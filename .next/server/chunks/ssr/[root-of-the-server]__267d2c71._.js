module.exports=[944104,(a,b,c)=>{b.exports=a.x("@capacitor/storage-373690b51d3080c6",()=>require("@capacitor/storage-373690b51d3080c6"))},258183,(a,b,c)=>{b.exports=a.x("capacitor-bluetooth-spp-02a0e47eb9d2c3e7",()=>require("capacitor-bluetooth-spp-02a0e47eb9d2c3e7"))},566767,a=>{"use strict";var b=a.i(20180),c=a.i(944104),d=a.i(258183);let e=null;async function f(a){if(!b.Capacitor.isNativePlatform())return{success:!1,message:"Not a native platform"};try{await d.default.requestPermissions();let b=(await c.Storage.get({key:"selected_printer"})).value;if(b)try{console.log("Trying stored printer:",b);let a=await d.default.connect({address:b});a?.connected?(e=b,console.log("Connected using stored printer.")):b=null}catch(a){console.log("Stored printer failed. Falling back to selection."),b=null}if(!b&&!e){console.log("Listing paired devices...");let a=await d.default.listPairedDevices();if(!a?.devices?.length)throw Error("No paired devices found");let b=a.devices.map(a=>a.name||a.address),f=prompt(`Select a Bluetooth device:
${b.map((a,b)=>`${b+1}: ${a}`).join("\n")}`,"1"),g=parseInt(f||"1",10)-1;if(g<0||g>=a.devices.length)throw Error("Invalid device selection");let h=a.devices[g];console.log("Connecting to",h.name,h.address);let i=await d.default.connect({address:h.address});if(!i?.connected)throw Error("Failed to connect");e=h.address,await c.Storage.set({key:"selected_printer",value:h.address}),console.log("Printer saved:",h.address)}return await d.default.write({data:a}),await d.default.write({data:"\x1bd\x03"}),{success:!0,message:"Printed successfully"}}catch(a){console.error("Bluetooth print failed:",a);try{await d.default.disconnect()}catch(a){}return e=null,{success:!1,message:a?.message||"Unknown error"}}}d.default.addListener("connected",a=>console.log("Event: connected",a)),d.default.addListener("connectionFailed",a=>console.log("Event: connectionFailed",a)),d.default.addListener("disconnected",a=>console.log("Event: disconnected",a)),d.default.addListener("deviceFound",a=>console.log("Event: deviceFound",a)),d.default.addListener("discoveryFinished",()=>console.log("Event: discoveryFinished")),a.s(["printBluetooth",()=>f])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__267d2c71._.js.map