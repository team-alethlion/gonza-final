module.exports=[971358,a=>a.a(async(b,c)=>{try{var d=a.i(137936),e=a.i(319343),f=a.i(118558),g=a.i(713095),h=b([e]);async function i(a,b="desc",c){try{let d={where:{branchId:a},orderBy:{createdAt:b},include:{cashTransaction:!0}};return c&&c>0&&(d.take=c),(await e.db.sale.findMany(d)).map(a=>({id:a.id,user_id:a.userId,location_id:a.branchId,receipt_number:a.saleNumber,customer_name:a.customerName,customer_address:a.customerAddress,customer_contact:a.customerPhone,customer_id:a.customerId,items:a.items,payment_status:a.paymentStatus,profit:0,date:a.date.toISOString(),tax_rate:a.taxRate?Number(a.taxRate):0,created_at:a.createdAt.toISOString(),updated_at:a.updatedAt.toISOString(),cash_transaction_id:a.cashTransactionId,amount_paid:Number(a.amountPaid),amount_due:Number(a.balance),category_id:a.categoryId,notes:a.notes}))}catch(a){return console.error("Error fetching sales:",a),[]}}async function j(a,b){try{let c=await e.db.sale.findUnique({where:{id:a},include:{cashTransaction:!0,installmentPayments:!0}});if(!c||c.branchId!==b)return{success:!1,error:"Sale not found or unauthorized"};return await e.db.$transaction(async b=>{await b.installmentPayment.deleteMany({where:{saleId:a}}),c.cashTransactionId&&await b.cashTransaction.delete({where:{id:c.cashTransactionId}}),await b.sale.delete({where:{id:a}})}),{success:!0,sale:{receiptNumber:c.saleNumber,customerName:c.customerName,customerAddress:c.customerAddress,customerContact:c.customerPhone,paymentStatus:c.paymentStatus,cashTransactionId:c.cashTransactionId,items:c.items,amountPaid:Number(c.amountPaid),amountDue:Number(c.balance),profit:0,taxRate:Number(c.taxRate),notes:c.notes}}}catch(a){return console.error("Error deleting sale:",a),{success:!1,error:a.message||"Failed to delete sale"}}}async function k(a,b,c){try{let d=a.payment_status;"NOT PAID"===d?d="UNPAID":"Installment Sale"===d?d="INSTALLMENT":"Paid"===d?d="PAID":"Quote"===d&&(d="QUOTE");let f={userId:a.user_id,branchId:a.location_id,saleNumber:a.receipt_number,customerName:a.customer_name,customerAddress:a.customer_address,customerPhone:a.customer_contact,customerId:a.customer_id,items:a.items,paymentStatus:d,date:new Date(a.date),taxRate:a.tax_rate,cashTransactionId:a.cash_transaction_id,amountPaid:a.amount_paid,balance:a.amount_due,categoryId:a.category_id,notes:a.notes,subtotal:0,total:0};if(b&&c){let a=await e.db.sale.update({where:{id:c},data:f});return{success:!0,data:a}}{let a=await e.db.sale.create({data:f});return{success:!0,data:a}}}catch(a){return console.error("Error upserting sale:",a),{success:!1,error:a.message||"Failed to preserve sale"}}}async function l(a,b,c){try{let d=a.paymentStatus;"NOT PAID"===d?d="UNPAID":"Installment Sale"===d?d="INSTALLMENT":"Paid"===d?d="PAID":"Quote"===d&&(d="QUOTE");let g=await e.db.sale.create({data:{userId:c,branchId:b,saleNumber:a.receiptNumber,customerName:a.customerName,customerId:a.customerId,date:new Date(a.date),items:a.items,paymentStatus:d,amountPaid:a.amountPaid||0,balance:a.amountDue||0,cashAccountId:a.cashAccountId,notes:a.notes,subtotal:0,total:0}});return(0,f.revalidatePath)("/sales"),(0,f.revalidatePath)("/customers"),{success:!0,data:g}}catch(a){return console.error("Error creating receipt:",a),{success:!1,error:a.message||"Failed to create receipt"}}}async function m(a){try{let b=await e.db.saleCategory.findMany({where:{branchId:a},orderBy:{name:"asc"}});return{success:!0,data:b}}catch(a){return console.error("Error fetching sales categories:",a),{success:!1,error:a.message}}}async function n(a,b,c,d=!1){try{let g=await e.db.saleCategory.create({data:{branchId:a,userId:b,name:c,is_default:d}});return(0,f.revalidatePath)("/sales"),{success:!0,data:g}}catch(a){return console.error("Error creating sales category:",a),{success:!1,error:a.message}}}async function o(a,b){try{let c=await e.db.saleCategory.update({where:{id:a},data:{name:b}});return(0,f.revalidatePath)("/sales"),{success:!0,data:c}}catch(a){return console.error("Error updating sales category:",a),{success:!1,error:a.message}}}async function p(a){try{return await e.db.saleCategory.delete({where:{id:a}}),(0,f.revalidatePath)("/sales"),{success:!0}}catch(a){return console.error("Error deleting sales category:",a),{success:!1,error:a.message}}}async function q(a,b){if(!a||!b)return null;try{return await e.db.customer.findFirst({where:{branchId:a,name:{contains:b,mode:"insensitive"}},select:{id:!0,name:!0}})}catch(a){return console.error("Error looking up customer by name:",a),null}}async function r(a,b){try{return await e.db.sale.update({where:{id:a},data:{customerId:b}}),{success:!0}}catch(a){return console.error("Error updating sale customer:",a),{success:!1,error:a.message}}}async function j(a){try{return await e.db.sale.delete({where:{id:a}}),(0,f.revalidatePath)("/sales"),!0}catch(a){return console.error("Error deleting sale:",a),!1}}[e]=h.then?(await h)():h,(0,g.ensureServerEntryExports)([i,j,k,l,m,n,o,p,q,r,j]),(0,d.registerServerReference)(i,"703e9376bfaf2adbf9aba886e70ba6b561f6bf5e0c",null),(0,d.registerServerReference)(j,"60d9064371ce5c0811194879498fdc849fbf872b8a",null),(0,d.registerServerReference)(k,"707be093cac72269888b676c90752075900286c135",null),(0,d.registerServerReference)(l,"701e1ec289530654c83844b4eaf8773c09a902523e",null),(0,d.registerServerReference)(m,"40d192c7133b72d6eb22105e9bdccca4dd09d6c312",null),(0,d.registerServerReference)(n,"78f34606537592502556e5eff8bf435c75821848df",null),(0,d.registerServerReference)(o,"601c76a41759792ff7ede8d55df9ffa468b0da22c2",null),(0,d.registerServerReference)(p,"4048df543ea89e6b499e78c5496b2ff9ac8b3367ff",null),(0,d.registerServerReference)(q,"602de18dc3faf52666fcf9224768f7ac9c1a6340ca",null),(0,d.registerServerReference)(r,"601a24df33adeed822b4de1bc4a7ea1dad51e405a6",null),(0,d.registerServerReference)(j,"40d9064371ce5c0811194879498fdc849fbf872b8a",null),a.s(["createReceiptAction",()=>l,"createSalesCategoryAction",()=>n,"deleteSaleAction",()=>j,"deleteSalesCategoryAction",()=>p,"getCustomerByNameAction",()=>q,"getSalesAction",()=>i,"getSalesCategoriesAction",()=>m,"updateSaleCustomerAction",()=>r,"updateSalesCategoryAction",()=>o,"upsertSaleAction",()=>k]),c()}catch(a){c(a)}},!1),419447,a=>a.a(async(b,c)=>{try{var d=a.i(137936),e=a.i(319343),f=a.i(118558),g=a.i(713095),h=b([e]);async function i(a,b){try{let c=await e.db.$transaction(async c=>{let d=await c.expense.create({data:{userId:a.userId,branchId:a.locationId,amount:a.amount,description:a.description,category:a.category||null,date:a.date,paymentMethod:a.paymentMethod||null,personInCharge:a.personInCharge||null,receiptImage:a.receiptImage||null,cashAccountId:b&&a.cashAccountId?a.cashAccountId:null}});if(b&&a.cashAccountId){let b=await c.cashTransaction.create({data:{userId:a.userId,branchId:a.locationId,accountId:a.cashAccountId,amount:a.amount,transactionType:"cash_out",category:a.category||"Expense",description:`Expense: ${a.description}`,personInCharge:a.personInCharge||null,date:a.date,paymentMethod:a.paymentMethod||null,receiptImage:a.receiptImage||null}});await c.expense.update({where:{id:d.id},data:{cashTransactionId:b.id}})}return d});return(0,f.revalidatePath)("/finance"),{success:!0,data:c}}catch(a){return console.error("Error creating expense:",a),{success:!1,error:a.message}}}async function j(a){try{let b=await e.db.expense.findMany({where:{branchId:a},orderBy:{date:"desc"}});return{success:!0,data:b.map(a=>({...a,created_at:a.createdAt.toISOString(),updated_at:a.updatedAt.toISOString(),payment_method:a.paymentMethod,person_in_charge:a.personInCharge,receipt_image:a.receiptImage,cash_account_id:a.cashAccountId,cash_transaction_id:a.cashTransactionId}))}}catch(a){return console.error("Error fetching expenses:",a),{success:!1,error:a.message}}}async function k(a,b,c){try{let d=await e.db.$transaction(async d=>{let e=await d.expense.update({where:{id:a},data:{amount:b.amount,description:b.description,category:b.category,date:b.date,paymentMethod:b.paymentMethod,personInCharge:b.personInCharge,receiptImage:b.receiptImage,cashAccountId:b.cashAccountId||null}}),f=!!b.cashAccountId,g=!!c.cashTransactionId;if(f&&!g){let e=await d.cashTransaction.create({data:{userId:c.userId,branchId:c.branchId||c.locationId,accountId:b.cashAccountId,amount:b.amount||c.amount,transactionType:"cash_out",category:b.category||c.category||"Expense",description:`Expense: ${b.description||c.description}`,personInCharge:b.personInCharge||c.personInCharge||null,date:b.date||c.date,paymentMethod:b.paymentMethod||c.paymentMethod||null,receiptImage:b.receiptImage||c.receiptImage||null}});await d.expense.update({where:{id:a},data:{cashTransactionId:e.id}})}else f&&g?await d.cashTransaction.update({where:{id:c.cashTransactionId},data:{accountId:b.cashAccountId,amount:b.amount||c.amount,category:b.category||c.category||"Expense",description:`Expense: ${b.description||c.description}`,personInCharge:b.personInCharge||c.personInCharge||null,date:b.date||c.date,paymentMethod:b.paymentMethod||c.paymentMethod||null,receiptImage:b.receiptImage||c.receiptImage||null}}):!f&&g&&(await d.cashTransaction.delete({where:{id:c.cashTransactionId}}),await d.expense.update({where:{id:a},data:{cashTransactionId:null}}));return e});return(0,f.revalidatePath)("/finance"),{success:!0,data:d}}catch(a){return console.error("Error updating expense:",a),{success:!1,error:a.message}}}async function l(a){try{return await e.db.$transaction(async b=>{let c=await b.expense.findUnique({where:{id:a},select:{cashTransactionId:!0}});c?.cashTransactionId&&await b.cashTransaction.delete({where:{id:c.cashTransactionId}}),await b.expense.delete({where:{id:a}})}),(0,f.revalidatePath)("/finance"),{success:!0}}catch(a){return console.error("Error deleting expense:",a),{success:!1,error:a.message}}}async function m(a){try{let b=await e.db.installmentPayment.findMany({where:{saleId:a},orderBy:{paymentDate:"desc"}});return{success:!0,data:b.map(a=>({id:a.id,saleId:a.saleId,userId:a.userId,amount:Number(a.amount),paymentDate:a.paymentDate.toISOString(),notes:a.notes,cashTransactionId:a.cashTransactionId,createdAt:a.createdAt.toISOString(),updatedAt:a.updatedAt.toISOString()}))}}catch(a){return console.error("Error fetching installment payments:",a),{success:!1,error:a.message}}}async function n(a){try{let b=await e.db.$transaction(async b=>{let c=a.cashTransactionId;if(a.accountId&&a.locationId&&!c){let d=await b.sale.findUnique({where:{id:a.saleId},select:{customerName:!0,receiptNumber:!0}}),e=d?`Installment payment for ${d.customerName} - Receipt #${d.receiptNumber}`:"Installment payment for sale";c=(await b.cashTransaction.create({data:{userId:a.userId,branchId:a.locationId,accountId:a.accountId,amount:a.amount,transactionType:"cash_in",category:"Installment payment",description:e,date:a.paymentDate?new Date(a.paymentDate):new Date}})).id}return await b.installmentPayment.create({data:{saleId:a.saleId,userId:a.userId,amount:a.amount,notes:a.notes,cashTransactionId:c,paymentDate:a.paymentDate?new Date(a.paymentDate):new Date}})});return(0,f.revalidatePath)("/finance"),{success:!0,data:b}}catch(a){return console.error("Error creating installment payment:",a),{success:!1,error:a.message}}}async function o(a,b){try{let c=await e.db.$transaction(async c=>{let d=await c.installmentPayment.findUnique({where:{id:a},select:{cashTransactionId:!0}});if(!d)throw Error("Payment not found");let e=await c.installmentPayment.update({where:{id:a},data:{amount:b.amount,notes:b.notes,paymentDate:b.paymentDate?new Date(b.paymentDate):void 0}});return d.cashTransactionId&&await c.cashTransaction.update({where:{id:d.cashTransactionId},data:{amount:b.amount,date:b.paymentDate?new Date(b.paymentDate):void 0}}),e});return(0,f.revalidatePath)("/finance"),{success:!0,data:c}}catch(a){return console.error("Error updating installment payment:",a),{success:!1,error:a.message}}}async function p(a){try{return await e.db.$transaction(async b=>{let c=await b.installmentPayment.findUnique({where:{id:a},select:{cashTransactionId:!0}});c?.cashTransactionId&&await b.cashTransaction.delete({where:{id:c.cashTransactionId}}),await b.installmentPayment.delete({where:{id:a}})}),(0,f.revalidatePath)("/finance"),{success:!0}}catch(a){return console.error("Error deleting installment payment:",a),{success:!1,error:a.message}}}async function q(a,b,c,d){try{let g=await e.db.$transaction(async e=>{let f=await e.installmentPayment.findUnique({where:{id:a},include:{sale:!0}});if(!f)throw Error("Payment not found");if(f.cashTransactionId)throw Error("Payment already linked");let g=f.sale?`Installment payment for ${f.sale.customerName} - Receipt #${f.sale.receiptNumber}`:`Installment payment #${a.substring(0,8)}`,h=await e.cashTransaction.create({data:{userId:d,branchId:c,accountId:b,amount:f.amount,transactionType:"cash_in",category:"Installment payment",description:g,date:f.paymentDate}});return await e.installmentPayment.update({where:{id:a},data:{cashTransactionId:h.id}}),h});return(0,f.revalidatePath)("/finance"),{success:!0,data:g}}catch(a){return console.error("Error linking installment to cash:",a),{success:!1,error:a.message}}}async function r(a){try{return await e.db.$transaction(async b=>{let c=await b.installmentPayment.findUnique({where:{id:a},select:{cashTransactionId:!0}});if(!c?.cashTransactionId)throw Error("Payment not linked");await b.cashTransaction.delete({where:{id:c.cashTransactionId}}),await b.installmentPayment.update({where:{id:a},data:{cashTransactionId:null}})}),(0,f.revalidatePath)("/finance"),{success:!0}}catch(a){return console.error("Error unlinking installment from cash:",a),{success:!1,error:a.message}}}async function s(a){try{let b=await e.db.expenseCategory.findMany({where:{branchId:a},orderBy:[{isDefault:"desc"},{name:"asc"}]});return{success:!0,data:b.map(a=>({id:a.id,name:a.name,isDefault:a.isDefault,createdAt:a.createdAt.toISOString()}))}}catch(a){return console.error("Error fetching expense categories:",a),{success:!1,error:a.message}}}async function t(a){try{let b=await e.db.expenseCategory.create({data:{userId:a.userId,branchId:a.locationId,name:a.name,isDefault:a.isDefault||!1}});return(0,f.revalidatePath)("/finance"),{success:!0,data:b}}catch(a){return console.error("Error creating expense category:",a),{success:!1,error:a.message}}}async function u(a){try{return await e.db.expenseCategory.delete({where:{id:a}}),(0,f.revalidatePath)("/finance"),{success:!0}}catch(a){return console.error("Error deleting expense category:",a),{success:!1,error:a.message}}}async function v(a,b,c){try{let d=c.map(c=>({userId:a,branchId:b,name:c,isDefault:!0}));return await e.db.expenseCategory.createMany({data:d,skipDuplicates:!0}),(0,f.revalidatePath)("/finance"),{success:!0}}catch(a){return console.error("Error creating default categories:",a),{success:!1,error:a.message}}}async function w(a){try{let b=await e.db.cashAccount.findMany({where:{branchId:a},orderBy:[{isDefault:"desc"},{name:"asc"}]});return{success:!0,data:b.map(a=>({id:a.id,name:a.name,description:a.description,openingBalance:Number(a.initialBalance),isDefault:a.isDefault,createdAt:a.createdAt.toISOString(),updatedAt:a.updatedAt.toISOString()}))}}catch(a){return console.error("Error fetching cash accounts:",a),{success:!1,error:a.message}}}async function x(a){try{let b=await e.db.cashAccount.create({data:{userId:a.userId,branchId:a.locationId,name:a.name,description:a.description||null,initialBalance:a.openingBalance||0,isDefault:a.isDefault||!1}});return(0,f.revalidatePath)("/finance"),{success:!0,data:b}}catch(a){return console.error("Error creating cash account:",a),{success:!1,error:a.message}}}async function y(a,b){try{let c=await e.db.cashAccount.update({where:{id:a},data:{name:b.name,description:b.description,initialBalance:b.openingBalance,isDefault:b.isDefault}});return(0,f.revalidatePath)("/finance"),{success:!0,data:c}}catch(a){return console.error("Error updating cash account:",a),{success:!1,error:a.message}}}async function z(a,b){try{let c=await e.db.$transaction(async c=>{let d=await c.cashTransaction.count({where:{accountId:a,branchId:b}}),e=await c.expense.count({where:{cashAccountId:a,branchId:b}});return d>0||e>0?{success:!1,hasTransactions:!0,details:`Account has ${d} transactions and ${e} expenses.`}:(await c.cashAccount.delete({where:{id:a,locationId:b}}),{success:!0,hasTransactions:!1})});return(0,f.revalidatePath)("/finance"),c}catch(a){return console.error("Error deleting cash account:",a),{success:!1,error:a.message}}}async function A(a,b,c){try{return await e.db.$transaction(async d=>{c?await d.cashTransaction.deleteMany({where:{accountId:a,branchId:b}}):await d.cashTransaction.updateMany({where:{accountId:a,branchId:b},data:{accountId:null}}),await d.expense.updateMany({where:{cashAccountId:a,branchId:b},data:{cashAccountId:null,cashTransactionId:null}}),await d.cashAccount.delete({where:{id:a,branchId:b}})}),(0,f.revalidatePath)("/finance"),{success:!0}}catch(a){return console.error("Error deleting cash account with transactions:",a),{success:!1,error:a.message}}}async function B(a,b){try{let c=await e.db.cashAccount.findUnique({where:{id:a},select:{initialBalance:!0}});if(!c)return{success:!1,error:"Account not found"};let d=await e.db.cashTransaction.findMany({where:{accountId:a,branchId:b},select:{amount:!0,transactionType:!0}}),f=Number(c.initialBalance);for(let a of d){let b=Number(a.amount);"cash_in"===a.transactionType||"transfer_in"===a.transactionType?f+=b:("cash_out"===a.transactionType||"transfer_out"===a.transactionType)&&(f-=b)}return{success:!0,data:f}}catch(a){return console.error("Error calculating account balance:",a),{success:!1,error:a.message}}}async function C(a,b){try{let c={branchId:a};b&&(c.accountId=b);let d=await e.db.cashTransaction.findMany({where:c,orderBy:[{date:"desc"},{createdAt:"desc"}]});return{success:!0,data:d.map(a=>({...a,created_at:a.createdAt.toISOString(),updated_at:a.updatedAt.toISOString(),user_id:a.userId,account_id:a.accountId,location_id:a.locationId,transaction_type:a.transactionType,person_in_charge:a.personInCharge,payment_method:a.paymentMethod,receipt_image:a.receiptImage}))}}catch(a){return console.error("Error fetching cash transactions:",a),{success:!1,error:a.message}}}async function D(a){try{let b=await e.db.$transaction(async b=>{if("transfer"!==a.transactionType||!a.toAccountId)return await b.cashTransaction.create({data:{userId:a.userId,branchId:a.locationId,accountId:a.accountId,amount:a.amount,transactionType:a.transactionType,category:a.category,description:a.description,personInCharge:a.personInCharge,tags:a.tags,date:a.date?new Date(a.date):new Date,paymentMethod:a.paymentMethod,receiptImage:a.receiptImage}});{let c=await b.cashTransaction.create({data:{userId:a.userId,locationId:a.locationId,accountId:a.accountId,amount:a.amount,transactionType:"transfer_out",description:a.description,date:a.date?new Date(a.date):new Date,category:a.category||"Transfer"}}),d=await b.cashTransaction.create({data:{userId:a.userId,locationId:a.locationId,accountId:a.toAccountId,amount:a.amount,transactionType:"transfer_in",description:a.description,date:a.date?new Date(a.date):new Date,category:a.category||"Transfer"}});return[c,d]}});return(0,f.revalidatePath)("/finance"),{success:!0,data:b}}catch(a){return console.error("Error creating cash transaction:",a),{success:!1,error:a.message}}}async function E(a,b){try{let c=await e.db.cashTransaction.update({where:{id:a},data:{accountId:b.accountId,amount:b.amount,transactionType:b.transactionType,category:b.category,description:b.description,personInCharge:b.personInCharge,tags:b.tags,date:b.date?new Date(b.date):void 0,paymentMethod:b.paymentMethod,receiptImage:b.receiptImage}});return(0,f.revalidatePath)("/finance"),{success:!0,data:c}}catch(a){return console.error("Error updating cash transaction:",a),{success:!1,error:a.message}}}async function F(a){try{let b=await e.db.cashTransaction.findUnique({where:{id:a},select:{accountId:!0}});return{success:!0,data:b}}catch(a){return console.error("Error finding cash transaction:",a),{success:!1,error:a.message}}}async function G(a,b){try{return await e.db.$transaction(async c=>{await c.installmentPayment.updateMany({where:{cashTransactionId:a},data:{cashTransactionId:null}}),await c.cashTransaction.delete({where:{id:a,branchId:b}})}),(0,f.revalidatePath)("/finance"),{success:!0}}catch(a){return console.error("Error deleting cash transaction:",a),{success:!1,error:a.message}}}async function H(a,b){try{let c=await e.db.cashAccount.findFirst({where:{id:a,branchId:b},select:{initialBalance:!0}});return{success:!0,data:Number(c?.initialBalance||0)}}catch(a){return console.error("Error fetching opening balance:",a),{success:!1,error:a.message}}}async function I(a){try{let b=await e.db.$transaction(async b=>{let c=[];for(let d of a)"transfer"===d.transactionType&&d.toAccountId?(c.push(await b.cashTransaction.create({data:{userId:d.userId,branchId:d.locationId,accountId:d.accountId,amount:d.amount,transactionType:"transfer_out",description:d.description,date:d.date?new Date(d.date):new Date,category:d.category||"Transfer"}})),c.push(await b.cashTransaction.create({data:{userId:d.userId,branchId:d.locationId,accountId:d.toAccountId,amount:d.amount,transactionType:"transfer_in",description:d.description,date:d.date?new Date(d.date):new Date,category:d.category||"Transfer"}}))):c.push(await b.cashTransaction.create({data:{userId:d.userId,branchId:d.locationId,accountId:d.accountId,amount:d.amount,transactionType:d.transactionType,category:d.category,description:d.description,personInCharge:d.personInCharge,tags:d.tags,date:d.date?new Date(d.date):new Date,paymentMethod:d.paymentMethod,receiptImage:d.receiptImage}}));return c});return(0,f.revalidatePath)("/finance"),{success:!0,data:b}}catch(a){return console.error("Error creating bulk transactions:",a),{success:!1,error:a.message}}}[e]=h.then?(await h)():h,(0,g.ensureServerEntryExports)([i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I]),(0,d.registerServerReference)(i,"60ff4a4d37b8cdb46933c77d4c2feddf840c5c9e12",null),(0,d.registerServerReference)(j,"403ecd539ba07dc1ae97e837a5af133a7339b5cb64",null),(0,d.registerServerReference)(k,"70d8f9fd83845cd0ba1effc4e3ccdba420d97bade6",null),(0,d.registerServerReference)(l,"40f5e1fa124fe3ebdec7f34b54a6837a1c32f5d22d",null),(0,d.registerServerReference)(m,"40786257b46b845f51e5b90ff2502c389af049cc70",null),(0,d.registerServerReference)(n,"40112c882b84370baebfbdd88b55390cbebe0d524d",null),(0,d.registerServerReference)(o,"6021a6dd25147899fbda211078cd44cca985d89362",null),(0,d.registerServerReference)(p,"409394b83f001d081510671555a3855b10e38d2c72",null),(0,d.registerServerReference)(q,"78ab6573748e58002b49a105ac9332c6ce6438d0d6",null),(0,d.registerServerReference)(r,"4001af3a742114ad88aa5fa65b77c9b0daf7714c0e",null),(0,d.registerServerReference)(s,"40a697434fd28c67d2c607c1f57f3439edf220a529",null),(0,d.registerServerReference)(t,"40127fd3ae724f72ea4406ee7bf136a2e88120db7f",null),(0,d.registerServerReference)(u,"408d7d1e536999dcf29cd979cf16838168c69252f0",null),(0,d.registerServerReference)(v,"7062b9fc92a24c208cfe0ff340b8c459971725aba8",null),(0,d.registerServerReference)(w,"408055c65091de6e86656304d04a002881aed3acc6",null),(0,d.registerServerReference)(x,"40fec0c16d5b967e0b7b13b4f39e9f33caa55d98fd",null),(0,d.registerServerReference)(y,"60cff6e1bde4cdde91ed3aaa29411ed65f1ac6b8ba",null),(0,d.registerServerReference)(z,"609fff12b333f8481f6eaa00c9f6ed0ca7485d5f62",null),(0,d.registerServerReference)(A,"701a700c12f80accdeeab232d537f79439d8fe9e50",null),(0,d.registerServerReference)(B,"60a22285198ef838d83b1b4a602809518cbd22267e",null),(0,d.registerServerReference)(C,"6050d5e4425dec9de12384682af8632685a43503f6",null),(0,d.registerServerReference)(D,"4064724fc471e698ee76d294a980e2a65c0a9c856a",null),(0,d.registerServerReference)(E,"60e4c60d7aa378a229209542057eb77c66409f1850",null),(0,d.registerServerReference)(F,"40db42f6103f55b9f7ade5c65ca70a00feff7ff278",null),(0,d.registerServerReference)(G,"605e333b82184dfc91eaa2d1fe6090163e41e2aa78",null),(0,d.registerServerReference)(H,"60233cf66a8bd607780138afb600e5b4300ab3ce36",null),(0,d.registerServerReference)(I,"402f81bafe02611b5b5687b2b85c12e36ea9604ccf",null),a.s(["createBulkCashTransactionsAction",()=>I,"createCashAccountAction",()=>x,"createCashTransactionAction",()=>D,"createDefaultExpenseCategoriesAction",()=>v,"createExpenseAction",()=>i,"createExpenseCategoryAction",()=>t,"createInstallmentPaymentAction",()=>n,"deleteCashAccountAction",()=>z,"deleteCashAccountWithTransactionsAction",()=>A,"deleteCashTransactionAction",()=>G,"deleteExpenseAction",()=>l,"deleteExpenseCategoryAction",()=>u,"deleteInstallmentPaymentAction",()=>p,"findCashTransactionAction",()=>F,"getAccountOpeningBalanceAction",()=>H,"getCashAccountBalanceAction",()=>B,"getCashAccountsAction",()=>w,"getCashTransactionsAction",()=>C,"getExpenseCategoriesAction",()=>s,"getExpensesAction",()=>j,"getInstallmentPaymentsAction",()=>m,"linkInstallmentToCashAction",()=>q,"unlinkInstallmentFromCashAction",()=>r,"updateCashAccountAction",()=>y,"updateCashTransactionAction",()=>E,"updateExpenseAction",()=>k,"updateInstallmentPaymentAction",()=>o]),c()}catch(a){c(a)}},!1),878274,a=>a.a(async(b,c)=>{try{var d=a.i(137936),e=a.i(319343),f=a.i(713095),g=b([e]);async function h(a){try{return await e.db.activityHistory.create({data:{userId:a.userId,locationId:a.locationId,activityType:a.activityType,module:a.module,entityType:a.entityType,entityId:a.entityId||null,entityName:a.entityName,description:a.description,metadata:a.metadata||null,profileId:a.profileId||null,profileName:a.profileName||null}}),{success:!0}}catch(a){return console.error("Error logging activity:",a),{success:!1,error:a.message}}}async function i(a,b,c=1,d=20,f){try{let g={locationId:a,userId:b};if(f&&(f.activityType&&"ALL"!==f.activityType&&(g.activityType=f.activityType),f.module&&"ALL"!==f.module&&(g.module=f.module),f.search&&(g.OR=[{entityName:{contains:f.search,mode:"insensitive"}},{description:{contains:f.search,mode:"insensitive"}}]),f.dateFrom||f.dateTo)&&(g.createdAt={},f.dateFrom&&(g.createdAt.gte=new Date(f.dateFrom)),f.dateTo)){let a=new Date(f.dateTo);a.setHours(23,59,59,999),g.createdAt.lte=a}let[h,i]=await Promise.all([e.db.activityHistory.findMany({where:g,skip:(c-1)*d,take:d,orderBy:{createdAt:"desc"}}),e.db.activityHistory.count({where:g})]);return{success:!0,data:{activities:h.map(a=>({...a,created_at:a.createdAt.toISOString(),activity_type:a.activityType,location_id:a.locationId,user_id:a.userId,entity_type:a.entityType,entity_id:a.entityId,entity_name:a.entityName,profile_id:a.profileId,profile_name:a.profileName})),count:i}}}catch(a){return console.error("Error fetching activity history:",a),{success:!1,error:a.message}}}async function j(a,b,c){try{let d=await e.db.activityHistory.findMany({where:{locationId:a,module:b,activityType:c},orderBy:{createdAt:"desc"}});return{success:!0,data:d.map(a=>({...a,createdAt:a.createdAt.toISOString(),profileName:a.profileName}))}}catch(a){return console.error("Error fetching activity history by type:",a),{success:!1,error:a.message,data:[]}}}[e]=g.then?(await g)():g,(0,f.ensureServerEntryExports)([h,i,j]),(0,d.registerServerReference)(h,"401d907b5cd7e0b2f207e9b555ac4fe2e14de08444",null),(0,d.registerServerReference)(i,"7c50216f90d367a7092d0edb6ffc217f655b260170",null),(0,d.registerServerReference)(j,"70d9b0558099fec3cea19015c6e9f34f169e8a6f38",null),a.s(["getActivityHistoryAction",()=>i,"getActivityHistoryByTypeAction",()=>j,"logActivityAction",()=>h]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=src_app_actions_9d632056._.js.map