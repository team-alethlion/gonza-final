{"version":3,"sources":["../../../../src/app/actions/sales.ts","../../../../src/app/actions/finance.ts","../../../../src/app/actions/activity.ts"],"sourcesContent":["'use server';\r\n\r\nimport { db } from '../../../prisma/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nexport async function getSalesAction(businessId: string, sortOrder: 'asc' | 'desc' = 'desc', pageSize?: number) {\r\n    try {\r\n        const queryOptions: any = {\r\n            where: {\r\n                branchId: businessId,\r\n            },\r\n            orderBy: {\r\n                createdAt: sortOrder,\r\n            },\r\n            include: {\r\n                cashTransaction: true,\r\n            }\r\n        };\r\n\r\n        if (pageSize && pageSize > 0) {\r\n            queryOptions.take = pageSize;\r\n        }\r\n\r\n        const sales = await db.sale.findMany(queryOptions);\r\n\r\n        // Provide default mappings to existing React components\r\n        return sales.map((item: any) => ({\r\n            id: item.id,\r\n            user_id: item.userId,\r\n            location_id: item.branchId,\r\n            receipt_number: item.saleNumber,\r\n            customer_name: item.customerName,\r\n            customer_address: item.customerAddress,\r\n            customer_contact: item.customerPhone,\r\n            customer_id: item.customerId,\r\n            items: item.items as any, // jsonb type\r\n            payment_status: item.paymentStatus,\r\n            profit: 0, // Profit not stored directly\r\n            date: item.date.toISOString(),\r\n            tax_rate: item.taxRate ? Number(item.taxRate) : 0,\r\n            created_at: item.createdAt.toISOString(),\r\n            updated_at: item.updatedAt.toISOString(),\r\n            cash_transaction_id: item.cashTransactionId,\r\n            amount_paid: Number(item.amountPaid),\r\n            amount_due: Number(item.balance),\r\n            category_id: item.categoryId,\r\n            notes: item.notes\r\n        }));\r\n    } catch (error) {\r\n        console.error('Error fetching sales:', error);\r\n        return [];\r\n    }\r\n}\r\n\r\nexport async function deleteSaleAction(id: string, businessId: string) {\r\n    try {\r\n        const sale = await db.sale.findUnique({\r\n            where: { id },\r\n            include: { cashTransaction: true, installmentPayments: true }\r\n        });\r\n\r\n        if (!sale || sale.branchId !== businessId) {\r\n            return { success: false, error: 'Sale not found or unauthorized' };\r\n        }\r\n\r\n        await db.$transaction(async (tx) => {\r\n            // Delete installments\r\n            await tx.installmentPayment.deleteMany({\r\n                where: { saleId: id }\r\n            });\r\n\r\n            // Delete associated cash transaction\r\n            if (sale.cashTransactionId) {\r\n                await tx.cashTransaction.delete({\r\n                    where: { id: sale.cashTransactionId }\r\n                });\r\n            }\r\n\r\n            // Delete the sale itself\r\n            await tx.sale.delete({\r\n                where: { id }\r\n            });\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            sale: {\r\n                receiptNumber: sale.saleNumber,\r\n                customerName: sale.customerName,\r\n                customerAddress: sale.customerAddress,\r\n                customerContact: sale.customerPhone,\r\n                paymentStatus: sale.paymentStatus,\r\n                cashTransactionId: sale.cashTransactionId,\r\n                items: sale.items as any,\r\n                amountPaid: Number(sale.amountPaid),\r\n                amountDue: Number(sale.balance),\r\n                profit: 0,\r\n                taxRate: Number(sale.taxRate),\r\n                notes: sale.notes\r\n            }\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error deleting sale:', error);\r\n        return { success: false, error: error.message || 'Failed to delete sale' };\r\n    }\r\n}\r\n\r\nexport async function upsertSaleAction(saleDbData: any, isUpdate: boolean, updateId?: string) {\r\n    try {\r\n        // Map PaymentStatus if needed\r\n        let status = saleDbData.payment_status;\r\n        if (status === 'NOT PAID') status = 'UNPAID';\r\n        else if (status === 'Installment Sale') status = 'INSTALLMENT';\r\n        else if (status === 'Paid') status = 'PAID';\r\n        else if (status === 'Quote') status = 'QUOTE';\r\n\r\n        const prismaData: any = {\r\n            userId: saleDbData.user_id,\r\n            branchId: saleDbData.location_id,\r\n            saleNumber: saleDbData.receipt_number,\r\n            customerName: saleDbData.customer_name,\r\n            customerAddress: saleDbData.customer_address,\r\n            customerPhone: saleDbData.customer_contact,\r\n            customerId: saleDbData.customer_id,\r\n            items: saleDbData.items,\r\n            paymentStatus: status,\r\n            date: new Date(saleDbData.date),\r\n            taxRate: saleDbData.tax_rate,\r\n            cashTransactionId: saleDbData.cash_transaction_id,\r\n            amountPaid: saleDbData.amount_paid,\r\n            balance: saleDbData.amount_due,\r\n            categoryId: saleDbData.category_id,\r\n            notes: saleDbData.notes,\r\n            subtotal: 0, // Placeholder\r\n            total: 0,     // Placeholder\r\n        };\r\n\r\n        if (isUpdate && updateId) {\r\n            const updated = await db.sale.update({\r\n                where: { id: updateId },\r\n                data: prismaData\r\n            });\r\n            return { success: true, data: updated };\r\n        } else {\r\n            const created = await db.sale.create({\r\n                data: prismaData\r\n            });\r\n            return { success: true, data: created };\r\n        }\r\n    } catch (error: any) {\r\n        console.error('Error upserting sale:', error);\r\n        return { success: false, error: error.message || 'Failed to preserve sale' };\r\n    }\r\n}\r\n\r\nexport async function createReceiptAction(saleData: any, businessId: string, userId: string) {\r\n    try {\r\n        let status = saleData.paymentStatus;\r\n        if (status === 'NOT PAID') status = 'UNPAID';\r\n        else if (status === 'Installment Sale') status = 'INSTALLMENT';\r\n        else if (status === 'Paid') status = 'PAID';\r\n        else if (status === 'Quote') status = 'QUOTE';\r\n\r\n        const created = await db.sale.create({\r\n            data: {\r\n                userId: userId,\r\n                branchId: businessId,\r\n                saleNumber: saleData.receiptNumber,\r\n                customerName: saleData.customerName,\r\n                customerId: saleData.customerId,\r\n                date: new Date(saleData.date),\r\n                items: saleData.items,\r\n                paymentStatus: status,\r\n                amountPaid: saleData.amountPaid || 0,\r\n                balance: saleData.amountDue || 0,\r\n                cashAccountId: saleData.cashAccountId,\r\n                notes: saleData.notes,\r\n                subtotal: 0,\r\n                total: 0,\r\n            }\r\n        });\r\n\r\n        revalidatePath('/sales');\r\n        revalidatePath('/customers');\r\n\r\n        return { success: true, data: created };\r\n    } catch (error: any) {\r\n        console.error('Error creating receipt:', error);\r\n        return { success: false, error: error.message || 'Failed to create receipt' };\r\n    }\r\n}\r\n\r\n// --- SALES CATEGORIES ---\r\n\r\nexport async function getSalesCategoriesAction(businessId: string) {\r\n    try {\r\n        const categories = await db.saleCategory.findMany({\r\n            where: { branchId: businessId },\r\n            orderBy: { name: 'asc' }\r\n        });\r\n\r\n        return { success: true, data: categories };\r\n    } catch (error: any) {\r\n        console.error('Error fetching sales categories:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createSalesCategoryAction(businessId: string, userId: string, name: string, isDefault: boolean = false) {\r\n    try {\r\n        const category = await db.saleCategory.create({\r\n            data: {\r\n                branchId: businessId,\r\n                userId,\r\n                name,\r\n                is_default: isDefault\r\n            }\r\n        });\r\n\r\n        revalidatePath('/sales');\r\n        return { success: true, data: category };\r\n    } catch (error: any) {\r\n        console.error('Error creating sales category:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function updateSalesCategoryAction(id: string, name: string) {\r\n    try {\r\n        const category = await db.saleCategory.update({\r\n            where: { id },\r\n            data: { name }\r\n        });\r\n\r\n        revalidatePath('/sales');\r\n        return { success: true, data: category };\r\n    } catch (error: any) {\r\n        console.error('Error updating sales category:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteSalesCategoryAction(id: string) {\r\n    try {\r\n        await db.saleCategory.delete({\r\n            where: { id }\r\n        });\r\n\r\n        revalidatePath('/sales');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting sales category:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n// --- CUSTOMER LOOKUP ---\r\n\r\nexport async function getCustomerByNameAction(branchId: string, name: string) {\r\n    if (!branchId || !name) return null;\r\n    try {\r\n        const customer = await db.customer.findFirst({\r\n            where: {\r\n                branchId,\r\n                name: { contains: name, mode: 'insensitive' }\r\n            },\r\n            select: { id: true, name: true }\r\n        });\r\n        return customer;\r\n    } catch (error) {\r\n        console.error('Error looking up customer by name:', error);\r\n        return null;\r\n    }\r\n}\r\n\r\nexport async function updateSaleCustomerAction(saleId: string, customerId: string) {\r\n    try {\r\n        await db.sale.update({\r\n            where: { id: saleId },\r\n            data: { customerId }\r\n        });\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error updating sale customer:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteSaleAction(saleId: string) {\r\n    try {\r\n        await db.sale.delete({ where: { id: saleId } });\r\n        revalidatePath('/sales');\r\n        return true;\r\n    } catch (error) {\r\n        console.error('Error deleting sale:', error);\r\n        return false;\r\n    }\r\n}\r\n","'use server';\r\n\r\nimport { db, PaymentStatus, ActivityType, ActivityModule } from '../../../prisma/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// --- EXPENSES ---\r\n\r\nexport interface ExpenseInput {\r\n    amount: number;\r\n    description: string;\r\n    category?: string;\r\n    date: Date;\r\n    paymentMethod?: string;\r\n    personInCharge?: string;\r\n    receiptImage?: string;\r\n    cashAccountId?: string;\r\n    userId: string;\r\n    locationId: string;\r\n}\r\n\r\nexport async function createExpenseAction(data: ExpenseInput, linkToCash: boolean) {\r\n    try {\r\n        const result = await db.$transaction(async (tx: any) => {\r\n            // 1. Create the expense\r\n            const expense = await tx.expense.create({\r\n                data: {\r\n                    userId: data.userId,\r\n                    branchId: data.locationId,\r\n                    amount: data.amount,\r\n                    description: data.description,\r\n                    category: data.category || null,\r\n                    date: data.date,\r\n                    paymentMethod: data.paymentMethod || null,\r\n                    personInCharge: data.personInCharge || null,\r\n                    receiptImage: data.receiptImage || null,\r\n                    cashAccountId: linkToCash && data.cashAccountId ? data.cashAccountId : null\r\n                }\r\n            });\r\n\r\n            // 2. If linking to cash, create a cash transaction\r\n            if (linkToCash && data.cashAccountId) {\r\n                const cashTx = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        branchId: data.locationId,\r\n                        accountId: data.cashAccountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'cash_out',\r\n                        category: data.category || 'Expense',\r\n                        description: `Expense: ${data.description}`,\r\n                        personInCharge: data.personInCharge || null,\r\n                        date: data.date,\r\n                        paymentMethod: data.paymentMethod || null,\r\n                        receiptImage: data.receiptImage || null\r\n                    }\r\n                });\r\n\r\n                // Update expense with transaction reference\r\n                await tx.expense.update({\r\n                    where: { id: expense.id },\r\n                    data: { cashTransactionId: cashTx.id }\r\n                });\r\n            }\r\n\r\n            return expense;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getExpensesAction(locationId: string) {\r\n    try {\r\n        const expenses = await db.expense.findMany({\r\n            where: { branchId: locationId },\r\n            orderBy: { date: 'desc' }\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: expenses.map((e: any) => ({\r\n                ...e,\r\n                created_at: e.createdAt.toISOString(),\r\n                updated_at: e.updatedAt.toISOString(),\r\n                payment_method: e.paymentMethod,\r\n                person_in_charge: e.personInCharge,\r\n                receipt_image: e.receiptImage,\r\n                cash_account_id: e.cashAccountId,\r\n                cash_transaction_id: e.cashTransactionId\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching expenses:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function updateExpenseAction(id: string, updates: any, currentExpense: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx: any) => {\r\n            // Update expense\r\n            const updatedExpense = await tx.expense.update({\r\n                where: { id },\r\n                data: {\r\n                    amount: updates.amount,\r\n                    description: updates.description,\r\n                    category: updates.category,\r\n                    date: updates.date,\r\n                    paymentMethod: updates.paymentMethod,\r\n                    personInCharge: updates.personInCharge,\r\n                    receiptImage: updates.receiptImage,\r\n                    cashAccountId: updates.cashAccountId || null\r\n                }\r\n            });\r\n\r\n            const shouldLinkToCash = !!updates.cashAccountId;\r\n            const wasLinkedToCash = !!currentExpense.cashTransactionId;\r\n\r\n            if (shouldLinkToCash && !wasLinkedToCash) {\r\n                // Create new cash transaction\r\n                const cashTx = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: currentExpense.userId,\r\n                        branchId: currentExpense.branchId || currentExpense.locationId,\r\n                        accountId: updates.cashAccountId,\r\n                        amount: updates.amount || currentExpense.amount,\r\n                        transactionType: 'cash_out',\r\n                        category: updates.category || currentExpense.category || 'Expense',\r\n                        description: `Expense: ${updates.description || currentExpense.description}`,\r\n                        personInCharge: updates.personInCharge || currentExpense.personInCharge || null,\r\n                        date: updates.date || currentExpense.date,\r\n                        paymentMethod: updates.paymentMethod || currentExpense.paymentMethod || null,\r\n                        receiptImage: updates.receiptImage || currentExpense.receiptImage || null\r\n                    }\r\n                });\r\n                await tx.expense.update({\r\n                    where: { id },\r\n                    data: { cashTransactionId: cashTx.id }\r\n                });\r\n            } else if (shouldLinkToCash && wasLinkedToCash) {\r\n                // Update existing cash transaction\r\n                await tx.cashTransaction.update({\r\n                    where: { id: currentExpense.cashTransactionId },\r\n                    data: {\r\n                        accountId: updates.cashAccountId,\r\n                        amount: updates.amount || currentExpense.amount,\r\n                        category: updates.category || currentExpense.category || 'Expense',\r\n                        description: `Expense: ${updates.description || currentExpense.description}`,\r\n                        personInCharge: updates.personInCharge || currentExpense.personInCharge || null,\r\n                        date: updates.date || currentExpense.date,\r\n                        paymentMethod: updates.paymentMethod || currentExpense.paymentMethod || null,\r\n                        receiptImage: updates.receiptImage || currentExpense.receiptImage || null\r\n                    }\r\n                });\r\n            } else if (!shouldLinkToCash && wasLinkedToCash) {\r\n                // Delete existing cash transaction\r\n                await tx.cashTransaction.delete({\r\n                    where: { id: currentExpense.cashTransactionId }\r\n                });\r\n                await tx.expense.update({\r\n                    where: { id },\r\n                    data: { cashTransactionId: null }\r\n                });\r\n            }\r\n\r\n            return updatedExpense;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error updating expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteExpenseAction(id: string) {\r\n    try {\r\n        await db.$transaction(async (tx: any) => {\r\n            const expense = await tx.expense.findUnique({\r\n                where: { id },\r\n                select: { cashTransactionId: true }\r\n            });\r\n\r\n            if (expense?.cashTransactionId) {\r\n                await tx.cashTransaction.delete({\r\n                    where: { id: expense.cashTransactionId }\r\n                });\r\n            }\r\n\r\n            await tx.expense.delete({\r\n                where: { id }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n// --- INSTALLMENT PAYMENTS ---\r\n\r\nexport async function getInstallmentPaymentsAction(saleId: string) {\r\n    try {\r\n        const payments = await db.installmentPayment.findMany({\r\n            where: { saleId },\r\n            orderBy: { paymentDate: 'desc' }\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: payments.map((p: any) => ({\r\n                id: p.id,\r\n                saleId: p.saleId,\r\n                userId: p.userId,\r\n                amount: Number(p.amount),\r\n                paymentDate: p.paymentDate.toISOString(),\r\n                notes: p.notes,\r\n                cashTransactionId: p.cashTransactionId,\r\n                createdAt: p.createdAt.toISOString(),\r\n                updatedAt: p.updatedAt.toISOString()\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching installment payments:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createInstallmentPaymentAction(data: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx: any) => {\r\n            let cashTxId = data.cashTransactionId;\r\n\r\n            if (data.accountId && data.locationId && !cashTxId) {\r\n                const sale = await tx.sale.findUnique({\r\n                    where: { id: data.saleId },\r\n                    select: { customerName: true, receiptNumber: true }\r\n                });\r\n\r\n                const description = sale\r\n                    ? `Installment payment for ${sale.customerName} - Receipt #${sale.receiptNumber}`\r\n                    : `Installment payment for sale`;\r\n\r\n                const cashTx = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        branchId: data.locationId,\r\n                        accountId: data.accountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'cash_in',\r\n                        category: 'Installment payment',\r\n                        description: description,\r\n                        date: data.paymentDate ? new Date(data.paymentDate) : new Date(),\r\n                    }\r\n                });\r\n                cashTxId = cashTx.id;\r\n            }\r\n\r\n            const payment = await tx.installmentPayment.create({\r\n                data: {\r\n                    saleId: data.saleId,\r\n                    userId: data.userId,\r\n                    amount: data.amount,\r\n                    notes: data.notes,\r\n                    cashTransactionId: cashTxId,\r\n                    paymentDate: data.paymentDate ? new Date(data.paymentDate) : new Date()\r\n                }\r\n            });\r\n\r\n            return payment;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating installment payment:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function updateInstallmentPaymentAction(id: string, updates: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx: any) => {\r\n            const current = await tx.installmentPayment.findUnique({\r\n                where: { id },\r\n                select: { cashTransactionId: true }\r\n            });\r\n\r\n            if (!current) throw new Error(\"Payment not found\");\r\n\r\n            const updated = await tx.installmentPayment.update({\r\n                where: { id },\r\n                data: {\r\n                    amount: updates.amount,\r\n                    notes: updates.notes,\r\n                    paymentDate: updates.paymentDate ? new Date(updates.paymentDate) : undefined\r\n                }\r\n            });\r\n\r\n            if (current.cashTransactionId) {\r\n                await tx.cashTransaction.update({\r\n                    where: { id: current.cashTransactionId },\r\n                    data: {\r\n                        amount: updates.amount,\r\n                        date: updates.paymentDate ? new Date(updates.paymentDate) : undefined\r\n                    }\r\n                });\r\n            }\r\n\r\n            return updated;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error updating installment payment:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteInstallmentPaymentAction(id: string) {\r\n    try {\r\n        await db.$transaction(async (tx: any) => {\r\n            const payment = await tx.installmentPayment.findUnique({\r\n                where: { id },\r\n                select: { cashTransactionId: true }\r\n            });\r\n\r\n            if (payment?.cashTransactionId) {\r\n                await tx.cashTransaction.delete({\r\n                    where: { id: payment.cashTransactionId }\r\n                });\r\n            }\r\n\r\n            await tx.installmentPayment.delete({\r\n                where: { id }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting installment payment:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function linkInstallmentToCashAction(paymentId: string, accountId: string, locationId: string, userId: string) {\r\n    try {\r\n        const result = await db.$transaction(async (tx: any) => {\r\n            const payment = await tx.installmentPayment.findUnique({\r\n                where: { id: paymentId },\r\n                include: { sale: true }\r\n            });\r\n\r\n            if (!payment) throw new Error(\"Payment not found\");\r\n            if (payment.cashTransactionId) throw new Error(\"Payment already linked\");\r\n\r\n            const description = payment.sale\r\n                ? `Installment payment for ${payment.sale.customerName} - Receipt #${payment.sale.receiptNumber}`\r\n                : `Installment payment #${paymentId.substring(0, 8)}`;\r\n\r\n            const cashTx = await tx.cashTransaction.create({\r\n                data: {\r\n                    userId,\r\n                    branchId: locationId,\r\n                    accountId,\r\n                    amount: payment.amount,\r\n                    transactionType: 'cash_in',\r\n                    category: 'Installment payment',\r\n                    description,\r\n                    date: payment.paymentDate,\r\n                }\r\n            });\r\n\r\n            await tx.installmentPayment.update({\r\n                where: { id: paymentId },\r\n                data: { cashTransactionId: cashTx.id }\r\n            });\r\n\r\n            return cashTx;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error linking installment to cash:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function unlinkInstallmentFromCashAction(paymentId: string) {\r\n    try {\r\n        await db.$transaction(async (tx: any) => {\r\n            const payment = await tx.installmentPayment.findUnique({\r\n                where: { id: paymentId },\r\n                select: { cashTransactionId: true }\r\n            });\r\n\r\n            if (!payment?.cashTransactionId) throw new Error(\"Payment not linked\");\r\n\r\n            await tx.cashTransaction.delete({\r\n                where: { id: payment.cashTransactionId }\r\n            });\r\n\r\n            await tx.installmentPayment.update({\r\n                where: { id: paymentId },\r\n                data: { cashTransactionId: null }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error unlinking installment from cash:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n// --- EXPENSE CATEGORIES ---\r\n\r\nexport async function getExpenseCategoriesAction(locationId: string) {\r\n    try {\r\n        const categories = await db.expenseCategory.findMany({\r\n            where: { branchId: locationId },\r\n            orderBy: [{ isDefault: 'desc' }, { name: 'asc' }]\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: categories.map((c: any) => ({\r\n                id: c.id,\r\n                name: c.name,\r\n                isDefault: c.isDefault,\r\n                createdAt: c.createdAt.toISOString()\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching expense categories:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createExpenseCategoryAction(data: any) {\r\n    try {\r\n        const result = await db.expenseCategory.create({\r\n            data: {\r\n                userId: data.userId,\r\n                branchId: data.locationId,\r\n                name: data.name,\r\n                isDefault: data.isDefault || false\r\n            }\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating expense category:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteExpenseCategoryAction(id: string) {\r\n    try {\r\n        await db.expenseCategory.delete({\r\n            where: { id }\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting expense category:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createDefaultExpenseCategoriesAction(userId: string, locationId: string, categoryNames: string[]) {\r\n    try {\r\n        const data = categoryNames.map(name => ({\r\n            userId,\r\n            branchId: locationId,\r\n            name,\r\n            isDefault: true\r\n        }));\r\n\r\n        await db.expenseCategory.createMany({\r\n            data,\r\n            skipDuplicates: true\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error creating default categories:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n// --- CASH ACCOUNTS ---\r\n\r\nexport async function getCashAccountsAction(locationId: string) {\r\n    try {\r\n        const accounts = await db.cashAccount.findMany({\r\n            where: { branchId: locationId },\r\n            orderBy: [{ isDefault: 'desc' }, { name: 'asc' }]\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: accounts.map((a: any) => ({\r\n                id: a.id,\r\n                name: a.name,\r\n                description: a.description,\r\n                openingBalance: Number(a.initialBalance),\r\n                isDefault: a.isDefault,\r\n                createdAt: a.createdAt.toISOString(),\r\n                updatedAt: a.updatedAt.toISOString()\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching cash accounts:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createCashAccountAction(data: any) {\r\n    try {\r\n        const result = await db.cashAccount.create({\r\n            data: {\r\n                userId: data.userId,\r\n                branchId: data.locationId,\r\n                name: data.name,\r\n                description: data.description || null,\r\n                initialBalance: data.openingBalance || 0,\r\n                isDefault: data.isDefault || false\r\n            }\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating cash account:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function updateCashAccountAction(id: string, updates: any) {\r\n    try {\r\n        const result = await db.cashAccount.update({\r\n            where: { id },\r\n            data: {\r\n                name: updates.name,\r\n                description: updates.description,\r\n                initialBalance: updates.openingBalance,\r\n                isDefault: updates.isDefault\r\n            }\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error updating cash account:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteCashAccountAction(id: string, locationId: string) {\r\n    try {\r\n        const result = await db.$transaction(async (tx: any) => {\r\n            const txCount = await tx.cashTransaction.count({\r\n                where: { accountId: id, branchId: locationId }\r\n            });\r\n\r\n            const expCount = await tx.expense.count({\r\n                where: { cashAccountId: id, branchId: locationId }\r\n            });\r\n\r\n            if (txCount > 0 || expCount > 0) {\r\n                return {\r\n                    success: false,\r\n                    hasTransactions: true,\r\n                    details: `Account has ${txCount} transactions and ${expCount} expenses.`\r\n                };\r\n            }\r\n\r\n            await tx.cashAccount.delete({\r\n                where: { id, locationId }\r\n            });\r\n\r\n            return { success: true, hasTransactions: false };\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return result;\r\n    } catch (error: any) {\r\n        console.error('Error deleting cash account:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteCashAccountWithTransactionsAction(id: string, locationId: string, deleteTransactions: boolean) {\r\n    try {\r\n        await db.$transaction(async (tx: any) => {\r\n            if (deleteTransactions) {\r\n                await tx.cashTransaction.deleteMany({\r\n                    where: { accountId: id, branchId: locationId }\r\n                });\r\n                await tx.expense.updateMany({\r\n                    where: { cashAccountId: id, branchId: locationId },\r\n                    data: { cashAccountId: null, cashTransactionId: null }\r\n                });\r\n            } else {\r\n                await tx.cashTransaction.updateMany({\r\n                    where: { accountId: id, branchId: locationId },\r\n                    data: { accountId: null }\r\n                });\r\n                await tx.expense.updateMany({\r\n                    where: { cashAccountId: id, branchId: locationId },\r\n                    data: { cashAccountId: null, cashTransactionId: null }\r\n                });\r\n            }\r\n\r\n            await tx.cashAccount.delete({\r\n                where: { id, branchId: locationId }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting cash account with transactions:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getCashAccountBalanceAction(accountId: string, locationId: string) {\r\n    try {\r\n        const account = await db.cashAccount.findUnique({\r\n            where: { id: accountId },\r\n            select: { initialBalance: true }\r\n        });\r\n\r\n        if (!account) return { success: false, error: 'Account not found' };\r\n\r\n        const transactions = await db.cashTransaction.findMany({\r\n            where: { accountId, branchId: locationId },\r\n            select: { amount: true, transactionType: true }\r\n        });\r\n\r\n        let balance = Number(account.initialBalance);\r\n        for (const tx of transactions) {\r\n            const amount = Number(tx.amount);\r\n            if (tx.transactionType === 'cash_in' || tx.transactionType === 'transfer_in') {\r\n                balance += amount;\r\n            } else if (tx.transactionType === 'cash_out' || tx.transactionType === 'transfer_out') {\r\n                balance -= amount;\r\n            }\r\n        }\r\n\r\n        return { success: true, data: balance };\r\n    } catch (error: any) {\r\n        console.error('Error calculating account balance:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n// --- CASH TRANSACTIONS ---\r\n\r\nexport async function getCashTransactionsAction(locationId: string, accountId?: string) {\r\n    try {\r\n        const where: any = { branchId: locationId };\r\n        if (accountId) where.accountId = accountId;\r\n\r\n        const transactions = await db.cashTransaction.findMany({\r\n            where,\r\n            orderBy: [{ date: 'desc' }, { createdAt: 'desc' }]\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: transactions.map((t: any) => ({\r\n                ...t,\r\n                created_at: t.createdAt.toISOString(),\r\n                updated_at: t.updatedAt.toISOString(),\r\n                user_id: t.userId,\r\n                account_id: t.accountId,\r\n                location_id: t.locationId,\r\n                transaction_type: t.transactionType,\r\n                person_in_charge: t.personInCharge,\r\n                payment_method: t.paymentMethod,\r\n                receipt_image: t.receiptImage\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching cash transactions:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createCashTransactionAction(data: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx: any) => {\r\n            if (data.transactionType === 'transfer' && data.toAccountId) {\r\n                const txOut = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.accountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'transfer_out',\r\n                        description: data.description,\r\n                        date: data.date ? new Date(data.date) : new Date(),\r\n                        category: data.category || 'Transfer'\r\n                    }\r\n                });\r\n\r\n                const txIn = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.toAccountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'transfer_in',\r\n                        description: data.description,\r\n                        date: data.date ? new Date(data.date) : new Date(),\r\n                        category: data.category || 'Transfer'\r\n                    }\r\n                });\r\n\r\n                return [txOut, txIn];\r\n            } else {\r\n                const transaction = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        branchId: data.locationId,\r\n                        accountId: data.accountId,\r\n                        amount: data.amount,\r\n                        transactionType: data.transactionType,\r\n                        category: data.category,\r\n                        description: data.description,\r\n                        personInCharge: data.personInCharge,\r\n                        tags: data.tags,\r\n                        date: data.date ? new Date(data.date) : new Date(),\r\n                        paymentMethod: data.paymentMethod,\r\n                        receiptImage: data.receiptImage\r\n                    }\r\n                });\r\n                return transaction;\r\n            }\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating cash transaction:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function updateCashTransactionAction(id: string, updates: any) {\r\n    try {\r\n        const result = await db.cashTransaction.update({\r\n            where: { id },\r\n            data: {\r\n                accountId: updates.accountId,\r\n                amount: updates.amount,\r\n                transactionType: updates.transactionType,\r\n                category: updates.category,\r\n                description: updates.description,\r\n                personInCharge: updates.personInCharge,\r\n                tags: updates.tags,\r\n                date: updates.date ? new Date(updates.date) : undefined,\r\n                paymentMethod: updates.paymentMethod,\r\n                receiptImage: updates.receiptImage\r\n            }\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error updating cash transaction:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function findCashTransactionAction(id: string) {\r\n    try {\r\n        const transaction = await db.cashTransaction.findUnique({\r\n            where: { id },\r\n            select: { accountId: true }\r\n        });\r\n\r\n        return { success: true, data: transaction };\r\n    } catch (error: any) {\r\n        console.error('Error finding cash transaction:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteCashTransactionAction(id: string, locationId: string) {\r\n    try {\r\n        await db.$transaction(async (tx: any) => {\r\n            await tx.installmentPayment.updateMany({\r\n                where: { cashTransactionId: id },\r\n                data: { cashTransactionId: null }\r\n            });\r\n\r\n            await tx.cashTransaction.delete({\r\n                where: { id, branchId: locationId }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting cash transaction:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getAccountOpeningBalanceAction(accountId: string, locationId: string) {\r\n    try {\r\n        const account = await db.cashAccount.findFirst({\r\n            where: { id: accountId, branchId: locationId },\r\n            select: { initialBalance: true }\r\n        });\r\n\r\n        return { success: true, data: Number(account?.initialBalance || 0) };\r\n    } catch (error: any) {\r\n        console.error('Error fetching opening balance:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createBulkCashTransactionsAction(transactions: any[]) {\r\n    try {\r\n        const result = await db.$transaction(async (tx: any) => {\r\n            const created = [];\r\n            for (const data of transactions) {\r\n                if (data.transactionType === 'transfer' && data.toAccountId) {\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            branchId: data.locationId,\r\n                            accountId: data.accountId,\r\n                            amount: data.amount,\r\n                            transactionType: 'transfer_out',\r\n                            description: data.description,\r\n                            date: data.date ? new Date(data.date) : new Date(),\r\n                            category: data.category || 'Transfer'\r\n                        }\r\n                    }));\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            branchId: data.locationId,\r\n                            accountId: data.toAccountId,\r\n                            amount: data.amount,\r\n                            transactionType: 'transfer_in',\r\n                            description: data.description,\r\n                            date: data.date ? new Date(data.date) : new Date(),\r\n                            category: data.category || 'Transfer'\r\n                        }\r\n                    }));\r\n                } else {\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            branchId: data.locationId,\r\n                            accountId: data.accountId,\r\n                            amount: data.amount,\r\n                            transactionType: data.transactionType,\r\n                            category: data.category,\r\n                            description: data.description,\r\n                            personInCharge: data.personInCharge,\r\n                            tags: data.tags,\r\n                            date: data.date ? new Date(data.date) : new Date(),\r\n                            paymentMethod: data.paymentMethod,\r\n                            receiptImage: data.receiptImage\r\n                        }\r\n                    }));\r\n                }\r\n            }\r\n            return created;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating bulk transactions:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n","'use server';\r\n\r\nimport { db, ActivityType, ActivityModule } from '../../../prisma/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nexport interface ActivityLogInput {\r\n    userId: string;\r\n    locationId: string;\r\n    activityType: ActivityType;\r\n    module: ActivityModule;\r\n    entityType: string;\r\n    entityId?: string;\r\n    entityName: string;\r\n    description: string;\r\n    metadata?: any;\r\n    profileId?: string;\r\n    profileName?: string;\r\n}\r\n\r\nexport async function logActivityAction(data: ActivityLogInput) {\r\n    try {\r\n        await db.activityHistory.create({\r\n            data: {\r\n                userId: data.userId,\r\n                locationId: data.locationId,\r\n                activityType: data.activityType,\r\n                module: data.module,\r\n                entityType: data.entityType,\r\n                entityId: data.entityId || null,\r\n                entityName: data.entityName,\r\n                description: data.description,\r\n                metadata: data.metadata || null,\r\n                profileId: data.profileId || null,\r\n                profileName: data.profileName || null\r\n            }\r\n        });\r\n\r\n        // revalidatePath('/history'); // Typically history page might need refresh\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error logging activity:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport interface ActivityFilters {\r\n    activityType?: string;\r\n    module?: string;\r\n    search?: string;\r\n    dateFrom?: string;\r\n    dateTo?: string;\r\n}\r\n\r\nexport async function getActivityHistoryAction(\r\n    locationId: string,\r\n    userId: string,\r\n    page: number = 1,\r\n    pageSize: number = 20,\r\n    filters?: ActivityFilters\r\n) {\r\n    try {\r\n        const skip = (page - 1) * pageSize;\r\n\r\n        const where: any = {\r\n            locationId,\r\n            userId\r\n        };\r\n\r\n        if (filters) {\r\n            if (filters.activityType && filters.activityType !== 'ALL') {\r\n                where.activityType = filters.activityType;\r\n            }\r\n            if (filters.module && filters.module !== 'ALL') {\r\n                where.module = filters.module;\r\n            }\r\n            if (filters.search) {\r\n                where.OR = [\r\n                    { entityName: { contains: filters.search, mode: 'insensitive' } },\r\n                    { description: { contains: filters.search, mode: 'insensitive' } }\r\n                ];\r\n            }\r\n            if (filters.dateFrom || filters.dateTo) {\r\n                where.createdAt = {};\r\n                if (filters.dateFrom) {\r\n                    where.createdAt.gte = new Date(filters.dateFrom);\r\n                }\r\n                if (filters.dateTo) {\r\n                    const toDate = new Date(filters.dateTo);\r\n                    toDate.setHours(23, 59, 59, 999);\r\n                    where.createdAt.lte = toDate;\r\n                }\r\n            }\r\n        }\r\n\r\n        const [activities, count] = await Promise.all([\r\n            db.activityHistory.findMany({\r\n                where,\r\n                skip,\r\n                take: pageSize,\r\n                orderBy: {\r\n                    createdAt: 'desc'\r\n                }\r\n            }),\r\n            db.activityHistory.count({ where })\r\n        ]);\r\n\r\n        return {\r\n            success: true,\r\n            data: {\r\n                activities: activities.map((a: any) => ({\r\n                    ...a,\r\n                    created_at: a.createdAt.toISOString(), // Map back to shape expected by hook\r\n                    activity_type: a.activityType,\r\n                    location_id: a.locationId,\r\n                    user_id: a.userId,\r\n                    entity_type: a.entityType,\r\n                    entity_id: a.entityId,\r\n                    entity_name: a.entityName,\r\n                    profile_id: a.profileId,\r\n                    profile_name: a.profileName\r\n                })),\r\n                count\r\n            }\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching activity history:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getActivityHistoryByTypeAction(locationId: string, module: string, activityType: string) {\r\n    try {\r\n        const records = await db.activityHistory.findMany({\r\n            where: { locationId, module: module as any, activityType: activityType as any },\r\n            orderBy: { createdAt: 'desc' }\r\n        });\r\n        return {\r\n            success: true,\r\n            data: records.map((a: any) => ({\r\n                ...a,\r\n                createdAt: a.createdAt.toISOString(),\r\n                profileName: a.profileName\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching activity history by type:', error);\r\n        return { success: false, error: error.message, data: [] };\r\n    }\r\n}\r\n"],"names":[],"mappings":"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"}