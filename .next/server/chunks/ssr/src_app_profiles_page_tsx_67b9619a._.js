module.exports=[726842,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(591119),e=a.i(699570),f=a.i(786304),g=a.i(335732),h=a.i(890914),i=a.i(417755),j=a.i(992258),k=a.i(963519),l=a.i(824569),m=a.i(781560),n=a.i(46864);let o=(0,a.i(170106).default)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),p=({profile:a,onEdit:c,onDelete:p,canManage:q=!0})=>{let{toggleProfileStatus:r,currentProfile:s}=(0,h.useProfiles)(),t=async()=>{q&&await r(a.id,!a.is_active)},u=s?.id===a.id;return(0,b.jsxs)(d.Card,{className:`relative ${!a.is_active?"opacity-60":""}`,children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-start justify-between space-y-0 pb-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg",children:a.profile_name}),(0,b.jsx)(f.Badge,{variant:(a=>{switch(a.toLowerCase()){case"owner":return"default";case"manager":return"secondary";default:return"outline"}})(a.role),className:"mt-1",children:a.role}),u&&(0,b.jsx)(f.Badge,{variant:"outline",className:"ml-2 text-[10px] bg-blue-50 text-blue-600 border-blue-100",children:"You"})]}),q&&(0,b.jsxs)(g.DropdownMenu,{children:[(0,b.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,b.jsx)(i.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(g.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(g.DropdownMenuItem,{onClick:c,children:[(0,b.jsx)(l.Edit,{className:"h-4 w-4 mr-2"}),"Edit Profile"]}),(0,b.jsx)(g.DropdownMenuItem,{onClick:t,children:a.is_active?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o,{className:"h-4 w-4 mr-2"}),"Deactivate"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.UserCheck,{className:"h-4 w-4 mr-2"}),"Activate"]})}),(0,b.jsxs)(g.DropdownMenuItem,{onClick:p,className:"text-destructive focus:text-destructive",children:[(0,b.jsx)(m.Trash2,{className:"h-4 w-4 mr-2"}),"Delete Profile"]})]})]})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)(j.Mail,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground",children:a.email})]}),a.phone_number&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)(k.Phone,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground",children:a.phone_number})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground pt-2 border-t",children:[(0,b.jsxs)("span",{children:["Created ",new Date(a.created_at).toLocaleDateString()]}),(0,b.jsx)(f.Badge,{variant:a.is_active?"default":"secondary",className:"text-xs",children:a.is_active?"Active":"Inactive"})]})]})]})},q=({profiles:a,onEditProfile:c,onDeleteProfile:d,canManage:e=!0})=>(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(a=>(0,b.jsx)(p,{profile:a,onEdit:()=>c(a),onDelete:()=>d(a),canManage:e},a.id))});var r=a.i(333140);let s=()=>(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((a,c)=>(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-start justify-between space-y-0 pb-3",children:[(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)(r.Skeleton,{className:"h-5 w-32"}),(0,b.jsx)(r.Skeleton,{className:"h-4 w-16"})]}),(0,b.jsx)(r.Skeleton,{className:"h-8 w-8"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.Skeleton,{className:"h-4 w-4"}),(0,b.jsx)(r.Skeleton,{className:"h-4 w-40"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.Skeleton,{className:"h-4 w-4"}),(0,b.jsx)(r.Skeleton,{className:"h-4 w-32"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,b.jsx)(r.Skeleton,{className:"h-3 w-24"}),(0,b.jsx)(r.Skeleton,{className:"h-4 w-12"})]})]})]},c))});var t=a.i(660246);let u=()=>(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardContent,{className:"flex flex-col items-center justify-center py-12",children:[(0,b.jsx)(t.Users,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No Profiles Yet"}),(0,b.jsx)("p",{className:"text-muted-foreground text-center max-w-md",children:"Create profiles for individuals using your business account. Each profile can track their activities separately."})]})}),v=({profiles:a,isLoading:c,onEditProfile:d,onDeleteProfile:e,canManage:f=!0})=>c?(0,b.jsx)(s,{}):0===a.length?(0,b.jsx)(u,{}):(0,b.jsx)(q,{profiles:a,onEditProfile:d,onDeleteProfile:e,canManage:f});var w=a.i(915618);let x=({profilesCount:a,onNewProfile:c,canManage:d=!0})=>(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold text-foreground flex items-center gap-2",children:[(0,b.jsx)(t.Users,{className:"h-8 w-8"}),"Profiles"]}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Manage individual user profiles for your business â€¢ ",a," profile",1!==a?"s":""]})]}),d&&(0,b.jsxs)(e.Button,{onClick:c,className:"gap-2",children:[(0,b.jsx)(w.Plus,{className:"h-4 w-4"}),"New Profile"]})]});var y=a.i(814574),z=a.i(866718),A=a.i(870430),B=a.i(580701),C=a.i(169819),D=a.i(405050);let E=(0,D.createServerReference)("4052909717fb7c5829a34f18b1cedd1784304b0419",D.callServer,void 0,D.findSourceMapURL,"getRolesAction"),F=({open:a,onOpenChange:d})=>{let{currentBusiness:f}=(0,C.useBusiness)(),{createProfile:g,profiles:i}=(0,h.useProfiles)(),[j,k]=(0,c.useState)({profile_name:"",email:"",phone_number:"",role:"staff",role_id:""}),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!1);c.default.useEffect(()=>{a&&f?.id&&p()},[a,f?.id]);let p=async()=>{try{if(f?.id){let a=await E(f.id);m(a)}}catch(a){console.error(a)}0===i.length&&k(a=>({...a,role:"owner",role_id:null}))},q=async a=>{a.preventDefault(),o(!0);try{await g({profile_name:j.profile_name.trim(),email:j.email.trim(),phone_number:j.phone_number.trim()||void 0,role:j.role,role_id:j.role_id||null,pin:"0000",is_active:!0})&&(k({profile_name:"",email:"",phone_number:"",role:"staff",role_id:null}),d(!1))}finally{o(!1)}},r=(a,b)=>{k(c=>({...c,[a]:b}))};return(0,b.jsx)(y.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(y.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsx)(y.DialogHeader,{children:(0,b.jsx)(y.DialogTitle,{children:"Create New Profile"})}),(0,b.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"profile_name",children:"Profile Name"}),(0,b.jsx)(z.Input,{id:"profile_name",value:j.profile_name,onChange:a=>r("profile_name",a.target.value),placeholder:"Enter profile name",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"email",children:"Email"}),(0,b.jsx)(z.Input,{id:"email",type:"email",value:j.email,onChange:a=>r("email",a.target.value),placeholder:"Enter email address",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"phone_number",children:"Phone Number (Optional)"}),(0,b.jsx)(z.Input,{id:"phone_number",value:j.phone_number,onChange:a=>r("phone_number",a.target.value),placeholder:"Enter phone number"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"role",children:"Role"}),(0,b.jsxs)(B.Select,{value:j.role_id||j.role,onValueChange:a=>{let b=l.find(b=>b.id===a);b?k(c=>({...c,role_id:a,role:b.name})):k(b=>({...b,role_id:null,role:a}))},disabled:0===i.length,children:[(0,b.jsx)(B.SelectTrigger,{children:(0,b.jsx)(B.SelectValue,{placeholder:"Select role"})}),(0,b.jsx)(B.SelectContent,{children:l.length>0?l.map(a=>(0,b.jsx)(B.SelectItem,{value:a.id,children:a.name},a.id)):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(B.SelectItem,{value:"owner",children:"Owner"}),(0,b.jsx)(B.SelectItem,{value:"manager",children:"Manager"}),(0,b.jsx)(B.SelectItem,{value:"staff",children:"Staff"})]})})]}),0===i.length&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"First profile must be the Owner."})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>d(!1),disabled:n,children:"Cancel"}),(0,b.jsx)(e.Button,{type:"submit",disabled:n,children:n?"Creating...":"Create Profile"})]})]})]})})};var G=a.i(943108),H=a.i(823292);let I=({profile:a,open:d,onOpenChange:f})=>{let{currentBusiness:g}=(0,C.useBusiness)(),{updateProfile:i,resetProfilePin:j}=(0,h.useProfiles)(),[k,l]=(0,c.useState)({profile_name:"",email:"",phone_number:"",role:"staff",role_id:""}),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)("");(0,c.useEffect)(()=>{d&&g?.id&&u()},[d,g?.id]);let u=async()=>{try{if(g?.id){let a=await E(g.id);n(a)}}catch(a){console.error(a)}};(0,c.useEffect)(()=>{a&&l({profile_name:a.profile_name,email:a.email,phone_number:a.phone_number||"",role:a.role,role_id:a.role_id})},[a]);let v=async b=>{if(b.preventDefault(),a){p(!0);try{await i(a.id,{profile_name:k.profile_name.trim(),email:k.email.trim(),phone_number:k.phone_number.trim()||void 0,role:k.role,role_id:k.role_id||null})&&f(!1)}finally{p(!1)}}},w=async()=>{if(a&&s){if(4!==s.length||!/^\d+$/.test(s))return void H.toast.error("PIN must be 4 digits");p(!0);try{await j(a.id,s)&&(r(!1),t(""))}finally{p(!1)}}},x=(a,b)=>{l(c=>({...c,[a]:b}))};return a?(0,b.jsx)(y.Dialog,{open:d,onOpenChange:f,children:(0,b.jsxs)(y.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsx)(y.DialogHeader,{children:(0,b.jsx)(y.DialogTitle,{children:"Edit Profile"})}),(0,b.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"edit_profile_name",children:"Profile Name"}),(0,b.jsx)(z.Input,{id:"edit_profile_name",value:k.profile_name,onChange:a=>x("profile_name",a.target.value),placeholder:"Enter profile name",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"edit_email",children:"Email"}),(0,b.jsx)(z.Input,{id:"edit_email",type:"email",value:k.email,onChange:a=>x("email",a.target.value),placeholder:"Enter email address",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"edit_phone_number",children:"Phone Number (Optional)"}),(0,b.jsx)(z.Input,{id:"edit_phone_number",value:k.phone_number,onChange:a=>x("phone_number",a.target.value),placeholder:"Enter phone number"})]}),"owner"!==a.role.toLowerCase()&&a.business_role?.name!=="Owner"&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"edit_role",children:"Role"}),(0,b.jsxs)(B.Select,{value:k.role_id||k.role,onValueChange:a=>{let b=m.find(b=>b.id===a);b?l(c=>({...c,role_id:a,role:b.name})):l(b=>({...b,role_id:null,role:a}))},children:[(0,b.jsx)(B.SelectTrigger,{children:(0,b.jsx)(B.SelectValue,{placeholder:"Select role"})}),(0,b.jsx)(B.SelectContent,{children:m.length>0?m.map(a=>(0,b.jsx)(B.SelectItem,{value:a.id,children:a.name},a.id)):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(B.SelectItem,{value:"owner",children:"Owner"}),(0,b.jsx)(B.SelectItem,{value:"manager",children:"Manager"}),(0,b.jsx)(B.SelectItem,{value:"staff",children:"Staff"})]})})]})]}),(0,b.jsx)("div",{className:"border-t pt-4 mt-4",children:q?(0,b.jsxs)("div",{className:"space-y-3 p-3 bg-amber-50 rounded-lg border border-amber-100",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(A.Label,{htmlFor:"new_pin",children:"New 4-Digit PIN"}),(0,b.jsx)(z.Input,{id:"new_pin",type:"password",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:s,onChange:a=>t(a.target.value),placeholder:"Enter new PIN"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{type:"button",variant:"ghost",className:"flex-1",onClick:()=>{r(!1),t("")},children:"Cancel"}),(0,b.jsx)(e.Button,{type:"button",variant:"default",className:"flex-1 bg-amber-600 hover:bg-amber-700",onClick:w,disabled:o||4!==s.length,children:"Confirm Reset"})]})]}):(0,b.jsxs)(e.Button,{type:"button",variant:"outline",className:"w-full gap-2 text-amber-600 border-amber-200 hover:bg-amber-50",onClick:()=>r(!0),children:[(0,b.jsx)(G.Lock,{size:16})," Reset Profile PIN"]})}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>f(!1),disabled:o,children:"Cancel"}),(0,b.jsx)(e.Button,{type:"submit",disabled:o,children:o?"Updating...":"Update Profile"})]})]})]})}):null};var J=a.i(486192);let K=({profile:a,open:d,onOpenChange:e})=>{let{deleteProfile:f}=(0,h.useProfiles)(),[g,i]=(0,c.useState)(!1),j=async()=>{if(a){i(!0);try{await f(a.id)&&e(!1)}finally{i(!1)}}};return a?(0,b.jsx)(J.AlertDialog,{open:d,onOpenChange:e,children:(0,b.jsxs)(J.AlertDialogContent,{children:[(0,b.jsxs)(J.AlertDialogHeader,{children:[(0,b.jsx)(J.AlertDialogTitle,{children:"Delete Profile"}),(0,b.jsxs)(J.AlertDialogDescription,{children:['Are you sure you want to delete the profile "',a.profile_name,'"? This action cannot be undone. All activity history associated with this profile will remain but will no longer be linked to a profile.']})]}),(0,b.jsxs)(J.AlertDialogFooter,{children:[(0,b.jsx)(J.AlertDialogCancel,{disabled:g,children:"Cancel"}),(0,b.jsx)(J.AlertDialogAction,{onClick:j,disabled:g,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:g?"Deleting...":"Delete Profile"})]})]})}):null};var L=a.i(875083);let M=(0,D.createServerReference)("60fb2389f1a7f9190d01c7bd2da1f5e38add1594cd",D.callServer,void 0,D.findSourceMapURL,"upsertRoleAction"),N=(0,D.createServerReference)("4051b0115f438ba3dd6196d0c8dbb545e2e4fbd8c4",D.callServer,void 0,D.findSourceMapURL,"deleteRoleAction");var O=a.i(315055),P=a.i(603314),Q=a.i(510448),R=a.i(533441),S=a.i(633508);let T=[{id:"sales",name:"Sales",actions:["view","create","edit","delete","refund"]},{id:"inventory",name:"Inventory",actions:["view","create","edit","delete","stock_adjustment","view_cost_price","view_profit","view_selling_price"]},{id:"finance",name:"Finance",actions:["view","create","edit","manage_accounts"]},{id:"customers",name:"Customers",actions:["view","create","edit","delete","manage"]},{id:"messages",name:"Messages",actions:["view","create","edit","delete","send"]},{id:"tasks",name:"Tasks",actions:["view","create","edit","delete","manage"]},{id:"profiles",name:"Profiles",actions:["view","manage"]},{id:"settings",name:"Settings",actions:["view","manage"]},{id:"expenses",name:"Expenses",actions:["view","create","edit","delete"]},{id:"dashboard",name:"Dashboard",actions:["view","view_total_sales","view_gross_profit","view_total_expenses","view_inventory_value","view_sales_types","view_avg_price","view_total_amount"]}],U=()=>{let{currentBusiness:a}=(0,C.useBusiness)(),{hasPermission:f,loadProfiles:g}=(0,h.useProfiles)(),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(!0),[n,o]=(0,c.useState)(null);(0,c.useEffect)(()=>{p()},[a?.id]);let p=async()=>{if(a?.id){l(!0);try{let b=await E(a.id);j(b)}catch(a){console.error("Error loading roles:",a),H.toast.error("Failed to load roles")}finally{l(!1)}}},q=async()=>{if(a?.id&&n?.name)try{let b={id:n.id,business_location_id:a.id,name:n.name,description:n.description||null,permissions:n.permissions||{}},c=await M(a.id,b);if(!c.success)throw Error(c.error);H.toast.success(n.id?"Role updated":"Role created"),o(null),await p(),await g()}catch(a){console.error("Error saving role:",a),H.toast.error("Failed to save role")}},r=async a=>{if(confirm("Are you sure you want to delete this role? Profiles assigned to this role will lose their special permissions."))try{let b=await N(a);if(!b.success)throw Error(b.error);H.toast.success("Role deleted"),await p(),await g()}catch(a){console.error("Error deleting role:",a),H.toast.error("Failed to delete role")}};return f("profiles","manage")?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-medium",children:"Roles & Permissions"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage roles and what each profile can access."})]}),!n&&(0,b.jsxs)(e.Button,{onClick:()=>o({name:"",permissions:{}}),className:"gap-2",children:[(0,b.jsx)(w.Plus,{className:"h-4 w-4"}),"New Role"]})]}),n?(0,b.jsxs)(d.Card,{className:"border-primary/20",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:n.id?"Edit Role":"Create New Role"}),(0,b.jsx)(d.CardDescription,{children:"Define the name and permissions for this role."})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"role-name",children:"Role Name"}),(0,b.jsx)(z.Input,{id:"role-name",value:n.name,onChange:a=>o({...n,name:a.target.value}),placeholder:"e.g. Sales Associate"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"role-desc",children:"Description"}),(0,b.jsx)(z.Input,{id:"role-desc",value:n.description||"",onChange:a=>o({...n,description:a.target.value}),placeholder:"Brief description of the role's purpose"})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(A.Label,{children:"Permissions"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 border rounded-lg p-4 bg-muted/30",children:T.map(a=>(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"font-semibold text-sm flex items-center gap-2 border-b pb-1",children:[(0,b.jsx)(P.Shield,{className:"h-3 w-3 text-primary"}),a.name]}),(0,b.jsx)("div",{className:"grid grid-cols-1 gap-2",children:a.actions.map(c=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(O.Checkbox,{id:`${a.id}-${c}`,checked:(n.permissions?.[a.id]||[]).includes(c),onCheckedChange:()=>((a,b)=>{if(!n)return;let c={...n.permissions||{}},d=[...c[a]||[]];d.includes(b)?c[a]=d.filter(a=>a!==b):c[a]=[...d,b],o({...n,permissions:c})})(a.id,c)}),(0,b.jsx)(A.Label,{htmlFor:`${a.id}-${c}`,className:"text-xs capitalize font-normal cursor-pointer",children:c.replace("_"," ")})]},c))})]},a.id))})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,b.jsxs)(e.Button,{variant:"outline",onClick:()=>o(null),className:"gap-2",children:[(0,b.jsx)(S.X,{className:"h-4 w-4"})," Cancel"]}),(0,b.jsxs)(e.Button,{onClick:q,className:"gap-2",children:[(0,b.jsx)(R.Check,{className:"h-4 w-4"})," ",n.id?"Update Role":"Create Role"]})]})]})]}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k?(0,b.jsx)("p",{children:"Loading roles..."}):0===i.length?(0,b.jsx)("p",{className:"text-muted-foreground col-span-full text-center py-8",children:"No custom roles created yet."}):i.map(a=>(0,b.jsxs)(d.Card,{className:"group hover:border-primary/50 transition-colors",children:[(0,b.jsxs)(d.CardHeader,{className:"pb-2",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:a.name}),(0,b.jsxs)("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>o(a),children:(0,b.jsx)(Q.Edit2,{className:"h-4 w-4"})}),(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>r(a.id),children:(0,b.jsx)(m.Trash2,{className:"h-4 w-4"})})]})]}),(0,b.jsx)(d.CardDescription,{className:"line-clamp-1",children:a.description||"No description"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[Object.keys(a.permissions).slice(0,4).map(a=>(0,b.jsx)("span",{className:"text-[10px] bg-primary/10 text-primary px-2 py-0.5 rounded-full capitalize",children:a},a)),Object.keys(a.permissions).length>4&&(0,b.jsxs)("span",{className:"text-[10px] bg-muted text-muted-foreground px-2 py-0.5 rounded-full",children:["+",Object.keys(a.permissions).length-4," more"]})]})})]},a.id))})]}):(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"p-6 text-center text-muted-foreground",children:"You do not have permission to manage roles."})})};var V=a.i(104416);let W=()=>{let{currentProfile:a,changePin:f}=(0,h.useProfiles)(),[g,i]=(0,c.useState)({oldPin:"",newPin:"",confirmPin:""}),[j,k]=(0,c.useState)(!1);if(!a)return null;let l=async a=>{if(a.preventDefault(),g.newPin!==g.confirmPin)return void H.toast.error("New PINs do not match");if(4!==g.newPin.length||!/^\d+$/.test(g.newPin))return void H.toast.error("PIN must be exactly 4 digits");k(!0);try{await f(g.oldPin,g.newPin)&&i({oldPin:"",newPin:"",confirmPin:""})}finally{k(!1)}};return(0,b.jsxs)("div",{className:"max-w-md mx-auto space-y-6",children:[(0,b.jsxs)(d.Card,{className:"border-primary/20 shadow-sm",children:[(0,b.jsxs)(d.CardHeader,{className:"text-center",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2",children:(0,b.jsx)(G.Lock,{className:"h-6 w-6 text-primary"})}),(0,b.jsx)(d.CardTitle,{children:"Change Your PIN"}),(0,b.jsxs)(d.CardDescription,{children:["Profiles default to ",(0,b.jsx)("span",{className:"font-mono font-bold text-foreground",children:"0000"}),". We recommend changing it for security."]})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("form",{onSubmit:l,className:"space-y-4",autoComplete:"off",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"oldPin",children:"Current PIN"}),(0,b.jsx)(z.Input,{id:"oldPin",type:"password",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:g.oldPin,onChange:a=>i({...g,oldPin:a.target.value}),placeholder:"0000",required:!0,autoComplete:"off"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"newPin",children:"New 4-Digit PIN"}),(0,b.jsx)(z.Input,{id:"newPin",type:"password",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:g.newPin,onChange:a=>i({...g,newPin:a.target.value}),placeholder:"Enter new PIN",required:!0,autoComplete:"new-password"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(A.Label,{htmlFor:"confirmPin",children:"Confirm New PIN"}),(0,b.jsx)(z.Input,{id:"confirmPin",type:"password",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:g.confirmPin,onChange:a=>i({...g,confirmPin:a.target.value}),placeholder:"Confirm new PIN",required:!0,autoComplete:"new-password"})]}),(0,b.jsx)(e.Button,{type:"submit",className:"w-full gap-2",disabled:j,children:j?"Updating...":(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(V.ShieldCheck,{className:"h-4 w-4"}),"Update PIN"]})})]})})]}),(0,b.jsxs)(d.Card,{className:"border-muted bg-muted/20",children:[(0,b.jsx)(d.CardHeader,{className:"pb-2",children:(0,b.jsxs)(d.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(R.Check,{className:"h-4 w-4 text-green-600"})," Security Tip"]})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Avoid simple patterns like 1234 or your birth year. Your PIN is required whenever you switch to this profile."})})]})]})};a.s(["default",0,()=>{let{currentBusiness:a}=(0,C.useBusiness)(),{profiles:d,isLoading:e,hasPermission:f}=(0,h.useProfiles)(),g=f("profiles","manage"),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(null);return a?(0,b.jsxs)("div",{className:"space-y-6 p-6",children:[(0,b.jsxs)(L.Tabs,{defaultValue:"profiles",className:"w-full",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4 border-b pb-4",children:[(0,b.jsxs)(L.TabsList,{className:"bg-muted/50",children:[(0,b.jsxs)(L.TabsTrigger,{value:"profiles",className:"gap-2",children:[(0,b.jsx)(t.Users,{className:"h-4 w-4"}),"Profiles"]}),f("profiles","manage")&&(0,b.jsxs)(L.TabsTrigger,{value:"roles",className:"gap-2",children:[(0,b.jsx)(P.Shield,{className:"h-4 w-4"}),"Roles"]}),(0,b.jsxs)(L.TabsTrigger,{value:"security",className:"gap-2",children:[(0,b.jsx)(G.Lock,{className:"h-4 w-4"}),"Security"]})]}),(0,b.jsx)("div",{className:"hidden sm:block",children:(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Current Business: ",(0,b.jsx)("span",{className:"font-semibold text-foreground",children:a.name})]})})]}),(0,b.jsxs)(L.TabsContent,{value:"profiles",className:"space-y-6 mt-0",children:[(0,b.jsx)(x,{profilesCount:d.length,onNewProfile:()=>j(!0),canManage:g}),(0,b.jsx)(v,{profiles:d,isLoading:e,onEditProfile:l,onDeleteProfile:n,canManage:g})]}),(0,b.jsx)(L.TabsContent,{value:"roles",className:"mt-0",children:(0,b.jsx)(U,{})}),(0,b.jsx)(L.TabsContent,{value:"security",className:"mt-0",children:(0,b.jsx)(W,{})})]}),(0,b.jsx)(F,{open:i,onOpenChange:j}),(0,b.jsx)(I,{profile:k,open:!!k,onOpenChange:a=>!a&&l(null)}),(0,b.jsx)(K,{profile:m,open:!!m,onOpenChange:a=>!a&&n(null)})]}):(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-muted-foreground",children:"No Business Selected"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Please select a business to manage profiles."})]})})}],726842)}];

//# sourceMappingURL=src_app_profiles_page_tsx_67b9619a._.js.map