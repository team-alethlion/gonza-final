module.exports=[491735,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={assign:function(){return i},searchParamsToUrlQuery:function(){return f},urlQueryToSearchParams:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){let b={};for(let[c,d]of a.entries()){let a=b[c];void 0===a?b[c]=d:Array.isArray(a)?a.push(d):b[c]=[a,d]}return b}function g(a){return"string"==typeof a?a:("number"!=typeof a||isNaN(a))&&"boolean"!=typeof a?"":String(a)}function h(a){let b=new URLSearchParams;for(let[c,d]of Object.entries(a))if(Array.isArray(d))for(let a of d)b.append(c,g(a));else b.set(c,g(d));return b}function i(a,...b){for(let c of b){for(let b of c.keys())a.delete(b);for(let[b,d]of c.entries())a.append(b,d)}return a}},143087,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={formatUrl:function(){return h},formatWithValidation:function(){return j},urlObjectKeys:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(346058)._(a.r(491735)),g=/https?|ftp|gopher|file/;function h(a){let{auth:b,hostname:c}=a,d=a.protocol||"",e=a.pathname||"",h=a.hash||"",i=a.query||"",j=!1;b=b?encodeURIComponent(b).replace(/%3A/i,":")+"@":"",a.host?j=b+a.host:c&&(j=b+(~c.indexOf(":")?`[${c}]`:c),a.port&&(j+=":"+a.port)),i&&"object"==typeof i&&(i=String(f.urlQueryToSearchParams(i)));let k=a.search||i&&`?${i}`||"";return d&&!d.endsWith(":")&&(d+=":"),a.slashes||(!d||g.test(d))&&!1!==j?(j="//"+(j||""),e&&"/"!==e[0]&&(e="/"+e)):j||(j=""),h&&"#"!==h[0]&&(h="#"+h),k&&"?"!==k[0]&&(k="?"+k),e=e.replace(/[?#]/g,encodeURIComponent),k=k.replace("#","%23"),`${d}${j}${e}${k}${h}`}let i=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function j(a){return h(a)}},808591,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"useMergedRef",{enumerable:!0,get:function(){return e}});let d=a.r(572131);function e(a,b){let c=(0,d.useRef)(null),e=(0,d.useRef)(null);return(0,d.useCallback)(d=>{if(null===d){let a=c.current;a&&(c.current=null,a());let b=e.current;b&&(e.current=null,b())}else a&&(c.current=f(a,d)),b&&(e.current=f(b,d))},[a,b])}function f(a,b){if("function"!=typeof a)return a.current=b,()=>{a.current=null};{let c=a(b);return"function"==typeof c?c:()=>a(null)}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},946272,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DecodeError:function(){return r},MiddlewareNotFoundError:function(){return v},MissingStaticPage:function(){return u},NormalizeError:function(){return s},PageNotFoundError:function(){return t},SP:function(){return p},ST:function(){return q},WEB_VITALS:function(){return f},execOnce:function(){return g},getDisplayName:function(){return l},getLocationOrigin:function(){return j},getURL:function(){return k},isAbsoluteUrl:function(){return i},isResSent:function(){return m},loadGetInitialProps:function(){return o},normalizeRepeatedSlashes:function(){return n},stringifyError:function(){return w}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=["CLS","FCP","FID","INP","LCP","TTFB"];function g(a){let b,c=!1;return(...d)=>(c||(c=!0,b=a(...d)),b)}let h=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,i=a=>h.test(a);function j(){let{protocol:a,hostname:b,port:c}=window.location;return`${a}//${b}${c?":"+c:""}`}function k(){let{href:a}=window.location,b=j();return a.substring(b.length)}function l(a){return"string"==typeof a?a:a.displayName||a.name||"Unknown"}function m(a){return a.finished||a.headersSent}function n(a){let b=a.split("?");return b[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(b[1]?`?${b.slice(1).join("?")}`:"")}async function o(a,b){let c=b.res||b.ctx&&b.ctx.res;if(!a.getInitialProps)return b.ctx&&b.Component?{pageProps:await o(b.Component,b.ctx)}:{};let d=await a.getInitialProps(b);if(c&&m(c))return d;if(!d)throw Object.defineProperty(Error(`"${l(a)}.getInitialProps()" should resolve to an object. But found "${d}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return d}let p="u">typeof performance,q=p&&["mark","measure","getEntriesByName"].every(a=>"function"==typeof performance[a]);class r extends Error{}class s extends Error{}class t extends Error{constructor(a){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${a}`}}class u extends Error{constructor(a,b){super(),this.message=`Failed to load static file for page: ${a} ${b}`}}class v extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function w(a){return JSON.stringify({message:a.message,stack:a.stack})}},908868,(a,b,c)=>{"use strict";function d(a){let b=a.indexOf("#"),c=a.indexOf("?"),d=c>-1&&(b<0||c<b);return d||b>-1?{pathname:a.substring(0,d?c:b),query:d?a.substring(c,b>-1?b:void 0):"",hash:b>-1?a.slice(b):""}:{pathname:a,query:"",hash:""}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"parsePath",{enumerable:!0,get:function(){return d}})},605407,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addPathPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(908868);function e(a,b){if(!a.startsWith("/")||!b)return a;let{pathname:c,query:e,hash:f}=(0,d.parsePath)(a);return`${b}${c}${e}${f}`}},546112,(a,b,c)=>{"use strict";function d(a){return a.replace(/\/$/,"")||"/"}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"removeTrailingSlash",{enumerable:!0,get:function(){return d}})},425075,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"normalizePathTrailingSlash",{enumerable:!0,get:function(){return f}});let d=a.r(546112),e=a.r(908868),f=a=>{if(!a.startsWith("/"))return a;let{pathname:b,query:c,hash:f}=(0,e.parsePath)(a);return`${(0,d.removeTrailingSlash)(b)}${c}${f}`};("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},138243,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addBasePath",{enumerable:!0,get:function(){return f}});let d=a.r(605407),e=a.r(425075);function f(a,b){return(0,e.normalizePathTrailingSlash)((0,d.addPathPrefix)(a,""))}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},192434,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"warnOnce",{enumerable:!0,get:function(){return d}});let d=a=>{}},510846,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e,f,g={FetchStrategy:function(){return k},NavigationResultTag:function(){return i},PrefetchPriority:function(){return j}};for(var h in g)Object.defineProperty(c,h,{enumerable:!0,get:g[h]});var i=((d={})[d.MPA=0]="MPA",d[d.Success=1]="Success",d[d.NoOp=2]="NoOp",d[d.Async=3]="Async",d),j=((e={})[e.Intent=2]="Intent",e[e.Default=1]="Default",e[e.Background=0]="Background",e),k=((f={})[f.LoadingBoundary=0]="LoadingBoundary",f[f.PPR=1]="PPR",f[f.PPRRuntime=2]="PPRRuntime",f[f.Full=3]="Full",f);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},192702,(a,b,c)=>{"use strict";function d(a,b){let c=new URL(a);return{pathname:c.pathname,search:c.search,nextUrl:b}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createCacheKey",{enumerable:!0,get:function(){return d}}),("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},476e3,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"HasLoadingBoundary",{enumerable:!0,get:function(){return e}});var d,e=((d={})[d.SegmentHasLoadingBoundary=1]="SegmentHasLoadingBoundary",d[d.SubtreeHasLoadingBoundary=2]="SubtreeHasLoadingBoundary",d[d.SubtreeHasNoLoadingBoundary=3]="SubtreeHasNoLoadingBoundary",d)},730641,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"matchSegment",{enumerable:!0,get:function(){return d}});let d=(a,b)=>"string"==typeof a?"string"==typeof b&&a===b:"string"!=typeof b&&a[0]===b[0]&&a[1]===b[1];("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},537909,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={ACTION_HEADER:function(){return g},FLIGHT_HEADERS:function(){return o},NEXT_ACTION_NOT_FOUND_HEADER:function(){return v},NEXT_ACTION_REVALIDATED_HEADER:function(){return y},NEXT_DID_POSTPONE_HEADER:function(){return r},NEXT_HMR_REFRESH_HASH_COOKIE:function(){return l},NEXT_HMR_REFRESH_HEADER:function(){return k},NEXT_HTML_REQUEST_ID_HEADER:function(){return x},NEXT_IS_PRERENDER_HEADER:function(){return u},NEXT_REQUEST_ID_HEADER:function(){return w},NEXT_REWRITTEN_PATH_HEADER:function(){return s},NEXT_REWRITTEN_QUERY_HEADER:function(){return t},NEXT_ROUTER_PREFETCH_HEADER:function(){return i},NEXT_ROUTER_SEGMENT_PREFETCH_HEADER:function(){return j},NEXT_ROUTER_STALE_TIME_HEADER:function(){return q},NEXT_ROUTER_STATE_TREE_HEADER:function(){return h},NEXT_RSC_UNION_QUERY:function(){return p},NEXT_URL:function(){return m},RSC_CONTENT_TYPE_HEADER:function(){return n},RSC_HEADER:function(){return f}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="rsc",g="next-action",h="next-router-state-tree",i="next-router-prefetch",j="next-router-segment-prefetch",k="next-hmr-refresh",l="__next_hmr_refresh_hash__",m="next-url",n="text/x-component",o=[f,h,i,k,j],p="_rsc",q="x-nextjs-stale-time",r="x-nextjs-postponed",s="x-nextjs-rewritten-path",t="x-nextjs-rewritten-query",u="x-nextjs-prerender",v="x-nextjs-action-not-found",w="x-nextjs-request-id",x="x-nextjs-html-request-id",y="x-action-revalidated";("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},158216,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={HEAD_REQUEST_KEY:function(){return h},ROOT_SEGMENT_REQUEST_KEY:function(){return g},appendSegmentRequestKeyPart:function(){return j},convertSegmentPathToStaticExportFilename:function(){return m},createSegmentRequestKeyPart:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(739118),g="",h="/_head";function i(a){if("string"==typeof a)return a.startsWith(f.PAGE_SEGMENT_KEY)?f.PAGE_SEGMENT_KEY:"/_not-found"===a?"_not-found":l(a);let b=a[0];return"$"+a[2]+"$"+l(b)}function j(a,b,c){return a+"/"+("children"===b?c:`@${l(b)}/${c}`)}let k=/^[a-zA-Z0-9\-_@]+$/;function l(a){return k.test(a)?a:"!"+btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function m(a){return`__next${a.replace(/\//g,".")}.txt`}},323187,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={doesStaticSegmentAppearInURL:function(){return l},getCacheKeyForDynamicParam:function(){return m},getParamValueFromCacheKey:function(){return o},getRenderedPathname:function(){return j},getRenderedSearch:function(){return i},parseDynamicParamFromURLPart:function(){return k},urlSearchParamsToParsedUrlQuery:function(){return p},urlToUrlWithoutFlightMarker:function(){return n}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(739118),g=a.r(158216),h=a.r(537909);function i(a){let b=a.headers.get(h.NEXT_REWRITTEN_QUERY_HEADER);return null!==b?""===b?"":"?"+b:n(new URL(a.url)).search}function j(a){return a.headers.get(h.NEXT_REWRITTEN_PATH_HEADER)??n(new URL(a.url)).pathname}function k(a,b,c){switch(a){case"c":return c<b.length?b.slice(c).map(a=>encodeURIComponent(a)):[];case"ci(..)(..)":case"ci(.)":case"ci(..)":case"ci(...)":{let d=a.length-2;return c<b.length?b.slice(c).map((a,b)=>0===b?encodeURIComponent(a.slice(d)):encodeURIComponent(a)):[]}case"oc":return c<b.length?b.slice(c).map(a=>encodeURIComponent(a)):null;case"d":if(c>=b.length)return"";return encodeURIComponent(b[c]);case"di(..)(..)":case"di(.)":case"di(..)":case"di(...)":{let d=a.length-2;if(c>=b.length)return"";return encodeURIComponent(b[c].slice(d))}default:return""}}function l(a){return!(a===g.ROOT_SEGMENT_REQUEST_KEY||a.startsWith(f.PAGE_SEGMENT_KEY)||"("===a[0]&&a.endsWith(")"))&&a!==f.DEFAULT_SEGMENT_KEY&&"/_not-found"!==a}function m(a,b){return"string"==typeof a?(0,f.addSearchParamsIfPageSegment)(a,Object.fromEntries(new URLSearchParams(b))):null===a?"":a.join("/")}function n(a){let b=new URL(a);return b.searchParams.delete(h.NEXT_RSC_UNION_QUERY),b}function o(a,b){return"c"===b||"oc"===b?a.split("/"):a}function p(a){let b={};for(let[c,d]of a.entries())void 0===b[c]?b[c]=d:Array.isArray(b[c])?b[c].push(d):b[c]=[b[c],d];return b}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},74685,(a,b,c)=>{"use strict";function d(a,b=!0){return a.pathname+a.search+(b?a.hash:"")}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createHrefFromUrl",{enumerable:!0,get:function(){return d}}),("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},522129,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={createInitialRSCPayloadFromFallbackPrerender:function(){return j},getFlightDataPartsFromPath:function(){return i},getNextFlightSegmentPath:function(){return k},normalizeFlightData:function(){return l},prepareFlightRouterStateForRequest:function(){return m}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(739118),g=a.r(323187),h=a.r(74685);function i(a){let[b,c,d,e]=a.slice(-4),f=a.slice(0,-4);return{pathToSegment:f.slice(0,-1),segmentPath:f,segment:f[f.length-1]??"",tree:b,seedData:c,head:d,isHeadPartial:e,isRootRender:4===a.length}}function j(a,b){let c=(0,g.getRenderedPathname)(a),d=(0,g.getRenderedSearch)(a),e=(0,h.createHrefFromUrl)(new URL(location.href)),f=b.f[0],i=f[0];return{b:b.b,c:e.split("/"),q:d,i:b.i,f:[[function a(b,c,d,e){let f,h,i=b[0];if("string"==typeof i)f=i,h=(0,g.doesStaticSegmentAppearInURL)(i);else{let a=i[0],b=i[2],j=(0,g.parseDynamicParamFromURLPart)(b,d,e);f=[a,(0,g.getCacheKeyForDynamicParam)(j,c),b],h=!0}let j=h?e+1:e,k=b[1],l={};for(let b in k){let e=k[b];l[b]=a(e,c,d,j)}return[f,l,null,b[3],b[4]]}(i,d,c.split("/").filter(a=>""!==a),0),f[1],f[2],f[2]]],m:b.m,G:b.G,S:b.S}}function k(a){return a.slice(2)}function l(a){return"string"==typeof a?a:a.map(a=>i(a))}function m(a,b){return b?encodeURIComponent(JSON.stringify(a)):encodeURIComponent(JSON.stringify(function a(b){var c,d;let[e,g,h,i,j,k]=b,l="string"==typeof(c=e)&&c.startsWith(f.PAGE_SEGMENT_KEY+"?")?f.PAGE_SEGMENT_KEY:c,m={};for(let[b,c]of Object.entries(g))m[b]=a(c);let n=[l,m,null,(d=i)&&"refresh"!==d?i:null];return void 0!==j&&(n[4]=j),void 0!==k&&(n[5]=k),n}(a)))}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},691377,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getAppBuildId:function(){return h},setAppBuildId:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="";function g(a){f=a}function h(){return f}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},16661,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={djb2Hash:function(){return f},hexHash:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){let b=5381;for(let c=0;c<a.length;c++)b=(b<<5)+b+a.charCodeAt(c)|0;return b>>>0}function g(a){return f(a).toString(36).slice(0,5)}},35604,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"computeCacheBustingSearchParam",{enumerable:!0,get:function(){return e}});let d=a.r(16661);function e(a,b,c,e){return(void 0===a||"0"===a)&&void 0===b&&void 0===c&&void 0===e?"":(0,d.hexHash)([a||"0",b||"0",c||"0",e||"0"].join(","))}},425744,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={setCacheBustingSearchParam:function(){return h},setCacheBustingSearchParamWithHash:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(35604),g=a.r(537909),h=(a,b)=>{i(a,(0,f.computeCacheBustingSearchParam)(b[g.NEXT_ROUTER_PREFETCH_HEADER],b[g.NEXT_ROUTER_SEGMENT_PREFETCH_HEADER],b[g.NEXT_ROUTER_STATE_TREE_HEADER],b[g.NEXT_URL]))},i=(a,b)=>{let c=a.search,d=(c.startsWith("?")?c.slice(1):c).split("&").filter(a=>a&&!a.startsWith(`${g.NEXT_RSC_UNION_QUERY}=`));b.length>0?d.push(`${g.NEXT_RSC_UNION_QUERY}=${b}`):d.push(`${g.NEXT_RSC_UNION_QUERY}`),a.search=d.length?`?${d.join("&")}`:""};("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},68063,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getDeploymentId:function(){return f},getDeploymentIdQueryOrEmptyString:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(){return!1}function g(){return""}},120873,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0});var e={createFetch:function(){return t},createFromNextReadableStream:function(){return u},fetchServerResponse:function(){return s}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(738783),h=a.r(537909),i=a.r(120611),j=a.r(1722),k=a.r(522129),l=a.r(691377),m=a.r(425744),n=a.r(323187),o=a.r(68063),p=g.createFromReadableStream,q=g.createFromFetch;function r(a){return(0,n.urlToUrlWithoutFlightMarker)(new URL(a,location.origin)).toString()}async function s(a,b){let{flightRouterState:c,nextUrl:d}=b,e={[h.RSC_HEADER]:"1",[h.NEXT_ROUTER_STATE_TREE_HEADER]:(0,k.prepareFlightRouterStateForRequest)(c,b.isHmrRefresh)};d&&(e[h.NEXT_URL]=d);try{let b=await t(a,e,"auto",!0),c=(0,n.urlToUrlWithoutFlightMarker)(new URL(b.url)),d=b.redirected?c:a,f=b.headers.get("content-type")||"",g=!!b.headers.get("vary")?.includes(h.NEXT_URL),i=!!b.headers.get(h.NEXT_DID_POSTPONE_HEADER),j=b.headers.get(h.NEXT_ROUTER_STALE_TIME_HEADER),m=null!==j?1e3*parseInt(j,10):-1;if(!f.startsWith(h.RSC_CONTENT_TYPE_HEADER)||!b.ok||!b.body)return a.hash&&(c.hash=a.hash),r(c.toString());let o=b.flightResponse;if(null===o){let a,c=i?(a=b.body.getReader(),new ReadableStream({async pull(b){for(;;){let{done:c,value:d}=await a.read();if(!c){b.enqueue(d);continue}return}}})):b.body;o=u(c,e)}let p=await o;if((0,l.getAppBuildId)()!==p.b)return r(b.url);let q=(0,k.normalizeFlightData)(p.f);if("string"==typeof q)return r(q);return{flightData:q,canonicalUrl:d,renderedSearch:(0,n.getRenderedSearch)(b),couldBeIntercepted:g,prerendered:p.S,postponed:i,staleTime:m,debugInfo:o._debugInfo??null}}catch(b){return console.error(`Failed to fetch RSC payload for ${a}. Falling back to browser navigation.`,b),a.toString()}}async function t(a,b,c,e,f){var g,k;let l=(0,o.getDeploymentId)();l&&(b["x-deployment-id"]=l);let n=new URL(a);(0,m.setCacheBustingSearchParam)(n,b);let p=fetch(n,{credentials:"same-origin",headers:b,priority:c||void 0,signal:f}),r=e?(g=p,k=b,q(g,{callServer:i.callServer,findSourceMapURL:j.findSourceMapURL,debugChannel:d&&d(k)})):null,s=await p,t=s.redirected,u=new URL(s.url,n);return u.searchParams.delete(h.NEXT_RSC_UNION_QUERY),{url:u.href,redirected:t,ok:s.ok,headers:s.headers,body:s.body,status:s.status,flightResponse:r}}function u(a,b){return p(a,{callServer:i.callServer,findSourceMapURL:j.findSourceMapURL,debugChannel:d&&d(b)})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},954645,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={deleteFromLru:function(){return l},lruPut:function(){return j},updateLruSize:function(){return k}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(851561),g=null,h=!1,i=0;function j(a){if(g===a)return;let b=a.prev,c=a.next;if(null===c||null===b?(i+=a.size,m()):(b.next=c,c.prev=b),null===g)a.prev=a,a.next=a;else{let b=g.prev;a.prev=b,null!==b&&(b.next=a),a.next=g,g.prev=a}g=a}function k(a,b){let c=a.size;a.size=b,null!==a.next&&(i=i-c+b,m())}function l(a){let b=a.next,c=a.prev;null!==b&&null!==c&&(i-=a.size,a.next=null,a.prev=null,g===a?b===g?g=null:(g=b,c.next=b,b.prev=c):(c.next=b,b.prev=c))}function m(){h||i<=0x3200000||(h=!0,o(n))}function n(){h=!1;for(;i>0x2d00000&&null!==g;){let a=g.prev;null!==a&&(0,f.deleteMapEntry)(a)}}let o="function"==typeof requestIdleCallback?requestIdleCallback:a=>setTimeout(a,0);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},851561,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={Fallback:function(){return g},createCacheMap:function(){return i},deleteFromCacheMap:function(){return n},deleteMapEntry:function(){return o},getFromCacheMap:function(){return j},isValueExpired:function(){return k},setInCacheMap:function(){return l},setSizeInCacheMap:function(){return p}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(954645),g={},h={};function i(){return{parent:null,key:null,value:null,map:null,prev:null,next:null,size:0}}function j(a,b,c,d,e){let i=function a(b,c,d,e,f,i){let j,l;if(null!==e)j=e.value,l=e.parent;else if(f&&i!==h)j=h,l=null;else return null===d.value?d:k(b,c,d.value)?(o(d),null):d;let m=d.map;if(null!==m){let d=m.get(j);if(void 0!==d){let e=a(b,c,d,l,f,j);if(null!==e)return e}let e=m.get(g);if(void 0!==e)return a(b,c,e,l,f,j)}return null}(a,b,c,d,e,0);return null===i||null===i.value?null:((0,f.lruPut)(i),i.value)}function k(a,b,c){return c.staleAt<=a||c.version<b}function l(a,b,c,d){let e=function(a,b,c){let d=a,e=b,f=null;for(;;){let a=f;if(null!==e)f=e.value,e=e.parent;else if(c&&a!==h){if(null===d.value)return d;f=h}else break;let b=d.map;if(null!==b){let a=b.get(f);if(void 0!==a){d=a;continue}}else b=new Map,d.map=b;let g={parent:d,key:f,value:null,map:null,prev:null,next:null,size:0};b.set(f,g),d=g}return d}(a,b,d);m(e,c),(0,f.lruPut)(e),(0,f.updateLruSize)(e,c.size)}function m(a,b){null!==a.value&&(a.value.ref=null,a.value=null);let c=b.ref;a.value=b,b.ref=a,(0,f.updateLruSize)(a,b.size),null!==c&&c!==a&&c.value===b&&o(c)}function n(a){let b=a.ref;null!==b&&(a.ref=null,o(b))}function o(a){a.value=null,(0,f.deleteFromLru)(a);let b=a.map;if(null===b){let b=a.parent,c=a.key;for(;null!==b;){let a=b.map;if(null!==a&&(a.delete(c),0===a.size)&&(b.map=null,null===b.value)){c=b.key,b=b.parent;continue}break}}else{let c=b.get(h);void 0!==c&&null!==c.value&&m(a,c.value)}}function p(a,b){let c=a.ref;null!==c&&(a.size=b,(0,f.updateLruSize)(c,b))}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},91442,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={appendLayoutVaryPath:function(){return k},clonePageVaryPathWithNewSearchParams:function(){return p},finalizeLayoutVaryPath:function(){return l},finalizeMetadataVaryPath:function(){return n},finalizePageVaryPath:function(){return m},getFulfilledRouteVaryPath:function(){return j},getRouteVaryPath:function(){return i},getSegmentVaryPathForRequest:function(){return o}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(510846),g=a.r(851561),h=a.r(158216);function i(a,b,c){return{value:a,parent:{value:b,parent:{value:c,parent:null}}}}function j(a,b,c,d){return{value:a,parent:{value:b,parent:{value:d?c:g.Fallback,parent:null}}}}function k(a,b){return{value:b,parent:a}}function l(a,b){return{value:a,parent:b}}function m(a,b,c){return{value:a,parent:{value:b,parent:c}}}function n(a,b,c){return{value:a+h.HEAD_REQUEST_KEY,parent:{value:b,parent:c}}}function o(a,b){let c=b.varyPath;if(b.isPage&&a!==f.FetchStrategy.Full&&a!==f.FetchStrategy.PPRRuntime){let a=c.parent.parent;return{value:c.value,parent:{value:g.Fallback,parent:a}}}return c}function p(a,b){let c=a.parent;return{value:a.value,parent:{value:b,parent:c.parent}}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},719924,(a,b,c)=>{"use strict";function d(a){return a.startsWith("/")?a:`/${a}`}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureLeadingSlash",{enumerable:!0,get:function(){return d}})},953808,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={normalizeAppPath:function(){return h},normalizeRscURL:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(719924),g=a.r(739118);function h(a){return(0,f.ensureLeadingSlash)(a.split("/").reduce((a,b,c,d)=>!b||(0,g.isGroupSegment)(b)||"@"===b[0]||("page"===b||"route"===b)&&c===d.length-1?a:`${a}/${b}`,""))}function i(a){return a.replace(/\.rsc($|\?)/,"$1")}},518099,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={INTERCEPTION_ROUTE_MARKERS:function(){return g},extractInterceptionRouteInformation:function(){return i},isInterceptionRouteAppPath:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(953808),g=["(..)(..)","(.)","(..)","(...)"];function h(a){return void 0!==a.split("/").find(a=>g.find(b=>a.startsWith(b)))}function i(a){let b,c,d;for(let e of a.split("/"))if(c=g.find(a=>e.startsWith(a))){[b,d]=a.split(c,2);break}if(!b||!c||!d)throw Object.defineProperty(Error(`Invalid interception route: ${a}. Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>`),"__NEXT_ERROR_CODE",{value:"E269",enumerable:!1,configurable:!0});switch(b=(0,f.normalizeAppPath)(b),c){case"(.)":d="/"===b?`/${d}`:b+"/"+d;break;case"(..)":if("/"===b)throw Object.defineProperty(Error(`Invalid interception route: ${a}. Cannot use (..) marker at the root level, use (.) instead.`),"__NEXT_ERROR_CODE",{value:"E207",enumerable:!1,configurable:!0});d=b.split("/").slice(0,-1).concat(d).join("/");break;case"(...)":d="/"+d;break;case"(..)(..)":let e=b.split("/");if(e.length<=2)throw Object.defineProperty(Error(`Invalid interception route: ${a}. Cannot use (..)(..) marker at the root level or one level up.`),"__NEXT_ERROR_CODE",{value:"E486",enumerable:!1,configurable:!0});d=e.slice(0,-2).concat(d).join("/");break;default:throw Object.defineProperty(Error("Invariant: unexpected marker"),"__NEXT_ERROR_CODE",{value:"E112",enumerable:!1,configurable:!0})}return{interceptingRoute:b,interceptedRoute:d}}},837042,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={computeChangedPath:function(){return l},extractPathFromFlightRouterState:function(){return k},getSelectedParams:function(){return function a(b,c={}){for(let d of Object.values(b[1])){let b=d[0],e=Array.isArray(b),f=e?b[1]:b;!f||f.startsWith(g.PAGE_SEGMENT_KEY)||(e&&("c"===b[2]||"oc"===b[2])?c[b[0]]=b[1].split("/"):e&&(c[b[0]]=b[1]),c=a(d,c))}return c}}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(518099),g=a.r(739118),h=a.r(730641),i=a=>"string"==typeof a?"children"===a?"":a:a[1];function j(a){return a.reduce((a,b)=>{let c;return""===(b="/"===(c=b)[0]?c.slice(1):c)||(0,g.isGroupSegment)(b)?a:`${a}/${b}`},"")||"/"}function k(a){let b=Array.isArray(a[0])?a[0][1]:a[0];if(b===g.DEFAULT_SEGMENT_KEY||f.INTERCEPTION_ROUTE_MARKERS.some(a=>b.startsWith(a)))return;if(b.startsWith(g.PAGE_SEGMENT_KEY))return"";let c=[i(b)],d=a[1]??{},e=d.children?k(d.children):void 0;if(void 0!==e)c.push(e);else for(let[a,b]of Object.entries(d)){if("children"===a)continue;let d=k(b);void 0!==d&&c.push(d)}return j(c)}function l(a,b){let c=function a(b,c){let[d,e]=b,[g,j]=c,l=i(d),m=i(g);if(f.INTERCEPTION_ROUTE_MARKERS.some(a=>l.startsWith(a)||m.startsWith(a)))return"";if(!(0,h.matchSegment)(d,g))return k(c)??"";for(let b in e)if(j[b]){let c=a(e[b],j[b]);if(null!==c)return`${i(g)}/${c}`}return null}(a,b);return null==c||"/"===c?c:j(c.split("/"))}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},688632,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"handleMutable",{enumerable:!0,get:function(){return f}});let d=a.r(837042);function e(a){return void 0!==a}function f(a,b){let c=b.shouldScroll??!0,f=a.previousNextUrl,g=a.nextUrl;if(e(b.patchedTree)){let c=(0,d.computeChangedPath)(a.tree,b.patchedTree);c?(f=g,g=c):g||(g=a.canonicalUrl)}return{canonicalUrl:b.canonicalUrl??a.canonicalUrl,renderedSearch:b.renderedSearch??a.renderedSearch,pushRef:{pendingPush:e(b.pendingPush)?b.pendingPush:a.pushRef.pendingPush,mpaNavigation:e(b.mpaNavigation)?b.mpaNavigation:a.pushRef.mpaNavigation,preserveCustomHistoryState:e(b.preserveCustomHistoryState)?b.preserveCustomHistoryState:a.pushRef.preserveCustomHistoryState},focusAndScrollRef:{apply:!!c&&(!!e(b?.scrollableSegments)||a.focusAndScrollRef.apply),onlyHashChange:b.onlyHashChange||!1,hashFragment:c?b.hashFragment&&""!==b.hashFragment?decodeURIComponent(b.hashFragment.slice(1)):a.focusAndScrollRef.hashFragment:null,segmentPaths:c?b?.scrollableSegments??a.focusAndScrollRef.segmentPaths:[]},cache:b.cache?b.cache:a.cache,tree:e(b.patchedTree)?b.patchedTree:a.tree,nextUrl:g,previousNextUrl:f,debugInfo:b.collectedDebugInfo??null}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},870681,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createRouterCacheKey",{enumerable:!0,get:function(){return e}});let d=a.r(739118);function e(a,b=!1){return Array.isArray(a)?`${a[0]}|${a[1]}|${a[2]}`:b&&a.startsWith(d.PAGE_SEGMENT_KEY)?d.PAGE_SEGMENT_KEY:a}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},71094,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isNavigatingToNewRootLayout",{enumerable:!0,get:function(){return function a(b,c){let d=b[0],e=c[0];if(Array.isArray(d)&&Array.isArray(e)){if(d[0]!==e[0]||d[2]!==e[2])return!0}else if(d!==e)return!0;if(b[4])return!c[4];if(c[4])return!0;let f=Object.values(b[1])[0],g=Object.values(c[1])[0];return!f||!g||a(f,g)}}}),("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},557051,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={FreshnessPolicy:function(){return q},createInitialCacheNodeForHydration:function(){return s},isDeferredRsc:function(){return G},spawnDynamicRequests:function(){return B},startPPRNavigation:function(){return t}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(739118),h=a.r(730641),i=a.r(74685),j=a.r(870681),k=a.r(120873),l=a.r(190841),m=a.r(288347),n=a.r(71094),o=a.r(323053),p=a.r(37472);var q=((d={})[d.Default=0]="Default",d[d.Hydration=1]="Hydration",d[d.HistoryTraversal=2]="HistoryTraversal",d[d.RefreshAll=3]="RefreshAll",d[d.HMRRefresh=4]="HMRRefresh",d);let r=()=>{};function s(a,b,c,d){return u(a,b,void 0,1,c,d,null,null,!1,null,null,!1,{scrollableSegments:null,separateRefreshUrls:null}).node}function t(a,b,c,d,e,f,k,l,m,o,p,q,r){return function a(b,c,d,e,f,k,l,m,o,p,q,r,s,t,A,B,C,D){var E,F;let G,H,I,J=e[0],K=f[0];if(!(0,h.matchSegment)(K,J))return!l&&(0,n.isNavigatingToNewRootLayout)(e,f)||K===g.NOT_FOUND_SEGMENT_KEY||null===t||null===A?null:u(b,f,d,k,m,o,p,q,r,t,A,B,D);let L=null!==A&&null!==t?t.concat([A,K]):[],M=f[1],N=e[1],O=null!==m?m[1]:null,P=null!==p?p[1]:null,Q=!0===f[4],R=l||Q,S=void 0!==d?d.parallelRoutes:void 0,T=!1,U=!1;switch(k){case 0:case 2:case 1:T=!1,U=!1;break;case 3:case 4:T=!0,U=!0}let V=new Map(T?void 0:S),W=0===Object.keys(M).length;if(void 0===d||U||W&&s)if(null!==m&&null!==m[0]){let a=m[0],c=m[2],d=null===o;H=y(a,c,!1,o,d,W,V,b),I=W&&d}else if(null!==p){let a=p[0],c=p[2],d=p[3];H=y(a,c,d,q,r,W,V,b),I=d||W&&r}else H=z(V,W,b,k),I=!0;else H=x(!1,d,V),I=!1;let X=f[2],Y="string"==typeof X&&"refresh"===f[3]?X:C;I&&null!==Y&&(E=D,F=Y,null===(G=E.separateRefreshUrls)?E.separateRefreshUrls=new Set([F]):G.add(F));let Z={},$=null,_=!1,aa={};for(let d in M){let e=M[d],f=N[d];if(void 0===f)return null;let h=void 0!==S?S.get(d):void 0,l=null!==O?O[d]:null,m=null!==P?P[d]:null,n=e[0],p=o,t=q,u=r;2!==k&&n===g.DEFAULT_SEGMENT_KEY&&(n=(e=function(a,b){let c;return"refresh"===b[3]?c=b:((c=v(b,b[1]))[2]=(0,i.createHrefFromUrl)(a),c[3]="refresh"),c}(c,f))[0],l=null,p=null,m=null,t=null,u=!1);let w=(0,j.createRouterCacheKey)(n),x=a(b,c,void 0!==h?h.get(w):void 0,f,e,k,R,l??null,p,m??null,t,u,s,L,d,B||I,Y,D);if(null===x)return null;null===$&&($=new Map),$.set(d,x);let y=x.node;if(null!==y){let a=new Map(T?void 0:h);a.set(w,y),V.set(d,a)}let z=x.route;Z[d]=z;let A=x.dynamicRequestTree;null!==A?(_=!0,aa[d]=A):aa[d]=z}return{status:+!I,route:v(f,Z),node:H,dynamicRequestTree:w(f,aa,I,_,B),refreshUrl:Y,children:$}}(a,b,null!==c?c:void 0,d,e,f,!1,k,l,m,o,p,q,null,null,!1,null,r)}function u(a,b,c,d,e,f,g,h,i,k,l,m,n){let p,q,r=b[0],s=null!==l&&null!==k?k.concat([l,r]):[],t=b[1],A=null!==g?g[1]:null,B=null!==e?e[1]:null,C=void 0!==c?c.parallelRoutes:void 0,D=!1,E=!1,F=!1;switch(d){case 0:D=!1,E=void 0===c||a-c.navigatedAt>=o.DYNAMIC_STALETIME_MS,F=!1;break;case 1:E=!1,D=!1,F=!1;break;case 2:if(E=!1,E=!1,void 0!==c){let a=c.rsc;F=!G(a)||"pending"!==a.status}else F=!1;break;case 3:case 4:E=!0,D=!0,F=!1}let H=new Map(D?void 0:C),I=0===Object.keys(t).length;if(I&&(null===n.scrollableSegments&&(n.scrollableSegments=[]),n.scrollableSegments.push(s)),E||void 0===c)if(null!==e&&null!==e[0]){let b=e[0],c=e[2],g=null===f&&1!==d;p=y(b,c,!1,f,g,I,H,a),q=I&&g}else if(1===d&&I&&null!==f)p=y(null,null,!1,f,!1,I,H,a),q=!1;else if(1!==d&&null!==g){let b=g[0],c=g[2],d=g[3];p=y(b,c,d,h,i,I,H,a),q=d||I&&i}else p=z(H,I,a,d),q=!0;else p=x(F,c,H),q=!1;let J={},K=null,L=!1,M={};for(let b in t){let c=t[b],e=void 0!==C?C.get(b):void 0,g=null!==B?B[b]:null,k=null!==A?A[b]:null,l=c[0],o=(0,j.createRouterCacheKey)(l),p=u(a,c,void 0!==e?e.get(o):void 0,d,g??null,f,k??null,h,i,s,b,m||q,n);null===K&&(K=new Map),K.set(b,p);let r=p.node;if(null!==r){let a=new Map(D?void 0:e);a.set(o,r),H.set(b,a)}let v=p.route;J[b]=v;let w=p.dynamicRequestTree;null!==w?(L=!0,M[b]=w):M[b]=v}return{status:+!q,route:v(b,J),node:p,dynamicRequestTree:w(b,M,q,L,m),refreshUrl:null,children:K}}function v(a,b){let c=[a[0],b];return 2 in a&&(c[2]=a[2]),3 in a&&(c[3]=a[3]),4 in a&&(c[4]=a[4]),c}function w(a,b,c,d,e){let f=null;return c?(f=v(a,b),e||(f[3]="refetch")):f=d?v(a,b):null,f}function x(a,b,c){return{rsc:b.rsc,prefetchRsc:a?null:b.prefetchRsc,head:b.head,prefetchHead:a?null:b.prefetchHead,loading:b.loading,parallelRoutes:c,navigatedAt:b.navigatedAt}}function y(a,b,c,d,e,f,g,h){let i,j,k,l;return c?(j=a,i=H()):(j=null,i=a),f?e?(k=d,l=H()):(k=null,l=d):(k=null,l=null),{rsc:i,prefetchRsc:j,head:l,prefetchHead:k,loading:b,parallelRoutes:g,navigatedAt:h}}function z(a,b,c,d){let e=1===d;return{rsc:e?null:H(),prefetchRsc:null,head:!e&&b?H():null,prefetchHead:null,loading:e?null:H(),parallelRoutes:a,navigatedAt:c}}let A=!1;function B(a,b,c,d,e){let f=a.dynamicRequestTree;if(null===f){A=!1;return}let g=E(a,f,b,c,d),h=e.separateRefreshUrls,j=null;if(null!==h){j=[];let e=(0,i.createHrefFromUrl)(b);for(let b of h)b!==e&&null!==f&&j.push(E(a,f,new URL(b,location.origin),c,d))}C(a,c,g,j).then(r,r)}async function C(a,b,c,d){var e,f;let g=await (e=c,f=d,new Promise(a=>{let b=b=>{0===b.exitStatus?0==--d&&a(0):a(b.exitStatus)},c=()=>a(2),d=1;e.then(b,c),null!==f&&(d+=f.length,f.forEach(a=>a.then(b,c)))}));switch(0===g&&(g=function a(b,c,d){var e,f,g;let h,i,j,k;0===b.status?(b.status=2,e=b.node,f=c,g=d,G(i=e.rsc)&&(null===f?i.resolve(null,g):i.reject(f,g)),G(j=e.loading)&&j.resolve(null,g),G(k=e.head)&&k.resolve(null,g),h=null===b.refreshUrl?1:2):h=0;let l=b.children;if(null!==l)for(let[,b]of l){let e=a(b,c,d);e>h&&(h=e)}return h}(a,null,null)),g){case 0:A=!1;return;case 1:{let d=await c;D(!1,d.url,b,d.seed,a.route);return}case 2:{let d=await c;D(!0,d.url,b,d.seed,a.route);return}default:return g}}function D(a,b,c,d,e){a=a||A,A=!0;let f={type:m.ACTION_SERVER_PATCH,previousTree:e,url:b,nextUrl:c,seed:d,mpa:a};(0,l.dispatchAppRouterAction)(f)}async function E(a,b,c,d,e){try{let f=await (0,k.fetchServerResponse)(c,{flightRouterState:b,nextUrl:d,isHmrRefresh:4===e});if("string"==typeof f)return{exitStatus:2,url:new URL(f,location.origin),seed:null};let g=(0,p.convertServerPatchToFullTree)(a.route,f.flightData,f.renderedSearch);return{exitStatus:+!!function a(b,c,d,e,f){0===b.status&&null!==d&&(b.status=1,function(a,b,c,d){let e=a.rsc,f=b[0];if(null===f)return;null===e?a.rsc=f:G(e)&&e.resolve(f,d);let g=a.loading;if(G(g)){let a=b[2];g.resolve(a,d)}let h=a.head;G(h)&&h.resolve(c,d)}(b.node,d,e,f));let g=b.children,i=c[1],j=null!==d?d[1]:null,k=!1;if(null!==g)for(let b in i){let c=i[b],d=null!==j?j[b]:null,l=g.get(b);if(void 0===l)k=!0;else{let b=l.route[0];(0,h.matchSegment)(c[0],b)&&null!=d&&a(l,c,d,e,f)&&(k=!0)}}return k}(a,g.tree,g.data,g.head,f.debugInfo),url:new URL(f.canonicalUrl,location.origin),seed:g}}catch{return{exitStatus:2,url:c,seed:null}}}let F=Symbol();function G(a){return a&&"object"==typeof a&&a.tag===F}function H(){let a,b,c=[],d=new Promise((c,d)=>{a=c,b=d});return d.status="pending",d.resolve=(b,e)=>{"pending"===d.status&&(d.status="fulfilled",d.value=b,null!==e&&c.push.apply(c,e),a(b))},d.reject=(a,e)=>{"pending"===d.status&&(d.status="rejected",d.reason=a,null!==e&&c.push.apply(c,e),b(a))},d.tag=F,d._debugInfo=c,d}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},37472,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={convertServerPatchToFullTree:function(){return u},navigate:function(){return m},navigateToSeededRoute:function(){return n}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(120873),g=a.r(557051),h=a.r(74685),i=a.r(399032),j=a.r(192702),k=a.r(739118),l=a.r(510846);function m(a,b,c,d,e,f,g,h){let k=Date.now(),m=a.href,n=m===b.href,p=(0,j.createCacheKey)(m,e),s=(0,i.readRouteCacheEntry)(k,p);if(null!==s&&s.status===i.EntryStatus.Fulfilled){let h=q(k,s,s.tree),i=h.flightRouterState,j=h.seedData,l=r(k,s),m=l.rsc,p=l.isPartial,t=s.canonicalUrl+a.hash;return o(k,a,b,e,n,c,d,i,j,m,p,t,s.renderedSearch,f,g)}if(null===s||s.status!==i.EntryStatus.Rejected){let h=(0,i.requestOptimisticRouteCacheEntry)(k,a,e);if(null!==h){let i=q(k,h,h.tree),j=i.flightRouterState,l=i.seedData,m=r(k,h),p=m.rsc,s=m.isPartial,t=h.canonicalUrl+a.hash;return o(k,a,b,e,n,c,d,j,l,p,s,t,h.renderedSearch,f,g)}}let u=h.collectedDebugInfo??[];return void 0===h.collectedDebugInfo&&(u=h.collectedDebugInfo=[]),{tag:l.NavigationResultTag.Async,data:t(k,a,b,e,c,d,f,g,u)}}function n(a,b,c,d,e,f,h,i,j,k){let m={scrollableSegments:null,separateRefreshUrls:null},n=b.href===e.href,o=(0,g.startPPRNavigation)(a,e,f,h,d.tree,i,d.data,d.head,null,null,!1,n,m);return null!==o?((0,g.spawnDynamicRequests)(o,b,j,i,m),p(o,c,d.renderedSearch,m.scrollableSegments,k,b.hash)):{tag:l.NavigationResultTag.MPA,data:c}}function o(a,b,c,d,e,f,h,i,j,k,m,n,o,q,r){let s={scrollableSegments:null,separateRefreshUrls:null},t=(0,g.startPPRNavigation)(a,c,f,h,i,q,null,null,j,k,m,e,s);return null!==t?((0,g.spawnDynamicRequests)(t,b,d,q,s),p(t,n,o,s.scrollableSegments,r,b.hash)):{tag:l.NavigationResultTag.MPA,data:n}}function p(a,b,c,d,e,f){return{tag:l.NavigationResultTag.Success,data:{flightRouterState:a.route,cacheNode:a.node,canonicalUrl:b,renderedSearch:c,scrollableSegments:d,shouldScroll:e,hash:f}}}function q(a,b,c){let d={},e={},f=c.slots;if(null!==f)for(let c in f){let g=q(a,b,f[c]);d[c]=g.flightRouterState,e[c]=g.seedData}let g=null,h=null,j=!0,l=(0,i.readSegmentCacheEntry)(a,c.varyPath);if(null!==l)switch(l.status){case i.EntryStatus.Fulfilled:g=l.rsc,h=l.loading,j=l.isPartial;break;case i.EntryStatus.Pending:{let a=(0,i.waitForSegmentCacheEntry)(l);g=a.then(a=>null!==a?a.rsc:null),h=a.then(a=>null!==a?a.loading:null),j=l.isPartial}case i.EntryStatus.Empty:case i.EntryStatus.Rejected:}return{flightRouterState:[(0,k.addSearchParamsIfPageSegment)(c.segment,Object.fromEntries(new URLSearchParams(b.renderedSearch))),d,null,null,c.isRootLayout],seedData:[g,e,h,j,!1]}}function r(a,b){let c=null,d=!0,e=(0,i.readSegmentCacheEntry)(a,b.metadata.varyPath);if(null!==e)switch(e.status){case i.EntryStatus.Fulfilled:c=e.rsc,d=e.isPartial;break;case i.EntryStatus.Pending:c=(0,i.waitForSegmentCacheEntry)(e).then(a=>null!==a?a.rsc:null),d=e.isPartial;case i.EntryStatus.Empty:case i.EntryStatus.Rejected:}return{rsc:c,isPartial:d}}let s=["",{},null,"refetch"];async function t(a,b,c,d,e,i,j,k,m){let o;switch(j){case g.FreshnessPolicy.Default:case g.FreshnessPolicy.HistoryTraversal:o=i;break;case g.FreshnessPolicy.Hydration:case g.FreshnessPolicy.RefreshAll:case g.FreshnessPolicy.HMRRefresh:o=s;break;default:o=i}let p=(0,f.fetchServerResponse)(b,{flightRouterState:o,nextUrl:d}),q=await p;if("string"==typeof q)return{tag:l.NavigationResultTag.MPA,data:q};let{flightData:r,canonicalUrl:t,renderedSearch:v,debugInfo:w}=q;null!==w&&m.push(...w);let x=u(i,r,v);return n(a,b,(0,h.createHrefFromUrl)(t),x,c,e,i,j,d,k)}function u(a,b,c){let d=a,e=null,f=null;for(let{segmentPath:a,tree:c,seedData:g,head:h}of b){let b=function a(b,c,d,e,f,g){let h;if(g===f.length)return{tree:d,data:e};let i=f[g],j=b[1],k=null!==c?c[1]:null,l={},m={};for(let b in j){let c=j[b],h=null!==k?k[b]??null:null;if(b===i){let i=a(c,h,d,e,f,g+2);l[b]=i.tree,m[b]=i.data}else l[b]=c,m[b]=h}return h=[b[0],l],2 in b&&(h[2]=b[2]),3 in b&&(h[3]=b[3]),4 in b&&(h[4]=b[4]),{tree:h,data:[null,m,null,!0,!1]}}(d,e,c,g,a,0);d=b.tree,e=b.data,f=h}return{tree:d,data:e,renderedSearch:c,head:f}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},323053,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DYNAMIC_STALETIME_MS:function(){return l},STATIC_STALETIME_MS:function(){return m},generateSegmentsFromPatch:function(){return function a(b){let c=[],[d,e]=b;if(0===Object.keys(e).length)return[[d]];for(let[b,f]of Object.entries(e))for(let e of a(f))""===d?c.push([b,...e]):c.push([d,b,...e]);return c}},handleExternalUrl:function(){return n},handleNavigationResult:function(){return o},navigateReducer:function(){return p}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(74685),g=a.r(688632),h=a.r(37472),i=a.r(510846),j=a.r(399032),k=a.r(557051),l=1e3*Number("0"),m=(0,j.getStaleTimeMs)(Number("300"));function n(a,b,c,d){return b.mpaNavigation=!0,b.canonicalUrl=c,b.pendingPush=d,b.scrollableSegments=void 0,(0,g.handleMutable)(a,b)}function o(a,b,c,d,e){switch(e.tag){case i.NavigationResultTag.MPA:return n(b,c,e.data,d);case i.NavigationResultTag.Success:{c.cache=e.data.cacheNode,c.patchedTree=e.data.flightRouterState,c.renderedSearch=e.data.renderedSearch,c.canonicalUrl=e.data.canonicalUrl,c.scrollableSegments=e.data.scrollableSegments??void 0,c.shouldScroll=e.data.shouldScroll,c.hashFragment=e.data.hash;let d=new URL(b.canonicalUrl,a);return a.pathname===d.pathname&&a.search===d.search&&a.hash!==d.hash&&(c.onlyHashChange=!0,c.shouldScroll=e.data.shouldScroll,c.hashFragment=a.hash,c.scrollableSegments=[]),(0,g.handleMutable)(b,c)}case i.NavigationResultTag.Async:return e.data.then(e=>o(a,b,c,d,e),()=>b);default:return b}}function p(a,b){let{url:c,isExternalUrl:d,navigateType:e,shouldScroll:g}=b,i={},j=(0,f.createHrefFromUrl)(c),l="push"===e;if(i.preserveCustomHistoryState=!1,i.pendingPush=l,d)return n(a,i,c.toString(),l);if(document.getElementById("__next-page-redirect"))return n(a,i,j,l);let m=new URL(a.canonicalUrl,location.origin),p=(0,h.navigate)(c,m,a.cache,a.tree,a.nextUrl,k.FreshnessPolicy.Default,g,i);return o(c,a,i,l,p)}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},554427,(a,b,c)=>{"use strict";function d(){let a,b,c=new Promise((c,d)=>{a=c,b=d});return{resolve:a,reject:b,promise:c}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createPromiseWithResolvers",{enumerable:!0,get:function(){return d}})},399032,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={EntryStatus:function(){return y},canNewFetchStrategyProvideMoreContent:function(){return ae},convertRouteTreeToFlightRouterState:function(){return function a(b){let c={};if(null!==b.slots)for(let d in b.slots)c[d]=a(b.slots[d]);return[b.segment,c,null,null,b.isRootLayout]}},createDetachedSegmentCacheEntry:function(){return R},fetchRouteOnCacheMiss:function(){return Y},fetchSegmentOnCacheMiss:function(){return Z},fetchSegmentPrefetchesUsingDynamicRequest:function(){return $},getCurrentCacheVersion:function(){return E},getStaleTimeMs:function(){return x},overwriteRevalidatingSegmentCacheEntry:function(){return P},pingInvalidationListeners:function(){return G},readOrCreateRevalidatingSegmentEntry:function(){return O},readOrCreateRouteCacheEntry:function(){return K},readOrCreateSegmentCacheEntry:function(){return N},readRouteCacheEntry:function(){return H},readSegmentCacheEntry:function(){return I},requestOptimisticRouteCacheEntry:function(){return L},revalidateEntireCache:function(){return F},upgradeToPendingSegment:function(){return S},upsertSegmentEntry:function(){return Q},waitForSegmentCacheEntry:function(){return J}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(476e3),h=a.r(537909),i=a.r(120873),j=a.r(942297),k=a.r(91442),l=a.r(691377),m=a.r(74685),n=a.r(192702),o=a.r(323187),p=a.r(851561),q=a.r(158216),r=a.r(522129),s=a.r(323053),t=a.r(116441),u=a.r(739118),v=a.r(510846),w=a.r(554427);function x(a){return 1e3*Math.max(a,30)}var y=((d={})[d.Empty=0]="Empty",d[d.Pending=1]="Pending",d[d.Fulfilled=2]="Fulfilled",d[d.Rejected=3]="Rejected",d);let z=["",{},null,"metadata-only"],A=(0,p.createCacheMap)(),B=(0,p.createCacheMap)(),C=null,D=0;function E(){return D}function F(a,b){D++,(0,j.startRevalidationCooldown)(),(0,t.pingVisibleLinks)(a,b),G(a,b)}function G(a,b){if(null!==C){let c=C;for(let d of(C=null,c))(0,j.isPrefetchTaskDirty)(d,a,b)&&function(a){let b=a.onInvalidate;if(null!==b){a.onInvalidate=null;try{b()}catch(a){"function"==typeof reportError?reportError(a):console.error(a)}}}(d)}}function H(a,b){let c=(0,k.getRouteVaryPath)(b.pathname,b.search,b.nextUrl);return(0,p.getFromCacheMap)(a,D,A,c,!1)}function I(a,b){return(0,p.getFromCacheMap)(a,D,B,b,!1)}function J(a){let b=a.promise;return null===b&&(b=a.promise=(0,w.createPromiseWithResolvers)()),b.promise}function K(a,b,c){null!==b.onInvalidate&&(null===C?C=new Set([b]):C.add(b));let d=H(a,c);if(null!==d)return d;let e={canonicalUrl:null,status:0,blockedTasks:null,tree:null,metadata:null,couldBeIntercepted:!0,isPPREnabled:!1,renderedSearch:null,ref:null,size:0,staleAt:1/0,version:D},f=(0,k.getRouteVaryPath)(c.pathname,c.search,c.nextUrl);return(0,p.setInCacheMap)(A,f,e,!1),e}function L(a,b,c){let d=b.search;if(""===d)return null;let e=new URL(b);e.search="";let f=H(a,(0,n.createCacheKey)(e.href,c));if(null===f||2!==f.status)return null;let g=new URL(f.canonicalUrl,b.origin),h=""!==g.search?g.search:d,i=""!==f.renderedSearch?f.renderedSearch:d,j=new URL(f.canonicalUrl,location.origin);return j.search=h,{canonicalUrl:(0,m.createHrefFromUrl)(j),status:2,blockedTasks:null,tree:M(f.tree,i),metadata:M(f.metadata,i),couldBeIntercepted:f.couldBeIntercepted,isPPREnabled:f.isPPREnabled,renderedSearch:i,ref:null,size:0,staleAt:f.staleAt,version:f.version}}function M(a,b){let c=null,d=a.slots;if(null!==d)for(let a in c={},d){let e=d[a];c[a]=M(e,b)}return a.isPage?{requestKey:a.requestKey,segment:a.segment,varyPath:(0,k.clonePageVaryPathWithNewSearchParams)(a.varyPath,b),isPage:!0,slots:c,isRootLayout:a.isRootLayout,hasLoadingBoundary:a.hasLoadingBoundary,hasRuntimePrefetch:a.hasRuntimePrefetch}:{requestKey:a.requestKey,segment:a.segment,varyPath:a.varyPath,isPage:!1,slots:c,isRootLayout:a.isRootLayout,hasLoadingBoundary:a.hasLoadingBoundary,hasRuntimePrefetch:a.hasRuntimePrefetch}}function N(a,b,c,d){let e=I(a,d.varyPath);if(null!==e)return e;let f=(0,k.getSegmentVaryPathForRequest)(b,d),g=R(c.staleAt);return(0,p.setInCacheMap)(B,f,g,!1),g}function O(a,b,c,d){var e;let f=(e=d.varyPath,(0,p.getFromCacheMap)(a,D,B,e,!0));if(null!==f)return f;let g=(0,k.getSegmentVaryPathForRequest)(b,d),h=R(c.staleAt);return(0,p.setInCacheMap)(B,g,h,!0),h}function P(a,b,c){let d=(0,k.getSegmentVaryPathForRequest)(a,c),e=R(b.staleAt);return(0,p.setInCacheMap)(B,d,e,!0),e}function Q(a,b,c){if((0,p.isValueExpired)(a,D,c))return null;let d=I(a,b);if(null!==d){var e;if(c.fetchStrategy!==d.fetchStrategy&&(e=d.fetchStrategy,!(e<c.fetchStrategy))||!d.isPartial&&c.isPartial)return c.status=3,c.loading=null,c.rsc=null,null;(0,p.deleteFromCacheMap)(d)}return(0,p.setInCacheMap)(B,b,c,!1),c}function R(a){return{status:0,fetchStrategy:v.FetchStrategy.PPR,rsc:null,loading:null,isPartial:!0,promise:null,ref:null,size:0,staleAt:a,version:0}}function S(a,b){return a.status=1,a.fetchStrategy=b,b===v.FetchStrategy.Full&&(a.isPartial=!1),a.version=D,a}function T(a){let b=a.blockedTasks;if(null!==b){for(let a of b)(0,j.pingPrefetchTask)(a);a.blockedTasks=null}}function U(a,b,c,d,e,f,h,i){let j={requestKey:q.HEAD_REQUEST_KEY,segment:q.HEAD_REQUEST_KEY,varyPath:c,isPage:!0,slots:null,isRootLayout:!1,hasLoadingBoundary:g.HasLoadingBoundary.SubtreeHasNoLoadingBoundary,hasRuntimePrefetch:!1};return a.status=2,a.tree=b,a.metadata=j,a.staleAt=d,a.couldBeIntercepted=e,a.canonicalUrl=f,a.renderedSearch=h,a.isPPREnabled=i,T(a),a}function V(a,b,c,d,e){return a.status=2,a.rsc=b,a.loading=c,a.staleAt=d,a.isPartial=e,null!==a.promise&&(a.promise.resolve(a),a.promise=null),a}function W(a,b){a.status=3,a.staleAt=b,T(a)}function X(a,b){a.status=3,a.staleAt=b,null!==a.promise&&(a.promise.resolve(null),a.promise=null)}async function Y(a,b,c){let d=c.pathname,e=c.search,f=c.nextUrl,j={[h.RSC_HEADER]:"1",[h.NEXT_ROUTER_PREFETCH_HEADER]:"1",[h.NEXT_ROUTER_SEGMENT_PREFETCH_HEADER]:"/_tree"};null!==f&&(j[h.NEXT_URL]=f);try{let c,n,t=new URL(d+e,location.origin);if(c=await ac(t,j),n=null!==c&&c.redirected?new URL(c.url):t,!c||!c.ok||204===c.status||!c.body)return W(a,Date.now()+1e4),null;let y=(0,m.createHrefFromUrl)(n),z=c.headers.get("vary"),B=null!==z&&z.includes(h.NEXT_URL),C=(0,w.createPromiseWithResolvers)(),D="2"===c.headers.get(h.NEXT_DID_POSTPONE_HEADER);if(D){let b,d,e=ad(c.body,C.resolve,function(b){(0,p.setSizeInCacheMap)(a,b)}),f=await (0,i.createFromNextReadableStream)(e,j);if(f.buildId!==(0,l.getAppBuildId)())return W(a,Date.now()+1e4),null;let h=(0,o.getRenderedPathname)(c),m=(0,o.getRenderedSearch)(c),n={metadataVaryPath:null},r=(b=h.split("/").filter(a=>""!==a),d=q.ROOT_SEGMENT_REQUEST_KEY,function a(b,c,d,e,f,h,i,j){let l,m,n=null,p=b.slots;if(null!==p)for(let b in l=!1,m=(0,k.finalizeLayoutVaryPath)(e,d),n={},p){let c,g,l,m=p[b],r=m.name,s=m.paramType,t=m.paramKey;if(null!==s){let a=(0,o.parseDynamicParamFromURLPart)(s,f,h),b=null!==t?t:(0,o.getCacheKeyForDynamicParam)(a,"");l=(0,k.appendLayoutVaryPath)(d,b),g=[r,b,s],c=!0}else l=d,g=r,c=(0,o.doesStaticSegmentAppearInURL)(r);let u=c?h+1:h,v=(0,q.createSegmentRequestKeyPart)(g),w=(0,q.appendSegmentRequestKeyPart)(e,b,v);n[b]=a(m,g,l,w,f,u,i,j)}else e.endsWith(u.PAGE_SEGMENT_KEY)?(l=!0,m=(0,k.finalizePageVaryPath)(e,i,d),null===j.metadataVaryPath&&(j.metadataVaryPath=(0,k.finalizeMetadataVaryPath)(e,i,d))):(l=!1,m=(0,k.finalizeLayoutVaryPath)(e,d));return{requestKey:e,segment:c,varyPath:m,isPage:l,slots:n,isRootLayout:b.isRootLayout,hasLoadingBoundary:g.HasLoadingBoundary.SegmentHasLoadingBoundary,hasRuntimePrefetch:b.hasRuntimePrefetch}}(f.tree,d,null,q.ROOT_SEGMENT_REQUEST_KEY,b,0,m,n)),s=n.metadataVaryPath;if(null===s)return W(a,Date.now()+1e4),null;let t=x(f.staleTime);U(a,r,s,Date.now()+t,B,y,m,D)}else{let d=ad(c.body,C.resolve,function(b){(0,p.setSizeInCacheMap)(a,b)}),e=await (0,i.createFromNextReadableStream)(d,j);if(e.b!==(0,l.getAppBuildId)())return W(a,Date.now()+1e4),null;!function(a,b,c,d,e,f,i,j,l){let m=(0,o.getRenderedSearch)(d),n=(0,r.normalizeFlightData)(e.f);if("string"==typeof n||1!==n.length)return W(f,a+1e4);let p=n[0];if(!p.isRootRender)return W(f,a+1e4);let t=p.tree,v="number"==typeof e.rp?.[1]?e.rp[1]:parseInt(d.headers.get(h.NEXT_ROUTER_STALE_TIME_HEADER)??"",10),w=isNaN(v)?s.STATIC_STALETIME_MS:x(v),y="1"===d.headers.get(h.NEXT_DID_POSTPONE_HEADER),z={metadataVaryPath:null},A=function a(b,c,d,e,f){let h,i,j,l,m=b[0];if(Array.isArray(m)){j=!1;let a=m[1];i=(0,k.appendLayoutVaryPath)(d,a),l=(0,k.finalizeLayoutVaryPath)(c,i),h=m}else i=d,c.endsWith(u.PAGE_SEGMENT_KEY)?(j=!0,h=u.PAGE_SEGMENT_KEY,l=(0,k.finalizePageVaryPath)(c,e,i),null===f.metadataVaryPath&&(f.metadataVaryPath=(0,k.finalizeMetadataVaryPath)(c,e,i))):(j=!1,h=m,l=(0,k.finalizeLayoutVaryPath)(c,i));let n=null,o=b[1];for(let b in o){let d=o[b],g=d[0],h=(0,q.createSegmentRequestKeyPart)(g),j=a(d,(0,q.appendSegmentRequestKeyPart)(c,b,h),i,e,f);null===n?n={[b]:j}:n[b]=j}return{requestKey:c,segment:h,varyPath:l,isPage:j,slots:n,isRootLayout:!0===b[4],hasLoadingBoundary:void 0!==b[5]?b[5]:g.HasLoadingBoundary.SubtreeHasNoLoadingBoundary,hasRuntimePrefetch:!1}}(t,q.ROOT_SEGMENT_REQUEST_KEY,null,m,z),B=z.metadataVaryPath;if(null===B)return W(f,a+1e4);let C=U(f,A,B,a+w,i,j,m,l);aa(a,b,c,d,e,y,C,null)}(Date.now(),b,v.FetchStrategy.LoadingBoundary,c,e,a,B,y,D)}if(!B){let b=(0,k.getFulfilledRouteVaryPath)(d,e,f,B);(0,p.setInCacheMap)(A,b,a,!1)}return{value:null,closed:C.promise}}catch(b){return W(a,Date.now()+1e4),null}}async function Z(a,b,c,d){let e=new URL(a.canonicalUrl,location.origin),f=c.nextUrl,g=d.requestKey,j=g===q.ROOT_SEGMENT_REQUEST_KEY?"/_index":g,k={[h.RSC_HEADER]:"1",[h.NEXT_ROUTER_PREFETCH_HEADER]:"1",[h.NEXT_ROUTER_SEGMENT_PREFETCH_HEADER]:j};null!==f&&(k[h.NEXT_URL]=f);try{let c=await ac(e,k);if(!c||!c.ok||204===c.status||"2"!==c.headers.get(h.NEXT_DID_POSTPONE_HEADER)||!c.body)return X(b,Date.now()+1e4),null;let d=(0,w.createPromiseWithResolvers)(),f=ad(c.body,d.resolve,function(a){(0,p.setSizeInCacheMap)(b,a)}),g=await (0,i.createFromNextReadableStream)(f,k);if(g.buildId!==(0,l.getAppBuildId)())return X(b,Date.now()+1e4),null;return{value:V(b,g.rsc,g.loading,a.staleAt,g.isPartial),closed:d.promise}}catch(a){return X(b,Date.now()+1e4),null}}async function $(a,b,c,d,e){let f=a.key,g=new URL(b.canonicalUrl,location.origin),j=f.nextUrl;1===e.size&&e.has(b.metadata.requestKey)&&(d=z);let k={[h.RSC_HEADER]:"1",[h.NEXT_ROUTER_STATE_TREE_HEADER]:(0,r.prepareFlightRouterStateForRequest)(d)};switch(null!==j&&(k[h.NEXT_URL]=j),c){case v.FetchStrategy.Full:break;case v.FetchStrategy.PPRRuntime:k[h.NEXT_ROUTER_PREFETCH_HEADER]="2";break;case v.FetchStrategy.LoadingBoundary:k[h.NEXT_ROUTER_PREFETCH_HEADER]="1"}try{let d=await ac(g,k);if(!d||!d.ok||!d.body||(0,o.getRenderedSearch)(d)!==b.renderedSearch)return _(e,Date.now()+1e4),null;let f=(0,w.createPromiseWithResolvers)(),h=null,j=ad(d.body,f.resolve,function(a){if(null===h)return;let b=a/h.length;for(let a of h)(0,p.setSizeInCacheMap)(a,b)}),l=await (0,i.createFromNextReadableStream)(j,k),m=c===v.FetchStrategy.PPRRuntime&&l.rp?.[0]===!0;return h=aa(Date.now(),a,c,d,l,m,b,e),{value:null,closed:f.promise}}catch(a){return _(e,Date.now()+1e4),null}}function _(a,b){let c=[];for(let d of a.values())1===d.status?X(d,b):2===d.status&&c.push(d);return c}function aa(a,b,c,d,e,f,g,i){if(e.b!==(0,l.getAppBuildId)())return null!==i&&_(i,a+1e4),null;let j=(0,r.normalizeFlightData)(e.f);if("string"==typeof j)return null;let k="number"==typeof e.rp?.[1]?e.rp[1]:parseInt(d.headers.get(h.NEXT_ROUTER_STALE_TIME_HEADER)??"",10),m=a+(isNaN(k)?s.STATIC_STALETIME_MS:x(k));for(let d of j){let e=d.seedData;if(null!==e){let h=d.segmentPath,j=g.tree;for(let b=0;b<h.length;b+=2){let c=h[b];if(j?.slots?.[c]===void 0)return null!==i&&_(i,a+1e4),null;j=j.slots[c]}!function a(b,c,d,e,f,g,h,i,j){let k=h[0];ab(b,d,e,k,h[2],null===k||i,g,f,j);let l=f.slots;if(null!==l){let f=h[1];for(let h in l){let k=l[h],m=f[h];null!=m&&a(b,c,d,e,k,g,m,i,j)}}}(a,b,c,g,j,m,e,f,i)}let h=d.head;null!==h&&ab(a,c,g,h,null,d.isHeadPartial,m,g.metadata,i)}return null!==i?_(i,a+1e4):null}function ab(a,b,c,d,e,f,g,h,i){let j=null!==i?i.get(h.requestKey):void 0;if(void 0!==j)V(j,d,e,g,f);else{let i=N(a,b,c,h);if(0===i.status)V(S(i,b),d,e,g,f);else{let c=V(S(R(g),b),d,e,g,f);Q(a,(0,k.getSegmentVaryPathForRequest)(b,h),c)}}}async function ac(a,b){let c=await (0,i.createFetch)(a,b,"low",!1);if(!c.ok)return null;{let a=c.headers.get("content-type");if(!(a&&a.startsWith(h.RSC_CONTENT_TYPE_HEADER)))return null}return c}function ad(a,b,c){let d=0,e=a.getReader();return new ReadableStream({async pull(a){for(;;){let{done:f,value:g}=await e.read();if(!f){a.enqueue(g),c(d+=g.byteLength);continue}b();return}}})}function ae(a,b){return a<b}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},942297,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={cancelPrefetchTask:function(){return v},isPrefetchTaskDirty:function(){return x},pingPrefetchTask:function(){return D},reschedulePrefetchTask:function(){return w},schedulePrefetchTask:function(){return u},startRevalidationCooldown:function(){return t}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(476e3),g=a.r(730641),h=a.r(399032),i=a.r(91442),j=a.r(192702),k=a.r(510846),l=a.r(739118),m="function"==typeof queueMicrotask?queueMicrotask:a=>Promise.resolve().then(a).catch(a=>setTimeout(()=>{throw a})),n=[],o=0,p=0,q=!1,r=null,s=null;function t(){null!==s&&clearTimeout(s),s=setTimeout(()=>{s=null,z()},300)}function u(a,b,c,d,e){let f={key:a,treeAtTimeOfPrefetch:b,cacheVersion:(0,h.getCurrentCacheVersion)(),priority:d,phase:1,hasBackgroundWork:!1,spawnedRuntimePrefetches:null,fetchStrategy:c,sortId:p++,isCanceled:!1,onInvalidate:e,_heapIndex:-1};return y(f),P(n,f),z(),f}function v(a){a.isCanceled=!0,function(a,b){let c=b._heapIndex;if(-1!==c&&(b._heapIndex=-1,0!==a.length)){let d=a.pop();d!==b&&(a[c]=d,d._heapIndex=c,U(a,d,c))}}(n,a)}function w(a,b,c,d){a.isCanceled=!1,a.phase=1,a.sortId=p++,a.priority=a===r?k.PrefetchPriority.Intent:d,a.treeAtTimeOfPrefetch=b,a.fetchStrategy=c,y(a),-1!==a._heapIndex?S(n,a):P(n,a),z()}function x(a,b,c){let d=(0,h.getCurrentCacheVersion)();return a.cacheVersion!==d||a.treeAtTimeOfPrefetch!==c||a.key.nextUrl!==b}function y(a){a.priority===k.PrefetchPriority.Intent&&a!==r&&(null!==r&&r.priority!==k.PrefetchPriority.Background&&(r.priority=k.PrefetchPriority.Default,S(n,r)),r=a)}function z(){q||(q=!0,m(E))}function A(a){return null===s&&(a.priority===k.PrefetchPriority.Intent?o<12:o<4)}function B(a){return o++,a.then(a=>null===a?(C(),null):(a.closed.then(C),a.value))}function C(){o--,z()}function D(a){a.isCanceled||-1!==a._heapIndex||(P(n,a),z())}function E(){q=!1;let a=Date.now(),b=Q(n);for(;null!==b&&A(b);){b.cacheVersion=(0,h.getCurrentCacheVersion)();let c=function(a,b){let c=b.key,d=(0,h.readOrCreateRouteCacheEntry)(a,b,c),e=function(a,b,c){switch(c.status){case h.EntryStatus.Empty:B((0,h.fetchRouteOnCacheMiss)(c,b,b.key)),c.staleAt=a+6e4,c.status=h.EntryStatus.Pending;case h.EntryStatus.Pending:{let a=c.blockedTasks;return null===a?c.blockedTasks=new Set([b]):a.add(b),1}case h.EntryStatus.Rejected:break;case h.EntryStatus.Fulfilled:{if(0!==b.phase)return 2;if(!A(b))return 0;let i=c.tree,j=b.fetchStrategy===k.FetchStrategy.PPR?c.isPPREnabled?k.FetchStrategy.PPR:k.FetchStrategy.LoadingBoundary:b.fetchStrategy;switch(j){case k.FetchStrategy.PPR:{var d,e,g;if(I(d=a,e=b,g=c,(0,h.readOrCreateSegmentCacheEntry)(d,k.FetchStrategy.PPR,g,g.metadata),e.key,g.metadata),0===function a(b,c,d,e,f){let g=(0,h.readOrCreateSegmentCacheEntry)(b,c.fetchStrategy,d,f);I(b,c,d,g,c.key,f);let i=e[1],j=f.slots;if(null!==j)for(let e in j){if(!A(c))return 0;let f=j[e],g=f.segment,k=i[e],l=k?.[0];if(0===(void 0!==l&&N(d,g,l)?a(b,c,d,k,f):function a(b,c,d,e){if(e.hasRuntimePrefetch)return null===c.spawnedRuntimePrefetches?c.spawnedRuntimePrefetches=new Set([e.requestKey]):c.spawnedRuntimePrefetches.add(e.requestKey),2;let f=(0,h.readOrCreateSegmentCacheEntry)(b,c.fetchStrategy,d,e);if(I(b,c,d,f,c.key,e),null!==e.slots){if(!A(c))return 0;for(let f in e.slots)if(0===a(b,c,d,e.slots[f]))return 0}return 2}(b,c,d,f)))return 0}return 2}(a,b,c,b.treeAtTimeOfPrefetch,i))return 0;let f=b.spawnedRuntimePrefetches;if(null!==f){let d=new Map;G(a,b,c,d,k.FetchStrategy.PPRRuntime);let e=function a(b,c,d,e,f,g){if(f.has(e.requestKey))return H(b,c,d,e,!1,g,k.FetchStrategy.PPRRuntime);let h={},i=e.slots;if(null!==i)for(let e in i){let j=i[e];h[e]=a(b,c,d,j,f,g)}return[e.segment,h,null,null]}(a,b,c,i,f,d);d.size>0&&B((0,h.fetchSegmentPrefetchesUsingDynamicRequest)(b,c,k.FetchStrategy.PPRRuntime,e,d))}return 2}case k.FetchStrategy.Full:case k.FetchStrategy.PPRRuntime:case k.FetchStrategy.LoadingBoundary:{let d=new Map;G(a,b,c,d,j);let e=function a(b,c,d,e,g,i,j){let l=e[1],m=g.slots,n={};if(null!==m)for(let e in m){let g=m[e],o=g.segment,p=l[e],q=p?.[0];if(void 0!==q&&N(d,o,q)){let f=a(b,c,d,p,g,i,j);n[e]=f}else switch(j){case k.FetchStrategy.LoadingBoundary:{let a=g.hasLoadingBoundary!==f.HasLoadingBoundary.SubtreeHasNoLoadingBoundary?function a(b,c,d,e,g,i){let j=null===g?"inside-shared-layout":null,l=(0,h.readOrCreateSegmentCacheEntry)(b,c.fetchStrategy,d,e);switch(l.status){case h.EntryStatus.Empty:i.set(e.requestKey,(0,h.upgradeToPendingSegment)(l,k.FetchStrategy.LoadingBoundary)),"refetch"!==g&&(j=g="refetch");break;case h.EntryStatus.Fulfilled:if(e.hasLoadingBoundary===f.HasLoadingBoundary.SegmentHasLoadingBoundary)return(0,h.convertRouteTreeToFlightRouterState)(e);case h.EntryStatus.Pending:case h.EntryStatus.Rejected:}let m={};if(null!==e.slots)for(let f in e.slots){let h=e.slots[f];m[f]=a(b,c,d,h,g,i)}return[e.segment,m,null,j,e.isRootLayout]}(b,c,d,g,null,i):(0,h.convertRouteTreeToFlightRouterState)(g);n[e]=a;break}case k.FetchStrategy.PPRRuntime:{let a=H(b,c,d,g,!1,i,j);n[e]=a;break}case k.FetchStrategy.Full:{let a=H(b,c,d,g,!1,i,j);n[e]=a}}}return[g.segment,n,null,null,g.isRootLayout]}(a,b,c,b.treeAtTimeOfPrefetch,i,d,j);return d.size>0&&B((0,h.fetchSegmentPrefetchesUsingDynamicRequest)(b,c,j,e,d)),2}}}}return 2}(a,b,d);if(0!==e&&""!==c.search){let d=new URL(c.pathname,location.origin),e=(0,j.createCacheKey)(d.href,c.nextUrl),f=(0,h.readOrCreateRouteCacheEntry)(a,b,e);switch(f.status){case h.EntryStatus.Empty:F(b)&&(f.status=h.EntryStatus.Pending,B((0,h.fetchRouteOnCacheMiss)(f,b,e)));case h.EntryStatus.Pending:case h.EntryStatus.Fulfilled:case h.EntryStatus.Rejected:}}return e}(a,b),d=b.hasBackgroundWork;switch(b.hasBackgroundWork=!1,b.spawnedRuntimePrefetches=null,c){case 0:return;case 1:R(n),b=Q(n);continue;case 2:1===b.phase?(b.phase=0,S(n,b)):d?(b.priority=k.PrefetchPriority.Background,S(n,b)):R(n),b=Q(n);continue}}}function F(a){return a.priority===k.PrefetchPriority.Background||(a.hasBackgroundWork=!0,!1)}function G(a,b,c,d,e){H(a,b,c,c.metadata,!1,d,e===k.FetchStrategy.LoadingBoundary?k.FetchStrategy.Full:e)}function H(a,b,c,d,e,f,g){let i=(0,h.readOrCreateSegmentCacheEntry)(a,g,c,d),j=null;switch(i.status){case h.EntryStatus.Empty:j=(0,h.upgradeToPendingSegment)(i,g);break;case h.EntryStatus.Fulfilled:i.isPartial&&(0,h.canNewFetchStrategyProvideMoreContent)(i.fetchStrategy,g)&&(j=K(a,c,d,g));break;case h.EntryStatus.Pending:case h.EntryStatus.Rejected:(0,h.canNewFetchStrategyProvideMoreContent)(i.fetchStrategy,g)&&(j=K(a,c,d,g))}let k={};if(null!==d.slots)for(let h in d.slots){let i=d.slots[h];k[h]=H(a,b,c,i,e||null!==j,f,g)}null!==j&&f.set(d.requestKey,j);let l=e||null===j?null:"refetch";return[d.segment,k,null,l,d.isRootLayout]}function I(a,b,c,d,e,f){switch(d.status){case h.EntryStatus.Empty:B((0,h.fetchSegmentOnCacheMiss)(c,(0,h.upgradeToPendingSegment)(d,k.FetchStrategy.PPR),e,f));break;case h.EntryStatus.Pending:switch(d.fetchStrategy){case k.FetchStrategy.PPR:case k.FetchStrategy.PPRRuntime:case k.FetchStrategy.Full:break;case k.FetchStrategy.LoadingBoundary:F(b)&&J(a,c,e,f);break;default:d.fetchStrategy}break;case h.EntryStatus.Rejected:switch(d.fetchStrategy){case k.FetchStrategy.PPR:case k.FetchStrategy.PPRRuntime:case k.FetchStrategy.Full:break;case k.FetchStrategy.LoadingBoundary:J(a,c,e,f);break;default:d.fetchStrategy}case h.EntryStatus.Fulfilled:}}function J(a,b,c,d){let e=(0,h.readOrCreateRevalidatingSegmentEntry)(a,k.FetchStrategy.PPR,b,d);switch(e.status){case h.EntryStatus.Empty:M(B((0,h.fetchSegmentOnCacheMiss)(b,(0,h.upgradeToPendingSegment)(e,k.FetchStrategy.PPR),c,d)),(0,i.getSegmentVaryPathForRequest)(k.FetchStrategy.PPR,d));case h.EntryStatus.Pending:case h.EntryStatus.Fulfilled:case h.EntryStatus.Rejected:}}function K(a,b,c,d){let e=(0,h.readOrCreateRevalidatingSegmentEntry)(a,d,b,c);if(e.status===h.EntryStatus.Empty){let a=(0,h.upgradeToPendingSegment)(e,d);return M((0,h.waitForSegmentCacheEntry)(a),(0,i.getSegmentVaryPathForRequest)(d,c)),a}if((0,h.canNewFetchStrategyProvideMoreContent)(e.fetchStrategy,d)){let a=(0,h.overwriteRevalidatingSegmentCacheEntry)(d,b,c),e=(0,h.upgradeToPendingSegment)(a,d);return M((0,h.waitForSegmentCacheEntry)(e),(0,i.getSegmentVaryPathForRequest)(d,c)),e}switch(e.status){case h.EntryStatus.Pending:case h.EntryStatus.Fulfilled:case h.EntryStatus.Rejected:default:return null}}let L=()=>{};function M(a,b){a.then(a=>{null!==a&&(0,h.upsertSegmentEntry)(Date.now(),b,a)},L)}function N(a,b,c){return c===l.PAGE_SEGMENT_KEY?b===(0,l.addSearchParamsIfPageSegment)(l.PAGE_SEGMENT_KEY,Object.fromEntries(new URLSearchParams(a.renderedSearch))):(0,g.matchSegment)(c,b)}function O(a,b){let c=b.priority-a.priority;if(0!==c)return c;let d=b.phase-a.phase;return 0!==d?d:b.sortId-a.sortId}function P(a,b){let c=a.length;a.push(b),b._heapIndex=c,T(a,b,c)}function Q(a){return 0===a.length?null:a[0]}function R(a){if(0===a.length)return null;let b=a[0];b._heapIndex=-1;let c=a.pop();return c!==b&&(a[0]=c,c._heapIndex=0,U(a,c,0)),b}function S(a,b){let c=b._heapIndex;-1!==c&&(0===c?U(a,b,0):O(a[c-1>>>1],b)>0?T(a,b,c):U(a,b,c))}function T(a,b,c){let d=c;for(;d>0;){let c=d-1>>>1,e=a[c];if(!(O(e,b)>0))return;a[c]=b,b._heapIndex=c,a[d]=e,e._heapIndex=d,d=c}}function U(a,b,c){let d=c,e=a.length,f=e>>>1;for(;d<f;){let c=(d+1)*2-1,f=a[c],g=c+1,h=a[g];if(0>O(f,b))g<e&&0>O(h,f)?(a[d]=h,h._heapIndex=d,a[g]=b,b._heapIndex=g,d=g):(a[d]=f,f._heapIndex=d,a[c]=b,b._heapIndex=c,d=c);else{if(!(g<e&&0>O(h,b)))return;a[d]=h,h._heapIndex=d,a[g]=b,b._heapIndex=g,d=g}}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},116441,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={IDLE_LINK_STATUS:function(){return l},PENDING_LINK_STATUS:function(){return k},mountFormInstance:function(){return t},mountLinkInstance:function(){return s},onLinkVisibilityChanged:function(){return v},onNavigationIntent:function(){return w},pingVisibleLinks:function(){return y},setLinkForCurrentNavigation:function(){return m},unmountLinkForCurrentNavigation:function(){return n},unmountPrefetchableInstance:function(){return u}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(510846),g=a.r(192702),h=a.r(942297),i=a.r(572131),j=null,k={pending:!0},l={pending:!1};function m(a){(0,i.startTransition)(()=>{j?.setOptimisticLinkStatus(l),a?.setOptimisticLinkStatus(k),j=a})}function n(a){j===a&&(j=null)}let o="function"==typeof WeakMap?new WeakMap:new Map,p=new Set,q="function"==typeof IntersectionObserver?new IntersectionObserver(function(a){for(let b of a){let a=b.intersectionRatio>0;v(b.target,a)}},{rootMargin:"200px"}):null;function r(a,b){void 0!==o.get(a)&&u(a),o.set(a,b),null!==q&&q.observe(a)}function s(a,b,c,d,e,f){if(e){let b=null;if(null!==b){let e={router:c,fetchStrategy:d,isVisible:!1,prefetchTask:null,prefetchHref:b.href,setOptimisticLinkStatus:f};return r(a,e),e}}return{router:c,fetchStrategy:d,isVisible:!1,prefetchTask:null,prefetchHref:null,setOptimisticLinkStatus:f}}function t(a,b,c,d){let e=null;null===e||r(a,{router:c,fetchStrategy:d,isVisible:!1,prefetchTask:null,prefetchHref:e.href,setOptimisticLinkStatus:null})}function u(a){let b=o.get(a);if(void 0!==b){o.delete(a),p.delete(b);let c=b.prefetchTask;null!==c&&(0,h.cancelPrefetchTask)(c)}null!==q&&q.unobserve(a)}function v(a,b){let c=o.get(a);void 0!==c&&(c.isVisible=b,b?p.add(c):p.delete(c),x(c,f.PrefetchPriority.Default))}function w(a,b){let c=o.get(a);void 0!==c&&void 0!==c&&x(c,f.PrefetchPriority.Intent)}function x(a,b){}function y(a,b){for(let c of p){let d=c.prefetchTask;if(null!==d&&!(0,h.isPrefetchTaskDirty)(d,a,b))continue;null!==d&&(0,h.cancelPrefetchTask)(d);let e=(0,g.createCacheKey)(c.prefetchHref,a);c.prefetchTask=(0,h.schedulePrefetchTask)(e,b,c.fetchStrategy,f.PrefetchPriority.Default,null)}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},611679,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"pathHasPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(908868);function e(a,b){if("string"!=typeof a)return!1;let{pathname:c}=(0,d.parsePath)(a);return c===b||c.startsWith(b+"/")}},278897,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"hasBasePath",{enumerable:!0,get:function(){return e}});let d=a.r(611679);function e(a){return(0,d.pathHasPrefix)(a,"")}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},11762,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isLocalURL",{enumerable:!0,get:function(){return f}});let d=a.r(946272),e=a.r(278897);function f(a){if(!(0,d.isAbsoluteUrl)(a))return!0;try{let b=(0,d.getLocationOrigin)(),c=new URL(a,b);return c.origin===b&&(0,e.hasBasePath)(c.pathname)}catch(a){return!1}}},509833,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"errorOnce",{enumerable:!0,get:function(){return d}});let d=a=>{}},238246,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={default:function(){return q},useLinkStatus:function(){return s}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(346058),g=a.r(187924),h=f._(a.r(572131)),i=a.r(143087),j=a.r(909270),k=a.r(808591),l=a.r(946272),m=a.r(138243);a.r(192434);let n=a.r(116441);a.r(11762);let o=a.r(510846);function p(a){return"string"==typeof a?a:(0,i.formatUrl)(a)}function q(a){var b;let c,d,e,[f,i]=(0,h.useOptimistic)(n.IDLE_LINK_STATUS),q=(0,h.useRef)(null),{href:s,as:t,children:u,prefetch:v=null,passHref:w,replace:x,shallow:y,scroll:z,onClick:A,onMouseEnter:B,onTouchStart:C,legacyBehavior:D=!1,onNavigate:E,ref:F,unstable_dynamicOnHover:G,...H}=a;c=u,D&&("string"==typeof c||"number"==typeof c)&&(c=(0,g.jsx)("a",{children:c}));let I=h.default.useContext(j.AppRouterContext),J=!1!==v,K=!1!==v?null===(b=v)||"auto"===b?o.FetchStrategy.PPR:o.FetchStrategy.Full:o.FetchStrategy.PPR,{href:L,as:M}=h.default.useMemo(()=>{let a=p(s);return{href:a,as:t?p(t):a}},[s,t]);if(D){if(c?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});d=h.default.Children.only(c)}let N=D?d&&"object"==typeof d&&d.ref:F,O=h.default.useCallback(a=>(null!==I&&(q.current=(0,n.mountLinkInstance)(a,L,I,K,J,i)),()=>{q.current&&((0,n.unmountLinkForCurrentNavigation)(q.current),q.current=null),(0,n.unmountPrefetchableInstance)(a)}),[J,L,I,K,i]),P={ref:(0,k.useMergedRef)(O,N),onClick(a){if((D||"function"!=typeof A||A(a),D&&d.props&&"function"==typeof d.props.onClick&&d.props.onClick(a),I)&&!a.defaultPrevented);},onMouseEnter(a){D||"function"!=typeof B||B(a),D&&d.props&&"function"==typeof d.props.onMouseEnter&&d.props.onMouseEnter(a),I&&J&&(0,n.onNavigationIntent)(a.currentTarget,!0===G)},onTouchStart:function(a){D||"function"!=typeof C||C(a),D&&d.props&&"function"==typeof d.props.onTouchStart&&d.props.onTouchStart(a),I&&J&&(0,n.onNavigationIntent)(a.currentTarget,!0===G)}};return(0,l.isAbsoluteUrl)(M)?P.href=M:D&&!w&&("a"!==d.type||"href"in d.props)||(P.href=(0,m.addBasePath)(M)),e=D?h.default.cloneElement(d,P):(0,g.jsx)("a",{...H,...P,children:c}),(0,g.jsx)(r.Provider,{value:f,children:e})}a.r(509833);let r=(0,h.createContext)(n.IDLE_LINK_STATUS),s=()=>(0,h.useContext)(r);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},526691,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(391956),e=a.i(169819),f=a.i(100260),g=a.i(662432),h=a.i(866102),i=a.i(737139),j=a.i(50944),k=a.i(405050);let l=(0,k.createServerReference)("600ac80e87b60a5c02e2c4c1f0b6a0a7dc2d33be23",k.callServer,void 0,k.findSourceMapURL,"getCustomerStatsAction");var m=a.i(333140);let n=()=>(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsx)("div",{className:"bg-white rounded-lg border p-6",children:(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.Skeleton,{className:"h-8 w-64"}),(0,b.jsx)(m.Skeleton,{className:"h-4 w-96"})]}),(0,b.jsx)(m.Skeleton,{className:"h-10 w-40"})]})}),(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(m.Skeleton,{className:"h-24"},c))}),(0,b.jsx)("div",{className:"bg-white rounded-lg border",children:(0,b.jsx)("div",{className:"p-6",children:(0,b.jsx)(m.Skeleton,{className:"h-40"})})})]});var o=a.i(699570),p=a.i(170106);let q=(0,p.default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var r=a.i(660246),s=a.i(284505),t=a.i(104720),u=a.i(256711),v=a.i(932596),w=a.i(478793);let x=({customers:a,currency:c,businessName:d,businessLogo:e,getCategoryName:f,getCustomerLifetimePurchases:g})=>{let{toast:h}=(0,w.useToast)();return 0===a.length?null:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{try{((a,b="UGX",c,d)=>{if(0===a.length)return alert("No customers to export");let e=new Blob([[["Full Name","Phone Number","Email","Gender","Location","Birthday","Category","Lifetime Value","Total Orders","Notes","Tags","Created Date"],...a.map(a=>{let b=d?d(a.fullName):{total:0,count:0};return[`"${(a.fullName||"").replace(/"/g,'""')}"`,`"${(a.phoneNumber||"").replace(/"/g,'""')}"`,`"${(a.email||"").replace(/"/g,'""')}"`,`"${(a.gender||"").replace(/"/g,'""')}"`,`"${(a.location||"").replace(/"/g,'""')}"`,a.birthday?(0,u.format)(new Date(a.birthday),"yyyy-MM-dd"):"",`"${c(a.categoryId||null).replace(/"/g,'""')}"`,b.total.toFixed(2),b.count.toString(),`"${(a.notes||"").replace(/"/g,'""')}"`,`"${(a.tags||[]).join(", ").replace(/"/g,'""')}"`,(0,u.format)(new Date(a.createdAt),"yyyy-MM-dd HH:mm:ss")]})].map(a=>a.join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),f=document.createElement("a");if(void 0!==f.download){let a=URL.createObjectURL(e);f.setAttribute("href",a),f.setAttribute("download",`customers-${b}-${(0,u.format)(new Date,"yyyy-MM-dd")}.csv`),f.style.visibility="hidden",document.body.appendChild(f),f.click(),document.body.removeChild(f)}})(a,c,f,g),h({title:"Success",description:`Exported ${a.length} customers to CSV`})}catch(a){console.error("Error exporting to CSV:",a),h({title:"Error",description:"Failed to export customers to CSV",variant:"destructive"})}},className:"gap-2",children:[(0,b.jsx)(s.Download,{className:"h-4 w-4"}),"Export CSV"]}),(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{try{((a,b,c,d,e,f)=>{if(0===a.length)return alert("No customers to export");let g=new v.default("landscape","mm","a4"),h=g.internal.pageSize.getWidth(),i=g.internal.pageSize.getHeight(),j=10;g.setFontSize(18),g.setFont("helvetica","bold"),g.text(d||"Business Name",10,j),j+=8,g.setFontSize(14),g.text("Customer Report",10,j),j+=6,g.setFontSize(10),g.setFont("helvetica","normal"),g.text(`Generated on: ${(0,u.format)(new Date,"MMMM dd, yyyy")}`,10,j),j+=4,g.text(`Currency: ${c||"UGX"}`,10,j),j+=10;let k=a.length,l={};a.forEach(a=>{let c=b(a.categoryId||null);l[c]=(l[c]||0)+1}),g.setFontSize(12),g.setFont("helvetica","bold"),g.text("Summary:",10,j),j+=6,g.setFontSize(10),g.setFont("helvetica","normal"),g.text(`Total Customers: ${k}`,15,j),j+=6,Object.entries(l).forEach(([a,b])=>{g.text(`${a}: ${b}`,15,j),j+=6}),j+=5;let m=["Name","Phone","Email","Gender","Location","Birthday","Category","Lifetime Value","Orders"],n=[30,20,30,12,25,18,20,25,15],o=n.reduce((a,b)=>a+b,0),p=(h-o)/2,q=a=>j+a>i-10&&(g.addPage(),j=10,g.setFontSize(12),g.setFont("helvetica","bold"),g.text("Customer List",10,j),j+=8,r(),!0),r=()=>{g.setFontSize(10),g.setFont("helvetica","bold"),g.setFillColor(240,240,240),g.rect(p,j,o,8,"F");let a=p;m.forEach((b,c)=>{g.text(b,a+2,j+5),a+=n[c]}),j+=8};g.setFontSize(12),g.setFont("helvetica","bold"),g.text("Customer List",10,j),j+=8,q(15),r(),g.setFont("helvetica","normal"),a.forEach((a,d)=>{q(8),d%2==0&&(g.setFillColor(248,248,248),g.rect(p,j,o,6,"F"));let e=f?f(a.fullName):{total:0,count:0},h=p;[a.fullName||"",a.phoneNumber||"",a.email||"",a.gender||"",a.location||"",a.birthday?(0,u.format)(new Date(a.birthday),"MMM dd"):"",b(a.categoryId||null),`${c||"UGX"} ${e.total.toLocaleString()}`,e.count.toString()].forEach((a,b)=>{let c=n[b],d=a.toString(),e=Math.floor(c/2.5),f=d.length>e?d.substring(0,e-3)+"...":d;g.text(f,h+2,j+4),h+=c}),j+=6});let s=g.getNumberOfPages();for(let a=1;a<=s;a++)g.setPage(a),g.setFontSize(8),g.setFont("helvetica","normal"),g.text(`Page ${a} of ${s}`,h-10-25,i-5);let t=`customers_report_${c||"UGX"}_${(0,u.format)(new Date,"yyyy-MM-dd")}.pdf`;g.save(t)})(a,f,c,d,0,g),h({title:"Success",description:`Exported ${a.length} customers to PDF`})}catch(a){console.error("Error exporting to PDF:",a),h({title:"Error",description:"Failed to export customers to PDF",variant:"destructive"})}},className:"gap-2",children:[(0,b.jsx)(t.FileText,{className:"h-4 w-4"}),"Export PDF"]})]})},y=({onAddNewCustomer:a,onFindDuplicates:c,customers:d=[],currency:e="UGX",businessName:f="Your Business",businessLogo:g,getCategoryName:h=()=>"Uncategorized",getCustomerLifetimePurchases:i,canCreate:j=!0})=>(0,b.jsx)("div",{className:"bg-white rounded-lg border p-6",children:(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Customer Management"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Manage your customer relationships and track their activities"})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,b.jsx)(x,{customers:d,currency:e,businessName:f,businessLogo:g,getCategoryName:h,getCustomerLifetimePurchases:i}),c&&(0,b.jsxs)(o.Button,{onClick:c,variant:"outline",className:"gap-2 px-6 py-3 text-sm font-medium",children:[(0,b.jsx)(r.Users,{className:"h-4 w-4"}),"Find Duplicates"]}),j&&(0,b.jsxs)(o.Button,{onClick:a,className:"gap-2 px-6 py-3 text-sm font-medium",children:[(0,b.jsx)(q,{className:"h-4 w-4"}),"Add New Customer"]})]})]})});var z=a.i(591119),A=a.i(724669),B=a.i(941675);let C=({customerStats:a})=>(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[(0,b.jsxs)(z.Card,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200 hover:shadow-md transition-shadow",children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-semibold text-blue-900",children:"Total Customers"}),(0,b.jsx)("div",{className:"p-2 bg-blue-500 rounded-lg",children:(0,b.jsx)(r.Users,{className:"h-4 w-4 text-white"})})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-3xl font-bold text-blue-900",children:a.totalCustomers}),(0,b.jsx)("p",{className:"text-xs text-blue-700 mt-1",children:"Active customer base"})]})]}),(0,b.jsxs)(z.Card,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200 hover:shadow-md transition-shadow",children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-semibold text-green-900",children:"New This Month"}),(0,b.jsx)("div",{className:"p-2 bg-green-500 rounded-lg",children:(0,b.jsx)(A.TrendingUp,{className:"h-4 w-4 text-white"})})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-3xl font-bold text-green-900",children:a.customersThisMonth}),(0,b.jsx)("p",{className:"text-xs text-green-700 mt-1",children:"Recent acquisitions"})]})]}),(0,b.jsxs)(z.Card,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200 hover:shadow-md transition-shadow",children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-semibold text-purple-900",children:"With Birthdays"}),(0,b.jsx)("div",{className:"p-2 bg-purple-500 rounded-lg",children:(0,b.jsx)(B.Calendar,{className:"h-4 w-4 text-white"})})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-3xl font-bold text-purple-900",children:a.customersWithBirthdays}),(0,b.jsx)("p",{className:"text-xs text-purple-700 mt-1",children:"Special occasions"})]})]})]});var D=a.i(875083),E=a.i(581464);let F=({activeTab:a,selectedCustomer:c})=>(0,b.jsxs)(D.TabsList,{className:"grid w-full grid-cols-2 lg:grid-cols-4 h-14 bg-white border border-gray-200 shadow-sm p-1.5 rounded-lg",children:[(0,b.jsxs)(D.TabsTrigger,{value:"list",className:"flex items-center gap-2.5 text-sm font-medium px-4 py-2.5 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:border-blue-200 data-[state=active]:shadow-sm rounded-md transition-all duration-200",children:[(0,b.jsx)(r.Users,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"All Customers"}),(0,b.jsx)("span",{className:"sm:hidden",children:"All"})]}),(0,b.jsxs)(D.TabsTrigger,{value:"top",className:"flex items-center gap-2.5 text-sm font-medium px-4 py-2.5 data-[state=active]:bg-amber-50 data-[state=active]:text-amber-700 data-[state=active]:border-amber-200 data-[state=active]:shadow-sm rounded-md transition-all duration-200",children:[(0,b.jsx)(A.TrendingUp,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Top Customers"}),(0,b.jsx)("span",{className:"sm:hidden",children:"Top"})]}),(0,b.jsxs)(D.TabsTrigger,{value:"inactive",className:"flex items-center gap-2.5 text-sm font-medium px-4 py-2.5 data-[state=active]:bg-orange-50 data-[state=active]:text-orange-700 data-[state=active]:border-orange-200 data-[state=active]:shadow-sm rounded-md transition-all duration-200",children:[(0,b.jsx)(B.Calendar,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Inactive"}),(0,b.jsx)("span",{className:"sm:hidden",children:"Inactive"})]}),c&&(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(D.TabsTrigger,{value:"details",className:"flex items-center gap-2.5 text-sm font-medium px-4 py-2.5 data-[state=active]:bg-purple-50 data-[state=active]:text-purple-700 data-[state=active]:border-purple-200 data-[state=active]:shadow-sm rounded-md transition-all duration-200",children:[(0,b.jsx)(E.Filter,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Details"}),(0,b.jsx)("span",{className:"sm:hidden",children:"Details"})]})})]});var G=a.i(866718),H=a.i(870430),I=a.i(587532),J=a.i(730769),K=a.i(580701),L=a.i(599209),M=a.i(320146),N=a.i(368114);let O=({activeTab:a,searchTerm:c,setSearchTerm:d,selectedCategory:e,setSelectedCategory:f,dateFilter:g,setDateFilter:h,dateRange:i,setDateRange:j,validCategories:k,filteredCustomers:l,customerStats:m,getCategoryName:n})=>{let p=i||{from:void 0,to:void 0};return"list"!==a&&"top"!==a&&"inactive"!==a?null:(0,b.jsxs)("div",{className:"xl:w-80 w-full space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Search & Filter"}),(0,b.jsx)("p",{className:"text-gray-600 text-sm",children:"Find customers quickly"})]}),"list"===a&&(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(I.Search,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),(0,b.jsx)(G.Input,{placeholder:"Search by name, contact, or location...",autoComplete:"off",className:"pl-12 h-12 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-lg shadow-sm transition-all duration-200",value:c,onChange:a=>d(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(H.Label,{className:"text-sm font-medium",children:"Filter by Category"}),(0,b.jsxs)(K.Select,{value:e,onValueChange:f,children:[(0,b.jsx)(K.SelectTrigger,{className:"h-12",children:(0,b.jsx)(K.SelectValue,{placeholder:"All categories"})}),(0,b.jsxs)(K.SelectContent,{children:[(0,b.jsx)(K.SelectItem,{value:"all",children:"All Categories"}),k.map(a=>(0,b.jsxs)(K.SelectItem,{value:a.id,children:[a.name," (",m.categoryBreakdown[a.id]||0,")"]},a.id))]})]})]}),("top"===a||"list"===a)&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(H.Label,{className:"text-sm font-medium",children:"Filter by Date"}),(0,b.jsxs)(K.Select,{value:g,onValueChange:h,children:[(0,b.jsx)(K.SelectTrigger,{className:"h-12",children:(0,b.jsx)(K.SelectValue,{placeholder:"All time"})}),(0,b.jsxs)(K.SelectContent,{children:[(0,b.jsx)(K.SelectItem,{value:"all",children:"All Time"}),(0,b.jsx)(K.SelectItem,{value:"today",children:"Today"}),(0,b.jsx)(K.SelectItem,{value:"yesterday",children:"Yesterday"}),(0,b.jsx)(K.SelectItem,{value:"this-week",children:"This Week"}),(0,b.jsx)(K.SelectItem,{value:"last-week",children:"Last Week"}),(0,b.jsx)(K.SelectItem,{value:"this-month",children:"This Month"}),(0,b.jsx)(K.SelectItem,{value:"last-month",children:"Last Month"}),(0,b.jsx)(K.SelectItem,{value:"this-year",children:"This Year"}),(0,b.jsx)(K.SelectItem,{value:"custom",children:"Custom Range"})]})]})]}),"custom"===g&&("top"===a||"list"===a)&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(H.Label,{className:"text-sm font-medium",children:"Select Date Range"}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsxs)(L.Popover,{children:[(0,b.jsx)(L.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(o.Button,{variant:"outline",className:(0,N.cn)("w-full justify-start text-left font-normal h-12",!p.from&&"text-muted-foreground"),children:[(0,b.jsx)(J.CalendarIcon,{className:"mr-2 h-4 w-4"}),p.from?(0,u.format)(p.from,"MMM d, yyyy"):"Start Date"]})}),(0,b.jsx)(L.PopoverContent,{className:"w-auto p-0 z-[9999]",align:"start",children:(0,b.jsx)(M.Calendar,{mode:"single",selected:p.from,onSelect:a=>j({...p,from:a}),initialFocus:!0,className:(0,N.cn)("p-3 pointer-events-auto")})})]}),(0,b.jsxs)(L.Popover,{children:[(0,b.jsx)(L.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(o.Button,{variant:"outline",className:(0,N.cn)("w-full justify-start text-left font-normal h-12",!p.to&&"text-muted-foreground"),children:[(0,b.jsx)(J.CalendarIcon,{className:"mr-2 h-4 w-4"}),p.to?(0,u.format)(p.to,"MMM d, yyyy"):"End Date"]})}),(0,b.jsx)(L.PopoverContent,{className:"w-auto p-0 z-[9999]",align:"start",children:(0,b.jsx)(M.Calendar,{mode:"single",selected:p.to,onSelect:a=>j({...p,to:a}),initialFocus:!0,className:(0,N.cn)("p-3 pointer-events-auto")})})]})]})]}),(c||"all"!==e)&&"list"===a&&(0,b.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,b.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,b.jsxs)("p",{className:"text-sm text-blue-700 font-medium",children:["Found ",l.length," customer",1!==l.length?"s":"","all"!==e&&` in ${n(e)}`]})]})]})};var P=a.i(786304),Q=a.i(177156),R=a.i(501199),S=a.i(824569),T=a.i(992258),U=a.i(963519),V=a.i(124987),W=a.i(533350),X=a.i(371844),Y=a.i(770094),Z=a.i(400291),$=a.i(248840);let _=({customers:a,isLoading:e,onSelectCustomer:f,onEditCustomer:g,canEdit:j=!0,canDelete:k=!0})=>{let{user:l}=(0,d.useAuth)(),{getCustomerLifetimePurchases:m}=(0,i.useSalesData)(l?.id),{settings:n}=(0,h.useBusinessSettings)(),p=(0,Y.useIsMobile)(),{canViewTotalAmount:q,canViewSellingPrice:r}=(0,Z.useFinancialVisibility)(),[s,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(null),y=a=>{if(!(q||r))return"";let b=m(a);return`${n.currency} ${(0,N.formatNumber)(b.total)}`},A=a=>{x(a),v(!0)};if(e)return(0,b.jsx)(X.default,{message:"Loading customers..."});if(0===a.length)return(0,b.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"No customers yet"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by adding your first customer"})]});let C=new Map;return(a.forEach(a=>{C.has(a.id)||C.set(a.id,a)}),p)?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"grid grid-cols-1 gap-4",children:Array.from(C.values()).map(a=>(0,b.jsxs)(z.Card,{className:"cursor-pointer hover:shadow-md transition-shadow duration-200 border border-gray-200",onClick:()=>f(a),children:[(0,b.jsx)(z.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg text-gray-900 break-words leading-tight",children:a.fullName}),(0,b.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[(0,b.jsx)(R.Receipt,{className:"h-4 w-4 text-green-600 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm font-medium text-green-600 truncate",children:y(a.fullName)})]})]}),(0,b.jsxs)("div",{className:"flex gap-1 flex-shrink-0",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:b=>{b.stopPropagation(),A(a)},children:(0,b.jsx)(t.FileText,{className:"h-4 w-4"})}),(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:b=>{b.stopPropagation(),f(a)},children:(0,b.jsx)(Q.Eye,{className:"h-4 w-4"})}),j&&(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:b=>{b.stopPropagation(),g(a)},children:(0,b.jsx)(S.Edit,{className:"h-4 w-4"})})]})]})}),(0,b.jsx)(z.CardContent,{className:"pt-0",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[a.email&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)(T.Mail,{className:"h-4 w-4 text-gray-400 flex-shrink-0"}),(0,b.jsx)("span",{className:"truncate",children:a.email})]}),a.phoneNumber&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)(U.Phone,{className:"h-4 w-4 text-gray-400 flex-shrink-0"}),(0,b.jsx)("span",{className:"break-all",children:a.phoneNumber})]}),a.location&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)(V.MapPin,{className:"h-4 w-4 text-gray-400 flex-shrink-0"}),(0,b.jsx)("span",{className:"break-words",children:a.location})]})]}),a.birthday&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)(B.Calendar,{className:"h-4 w-4 text-gray-400 flex-shrink-0"}),(0,b.jsxs)("span",{children:["Birthday: ",(0,u.format)(a.birthday,"MMM d, yyyy")]})]}),a.tags&&a.tags.length>0&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[(0,b.jsx)(W.Tag,{className:"h-3 w-3 flex-shrink-0"}),(0,b.jsx)("span",{children:"Tags"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-1",children:[a.tags.slice(0,3).map((a,c)=>(0,b.jsx)(P.Badge,{variant:"outline",className:"text-xs bg-blue-50 border-blue-200 text-blue-700",children:a},c)),a.tags.length>3&&(0,b.jsxs)(P.Badge,{variant:"outline",className:"text-xs bg-gray-100 border-gray-200",children:["+",a.tags.length-3]})]})]})]})})]},a.id))}),w&&(0,b.jsx)($.default,{customer:w,open:s,onClose:()=>{v(!1),x(null)}})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"bg-white rounded-lg border",children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-gray-50 border-b",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Customer"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Contact"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Lifetime Value"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Tags"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 font-medium text-gray-900",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:Array.from(C.values()).map((a,c)=>(0,b.jsxs)("tr",{className:`border-b hover:bg-gray-50 cursor-pointer transition-colors ${c%2==0?"bg-white":"bg-gray-25"}`,onClick:()=>f(a),children:[(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium text-gray-900 break-words",children:a.fullName}),a.location&&(0,b.jsx)("span",{className:"text-sm text-gray-500 break-words",children:a.location}),a.birthday&&(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:["Birthday: ",(0,u.format)(a.birthday,"MMM d, yyyy")]})]})}),(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"flex flex-col space-y-1",children:[a.email&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)(T.Mail,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),(0,b.jsx)("span",{className:"break-words",children:a.email})]}),a.phoneNumber&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)(U.Phone,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),(0,b.jsx)("span",{className:"break-all",children:a.phoneNumber})]})]})}),(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(R.Receipt,{className:"h-4 w-4 text-green-600 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm font-medium text-green-600",children:y(a.fullName)})]})}),(0,b.jsx)("td",{className:"py-4 px-4",children:a.tags&&a.tags.length>0?(0,b.jsxs)("div",{className:"flex flex-wrap gap-1",children:[a.tags.slice(0,2).map((a,c)=>(0,b.jsx)(P.Badge,{variant:"outline",className:"text-xs bg-blue-50 border-blue-200 text-blue-700",children:a},c)),a.tags.length>2&&(0,b.jsxs)(P.Badge,{variant:"outline",className:"text-xs bg-gray-100 border-gray-200",children:["+",a.tags.length-2]})]}):(0,b.jsx)("span",{className:"text-sm text-gray-400",children:"No tags"})}),(0,b.jsx)("td",{className:"py-4 px-4",children:(0,b.jsxs)("div",{className:"flex gap-1 justify-end",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:b=>{b.stopPropagation(),A(a)},title:"Send Notice",children:(0,b.jsx)(t.FileText,{className:"h-4 w-4"})}),(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:b=>{b.stopPropagation(),f(a)},title:"View Details",children:(0,b.jsx)(Q.Eye,{className:"h-4 w-4"})}),j&&(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:b=>{b.stopPropagation(),g(a)},title:"Edit Customer",children:(0,b.jsx)(S.Edit,{className:"h-4 w-4"})})]})})]},a.id))})]})})}),w&&(0,b.jsx)($.default,{customer:w,open:s,onClose:()=>{v(!1),x(null)}})]})},aa=(0,p.default)("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);var ab=a.i(546842);let ac=(0,p.default)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);var ad=a.i(665967),ae=a.i(750054);let af=({selectedCategory:a="all",dateFilter:e="all",dateRange:g={from:void 0,to:void 0}})=>{let{user:j}=(0,d.useAuth)(),{sales:k,isLoading:l}=(0,i.useSalesData)(j?.id||""),{customers:m}=(0,f.useCustomers)(),{settings:n}=(0,h.useBusinessSettings)(),o=(0,ad.useNavigate)(),[p,q]=c.default.useState(1),r=(()=>{let b=k;if("custom"===e&&g.from&&g.to)b=k.filter(a=>{let b=new Date(a.date);return b>=g.from&&b<=g.to});else if("all"!==e){let a=(0,ae.getDateRangeFromFilter)(e);b=k.filter(b=>{let c=new Date(b.date);return c>=a.from&&c<=a.to})}let c=b.filter(a=>"Quote"!==a.paymentStatus),d=new Map;c.forEach(a=>{let b=a.customerName,c=a.items.reduce((a,b)=>a+b.price*b.quantity,0);if(d.has(b)){let e=d.get(b);d.set(b,{total:e.total+c,count:e.count+1,customerId:e.customerId||a.customerId})}else d.set(b,{total:c,count:1,customerId:a.customerId})});let f=Array.from(d.entries()).map(([a,b])=>({id:b.customerId,name:a,totalPurchases:b.total,orderCount:b.count})).sort((a,b)=>b.totalPurchases-a.totalPurchases);return a&&"all"!==a&&(f=f.filter(b=>{if(b.id){let c=m.find(a=>a.id===b.id);return c?.categoryId===a}let c=m.find(a=>a.fullName===b.name);return c?.categoryId===a})),f})(),s=Math.ceil(r.length/10),t=r.slice((p-1)*10,10*p);return l?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,b.jsx)(X.default,{message:"Loading top customers..."})}):(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)(z.Card,{className:"shadow-lg border-0 bg-gradient-to-br from-white to-gray-50",children:[(0,b.jsxs)(z.CardHeader,{className:"pb-4",children:[(0,b.jsxs)(z.CardTitle,{className:"flex items-center gap-3 text-xl",children:[(0,b.jsx)("div",{className:"p-2 bg-amber-100 rounded-lg",children:(0,b.jsx)(aa,{className:"h-6 w-6 text-amber-600"})}),(0,b.jsx)("span",{className:"text-gray-900 font-bold",children:"Top Customers by Revenue"})]}),(0,b.jsxs)(z.CardDescription,{className:"text-gray-600 text-sm",children:["Customers ranked by total purchase amount (excluding quotes)","all"!==e&&(0,b.jsx)(P.Badge,{variant:"outline",className:"ml-2 bg-purple-50 text-purple-700 border-purple-200",children:"custom"===e?"Custom Range":"today"===e?"Today":"yesterday"===e?"Yesterday":"this-week"===e?"This Week":"last-week"===e?"Last Week":"this-month"===e?"This Month":"last-month"===e?"Last Month":"this-year"===e?"This Year":""}),"all"!==a&&(0,b.jsx)(P.Badge,{variant:"outline",className:"ml-2 bg-blue-50 text-blue-700 border-blue-200",children:"Filtered by category"})]})]}),(0,b.jsx)(z.CardContent,{className:"pt-0",children:0===t.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"w-20 h-20 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,b.jsx)(ab.User,{className:"h-10 w-10 text-gray-400"})}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"all"!==a?"No customers in this category":"No customer data available"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 max-w-md mx-auto",children:"all"!==a?"Try selecting a different category or add customers to this category.":"Sales data will appear here once you have completed transactions."})]}):(0,b.jsxs)("div",{className:"space-y-3",children:[t.map((a,c)=>{let d=(p-1)*10+c;return(0,b.jsxs)("div",{className:"group relative bg-white border border-gray-200 rounded-xl p-3 sm:p-4 hover:shadow-md transition-all duration-200 hover:border-gray-300 cursor-pointer",onClick:()=>((a,b)=>{if(b){let a=m.find(a=>a.id===b);if(a)return void o(`/customers?view=${a.id}`)}let c=m.find(b=>b.fullName===a);c&&o(`/customers?view=${c.id}`)})(a.name,a.id),children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)("div",{className:`
                        w-8 h-8 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center font-bold text-xs sm:text-sm
                        ${0===d?"bg-gradient-to-br from-amber-400 to-amber-600 text-white shadow-lg":1===d?"bg-gradient-to-br from-gray-300 to-gray-500 text-white shadow-md":2===d?"bg-gradient-to-br from-amber-600 to-amber-800 text-white shadow-md":"bg-gradient-to-br from-blue-50 to-blue-100 text-blue-700 border border-blue-200"}
                      `,children:d+1})}),(0,b.jsx)("div",{className:"flex-1 min-w-0",children:(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsx)("h4",{className:"font-semibold text-gray-900 text-sm sm:text-base leading-tight break-words flex-1",children:a.name}),(0,b.jsxs)("div",{className:"flex-shrink-0",children:[0===d&&(0,b.jsx)(P.Badge,{className:"bg-gradient-to-r from-amber-500 to-amber-600 text-white border-0 text-xs font-semibold px-2 py-1 shadow-md",children:""}),1===d&&(0,b.jsx)(P.Badge,{variant:"secondary",className:"bg-gradient-to-r from-gray-400 to-gray-500 text-white border-0 text-xs font-semibold px-2 py-1",children:""}),2===d&&(0,b.jsx)(P.Badge,{variant:"secondary",className:"bg-gradient-to-r from-amber-700 to-amber-800 text-white border-0 text-xs font-semibold px-2 py-1",children:""}),d>2&&(0,b.jsxs)(P.Badge,{variant:"outline",className:"border-gray-300 text-gray-600 text-xs font-medium px-2 py-1 bg-white",children:["#",d+1]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col xs:flex-row xs:items-center gap-2 xs:gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"p-1 bg-green-100 rounded",children:(0,b.jsx)(A.TrendingUp,{className:"h-3 w-3 text-green-600"})}),(0,b.jsxs)("span",{className:"font-bold text-green-700 text-sm",children:[n.currency," ",(0,N.formatNumber)(a.totalPurchases)]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"p-1 bg-blue-100 rounded",children:(0,b.jsx)(ac,{className:"h-3 w-3 text-blue-600"})}),(0,b.jsxs)("span",{className:"text-xs font-medium text-gray-600",children:[a.orderCount," ",1===a.orderCount?"order":"orders"]})]})]})]})})]}),(0,b.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/0 to-purple-500/0 group-hover:from-blue-500/5 group-hover:to-purple-500/5 rounded-xl transition-all duration-200 pointer-events-none"})]},a.id||a.name)}),s>1&&(0,b.jsxs)("div",{className:"flex justify-center mt-6 gap-2",children:[(0,b.jsx)("button",{className:"px-3 py-1 rounded border text-sm font-medium bg-white hover:bg-gray-100 disabled:opacity-50",onClick:()=>q(p-1),disabled:1===p,children:"Previous"}),(0,b.jsxs)("span",{className:"px-2 py-1 text-gray-600 text-sm",children:["Page ",p," of ",s]}),(0,b.jsx)("button",{className:"px-3 py-1 rounded border text-sm font-medium bg-white hover:bg-gray-100 disabled:opacity-50",onClick:()=>q(p+1),disabled:p===s,children:"Next"})]})]})})]})})};var ag=a.i(596221),ah=a.i(292e3);let ai=(0,p.default)("MessageCircleHeart",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}],["path",{d:"M15.8 9.2a2.5 2.5 0 0 0-3.5 0l-.3.4-.35-.3a2.42 2.42 0 1 0-3.2 3.6l3.6 3.5 3.6-3.5c1.2-1.2 1.1-2.7.2-3.7",key:"43lnbm"}]]);var aj=a.i(148817),ak=a.i(668465),al=a.i(724793),am=a.i(823292),an=a.i(814574),ao=a.i(429246),ap=a.i(563588),aq=a.i(123129);let ar=({customer:a,open:d,onClose:e})=>{let{settings:f}=(0,h.useBusinessSettings)(),[g,i]=(0,c.useState)("");(0,c.useEffect)(()=>{a&&d&&i((0,aq.getWeMissYouMessage)(a.fullName))},[a,d]);let j=a?.email&&""!==a.email.trim(),k=a&&(0,aq.canSendSMS)(a);return(0,b.jsx)(an.Dialog,{open:d,onOpenChange:e,children:(0,b.jsxs)(an.DialogContent,{className:"sm:max-w-[600px]",children:[(0,b.jsx)(an.DialogHeader,{children:(0,b.jsxs)(an.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(ap.MessageSquare,{className:"h-5 w-5 text-purple-600"}),'Send "We Miss You" Message']})}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[a&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("p",{className:"text-sm font-medium text-muted-foreground",children:["Sending to: ",(0,b.jsx)("span",{className:"text-foreground font-semibold",children:a.fullName})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 text-sm text-muted-foreground",children:[a.phoneNumber&&(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(U.Phone,{className:"h-3 w-3"}),a.phoneNumber]}),a.email&&(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(T.Mail,{className:"h-3 w-3"}),a.email]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"message",className:"text-sm font-medium",children:"Message"}),(0,b.jsx)(ao.Textarea,{id:"message",value:g,onChange:a=>i(a.target.value),placeholder:"Enter your message...",className:"min-h-[200px] resize-none"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Your business name and signature will be added automatically."})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 pt-4",children:[(0,b.jsxs)(o.Button,{onClick:()=>{if(!a?.phoneNumber)return void am.toast.error("This customer doesn't have a phone number.");if(!g.trim())return void am.toast.error("Please enter a message.");let b=(0,aq.formatMessageForSMS)(g,f.businessName);try{(0,aq.openSMSApp)({phoneNumber:a.phoneNumber,message:b}),am.toast.success("Opening SMS app..."),e()}catch(a){am.toast.error("Failed to open SMS app.")}},disabled:!k||!g.trim(),className:"flex-1 bg-blue-600 hover:bg-blue-700",title:k?"Send via SMS":"No phone number available",children:[(0,b.jsx)(U.Phone,{className:"h-4 w-4 mr-2"}),"Send SMS"]}),(0,b.jsxs)(o.Button,{onClick:()=>{if(!a?.phoneNumber)return void am.toast.error("This customer doesn't have a phone number.");if(!g.trim())return void am.toast.error("Please enter a message.");let b=(0,aq.formatMessageForSMS)(g,f.businessName);try{(0,aq.openWhatsApp)({phoneNumber:a.phoneNumber,message:b}),am.toast.success("Opening WhatsApp..."),e()}catch(a){am.toast.error("Failed to open WhatsApp.")}},disabled:!k||!g.trim(),className:"flex-1 bg-green-600 hover:bg-green-700",title:k?"Send via WhatsApp":"No phone number available",children:[(0,b.jsx)(ap.MessageSquare,{className:"h-4 w-4 mr-2"}),"WhatsApp"]}),(0,b.jsxs)(o.Button,{onClick:()=>{if(!a?.email)return void am.toast.error("This customer doesn't have an email address.");if(!g.trim())return void am.toast.error("Please enter a message.");let b=(0,aq.formatMessageForSMS)(g,f.businessName),c=`mailto:${a.email}?subject=${encodeURIComponent("We Miss You!")}&body=${encodeURIComponent(b)}`;try{window.open(c),am.toast.success("Opening email client..."),e()}catch(a){am.toast.error("Failed to open email client.")}},disabled:!j||!g.trim(),className:"flex-1 bg-purple-600 hover:bg-purple-700",title:j?"Send via Email":"No email address available",children:[(0,b.jsx)(T.Mail,{className:"h-4 w-4 mr-2"}),"Email"]})]}),(0,b.jsx)(o.Button,{onClick:e,variant:"outline",className:"w-full",children:"Cancel"})]})]})})},as=({customers:a,isLoading:e,onSelectCustomer:f,onSendEmail:g,selectedCategory:h="all"})=>{let{user:j}=(0,d.useAuth)(),{sales:k,isLoading:l}=(0,i.useSalesData)(j?.id),[m,n]=(0,c.useState)("30days"),[p,q]=(0,c.useState)(null),r=(0,c.useMemo)(()=>{if(l||e||0===a.length||0===k.length)return[];let b=(()=>{let a=new Date;switch(m){case"30days":default:return(0,aj.subDays)(a,30);case"60days":return(0,aj.subDays)(a,60);case"90days":return(0,aj.subDays)(a,90);case"6months":return(0,ak.subMonths)(a,6);case"1year":return(0,al.subYears)(a,1);case"all":return new Date(0)}})(),c=a;return h&&"all"!==h&&(c=a.filter(a=>a.categoryId===h)),c.filter(a=>{let c=k.filter(b=>b.customerName.toLowerCase()===a.fullName.toLowerCase()&&"Quote"!==b.paymentStatus);return 0===c.length||new Date(Math.max(...c.map(a=>new Date(a.date).getTime())))<b})},[a,k,m,l,e,h]);return e||l?(0,b.jsx)("div",{className:"w-full h-64 flex items-center justify-center",children:(0,b.jsx)(ag.Loader2,{className:"h-8 w-8 animate-spin text-blue-500"})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Show inactive for:"}),(0,b.jsxs)(K.Select,{value:m,onValueChange:a=>n(a),children:[(0,b.jsx)(K.SelectTrigger,{className:"w-[160px]",children:(0,b.jsx)(K.SelectValue,{placeholder:"Select period"})}),(0,b.jsxs)(K.SelectContent,{children:[(0,b.jsx)(K.SelectItem,{value:"30days",children:"30 days"}),(0,b.jsx)(K.SelectItem,{value:"60days",children:"60 days"}),(0,b.jsx)(K.SelectItem,{value:"90days",children:"90 days"}),(0,b.jsx)(K.SelectItem,{value:"6months",children:"6 months"}),(0,b.jsx)(K.SelectItem,{value:"1year",children:"1 year"}),(0,b.jsx)(K.SelectItem,{value:"all",children:"All inactive"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:["all"!==h&&(0,b.jsx)(P.Badge,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"Filtered by category"}),(0,b.jsxs)(P.Badge,{variant:"outline",className:"bg-amber-50 text-amber-800 border-amber-200",children:[r.length," inactive customers"]})]})]}),0===r.length?(0,b.jsx)(z.Card,{className:"border-dashed",children:(0,b.jsxs)(z.CardContent,{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,b.jsx)(ah.AlertCircle,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No inactive customers found"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 max-w-md",children:"all"!==h?`No customers in the selected category have been inactive for ${"30days"===m?"the last 30 days":"60days"===m?"the last 60 days":"90days"===m?"the last 90 days":"6months"===m?"the last 6 months":"1year"===m?"the last year":"their history"}.`:`All of your customers have made purchases within ${"30days"===m?"the last 30 days":"60days"===m?"the last 60 days":"90days"===m?"the last 90 days":"6months"===m?"the last 6 months":"1year"===m?"the last year":"their history"}.`})]})}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(a=>(0,b.jsxs)(z.Card,{className:"cursor-pointer hover:shadow-md transition-shadow duration-200 border border-amber-200 bg-amber-50/30",onClick:()=>f(a),children:[(0,b.jsx)(z.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg text-gray-900 truncate",children:a.fullName}),(0,b.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[(0,b.jsx)(B.Calendar,{className:"h-4 w-4 text-amber-600"}),(0,b.jsx)("span",{className:"text-sm font-medium text-amber-700",children:(a=>{let b=k.filter(b=>b.customerName.toLowerCase()===a.toLowerCase()&&"Quote"!==b.paymentStatus);if(0===b.length)return"No purchases";let c=new Date(Math.max(...b.map(a=>new Date(a.date).getTime()))),d=Math.floor((new Date().getTime()-c.getTime())/864e5);if(d<30)return`${d} days ago`;if(d<365){let a=Math.floor(d/30);return`${a} month${a>1?"s":""} ago`}{let a=Math.floor(d/365);return`${a} year${a>1?"s":""} ago`}})(a.fullName)})]})]}),(0,b.jsxs)("div",{className:"flex gap-1 ml-2",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-purple-50 hover:text-purple-600",onClick:b=>{b.stopPropagation(),q(a)},title:"Send 'We Miss You' message",children:(0,b.jsx)(ai,{className:"h-4 w-4 text-purple-600"})}),(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:b=>{b.stopPropagation(),f(a)},children:(0,b.jsx)(Q.Eye,{className:"h-4 w-4"})}),a.email&&(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:b=>{b.stopPropagation();if(g)g(a);else if(a.email){let b=`mailto:${a.email}?subject=We miss you!&body=${encodeURIComponent("We Miss You!\n\nIt's been a while since we last heard from you, and we just wanted to check in. We truly value you as a customer and would love to have you back. If there's anything you need or if we can assist in any way, we're here for you!\n\nHope to see you again soon,")}`;window.open(b)}else am.toast.error("This customer doesn't have an email address.")},children:(0,b.jsx)(T.Mail,{className:"h-4 w-4"})})]})]})}),(0,b.jsx)(z.CardContent,{className:"pt-0",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[a.email&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)(T.Mail,{className:"h-4 w-4 text-gray-400"}),(0,b.jsx)("span",{className:"truncate",children:a.email})]}),a.phoneNumber&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)(U.Phone,{className:"h-4 w-4 text-gray-400"}),(0,b.jsx)("span",{children:a.phoneNumber})]}),a.location&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)(V.MapPin,{className:"h-4 w-4 text-gray-400"}),(0,b.jsx)("span",{className:"truncate",children:a.location})]})]}),a.tags&&a.tags.length>0&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[(0,b.jsx)(W.Tag,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:"Tags"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-1",children:[a.tags.slice(0,2).map((a,c)=>(0,b.jsx)(P.Badge,{variant:"outline",className:"text-xs bg-blue-50 border-blue-200 text-blue-700",children:a},c)),a.tags.length>2&&(0,b.jsxs)(P.Badge,{variant:"outline",className:"text-xs bg-gray-100 border-gray-200",children:["+",a.tags.length-2]})]})]})]})})]},a.id))}),(0,b.jsx)(ar,{customer:p,open:!!p,onClose:()=>q(null)})]})};var at=a.i(510448),au=a.i(781560),av=a.i(911156);let aw=(0,p.default)("Cake",[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h.01",key:"1bh4kh"}],["path",{d:"M12 4h.01",key:"1ujb9j"}],["path",{d:"M17 4h.01",key:"1upcoc"}]]);var ax=a.i(486192);let ay=(0,p.default)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);var az=a.i(327054),aA=a.i(206015),aB=a.i(238246),aC=a.i(626109);let aD=({customerId:a,customerNameProp:e})=>{let{user:f}=(0,d.useAuth)(),{settings:g}=(0,h.useBusinessSettings)(),{sales:j,isLoading:k}=(0,i.useSalesData)(f?.id,"desc"),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(e||""),[r,s]=(0,c.useState)(null),[t,v]=(0,c.useState)(!1);return((0,c.useEffect)(()=>{e&&q(e)},[e]),(0,c.useEffect)(()=>{if(!j||0===j.length||!p){m([]),o(!1);return}m(j.filter(b=>{if(b.customerId)return b.customerId===a;let c=b.customerName?.toLowerCase().trim()===p.toLowerCase().trim(),d=b.receiptNumber?.startsWith("ADJ-")||b.receiptNumber?.startsWith("PAY-");return c&&!d})),o(!1)},[j,a,p]),k||n)?(0,b.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,b.jsx)(Loader2,{className:"h-8 w-8 animate-spin text-blue-500"})}):0===l.length?(0,b.jsxs)("div",{className:"text-center py-8 border rounded-md",children:[(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"No purchase history found"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"This customer hasn't made any purchases yet"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(aA.Table,{children:[(0,b.jsx)(aA.TableHeader,{children:(0,b.jsxs)(aA.TableRow,{children:[(0,b.jsx)(aA.TableHead,{children:"Date"}),(0,b.jsx)(aA.TableHead,{children:"Receipt #"}),(0,b.jsx)(aA.TableHead,{children:"Amount"}),(0,b.jsx)(aA.TableHead,{children:"Items"}),(0,b.jsx)(aA.TableHead,{children:"Status"})]})}),(0,b.jsx)(aA.TableBody,{children:l.map(a=>{let c;return(0,b.jsxs)(aA.TableRow,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>{s(a),v(!0)},children:[(0,b.jsx)(aA.TableCell,{children:(0,u.format)(a.date,"MMM d, yyyy")}),(0,b.jsx)(aA.TableCell,{children:(0,b.jsx)(aB.default,{href:`/sales?receipt=${a.receiptNumber}`,className:"text-blue-600 hover:underline",onClick:a=>a.stopPropagation(),children:a.receiptNumber})}),(0,b.jsx)(aA.TableCell,{children:(c=a.items.reduce((a,b)=>a+b.price*b.quantity,0),`${g.currency} ${(0,N.formatNumber)(c)}`)}),(0,b.jsx)(aA.TableCell,{children:(0,b.jsx)("span",{className:"text-sm",children:(a=>{if(!a.items||0===a.items.length)return"No items";let b=a.items[0];return 1===a.items.length?`${b.description} (${b.quantity})`:`${b.description} (+${a.items.length-1} more)`})(a)})}),(0,b.jsx)(aA.TableCell,{children:(a=>{switch(a?.toUpperCase()){case"PAID":return(0,b.jsx)(Badge,{className:"bg-green-100 text-green-800",children:"Paid"});case"NOT PAID":return(0,b.jsx)(Badge,{className:"bg-red-100 text-red-800",children:"Unpaid"});case"QUOTE":return(0,b.jsx)(Badge,{className:"bg-blue-100 text-blue-800",children:"Quote"});case"INSTALLMENT SALE":return(0,b.jsx)(Badge,{className:"bg-purple-100 text-purple-800",children:"Installment"});default:return(0,b.jsx)(Badge,{children:a})}})(a.paymentStatus)})]},a.id)})})]})}),r&&(0,b.jsx)(aC.default,{isOpen:t,sale:r,currency:g.currency,onOpenChange:()=>{v(!1),s(null)}})]})};var aE=a.i(114548);let aF=({notes:a,onSave:d})=>{let[e,f]=(0,c.useState)(!1),[g,h]=(0,c.useState)(a),[i,j]=(0,c.useState)(!1),k=async()=>{j(!0);try{await d(g)&&f(!1)}finally{j(!1)}};return(0,b.jsx)(z.Card,{children:(0,b.jsx)(z.CardContent,{className:"pt-6",children:e?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(ao.Textarea,{value:g,onChange:a=>h(a.target.value),rows:8,placeholder:"Enter notes about this customer...",className:"w-full"}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(o.Button,{variant:"outline",onClick:()=>{h(a),f(!1)},children:"Cancel"}),(0,b.jsx)(o.Button,{onClick:k,disabled:i,children:i?"Saving...":"Save Notes"})]})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[a?(0,b.jsx)("div",{className:"whitespace-pre-wrap",children:a}):(0,b.jsx)("div",{className:"text-muted-foreground italic",children:"No notes for this customer yet."}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>f(!0),children:[(0,b.jsx)(aE.Save,{className:"h-4 w-4 mr-1"}),"Edit Notes"]})})]})})})};var aG=a.i(298001);let aH=({customer:a,sale:d,open:e,onClose:f,templateId:g="thank_you"})=>{let[i,j]=(0,c.useState)(""),{settings:k}=(0,h.useBusinessSettings)(),{toast:l}=(0,w.useToast)();return c.default.useEffect(()=>{if(e&&g){let a=(0,aG.getTemplateById)(g);if(a){let b=a.content;if(d&&"payment_reminder"===g){let a=d.items.reduce((a,b)=>a+b.price*b.quantity,0);b=`${b}

Sale Details:
Receipt: ${d.receiptNumber}
Amount: ${k.currency} ${a.toFixed(2)}`}j(b)}}},[e,g,d,k.currency]),(0,b.jsx)(an.Dialog,{open:e,onOpenChange:f,children:(0,b.jsxs)(an.DialogContent,{className:"max-w-md",children:[(0,b.jsx)(an.DialogHeader,{children:(0,b.jsxs)(an.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(ap.MessageSquare,{className:"h-5 w-5"}),"Send SMS to ",a.fullName]})}),(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Message"}),(0,b.jsx)(ao.Textarea,{value:i,onChange:a=>j(a.target.value),placeholder:"Enter your message...",rows:6,className:"resize-none"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Message will be formatted for SMS with greeting and signature."})]})}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[(0,b.jsx)(o.Button,{variant:"outline",onClick:f,children:"Cancel"}),(0,b.jsxs)(o.Button,{onClick:()=>{if(!i.trim())return void l({title:"Message required",description:"Please enter a message before sending SMS.",variant:"destructive"});try{let b=`Dear ${a.fullName},

${i}

Yours faithfully,
${k.businessName||"Management"}`,c=(0,aq.formatMessageForSMS)(b,k.businessName);(0,aq.openSMSApp)({phoneNumber:a.phoneNumber,message:c}),l({title:"SMS app opened",description:"Your message has been prepared in the SMS app."}),f()}catch(a){console.error("Error sending SMS:",a),l({title:"SMS failed",description:"Failed to open SMS app. Please try again.",variant:"destructive"})}},disabled:!i.trim(),className:"gap-2",children:[(0,b.jsx)(ap.MessageSquare,{className:"h-4 w-4"}),"Send SMS"]})]})]})})};var aI=a.i(269876),aJ=a.i(73570),aK=a.i(179257);let aL=(0,p.default)("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);var aM=a.i(468976),aN=a.i(405784),aO=a.i(767552),aP=a.i(807113),aQ=a.i(139130);let aR=({customer:a,unpaidSales:d,totalAmountDue:e})=>{let{settings:f}=(0,h.useBusinessSettings)(),{toast:g}=(0,w.useToast)(),i=(0,Y.useIsMobile)(),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(!1),[n,p]=(0,c.useState)("Our records show that you have pending payments for the following items purchased on credit. We kindly request you to complete payment at your earliest convenience.\n\nPlease reach out to us if you need any assistance or clarification."),[q,r]=(0,c.useState)(!1),t=a=>`${f.currency} ${(0,N.formatNumber)(a)}`,v=async()=>{r(!0)},x=async()=>{try{let b=await (0,aP.generatePaymentReminderPDF)(a,d,e,f,n,"blob"),c=`Payment_Reminder_${a.fullName.replace(/\s+/g,"_")}.pdf`,h=`Payment Reminder for ${a.fullName}. Please find the attached document for details.`;if(navigator.share){let a=new File([b],c,{type:"application/pdf"});if(navigator.canShare&&navigator.canShare({files:[a]}))return void await navigator.share({files:[a],title:"Payment Reminder",text:h});await navigator.share({title:"Payment Reminder",text:h})}else{let b=y.map(a=>`${a.receiptNumber}: ${t(a.total)}`).join(", "),c=`Payment Reminder for ${a.fullName}. Total: ${t(e)}. Items: ${b}`;await navigator.clipboard.writeText(c),g({title:"Copied to clipboard",description:"Summary copied as file sharing is not supported."})}}catch(a){console.error("Error sharing PDF:",a),g({title:"Share failed",description:"Failed to generate or share the PDF.",variant:"destructive"})}},y=d.flatMap(a=>a.items.map(b=>({...b,saleId:a.id,receiptNumber:a.receiptNumber,saleDate:a.date,total:b.price*b.quantity})));return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(z.Card,{className:"border-orange-200 bg-orange-50",children:[(0,b.jsx)(z.CardHeader,{className:`${i?"pb-3 px-4 pt-4":"pb-4"}`,children:(0,b.jsxs)("div",{className:`flex ${i?"flex-col gap-3":"items-center justify-between"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(aJ.AlertTriangle,{className:`${i?"h-4 w-4":"h-5 w-5"} text-orange-600`}),(0,b.jsx)(z.CardTitle,{className:`text-orange-800 ${i?"text-lg":"text-xl"}`,children:"Payment Reminder Notice"}),(0,b.jsx)("div",{className:"ml-2 px-2 py-1 bg-orange-200 rounded-md",children:(0,b.jsx)("span",{className:`text-orange-800 font-semibold ${i?"text-xs":"text-sm"}`,children:t(e)})})]}),(0,b.jsxs)("div",{className:`flex ${i?"flex-wrap":""} gap-2`,children:[(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:v,className:i?"flex-1 min-w-[140px]":"",children:[(0,b.jsx)(s.Download,{className:"h-4 w-4 mr-1"}),i?"PDF":"Download PDF"]}),(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{let b=y.map(a=>`${a.receiptNumber} - ${a.description} (Qty: ${a.quantity}) - ${t(a.total)}`).join("\n"),c=`Payment Reminder for ${a.fullName}

Dear ${a.fullName},

${n}

Outstanding Items:
${b}

Total Outstanding Balance: ${t(e)}

Thank you for your continued support.

${f.businessName}`;navigator.clipboard.writeText(c),g({title:"Copied",description:"Payment reminder text with items copied to clipboard"})},className:i?"flex-1 min-w-[120px]":"",children:[(0,b.jsx)(aK.Link,{className:"h-4 w-4 mr-1"}),i?"Copy":"Copy Text"]}),(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:x,className:i?"flex-1 min-w-[140px]":"bg-blue-50 border-blue-200 text-blue-700 hover:bg-blue-100",children:[(0,b.jsx)(aL,{className:"h-4 w-4 mr-1 text-blue-600"}),"Share"]}),(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>m(!l),className:`${i?"flex-1 min-w-[120px]":""} text-orange-700 hover:bg-orange-100`,children:l?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(aO.ChevronUp,{className:"h-4 w-4 mr-1"}),"Hide Details"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(aN.ChevronDown,{className:"h-4 w-4 mr-1"}),"View Details"]})})]})]})}),l&&(0,b.jsx)(z.CardContent,{className:i?"px-4 pb-4":"",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:`bg-white ${i?"p-3":"p-4"} rounded-lg border`,children:[(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:(0,b.jsxs)("strong",{children:["Dear ",a.fullName,","]})}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(H.Label,{htmlFor:"reminder-message",className:"text-sm font-medium text-gray-700",children:"Reminder Message"}),(0,b.jsxs)(o.Button,{variant:"ghost",size:"sm",onClick:()=>k(!j),className:`${i?"h-7 px-2 text-xs":"h-8 px-3"}`,children:[(0,b.jsx)(aM.Edit3,{className:"h-3 w-3 mr-1"}),j?"Save":"Edit"]})]}),j?(0,b.jsx)(ao.Textarea,{id:"reminder-message",value:n,onChange:a=>p(a.target.value),className:`${i?"min-h-[120px] text-sm":"min-h-[100px] text-sm"}`,placeholder:"Enter your custom reminder message..."}):(0,b.jsx)("div",{className:"text-sm text-gray-600 whitespace-pre-line bg-gray-50 p-3 rounded border",children:n})]})]}),(0,b.jsx)("div",{className:"bg-white rounded-lg border overflow-hidden",children:i?(0,b.jsxs)("div",{className:"divide-y divide-gray-200",children:[(0,b.jsx)("div",{className:"bg-orange-100 px-3 py-2",children:(0,b.jsx)("h3",{className:"font-semibold text-orange-800 text-sm",children:"Outstanding Items"})}),y.map((a,c)=>(0,b.jsx)("div",{className:"p-3 space-y-2",children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium text-sm text-gray-900",children:a.description}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:["Invoice: ",a.receiptNumber]}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:(0,u.format)(a.saleDate,"MMM d, yyyy")})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"font-semibold text-sm",children:t(a.total)}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[a.quantity,"  ",t(a.price)]})]})]})},`${a.saleId}-${c}`)),(0,b.jsx)("div",{className:"bg-orange-50 px-3 py-3 border-t-2 border-orange-200",children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"font-semibold text-orange-800 text-sm",children:"Total Outstanding:"}),(0,b.jsx)("span",{className:"font-bold text-orange-800 text-lg",children:t(e)})]})})]}):(0,b.jsxs)(aA.Table,{children:[(0,b.jsx)(aA.TableHeader,{children:(0,b.jsxs)(aA.TableRow,{children:[(0,b.jsx)(aA.TableHead,{children:"Invoice #"}),(0,b.jsx)(aA.TableHead,{children:"Product Name"}),(0,b.jsx)(aA.TableHead,{children:"Qty"}),(0,b.jsx)(aA.TableHead,{children:"Price"}),(0,b.jsx)(aA.TableHead,{children:"Total"}),(0,b.jsx)(aA.TableHead,{children:"Sale Date"})]})}),(0,b.jsxs)(aA.TableBody,{children:[y.map((a,c)=>(0,b.jsxs)(aA.TableRow,{children:[(0,b.jsx)(aA.TableCell,{className:"font-medium",children:a.receiptNumber}),(0,b.jsx)(aA.TableCell,{children:a.description}),(0,b.jsx)(aA.TableCell,{children:a.quantity}),(0,b.jsx)(aA.TableCell,{children:t(a.price)}),(0,b.jsx)(aA.TableCell,{children:t(a.total)}),(0,b.jsx)(aA.TableCell,{children:(0,u.format)(a.saleDate,"MMM d, yyyy")})]},`${a.saleId}-${c}`)),(0,b.jsxs)(aA.TableRow,{className:"bg-orange-50 border-t-2 border-orange-200",children:[(0,b.jsx)(aA.TableCell,{colSpan:4,className:"font-semibold text-orange-800",children:"Total Outstanding Balance:"}),(0,b.jsx)(aA.TableCell,{colSpan:2,className:"font-bold text-orange-800 text-lg",children:t(e)})]})]})]})}),(0,b.jsxs)("div",{className:`bg-white ${i?"p-3":"p-4"} rounded-lg border`,children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:(0,b.jsx)("strong",{children:"Thank you for your continued support."})}),(0,b.jsxs)("p",{className:`${i?"text-xs":"text-sm"} text-gray-500 mt-2`,children:[f.businessName,(0,b.jsx)("br",{}),"Notice generated on ",(0,u.format)(new Date,"MMMM d, yyyy")]})]})]})})]}),(0,b.jsx)(aQ.default,{isOpen:q,onOpenChange:r,sale:null,customer:a,unpaidSales:d})]})},aS=(0,k.createServerReference)("701e1ec289530654c83844b4eaf8773c09a902523e",k.callServer,void 0,k.findSourceMapURL,"createReceiptAction");var aT=a.i(533018);let aU=({customer:f,onUpdate:g,onDelete:j,canEdit:k=!0,canDelete:l=!0})=>{let m,n,p,q,r,s,v,x,y,A,C=c.default.useRef(null),[E,F]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(!1),[M,O]=(0,c.useState)(!1),[Q,S]=(0,c.useState)(!1),W=()=>aj.filter(a=>{let b=(a.paymentStatus||"").toString().toUpperCase(),c=new Date(a.date),d=E?new Date(E):null,e=I?new Date(I):null;e&&e.setHours(23,59,59,999);let g=(!d||c>=d)&&(!e||c<=e);return a.customerName.toLowerCase()===f.fullName.toLowerCase()&&"QUOTE"!==b&&g}),X=a=>{let b=(a.paymentStatus||"").toString().toUpperCase();return"number"==typeof a.amountPaid?a.amountPaid:"number"==typeof a.amount_paid?a.amount_paid:"number"==typeof a.paid?a.paid:"number"==typeof a.paymentAmount?a.paymentAmount:"INSTALLMENT SALE"===b&&Array.isArray(a.installments)?a.installments.reduce((a,b)=>a+(b.amountPaid||0),0):"PAID"===b?a.items.reduce((a,b)=>a+b.price*b.quantity,0):0},Z=async()=>{let b=aj.filter(a=>a.customerName.toLowerCase()===f.fullName.toLowerCase()&&"QUOTE"!==(a.paymentStatus||"").toString().toUpperCase()),c=E?new Date(E):null,d=I?new Date(I):null;d&&d.setHours(23,59,59,999);let e=0;c&&b.forEach(a=>{new Date(a.date)<c&&(e+=a.items.reduce((a,b)=>a+b.price*b.quantity,0),e-=X(a))});let g=[];b.forEach(a=>{let b=(a.paymentStatus||"").toString().toUpperCase(),c="Receipt #";if("QUOTE"===b?c="Quote #":"NOT PAID"===b||"PARTIAL"===b?c="Invoice #":a.receiptNumber.startsWith("ADJ-")&&(c="Adjustment #"),g.push({date:new Date(a.date),details:`${c}${a.receiptNumber}`,amount:a.items.reduce((a,b)=>a+b.price*b.quantity,0),type:"sale"}),"INSTALLMENT SALE"===b&&Array.isArray(a.installments))a.installments.forEach(b=>{let c=b.amountPaid||0;c>0&&g.push({date:new Date(b.date?b.date:a.date),details:"Payment",amount:-c,type:"payment"})});else{let b=X(a);b>0&&g.push({date:new Date(a.date),details:"Payment",amount:-b,type:"payment"})}}),g.sort((a,b)=>a.date.getTime()-b.date.getTime());let h=[],i=e;c&&h.push({date:c.toISOString(),details:"Opening Balance",amount:e,paid:0,balance:e}),g.forEach(a=>{let b=(!c||a.date>=c)&&(!d||a.date<=d);i+=a.amount,b&&h.push({date:a.date.toISOString(),details:a.details,amount:a.amount>0?a.amount:0,paid:a.amount<0?Math.abs(a.amount):0,balance:i})});let{generateStatementPDF:j}=await a.A(285433);await j(h,{filename:`customer_statement_${f.fullName.replace(/\s+/g,"_")}_${new Date().toISOString().slice(0,10)}.pdf`,orientation:"portrait",format:"a4",margins:{top:15,right:15,bottom:15,left:15},currency:as.currency,customerName:f.fullName})},[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)(!1),[ad,ae]=(0,c.useState)(!1),[af,ah]=(0,c.useState)(!1),{user:ai}=(0,d.useAuth)(),{sales:aj,isLoading:ak,getCustomerLifetimePurchases:al,deleteSale:am,refetch:ao}=(0,i.useSalesData)(ai?.id),{currentBusiness:ar}=(0,e.useBusiness)(),{settings:as}=(0,h.useBusinessSettings)(),aA=(0,Y.useIsMobile)(),{toast:aB}=(0,w.useToast)(),[aC,aE]=(0,c.useState)(null),[aG,aJ]=(0,c.useState)(null),[aK,aL]=(0,c.useState)(!0);(0,c.useEffect)(()=>{aL(!0);try{if(f&&!ak){let a=al(f.fullName);aE(a);let b=aj.filter(a=>a.customerName.toLowerCase()===f.fullName.toLowerCase()).filter(a=>"NOT PAID"===a.paymentStatus),c=b.reduce((a,b)=>a+b.items.reduce((a,b)=>a+b.price*b.quantity,0),0);aJ({total:c,count:b.length})}else aE({total:0,count:0}),aJ({total:0,count:0})}catch(a){console.error("Error calculating purchase data:",a),aE({total:0,count:0}),aJ({total:0,count:0})}finally{aL(!1)}},[f,aj,ak,al]);let aM=a=>`${as.currency} ${(0,N.formatNumber)(a)}`,aN=async a=>{console.log("Customer update data received in detail view:",a);let b={...a};if(b.birthday&&(console.log("Birthday before update:",b.birthday),!(b.birthday instanceof Date)||isNaN(b.birthday.getTime())))if(console.log("Converting birthday to valid Date object"),"string"==typeof b.birthday){let a=b.birthday.split("-");if(3===a.length){let[c,d,e]=a.map(Number);b.birthday=new Date(Date.UTC(c,d-1,e,12,0,0))}else console.error("Invalid birthday string format"),b.birthday=null}else console.error("Birthday is not a Date or string:",typeof b.birthday),b.birthday=null;let c=await g(b);return c&&aa(!1),c},aO=async()=>{let a=await j();return a&&ac(!1),a},aP=aA&&(0,aq.canSendSMS)(f),aQ=(0,aq.canSendSMS)(f),aU=null!==f.birthday,aV=f.birthday&&new Date().toDateString()===f.birthday.toDateString(),aW=f.birthday&&new Date().getMonth()===f.birthday.getMonth(),aX=a=>{if(!(0,aq.canSendSMS)(f))return void aB({title:"Phone number required",description:"Customer phone number is not available.",variant:"destructive"});try{let b=(0,aq.getBirthdayMessage)(f.fullName),c=(0,aq.formatMessageForSMS)(b,as.businessName);"sms"===a?((0,aq.openSMSApp)({phoneNumber:f.phoneNumber,message:c}),aB({title:"SMS app opened",description:"Birthday wishes prepared in SMS app."})):((0,aq.openWhatsApp)({phoneNumber:f.phoneNumber,message:c}),aB({title:"WhatsApp opened",description:"Birthday wishes prepared in WhatsApp."}))}catch(a){console.error("Error sending birthday wishes:",a),aB({title:"Failed to send",description:"Failed to open messaging app. Please try again.",variant:"destructive"})}};return(0,b.jsxs)("div",{className:"space-y-6",children:[aG&&aG.count>0&&(0,b.jsx)(aR,{customer:f,unpaidSales:aj.filter(a=>a.customerName.toLowerCase()===f.fullName.toLowerCase()&&"NOT PAID"===a.paymentStatus),totalAmountDue:aG.total}),aU&&aW&&(aP||aQ)&&(0,b.jsx)(z.Card,{className:"border-pink-200 bg-gradient-to-r from-pink-50 to-purple-50",children:(0,b.jsx)(z.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-pink-500 rounded-lg",children:(0,b.jsx)(aw,{className:"h-5 w-5 text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium text-pink-900",children:aV?" It's their birthday today!":"Birthday this month"}),(0,b.jsxs)("p",{className:"text-sm text-pink-700",children:[f.birthday&&(0,u.format)(f.birthday,"MMMM d")," - Send birthday wishes"]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[aP&&(0,b.jsxs)(o.Button,{size:"sm",onClick:()=>aX("sms"),className:"bg-pink-500 hover:bg-pink-600 text-white",children:[(0,b.jsx)(ap.MessageSquare,{className:"h-4 w-4 mr-1"}),"SMS Wishes"]}),aQ&&(0,b.jsx)(o.Button,{size:"sm",variant:"outline",onClick:()=>aX("whatsapp"),className:"border-green-500 text-green-700 hover:bg-green-50",children:" WhatsApp"})]})]})})}),(0,b.jsxs)(z.Card,{children:[(0,b.jsx)(z.CardHeader,{className:"pb-4",children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(z.CardTitle,{className:"text-2xl",children:f.fullName}),(0,b.jsxs)(z.CardDescription,{children:["Customer since ",(0,u.format)(f.createdAt,"MMMM d, yyyy")]})]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[aP&&(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>ah(!0),children:[(0,b.jsx)(ap.MessageSquare,{className:"h-4 w-4 mr-1"}),"SMS"]}),(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>ae(!0),children:[(0,b.jsx)(t.FileText,{className:"h-4 w-4 mr-1"}),"Send Notice"]}),k&&(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>aa(!0),children:[(0,b.jsx)(at.Edit2,{className:"h-4 w-4 mr-1"}),"Edit"]}),l&&(0,b.jsxs)(o.Button,{variant:"destructive",size:"sm",onClick:()=>ac(!0),children:[(0,b.jsx)(au.Trash2,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})}),(0,b.jsx)(z.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium text-gray-500 mb-2",children:"Contact Information"}),(0,b.jsxs)("div",{className:"space-y-2",children:[f.email&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(T.Mail,{className:"h-4 w-4 text-gray-400"}),(0,b.jsx)("a",{href:`mailto:${f.email}`,className:"text-blue-600 hover:underline",children:f.email})]}),f.phoneNumber&&(0,b.jsxs)("div",{className:"flex items-center gap-2 justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(U.Phone,{className:"h-4 w-4 text-gray-400"}),(0,b.jsx)("a",{href:`tel:${f.phoneNumber}`,className:"text-blue-600 hover:underline",children:f.phoneNumber})]}),aP&&(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>ah(!0),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50 p-1 h-auto",title:"Send SMS",children:(0,b.jsx)(ap.MessageSquare,{className:"h-4 w-4"})})]}),f.location&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(V.MapPin,{className:"h-4 w-4 text-gray-400"}),(0,b.jsx)("span",{children:f.location})]})]})]}),f.birthday&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium text-gray-500 mb-2",children:"Birthday"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(B.Calendar,{className:"h-4 w-4 text-gray-400"}),(0,b.jsx)("span",{children:(0,u.format)(f.birthday,"MMMM d")})]})]}),f.socialMedia&&Object.keys(f.socialMedia).length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium text-gray-500 mb-2",children:"Social Media"}),(0,b.jsx)("div",{className:"space-y-1",children:Object.entries(f.socialMedia).map(([a,c])=>c&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"capitalize",children:[a,":"]}),(0,b.jsx)("span",{className:"text-blue-600",children:c})]},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium text-gray-500 mb-2",children:"Purchase Summary"}),aK?(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(ag.Loader2,{className:"h-4 w-4 mr-2 animate-spin text-gray-500"}),(0,b.jsx)("span",{children:"Loading purchase data..."})]}):(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(R.Receipt,{className:"h-4 w-4 text-gray-400"}),(0,b.jsxs)("span",{children:[(0,b.jsx)("strong",{children:"Lifetime Purchases:"})," ",aC?.count||0," orders totaling ",aM(aC?.total||0)]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(av.CreditCard,{className:"h-4 w-4 text-red-400"}),(0,b.jsxs)("span",{children:[(0,b.jsx)("strong",{children:"Total Credit Sales:"})," ",aG?.count||0," unpaid orders totaling ",aM(aG?.total||0)]})]}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"* Quotes are excluded from totals"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[f.tags&&f.tags.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium text-gray-500 mb-2",children:"Tags"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:f.tags.map((a,c)=>(0,b.jsx)(P.Badge,{variant:"outline",className:"bg-blue-50",children:a},c))})]}),f.gender&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium text-gray-500 mb-2",children:"Gender"}),(0,b.jsx)("span",{className:"capitalize",children:f.gender})]})]})]})})]}),(0,b.jsxs)(D.Tabs,{defaultValue:"purchases",className:"w-full",children:[(0,b.jsxs)(D.TabsList,{children:[(0,b.jsx)(D.TabsTrigger,{value:"purchases",children:"Purchase History"}),(0,b.jsx)(D.TabsTrigger,{value:"notes",children:"Notes"}),(0,b.jsx)(D.TabsTrigger,{value:"statement",children:"Statement"})]}),(0,b.jsx)(D.TabsContent,{value:"purchases",children:(0,b.jsx)(aD,{customerId:f.id,customerNameProp:f.fullName})}),(0,b.jsx)(D.TabsContent,{value:"notes",children:(0,b.jsx)(aF,{notes:f.notes||"",onSave:a=>g({notes:a})})}),(0,b.jsx)(D.TabsContent,{value:"statement",children:(0,b.jsxs)("div",{ref:C,className:"bg-white rounded-xl shadow-lg p-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-bold text-xl text-gray-800",children:"Customer Statement"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Transaction history and balance"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-4 w-full md:w-auto",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(H.Label,{htmlFor:"statement-start",className:"text-xs font-medium text-gray-500",children:"From:"}),(0,b.jsx)(G.Input,{id:"statement-start",type:"date",value:E,onChange:a=>F(a.target.value),className:"h-9 text-xs w-36"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(H.Label,{htmlFor:"statement-end",className:"text-xs font-medium text-gray-500",children:"To:"}),(0,b.jsx)(G.Input,{id:"statement-end",type:"date",value:I,onChange:a=>J(a.target.value),className:"h-9 text-xs w-36"})]}),(0,b.jsxs)("div",{className:"flex gap-2 ml-auto",children:[k&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Button,{size:"sm",variant:"outline",className:"bg-red-50 text-red-700 border-red-200",onClick:()=>L(!0),children:"Add Charge"}),(0,b.jsx)(o.Button,{size:"sm",variant:"outline",className:"bg-green-50 text-green-700 border-green-200",onClick:()=>O(!0),children:"Add Payment"})]}),(0,b.jsx)(o.Button,{size:"sm",variant:"outline",onClick:()=>{let a=aj.filter(a=>a.customerName.toLowerCase()===f.fullName.toLowerCase()&&"QUOTE"!==(a.paymentStatus||"").toString().toUpperCase()),b=E?new Date(E):null,c=I?new Date(I):null;c&&c.setHours(23,59,59,999);let d=0;b&&a.forEach(a=>{new Date(a.date)<b&&(d+=a.items.reduce((a,b)=>a+b.price*b.quantity,0),d-=X(a))});let e=[];a.forEach(a=>{let b=(a.paymentStatus||"").toString().toUpperCase(),c="Receipt #";if("QUOTE"===b?c="Quote #":"NOT PAID"===b||"PARTIAL"===b?c="Invoice #":a.receiptNumber.startsWith("ADJ-")&&(c="Adjustment #"),e.push({date:new Date(a.date),details:`${c}${a.receiptNumber}`,amount:a.items.reduce((a,b)=>a+b.price*b.quantity,0),type:"sale"}),"INSTALLMENT SALE"===b&&Array.isArray(a.installments))a.installments.forEach(b=>{let c=b.amountPaid||0;c>0&&e.push({date:new Date(b.date?b.date:a.date),details:"Payment",amount:-c,type:"payment"})});else{let b=X(a);b>0&&e.push({date:new Date(a.date),details:"Payment",amount:-b,type:"payment"})}}),e.sort((a,b)=>{let c=a.date.getTime()-b.date.getTime();return 0!==c?c:(a.createdAt?.getTime()||0)-(b.createdAt?.getTime()||0)});let g=[],h=d;b&&g.push([(0,u.format)(b,"yyyy-MM-dd"),"Opening Balance","-",h]),e.forEach(a=>{let d=(!b||a.date>=b)&&(!c||a.date<=c);h+=a.amount,d&&g.push([(0,u.format)(a.date,"yyyy-MM-dd"),a.details,a.amount,h])});let i=new Blob([[["Date","Details","Amount","Balance"],...g].map(a=>a.join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),j=document.createElement("a");j.href=URL.createObjectURL(i),j.download=`customer_statement_${f.fullName.replace(/\s+/g,"_")}_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(j),j.click(),document.body.removeChild(j)},children:"CSV"}),(0,b.jsx)(o.Button,{size:"sm",variant:"outline",onClick:Z,children:"PDF"})]})]})]}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-sm border-collapse",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-blue-600 text-white",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left font-semibold first:rounded-tl-lg",children:"Date"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left font-semibold",children:"Details (Receipt/Invoice)"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right font-semibold",children:"Amount"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right font-semibold",children:"Balance"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center font-semibold last:rounded-tr-lg",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-200",children:(m=aj.filter(a=>a.customerName.toLowerCase()===f.fullName.toLowerCase()&&"QUOTE"!==(a.paymentStatus||"").toString().toUpperCase()),n=E?new Date(E):null,(p=I?new Date(I):null)&&p.setHours(23,59,59,999),q=0,n&&m.forEach(a=>{if(new Date(a.date)<n){let b=a.items.reduce((a,b)=>a+b.price*b.quantity,0);q+=b,q-=X(a)}}),r=[...m.filter(a=>{let b=new Date(a.date);return(!n||b>=n)&&(!p||b<=p)})].sort((a,b)=>new Date(a.date).getTime()-new Date(b.date).getTime()),s=q,v=[],r.forEach(a=>{let b=(a.paymentStatus||"").toString().toUpperCase(),c="Receipt #";if("QUOTE"===b?c="Quote #":"NOT PAID"===b||"PARTIAL"===b?c="Invoice #":a.receiptNumber.startsWith("ADJ-")&&(c="Adjustment #"),a.receiptNumber.startsWith("PAY-")||v.push({date:new Date(a.date),details:c+a.receiptNumber,amount:a.items.reduce((a,b)=>a+b.price*b.quantity,0),type:"sale",id:a.id,originalSale:a,createdAt:a.createdAt}),"INSTALLMENT SALE"===b&&Array.isArray(a.installments))a.installments.forEach((b,c)=>{let d=b.amountPaid||0;d>0&&v.push({date:new Date(b.date?b.date:a.date),details:"Payment",amount:-d,type:"payment",id:`${a.id}-inst-${c}`,originalSale:a,isInstallment:!0,createdAt:a.createdAt})});else{let b=X(a);b>0&&v.push({date:new Date(a.date),details:"Payment",amount:-b,type:"payment",id:`${a.id}-payment`,originalSale:a,isManualPayment:a.receiptNumber.startsWith("PAY-"),createdAt:a.createdAt})}}),v.sort((a,b)=>{let c=a.date.getTime()-b.date.getTime();return 0!==c?c:(a.createdAt?.getTime()||0)-(b.createdAt?.getTime()||0)}),x=[],n&&x.push((0,b.jsxs)("tr",{className:"bg-gray-50 italic",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-gray-500",children:(0,u.format)(n,"MMM d, yyyy")}),(0,b.jsx)("td",{className:"px-4 py-3 text-gray-500 font-medium",children:"Opening Balance"}),(0,b.jsx)("td",{className:"px-4 py-3 text-right text-gray-500",children:"-"}),(0,b.jsxs)("td",{className:"px-4 py-3 text-right font-semibold text-gray-600",children:[as.currency," ",q.toLocaleString()]})]},"opening-balance")),v.forEach(a=>{let c=(!n||a.date>=n)&&(!p||a.date<=p);if(s+=a.amount,c){let c="payment"===a.type;x.push((0,b.jsxs)("tr",{className:c?"bg-green-50/50 hover:bg-green-50 transition-colors":"hover:bg-blue-50 transition-colors",children:[(0,b.jsx)("td",{className:`px-4 py-3 ${c?"text-green-700 italic":"text-gray-600"}`,children:(0,u.format)(a.date,"MMM d, yyyy")}),(0,b.jsx)("td",{className:`px-4 py-3 font-medium ${c?"text-green-700":"text-gray-900"}`,children:a.details}),(0,b.jsxs)("td",{className:`px-4 py-3 text-right ${c?"text-green-700":"text-gray-900"}`,children:[c?"- ":"",as.currency," ",Math.abs(a.amount).toLocaleString()]}),(0,b.jsxs)("td",{className:`px-4 py-3 text-right font-bold ${c?"text-green-800":"text-gray-900"}`,children:[as.currency," ",s.toLocaleString()]}),(0,b.jsx)("td",{className:"px-4 py-3 text-center whitespace-nowrap",children:(0,b.jsxs)(o.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50",onClick:async()=>{if(confirm("Are you sure you want to delete this entry?"))try{a.isInstallment?aB({title:"Notice",description:"Cannot delete installment payment from this view. Please go to the sale details."}):"sale"===a.type||a.isManualPayment?(await am(a.originalSale.id),aB({title:"Success",description:"Entry deleted"})):aB({title:"Notice",description:"Cannot delete this payment directly. Delete the sale instead."})}catch(a){console.error(a),aB({title:"Error",description:"Failed to delete",variant:"destructive"})}},children:[(0,b.jsx)(ay,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Delete"})]})})]},a.id))}}),x)})]})}),0===W().length&&(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-400",children:[(0,b.jsx)(t.FileText,{className:"h-12 w-12 mb-3 opacity-20"}),(0,b.jsx)("p",{children:"No transactions found for the selected date range."})]}),W().length>0&&(0,b.jsx)("div",{className:"mt-6 flex justify-end",children:(0,b.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100 min-w-48",children:[(0,b.jsx)("p",{className:"text-xs text-blue-600 font-medium uppercase tracking-wider mb-1",children:"Current Balance"}),(0,b.jsxs)("p",{className:"text-2xl font-black text-blue-900",children:[as.currency," ",(y=W(),A=0,y.forEach(a=>{let b=a.items.reduce((a,b)=>a+b.price*b.quantity,0);A+=b,A-=X(a)}),A.toLocaleString())]})]})})]})})]}),(0,b.jsx)(an.Dialog,{open:_,onOpenChange:aa,children:(0,b.jsxs)(an.DialogContent,{className:"max-w-2xl max-h-[90vh]",children:[(0,b.jsxs)(an.DialogHeader,{children:[(0,b.jsx)(an.DialogTitle,{children:"Edit Customer"}),(0,b.jsx)(an.DialogDescription,{children:"Update customer information. Click save when you're done."})]}),(0,b.jsx)(aI.ScrollArea,{className:"h-[calc(80vh-8rem)]",children:(0,b.jsx)("div",{className:"px-1",children:(0,b.jsx)(az.default,{initialData:f,onSubmit:aN,onCancel:()=>aa(!1)})})})]})}),(0,b.jsx)($.default,{customer:f,open:ad,onClose:()=>ae(!1)}),(0,b.jsx)(aH,{customer:f,open:af,onClose:()=>ah(!1),templateId:"general_notice"}),(0,b.jsx)(an.Dialog,{open:K,onOpenChange:L,children:(0,b.jsxs)(an.DialogContent,{className:"max-w-md",children:[(0,b.jsxs)(an.DialogHeader,{children:[(0,b.jsx)(an.DialogTitle,{children:"Add Manual Charge"}),(0,b.jsx)(an.DialogDescription,{children:"Create a debit adjustment for this customer's account."})]}),(0,b.jsxs)("form",{onSubmit:async a=>{a.preventDefault();let b=a.target,c=parseFloat(b.amount.value.replace(/,/g,"")),d=b.description.value,e=b.date.value,g=e?new Date(e):new Date;if(isNaN(c)||c<=0)return void aB({title:"Error",description:"Please enter a valid amount.",variant:"destructive"});S(!0);try{let a=await (0,aT.generateReceiptNumber)(ar?.id||""),b={receiptNumber:`ADJ-${a}`,customerName:f.fullName,customerId:f.id,date:g.toISOString().split("T")[0],items:[{description:d||"Manual Charge",quantity:1,price:c,cost:0}],paymentStatus:"NOT PAID",amountPaid:0,amountDue:c,profit:c,cashAccountId:void 0,paymentDetails:void 0,installmentPlan:void 0},e=await aS(b,ar?.id||"",ai?.id||"");if(!e.success)throw Error(e.error);aB({title:"Success",description:"Manual charge added successfully."}),L(!1),await ao()}catch(a){console.error(a),aB({title:"Error",description:a.message||"Failed to add charge.",variant:"destructive"})}finally{S(!1)}},children:[(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(H.Label,{htmlFor:"charge-date",children:"Date"}),(0,b.jsx)(G.Input,{id:"charge-date",name:"date",type:"date",defaultValue:new Date().toISOString().split("T")[0],required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(H.Label,{htmlFor:"charge-desc",children:"Description"}),(0,b.jsx)(G.Input,{id:"charge-desc",name:"description",placeholder:"e.g., Service Fee, Penalty",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(H.Label,{htmlFor:"charge-amount",children:["Amount (",as.currency,")"]}),(0,b.jsx)(G.Input,{id:"charge-amount",name:"amount",type:"text",inputMode:"decimal",placeholder:"0.00",required:!0})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(o.Button,{type:"button",variant:"outline",onClick:()=>L(!1),children:"Cancel"}),(0,b.jsxs)(o.Button,{type:"submit",disabled:Q,children:[Q?(0,b.jsx)(ag.Loader2,{className:"h-4 w-4 animate-spin mr-2"}):null,"Save Charge"]})]})]})]})}),(0,b.jsx)(an.Dialog,{open:M,onOpenChange:O,children:(0,b.jsxs)(an.DialogContent,{className:"max-w-md",children:[(0,b.jsxs)(an.DialogHeader,{children:[(0,b.jsx)(an.DialogTitle,{children:"Add Manual Payment"}),(0,b.jsx)(an.DialogDescription,{children:"Record a payment or credit to this customer's balance."})]}),(0,b.jsxs)("form",{onSubmit:async a=>{a.preventDefault();let b=a.target,c=parseFloat(b.amount.value.replace(/,/g,"")),d=b.description.value,e=b.date.value,g=e?new Date(e):new Date;if(isNaN(c)||c<=0)return void aB({title:"Error",description:"Please enter a valid amount.",variant:"destructive"});S(!0);try{let a=await (0,aT.generateReceiptNumber)(ar?.id||""),b={receiptNumber:`PAY-${a}`,customerName:f.fullName,customerId:f.id,date:g.toISOString().split("T")[0],items:[{description:d||"Account Payment",quantity:1,price:0,cost:0}],paymentStatus:"PAID",amountPaid:c,amountDue:0,profit:0,cashAccountId:void 0,paymentDetails:void 0,installmentPlan:void 0},e=await aS(b,ar?.id||"",ai?.id||"");if(!e.success)throw Error(e.error);aB({title:"Success",description:"Manual payment recorded successfully."}),O(!1),await ao()}catch(a){console.error(a),aB({title:"Error",description:a.message||"Failed to record payment.",variant:"destructive"})}finally{S(!1)}},children:[(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(H.Label,{htmlFor:"pay-date",children:"Date"}),(0,b.jsx)(G.Input,{id:"pay-date",name:"date",type:"date",defaultValue:new Date().toISOString().split("T")[0],required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(H.Label,{htmlFor:"pay-desc",children:"Description"}),(0,b.jsx)(G.Input,{id:"pay-desc",name:"description",placeholder:"e.g., Cash Payment, Discount, Waiver",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(H.Label,{htmlFor:"pay-amount",children:["Amount (",as.currency,")"]}),(0,b.jsx)(G.Input,{id:"pay-amount",name:"amount",type:"text",inputMode:"decimal",placeholder:"0.00",required:!0})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(o.Button,{type:"button",variant:"outline",onClick:()=>O(!1),children:"Cancel"}),(0,b.jsxs)(o.Button,{type:"submit",disabled:Q,children:[Q?(0,b.jsx)(ag.Loader2,{className:"h-4 w-4 animate-spin mr-2"}):null,"Save Payment"]})]})]})]})}),(0,b.jsx)(ax.AlertDialog,{open:ab,onOpenChange:ac,children:(0,b.jsxs)(ax.AlertDialogContent,{children:[(0,b.jsxs)(ax.AlertDialogHeader,{children:[(0,b.jsx)(ax.AlertDialogTitle,{children:"Are you sure?"}),(0,b.jsxs)(ax.AlertDialogDescription,{children:['This action cannot be undone. This will permanently delete customer "',f.fullName,'" and remove their data from our servers.']})]}),(0,b.jsxs)(ax.AlertDialogFooter,{children:[(0,b.jsx)(ax.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(ax.AlertDialogAction,{onClick:aO,children:"Delete"})]})]})})]})},aV=({activeTab:a,setActiveTab:c,selectedCustomer:d,searchTerm:e,setSearchTerm:f,selectedCategory:g,setSelectedCategory:h,dateFilter:i,setDateFilter:j,dateRange:k,setDateRange:l,validCategories:m,filteredCustomers:n,customers:o,customerStats:p,getCategoryName:q,onSelectCustomer:r,onEditCustomer:s,onDeleteCustomer:t,onUpdateCustomer:u,setSelectedCustomer:v,canCreate:w=!0,canEdit:x=!0,canDelete:y=!0})=>(0,b.jsxs)("div",{className:"bg-white rounded-xl border shadow-sm",children:[(0,b.jsx)("div",{className:"px-8 py-6 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white",children:(0,b.jsxs)("div",{className:"flex flex-col xl:flex-row gap-8 items-start",children:[(0,b.jsxs)("div",{className:"flex-1 space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Customer Views"}),(0,b.jsx)("p",{className:"text-gray-600 text-sm",children:"Choose how you want to view and manage your customers"})]}),(0,b.jsx)(D.Tabs,{value:a,onValueChange:c,className:"w-full",children:(0,b.jsx)(F,{activeTab:a,selectedCustomer:d})})]}),(0,b.jsx)(O,{activeTab:a,searchTerm:e,setSearchTerm:f,selectedCategory:g,setSelectedCategory:h,dateFilter:i,setDateFilter:j,dateRange:k,setDateRange:l,validCategories:m,filteredCustomers:n,customerStats:p,getCategoryName:q})]})}),(0,b.jsx)("div",{className:"p-8",children:(0,b.jsxs)(D.Tabs,{value:a,onValueChange:c,className:"w-full",children:[(0,b.jsx)(D.TabsContent,{value:"list",className:"mt-0",children:(0,b.jsx)(_,{customers:n,isLoading:!1,onSelectCustomer:r,onEditCustomer:s,onDeleteCustomer:t,canEdit:x,canDelete:y})}),(0,b.jsx)(D.TabsContent,{value:"top",className:"mt-0",children:(0,b.jsx)(af,{selectedCategory:g,dateFilter:i,dateRange:k})}),(0,b.jsx)(D.TabsContent,{value:"inactive",className:"mt-0",children:(0,b.jsx)(as,{customers:o,isLoading:!1,onSelectCustomer:r,selectedCategory:g})}),(0,b.jsx)(D.TabsContent,{value:"details",className:"mt-0",children:d&&(0,b.jsx)(aU,{customer:d,onUpdate:async a=>await u(d.id,a),onDelete:async()=>{let a=await t(d.id);return a&&(v(null),c("list")),a},canEdit:x,canDelete:y})})]})})]}),aW=({customers:a})=>{let c=new Date().getMonth(),d=(0,Y.useIsMobile)(),{settings:e}=(0,h.useBusinessSettings)(),{toast:f}=(0,w.useToast)(),g=a.filter(a=>a.birthday&&a.birthday.getMonth()===c),i=(a,b)=>{if(!(0,aq.canSendSMS)(a))return void f({title:"Phone number required",description:"Customer phone number is not available.",variant:"destructive"});try{let c=(0,aq.getBirthdayMessage)(a.fullName),d=(0,aq.formatMessageForSMS)(c,e.businessName);"sms"===b?((0,aq.openSMSApp)({phoneNumber:a.phoneNumber,message:d}),f({title:"SMS app opened",description:"Birthday wishes prepared in SMS app."})):((0,aq.openWhatsApp)({phoneNumber:a.phoneNumber,message:d}),f({title:"WhatsApp opened",description:"Birthday wishes prepared in WhatsApp."}))}catch(a){console.error("Error sending birthday wishes:",a),f({title:"Failed to send",description:"Failed to open messaging app. Please try again.",variant:"destructive"})}};return(0,b.jsxs)(z.Card,{children:[(0,b.jsx)(z.CardHeader,{className:"pb-3",children:(0,b.jsxs)(z.CardTitle,{className:"flex items-center gap-2 text-lg font-medium",children:[(0,b.jsx)(aw,{className:"h-5 w-5 text-blue-500"}),(0,b.jsx)("span",{children:"This Month's Birthdays"}),g.length>0&&(0,b.jsx)(P.Badge,{variant:"secondary",className:"ml-2",children:g.length})]})}),(0,b.jsx)(z.CardContent,{children:g.length>0?(0,b.jsx)("ul",{className:"space-y-3",children:g.map(a=>(0,b.jsxs)("li",{className:"flex items-center justify-between border-b pb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.fullName}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:a.birthday&&(0,u.format)(a.birthday,"MMMM d")})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[a.email&&(0,b.jsx)("a",{href:`mailto:${a.email}?subject=Happy Birthday!&body=${encodeURIComponent(" Happy Birthday! \nWishing you a day filled with joy, love, and great memories. Thank you for being a valued part of our Family. We're grateful for your support and wish you nothing but happiness in the year ahead!")}`,className:"text-sm text-blue-500 hover:underline",children:"Send email"}),(0,aq.canSendSMS)(a)&&d&&(0,b.jsxs)(o.Button,{size:"sm",variant:"outline",onClick:()=>i(a,"sms"),className:"text-xs",children:[(0,b.jsx)(ap.MessageSquare,{className:"h-3 w-3 mr-1"}),"SMS"]}),(0,aq.canSendSMS)(a)&&(0,b.jsx)(o.Button,{size:"sm",variant:"outline",onClick:()=>i(a,"whatsapp"),className:"text-xs border-green-500 text-green-700 hover:bg-green-50",children:" WhatsApp"})]})]},a.id))}):(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"No birthdays this month"})})]})};var aX=a.i(915618),aY=a.i(321161);let aZ=()=>{let{categories:a,isLoading:d,createCategory:e,updateCategory:f,deleteCategory:h}=(0,g.useCustomerCategories)(),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(null),[p,q]=(0,c.useState)(!1),r=async()=>{k.trim()&&(q(!0),await e(k)&&(l(""),j(!1)),q(!1))},s=async()=>{m&&m.name.trim()&&(q(!0),await f(m.id,m.name)&&n(null),q(!1))},t=async a=>{await h(a)};return d?(0,b.jsx)("div",{children:"Loading categories..."}):(0,b.jsxs)(z.Card,{children:[(0,b.jsx)(z.CardHeader,{children:(0,b.jsxs)(z.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(aY.Settings,{className:"h-5 w-5"}),"Manage Categories"]})}),(0,b.jsxs)(z.CardContent,{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:a.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2 p-2 border rounded-lg",children:[(0,b.jsx)(P.Badge,{variant:a.isDefault?"default":"secondary",children:a.name}),(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>n({id:a.id,name:a.name}),className:"h-6 w-6 p-0",children:(0,b.jsx)(S.Edit,{className:"h-3 w-3"})}),(0,b.jsxs)(ax.AlertDialog,{children:[(0,b.jsx)(ax.AlertDialogTrigger,{asChild:!0,children:(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-red-600",children:(0,b.jsx)(au.Trash2,{className:"h-3 w-3"})})}),(0,b.jsxs)(ax.AlertDialogContent,{children:[(0,b.jsxs)(ax.AlertDialogHeader,{children:[(0,b.jsx)(ax.AlertDialogTitle,{children:"Delete Category"}),(0,b.jsxs)(ax.AlertDialogDescription,{children:['Are you sure you want to delete the "',a.name,'" category? This action cannot be undone.']})]}),(0,b.jsxs)(ax.AlertDialogFooter,{children:[(0,b.jsx)(ax.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(ax.AlertDialogAction,{onClick:()=>t(a.id),children:"Delete"})]})]})]})]})]},a.id))}),(0,b.jsxs)(an.Dialog,{open:i,onOpenChange:j,children:[(0,b.jsx)(an.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(o.Button,{variant:"outline",className:"gap-2",children:[(0,b.jsx)(aX.Plus,{className:"h-4 w-4"}),"Add Category"]})}),(0,b.jsxs)(an.DialogContent,{children:[(0,b.jsxs)(an.DialogHeader,{children:[(0,b.jsx)(an.DialogTitle,{children:"Add New Category"}),(0,b.jsx)(an.DialogDescription,{children:"Create a new customer category to organize your customers."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(H.Label,{htmlFor:"categoryName",children:"Category Name"}),(0,b.jsx)(G.Input,{id:"categoryName",value:k,onChange:a=>l(a.target.value),placeholder:"Enter category name"})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(o.Button,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),(0,b.jsx)(o.Button,{onClick:r,disabled:!k.trim()||p,children:p?"Creating...":"Create"})]})]})]})]}),m&&(0,b.jsx)(an.Dialog,{open:!!m,onOpenChange:()=>n(null),children:(0,b.jsxs)(an.DialogContent,{children:[(0,b.jsxs)(an.DialogHeader,{children:[(0,b.jsx)(an.DialogTitle,{children:"Edit Category"}),(0,b.jsx)(an.DialogDescription,{children:"Update the category name."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(H.Label,{htmlFor:"editCategoryName",children:"Category Name"}),(0,b.jsx)(G.Input,{id:"editCategoryName",value:m.name,onChange:a=>n({...m,name:a.target.value}),placeholder:"Enter category name"})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(o.Button,{variant:"outline",onClick:()=>n(null),children:"Cancel"}),(0,b.jsx)(o.Button,{onClick:s,disabled:!m.name.trim()||p,children:p?"Updating...":"Update"})]})]})]})})]})]})};var a$=a.i(197920),a_=a.i(507554),a0=a.i(470121),a1=a.i(750104),a2=a.i(30553),a3=a.i(224050),a4=a.i(225152),a5=a.i(507827),a6=a.i(3688),a7=a.i(77994),a8=a.i(777192),a9="Radio",[ba,bb]=(0,a1.createContextScope)(a9),[bc,bd]=ba(a9),be=c.forwardRef((a,d)=>{let{__scopeRadio:e,name:f,checked:g=!1,required:h,disabled:i,value:j="on",onCheck:k,form:l,...m}=a,[n,o]=c.useState(null),p=(0,a0.useComposedRefs)(d,a=>o(a)),q=c.useRef(!1),r=!n||l||!!n.closest("form");return(0,b.jsxs)(bc,{scope:e,checked:g,disabled:i,children:[(0,b.jsx)(a2.Primitive.button,{type:"button",role:"radio","aria-checked":g,"data-state":bi(g),"data-disabled":i?"":void 0,disabled:i,value:j,...m,ref:p,onClick:(0,a_.composeEventHandlers)(a.onClick,a=>{g||k?.(),r&&(q.current=a.isPropagationStopped(),q.current||a.stopPropagation())})}),r&&(0,b.jsx)(bh,{control:n,bubbles:!q.current,name:f,value:j,checked:g,required:h,disabled:i,form:l,style:{transform:"translateX(-100%)"}})]})});be.displayName=a9;var bf="RadioIndicator",bg=c.forwardRef((a,c)=>{let{__scopeRadio:d,forceMount:e,...f}=a,g=bd(bf,d);return(0,b.jsx)(a8.Presence,{present:e||g.checked,children:(0,b.jsx)(a2.Primitive.span,{"data-state":bi(g.checked),"data-disabled":g.disabled?"":void 0,...f,ref:c})})});bg.displayName=bf;var bh=c.forwardRef(({__scopeRadio:a,control:d,checked:e,bubbles:f=!0,...g},h)=>{let i=c.useRef(null),j=(0,a0.useComposedRefs)(i,h),k=(0,a7.usePrevious)(e),l=(0,a6.useSize)(d);return c.useEffect(()=>{let a=i.current;if(!a)return;let b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(k!==e&&b){let c=new Event("click",{bubbles:f});b.call(a,e),a.dispatchEvent(c)}},[k,e,f]),(0,b.jsx)(a2.Primitive.input,{type:"radio","aria-hidden":!0,defaultChecked:e,...g,tabIndex:-1,ref:j,style:{...g.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function bi(a){return a?"checked":"unchecked"}bh.displayName="RadioBubbleInput";var bj=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],bk="RadioGroup",[bl,bm]=(0,a1.createContextScope)(bk,[a3.createRovingFocusGroupScope,bb]),bn=(0,a3.createRovingFocusGroupScope)(),bo=bb(),[bp,bq]=bl(bk),br=c.forwardRef((a,c)=>{let{__scopeRadioGroup:d,name:e,defaultValue:f,value:g,required:h=!1,disabled:i=!1,orientation:j,dir:k,loop:l=!0,onValueChange:m,...n}=a,o=bn(d),p=(0,a5.useDirection)(k),[q,r]=(0,a4.useControllableState)({prop:g,defaultProp:f??null,onChange:m,caller:bk});return(0,b.jsx)(bp,{scope:d,name:e,required:h,disabled:i,value:q,onValueChange:r,children:(0,b.jsx)(a3.Root,{asChild:!0,...o,orientation:j,dir:p,loop:l,children:(0,b.jsx)(a2.Primitive.div,{role:"radiogroup","aria-required":h,"aria-orientation":j,"data-disabled":i?"":void 0,dir:p,...n,ref:c})})})});br.displayName=bk;var bs="RadioGroupItem",bt=c.forwardRef((a,d)=>{let{__scopeRadioGroup:e,disabled:f,...g}=a,h=bq(bs,e),i=h.disabled||f,j=bn(e),k=bo(e),l=c.useRef(null),m=(0,a0.useComposedRefs)(d,l),n=h.value===g.value,o=c.useRef(!1);return c.useEffect(()=>{let a=a=>{bj.includes(a.key)&&(o.current=!0)},b=()=>o.current=!1;return document.addEventListener("keydown",a),document.addEventListener("keyup",b),()=>{document.removeEventListener("keydown",a),document.removeEventListener("keyup",b)}},[]),(0,b.jsx)(a3.Item,{asChild:!0,...j,focusable:!i,active:n,children:(0,b.jsx)(be,{disabled:i,required:h.required,checked:n,...k,...g,name:h.name,ref:m,onCheck:()=>h.onValueChange(g.value),onKeyDown:(0,a_.composeEventHandlers)(a=>{"Enter"===a.key&&a.preventDefault()}),onFocus:(0,a_.composeEventHandlers)(g.onFocus,()=>{o.current&&l.current?.click()})})})});bt.displayName=bs;var bu=c.forwardRef((a,c)=>{let{__scopeRadioGroup:d,...e}=a,f=bo(d);return(0,b.jsx)(bg,{...f,...e,ref:c})});bu.displayName="RadioGroupIndicator";var bv=a.i(65151);let bw=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(br,{className:(0,N.cn)("grid gap-2",a),...c,ref:d}));bw.displayName=br.displayName;let bx=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(bt,{ref:d,className:(0,N.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),...c,children:(0,b.jsx)(bu,{className:"flex items-center justify-center",children:(0,b.jsx)(bv.Circle,{className:"h-2.5 w-2.5 fill-current text-current"})})}));bx.displayName=bt.displayName;let by=(0,k.createServerReference)("601c2e81e5452f88769b0bfbde3086892068006dee",k.callServer,void 0,k.findSourceMapURL,"mergeCustomersAction"),bz=({open:a,onOpenChange:d,customers:e,onMergeComplete:f})=>{let[g,h]=(0,c.useState)(e[0]?.id||""),[i,j]=(0,c.useState)(!1),k=async()=>{if(g&&!(e.length<2)){j(!0);try{let a=e.find(a=>a.id===g),b=e.filter(a=>a.id!==g).map(a=>a.id);if(!a||0===b.length)throw Error("Invalid selection");let c=await by(g,b);if(!c.success)throw Error(c.error);am.toast.success(`Successfully merged ${b.length} duplicate customer${b.length>1?"s":""} into ${a.fullName}`),f(),d(!1)}catch(b){console.error("Error merging customers:",b);let a=b?.message||b?.details||"Failed to merge customers";am.toast.error(`Merge failed: ${a}`)}finally{j(!1)}}};return(0,b.jsx)(an.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(an.DialogContent,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,b.jsxs)(an.DialogHeader,{children:[(0,b.jsxs)(an.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(r.Users,{className:"h-5 w-5"}),"Merge Duplicate Customers"]}),(0,b.jsx)(an.DialogDescription,{children:"Select which customer record to keep. All sales from duplicates will be transferred to the primary customer."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-start gap-2",children:[(0,b.jsx)(ah.AlertCircle,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"text-sm text-amber-800",children:[(0,b.jsx)("p",{className:"font-semibold mb-1",children:"This action cannot be undone"}),(0,b.jsx)("p",{children:"Duplicate customers will be permanently deleted, and all their sales will be transferred to the primary customer."})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(H.Label,{className:"text-base font-semibold mb-3 block",children:"Select Primary Customer (to keep):"}),(0,b.jsx)(bw,{value:g,onValueChange:h,children:(0,b.jsx)("div",{className:"space-y-3",children:e.map(a=>(0,b.jsx)(z.Card,{className:`cursor-pointer transition-all ${g===a.id?"border-primary border-2 bg-primary/5":"hover:border-gray-300"}`,children:(0,b.jsx)(z.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(bx,{value:a.id,id:a.id,className:"mt-1"}),(0,b.jsx)("label",{htmlFor:a.id,className:"flex-1 cursor-pointer",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-semibold text-base",children:a.fullName}),(0,b.jsxs)("div",{className:"space-y-1 mt-2 text-sm text-muted-foreground",children:[a.phoneNumber&&(0,b.jsxs)("div",{children:["Phone: ",a.phoneNumber]}),a.email&&(0,b.jsxs)("div",{children:["Email: ",a.email]}),a.location&&(0,b.jsxs)("div",{children:["Location: ",a.location]}),(0,b.jsxs)("div",{children:["Created: ",a.createdAt.toLocaleDateString()]})]})]}),g===a.id&&(0,b.jsx)(P.Badge,{className:"bg-primary",children:"Primary"})]})})]})})},a.id))})})]}),(0,b.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 flex items-start gap-2",children:[(0,b.jsx)(A.TrendingUp,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,b.jsx)("p",{className:"font-semibold mb-1",children:"After merging:"}),(0,b.jsxs)("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[(0,b.jsx)("li",{children:"All sales will be linked to the primary customer"}),(0,b.jsx)("li",{children:"Duplicate customer records will be deleted"}),(0,b.jsx)("li",{children:"Sales history will be preserved"})]})]})]})]}),(0,b.jsxs)(an.DialogFooter,{children:[(0,b.jsx)(o.Button,{variant:"outline",onClick:()=>d(!1),disabled:i,children:"Cancel"}),(0,b.jsx)(o.Button,{onClick:k,disabled:i||!g,children:i?"Merging...":`Merge ${e.length} Customers`})]})]})})};var bA=a.i(890914),bB=a.i(124348),bC=a.i(400210);a.s(["default",0,()=>{let a,k,{user:m}=(0,d.useAuth)(),{currentBusiness:p,isLoading:q}=(0,e.useBusiness)(),{customers:r,isLoading:s,createCustomer:t,updateCustomer:u,deleteCustomer:v,page:w,setPage:x,pageSize:A,setPageSize:B,totalCount:D}=(0,f.useCustomers)(50),{categories:E}=(0,g.useCustomerCategories)(),{settings:F}=(0,h.useBusinessSettings)(),{getCustomerLifetimePurchases:G}=(0,i.useSalesData)(m?.id),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)("all"),[L,M]=(0,c.useState)("all"),[N,O]=(0,c.useState)({from:void 0,to:void 0}),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)(void 0),[W,X]=(0,c.useState)("list"),Y=(0,j.useSearchParams)(),Z=(0,j.useRouter)(),{hasPermission:$,isLoading:_}=(0,bA.useProfiles)(),aa=$("customers","view"),ab=$("customers","create"),ac=$("customers","edit"),ad=$("customers","delete"),[ae,af]=(0,c.useState)(!1),[ag,ai]=(0,c.useState)([]),[aj,ak]=(0,c.useState)(null),[al,ao]=(0,c.useState)(!1),[ap,aq]=(0,c.useState)(void 0),[ar,as]=(0,c.useState)(void 0);(0,c.useEffect)(()=>{let a=!1;return(async()=>{if(!m?.id||!p?.id)return;let b=`allCustomerStats_${p.id}`,c=localStorage.getItem(b);try{if(c){let a=JSON.parse(c);if(Date.now()-a.ts<3e5){aq(a.withBirthdays),as(a.thisMonth);return}}}catch{}let d=await l(m.id,p.id);if(!a&&d.success&&d.data){aq(d.data.withBirthdays),as(d.data.thisMonth);try{localStorage.setItem(b,JSON.stringify({withBirthdays:d.data.withBirthdays,thisMonth:d.data.thisMonth,ts:Date.now()}))}catch{}}})(),()=>{a=!0}},[m?.id,p?.id]);let{validCategories:at,filteredCustomers:au,customerStats:av,getCategoryName:aw}=(a=(0,c.useMemo)(()=>E.filter(a=>a.id&&""!==a.id.trim()),[E]),k=(0,c.useMemo)(()=>r.filter(a=>{let b=a.fullName.toLowerCase().includes(H.toLowerCase())||a.email&&a.email.toLowerCase().includes(H.toLowerCase())||a.phoneNumber&&a.phoneNumber.includes(H),c="all"===J||a.categoryId===J;return b&&c}),[r,H,J]),{validCategories:a,filteredCustomers:k,customerStats:(0,c.useMemo)(()=>{let a="number"==typeof D?D:r.length,b="number"==typeof ap?ap:r.filter(a=>a.birthday).length;return{totalCustomers:a,customersWithBirthdays:b,customersThisMonth:"number"==typeof ar?ar:r.filter(a=>{let b=new Date,c=new Date(a.createdAt);return c.getMonth()===b.getMonth()&&c.getFullYear()===b.getFullYear()}).length,categoryBreakdown:E.reduce((a,b)=>(a[b.id]=r.filter(a=>a.categoryId===b.id).length,a),{})}},[r,E,D,ap,ar]),getCategoryName:b=>{if(!b)return"Uncategorized";let c=a.find(a=>a.id===b);return c?.name||"Unknown Category"}});(0,c.useEffect)(()=>{"new"===Y.get("action")&&(T(!0),Z.push("/customers"));let a=Y.get("view");if(a&&r.length>0){let b=r.find(b=>b.id===a);b&&(R(b),X("details"))}},[Y,r,Z]);let ax=(0,c.useCallback)(async a=>(U?await u(U.id,a):await t(a),T(!1),V(void 0),!0),[U,u,t]),ay=(0,c.useCallback)(a=>{R(a),X("details")},[]),az=(0,c.useCallback)(a=>{V(a),T(!0)},[]),aA=(0,c.useCallback)(()=>{V(void 0),T(!0)},[]),aB=(0,c.useCallback)(()=>{let a=new Map;r.forEach(b=>{let c=b.fullName.toLowerCase().trim();a.has(c)||a.set(c,[]),a.get(c).push(b)});let b=[];(a.forEach(a=>{a.length>1&&b.push(a)}),0===b.length)?am.toast.info("No duplicate customers found"):(ai(b),af(!0))},[r]);return q||!p||s||_?(0,b.jsx)(n,{}):aa?(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsx)(y,{onAddNewCustomer:aA,onFindDuplicates:ac?aB:void 0,customers:au,currency:F.currency,businessName:F.businessName,businessLogo:F.businessLogo,getCategoryName:aw,getCustomerLifetimePurchases:G,canCreate:ab}),(0,b.jsx)(C,{customerStats:av}),(0,b.jsx)(aW,{customers:r}),(0,b.jsx)(aZ,{}),(0,b.jsx)(aV,{activeTab:W,setActiveTab:X,selectedCustomer:Q,searchTerm:H,setSearchTerm:I,selectedCategory:J,setSelectedCategory:K,dateFilter:L,setDateFilter:M,dateRange:N,setDateRange:O,validCategories:at,filteredCustomers:au,customers:r,customerStats:av,getCategoryName:aw,onSelectCustomer:ay,onEditCustomer:az,onDeleteCustomer:v,onUpdateCustomer:u,setSelectedCustomer:R,canCreate:ab,canEdit:ac,canDelete:ad}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 md:p-4 border rounded",children:[(0,b.jsxs)("div",{className:"text-xs md:text-sm text-muted-foreground",children:["Showing ",(w-1)*A+1,"",Math.min(w*A,D)," of ",D]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("select",{className:"border rounded px-2 py-1 text-xs md:text-sm",value:A,onChange:a=>B(Number(a.target.value)),children:[20,50,100].map(a=>(0,b.jsxs)("option",{value:a,children:[a," / page"]},a))}),(0,b.jsx)("button",{className:"border rounded px-2 py-1 text-xs md:text-sm",disabled:1===w||s,onClick:()=>x(Math.max(1,w-1)),type:"button",children:"Prev"}),(0,b.jsx)("button",{className:"border rounded px-2 py-1 text-xs md:text-sm",disabled:w*A>=D||s,onClick:()=>x(w+1),type:"button",children:"Next"})]})]}),(0,b.jsx)(a$.default,{open:S,onClose:()=>{T(!1),V(void 0)},onAddCustomer:ax,initialData:U}),(0,b.jsx)(an.Dialog,{open:ae,onOpenChange:af,children:(0,b.jsxs)(an.DialogContent,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",children:[(0,b.jsxs)(an.DialogHeader,{children:[(0,b.jsx)(an.DialogTitle,{children:"Duplicate Customers Found"}),(0,b.jsxs)(an.DialogDescription,{children:["Found ",ag.length," group(s) of duplicate customers. Select a group to merge."]})]}),(0,b.jsx)("div",{className:"space-y-4",children:ag.map((a,c)=>(0,b.jsx)(z.Card,{className:"p-4",children:(0,b.jsxs)(z.CardContent,{className:"p-0",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-semibold text-lg",children:a[0].fullName}),(0,b.jsxs)(P.Badge,{variant:"secondary",className:"mt-1",children:[a.length," duplicates"]})]}),(0,b.jsx)(o.Button,{onClick:()=>{ak(a),ao(!0)},size:"sm",children:"Merge"})]}),(0,b.jsx)("div",{className:"space-y-2 text-sm",children:a.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between border-l-2 border-gray-200 pl-3 py-1",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{children:a.phoneNumber||"No phone"}),(0,b.jsxs)("div",{className:"text-muted-foreground text-xs",children:["Created: ",a.createdAt.toLocaleDateString()]})]}),a.email&&(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.email})]},a.id))})]})},c))})]})}),aj&&(0,b.jsx)(bz,{open:al,onOpenChange:ao,customers:aj,onMergeComplete:()=>{window.location.reload()}})]}):(0,b.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,b.jsxs)(bB.Alert,{variant:"destructive",children:[(0,b.jsx)(ah.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(bB.AlertTitle,{children:"Access Denied"}),(0,b.jsx)(bB.AlertDescription,{children:"You do not have permission to view the customers module. Please contact your administrator if you believe this is an error."})]}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsxs)(o.Button,{onClick:()=>Z.push("/"),variant:"outline",className:"gap-2",children:[(0,b.jsx)(bC.ArrowLeft,{className:"h-4 w-4"}),"Back to Dashboard"]})})]})}],526691)}];

//# sourceMappingURL=_7bf6476d._.js.map