module.exports=[542715,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(915618),e=a.i(267900),f=a.i(781560),g=a.i(699464),h=a.i(533441),i=a.i(787654),j=a.i(284505),k=a.i(773320),l=a.i(943108),m=a.i(603314),n=a.i(699570),o=a.i(591119),p=a.i(786304),q=a.i(866718),r=a.i(870430),s=a.i(486192),t=a.i(169819),u=a.i(478793),v=a.i(814574);let w=({open:a,onOpenChange:d})=>{let[e,f]=(0,c.useState)(""),[g,h]=(0,c.useState)(!1),{createBusiness:i}=(0,t.useBusiness)(),{toast:j}=(0,u.useToast)();(0,c.useEffect)(()=>{a||(f(""),h(!1))},[a]);let k=async a=>{if(a.preventDefault(),!e.trim())return void j({title:"Error",description:"Business name is required",variant:"destructive"});h(!0);try{console.log("Creating business with name:",e.trim()),await i(e.trim())?(j({title:"Success",description:"Business created successfully"}),f(""),d(!1)):j({title:"Error",description:"Failed to create business",variant:"destructive"})}catch(a){console.error("Error creating business:",a),j({title:"Error",description:"Failed to create business",variant:"destructive"})}finally{h(!1)}};return(0,b.jsx)(v.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(v.DialogContent,{className:"sm:max-w-md",onOpenAutoFocus:a=>a.preventDefault(),children:[(0,b.jsx)(v.DialogHeader,{children:(0,b.jsx)(v.DialogTitle,{children:"Create New Business"})}),(0,b.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"businessName",children:"Business Name"}),(0,b.jsx)(q.Input,{id:"businessName",type:"text",value:e,onChange:a=>{console.log("Input value changing to:",a.target.value),f(a.target.value)},placeholder:"Enter business name",disabled:g,autoComplete:"off",className:"w-full"})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,b.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>{f(""),d(!1)},disabled:g,children:"Cancel"}),(0,b.jsx)(n.Button,{type:"submit",disabled:g||!e.trim(),children:g?"Creating...":"Create Business"})]})]})]})})},x=({open:a,onOpenChange:c,onConfirm:d,businessName:e})=>(0,b.jsx)(s.AlertDialog,{open:a,onOpenChange:c,children:(0,b.jsxs)(s.AlertDialogContent,{className:"mx-4 max-w-md",children:[(0,b.jsxs)(s.AlertDialogHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"p-2 bg-amber-100 rounded-lg",children:(0,b.jsx)(i.RotateCcw,{className:"h-5 w-5 text-amber-600"})}),(0,b.jsx)(s.AlertDialogTitle,{children:"Reset Business Location"})]}),(0,b.jsxs)(s.AlertDialogDescription,{className:"text-sm space-y-2",children:[(0,b.jsxs)("p",{className:"font-medium text-gray-900",children:['Are you sure you want to reset "',e,'"?']}),(0,b.jsx)("p",{children:"This will permanently delete ALL data for this business location including:"}),(0,b.jsxs)("ul",{className:"list-disc list-inside text-xs space-y-1 ml-2",children:[(0,b.jsx)("li",{children:"All products and inventory"}),(0,b.jsx)("li",{children:"All sales records and receipts"}),(0,b.jsx)("li",{children:"All customers and their data"}),(0,b.jsx)("li",{children:"All expenses and transactions"}),(0,b.jsx)("li",{children:"All cash accounts and balances"}),(0,b.jsx)("li",{children:"All tasks and categories"}),(0,b.jsx)("li",{children:"All business settings"})]}),(0,b.jsx)("p",{className:"font-medium text-red-600 mt-2",children:"This action cannot be undone!"})]})]}),(0,b.jsxs)(s.AlertDialogFooter,{className:"flex-col-reverse md:flex-row gap-2",children:[(0,b.jsx)(s.AlertDialogCancel,{className:"w-full md:w-auto",children:"Cancel"}),(0,b.jsx)(s.AlertDialogAction,{onClick:d,className:"w-full md:w-auto bg-amber-600 hover:bg-amber-700 text-white",children:"Reset Business"})]})]})});var y=a.i(173390),z=a.i(391956),A=a.i(823292),B=a.i(405050);let C=(0,B.createServerReference)("60cb37a955a3f0fc9842da415e4b6b6c26c486a212",B.callServer,void 0,B.findSourceMapURL,"getBusinessBackupDataAction"),D=()=>{let[a,b]=(0,c.useState)(!1),[d,e]=(0,c.useState)(!1),[f,g]=(0,c.useState)(0),{user:h}=(0,z.useAuth)(),{currentBusiness:i}=(0,t.useBusiness)();return{exportBusinessData:async()=>{if(!h||!i)return void A.toast.error("No business selected for backup");b(!0),g(10);try{let a=await C(h.id,i.id);if(!a.success)throw Error(a.error||"Export failed");g(90);let b={metadata:{version:"1.0",timestamp:new Date().toISOString(),businessName:i.name,businessId:i.id,exportType:"full_backup"},data:a.data},c=new Blob([JSON.stringify(b,null,2)],{type:"application/json"}),d=URL.createObjectURL(c),e=document.createElement("a");e.href=d,e.download=`${i.name.replace(/[^a-zA-Z0-9]/g,"_")}_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(d),g(100),A.toast.success("Backup completed successfully")}catch(a){console.error("Backup failed:",a),A.toast.error("Backup failed. Please try again.")}finally{b(!1),g(0)}},importBusinessData:async a=>(A.toast.error("Data import is not yet supported with the new Prisma backend. Please contact support."),!1),isExporting:a,isImporting:d,progress:f}},E=({open:a,onOpenChange:c})=>{let{exportBusinessData:d,isExporting:e,progress:f}=D(),{currentBusiness:g}=(0,t.useBusiness)(),h=async()=>{await d(),e||c(!1)};return(0,b.jsx)(v.Dialog,{open:a,onOpenChange:c,children:(0,b.jsxs)(v.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(v.DialogHeader,{children:[(0,b.jsxs)(v.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(j.Download,{className:"h-5 w-5"}),"Backup Business Data"]}),(0,b.jsxs)(v.DialogDescription,{children:["Export all your business data including products, sales, customers, expenses, and settings.",g&&(0,b.jsxs)("span",{className:"block mt-2 font-medium text-foreground",children:["Business: ",g.name]})]})]}),e&&(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Preparing backup... ",f.toFixed(0),"%"]}),(0,b.jsx)(y.Progress,{value:f,className:"w-full"})]}),(0,b.jsxs)(v.DialogFooter,{className:"flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",children:[(0,b.jsx)(n.Button,{variant:"outline",onClick:()=>c(!1),disabled:e,children:"Cancel"}),(0,b.jsx)(n.Button,{onClick:h,disabled:e||!g,children:e?"Exporting...":"Start Backup"})]})]})})};var F=a.i(73570),G=a.i(124348);let H=({open:a,onOpenChange:d})=>{let{importBusinessData:e,isImporting:f,progress:g}=D(),{currentBusiness:h}=(0,t.useBusiness)(),[i,j]=(0,c.useState)(null),[l,m]=(0,c.useState)(!1),o=(0,c.useRef)(null),p=async()=>{!i||await e(i)&&(d(!1),j(null),m(!1))},q=()=>{d(!1),j(null),m(!1),o.current&&(o.current.value="")};return(0,b.jsx)(v.Dialog,{open:a,onOpenChange:q,children:(0,b.jsxs)(v.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(v.DialogHeader,{children:[(0,b.jsxs)(v.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Upload,{className:"h-5 w-5"}),"Restore Business Data"]}),(0,b.jsxs)(v.DialogDescription,{children:["Import business data from a backup file. This will replace all current data.",h&&(0,b.jsxs)("span",{className:"block mt-2 font-medium text-foreground",children:["Target Business: ",h.name]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[!i&&(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center border-2 border-dashed border-border rounded-lg p-6",children:[(0,b.jsx)(k.Upload,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Select a backup file to restore"}),(0,b.jsx)(n.Button,{variant:"outline",onClick:()=>o.current?.click(),disabled:f,children:"Choose File"}),(0,b.jsx)("input",{ref:o,type:"file",accept:".json",onChange:a=>{let b=a.target.files?.[0];b&&("application/json"===b.type||b.name.endsWith(".json")?(j(b),m(!0)):alert("Please select a valid JSON backup file"))},className:"hidden"})]}),i&&!f&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"p-3 bg-muted rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Selected File:"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:i.name}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(i.size/1024).toFixed(1)," KB"]})]}),l&&(0,b.jsxs)(G.Alert,{children:[(0,b.jsx)(F.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsxs)(G.AlertDescription,{children:[(0,b.jsx)("strong",{children:"Warning:"})," This will permanently replace all current business data including products, sales, customers, and settings. This action cannot be undone."]})]})]}),f&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Restoring data... ",g.toFixed(0),"%"]}),(0,b.jsx)(y.Progress,{value:g,className:"w-full"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"Please don't close this window. The app will reload automatically when complete."})]})]}),(0,b.jsxs)(v.DialogFooter,{className:"flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",children:[(0,b.jsx)(n.Button,{variant:"outline",onClick:q,disabled:f,children:"Cancel"}),i&&(0,b.jsx)(n.Button,{onClick:p,disabled:f||!h,variant:"destructive",children:f?"Restoring...":"Restore Data"})]})]})})};var I=a.i(175467),J=a.i(177156),K=a.i(141379);let L=(0,a.i(170106).default)("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]),M=({open:a,onOpenChange:d,businessId:e,businessName:f,hasPassword:g,onPasswordSet:h,onSetPassword:i,onRemovePassword:j})=>{let[k,o]=(0,c.useState)(""),[p,t]=(0,c.useState)(""),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(""),[I,M]=(0,c.useState)(!1),{toast:N}=(0,u.useToast)(),O=async a=>{if(a.preventDefault(),k.length<6?(N({title:"Password Too Short",description:"Password must be at least 6 characters long.",variant:"destructive"}),!1):k===p||(N({title:"Passwords Don't Match",description:"Please make sure both passwords are identical.",variant:"destructive"}),!1)){B(!0);try{await i(e,k)&&(h(e,!0),o(""),t(""),d(!1),N({title:"Password Set Successfully",description:`Business "${f}" is now password protected.`}),setTimeout(()=>{window.location.reload()},1e3))}catch(a){console.error("Error setting password:",a),N({title:"Failed to Set Password",description:"Please try again later.",variant:"destructive"})}finally{B(!1)}}},P=async()=>{if(!G.trim())return void N({title:"Password Required",description:"Please enter the current password to remove protection.",variant:"destructive"});B(!0);try{await j(e,G)&&(h(e,!1),D(!1),F(!1),H(""),d(!1),N({title:"Password Removed",description:`Business "${f}" is no longer password protected.`}),setTimeout(()=>{window.location.reload()},1e3))}catch(a){console.error("Error removing password:",a),N({title:"Failed to Remove Password",description:"Please try again later.",variant:"destructive"})}finally{B(!1)}},Q=()=>{F(!0)};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(v.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(v.DialogHeader,{className:"text-center",children:[(0,b.jsx)("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10",children:g?(0,b.jsx)(m.Shield,{className:"h-6 w-6 text-primary"}):(0,b.jsx)(L,{className:"h-6 w-6 text-muted-foreground"})}),(0,b.jsx)(v.DialogTitle,{className:"text-xl",children:g?"Change Business Password":"Set Business Password"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:g?`Update the password for "${f}"`:`Set a password to protect access to "${f}"`})]}),g?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"text-center p-4 rounded-lg bg-muted/50",children:[(0,b.jsx)(l.Lock,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"This business is currently password protected"})]}),E?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-amber-50 border border-amber-200",children:[(0,b.jsx)("p",{className:"text-sm text-amber-800 font-medium mb-2",children:"Enter current password to remove protection"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(q.Input,{type:I?"text":"password",value:G,onChange:a=>H(a.target.value),placeholder:"Enter current password",disabled:A,className:"pr-10"}),(0,b.jsx)(n.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>M(!I),disabled:A,children:I?(0,b.jsx)(K.EyeOff,{className:"h-4 w-4 text-muted-foreground"}):(0,b.jsx)(J.Eye,{className:"h-4 w-4 text-muted-foreground"})})]})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(n.Button,{variant:"outline",onClick:()=>{F(!1),H("")},disabled:A,className:"flex-1",children:"Cancel"}),(0,b.jsx)(n.Button,{variant:"destructive",onClick:P,disabled:A||!G.trim(),className:"flex-1",children:A?"Removing...":"Remove Password"})]})]}):(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)(n.Button,{variant:"destructive",onClick:Q,disabled:A,className:"w-full max-w-xs",children:"Remove Password"})})]}):null,(!g||k||p)&&(0,b.jsxs)("form",{onSubmit:O,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"new-password",children:"New Password"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(q.Input,{id:"new-password",type:w?"text":"password",value:k,onChange:a=>o(a.target.value),placeholder:"Enter new password (min 6 characters)",disabled:A,className:"pr-10"}),(0,b.jsx)(n.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>x(!w),disabled:A,children:w?(0,b.jsx)(K.EyeOff,{className:"h-4 w-4 text-muted-foreground"}):(0,b.jsx)(J.Eye,{className:"h-4 w-4 text-muted-foreground"})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"confirm-password",children:"Confirm Password"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(q.Input,{id:"confirm-password",type:y?"text":"password",value:p,onChange:a=>t(a.target.value),placeholder:"Confirm new password",disabled:A,className:"pr-10"}),(0,b.jsx)(n.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>z(!y),disabled:A,children:y?(0,b.jsx)(K.EyeOff,{className:"h-4 w-4 text-muted-foreground"}):(0,b.jsx)(J.Eye,{className:"h-4 w-4 text-muted-foreground"})})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>{o(""),t(""),x(!1),z(!1),F(!1),H(""),M(!1),d(!1)},disabled:A,className:"flex-1",children:"Cancel"}),(0,b.jsx)(n.Button,{type:"submit",disabled:A||!k.trim()||!p.trim(),className:"flex-1",children:A?"Setting...":g?"Update Password":"Set Password"})]})]})]})}),(0,b.jsx)(s.AlertDialog,{open:C,onOpenChange:D,children:(0,b.jsxs)(s.AlertDialogContent,{children:[(0,b.jsxs)(s.AlertDialogHeader,{children:[(0,b.jsx)(s.AlertDialogTitle,{children:"Remove Password Protection?"}),(0,b.jsxs)(s.AlertDialogDescription,{children:['This will remove password protection from "',f,'". Anyone with access to your account will be able to switch to this business without entering a password.']})]}),(0,b.jsxs)(s.AlertDialogFooter,{children:[(0,b.jsx)(s.AlertDialogCancel,{disabled:A,children:"Cancel"}),(0,b.jsx)(s.AlertDialogAction,{onClick:Q,disabled:A,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:A?"Removing...":"Remove Password"})]})]})})]})};var N=a.i(770094),O=a.i(474507),P=a.i(890914);a.s(["default",0,()=>{let{businessLocations:a,currentBusiness:v,switchBusiness:y,updateBusiness:z,deleteBusiness:A,resetBusiness:B,locationLimit:C}=(0,t.useBusiness)(),{toast:D}=(0,u.useToast)(),F=(0,N.useIsMobile)(),{setBusinessPassword:G,verifyBusinessPassword:J,removeBusinessPassword:K,isLoading:L}=(0,O.useBusinessPassword)(),{hasPermission:Q}=(0,P.useProfiles)(),R=Q("settings","manage"),[S,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)(!1),[W,X]=(0,c.useState)(!1),[Y,Z]=(0,c.useState)(!1),[$,_]=(0,c.useState)(null),[aa,ab]=(0,c.useState)(""),[ac,ad]=(0,c.useState)(null),[ae,af]=(0,c.useState)(null),[ag,ah]=(0,c.useState)(!1),[ai,aj]=(0,c.useState)(!1),[ak,al]=(0,c.useState)(!1),[am,an]=(0,c.useState)(null),[ao,ap]=(0,c.useState)(null),aq=async()=>{$&&aa.trim()&&(await z($,aa.trim())?(D({title:"Success",description:"Business name updated successfully"}),_(null),ab("")):D({title:"Error",description:"Failed to update business name",variant:"destructive"}))},ar=()=>{_(null),ab("")},as=async()=>{ac&&(await A(ac)?D({title:"Success",description:"Business deleted successfully"}):D({title:"Error",description:"Failed to delete business",variant:"destructive"}),ad(null))},at=async()=>{if(ae){ah(!0),console.log("Starting reset for business:",ae);try{await B(ae)?(D({title:"Success",description:"Business location has been reset successfully"}),console.log("Reset completed successfully"),setTimeout(()=>window.location.reload(),1500)):(D({title:"Error",description:"Failed to reset business location",variant:"destructive"}),console.error("Reset failed"))}catch(a){console.error("Error during reset:",a),D({title:"Error",description:"Failed to reset business location",variant:"destructive"})}finally{af(null),ah(!1)}}},au=()=>{let b=a.find(a=>a.id===ae);return b?.name||""};return(0,b.jsxs)("div",{className:"space-y-4 md:space-y-6 relative",children:[ag&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,b.jsx)("div",{className:"bg-white rounded-lg p-6 shadow-xl max-w-sm mx-4 w-full",children:(0,b.jsxs)("div",{className:"text-center space-y-4",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Resetting Business"}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:['Clearing all data for "',au(),'"...',(0,b.jsx)("br",{}),(0,b.jsx)("span",{className:"text-xs text-gray-500 mt-1 block",children:"Please don't close this window. This may take a few moments."})]})]})})}),(0,b.jsxs)("div",{className:ag?"pointer-events-none opacity-50":"",children:[(0,b.jsx)("div",{className:"space-y-3 md:space-y-2",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Business Management"}),(0,b.jsx)("p",{className:"text-sm md:text-base text-gray-600 mt-1",children:"Manage your business locations and settings"})]}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-2",children:[(0,b.jsxs)("div",{className:"flex gap-2",children:[R&&(0,b.jsxs)(n.Button,{onClick:()=>X(!0),variant:"outline",className:"flex-1 md:flex-none flex items-center justify-center gap-2",size:"default",disabled:!v||ag,children:[(0,b.jsx)(j.Download,{className:"h-4 w-4"}),F?"Backup":"Backup Data"]}),R&&(0,b.jsxs)(n.Button,{onClick:()=>Z(!0),variant:"outline",className:"flex-1 md:flex-none flex items-center justify-center gap-2",size:"default",disabled:!v||ag,children:[(0,b.jsx)(k.Upload,{className:"h-4 w-4"}),F?"Restore":"Restore Data"]})]}),R&&(0,b.jsxs)(n.Button,{onClick:()=>{a.length>=C?V(!0):T(!0)},className:"w-full md:w-auto flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700",size:"default",disabled:ag,children:[(0,b.jsx)(d.Plus,{className:"h-4 w-4"}),"Create New Business"]})]})]})}),v&&(0,b.jsxs)(o.Card,{className:"border-blue-200 bg-gradient-to-r from-blue-50 to-blue-100/50",children:[(0,b.jsxs)(o.CardHeader,{className:"pb-3",children:[(0,b.jsxs)(o.CardTitle,{className:"flex items-center gap-2 text-blue-800 text-lg md:text-xl",children:[(0,b.jsx)("div",{className:"p-2 bg-blue-200 rounded-lg",children:(0,b.jsx)(e.Building2,{className:"h-5 w-5"})}),"Current Business"]}),(0,b.jsx)(o.CardDescription,{className:"text-blue-600 text-sm",children:"You are currently working with this business"})]}),(0,b.jsx)(o.CardContent,{className:"pt-0",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg md:text-xl text-blue-900",children:v.name}),(0,b.jsxs)("p",{className:"text-sm text-blue-600",children:["Created: ",new Date(v.created_at).toLocaleDateString()]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[v.is_default&&(0,b.jsx)(p.Badge,{variant:"secondary",className:"bg-blue-100 text-blue-700 text-xs",children:"Default"}),(0,b.jsx)(p.Badge,{className:"bg-green-500 text-white text-xs",children:"Active"})]})]})})]}),(0,b.jsxs)(o.Card,{className:"shadow-sm",children:[(0,b.jsxs)(o.CardHeader,{className:"pb-4",children:[(0,b.jsx)(o.CardTitle,{className:"text-lg md:text-xl",children:"All Businesses"}),(0,b.jsx)(o.CardDescription,{className:"text-sm",children:"Manage your business locations. You can switch between them, edit their names, reset them, or delete them."})]}),(0,b.jsx)(o.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:0===a.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"p-4 bg-gray-100 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:(0,b.jsx)(e.Building2,{className:"h-10 w-10 text-gray-400"})}),(0,b.jsx)("p",{className:"text-gray-600 font-medium",children:"No businesses found"}),(0,b.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Create your first business to get started"})]}):a.map(a=>(0,b.jsx)("div",{className:`p-4 border rounded-xl transition-all ${v?.id===a.id?"border-blue-300 bg-blue-50/50 shadow-sm":"border-gray-200 bg-white hover:bg-gray-50"}`,children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,b.jsx)("div",{className:`p-2 rounded-lg ${v?.id===a.id?"bg-blue-200":"bg-gray-100"}`,children:(0,b.jsx)(e.Building2,{className:"h-5 w-5 text-gray-600"})}),(0,b.jsx)("div",{className:"flex-1 min-w-0",children:$===a.id?(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:`edit-${a.id}`,className:"text-sm font-medium",children:"Business Name"}),(0,b.jsx)(q.Input,{id:`edit-${a.id}`,value:aa,onChange:a=>ab(a.target.value),className:"h-9",onKeyDown:a=>{"Enter"===a.key&&aq(),"Escape"===a.key&&ar()},autoFocus:!0})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[(0,b.jsx)("h4",{className:"font-semibold text-gray-900 text-base",children:a.name}),a.switch_password_hash&&(0,b.jsx)(l.Lock,{className:"h-4 w-4 text-amber-500"}),a.is_default&&(0,b.jsx)(p.Badge,{variant:"outline",className:"text-xs",children:"Default"}),v?.id===a.id&&(0,b.jsx)(p.Badge,{className:"text-xs bg-green-500 text-white",children:"Current"})]}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:["Created: ",new Date(a.created_at).toLocaleDateString(),a.switch_password_hash&&(0,b.jsx)("span",{className:"text-amber-600 ml-2",children:"â€¢ Password Protected"})]})]})})]}),(0,b.jsx)("div",{className:"flex items-center gap-2 md:flex-shrink-0",children:$===a.id?(0,b.jsxs)("div",{className:"flex gap-2 w-full md:w-auto",children:[(0,b.jsxs)(n.Button,{size:"sm",onClick:aq,className:"flex-1 md:flex-none",children:[(0,b.jsx)(h.Check,{className:"h-4 w-4 md:mr-1"}),(0,b.jsx)("span",{className:"md:inline",children:"Save"})]}),(0,b.jsx)(n.Button,{size:"sm",variant:"outline",onClick:ar,className:"flex-1 md:flex-none",children:"Cancel"})]}):(0,b.jsxs)("div",{className:"flex gap-2 w-full md:w-auto",children:[v?.id!==a.id&&(0,b.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>{y(a.id,(a,b,c)=>{an({businessId:a,businessName:b,onVerified:c}),aj(!0)})},className:"flex-1 md:flex-none text-sm",disabled:ag,children:"Switch To"}),R&&(0,b.jsx)(n.Button,{size:"sm",variant:"ghost",onClick:()=>{var b,c;return b=a.id,c=a.name,void(_(b),ab(c))},className:"p-2",disabled:ag,children:(0,b.jsx)(g.Pencil,{className:"h-4 w-4"})}),R&&(0,b.jsx)(n.Button,{size:"sm",variant:"ghost",onClick:()=>{ap(a.id),al(!0)},className:"p-2 text-purple-600 hover:text-purple-700 hover:bg-purple-50",title:a.switch_password_hash?"Manage Password":"Set Password",disabled:ag,children:(0,b.jsx)(m.Shield,{className:"h-4 w-4"})}),R&&(0,b.jsx)(n.Button,{size:"sm",variant:"ghost",onClick:()=>af(a.id),className:"p-2 text-amber-600 hover:text-amber-700 hover:bg-amber-50",disabled:ag,children:(0,b.jsx)(i.RotateCcw,{className:"h-4 w-4"})}),!a.is_default&&R&&(0,b.jsx)(n.Button,{size:"sm",variant:"ghost",onClick:()=>ad(a.id),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50",disabled:ag,children:(0,b.jsx)(f.Trash2,{className:"h-4 w-4"})})]})})]})},a.id))})})]})]}),(0,b.jsx)(w,{open:S,onOpenChange:T}),(0,b.jsx)(E,{open:W,onOpenChange:X}),(0,b.jsx)(H,{open:Y,onOpenChange:Z}),(0,b.jsx)(x,{open:!!ae,onOpenChange:()=>af(null),onConfirm:at,businessName:au()}),(0,b.jsx)(I.BusinessPasswordDialog,{open:ai,onOpenChange:aj,businessName:am?.businessName||"",onPasswordVerified:()=>{am&&(am.onVerified(),D({title:"Business Switched",description:"You are now working with the selected business"}))},onVerifyPassword:async a=>!!am&&await J(am.businessId,a)}),ao&&(0,b.jsx)(M,{open:ak,onOpenChange:al,businessId:ao,businessName:a.find(a=>a.id===ao)?.name||"",hasPassword:!!a.find(a=>a.id===ao)?.switch_password_hash,onPasswordSet:(b,c)=>{a.map(a=>a.id===b?{...a,switch_password_hash:c?"has_password":void 0}:a)},onSetPassword:G,onRemovePassword:async(a,b)=>!!await J(a,b)&&await K(a)}),(0,b.jsx)(s.AlertDialog,{open:!!ac,onOpenChange:()=>ad(null),children:(0,b.jsxs)(s.AlertDialogContent,{className:"mx-4 max-w-md",children:[(0,b.jsxs)(s.AlertDialogHeader,{children:[(0,b.jsx)(s.AlertDialogTitle,{children:"Delete Business"}),(0,b.jsx)(s.AlertDialogDescription,{className:"text-sm",children:"Are you sure you want to delete this business? This action cannot be undone and will permanently delete all associated data including products, sales, customers, and expenses."})]}),(0,b.jsxs)(s.AlertDialogFooter,{className:"flex-col-reverse md:flex-row gap-2",children:[(0,b.jsx)(s.AlertDialogCancel,{className:"w-full md:w-auto",children:"Cancel"}),(0,b.jsx)(s.AlertDialogAction,{onClick:as,className:"w-full md:w-auto bg-red-600 hover:bg-red-700",children:"Delete"})]})]})}),(0,b.jsx)(s.AlertDialog,{open:U,onOpenChange:V,children:(0,b.jsxs)(s.AlertDialogContent,{className:"mx-4 max-w-md",children:[(0,b.jsxs)(s.AlertDialogHeader,{children:[(0,b.jsxs)(s.AlertDialogTitle,{className:"flex items-center gap-2 text-amber-600",children:[(0,b.jsx)(m.Shield,{className:"h-5 w-5"}),"Location Limit Reached"]}),(0,b.jsx)(s.AlertDialogDescription,{className:"text-sm pt-2",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("p",{className:"font-medium text-foreground",children:["You have reached the maximum allowed limit of ",(0,b.jsxs)("span",{className:"font-bold text-amber-600",children:[C," locations"]}),"."]}),(0,b.jsxs)("div",{className:"bg-muted/50 p-4 rounded-lg border border-border/50 text-sm space-y-2",children:[(0,b.jsx)("p",{children:"To add more locations, please contact Admin support:"}),(0,b.jsx)("a",{href:"tel:+256758519696",className:"block text-primary font-bold text-lg hover:underline",children:"+256 758519696"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground italic",children:"Note: Additional charges may apply for increasing your location limit."})]})]})})]}),(0,b.jsx)(s.AlertDialogFooter,{children:(0,b.jsx)(s.AlertDialogCancel,{className:"w-full",children:"Close"})})]})})]})}],542715)}];

//# sourceMappingURL=src_app_business-management_page_tsx_1fbefa40._.js.map