module.exports=[112779,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(799856),g=b([f]);[f]=g.then?(await g)():g;let h=e.forwardRef(({className:a,type:b,...c},e)=>(0,d.jsx)("input",{type:b,className:(0,f.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","number"===b&&"[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",a),onWheel:"number"===b?a=>{"number"===b&&a.currentTarget.blur()}:void 0,ref:e,...c}));h.displayName="Input",a.s(["Input",()=>h]),c()}catch(a){c(a)}},!1),463021,(a,b,c)=>{b.exports=a.x("@prisma/client-2c3a283f134fdcb6",()=>require("@prisma/client-2c3a283f134fdcb6"))},723862,a=>a.a(async(b,c)=>{try{let b=await a.y("pg-587764f78a6c7a9c");a.n(b),c()}catch(a){c(a)}},!0),169320,a=>a.a(async(b,c)=>{try{let b=await a.y("sonner-9908e9c26092bf41");a.n(b),c()}catch(a){c(a)}},!0),575210,a=>a.a(async(b,c)=>{try{let b=await a.y("@prisma/adapter-pg-994324666b79ccf3");a.n(b),c()}catch(a){c(a)}},!0),982230,(a,b,c)=>{b.exports=a.x("dotenv-653b48b2e300834e/config",()=>require("dotenv-653b48b2e300834e/config"))},150848,a=>a.a(async(b,c)=>{try{var d=a.i(463021),e=a.i(723862),f=a.i(575210);a.i(982230);var g=b([e,f]);[e,f]=g.then?(await g)():g;let h=process.env.DATABASE_URL,i=new e.Pool({connectionString:h}),j=new f.PrismaPg(i),k=a.g,l=k.prisma&&(!("branch"in k.prisma)||!("productHistory"in k.prisma)),m=k.prisma&&!l?k.prisma:new d.PrismaClient({adapter:j,log:["error","warn"]});a.s(["db",0,m]),c()}catch(a){c(a)}},!1),644950,a=>a.a(async(b,c)=>{try{let b=await a.y("bcryptjs-ee66c2bdc904f2cf");a.n(b),c()}catch(a){c(a)}},!0),913143,a=>a.a(async(b,c)=>{try{var d=a.i(150848),e=a.i(644950),f=b([d,e]);async function g(a){try{let{email:b,password:c,name:f}=a;if(await d.db.user.findUnique({where:{email:b}}))return{success:!1,error:"User already exists"};let g=await (0,e.hash)(c,10),h=await d.db.role.findFirst({where:{name:"Admin"}});h||(h=await d.db.role.create({data:{name:"Admin",description:"Default Admin Role"}}));let i=await d.db.user.create({data:{email:b,password:g,name:f,roleId:h.id}});return{success:!0,user:{id:i.id,email:i.email}}}catch(a){return console.error("Error in signUpAction:",a),{success:!1,error:a.message||"Failed to sign up"}}}async function h(a,b){try{let c=await d.db.user.findUnique({where:{email:a},include:{role:!0}});if(!c||!c.password||!await (0,e.compare)(b,c.password))return{success:!1,error:"Invalid email or password"};return{success:!0,user:{id:c.id,email:c.email,name:c.name,role:c.role?.name}}}catch(a){return console.error("Error in signInAction:",a),{success:!1,error:a.message||"Failed to sign in"}}}[d,e]=f.then?(await f)():f,a.s(["signInAction",()=>h,"signUpAction",()=>g]),c()}catch(a){c(a)}},!1),531811,a=>a.a(async(b,c)=>{try{a.i(508171);var d=a.i(127669),e=a.i(169320),f=a.i(913143),g=b([e,f]);[e,f]=g.then?(await g)():g;let h=(0,d.createContext)(void 0);a.s(["useAuth",0,()=>{let a=(0,d.useContext)(h);if(void 0===a)throw Error("useAuth must be used within an AuthProvider");return a}]),c()}catch(a){c(a)}},!1),108191,a=>{"use strict";var b=a.i(127669);let c=0,d=new Map,e=a=>{if(d.has(a))return;let b=setTimeout(()=>{d.delete(a),h({type:"REMOVE_TOAST",toastId:a})},1e6);d.set(a,b)},f=[],g={toasts:[]};function h(a){g=((a,b)=>{switch(b.type){case"ADD_TOAST":return{...a,toasts:[b.toast,...a.toasts].slice(0,1)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(a=>a.id===b.toast.id?{...a,...b.toast}:a)};case"DISMISS_TOAST":{let{toastId:c}=b;return c?e(c):a.toasts.forEach(a=>{e(a.id)}),{...a,toasts:a.toasts.map(a=>a.id===c||void 0===c?{...a,open:!1}:a)}}case"REMOVE_TOAST":if(void 0===b.toastId)return{...a,toasts:[]};return{...a,toasts:a.toasts.filter(a=>a.id!==b.toastId)}}})(g,a),f.forEach(a=>{a(g)})}function i({...a}){let b=(c=(c+1)%Number.MAX_SAFE_INTEGER).toString(),d=()=>h({type:"DISMISS_TOAST",toastId:b});return h({type:"ADD_TOAST",toast:{...a,id:b,open:!0,onOpenChange:a=>{a||d()}}}),{id:b,dismiss:d,update:a=>h({type:"UPDATE_TOAST",toast:{...a,id:b}})}}function j(){let[a,c]=b.useState(g);return b.useEffect(()=>(f.push(c),()=>{let a=f.indexOf(c);a>-1&&f.splice(a,1)}),[a]),{...a,toast:i,dismiss:a=>h({type:"DISMISS_TOAST",toastId:a})}}a.s(["toast",()=>i,"useToast",()=>j])},204618,a=>a.a(async(b,c)=>{try{var d=a.i(150848),e=a.i(644950),f=b([d,e]);async function g(a){try{return(await d.db.branch.findMany({where:{adminId:a},orderBy:[{createdAt:"desc"},{name:"asc"}]})).map((a,b)=>({id:a.id,name:a.name,user_id:a.adminId,is_default:0===b,created_at:a.createdAt.toISOString(),updated_at:a.updatedAt.toISOString(),switch_password_hash:a.accessPassword}))}catch(a){return console.error("Error fetching business locations:",a),[]}}async function h(a,b){try{let c=await d.db.branch.create({data:{name:b,location:"Main Location",adminId:a}});return{success:!0,data:{id:c.id,name:c.name,user_id:c.adminId,is_default:!1,created_at:c.createdAt.toISOString(),updated_at:c.updatedAt.toISOString(),switch_password_hash:c.accessPassword}}}catch(a){return console.error("Error creating business:",a),{success:!1,error:"Failed to create business"}}}async function i(a,b,c){try{let e=await d.db.branch.update({where:{id:a,adminId:b},data:{name:c}});return{success:!0,data:{id:e.id,name:e.name,user_id:e.adminId,is_default:!1,created_at:e.createdAt.toISOString(),updated_at:e.updatedAt.toISOString(),switch_password_hash:e.accessPassword}}}catch(a){return console.error("Error updating business:",a),{success:!1,error:"Failed to update business"}}}async function j(a,b){try{return await d.db.branch.delete({where:{id:a,adminId:b}}),{success:!0}}catch(a){return console.error("Error deleting business:",a),{success:!1,error:"Failed to delete business"}}}async function k(a,b){try{return await d.db.$transaction(async b=>{await b.productHistory.deleteMany({where:{locationId:a}}),await b.sale.deleteMany({where:{branchId:a}}),await b.product.deleteMany({where:{branchId:a}}),await b.customer.deleteMany({where:{branchId:a}}),await b.activityHistory.deleteMany({where:{branchId:a}})}),{success:!0}}catch(a){return console.error("Error resetting business:",a),{success:!1,error:a.message}}}async function l(a,b){try{let c=await e.default.hash(b,10);return await d.db.branch.update({where:{id:a},data:{accessPassword:c}}),{success:!0}}catch(a){return console.error("Error setting business password:",a),{success:!1,error:a.message}}}async function m(a,b){try{let c=await d.db.branch.findUnique({where:{id:a},select:{accessPassword:!0}});if(!c?.accessPassword)return{success:!0,verified:!0};let f=await e.default.compare(b,c.accessPassword);return{success:!0,verified:f}}catch(a){return console.error("Error verifying business password:",a),{success:!1,verified:!1,error:a.message}}}async function n(a){try{return await d.db.branch.update({where:{id:a},data:{accessPassword:null}}),{success:!0}}catch(a){return console.error("Error removing business password:",a),{success:!1,error:a.message}}}[d,e]=f.then?(await f)():f,a.s(["createBusinessAction",()=>h,"deleteBusinessAction",()=>j,"getBusinessLocationsAction",()=>g,"removeBusinessPasswordAction",()=>n,"resetBusinessAction",()=>k,"setBusinessPasswordAction",()=>l,"updateBusinessAction",()=>i,"verifyBusinessPasswordAction",()=>m]),c()}catch(a){c(a)}},!1),332613,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(108191),f=a.i(204618),g=b([f]);[f]=g.then?(await g)():g,a.s(["useBusinessPassword",0,()=>{let[a,b]=(0,d.useState)(!1),{toast:c}=(0,e.useToast)(),g="verified_businesses",h=()=>{try{let a=sessionStorage.getItem(g);return a?new Set(JSON.parse(a)):new Set}catch{return new Set}},i=a=>{try{let b=h();b.add(a),sessionStorage.setItem(g,JSON.stringify(Array.from(b)))}catch(a){console.error("Error storing verified business:",a)}},j=async(a,d)=>{b(!0);try{let b=await (0,f.setBusinessPasswordAction)(a,d);if(b.success)return c({title:"Password Set Successfully",description:"Your business is now password protected."}),!0;return c({title:"Failed to Set Password",description:b.error||"Please try again later.",variant:"destructive"}),!1}catch(a){return console.error("Error setting business password:",a),c({title:"Failed to Set Password",description:"An unexpected error occurred.",variant:"destructive"}),!1}finally{b(!1)}},k=async(a,d)=>{b(!0);try{let b=await (0,f.verifyBusinessPasswordAction)(a,d);if(b.success&&b.verified)return i(a),!0;return c({title:"Incorrect Password",description:"The password you entered is incorrect.",variant:"destructive"}),!1}catch(a){return console.error("Error verifying business password:",a),c({title:"Verification Error",description:"An unexpected error occurred.",variant:"destructive"}),!1}finally{b(!1)}},l=async a=>{b(!0);try{let b=await (0,f.removeBusinessPasswordAction)(a);if(!b.success)return c({title:"Failed to Remove Password",description:b.error||"Please try again later.",variant:"destructive"}),!1;{let b=h();return b.delete(a),sessionStorage.setItem(g,JSON.stringify(Array.from(b))),!0}}catch(a){return console.error("Error removing business password:",a),c({title:"Failed to Remove Password",description:"Please try again later.",variant:"destructive"}),!1}finally{b(!1)}};return{isLoading:a,setBusinessPassword:j,verifyBusinessPassword:k,removeBusinessPassword:l,isBusinessVerified:a=>h().has(a),setBusinessVerified:i,clearVerifiedBusinesses:()=>{try{sessionStorage.removeItem(g)}catch(a){console.error("Error clearing verified businesses:",a)}}}}]),c()}catch(a){c(a)}},!1),964889,a=>a.a(async(b,c)=>{try{a.i(508171);var d=a.i(127669),e=a.i(531811),f=a.i(332613);a.i(108191);var g=a.i(204618),h=b([e,f,g]);[e,f,g]=h.then?(await h)():h;let i=(0,d.createContext)(void 0);a.s(["useBusiness",0,()=>{let a=(0,d.useContext)(i);if(void 0===a)throw Error("useBusiness must be used within a BusinessProvider");return a}]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__9c058bb7._.js.map