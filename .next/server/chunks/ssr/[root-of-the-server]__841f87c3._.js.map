{"version":3,"sources":["../../../../node_modules/lucide-react/src/icons/clock.ts","../../../../node_modules/lucide-react/src/icons/package.ts","../../../../node_modules/lucide-react/src/icons/arrow-left.ts","../../../../src/components/ui/switch.tsx","../../../../node_modules/lucide-react/src/icons/printer.ts","../../../../src/utils/inventoryCacheUtils.ts","../../../../src/hooks/useProducts.ts","../../../../node_modules/lucide-react/src/icons/refresh-cw.ts","../../../../node_modules/lucide-react/src/icons/triangle-alert.ts","../../../../src/hooks/useStockHistory.ts","../../../../src/app/actions/inventory.ts","../../../../src/hooks/useStockSummaryData.ts","../../../../src/utils/exportBarcodeToPDF.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Clock\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cG9seWxpbmUgcG9pbnRzPSIxMiA2IDEyIDEyIDE2IDE0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/clock\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Clock = createLucideIcon('Clock', [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['polyline', { points: '12 6 12 12 16 14', key: '68esgv' }],\n]);\n\nexport default Clock;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Package\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTEgMjEuNzNhMiAyIDAgMCAwIDIgMGw3LTRBMiAyIDAgMCAwIDIxIDE2VjhhMiAyIDAgMCAwLTEtMS43M2wtNy00YTIgMiAwIDAgMC0yIDBsLTcgNEEyIDIgMCAwIDAgMyA4djhhMiAyIDAgMCAwIDEgMS43M3oiIC8+CiAgPHBhdGggZD0iTTEyIDIyVjEyIiAvPgogIDxwYXRoIGQ9Im0zLjMgNyA3LjcwMyA0LjczNGEyIDIgMCAwIDAgMS45OTQgMEwyMC43IDciIC8+CiAgPHBhdGggZD0ibTcuNSA0LjI3IDkgNS4xNSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/package\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Package = createLucideIcon('Package', [\n  [\n    'path',\n    {\n      d: 'M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z',\n      key: '1a0edw',\n    },\n  ],\n  ['path', { d: 'M12 22V12', key: 'd0xqtd' }],\n  ['path', { d: 'm3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7', key: 'yx3hmr' }],\n  ['path', { d: 'm7.5 4.27 9 5.15', key: '1c824w' }],\n]);\n\nexport default Package;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('ArrowLeft', [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n]);\n\nexport default ArrowLeft;\n","import * as React from \"react\"\r\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Switch = React.forwardRef<\r\n  React.ElementRef<typeof SwitchPrimitives.Root>,\r\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\r\n>(({ className, ...props }, ref) => (\r\n  <SwitchPrimitives.Root\r\n    className={cn(\r\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\r\n      className\r\n    )}\r\n    {...props}\r\n    ref={ref}\r\n  >\r\n    <SwitchPrimitives.Thumb\r\n      className={cn(\r\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\r\n      )}\r\n    />\r\n  </SwitchPrimitives.Root>\r\n))\r\nSwitch.displayName = SwitchPrimitives.Root.displayName\r\n\r\nexport { Switch }\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Printer\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNiAxOEg0YTIgMiAwIDAgMS0yLTJ2LTVhMiAyIDAgMCAxIDItMmgxNmEyIDIgMCAwIDEgMiAydjVhMiAyIDAgMCAxLTIgMmgtMiIgLz4KICA8cGF0aCBkPSJNNiA5VjNhMSAxIDAgMCAxIDEtMWgxMGExIDEgMCAwIDEgMSAxdjYiIC8+CiAgPHJlY3QgeD0iNiIgeT0iMTQiIHdpZHRoPSIxMiIgaGVpZ2h0PSI4IiByeD0iMSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/printer\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Printer = createLucideIcon('Printer', [\n  [\n    'path',\n    {\n      d: 'M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2',\n      key: '143wyd',\n    },\n  ],\n  ['path', { d: 'M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6', key: '1itne7' }],\n  ['rect', { x: '6', y: '14', width: '12', height: '8', rx: '1', key: '1ue0tg' }],\n]);\n\nexport default Printer;\n","import { QueryClient } from \"@tanstack/react-query\";\r\n\r\n/**\r\n * Utility to clear inventory-related caches (both localStorage and React Query)\r\n * to ensure real-time data accuracy.\r\n */\r\nexport const clearInventoryCaches = (queryClient?: QueryClient) => {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    // 1. Clear LocalStorage (Legacy / Manual caches)\r\n    const keys = Object.keys(localStorage);\r\n    const patterns = [\r\n        'allProductsStats_',\r\n        'stockSummary_',\r\n        'soldItems_',\r\n        'dashboardData_',\r\n        'analyticsData_'\r\n    ];\r\n\r\n    let clearedCount = 0;\r\n    keys.forEach(key => {\r\n        if (patterns.some(pattern => key.startsWith(pattern))) {\r\n            localStorage.removeItem(key);\r\n            clearedCount++;\r\n        }\r\n    });\r\n\r\n    if (clearedCount > 0) {\r\n        console.log(`[Cache] Cleared ${clearedCount} inventory-related localStorage entries.`);\r\n    }\r\n\r\n    // 2. Invalidate React Query Keys (Modern State)\r\n    if (queryClient) {\r\n        console.log('[Cache] Invalidating React Query inventory keys...');\r\n        // Invalidate specific keys used in the inventory module\r\n        queryClient.invalidateQueries({ queryKey: ['inventory_global_stats'] });\r\n        queryClient.invalidateQueries({ queryKey: ['stockSummary'] });\r\n        queryClient.invalidateQueries({ queryKey: ['products'] });\r\n        queryClient.invalidateQueries({ queryKey: ['sales'] });\r\n        queryClient.invalidateQueries({ queryKey: ['all-products-for-scanner'] });\r\n        queryClient.invalidateQueries({ queryKey: ['all-products'] });\r\n    }\r\n};\r\n","import { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { Product, ProductFormData, ProductFilters } from '@/types';\r\nimport { useBusinessSettings } from './useBusinessSettings';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport { clearInventoryCaches } from '@/utils/inventoryCacheUtils';\r\n\r\n// Import our new Server Actions\r\nimport {\r\n  getProductsAction,\r\n  createProductAction,\r\n  updateProductAction,\r\n  deleteProductAction,\r\n  updateProductsBulkAction\r\n} from '@/app/actions/products';\r\n\r\nexport const useProducts = (userId: string | undefined, initialPageSize: number = 50) => {\r\n  const [products, setProducts] = useState<Product[]>([]);\r\n  const [page, setPage] = useState(1);\r\n  const [pageSize, setPageSize] = useState(initialPageSize);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const { settings } = useBusinessSettings();\r\n  const { currentBusiness } = useBusiness();\r\n  const queryClient = useQueryClient();\r\n\r\n  const [filters, setFilters] = useState<ProductFilters>({\r\n    search: '',\r\n    category: 'all',\r\n    stockStatus: 'all'\r\n  });\r\n\r\n  const [typingTimer, setTypingTimer] = useState<NodeJS.Timeout | null>(null);\r\n\r\n  const setFiltersWithTypingState = useCallback((newFilters: ProductFilters) => {\r\n    if (newFilters.search !== filters.search) {\r\n      setIsTyping(true);\r\n      if (typingTimer) clearTimeout(typingTimer);\r\n      const timer = setTimeout(() => {\r\n        setIsTyping(false);\r\n      }, 600);\r\n      setTypingTimer(timer);\r\n    }\r\n    setFilters(newFilters);\r\n  }, [filters.search, typingTimer]);\r\n\r\n  // Use Server Action instead of Supabase\r\n  const loadProducts = useCallback(async (): Promise<{ products: Product[], count: number }> => {\r\n    if (!userId || !currentBusiness) {\r\n      return { products: [], count: 0 };\r\n    }\r\n\r\n    try {\r\n      // Server Action call\r\n      const result = await getProductsAction({\r\n        userId,\r\n        businessId: currentBusiness.id,\r\n        page,\r\n        pageSize,\r\n        search: filters.search,\r\n        category: filters.category === 'all' ? undefined : filters.category,\r\n        stockStatus: filters.stockStatus,\r\n      });\r\n      return result as { products: Product[], count: number };\r\n    } catch (error) {\r\n      console.error('Error loading products from server action:', error);\r\n      return { products: [], count: 0 };\r\n    }\r\n  }, [userId, currentBusiness?.id, page, pageSize, filters.search, filters.category, filters.stockStatus]);\r\n\r\n  const baseQueryKey = useMemo(() => ['products', userId, currentBusiness?.id], [userId, currentBusiness?.id]);\r\n  const queryKey = useMemo(() => [...baseQueryKey, page, pageSize, filters.search, filters.category, filters.stockStatus], [baseQueryKey, page, pageSize, filters.search, filters.category, filters.stockStatus]);\r\n\r\n  const { data: queriedData, isLoading: isQueryLoading, isFetching, refetch } = useQuery({\r\n    queryKey,\r\n    queryFn: loadProducts,\r\n    enabled: !!userId && !!currentBusiness?.id,\r\n    staleTime: 30_000,\r\n    gcTime: 30 * 60_000,\r\n    refetchOnWindowFocus: true,\r\n    refetchOnReconnect: true,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (queriedData) {\r\n      setProducts(queriedData.products);\r\n      setTotalCount(queriedData.count);\r\n    }\r\n  }, [queriedData]);\r\n\r\n  const isLoading = (isQueryLoading && !queriedData) && !isTyping;\r\n\r\n  // Supabase Storage remains untouched since Prisma doesn't do file storage\r\n  // but we isolate it here.\r\n  const uploadProductImage = async (imageFile: File): Promise<string | null> => {\r\n    try {\r\n      if (!userId) return null;\r\n\r\n      // We will implement a server action for this. \r\n      // For now, let's assume we have an uploadImageAction.\r\n      // const formData = new FormData();\r\n      // formData.append('file', imageFile);\r\n      // formData.append('userId', userId);\r\n      // const result = await uploadImageAction(formData);\r\n      // return result.url;\r\n\r\n      console.warn('Image upload redirecting to server action (TODO)');\r\n      return null;\r\n    } catch (error) {\r\n      console.error('Error in uploadProductImage:', error);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const createProduct = async (productData: ProductFormData): Promise<Product | null> => {\r\n    try {\r\n      if (!userId || !currentBusiness) return null;\r\n\r\n      const result = await createProductAction({\r\n        ...productData,\r\n        userId,\r\n        businessId: currentBusiness.id\r\n      });\r\n\r\n      if (!result) return null;\r\n\r\n      const newProduct = result as Product;\r\n\r\n      setProducts(prev => [newProduct, ...prev]);\r\n      setTotalCount(c => c + 1);\r\n\r\n      queryClient.invalidateQueries({ queryKey: baseQueryKey });\r\n      clearInventoryCaches(queryClient);\r\n\r\n      return newProduct;\r\n    } catch (error) {\r\n      console.error('Error creating product:', error);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const updateProduct = async (\r\n    id: string,\r\n    updates: Partial<Product>,\r\n    imageFile?: File | null,\r\n    isFromSale = false,\r\n    customChangeReason?: string,\r\n    adjustmentDate?: Date,\r\n    referenceId?: string,\r\n    receiptNumber?: string\r\n  ): Promise<boolean> => {\r\n    try {\r\n      if (!userId || !currentBusiness) return false;\r\n\r\n      let imageUrl = updates.imageUrl;\r\n      if (imageFile) {\r\n        imageUrl = await uploadProductImage(imageFile);\r\n      }\r\n\r\n      const result = await updateProductAction(id, {\r\n        ...updates,\r\n        imageUrl,\r\n        userId,\r\n        businessId: currentBusiness.id,\r\n        isFromSale,\r\n        customChangeReason,\r\n        referenceId\r\n      });\r\n\r\n      if (!result) return false;\r\n\r\n      queryClient.invalidateQueries({ queryKey: baseQueryKey });\r\n      clearInventoryCaches(queryClient);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error updating product:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const deleteProduct = async (id: string): Promise<boolean> => {\r\n    try {\r\n      if (!userId) return false;\r\n\r\n      const success = await deleteProductAction(id);\r\n\r\n      if (success) {\r\n        queryClient.invalidateQueries({ queryKey: baseQueryKey });\r\n        clearInventoryCaches(queryClient);\r\n        return true;\r\n      }\r\n      return false;\r\n    } catch (error) {\r\n      console.error('Error deleting product:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const updateProductsBulk = async (\r\n    updates: Array<{ id: string; updated: Partial<Product>; imageFile?: File | null }>,\r\n    userIdForHistory?: string,\r\n    changeReason?: string,\r\n    referenceId?: string,\r\n    adjustmentDate?: Date,\r\n    receiptNumber?: string\r\n  ): Promise<boolean> => {\r\n    try {\r\n      if (!userId || !currentBusiness) return false;\r\n\r\n      const success = await updateProductsBulkAction(\r\n        updates.map(u => ({ id: u.id, updated: u.updated })),\r\n        currentBusiness.id\r\n      );\r\n\r\n      if (success) {\r\n        queryClient.invalidateQueries({ queryKey: baseQueryKey });\r\n        clearInventoryCaches(queryClient);\r\n      }\r\n\r\n      return success;\r\n    } catch (error) {\r\n      console.error('Error in bulk update:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  return {\r\n    products,\r\n    isLoading,\r\n    loadProducts,\r\n    page,\r\n    setPage,\r\n    pageSize,\r\n    setPageSize,\r\n    totalCount,\r\n    createProduct,\r\n    updateProduct,\r\n    updateProductsBulk,\r\n    deleteProduct,\r\n    uploadProductImage,\r\n    refetch,\r\n    isFetching,\r\n    filters,\r\n    setFilters: setFiltersWithTypingState,\r\n  };\r\n};\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name RefreshCw\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMyAxMmE5IDkgMCAwIDEgOS05IDkuNzUgOS43NSAwIDAgMSA2Ljc0IDIuNzRMMjEgOCIgLz4KICA8cGF0aCBkPSJNMjEgM3Y1aC01IiAvPgogIDxwYXRoIGQ9Ik0yMSAxMmE5IDkgMCAwIDEtOSA5IDkuNzUgOS43NSAwIDAgMS02Ljc0LTIuNzRMMyAxNiIgLz4KICA8cGF0aCBkPSJNOCAxNkgzdjUiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/refresh-cw\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst RefreshCw = createLucideIcon('RefreshCw', [\n  ['path', { d: 'M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8', key: 'v9h5vc' }],\n  ['path', { d: 'M21 3v5h-5', key: '1q7to0' }],\n  ['path', { d: 'M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16', key: '3uifl3' }],\n  ['path', { d: 'M8 16H3v5', key: '1cv678' }],\n]);\n\nexport default RefreshCw;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name TriangleAlert\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMjEuNzMgMTgtOC0xNGEyIDIgMCAwIDAtMy40OCAwbC04IDE0QTIgMiAwIDAgMCA0IDIxaDE2YTIgMiAwIDAgMCAxLjczLTMiIC8+CiAgPHBhdGggZD0iTTEyIDl2NCIgLz4KICA8cGF0aCBkPSJNMTIgMTdoLjAxIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/triangle-alert\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst TriangleAlert = createLucideIcon('TriangleAlert', [\n  [\n    'path',\n    {\n      d: 'm21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3',\n      key: 'wmoenq',\n    },\n  ],\n  ['path', { d: 'M12 9v4', key: 'juzpu7' }],\n  ['path', { d: 'M12 17h.01', key: 'p32p05' }],\n]);\n\nexport default TriangleAlert;\n","\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { StockHistoryEntry } from '@/types';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport {\r\n  getStockHistoryAction,\r\n  createStockHistoryAction,\r\n  recalculateStockChainAction,\r\n  deleteStockHistoryEntriesByReferenceAction,\r\n  updateStockHistoryDatesByReferenceAction,\r\n  repairStockChainsAction,\r\n  getStockRepairsPreviewAction\r\n} from '@/app/actions/inventory';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\n\r\nexport interface ChainRepairBreakEntry {\r\n  entryId: string;\r\n  createdAt: string;\r\n  changeReason: string;\r\n  currentPrevQty: number;\r\n  currentNewQty: number;\r\n  fixedPrevQty: number;\r\n  fixedNewQty: number;\r\n}\r\n\r\nexport interface ChainRepairPreview {\r\n  productId: string;\r\n  productName: string;\r\n  totalEntries: number;\r\n  brokenEntries: ChainRepairBreakEntry[];\r\n  finalFixedQty: number;\r\n  currentProductQty: number;\r\n}\r\n\r\nexport const useStockHistory = (userId: string | undefined, productId?: string) => {\r\n  const [stockHistory, setStockHistory] = useState<StockHistoryEntry[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const { currentBusiness } = useBusiness();\r\n\r\n  const loadStockHistory = useCallback(async () => {\r\n    if (!userId || !currentBusiness) {\r\n      setStockHistory([]);\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true);\r\n      const result = await getStockHistoryAction(currentBusiness.id, productId);\r\n\r\n      if (!result.success || !result.data) {\r\n        throw new Error(result.error || 'Failed to fetch stock history');\r\n      }\r\n\r\n      const formattedHistory: StockHistoryEntry[] = result.data.map((entry: any) => ({\r\n        id: entry.id,\r\n        productId: entry.productId,\r\n        oldQuantity: entry.oldQuantity,\r\n        newQuantity: entry.newQuantity,\r\n        changeReason: entry.changeReason,\r\n        createdAt: new Date(entry.createdAt),\r\n        referenceId: entry.referenceId,\r\n        receiptNumber: entry.receiptNumber,\r\n        product: entry.product\r\n      }));\r\n\r\n      setStockHistory(formattedHistory);\r\n    } catch (error) {\r\n      console.error('Error loading stock history:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [userId, currentBusiness?.id, productId]);\r\n\r\n  useEffect(() => {\r\n    loadStockHistory();\r\n  }, [loadStockHistory]);\r\n\r\n  const createStockHistoryEntry = async (\r\n    targetProductId: string,\r\n    previousQuantity: number,\r\n    newQuantity: number,\r\n    reason: string,\r\n    referenceId?: string,\r\n    entryDate?: Date,\r\n    receiptNumber?: string,\r\n    productName?: string\r\n  ) => {\r\n    try {\r\n      if (!userId || !currentBusiness) return false;\r\n\r\n      const snapshottedReason = productName\r\n        ? `[${productName}] | ${reason}`\r\n        : reason;\r\n\r\n      const result = await createStockHistoryAction({\r\n        userId,\r\n        locationId: currentBusiness.id,\r\n        productId: targetProductId,\r\n        previousQuantity,\r\n        newQuantity,\r\n        changeReason: snapshottedReason,\r\n        referenceId,\r\n        receiptNumber,\r\n        createdAt: entryDate?.toISOString()\r\n      });\r\n\r\n      if (!result.success) {\r\n        console.error('Error creating stock history entry:', result.error);\r\n        return false;\r\n      }\r\n\r\n      await loadStockHistory();\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error creating stock history:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const deleteMultipleStockHistoryEntriesByReference = async (referenceId: string) => {\r\n    try {\r\n      if (!currentBusiness) return false;\r\n      const result = await deleteStockHistoryEntriesByReferenceAction(referenceId, currentBusiness.id);\r\n      if (!result.success) throw new Error(result.error);\r\n\r\n      await loadStockHistory();\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error deleting stock history entries:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const recalculateStockChain = async (targetProductId: string) => {\r\n    try {\r\n      if (!currentBusiness) return false;\r\n      const result = await recalculateStockChainAction(targetProductId, currentBusiness.id);\r\n      if (!result.success) throw new Error(result.error);\r\n\r\n      await loadStockHistory();\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error recalculating stock chain:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const updateStockHistoryDatesBySaleId = async (saleId: string, newDate: Date) => {\r\n    try {\r\n      if (!currentBusiness) return false;\r\n      const result = await updateStockHistoryDatesByReferenceAction(saleId, currentBusiness.id, newDate.toISOString());\r\n      if (!result.success) throw new Error(result.error);\r\n\r\n      await loadStockHistory();\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error updating stock history dates:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const repairAllStockChains = async (progressCallback?: (current: number, total: number) => void) => {\r\n    try {\r\n      if (!currentBusiness) return { repaired: 0, failed: 0 };\r\n      const result = await repairStockChainsAction(currentBusiness.id);\r\n      if (result.success && result.data) return result.data;\r\n      return { repaired: 0, failed: 0 };\r\n    } catch (error) {\r\n      console.error('Error repairing all chains:', error);\r\n      return { repaired: 0, failed: 0 };\r\n    }\r\n  }\r\n\r\n  const previewStockChainRepairs = async (progressCallback?: (current: number, total: number) => void) => {\r\n    try {\r\n      if (!currentBusiness) return [];\r\n      const result = await getStockRepairsPreviewAction(currentBusiness.id);\r\n      if (result.success && result.data) return result.data;\r\n      return [];\r\n    } catch (error) {\r\n      console.error('Error previewing repairs:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  return {\r\n    stockHistory,\r\n    isLoading,\r\n    createStockHistoryEntry,\r\n    deleteMultipleStockHistoryEntriesByReference,\r\n    recalculateStockChain,\r\n    updateStockHistoryDatesBySaleId,\r\n    repairAllStockChains,\r\n    previewStockChainRepairs,\r\n    refreshHistory: loadStockHistory\r\n  };\r\n};\r\n","'use server';\r\n\r\nimport { db } from '../../../prisma/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// --- STOCK HISTORY ---\r\n\r\nexport async function getStockHistoryAction(locationId: string, productId?: string) {\r\n    try {\r\n        const where: any = { locationId };\r\n        if (productId) where.productId = productId;\r\n\r\n        const history = await db.productHistory.findMany({\r\n            where,\r\n            include: {\r\n                product: {\r\n                    select: {\r\n                        name: true,\r\n                        costPrice: true,\r\n                        sellingPrice: true,\r\n                        sku: true\r\n                    }\r\n                }\r\n            },\r\n            orderBy: [{ createdAt: 'desc' }, { id: 'desc' }]\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: history.map((h: any) => ({\r\n                id: h.id,\r\n                productId: h.productId,\r\n                oldQuantity: h.previousQuantity,\r\n                newQuantity: h.newQuantity,\r\n                changeReason: h.changeReason,\r\n                createdAt: h.createdAt.toISOString(),\r\n                referenceId: h.referenceId,\r\n                receiptNumber: h.receiptNumber,\r\n                product: h.product ? {\r\n                    name: h.product.name,\r\n                    costPrice: h.product.costPrice,\r\n                    sellingPrice: h.product.sellingPrice,\r\n                    itemNumber: h.product.sku\r\n                } : undefined\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching stock history:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createStockHistoryAction(data: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx: any) => {\r\n            const entry = await tx.productHistory.create({\r\n                data: {\r\n                    userId: data.userId,\r\n                    locationId: data.locationId,\r\n                    productId: data.productId,\r\n                    previousQuantity: data.previousQuantity,\r\n                    newQuantity: data.newQuantity,\r\n                    changeReason: data.changeReason,\r\n                    referenceId: data.referenceId || null,\r\n                    receiptNumber: data.receiptNumber || null,\r\n                    createdAt: data.createdAt ? new Date(data.createdAt) : undefined\r\n                }\r\n            });\r\n\r\n            // Update product stock as well\r\n            await tx.product.update({\r\n                where: { id: data.productId },\r\n                data: { stock: data.newQuantity }\r\n            });\r\n\r\n            return entry;\r\n        });\r\n\r\n        revalidatePath('/inventory');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating stock history:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function recalculateStockChainAction(productId: string, locationId: string) {\r\n    try {\r\n        const result = await db.$transaction(async (tx: any) => {\r\n            const history = await tx.productHistory.findMany({\r\n                where: { productId, locationId },\r\n                orderBy: [{ createdAt: 'asc' }, { id: 'asc' }]\r\n            });\r\n\r\n            if (history.length === 0) return { finalQuantity: 0 };\r\n\r\n            let runningQuantity = 0;\r\n            const updates = [];\r\n\r\n            for (const entry of history) {\r\n                const change = entry.newQuantity - entry.previousQuantity;\r\n                const newPrev = runningQuantity;\r\n                const newNext = newPrev + change;\r\n\r\n                if (entry.previousQuantity !== newPrev || entry.newQuantity !== newNext) {\r\n                    updates.push(tx.productHistory.update({\r\n                        where: { id: entry.id },\r\n                        data: { previousQuantity: newPrev, newQuantity: newNext }\r\n                    }));\r\n                }\r\n                runningQuantity = newNext;\r\n            }\r\n\r\n            if (updates.length > 0) {\r\n                await Promise.all(updates);\r\n            }\r\n\r\n            // Update product\r\n            await tx.product.update({\r\n                where: { id: productId },\r\n                data: { stock: runningQuantity }\r\n            });\r\n\r\n            return { finalQuantity: runningQuantity };\r\n        });\r\n\r\n        revalidatePath('/inventory');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error recalculating stock chain:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteStockHistoryEntriesByReferenceAction(referenceId: string, locationId: string) {\r\n    try {\r\n        const result = await db.$transaction(async (tx: any) => {\r\n            const entries = await tx.productHistory.findMany({\r\n                where: { referenceId, locationId },\r\n                select: { productId: true }\r\n            });\r\n\r\n            const productIds = [...new Set(entries.map((e: any) => e.productId as string))];\r\n\r\n            await tx.productHistory.deleteMany({\r\n                where: { referenceId, locationId }\r\n            });\r\n\r\n            // Recalculate chains for affected products\r\n            for (const productId of productIds) {\r\n                await recalculateStockChainInternal(tx, productId as string, locationId);\r\n            }\r\n\r\n            return { affectedProducts: productIds.length };\r\n        });\r\n\r\n        revalidatePath('/inventory');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error deleting stock history by reference:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function updateStockHistoryDatesByReferenceAction(referenceId: string, locationId: string, newDate: string) {\r\n    try {\r\n        const result = await db.productHistory.updateMany({\r\n            where: { referenceId, locationId },\r\n            data: { createdAt: new Date(newDate) }\r\n        });\r\n\r\n        revalidatePath('/inventory');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error updating stock history dates:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n// Internal helper for use within transactions\r\nasync function recalculateStockChainInternal(tx: any, productId: string, locationId: string) {\r\n    const history = await tx.productHistory.findMany({\r\n        where: { productId, locationId },\r\n        orderBy: [{ createdAt: 'asc' }, { id: 'asc' }]\r\n    });\r\n\r\n    let runningQuantity = 0;\r\n    for (const entry of history) {\r\n        const change = entry.newQuantity - entry.previousQuantity;\r\n        const newPrev = runningQuantity;\r\n        const newNext = newPrev + change;\r\n\r\n        if (entry.previousQuantity !== newPrev || entry.newQuantity !== newNext) {\r\n            await tx.productHistory.update({\r\n                where: { id: entry.id },\r\n                data: { previousQuantity: newPrev, newQuantity: newNext }\r\n            });\r\n        }\r\n        runningQuantity = newNext;\r\n    }\r\n\r\n    await tx.product.update({\r\n        where: { id: productId },\r\n        data: { stock: runningQuantity }\r\n    });\r\n}\r\n\r\n// --- REQUISITIONS ---\r\n\r\nexport async function getRequisitionsAction(userId: string, locationId: string) {\r\n    try {\r\n        const requisitions = await db.requisition.findMany({\r\n            where: {\r\n                userId,\r\n                locationId\r\n            },\r\n            orderBy: {\r\n                createdAt: 'desc'\r\n            }\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: requisitions.map((req: any) => ({\r\n                id: req.id,\r\n                userId: req.userId,\r\n                locationId: req.branchId,\r\n                requisitionNumber: req.requisitionNumber,\r\n                title: req.title || '',\r\n                items: (req.items as any) || [],\r\n                notes: req.notes,\r\n                status: req.status,\r\n                createdAt: req.createdAt.toISOString(),\r\n                updatedAt: req.updatedAt.toISOString()\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching requisitions:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createRequisitionAction(data: any) {\r\n    try {\r\n        const requisition = await db.requisition.create({\r\n            data: {\r\n                userId: data.userId,\r\n                branchId: data.locationId,\r\n                requisitionNumber: data.requisitionNumber,\r\n                title: data.title,\r\n                items: data.items,\r\n                notes: data.notes,\r\n                status: data.status || 'draft'\r\n            }\r\n        });\r\n\r\n        revalidatePath('/requisitions');\r\n        return {\r\n            success: true,\r\n            data: {\r\n                id: requisition.id,\r\n                userId: requisition.userId,\r\n                locationId: requisition.branchId,\r\n                requisitionNumber: requisition.requisitionNumber,\r\n                title: requisition.title || '',\r\n                items: (requisition.items as any) || [],\r\n                notes: requisition.notes,\r\n                status: requisition.status,\r\n                createdAt: requisition.createdAt.toISOString(),\r\n                updatedAt: requisition.updatedAt.toISOString()\r\n            }\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error creating requisition:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function updateRequisitionAction(id: string, userId: string, data: any) {\r\n    try {\r\n        const requisition = await db.requisition.update({\r\n            where: { id, userId },\r\n            data: {\r\n                title: data.title,\r\n                items: data.items,\r\n                notes: data.notes,\r\n                status: data.status,\r\n                updatedAt: new Date()\r\n            }\r\n        });\r\n\r\n        revalidatePath('/requisitions');\r\n        return {\r\n            success: true,\r\n            data: {\r\n                id: requisition.id,\r\n                userId: requisition.userId,\r\n                locationId: requisition.branchId,\r\n                requisitionNumber: requisition.requisitionNumber,\r\n                title: requisition.title || '',\r\n                items: (requisition.items as any) || [],\r\n                notes: requisition.notes,\r\n                status: requisition.status,\r\n                createdAt: requisition.createdAt.toISOString(),\r\n                updatedAt: requisition.updatedAt.toISOString()\r\n            }\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error updating requisition:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteRequisitionAction(id: string, userId: string) {\r\n    try {\r\n        await db.requisition.delete({\r\n            where: { id, userId }\r\n        });\r\n\r\n        revalidatePath('/requisitions');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting requisition:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n// --- REPORTS / ANALYTICS ---\r\n\r\nexport async function getStockSummaryReportAction(locationId: string, startDate: string, endDate: string) {\r\n    try {\r\n        const start = new Date(startDate);\r\n        const end = new Date(endDate);\r\n\r\n        // Fetch all products for the location\r\n        const products = await db.product.findMany({\r\n            where: { branchId: locationId },\r\n            include: { category: true }\r\n        });\r\n\r\n        const reportData = await Promise.all(products.map(async (product: any) => {\r\n            // This is a simplified version of the logic that was likely in the RPC\r\n            // In a real production app, we'd use complex SQL or dedicated aggregate tables\r\n\r\n            // Get history for this product in the date range\r\n            const history = await db.productHistory.findMany({\r\n                where: {\r\n                    productId: product.id,\r\n                    locationId,\r\n                    createdAt: {\r\n                        gte: start,\r\n                        lte: end\r\n                    }\r\n                },\r\n                orderBy: { createdAt: 'asc' }\r\n            });\r\n\r\n            // Calculate metrics from history\r\n            let itemsSold = 0;\r\n            let stockIn = 0;\r\n            let adjustmentsIn = 0;\r\n            let adjustmentsOut = 0;\r\n\r\n            history.forEach((h: any) => {\r\n                const change = h.newQuantity - h.previousQuantity;\r\n                if (h.changeReason === 'SALE') {\r\n                    itemsSold += Math.abs(change);\r\n                } else if (h.changeReason === 'STOCK_IN' || h.changeReason === 'RESTOCK') {\r\n                    stockIn += change;\r\n                } else if (change > 0) {\r\n                    adjustmentsIn += change;\r\n                } else {\r\n                    adjustmentsOut += Math.abs(change);\r\n                }\r\n            });\r\n\r\n            // Get closing stock at end date (or current if after end date)\r\n            const closingStockEntry = await db.productHistory.findFirst({\r\n                where: {\r\n                    productId: product.id,\r\n                    locationId,\r\n                    createdAt: { lte: end }\r\n                },\r\n                orderBy: { createdAt: 'desc' }\r\n            });\r\n\r\n            const closingStock = closingStockEntry ? closingStockEntry.newQuantity : 0;\r\n            const openingStock = closingStock - (stockIn + adjustmentsIn - itemsSold - adjustmentsOut);\r\n\r\n            return {\r\n                productId: product.id,\r\n                productName: product.name,\r\n                itemNumber: product.sku || product.id,\r\n                imageUrl: product.imageUrl,\r\n                costPrice: Number(product.costPrice),\r\n                sellingPrice: Number(product.sellingPrice),\r\n                category: product.category?.name,\r\n                openingStock,\r\n                itemsSold,\r\n                stockIn,\r\n                transferOut: 0,\r\n                returnIn: 0,\r\n                returnOut: 0,\r\n                adjustmentsIn,\r\n                adjustmentsOut,\r\n                closingStock,\r\n                revaluation: closingStock * Number(product.costPrice)\r\n            };\r\n        }));\r\n\r\n        return { success: true, data: reportData };\r\n    } catch (error: any) {\r\n        console.error('Error generating stock summary report:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n// --- STOCK RECONCILIATION & REPAIRS ---\r\n\r\nexport async function getProductReconciliationAction(businessId: string, productId: string) {\r\n    try {\r\n        const product = await db.product.findUnique({\r\n            where: { id: productId },\r\n            include: { category: true }\r\n        });\r\n\r\n        if (!product) return { success: false, error: 'Product not found' };\r\n\r\n        // Fetch all history entries\r\n        const history = await db.productHistory.findMany({\r\n            where: { productId, locationId: businessId },\r\n            orderBy: [{ createdAt: 'asc' }, { id: 'asc' }]\r\n        });\r\n\r\n        // Fetch all sales containing this product\r\n        const sales = await db.sale.findMany({\r\n            where: { branchId: businessId },\r\n            orderBy: { date: 'asc' }\r\n        });\r\n\r\n        const openingStock = history.length > 0 ? history[0].newStock : 0;\r\n        const openingDate = history.length > 0 ? history[0].createdAt : null;\r\n\r\n        const dailyTransactions = new Map<string, any>();\r\n        let excludedSalesQty = 0;\r\n\r\n        sales.forEach(sale => {\r\n            const items = (sale.items as any[]) || [];\r\n            const soldQty = items\r\n                .filter(item => item.productId === productId)\r\n                .reduce((sum, item) => sum + (Number(item.quantity) || 0), 0);\r\n\r\n            if (soldQty > 0) {\r\n                if (openingDate && sale.date < openingDate) {\r\n                    excludedSalesQty += soldQty;\r\n                } else {\r\n                    const dateStr = sale.date.toISOString().split('T')[0];\r\n                    const day = dailyTransactions.get(dateStr) || { itemsSold: 0, stockAdded: 0, transferOut: 0, returnIn: 0, returnOut: 0, adjustments: 0 };\r\n                    day.itemsSold += soldQty;\r\n                    dailyTransactions.set(dateStr, day);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Movements (excluding initial entry)\r\n        const movements = history.slice(1);\r\n        movements.forEach(h => {\r\n            const dateStr = h.createdAt.toISOString().split('T')[0];\r\n            const delta = h.newStock - h.oldStock;\r\n            const reason = (h.changeReason || '').toLowerCase();\r\n\r\n            const day = dailyTransactions.get(dateStr) || { itemsSold: 0, stockAdded: 0, transferOut: 0, returnIn: 0, returnOut: 0, adjustments: 0 };\r\n\r\n            if (h.type === 'RESTOCK' || reason.includes('purchase') || reason.includes('addition')) {\r\n                day.stockAdded += delta;\r\n            } else if (reason.includes('transfer out')) {\r\n                day.transferOut += Math.abs(delta);\r\n            } else if (reason.includes('customer return')) {\r\n                day.returnIn += delta;\r\n            } else if (reason.includes('return to supplier')) {\r\n                day.returnOut += Math.abs(delta);\r\n            } else if (h.type !== 'SALE') {\r\n                day.adjustments += delta;\r\n            }\r\n            dailyTransactions.set(dateStr, day);\r\n        });\r\n\r\n        const sortedDates = Array.from(dailyTransactions.keys()).sort();\r\n        const dailyBreakdown = [];\r\n        let runningStock = openingStock;\r\n\r\n        for (const date of sortedDates) {\r\n            const day = dailyTransactions.get(date);\r\n            const startingStock = runningStock;\r\n            const endingStock = startingStock - day.itemsSold + day.stockAdded - day.transferOut + day.returnIn - day.returnOut + day.adjustments;\r\n\r\n            dailyBreakdown.push({\r\n                date,\r\n                startingStock,\r\n                ...day,\r\n                endingStock\r\n            });\r\n            runningStock = endingStock;\r\n        }\r\n\r\n        return {\r\n            success: true,\r\n            data: {\r\n                product: {\r\n                    id: product.id,\r\n                    name: product.name,\r\n                    quantity: product.stock,\r\n                    itemNumber: product.sku\r\n                },\r\n                currentStock: product.stock,\r\n                calculatedStock: runningStock,\r\n                discrepancy: product.stock - runningStock,\r\n                openingStock,\r\n                openingDate: openingDate?.toISOString(),\r\n                excludedSalesQty,\r\n                dailyBreakdown\r\n            }\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error in reconciliation action:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getStockRepairsPreviewAction(businessId: string) {\r\n    try {\r\n        const products = await db.product.findMany({\r\n            where: { branchId: businessId },\r\n            select: { id: true, name: true, stock: true }\r\n        });\r\n\r\n        const brokenChains = [];\r\n\r\n        for (const product of products) {\r\n            const history = await db.productHistory.findMany({\r\n                where: { productId: product.id, locationId: businessId },\r\n                orderBy: [{ createdAt: 'asc' }, { id: 'asc' }]\r\n            });\r\n\r\n            if (history.length === 0) continue;\r\n\r\n            let runningQuantity = 0;\r\n            const brokenEntries = [];\r\n\r\n            for (const entry of history) {\r\n                const change = entry.newStock - entry.oldStock;\r\n                const expectedPrev = runningQuantity;\r\n                const expectedNext = expectedPrev + change;\r\n\r\n                if (entry.oldStock !== expectedPrev || entry.newStock !== expectedNext) {\r\n                    brokenEntries.push({\r\n                        entryId: entry.id,\r\n                        createdAt: entry.createdAt.toISOString(),\r\n                        changeReason: entry.changeReason,\r\n                        currentPrevQty: entry.oldStock,\r\n                        currentNewQty: entry.newStock,\r\n                        fixedPrevQty: expectedPrev,\r\n                        fixedNewQty: expectedNext\r\n                    });\r\n                }\r\n                runningQuantity = expectedNext;\r\n            }\r\n\r\n            if (brokenEntries.length > 0 || Math.abs(product.stock - runningQuantity) > 0.001) {\r\n                brokenChains.push({\r\n                    productId: product.id,\r\n                    productName: product.name,\r\n                    totalEntries: history.length,\r\n                    brokenEntries,\r\n                    finalFixedQty: runningQuantity,\r\n                    currentProductQty: product.stock\r\n                });\r\n            }\r\n        }\r\n\r\n        return { success: true, data: brokenChains };\r\n    } catch (error: any) {\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function repairStockChainsAction(businessId: string, productIds?: string[]) {\r\n    try {\r\n        const ids = productIds || (await db.product.findMany({\r\n            where: { branchId: businessId },\r\n            select: { id: true }\r\n        })).map(p => p.id);\r\n\r\n        let repaired = 0;\r\n        let failed = 0;\r\n\r\n        for (const id of ids) {\r\n            try {\r\n                await recalculateStockChainAction(id, businessId);\r\n                repaired++;\r\n            } catch (err) {\r\n                failed++;\r\n            }\r\n        }\r\n\r\n        return { success: true, data: { repaired, failed } };\r\n    } catch (error: any) {\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getActivityByEntityIdsAction(entityIds: string[]) {\r\n    try {\r\n        const records = await db.activityHistory.findMany({\r\n            where: { entityId: { in: entityIds } },\r\n            select: { entityId: true, entityName: true }\r\n        });\r\n        return { success: true, data: records };\r\n    } catch (error: any) {\r\n        return { success: false, error: error.message, data: [] };\r\n    }\r\n}\r\n\r\nexport async function updateStockHistoryDatesAction(entryIds: string[], newDate: string) {\r\n    try {\r\n        await db.productHistory.updateMany({\r\n            where: { id: { in: entryIds } },\r\n            data: { createdAt: new Date(newDate) }\r\n        });\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n","import { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport { getStockSummaryReportAction } from '@/app/actions/inventory';\r\n\r\nexport interface StockSummaryData {\r\n  productId: string;\r\n  productName: string;\r\n  itemNumber: string;\r\n  imageUrl?: string | null;\r\n  costPrice: number;\r\n  sellingPrice: number;\r\n  category?: string;\r\n  openingStock: number;\r\n  itemsSold: number;\r\n  stockIn: number;\r\n  transferOut: number;\r\n  returnIn: number;\r\n  returnOut: number;\r\n  adjustmentsIn: number;\r\n  adjustmentsOut: number;\r\n  closingStock: number;\r\n  revaluation: number;\r\n}\r\n\r\nexport const useStockSummaryData = (\r\n  dateRange: { from: Date | undefined; to: Date | undefined }\r\n) => {\r\n  const { user } = useAuth();\r\n  const { currentBusiness } = useBusiness();\r\n  const queryClient = useQueryClient();\r\n\r\n  const fetchStockSummary = async (): Promise<StockSummaryData[]> => {\r\n    if (!user?.id || !currentBusiness?.id || !dateRange?.from || !dateRange?.to) return [];\r\n\r\n    try {\r\n      const result = await getStockSummaryReportAction(\r\n        currentBusiness.id,\r\n        dateRange.from.toISOString(),\r\n        dateRange.to.toISOString()\r\n      );\r\n\r\n      if (result.success && result.data) {\r\n        return result.data as StockSummaryData[];\r\n      } else {\r\n        throw new Error(result.error);\r\n      }\r\n    } catch (error: any) {\r\n      console.error('[StockSummary] Error fetching report:', error.message);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const { data: stockSummaryData = [], isLoading, refetch } = useQuery({\r\n    queryKey: ['stockSummary', currentBusiness?.id, dateRange.from?.toISOString(), dateRange.to?.toISOString()],\r\n    queryFn: fetchStockSummary,\r\n    enabled: !!user?.id && !!currentBusiness?.id && !!dateRange?.from && !!dateRange?.to,\r\n    staleTime: 5 * 60 * 1000,\r\n    gcTime: 30 * 60 * 1000,\r\n  });\r\n\r\n  return {\r\n    stockSummaryData,\r\n    isLoading,\r\n    loadStockSummaryData: refetch,\r\n    clearCache: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['stockSummary'] });\r\n    },\r\n    clearAllLocationCaches: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['stockSummary'] });\r\n    }\r\n  };\r\n};\r\n","import React from 'react';\r\nimport jsPDF from 'jspdf';\r\nimport html2canvas from 'html2canvas';\r\nimport Barcode from 'react-barcode';\r\nimport { createRoot } from 'react-dom/client';\r\nimport { Product } from '@/types';\r\n\r\ninterface BarcodeExportOptions {\r\n    productName: string;\r\n    barcodeValue: string;\r\n    price?: number;\r\n    currency?: string;\r\n    showPrice?: boolean;\r\n}\r\n\r\n/**\r\n * Render barcode to canvas and return image data URL\r\n */\r\nconst renderBarcodeToImage = async (options: BarcodeExportOptions): Promise<string> => {\r\n    const { productName, barcodeValue, price, currency = 'KES', showPrice = true } = options;\r\n\r\n    // Create a temporary container\r\n    const container = document.createElement('div');\r\n    container.style.position = 'absolute';\r\n    container.style.left = '-9999px';\r\n    container.style.top = '-9999px';\r\n    container.style.width = '300px'; // Base width for 50mm label\r\n    container.style.padding = '15px';\r\n    container.style.backgroundColor = 'white';\r\n    container.style.fontFamily = 'Arial, sans-serif';\r\n    document.body.appendChild(container);\r\n\r\n    try {\r\n        // Create the barcode container with styling\r\n        const barcodeContainer = document.createElement('div');\r\n        barcodeContainer.style.display = 'flex';\r\n        barcodeContainer.style.flexDirection = 'column';\r\n        barcodeContainer.style.alignItems = 'center';\r\n        barcodeContainer.style.gap = '8px';\r\n\r\n        // Product name\r\n        const nameElement = document.createElement('div');\r\n        nameElement.textContent = productName.length > 30 ? productName.substring(0, 27) + '...' : productName;\r\n        nameElement.style.fontSize = '14px';\r\n        nameElement.style.fontWeight = 'bold';\r\n        nameElement.style.textAlign = 'center';\r\n        nameElement.style.maxWidth = '100%';\r\n        nameElement.style.wordWrap = 'break-word';\r\n        barcodeContainer.appendChild(nameElement);\r\n\r\n        // Barcode SVG container\r\n        const svgContainer = document.createElement('div');\r\n        svgContainer.id = 'barcode-svg-container';\r\n        barcodeContainer.appendChild(svgContainer);\r\n\r\n        // Price (if applicable)\r\n        if (showPrice && price !== undefined) {\r\n            const priceElement = document.createElement('div');\r\n            priceElement.textContent = `${currency} ${price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;\r\n            priceElement.style.fontSize = '14px';\r\n            priceElement.style.fontWeight = 'bold';\r\n            priceElement.style.textAlign = 'center';\r\n            barcodeContainer.appendChild(priceElement);\r\n        }\r\n\r\n        container.appendChild(barcodeContainer);\r\n\r\n        // Render the barcode using React\r\n        const root = createRoot(svgContainer);\r\n        await new Promise<void>((resolve) => {\r\n            const BarcodeComponent = Barcode as any;\r\n            root.render(\r\n                React.createElement(BarcodeComponent, {\r\n                    value: barcodeValue,\r\n                    width: 1.5,\r\n                    height: 60,\r\n                    fontSize: 12\r\n                })\r\n            );\r\n            // Give React time to render\r\n            setTimeout(() => resolve(), 100);\r\n        });\r\n\r\n        // Convert to canvas\r\n        const canvas = await html2canvas(container, {\r\n            backgroundColor: '#ffffff',\r\n            scale: 2,\r\n        });\r\n\r\n        // Get image data URL\r\n        const imageDataUrl = canvas.toDataURL('image/jpeg', 0.95);\r\n\r\n        // Cleanup\r\n        root.unmount();\r\n        document.body.removeChild(container);\r\n\r\n        return imageDataUrl;\r\n    } catch (error) {\r\n        document.body.removeChild(container);\r\n        throw error;\r\n    }\r\n};\r\n\r\n/**\r\n * Export a single barcode as a PDF file\r\n */\r\nexport const exportSingleBarcodeToPDF = async (options: BarcodeExportOptions): Promise<void> => {\r\n    try {\r\n        const imageDataUrl = await renderBarcodeToImage(options);\r\n\r\n        // Create PDF\r\n        const pdf = new jsPDF({\r\n            orientation: 'portrait',\r\n            unit: 'mm',\r\n            format: 'a4',\r\n        });\r\n\r\n        // Add title\r\n        pdf.setFontSize(16);\r\n        pdf.text('Product Barcode', 105, 20, { align: 'center' });\r\n\r\n        // Add barcode image centered - Fixed 45x30mm\r\n        const imgWidth = 45;\r\n        const imgHeight = 30;\r\n        const x = (210 - imgWidth) / 2; // Center on A4 width (210mm)\r\n        const y = 40;\r\n\r\n        pdf.addImage(imageDataUrl, 'JPEG', x, y, imgWidth, imgHeight);\r\n\r\n        // Save PDF\r\n        const sanitizedName = options.productName.replace(/[^a-z0-9]/gi, '_').toLowerCase();\r\n        pdf.save(`barcode_${sanitizedName}_${Date.now()}.pdf`);\r\n    } catch (error) {\r\n        console.error('Error exporting barcode to PDF:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n/**\r\n * Export multiple barcodes to a single PDF file\r\n */\r\nexport const exportBulkBarcodesToPDF = async (\r\n    products: Product[],\r\n    options: { showPrice?: boolean; currency?: string } = {}\r\n): Promise<void> => {\r\n    const { showPrice = true, currency = 'KES' } = options;\r\n\r\n    try {\r\n        // Filter products with barcodes\r\n        const productsWithBarcodes = products.filter(p => p.barcode);\r\n\r\n        if (productsWithBarcodes.length === 0) {\r\n            throw new Error('No products with barcodes to export');\r\n        }\r\n\r\n        const pdf = new jsPDF({\r\n            orientation: 'portrait',\r\n            unit: 'mm',\r\n            format: 'a4',\r\n        });\r\n\r\n        // Layout configuration - Standardized 45x30mm labels\r\n        const labelWidth = 45;\r\n        const labelHeight = 30;\r\n        const spacing = 2; // Reduced spacing for better fit\r\n        const pageWidth = 210; // A4 width in mm\r\n        const pageHeight = 297; // A4 height in mm\r\n        const margin = 10;\r\n\r\n        // Calculate how many labels fit across (columns)\r\n        const cols = Math.floor((pageWidth - (2 * margin) + spacing) / (labelWidth + spacing));\r\n        // Calculate how many labels fit down (rows)\r\n        const rows = Math.floor((pageHeight - (2 * margin) + spacing) / (labelHeight + spacing));\r\n\r\n        const itemsPerPage = cols * rows;\r\n\r\n        // Calculate centered margins based on calculated grid\r\n        const totalGridWidth = (cols * labelWidth) + ((cols - 1) * spacing);\r\n        const totalGridHeight = (rows * labelHeight) + ((rows - 1) * spacing);\r\n\r\n        const marginX = (pageWidth - totalGridWidth) / 2;\r\n        const marginY = (pageHeight - totalGridHeight) / 2;\r\n\r\n        let itemCount = 0;\r\n\r\n        for (const product of productsWithBarcodes) {\r\n            if (itemCount > 0 && itemCount % itemsPerPage === 0) {\r\n                pdf.addPage();\r\n            }\r\n\r\n            const pageIndex = itemCount % itemsPerPage;\r\n            const row = Math.floor(pageIndex / cols);\r\n            const col = pageIndex % cols;\r\n\r\n            const x = marginX + (col * (labelWidth + spacing));\r\n            const y = marginY + (row * (labelHeight + spacing));\r\n\r\n            // Render barcode to image\r\n            const imageDataUrl = await renderBarcodeToImage({\r\n                productName: product.name,\r\n                barcodeValue: product.barcode!,\r\n                price: product.sellingPrice,\r\n                currency,\r\n                showPrice,\r\n            });\r\n\r\n            // Add border for visual separation (optional)\r\n            pdf.setDrawColor(200, 200, 200);\r\n            pdf.rect(x, y, labelWidth, labelHeight);\r\n\r\n            // Add barcode image\r\n            const imgWidth = labelWidth - 4;\r\n            const imgHeight = labelHeight - 4;\r\n            pdf.addImage(imageDataUrl, 'JPEG', x + 2, y + 2, imgWidth, imgHeight);\r\n\r\n            itemCount++;\r\n        }\r\n\r\n        // Add summary on first page\r\n        pdf.setPage(1);\r\n        pdf.setFontSize(10);\r\n        pdf.setTextColor(100, 100, 100);\r\n        pdf.text(`Total barcodes: ${productsWithBarcodes.length}`, 105, 5, { align: 'center' });\r\n\r\n        // Save PDF\r\n        const timestamp = new Date().toISOString().split('T')[0];\r\n        pdf.save(`barcodes_bulk_${timestamp}_${productsWithBarcodes.length}_items.pdf`);\r\n    } catch (error) {\r\n        console.error('Error exporting bulk barcodes to PDF:', error);\r\n        throw error;\r\n    }\r\n};\r\n"],"names":[],"mappings":"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","ignoreList":[0,1,2,4,7,8]}