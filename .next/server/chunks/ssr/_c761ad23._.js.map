{"version":3,"sources":["../../../../src/components/ui/sheet.tsx","../../../../src/components/inventory/ProductSuggestionsPanel.tsx","../../../../src/hooks/useProductSuggestions.ts","../../../../src/utils/discountCalculations.ts","../../../../src/hooks/useSoldItemsData.ts","../../../../src/hooks/useMobileOptimization.ts","../../../../src/utils/exportSoldItemsToCSV.ts","../../../../src/utils/exportSoldItemsToPDF.ts","../../../../src/components/inventory/ItemSalesDialog.tsx","../../../../src/components/inventory/SoldItemsTab.tsx","../../../../src/components/inventory/StockSummaryFilters.tsx","../../../../node_modules/lucide-react/src/icons/arrow-up-down.ts","../../../../src/components/inventory/StockSummaryTable.tsx","../../../../src/components/inventory/StockSummaryOverview.tsx","../../../../src/utils/exportStockSummaryToPDF.ts","../../../../src/components/inventory/StockSummaryTab.tsx","../../../../src/components/inventory/StockHistoryDateFilter.tsx","../../../../src/components/inventory/EditGroupDateDialog.tsx","../../../../src/components/inventory/DeleteInvoiceDialog.tsx","../../../../src/components/inventory/StockInputHistory.tsx","../../../../src/components/inventory/BulkStockAddTab.tsx","../../../../node_modules/lucide-react/src/icons/scan-barcode.ts","../../../../node_modules/lucide-react/src/icons/clipboard-list.ts","../../../../src/utils/exportStockCount.ts","../../../../src/components/inventory/StockCountTab.tsx","../../../../src/hooks/useRequisitions.ts","../../../../src/components/inventory/SavedRequisitions.tsx","../../../../src/components/inventory/RequisitionTab.tsx","../../../../node_modules/lucide-react/src/icons/list-filter.ts","../../../../node_modules/lucide-react/src/icons/truck.ts","../../../../node_modules/lucide-react/src/icons/file-up.ts","../../../../node_modules/lucide-react/src/icons/scale.ts","../../../../src/components/inventory/InventoryHeader.tsx","../../../../src/components/inventory/InventorySearchBar.tsx","../../../../src/components/inventory/TopSellingProductsTable.tsx","../../../../src/components/inventory/TopSellingProductsCard.tsx","../../../../src/components/inventory/StockLevelChart.tsx","../../../../src/components/inventory/StockLevelOverviewCard.tsx","../../../../src/hooks/useInventoryData.ts","../../../../src/pages/Inventory.tsx","../../../../node_modules/next/src/build/templates/pages.ts"],"sourcesContent":["\r\nimport * as React from \"react\"\r\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\nimport { X } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Sheet = SheetPrimitive.Root\r\n\r\nconst SheetTrigger = SheetPrimitive.Trigger\r\n\r\nconst SheetClose = SheetPrimitive.Close\r\n\r\nconst SheetPortal = SheetPrimitive.Portal\r\n\r\nconst SheetOverlay = React.forwardRef<\r\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\r\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\r\n>(({ className, ...props }, ref) => (\r\n  <SheetPrimitive.Overlay\r\n    className={cn(\r\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n    ref={ref}\r\n  />\r\n))\r\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\r\n\r\nconst sheetVariants = cva(\r\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\r\n  {\r\n    variants: {\r\n      side: {\r\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\r\n        bottom:\r\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\r\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\r\n        right:\r\n          \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      side: \"right\",\r\n    },\r\n  }\r\n)\r\n\r\ninterface SheetContentProps\r\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\r\n    VariantProps<typeof sheetVariants> {}\r\n\r\nconst SheetContent = React.forwardRef<\r\n  React.ElementRef<typeof SheetPrimitive.Content>,\r\n  SheetContentProps\r\n>(({ side = \"right\", className, children, ...props }, ref) => (\r\n  <SheetPortal>\r\n    <SheetOverlay />\r\n    <SheetPrimitive.Content\r\n      ref={ref}\r\n      className={cn(sheetVariants({ side }), className)}\r\n      {...props}\r\n    >\r\n      {children}\r\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\r\n        <X className=\"h-4 w-4\" />\r\n        <span className=\"sr-only\">Close</span>\r\n      </SheetPrimitive.Close>\r\n    </SheetPrimitive.Content>\r\n  </SheetPortal>\r\n))\r\nSheetContent.displayName = SheetPrimitive.Content.displayName\r\n\r\nconst SheetHeader = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col space-y-2 text-center sm:text-left\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nSheetHeader.displayName = \"SheetHeader\"\r\n\r\nconst SheetFooter = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nSheetFooter.displayName = \"SheetFooter\"\r\n\r\nconst SheetTitle = React.forwardRef<\r\n  React.ElementRef<typeof SheetPrimitive.Title>,\r\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\r\n>(({ className, ...props }, ref) => (\r\n  <SheetPrimitive.Title\r\n    ref={ref}\r\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nSheetTitle.displayName = SheetPrimitive.Title.displayName\r\n\r\nconst SheetDescription = React.forwardRef<\r\n  React.ElementRef<typeof SheetPrimitive.Description>,\r\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\r\n>(({ className, ...props }, ref) => (\r\n  <SheetPrimitive.Description\r\n    ref={ref}\r\n    className={cn(\"text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nSheetDescription.displayName = SheetPrimitive.Description.displayName\r\n\r\nexport {\r\n  Sheet,\r\n  SheetPortal,\r\n  SheetOverlay,\r\n  SheetTrigger,\r\n  SheetClose,\r\n  SheetContent,\r\n  SheetHeader,\r\n  SheetFooter,\r\n  SheetTitle,\r\n  SheetDescription,\r\n}\r\n","\r\n\r\nimport React from 'react';\r\nimport { Product } from '@/types';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Package, Search, X } from 'lucide-react';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport ProductImage from './ProductImage';\r\nimport {\r\n  Sheet,\r\n  SheetContent,\r\n  SheetDescription,\r\n  SheetHeader,\r\n  SheetTitle,\r\n} from '@/components/ui/sheet';\r\nimport { Button } from '@/components/ui/button';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\n\r\ninterface ProductSuggestionsPanelProps {\r\n  suggestions: Product[];\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSelectProduct: (product: Product) => void;\r\n  searchTerm: string;\r\n  isLoading?: boolean;\r\n}\r\n\r\nconst ProductSuggestionsPanel: React.FC<ProductSuggestionsPanelProps> = ({\r\n  suggestions,\r\n  isOpen,\r\n  onClose,\r\n  onSelectProduct,\r\n  searchTerm,\r\n  isLoading = false\r\n}) => {\r\n  const { settings } = useBusinessSettings();\r\n  const isMobile = useIsMobile();\r\n\r\n  const highlightMatch = (text: string, searchTerm: string) => {\r\n    if (!searchTerm) return text;\r\n\r\n    // Escape special regex characters in searchTerm\r\n    const escapedSearchTerm = searchTerm.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\r\n    const regex = new RegExp(`(${escapedSearchTerm})`, 'gi');\r\n    const parts = text.split(regex);\r\n\r\n    return parts.map((part, index) =>\r\n      regex.test(part) ? (\r\n        <span key={index} className=\"bg-yellow-200 font-medium\">\r\n          {part}\r\n        </span>\r\n      ) : (\r\n        <span key={index}>{part}</span>\r\n      )\r\n    );\r\n  };\r\n\r\n  const handleProductSelect = (product: Product) => {\r\n    onSelectProduct(product);\r\n    onClose();\r\n  };\r\n\r\n  // Mobile dropdown implementation\r\n  if (isMobile) {\r\n    if (!isOpen) return null;\r\n    if (suggestions.length === 0 && !isLoading) return null;\r\n\r\n    return (\r\n      <div className=\"bg-white border border-gray-200 rounded-md shadow-lg max-h-80 overflow-y-auto\">\r\n        <div className=\"p-2 border-b bg-gray-50\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Search className=\"h-4 w-4 text-gray-600\" />\r\n              <span className=\"text-sm font-medium\">Suggestions</span>\r\n            </div>\r\n            <Button variant=\"ghost\" size=\"icon\" onClick={onClose} className=\"h-6 w-6\">\r\n              <X className=\"h-3 w-3\" />\r\n            </Button>\r\n          </div>\r\n          <p className=\"text-xs text-gray-500 mt-1\">\r\n            {isLoading\r\n              ? 'Searching for products...'\r\n              : suggestions.length > 0\r\n                ? `Found ${suggestions.length} product${suggestions.length > 1 ? 's' : ''}`\r\n                : 'No products found'\r\n            }\r\n          </p>\r\n        </div>\r\n\r\n        {isLoading && (\r\n          <div className=\"p-8 text-center bg-white\">\r\n            <div className=\"h-6 w-6 border-2 border-primary border-t-transparent animate-spin rounded-full mx-auto mb-2\" />\r\n            <span className=\"text-xs text-gray-500\">Searching...</span>\r\n          </div>\r\n        )}\r\n\r\n        {!isLoading && suggestions.length > 0 && (\r\n          <div className=\"max-h-64 overflow-y-auto bg-primary\">\r\n            {suggestions.map((product) => (\r\n              <div\r\n                key={product.id}\r\n                className=\"p-3 hover:bg-primary-foreground/20 cursor-pointer border-b border-primary-foreground/20 last:border-b-0 bg-white mx-1 my-1 rounded\"\r\n                onClick={() => handleProductSelect(product)}\r\n              >\r\n                <div className=\"flex items-start gap-3\">\r\n                  <ProductImage imageUrl={product.imageUrl} alt={product.name} size=\"sm\" />\r\n\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-center gap-2 mb-1\">\r\n                      <Package className=\"h-4 w-4 text-gray-400 flex-shrink-0\" />\r\n                      <div className=\"font-medium text-sm truncate\">\r\n                        {highlightMatch(product.name, searchTerm)}\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-2 mb-2\">\r\n                      <Badge variant=\"outline\" className=\"text-xs\">\r\n                        {product.category}\r\n                      </Badge>\r\n                      <span className=\"text-xs text-gray-500\">\r\n                        Item #: {highlightMatch(product.itemNumber, searchTerm)}\r\n                      </span>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-between text-xs text-gray-600 mb-1\">\r\n                      <span>Qty: {product.quantity % 1 === 0 ? product.quantity : product.quantity.toFixed(2)}</span>\r\n                      <span className=\"font-medium\">\r\n                        {settings.currency} {product.sellingPrice.toFixed(2)}\r\n                      </span>\r\n                    </div>\r\n\r\n                    {product.description && (\r\n                      <div className=\"text-xs text-gray-500 truncate\">\r\n                        {highlightMatch(product.description, searchTerm)}\r\n                      </div>\r\n                    )}\r\n\r\n                    {product.supplier && (\r\n                      <div className=\"text-xs text-gray-500 mt-1\">\r\n                        Supplier: {highlightMatch(product.supplier, searchTerm)}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {!isLoading && suggestions.length === 0 && (\r\n          <div className=\"p-8 text-center bg-white\">\r\n            <Search className=\"h-8 w-8 text-gray-300 mx-auto mb-2\" />\r\n            <p className=\"text-xs text-gray-500\">No products found matching \"{searchTerm}\"</p>\r\n          </div>\r\n        )}\r\n\r\n        {suggestions.length >= 50 && (\r\n          <div className=\"p-3 border-t bg-primary text-center\">\r\n            <span className=\"text-xs text-primary-foreground\">\r\n              Showing top 50 results. Keep typing to refine...\r\n            </span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Desktop sidebar implementation\r\n  return (\r\n    <Sheet open={isOpen} onOpenChange={onClose} modal={false}>\r\n      <SheetContent\r\n        className=\"w-full sm:w-[400px] sm:max-w-[400px] p-0 z-[100] pointer-events-auto flex flex-col bg-primary\"\r\n        side=\"right\"\r\n        onOpenAutoFocus={(e) => e.preventDefault()}\r\n        onCloseAutoFocus={(e) => e.preventDefault()}\r\n      >\r\n        <SheetHeader className=\"p-4 border-b border-primary-foreground/20 bg-primary flex-shrink-0\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Search className=\"h-4 w-4 text-primary-foreground\" />\r\n              <SheetTitle className=\"text-base text-primary-foreground\">Product Suggestions</SheetTitle>\r\n            </div>\r\n            <Button variant=\"ghost\" size=\"icon\" onClick={onClose} className=\"h-8 w-8 text-primary-foreground hover:bg-primary-foreground/20\">\r\n              <X className=\"h-4 w-4\" />\r\n            </Button>\r\n          </div>\r\n          <SheetDescription className=\"text-left text-primary-foreground/80\">\r\n            {isLoading\r\n              ? 'Searching for products...'\r\n              : suggestions.length > 0\r\n                ? `Found ${suggestions.length} product${suggestions.length > 1 ? 's' : ''} matching \"${searchTerm}\"`\r\n                : `No products found matching \"${searchTerm}\"`\r\n            }\r\n          </SheetDescription>\r\n        </SheetHeader>\r\n\r\n        {isLoading ? (\r\n          <div className=\"flex-1 flex flex-col items-center justify-center p-8 text-primary-foreground bg-primary\">\r\n            <div className=\"h-8 w-8 border-2 border-primary-foreground border-t-transparent animate-spin rounded-full mb-4\" />\r\n            <p className=\"text-sm\">Searching products...</p>\r\n          </div>\r\n        ) : suggestions.length > 0 ? (\r\n          <ScrollArea className=\"flex-1 h-0 bg-primary\">\r\n            <div className=\"p-2\">\r\n              {suggestions.map((product) => (\r\n                <div\r\n                  key={product.id}\r\n                  className=\"p-3 hover:bg-primary-foreground/20 cursor-pointer border-b border-primary-foreground/20 last:border-b-0 rounded-md mx-1 my-1 hover:shadow-sm transition-all bg-white\"\r\n                  onClick={() => handleProductSelect(product)}\r\n                >\r\n                  <div className=\"flex items-start gap-3\">\r\n                    <ProductImage imageUrl={product.imageUrl} alt={product.name} size=\"sm\" />\r\n\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"flex items-center gap-2 mb-1\">\r\n                        <Package className=\"h-4 w-4 text-gray-400 flex-shrink-0\" />\r\n                        <div className=\"font-medium text-sm truncate\">\r\n                          {highlightMatch(product.name, searchTerm)}\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center gap-2 mb-2\">\r\n                        <Badge variant=\"outline\" className=\"text-xs\">\r\n                          {product.category}\r\n                        </Badge>\r\n                        <span className=\"text-xs text-gray-500\">\r\n                          Item #: {highlightMatch(product.itemNumber, searchTerm)}\r\n                        </span>\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center justify-between text-xs text-gray-600 mb-1\">\r\n                        <span>Qty: {product.quantity % 1 === 0 ? product.quantity : product.quantity.toFixed(2)}</span>\r\n                        <span className=\"font-medium\">\r\n                          {settings.currency} {product.sellingPrice.toFixed(2)}\r\n                        </span>\r\n                      </div>\r\n\r\n                      {product.description && (\r\n                        <div className=\"text-xs text-gray-500 truncate\">\r\n                          {highlightMatch(product.description, searchTerm)}\r\n                        </div>\r\n                      )}\r\n\r\n                      {product.supplier && (\r\n                        <div className=\"text-xs text-gray-500 mt-1\">\r\n                          Supplier: {highlightMatch(product.supplier, searchTerm)}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </ScrollArea>\r\n        ) : (\r\n          <div className=\"p-8 text-center text-primary-foreground flex-1 flex flex-col items-center justify-center bg-primary\">\r\n            <Search className=\"h-12 w-12 mx-auto mb-4 text-primary-foreground/50\" />\r\n            <p className=\"text-sm\">No products found</p>\r\n            <p className=\"text-xs mt-1\">Try adjusting your search term</p>\r\n          </div>\r\n        )}\r\n\r\n        {suggestions.length >= 50 && (\r\n          <div className=\"p-3 border-t bg-primary text-center flex-shrink-0\">\r\n            <span className=\"text-xs text-primary-foreground\">\r\n              Showing top 50 results. Keep typing to refine...\r\n            </span>\r\n          </div>\r\n        )}\r\n      </SheetContent>\r\n    </Sheet>\r\n  );\r\n};\r\n\r\nexport default ProductSuggestionsPanel;\r\n\r\n","\r\nimport { useState, useEffect, useMemo } from 'react';\r\nimport { Product } from '@/types';\r\nimport { matchProductSearch } from '@/utils/searchUtils';\r\n\r\nexport const useProductSuggestions = (products: Product[], searchTerm: string) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  // Get filtered suggestions based on search term\r\n  const suggestions = useMemo(() => {\r\n    if (!searchTerm || searchTerm.length < 1) {\r\n      return [];\r\n    }\r\n\r\n    // Use unified search utility for consistency\r\n    const filtered = products.filter(product => matchProductSearch(product, searchTerm));\r\n\r\n    // Sort by relevance (exact matches first, then starts with, then contains)\r\n    const searchLower = searchTerm.toLowerCase();\r\n    return filtered\r\n      .sort((a, b) => {\r\n        const aNameLower = String(a.name || '').toLowerCase();\r\n        const bNameLower = String(b.name || '').toLowerCase();\r\n        const aItemLower = String(a.itemNumber || '').toLowerCase();\r\n        const bItemLower = String(b.itemNumber || '').toLowerCase();\r\n\r\n        // Exact match on item number (highest priority)\r\n        if (aItemLower === searchLower) return -1;\r\n        if (bItemLower === searchLower) return 1;\r\n\r\n        // Exact match on name\r\n        if (aNameLower === searchLower) return -1;\r\n        if (bNameLower === searchLower) return 1;\r\n\r\n        // Starts with on item number\r\n        if (aItemLower.startsWith(searchLower) && !bItemLower.startsWith(searchLower)) return -1;\r\n        if (bItemLower.startsWith(searchLower) && !aItemLower.startsWith(searchLower)) return 1;\r\n\r\n        // Starts with on name\r\n        if (aNameLower.startsWith(searchLower) && !bNameLower.startsWith(searchLower)) return -1;\r\n        if (bNameLower.startsWith(searchLower) && !aNameLower.startsWith(searchLower)) return 1;\r\n\r\n        // Alphabetical by name\r\n        return aNameLower.localeCompare(bNameLower);\r\n      })\r\n      .slice(0, 100); // Increased to 100 suggestions for better user experience\r\n  }, [products, searchTerm]);\r\n\r\n  // Open panel when there are suggestions and search term is present\r\n  useEffect(() => {\r\n    if (searchTerm.length >= 1 && suggestions.length > 0) {\r\n      setIsOpen(true);\r\n    } else if (searchTerm.length === 0) {\r\n      setIsOpen(false);\r\n    }\r\n  }, [searchTerm, suggestions.length]);\r\n\r\n  const openPanel = () => {\r\n    setIsOpen(true);\r\n  };\r\n\r\n  const closePanel = () => {\r\n    setIsOpen(false);\r\n  };\r\n\r\n  return {\r\n    suggestions,\r\n    isOpen,\r\n    openPanel,\r\n    closePanel\r\n  };\r\n};\r\n","import { SaleItem } from '@/types';\r\n\r\n/**\r\n * Calculate the actual amount for a sale item after applying discounts\r\n */\r\nexport const calculateItemActualAmount = (item: SaleItem): number => {\r\n  const subtotal = item.price * item.quantity;\r\n  \r\n  let discountAmount = 0;\r\n  \r\n  // Handle cases where discountType is explicitly set\r\n  if (item.discountType === 'amount') {\r\n    discountAmount = Number(item.discountAmount) || 0;\r\n  } else if (item.discountType === 'percentage') {\r\n    const percentage = Number(item.discountPercentage) || 0;\r\n    discountAmount = (subtotal * percentage) / 100;\r\n  } \r\n  // Fallback: Infer discount type from available data (for legacy sales)\r\n  else if (!item.discountType) {\r\n    const percentage = Number(item.discountPercentage) || 0;\r\n    const amount = Number(item.discountAmount) || 0;\r\n    \r\n    if (percentage > 0) {\r\n      // Treat as percentage discount\r\n      discountAmount = (subtotal * percentage) / 100;\r\n    } else if (amount > 0) {\r\n      // Treat as amount discount\r\n      discountAmount = amount;\r\n    }\r\n  }\r\n  \r\n  return subtotal - discountAmount;\r\n};\r\n\r\n/**\r\n * Calculate the actual selling price per unit after discount\r\n */\r\nexport const calculateItemActualPrice = (item: SaleItem): number => {\r\n  const actualAmount = calculateItemActualAmount(item);\r\n  return actualAmount / item.quantity;\r\n};","import { useState, useMemo } from 'react';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { useSalesData } from '@/hooks/useSalesData';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { getDateRangeFromFilter } from '@/utils/dateFilters';\r\nimport { isSameDay } from 'date-fns';\r\nimport { calculateItemActualAmount, calculateItemActualPrice } from '@/utils/discountCalculations';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { getProductsAction } from '@/app/actions/products';\r\n\r\ninterface SoldItem {\r\n  description: string;\r\n  totalQuantity: number;\r\n  averagePrice: number;\r\n  totalAmount: number;\r\n  totalCost: number;\r\n  totalProfit: number;\r\n  totalDiscount: number;\r\n  averageCost?: number;\r\n  productIds: string[];\r\n}\r\n\r\nexport const useSoldItemsData = (\r\n  dateFilter: string,\r\n  dateRange: { from: Date | undefined; to: Date | undefined },\r\n  specificDate: Date | undefined,\r\n  showOnlyNotInInventory: boolean\r\n) => {\r\n  const { user } = useAuth();\r\n  const { currentBusiness } = useBusiness();\r\n  const { sales, isLoading: salesLoading, clearSoldItemsCache } = useSalesData(user?.id, 'desc');\r\n\r\n  // Fetch product inventory status for checking if items exist in inventory\r\n  const { data: dbInventoryMap, isLoading: inventoryLoading } = useQuery({\r\n    queryKey: ['inventory_check_map', currentBusiness?.id],\r\n    queryFn: async () => {\r\n      if (!currentBusiness?.id || !user?.id) return new Map<string, boolean>();\r\n\r\n      // Use the Prisma-backed server action instead of Supabase\r\n      const result = await getProductsAction({\r\n        userId: user.id,\r\n        businessId: currentBusiness.id,\r\n        pageSize: 1000, // Load enough to populate the map\r\n      });\r\n\r\n      const invMap = new Map<string, boolean>();\r\n      if (result && (result as any).products) {\r\n        ((result as any).products).forEach((p: any) => {\r\n          if (p.id) invMap.set(p.id, true);\r\n          if (p.name) invMap.set(p.name.trim().toLowerCase(), true);\r\n        });\r\n      }\r\n      return invMap;\r\n    },\r\n    enabled: !!currentBusiness?.id && !!user?.id,\r\n    staleTime: 5 * 60 * 1000, // 5 minutes\r\n    gcTime: 30 * 60 * 1000 // 30 minutes\r\n  });\r\n\r\n  // Calculate sold items derived from sales and inventory map\r\n  const soldItems = useMemo(() => {\r\n    if (!sales || sales.length === 0) return [];\r\n\r\n    let from: Date, to: Date;\r\n\r\n    if (dateFilter === 'specific-date' && specificDate) {\r\n      from = new Date(specificDate);\r\n      from.setHours(0, 0, 0, 0);\r\n      to = new Date(specificDate);\r\n      to.setHours(23, 59, 59, 999);\r\n    } else if (dateFilter === 'custom' && dateRange.from && dateRange.to) {\r\n      from = dateRange.from;\r\n      to = dateRange.to;\r\n    } else {\r\n      const range = getDateRangeFromFilter(dateFilter);\r\n      from = range.from;\r\n      to = range.to;\r\n    }\r\n\r\n    const filteredSales = sales.filter(sale => {\r\n      const saleDate = new Date(sale.date);\r\n      if (dateFilter === 'specific-date' && specificDate) {\r\n        return isSameDay(saleDate, specificDate) && sale.paymentStatus !== 'Quote';\r\n      }\r\n      return saleDate >= from && saleDate <= to && sale.paymentStatus !== 'Quote';\r\n    });\r\n\r\n    const itemsMap = new Map<string, { totalQuantity: number; totalAmount: number; totalCost: number; totalProfit: number; totalDiscount: number; prices: number[]; costs: number[]; productIds: string[] }>();\r\n\r\n    filteredSales.forEach(sale => {\r\n      sale.items.forEach(item => {\r\n        const key = item.description;\r\n        const subtotal = item.price * item.quantity;\r\n        const amount = calculateItemActualAmount(item);\r\n        const discount = subtotal - amount;\r\n        const cost = (item.cost || 0) * item.quantity;\r\n        const profit = amount - cost;\r\n        const actualPrice = calculateItemActualPrice(item);\r\n\r\n        if (itemsMap.has(key)) {\r\n          const existing = itemsMap.get(key)!;\r\n          existing.totalQuantity += item.quantity;\r\n          existing.totalAmount += amount;\r\n          existing.totalCost += cost;\r\n          existing.totalProfit += profit;\r\n          existing.totalDiscount += discount;\r\n          existing.prices.push(actualPrice);\r\n          existing.costs.push(item.cost || 0);\r\n          if (item.productId && !existing.productIds.includes(item.productId)) {\r\n            existing.productIds.push(item.productId);\r\n          }\r\n        } else {\r\n          itemsMap.set(key, {\r\n            totalQuantity: item.quantity,\r\n            totalAmount: amount,\r\n            totalCost: cost,\r\n            totalProfit: profit,\r\n            totalDiscount: discount,\r\n            prices: [actualPrice],\r\n            costs: [item.cost || 0],\r\n            productIds: item.productId ? [item.productId] : []\r\n          });\r\n        }\r\n      });\r\n    });\r\n\r\n    const result: SoldItem[] = Array.from(itemsMap.entries()).map(([description, data]) => ({\r\n      description,\r\n      totalQuantity: data.totalQuantity,\r\n      averagePrice: data.prices.reduce((sum, price) => sum + price, 0) / data.prices.length,\r\n      totalAmount: data.totalAmount,\r\n      totalCost: data.totalCost,\r\n      totalProfit: data.totalProfit,\r\n      totalDiscount: data.totalDiscount,\r\n      averageCost: data.costs.reduce((sum, cost) => sum + cost, 0) / data.costs.length,\r\n      productIds: data.productIds\r\n    }));\r\n\r\n    const sortedResult = result.sort((a, b) => b.totalAmount - a.totalAmount);\r\n\r\n    // Apply inventory filter if needed\r\n    if (showOnlyNotInInventory && dbInventoryMap) {\r\n      return sortedResult.filter(item => {\r\n        const existsById = item.productIds.some(id => dbInventoryMap.has(id));\r\n        if (existsById) return false;\r\n\r\n        const trimmedDesc = item.description.trim().toLowerCase();\r\n        return !dbInventoryMap.has(trimmedDesc);\r\n      });\r\n    }\r\n\r\n    return sortedResult;\r\n  }, [sales, dateFilter, dateRange, specificDate, dbInventoryMap, showOnlyNotInInventory]);\r\n\r\n  return {\r\n    soldItems,\r\n    isLoading: salesLoading || inventoryLoading,\r\n    loadSoldItemsData: () => {\r\n      // Force reload by invalidating sales query (since we rely on it)\r\n      clearSoldItemsCache(); // This helper from useSalesData will clear caches, but real reload comes from useSalesData invalidation\r\n    }\r\n  };\r\n};\r\n","\r\nimport { useState, useEffect } from 'react';\r\n\r\nexport interface MobileOptimizationConfig {\r\n  pageSize: number;\r\n  enableVirtualScrolling: boolean;\r\n  reducedAnimations: boolean;\r\n  compactView: boolean;\r\n}\r\n\r\nexport const useMobileOptimization = (): MobileOptimizationConfig => {\r\n  const [config, setConfig] = useState<MobileOptimizationConfig>({\r\n    pageSize: 20, // Increased default page size\r\n    enableVirtualScrolling: false,\r\n    reducedAnimations: false,\r\n    compactView: false\r\n  });\r\n\r\n  useEffect(() => {\r\n    const updateConfig = () => {\r\n      const isMobile = window.innerWidth < 768;\r\n      const isSlowConnection = 'connection' in navigator && \r\n        (navigator as any).connection?.effectiveType === 'slow-2g' || \r\n        (navigator as any).connection?.effectiveType === '2g';\r\n\r\n      setConfig({\r\n        pageSize: isMobile ? 15 : 20, // Increased page sizes but keep them reasonable\r\n        enableVirtualScrolling: isMobile,\r\n        reducedAnimations: isSlowConnection,\r\n        compactView: isMobile\r\n      });\r\n    };\r\n\r\n    updateConfig();\r\n    window.addEventListener('resize', updateConfig);\r\n    \r\n    return () => window.removeEventListener('resize', updateConfig);\r\n  }, []);\r\n\r\n  return config;\r\n};\r\n","\r\ninterface SoldItem {\r\n  description: string;\r\n  totalQuantity: number;\r\n  averagePrice: number;\r\n  totalAmount: number;\r\n  totalCost: number;\r\n  totalProfit: number;\r\n  totalDiscount: number;\r\n  averageCost?: number;\r\n}\r\n\r\nexport const exportSoldItemsToCSV = (soldItems: SoldItem[], period: string, currency: string = 'USD', costOnlyMode: boolean = false) => {\r\n  // Create CSV header based on mode\r\n  const headers = costOnlyMode \r\n    ? ['Item', 'Quantity', 'Average Cost', 'Total Cost']\r\n    : ['Item', 'Quantity', 'Average Price', 'Total Amount', 'Discount', 'Cost Amount', 'Profit'];\r\n  \r\n  // Number formatter without currency symbol and no decimal points\r\n  const numberFormatter = new Intl.NumberFormat('en-US', {\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0\r\n  });\r\n  \r\n  // Create CSV rows with clean numeric values based on mode\r\n  const rows = soldItems.map(item => {\r\n    if (costOnlyMode) {\r\n      return [\r\n        item.description,\r\n        item.totalQuantity.toString(),\r\n        numberFormatter.format(item.averageCost || 0),\r\n        numberFormatter.format(item.totalCost)\r\n      ];\r\n    } else {\r\n      return [\r\n        item.description,\r\n        item.totalQuantity.toString(),\r\n        numberFormatter.format(item.averagePrice),\r\n        numberFormatter.format(item.totalAmount),\r\n        numberFormatter.format(item.totalDiscount),\r\n        numberFormatter.format(item.totalCost),\r\n        numberFormatter.format(item.totalProfit)\r\n      ];\r\n    }\r\n  });\r\n  \r\n  // Add summary row based on mode\r\n  const totalQuantity = soldItems.reduce((sum, item) => sum + item.totalQuantity, 0);\r\n  const totalAmount = soldItems.reduce((sum, item) => sum + item.totalAmount, 0);\r\n  const totalDiscount = soldItems.reduce((sum, item) => sum + item.totalDiscount, 0);\r\n  const totalCost = soldItems.reduce((sum, item) => sum + item.totalCost, 0);\r\n  const totalProfit = soldItems.reduce((sum, item) => sum + item.totalProfit, 0);\r\n  \r\n  rows.push(['']); // Empty row\r\n  rows.push(['SUMMARY', '', '', '', '', '', '']);\r\n  rows.push(['Total Items', soldItems.length.toString(), '', '', '', '', '']);\r\n  rows.push(['Total Quantity', totalQuantity.toString(), '', '', '', '', '']);\r\n  \r\n  if (costOnlyMode) {\r\n    rows.push(['Total Cost', '', '', numberFormatter.format(totalCost)]);\r\n  } else {\r\n    rows.push(['Total Revenue', '', '', numberFormatter.format(totalAmount), '', '', '']);\r\n    rows.push(['Total Discount', '', '', '', numberFormatter.format(totalDiscount), '', '']);\r\n    rows.push(['Total Cost', '', '', '', '', numberFormatter.format(totalCost), '']);\r\n    rows.push(['Total Profit', '', '', '', '', '', numberFormatter.format(totalProfit)]);\r\n  }\r\n  \r\n  // Combine headers and rows\r\n  const csvContent = [headers, ...rows]\r\n    .map(row => row.map(cell => `\"${cell}\"`).join(','))\r\n    .join('\\n');\r\n  \r\n  // Create and download the file\r\n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n  const link = document.createElement('a');\r\n  const url = URL.createObjectURL(blob);\r\n  \r\n  const modePrefix = costOnlyMode ? 'cost_data_' : '';\r\n  link.setAttribute('href', url);\r\n  link.setAttribute('download', `${modePrefix}sold_items_${period.replace(/\\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.csv`);\r\n  link.style.visibility = 'hidden';\r\n  \r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n};\r\n","import { formatCashCurrency } from '@/lib/utils';\r\nimport { format } from 'date-fns';\r\nimport jsPDF from 'jspdf';\r\n\r\ninterface SoldItem {\r\n  description: string;\r\n  totalQuantity: number;\r\n  averagePrice: number;\r\n  totalAmount: number;\r\n  totalCost?: number;\r\n  totalProfit?: number;\r\n  totalDiscount?: number;\r\n}\r\n\r\nexport const exportSoldItemsToPDF = (\r\n  soldItems: SoldItem[], \r\n  period: string, \r\n  currency: string = 'USD', \r\n  costOnlyMode: boolean = false,\r\n  dateRange?: { from: Date | undefined; to: Date | undefined },\r\n  businessSettings?: {\r\n    businessName: string;\r\n    businessAddress: string;\r\n    businessPhone: string;\r\n    businessEmail: string;\r\n  }\r\n) => {\r\n  // Create new PDF document in portrait orientation\r\n  const pdf = new jsPDF({\r\n    orientation: 'portrait',\r\n    unit: 'mm',\r\n    format: 'a4',\r\n    compress: true\r\n  });\r\n\r\n  const pageWidth = pdf.internal.pageSize.getWidth();\r\n  const pageHeight = pdf.internal.pageSize.getHeight();\r\n  const margins = { top: 15, right: 15, bottom: 15, left: 15 };\r\n  const contentWidth = pageWidth - margins.left - margins.right;\r\n  \r\n  let currentY = margins.top;\r\n\r\n  // Table setup - adjusted column widths based on mode\r\n  const colWidths = costOnlyMode \r\n    ? [60, 30, 40, 40] // Item, Quantity, Avg Cost, Total Cost\r\n    : [38, 18, 22, 22, 20, 20, 20]; // Item, Quantity, Avg Price, Total, Discount, Cost, Profit\r\n  const rowHeight = 8;\r\n  const headerHeight = 10;\r\n\r\n  // Table headers based on mode\r\n  const headers = costOnlyMode\r\n    ? ['Item', 'Quantity', 'Avg Cost', 'Total Cost']\r\n    : ['Item', 'Quantity', 'Avg Price', 'Total', 'Discount', 'Cost', 'Profit'];\r\n\r\n  // Function to add watermark to current page\r\n  const addWatermark = () => {\r\n    pdf.setFontSize(8);\r\n    pdf.setFont('helvetica', 'normal');\r\n    pdf.setTextColor(150, 150, 150); // Light gray color\r\n    pdf.text('Created By Gonza Systems', pageWidth / 2, pageHeight - 10, { align: 'center' });\r\n    pdf.setTextColor(0, 0, 0); // Reset to black\r\n  };\r\n\r\n  // Function to draw table headers\r\n  const drawTableHeaders = () => {\r\n    // Draw header background\r\n    pdf.setFillColor(243, 244, 246);\r\n    pdf.rect(margins.left, currentY - 2, contentWidth, headerHeight, 'F');\r\n\r\n    // Draw header borders\r\n    pdf.setLineWidth(0.3);\r\n    pdf.rect(margins.left, currentY - 2, contentWidth, headerHeight);\r\n\r\n    // Header text\r\n    pdf.setFontSize(10);\r\n    pdf.setFont('helvetica', 'bold');\r\n    let currentX = margins.left;\r\n    \r\n    headers.forEach((header, index) => {\r\n      const colWidth = colWidths[index];\r\n      const textWidth = pdf.getTextWidth(header);\r\n      const textX = currentX + (colWidth - textWidth) / 2;\r\n      pdf.text(header, textX, currentY + 6);\r\n      \r\n      if (index < headers.length - 1) {\r\n        pdf.line(currentX + colWidth, currentY - 2, currentX + colWidth, currentY + headerHeight - 2);\r\n      }\r\n      \r\n      currentX += colWidth;\r\n    });\r\n\r\n    currentY += headerHeight;\r\n  };\r\n\r\n  // Helper function to check if we need a new page\r\n  const checkPageBreak = (neededHeight: number) => {\r\n    if (currentY + neededHeight > pageHeight - margins.bottom - 15) { // Reserve space for watermark\r\n      addWatermark(); // Add watermark to current page before creating new one\r\n      pdf.addPage();\r\n      currentY = margins.top;\r\n      drawTableHeaders(); // Add headers to new page\r\n      // Reset font to normal after drawing headers on new page\r\n      pdf.setFont('helvetica', 'normal');\r\n      pdf.setFontSize(9);\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  // Header section with business details on left and title on right\r\n  const headerStartY = currentY;\r\n  \r\n  // Business details on the left\r\n  if (businessSettings) {\r\n    pdf.setFontSize(12);\r\n    pdf.setFont('helvetica', 'bold');\r\n    pdf.text(businessSettings.businessName, margins.left, currentY);\r\n    currentY += 6;\r\n    \r\n    pdf.setFontSize(9);\r\n    pdf.setFont('helvetica', 'normal');\r\n    pdf.text(businessSettings.businessAddress, margins.left, currentY);\r\n    currentY += 5;\r\n    pdf.text(businessSettings.businessPhone, margins.left, currentY);\r\n    currentY += 5;\r\n    pdf.text(businessSettings.businessEmail, margins.left, currentY);\r\n  }\r\n  \r\n  // Reset currentY to header start for right-aligned content\r\n  currentY = headerStartY;\r\n  \r\n  // Title on the right\r\n  pdf.setFontSize(18);\r\n  pdf.setFont('helvetica', 'bold');\r\n  const title = costOnlyMode \r\n    ? `Items Cost Report (${currency})`\r\n    : `Items Sold Report (${currency})`;\r\n  const titleWidth = pdf.getTextWidth(title);\r\n  pdf.text(title, pageWidth - margins.right - titleWidth, currentY);\r\n  currentY += 10;\r\n\r\n  // Date range display - right aligned under title\r\n  if (dateRange?.from && dateRange?.to) {\r\n    pdf.setFontSize(12);\r\n    pdf.setFont('helvetica', 'normal');\r\n    const fromDate = format(dateRange.from, 'dd/MM/yyyy');\r\n    const toDate = format(dateRange.to, 'dd/MM/yyyy');\r\n    \r\n    const dateText = fromDate === toDate ? fromDate : `${fromDate} - ${toDate}`;\r\n    const dateWidth = pdf.getTextWidth(dateText);\r\n    pdf.text(dateText, pageWidth - margins.right - dateWidth, currentY);\r\n    currentY += 12;\r\n  } else {\r\n    // Fallback to current date if no range provided\r\n    pdf.setFontSize(12);\r\n    pdf.setFont('helvetica', 'normal');\r\n    const dateText = format(new Date(), 'dd/MM/yyyy');\r\n    const dateWidth = pdf.getTextWidth(dateText);\r\n    pdf.text(dateText, pageWidth - margins.right - dateWidth, currentY);\r\n    currentY += 12;\r\n  }\r\n  \r\n  // Ensure we have enough space for both sections\r\n  currentY = Math.max(currentY, headerStartY + 25);\r\n\r\n  if (soldItems.length === 0) {\r\n    // No data message\r\n    pdf.setFontSize(14);\r\n    pdf.setFont('helvetica', 'normal');\r\n    const noDataText = 'No items sold in the selected period.';\r\n    const noDataWidth = pdf.getTextWidth(noDataText);\r\n    pdf.text(noDataText, (pageWidth - noDataWidth) / 2, currentY + 30);\r\n  } else {\r\n    // Draw initial table headers\r\n    checkPageBreak(headerHeight + 10);\r\n    drawTableHeaders();\r\n\r\n    // Table data\r\n    pdf.setFont('helvetica', 'normal');\r\n    pdf.setFontSize(8);\r\n\r\n    // Number formatter without currency symbol and no decimal points\r\n    const numberFormatter = new Intl.NumberFormat('en-US', {\r\n      minimumFractionDigits: 0,\r\n      maximumFractionDigits: 0\r\n    });\r\n\r\n    soldItems.forEach((item, index) => {\r\n      checkPageBreak(rowHeight + 5);\r\n\r\n      const rowData = costOnlyMode\r\n        ? [\r\n            item.description,\r\n            item.totalQuantity.toString(),\r\n            numberFormatter.format(item.totalCost / item.totalQuantity), // Average cost\r\n            numberFormatter.format(item.totalCost)\r\n          ]\r\n        : [\r\n            item.description,\r\n            item.totalQuantity.toString(),\r\n            numberFormatter.format(item.averagePrice),\r\n            numberFormatter.format(item.totalAmount),\r\n            numberFormatter.format(item.totalDiscount || 0),\r\n            numberFormatter.format(item.totalCost || 0),\r\n            numberFormatter.format(item.totalProfit || 0)\r\n          ];\r\n\r\n      // Draw row background (alternating)\r\n      if (index % 2 === 0) {\r\n        pdf.setFillColor(249, 250, 251);\r\n        pdf.rect(margins.left, currentY - 1, contentWidth, rowHeight, 'F');\r\n      }\r\n\r\n      // Draw row borders\r\n      pdf.setLineWidth(0.1);\r\n      pdf.rect(margins.left, currentY - 1, contentWidth, rowHeight);\r\n\r\n      let currentX = margins.left;\r\n      \r\n      rowData.forEach((data, colIndex) => {\r\n        const colWidth = colWidths[colIndex];\r\n        let text = data;\r\n        \r\n        // Truncate text if too long\r\n        if (colIndex === 0) { // Item description\r\n          while (pdf.getTextWidth(text) > colWidth - 4 && text.length > 3) {\r\n            text = text.substring(0, text.length - 4) + '...';\r\n          }\r\n        }\r\n        \r\n        let textX = currentX + 2;\r\n        \r\n        // Center align numeric columns (Quantity, Avg Price, Total Amount, Cost Amount, Profit)\r\n        if (colIndex >= 1) {\r\n          const textWidth = pdf.getTextWidth(text);\r\n          textX = currentX + (colWidth - textWidth) / 2;\r\n        }\r\n        \r\n        pdf.text(text, textX, currentY + 5);\r\n        \r\n        if (colIndex < rowData.length - 1) {\r\n          pdf.line(currentX + colWidth, currentY - 1, currentX + colWidth, currentY + rowHeight - 1);\r\n        }\r\n        \r\n        currentX += colWidth;\r\n      });\r\n\r\n      currentY += rowHeight;\r\n    });\r\n\r\n    // Summary section\r\n    currentY += 10;\r\n    checkPageBreak(45);\r\n\r\n    // Summary title\r\n    pdf.setFontSize(16);\r\n    pdf.setFont('helvetica', 'bold');\r\n    pdf.text('Summary', margins.left, currentY);\r\n    currentY += 8;\r\n\r\n    // Calculate totals\r\n    const totalItems = soldItems.length;\r\n    const totalQuantity = soldItems.reduce((sum, item) => sum + item.totalQuantity, 0);\r\n    const totalRevenue = soldItems.reduce((sum, item) => sum + item.totalAmount, 0);\r\n    const totalDiscount = soldItems.reduce((sum, item) => sum + (item.totalDiscount || 0), 0);\r\n    const totalCost = soldItems.reduce((sum, item) => sum + (item.totalCost || 0), 0);\r\n    const totalProfit = soldItems.reduce((sum, item) => sum + (item.totalProfit || 0), 0);\r\n\r\n    // Draw summary box - make it wider to accommodate all content properly\r\n    const summaryBoxHeight = costOnlyMode ? 32 : 56;\r\n    const summaryBoxWidth = contentWidth;\r\n    \r\n    pdf.setFillColor(248, 249, 250);\r\n    pdf.rect(margins.left, currentY - 3, summaryBoxWidth, summaryBoxHeight, 'F');\r\n    pdf.setLineWidth(0.3);\r\n    pdf.setDrawColor(200, 200, 200);\r\n    pdf.rect(margins.left, currentY - 3, summaryBoxWidth, summaryBoxHeight);\r\n\r\n    // Summary data in columns based on mode\r\n    pdf.setFontSize(11);\r\n    pdf.setFont('helvetica', 'normal');\r\n    \r\n    const summaryData = costOnlyMode\r\n      ? [\r\n          ['Total Items:', totalItems.toString()],\r\n          ['Total Quantity:', totalQuantity.toString()],\r\n          ['Total Cost:', numberFormatter.format(totalCost)]\r\n        ]\r\n      : [\r\n          ['Total Items:', totalItems.toString()],\r\n          ['Total Quantity:', totalQuantity.toString()],\r\n          ['Total Revenue:', numberFormatter.format(totalRevenue)],\r\n          ['Total Discount:', numberFormatter.format(totalDiscount)],\r\n          ['Total Cost:', numberFormatter.format(totalCost)],\r\n          ['Total Profit:', numberFormatter.format(totalProfit)]\r\n        ];\r\n\r\n    let summaryY = currentY + 6;\r\n    const summaryX = margins.left + 15;\r\n\r\n    summaryData.forEach(([label, value]) => {\r\n      pdf.setFont('helvetica', 'bold');\r\n      pdf.text(label, summaryX, summaryY);\r\n      pdf.setFont('helvetica', 'normal');\r\n      const labelWidth = pdf.getTextWidth(label);\r\n      const valueX = summaryX + labelWidth + 5;\r\n      \r\n      // Fixed logic: Ensure the value text stays within the summary box bounds\r\n      const maxX = margins.left + summaryBoxWidth - 15;\r\n      const valueWidth = pdf.getTextWidth(value);\r\n      \r\n      // Check if text would overflow, if so right-align it within bounds\r\n      let finalX;\r\n      if (valueX + valueWidth > maxX) {\r\n        finalX = maxX - valueWidth;\r\n      } else {\r\n        finalX = valueX;\r\n      }\r\n      \r\n      pdf.text(value, finalX, summaryY);\r\n      summaryY += 8;\r\n    });\r\n  }\r\n\r\n  // Add watermark to the final page\r\n  addWatermark();\r\n\r\n  // Generate filename based on report date range\r\n  let filename: string;\r\n  const modePrefix = costOnlyMode ? 'cost_data_' : '';\r\n  \r\n  if (dateRange?.from && dateRange?.to) {\r\n    const fromDate = format(dateRange.from, 'yyyy-MM-dd');\r\n    const toDate = format(dateRange.to, 'yyyy-MM-dd');\r\n    \r\n    if (fromDate === toDate) {\r\n      filename = `${modePrefix}sold_items_${fromDate}.pdf`;\r\n    } else {\r\n      filename = `${modePrefix}sold_items_${fromDate}_to_${toDate}.pdf`;\r\n    }\r\n  } else {\r\n    // Fallback to current date if no range provided\r\n    filename = `${modePrefix}sold_items_${format(new Date(), 'yyyy-MM-dd')}.pdf`;\r\n  }\r\n\r\n  pdf.save(filename);\r\n};\r\n","\r\nimport React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Edit, Printer } from 'lucide-react';\r\nimport { formatCashCurrency } from '@/lib/utils';\r\nimport { format, isSameDay } from 'date-fns';\r\nimport { Sale } from '@/types';\r\nimport { getDateRangeFromFilter } from '@/utils/dateFilters';\r\nimport ReceiptDialog from '@/components/sales/ReceiptDialog';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\ninterface ItemSalesDialogProps {\r\n  isOpen: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  itemDescription: string;\r\n  sales: Sale[];\r\n  currency: string;\r\n  dateFilter: string;\r\n  dateRange: { from: Date | undefined; to: Date | undefined; };\r\n  specificDate: Date | undefined;\r\n}\r\n\r\nconst ItemSalesDialog: React.FC<ItemSalesDialogProps> = ({\r\n  isOpen,\r\n  onOpenChange,\r\n  itemDescription,\r\n  sales,\r\n  currency,\r\n  dateFilter,\r\n  dateRange,\r\n  specificDate\r\n}) => {\r\n  const navigate = useNavigate();\r\n  const { hasPermission } = useProfiles();\r\n  const { canViewSellingPrice } = useFinancialVisibility();\r\n  const [selectedSale, setSelectedSale] = useState<Sale | null>(null);\r\n  const [isReceiptOpen, setIsReceiptOpen] = useState(false);\r\n\r\n  // Apply the same date filtering logic as in SoldItemsTab\r\n  const getFilteredSales = () => {\r\n    let from: Date, to: Date;\r\n\r\n    if (dateFilter === 'specific-date' && specificDate) {\r\n      // Use the specific date for both from and to\r\n      from = new Date(specificDate);\r\n      from.setHours(0, 0, 0, 0);\r\n      to = new Date(specificDate);\r\n      to.setHours(23, 59, 59, 999);\r\n    } else if (dateFilter === 'custom' && dateRange.from && dateRange.to) {\r\n      // Use the custom date range\r\n      from = dateRange.from;\r\n      to = dateRange.to;\r\n    } else {\r\n      // Use predefined date filter\r\n      const range = getDateRangeFromFilter(dateFilter);\r\n      from = range.from;\r\n      to = range.to;\r\n    }\r\n\r\n    // Filter sales by date range and exclude quotes, then filter by item\r\n    const filteredSales = sales.filter(sale => {\r\n      const saleDate = new Date(sale.date);\r\n\r\n      let dateMatches = false;\r\n      if (dateFilter === 'specific-date' && specificDate) {\r\n        dateMatches = isSameDay(saleDate, specificDate);\r\n      } else {\r\n        dateMatches = saleDate >= from && saleDate <= to;\r\n      }\r\n\r\n      const hasItem = sale.items.some(item => item.description === itemDescription);\r\n      const isNotQuote = sale.paymentStatus !== 'Quote';\r\n\r\n      return dateMatches && hasItem && isNotQuote;\r\n    });\r\n\r\n    return filteredSales;\r\n  };\r\n\r\n  const relevantSales = getFilteredSales();\r\n\r\n  const handleEditSale = (sale: Sale) => {\r\n    navigate('/new-sale', { state: { editSale: sale } });\r\n    onOpenChange(false); // Close the dialog\r\n  };\r\n\r\n  const handleViewReceipt = (sale: Sale) => {\r\n    setSelectedSale(sale);\r\n    setIsReceiptOpen(true);\r\n  };\r\n\r\n  const handleCloseReceipt = () => {\r\n    setIsReceiptOpen(false);\r\n    setSelectedSale(null);\r\n  };\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-5xl max-h-[80vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle>Sales for \"{itemDescription}\"</DialogTitle>\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            {relevantSales.length} sale{relevantSales.length !== 1 ? 's' : ''} found in the selected period\r\n          </p>\r\n        </DialogHeader>\r\n\r\n        {relevantSales.length === 0 ? (\r\n          <div className=\"text-center py-8 text-muted-foreground\">\r\n            No sales found for this item in the selected period.\r\n          </div>\r\n        ) : (\r\n          <div className=\"overflow-x-auto\">\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Date</TableHead>\r\n                  <TableHead>Receipt #</TableHead>\r\n                  <TableHead>Customer</TableHead>\r\n                  <TableHead className=\"text-right\">Quantity</TableHead>\r\n                  <TableHead className=\"text-right\">Unit Price</TableHead>\r\n                  <TableHead className=\"text-right\">Total</TableHead>\r\n                  <TableHead>Status</TableHead>\r\n                  <TableHead className=\"text-center\">Actions</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {relevantSales.map((sale) => {\r\n                  const item = sale.items.find(item => item.description === itemDescription);\r\n                  if (!item) return null;\r\n\r\n                  return (\r\n                    <TableRow key={sale.id}>\r\n                      <TableCell>{format(sale.date, 'MMM d, yyyy')}</TableCell>\r\n                      <TableCell className=\"font-medium\">#{sale.receiptNumber}</TableCell>\r\n                      <TableCell>{sale.customerName}</TableCell>\r\n                      <TableCell className=\"text-right\">{item.quantity}</TableCell>\r\n                      <TableCell className=\"text-right\">\r\n                        {canViewSellingPrice ? formatCashCurrency(item.price, currency) : ''}\r\n                      </TableCell>\r\n                      <TableCell className=\"text-right\">\r\n                        {canViewSellingPrice ? formatCashCurrency(item.price * item.quantity, currency) : ''}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge\r\n                          variant={\r\n                            sale.paymentStatus === 'Paid' ? 'default' :\r\n                              sale.paymentStatus === 'NOT PAID' ? 'destructive' :\r\n                                'secondary'\r\n                          }\r\n                        >\r\n                          {sale.paymentStatus}\r\n                        </Badge>\r\n                      </TableCell>\r\n                      <TableCell className=\"text-center\">\r\n                        <div className=\"flex justify-center gap-1\">\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleViewReceipt(sale)}\r\n                            className=\"h-8 w-8 p-0\"\r\n                            title=\"View Receipt\"\r\n                          >\r\n                            <Printer className=\"h-4 w-4\" />\r\n                            <span className=\"sr-only\">View Receipt</span>\r\n                          </Button>\r\n                          {hasPermission('sales', 'edit') && (\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleEditSale(sale)}\r\n                              className=\"h-8 w-8 p-0\"\r\n                              title=\"Edit Sale\"\r\n                            >\r\n                              <Edit className=\"h-4 w-4\" />\r\n                              <span className=\"sr-only\">Edit Sale</span>\r\n                            </Button>\r\n                          )}\r\n                        </div>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  );\r\n                })}\r\n              </TableBody>\r\n            </Table>\r\n          </div>\r\n        )}\r\n      </DialogContent>\r\n\r\n      {/* Receipt Dialog */}\r\n      <ReceiptDialog\r\n        isOpen={isReceiptOpen}\r\n        sale={selectedSale}\r\n        currency={currency}\r\n        onOpenChange={handleCloseReceipt}\r\n      />\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ItemSalesDialog;\r\n","import React, { useState, useMemo, useEffect, useCallback } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Download, FileText, CalendarIcon, Search } from 'lucide-react';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useSalesData } from '@/hooks/useSalesData';\r\nimport { useSoldItemsData } from '@/hooks/useSoldItemsData';\r\nimport { useMobileOptimization } from '@/hooks/useMobileOptimization';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { formatNumber, formatCashCurrency } from '@/lib/utils';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport DateRangeFilter from '@/components/sales/DateRangeFilter';\r\nimport { exportSoldItemsToCSV } from '@/utils/exportSoldItemsToCSV';\r\nimport { exportSoldItemsToPDF } from '@/utils/exportSoldItemsToPDF';\r\nimport { Skeleton } from '@/components/ui/skeleton';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\r\nimport { Calendar } from '@/components/ui/calendar';\r\nimport { cn } from '@/lib/utils';\r\nimport { format } from 'date-fns';\r\nimport ItemSalesDialog from './ItemSalesDialog';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { getDateRangeFromFilter } from '@/utils/dateFilters';\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\nconst SoldItemsTab = () => {\r\n  const { user } = useAuth();\r\n  const { currentBusiness } = useBusiness();\r\n  const mobileConfig = useMobileOptimization();\r\n  const { sales } = useSalesData(user?.id, 'desc'); // Load all sales without pagination limit\r\n  const { settings, isLoading: settingsLoading } = useBusinessSettings();\r\n  const { canViewCostPrice, canViewProfit, canViewSellingPrice } = useFinancialVisibility();\r\n  const { toast } = useToast();\r\n\r\n  const FILTER_STORAGE_KEY = useMemo(() =>\r\n    currentBusiness?.id ? `soldItemsFilters_${currentBusiness.id}` : 'soldItemsFilters'\r\n    , [currentBusiness?.id]);\r\n\r\n  // Load persisted state from localStorage with mobile optimization\r\n  const getPersistedState = useCallback(() => {\r\n    try {\r\n      const saved = localStorage.getItem(FILTER_STORAGE_KEY);\r\n      if (saved) {\r\n        const parsed = JSON.parse(saved);\r\n        return {\r\n          dateFilter: parsed.dateFilter || 'this-month',\r\n          dateRange: parsed.dateRange ? {\r\n            from: parsed.dateRange.from ? new Date(parsed.dateRange.from) : undefined,\r\n            to: parsed.dateRange.to ? new Date(parsed.dateRange.to) : undefined\r\n          } : { from: undefined, to: undefined },\r\n          specificDate: parsed.specificDate ? new Date(parsed.specificDate) : undefined,\r\n          showOnlyNotInInventory: parsed.showOnlyNotInInventory || false,\r\n          showOnlyCostData: parsed.showOnlyCostData || false\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading persisted sold items filters:', error);\r\n    }\r\n    return {\r\n      dateFilter: 'this-month',\r\n      dateRange: { from: undefined, to: undefined },\r\n      specificDate: undefined,\r\n      showOnlyNotInInventory: false,\r\n      showOnlyCostData: false\r\n    };\r\n  }, [FILTER_STORAGE_KEY]);\r\n\r\n  const persistedState = useMemo(() => getPersistedState(), [getPersistedState]);\r\n  const [dateFilter, setDateFilter] = useState<string>(persistedState.dateFilter);\r\n  const [dateRange, setDateRange] = useState<{ from: Date | undefined; to: Date | undefined; }>(persistedState.dateRange);\r\n  const [specificDate, setSpecificDate] = useState<Date | undefined>(persistedState.specificDate);\r\n  const [selectedItem, setSelectedItem] = useState<string | null>(null);\r\n  const [isItemSalesDialogOpen, setIsItemSalesDialogOpen] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [showOnlyNotInInventory, setShowOnlyNotInInventory] = useState(persistedState.showOnlyNotInInventory);\r\n  const [showOnlyCostData, setShowOnlyCostData] = useState(persistedState.showOnlyCostData);\r\n\r\n  // Use the new hook for sold items data\r\n  const { soldItems, isLoading } = useSoldItemsData(\r\n    dateFilter,\r\n    dateRange,\r\n    specificDate,\r\n    showOnlyNotInInventory\r\n  );\r\n\r\n  // Persist state to localStorage whenever filters change\r\n  useEffect(() => {\r\n    const stateToSave = {\r\n      dateFilter,\r\n      dateRange: {\r\n        from: dateRange.from?.toISOString(),\r\n        to: dateRange.to?.toISOString()\r\n      },\r\n      specificDate: specificDate?.toISOString(),\r\n      showOnlyNotInInventory,\r\n      showOnlyCostData\r\n    };\r\n    localStorage.setItem(FILTER_STORAGE_KEY, JSON.stringify(stateToSave));\r\n  }, [dateFilter, dateRange, specificDate, showOnlyNotInInventory, showOnlyCostData, FILTER_STORAGE_KEY]);\r\n\r\n  // Optimized search filtering with debouncing effect\r\n  const filteredSoldItems = useMemo(() => {\r\n    if (!searchQuery.trim()) {\r\n      return soldItems;\r\n    }\r\n\r\n    const query = searchQuery.toLowerCase();\r\n    return soldItems.filter(item =>\r\n      item.description.toLowerCase().includes(query)\r\n    );\r\n  }, [soldItems, searchQuery]);\r\n\r\n  // Handle export to CSV\r\n  const handleExportToCSV = () => {\r\n    let dateRangeForExport: { from: Date | undefined; to: Date | undefined };\r\n\r\n    if (dateFilter === 'specific-date' && specificDate) {\r\n      dateRangeForExport = {\r\n        from: specificDate,\r\n        to: specificDate\r\n      };\r\n    } else if (dateFilter === 'custom' && dateRange.from && dateRange.to) {\r\n      dateRangeForExport = dateRange;\r\n    } else {\r\n      const range = getDateRangeFromFilter(dateFilter);\r\n      dateRangeForExport = range;\r\n    }\r\n\r\n    exportSoldItemsToCSV(filteredSoldItems, 'Current Period', settings.currency, showOnlyCostData);\r\n    toast({\r\n      title: \"Export successful\",\r\n      description: \"Sold items exported to CSV file.\",\r\n    });\r\n  };\r\n\r\n  // Handle export to PDF\r\n  const handleExportToPDF = () => {\r\n    // Don't export if settings are still loading\r\n    if (settingsLoading) {\r\n      toast({\r\n        title: \"Please wait\",\r\n        description: \"Business settings are still loading. Please try again in a moment.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    let dateRangeForExport: { from: Date | undefined; to: Date | undefined };\r\n\r\n    if (dateFilter === 'specific-date' && specificDate) {\r\n      dateRangeForExport = {\r\n        from: specificDate,\r\n        to: specificDate\r\n      };\r\n    } else if (dateFilter === 'custom' && dateRange.from && dateRange.to) {\r\n      dateRangeForExport = dateRange;\r\n    } else {\r\n      const range = getDateRangeFromFilter(dateFilter);\r\n      dateRangeForExport = range;\r\n    }\r\n\r\n    exportSoldItemsToPDF(filteredSoldItems, 'Current Period', settings.currency, showOnlyCostData, dateRangeForExport, {\r\n      businessName: settings.businessName,\r\n      businessAddress: settings.businessAddress,\r\n      businessPhone: settings.businessPhone,\r\n      businessEmail: settings.businessEmail\r\n    });\r\n    toast({\r\n      title: \"Export successful\",\r\n      description: \"Sold items exported to PDF file.\",\r\n    });\r\n  };\r\n\r\n  // Get period display text\r\n  const getPeriodDisplayText = () => {\r\n    if (dateFilter === 'specific-date' && specificDate) {\r\n      return format(specificDate, 'dd/MM/yyyy');\r\n    } else if (dateFilter === 'custom' && dateRange.from && dateRange.to) {\r\n      return `${format(dateRange.from, 'dd/MM/yyyy')} to ${format(dateRange.to, 'dd/MM/yyyy')}`;\r\n    } else {\r\n      const range = getDateRangeFromFilter(dateFilter);\r\n      if (range.from.toDateString() === range.to.toDateString()) {\r\n        return format(range.from, 'dd/MM/yyyy');\r\n      } else {\r\n        return `${format(range.from, 'dd/MM/yyyy')} to ${format(range.to, 'dd/MM/yyyy')}`;\r\n      }\r\n    }\r\n  };\r\n\r\n  // Handle item click\r\n  const handleItemClick = (itemDescription: string) => {\r\n    setSelectedItem(itemDescription);\r\n    setIsItemSalesDialogOpen(true);\r\n  };\r\n\r\n  // Handle inventory filter change\r\n  const handleInventoryFilterChange = (checked: boolean | 'indeterminate') => {\r\n    setShowOnlyNotInInventory(checked === true);\r\n  };\r\n\r\n  // Handle cost data filter change\r\n  const handleCostDataFilterChange = (checked: boolean | 'indeterminate') => {\r\n    setShowOnlyCostData(checked === true);\r\n  };\r\n\r\n  // Optimized loading skeleton for mobile\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex justify-between items-center\">\r\n          <Skeleton className=\"h-8 w-32\" />\r\n          <div className=\"flex gap-2\">\r\n            <Skeleton className=\"h-8 w-20\" />\r\n            <Skeleton className=\"h-8 w-20\" />\r\n          </div>\r\n        </div>\r\n        <Skeleton className=\"h-48\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <TooltipProvider>\r\n      <div className=\"space-y-6\">\r\n        {/* Optimized filter controls for mobile */}\r\n        <div className=\"flex flex-col gap-4\">\r\n          <div className=\"flex flex-col md:flex-row gap-4 items-start md:items-center\">\r\n            <Select value={dateFilter} onValueChange={setDateFilter}>\r\n              <SelectTrigger className=\"w-full md:w-48\">\r\n                <SelectValue placeholder=\"Select period\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"today\">Today</SelectItem>\r\n                <SelectItem value=\"yesterday\">Yesterday</SelectItem>\r\n                <SelectItem value=\"this-week\">This Week</SelectItem>\r\n                <SelectItem value=\"last-week\">Last Week</SelectItem>\r\n                <SelectItem value=\"this-month\">This Month</SelectItem>\r\n                <SelectItem value=\"last-month\">Last Month</SelectItem>\r\n                <SelectItem value=\"this-year\">This Year</SelectItem>\r\n                <SelectItem value=\"specific-date\">Specific Date</SelectItem>\r\n                <SelectItem value=\"custom\">Custom Range</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n\r\n            {dateFilter === 'specific-date' && (\r\n              <div className=\"w-full md:w-auto\">\r\n                <Popover>\r\n                  <PopoverTrigger asChild>\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      className={cn(\r\n                        \"w-full md:w-[240px] justify-start text-left font-normal bg-white\",\r\n                        !specificDate && \"text-muted-foreground\"\r\n                      )}\r\n                    >\r\n                      <CalendarIcon className=\"mr-2 h-4 w-4\" />\r\n                      {specificDate ? format(specificDate, \"PPP\") : <span>Pick a specific date</span>}\r\n                    </Button>\r\n                  </PopoverTrigger>\r\n                  <PopoverContent className=\"w-auto p-0 z-[100] bg-white shadow-lg\" align=\"start\">\r\n                    <Calendar\r\n                      mode=\"single\"\r\n                      selected={specificDate}\r\n                      onSelect={setSpecificDate}\r\n                      initialFocus\r\n                      className=\"p-3 pointer-events-auto\"\r\n                    />\r\n                  </PopoverContent>\r\n                </Popover>\r\n              </div>\r\n            )}\r\n\r\n            {dateFilter === 'custom' && (\r\n              <DateRangeFilter\r\n                dateRange={dateRange}\r\n                onDateRangeChange={setDateRange}\r\n              />\r\n            )}\r\n          </div>\r\n\r\n          {/* Export buttons - stack on mobile */}\r\n          <div className=\"flex flex-col md:flex-row gap-2\">\r\n            <Button variant=\"outline\" onClick={handleExportToCSV} className=\"gap-2 w-full md:w-auto\">\r\n              <FileText className=\"h-4 w-4\" />\r\n              Export CSV\r\n            </Button>\r\n            <Button variant=\"outline\" onClick={handleExportToPDF} className=\"gap-2 w-full md:w-auto\">\r\n              <Download className=\"h-4 w-4\" />\r\n              Export PDF\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Optimized search and filter controls */}\r\n        <div className=\"flex flex-col gap-4\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n            <Input\r\n              placeholder=\"Search items...\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"pl-10\"\r\n            />\r\n          </div>\r\n          <div className=\"flex flex-col gap-2\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Checkbox\r\n                id=\"not-in-inventory\"\r\n                checked={showOnlyNotInInventory}\r\n                onCheckedChange={handleInventoryFilterChange}\r\n              />\r\n              <label\r\n                htmlFor=\"not-in-inventory\"\r\n                className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\r\n              >\r\n                Show only items not in inventory\r\n              </label>\r\n            </div>\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Checkbox\r\n                id=\"cost-data-only\"\r\n                checked={showOnlyCostData}\r\n                onCheckedChange={handleCostDataFilterChange}\r\n                disabled={!canViewCostPrice}\r\n              />\r\n              <label\r\n                htmlFor=\"cost-data-only\"\r\n                className={cn(\r\n                  \"text-sm font-medium leading-none\",\r\n                  !canViewCostPrice && \"opacity-50 cursor-not-allowed\"\r\n                )}\r\n              >\r\n                Show only cost data (Item, Quantity, Average Cost, Total Cost)\r\n              </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Optimized sold items table */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-lg\">Items Sold - {getPeriodDisplayText()}</CardTitle>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Click on an item to view all sales containing that item\r\n              {searchQuery && `  Showing ${filteredSoldItems.length} of ${soldItems.length} items`}\r\n              {showOnlyNotInInventory && `  Filtered to show only items not in current inventory`}\r\n              {showOnlyCostData && `  Showing only cost data`}\r\n            </p>\r\n          </CardHeader>\r\n          <CardContent className=\"p-0\">\r\n            {filteredSoldItems.length === 0 ? (\r\n              <div className=\"p-8 text-center text-muted-foreground\">\r\n                {searchQuery ? \"No items found matching your search.\" :\r\n                  showOnlyNotInInventory ? \"No sold items found that are not in current inventory.\" :\r\n                    \"No items sold in the selected period.\"}\r\n              </div>\r\n            ) : (\r\n              <div className=\"overflow-x-auto\">\r\n                <Table>\r\n                  <TableHeader>\r\n                    <TableRow>\r\n                      <TableHead>Item</TableHead>\r\n                      <TableHead className=\"text-right\">Qty</TableHead>\r\n                      {showOnlyCostData ? (\r\n                        <>\r\n                          <TableHead className=\"text-right\">Avg Cost</TableHead>\r\n                          <TableHead className=\"text-right\">Total Cost</TableHead>\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <TableHead className=\"text-right\">Avg Price</TableHead>\r\n                          <TableHead className=\"text-right font-bold\">Total</TableHead>\r\n                          <TableHead className=\"text-right hidden sm:table-cell\">Discount</TableHead>\r\n                          {canViewCostPrice && <TableHead className=\"text-right\">Cost</TableHead>}\r\n                          {canViewProfit && <TableHead className=\"text-right\">Profit</TableHead>}\r\n                        </>\r\n                      )}\r\n                    </TableRow>\r\n                  </TableHeader>\r\n                  <TableBody>\r\n                    {filteredSoldItems.slice(0, mobileConfig.pageSize * 2).map((item, index) => (\r\n                      <TableRow\r\n                        key={index}\r\n                        className=\"cursor-pointer hover:bg-muted/50 transition-colors\"\r\n                        onClick={() => handleItemClick(item.description)}\r\n                      >\r\n                        <TableCell className=\"font-medium max-w-[200px] truncate\">\r\n                          <Tooltip>\r\n                            <TooltipTrigger asChild>\r\n                              <span className=\"cursor-help\">{item.description}</span>\r\n                            </TooltipTrigger>\r\n                            <TooltipContent side=\"top\" className=\"max-w-xs\">\r\n                              <div className=\"space-y-1\">\r\n                                <p className=\"font-bold break-words whitespace-normal\">{item.description}</p>\r\n                              </div>\r\n                            </TooltipContent>\r\n                          </Tooltip>\r\n                        </TableCell>\r\n                        <TableCell className=\"text-right\">{item.totalQuantity}</TableCell>\r\n                        {showOnlyCostData ? (\r\n                          <>\r\n                            <TableCell className=\"text-right\">\r\n                              {canViewCostPrice ? formatCashCurrency(item.averageCost || 0, settings.currency) : ''}\r\n                            </TableCell>\r\n                            <TableCell className=\"text-right\">\r\n                              {canViewCostPrice ? formatCashCurrency(item.totalCost, settings.currency) : ''}\r\n                            </TableCell>\r\n                          </>\r\n                        ) : (\r\n                          <>\r\n                            <TableCell className=\"text-right\">\r\n                              {canViewSellingPrice ? formatCashCurrency(item.averagePrice, settings.currency) : ''}\r\n                            </TableCell>\r\n                            <TableCell className=\"text-right font-medium\">\r\n                              {canViewSellingPrice ? formatCashCurrency(item.totalAmount, settings.currency) : ''}\r\n                            </TableCell>\r\n                            <TableCell className=\"text-right hidden sm:table-cell\">\r\n                              {canViewSellingPrice ? formatCashCurrency(item.totalDiscount, settings.currency) : ''}\r\n                            </TableCell>\r\n                            {canViewCostPrice && (\r\n                              <TableCell className=\"text-right text-sales-dark\">\r\n                                {formatCashCurrency(item.totalCost, settings.currency)}\r\n                              </TableCell>\r\n                            )}\r\n                            {canViewProfit && (\r\n                              <TableCell className=\"text-right font-semibold text-green-600\">\r\n                                {formatCashCurrency(item.totalProfit, settings.currency)}\r\n                              </TableCell>\r\n                            )}\r\n                          </>\r\n                        )}\r\n                      </TableRow>\r\n                    ))}\r\n                  </TableBody>\r\n                </Table>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Optimized summary for mobile */}\r\n        {filteredSoldItems.length > 0 && (\r\n          <Card>\r\n            <CardContent className=\"pt-6\">\r\n              {showOnlyCostData ? (\r\n                <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4 text-center\">\r\n                  <div>\r\n                    <p className=\"text-sm text-muted-foreground\">Items</p>\r\n                    <p className=\"text-lg md:text-2xl font-bold\">{filteredSoldItems.length}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-sm text-muted-foreground\">Quantity</p>\r\n                    <p className=\"text-lg md:text-2xl font-bold\">\r\n                      {filteredSoldItems.reduce((sum, item) => sum + item.totalQuantity, 0)}\r\n                    </p>\r\n                  </div>\r\n                  <div className=\"flex flex-col items-center\">\r\n                    <p className=\"text-sm text-muted-foreground\">Total Cost</p>\r\n                    <p className=\"text-lg md:text-2xl font-bold\">\r\n                      {canViewCostPrice ? formatCashCurrency(filteredSoldItems.reduce((sum, item) => sum + item.totalCost, 0), settings.currency) : ''}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-4\">\r\n                  {/* First row: Items, Quantity, Revenue */}\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-center\">\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Items</p>\r\n                      <p className=\"text-base sm:text-lg md:text-xl font-bold truncate\">{filteredSoldItems.length}</p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Quantity</p>\r\n                      <p className=\"text-base sm:text-lg md:text-xl font-bold truncate\">\r\n                        {filteredSoldItems.reduce((sum, item) => sum + item.totalQuantity, 0)}\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"flex flex-col items-center\">\r\n                      <p className=\"text-sm text-muted-foreground\">Revenue</p>\r\n                      <p className=\"text-base sm:text-lg md:text-xl font-bold truncate\">\r\n                        {canViewSellingPrice ? formatCashCurrency(filteredSoldItems.reduce((sum, item) => sum + item.totalAmount, 0), settings.currency) : ''}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  {/* Second row: Discount, Cost, Profit */}\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-center\">\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Discount</p>\r\n                      <p className=\"text-base sm:text-lg md:text-xl font-bold truncate\">\r\n                        {canViewSellingPrice ? formatCashCurrency(filteredSoldItems.reduce((sum, item) => sum + item.totalDiscount, 0), settings.currency) : ''}\r\n                      </p>\r\n                    </div>\r\n                    {canViewCostPrice && (\r\n                      <div className=\"flex flex-col items-center\">\r\n                        <p className=\"text-sm text-muted-foreground\">Cost</p>\r\n                        <p className=\"text-base sm:text-lg md:text-xl font-bold truncate\">\r\n                          {formatCashCurrency(filteredSoldItems.reduce((sum, item) => sum + item.totalCost, 0), settings.currency)}\r\n                        </p>\r\n                      </div>\r\n                    )}\r\n                    {canViewProfit && (\r\n                      <div className=\"flex flex-col items-center\">\r\n                        <p className=\"text-sm text-muted-foreground\">Profit</p>\r\n                        <p className=\"text-base sm:text-lg md:text-xl font-bold truncate\">\r\n                          {formatCashCurrency(filteredSoldItems.reduce((sum, item) => sum + item.totalProfit, 0), settings.currency)}\r\n                        </p>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n\r\n        {/* Item Sales Dialog */}\r\n        <ItemSalesDialog\r\n          isOpen={isItemSalesDialogOpen}\r\n          onOpenChange={setIsItemSalesDialogOpen}\r\n          itemDescription={selectedItem || ''}\r\n          sales={sales}\r\n          currency={settings.currency}\r\n          dateFilter={dateFilter}\r\n          dateRange={dateRange}\r\n          specificDate={specificDate}\r\n        />\r\n      </div>\r\n    </TooltipProvider>\r\n  );\r\n};\r\n\r\nexport default SoldItemsTab;\r\n","\r\nimport React from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Download, FileText, CalendarIcon } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport DateRangeFilter from '@/components/sales/DateRangeFilter';\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\r\nimport { Calendar } from '@/components/ui/calendar';\r\nimport { cn } from '@/lib/utils';\r\n\r\ninterface StockSummaryFiltersProps {\r\n  period: 'today' | 'yesterday' | 'this-week' | 'last-week' | 'this-month' | 'last-month' | 'this-year' | 'all-time' | 'specific-day' | 'custom';\r\n  setPeriod: (period: any) => void;\r\n  dateRange: { from: Date | undefined; to: Date | undefined };\r\n  setDateRange: (range: { from: Date | undefined; to: Date | undefined }) => void;\r\n  specificDay: Date | undefined;\r\n  setSpecificDay: (date: Date | undefined) => void;\r\n  onExportCSV: () => void;\r\n  onExportPDF: () => void;\r\n}\r\n\r\nconst StockSummaryFilters: React.FC<StockSummaryFiltersProps> = ({\r\n  period,\r\n  setPeriod,\r\n  dateRange,\r\n  setDateRange,\r\n  specificDay,\r\n  setSpecificDay,\r\n  onExportCSV,\r\n  onExportPDF\r\n}) => {\r\n  const getPeriodLabel = () => {\r\n    switch (period) {\r\n      case 'today': return 'Today';\r\n      case 'yesterday': return 'Yesterday';\r\n      case 'this-week': return 'This Week';\r\n      case 'last-week': return 'Last Week';\r\n      case 'this-month': return 'This Month';\r\n      case 'last-month': return 'Last Month';\r\n      case 'this-year': return 'This Year';\r\n      case 'all-time': return 'All Time';\r\n      case 'specific-day': return 'Specific Day';\r\n      case 'custom': return 'Custom Range';\r\n      default: return 'This Month';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Header with Export Buttons */}\r\n      <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n        <h3 className=\"text-lg font-semibold\">Stock Summary</h3>\r\n        <div className=\"flex flex-col md:flex-row gap-2\">\r\n          <Button onClick={onExportCSV} variant=\"outline\" size=\"sm\">\r\n            <Download className=\"h-4 w-4 mr-2\" />\r\n            CSV\r\n          </Button>\r\n          <Button onClick={onExportPDF} variant=\"outline\" size=\"sm\">\r\n            <FileText className=\"h-4 w-4 mr-2\" />\r\n            PDF\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filter Controls */}\r\n      <div className=\"flex flex-col md:flex-row gap-4\">\r\n        {/* Period Selector */}\r\n        <div className=\"w-full md:w-[200px]\">\r\n          <Select value={period} onValueChange={(value: any) => setPeriod(value)}>\r\n            <SelectTrigger className=\"bg-white\">\r\n              <SelectValue placeholder=\"Select period\" />\r\n            </SelectTrigger>\r\n            <SelectContent className=\"bg-white\">\r\n              <SelectItem value=\"today\">Today</SelectItem>\r\n              <SelectItem value=\"yesterday\">Yesterday</SelectItem>\r\n              <SelectItem value=\"this-week\">This Week</SelectItem>\r\n              <SelectItem value=\"last-week\">Last Week</SelectItem>\r\n              <SelectItem value=\"this-month\">This Month</SelectItem>\r\n              <SelectItem value=\"last-month\">Last Month</SelectItem>\r\n              <SelectItem value=\"this-year\">This Year</SelectItem>\r\n              <SelectItem value=\"all-time\">All Time</SelectItem>\r\n              <SelectItem value=\"specific-day\">Specific Day</SelectItem>\r\n              <SelectItem value=\"custom\">Custom Range</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n\r\n        {/* Specific Day Picker */}\r\n        {period === 'specific-day' && (\r\n          <div className=\"w-full md:w-auto\">\r\n            <Popover>\r\n              <PopoverTrigger asChild>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className={cn(\r\n                    \"w-full md:w-[240px] justify-start text-left font-normal bg-white\",\r\n                    !specificDay && \"text-muted-foreground\"\r\n                  )}\r\n                >\r\n                  <CalendarIcon className=\"mr-2 h-4 w-4\" />\r\n                  {specificDay ? format(specificDay, \"PPP\") : <span>Pick a specific day</span>}\r\n                </Button>\r\n              </PopoverTrigger>\r\n              <PopoverContent className=\"w-auto p-0 z-[100] bg-white shadow-lg\" align=\"start\">\r\n                <Calendar\r\n                  mode=\"single\"\r\n                  selected={specificDay}\r\n                  onSelect={setSpecificDay}\r\n                  initialFocus\r\n                  className=\"p-3 pointer-events-auto\"\r\n                />\r\n              </PopoverContent>\r\n            </Popover>\r\n          </div>\r\n        )}\r\n\r\n        {/* Custom Date Range */}\r\n        {period === 'custom' && (\r\n          <DateRangeFilter\r\n            dateRange={dateRange}\r\n            onDateRangeChange={setDateRange}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {/* Current Period Display */}\r\n      <div className=\"text-sm text-muted-foreground\">\r\n        Showing data for: <span className=\"font-medium\">{getPeriodLabel()}</span>\r\n        {period === 'specific-day' && specificDay && (\r\n          <span className=\"ml-2\">\r\n            ({format(specificDay, \"MMM d, yyyy\")})\r\n          </span>\r\n        )}\r\n        {period === 'custom' && dateRange?.from && dateRange?.to && (\r\n          <span className=\"ml-2\">\r\n            ({format(dateRange.from, \"MMM d, yyyy\")} - {format(dateRange.to, \"MMM d, yyyy\")})\r\n          </span>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StockSummaryFilters;\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ArrowUpDown\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMjEgMTYtNCA0LTQtNCIgLz4KICA8cGF0aCBkPSJNMTcgMjBWNCIgLz4KICA8cGF0aCBkPSJtMyA4IDQtNCA0IDQiIC8+CiAgPHBhdGggZD0iTTcgNHYxNiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-up-down\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowUpDown = createLucideIcon('ArrowUpDown', [\n  ['path', { d: 'm21 16-4 4-4-4', key: 'f6ql7i' }],\n  ['path', { d: 'M17 20V4', key: '1ejh1v' }],\n  ['path', { d: 'm3 8 4-4 4 4', key: '11wl7u' }],\n  ['path', { d: 'M7 4v16', key: '1glfcx' }],\n]);\n\nexport default ArrowUpDown;\n","\r\nimport React, { useState, useMemo, useEffect } from 'react';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Search, ArrowUpDown, ArrowUp, ArrowDown, ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport ProductImage from '@/components/inventory/ProductImage';\r\nimport LoadingSpinner from '@/components/LoadingSpinner';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { Product } from '@/types';\r\nimport { Pagination, PaginationContent, PaginationItem, PaginationLink, PaginationNext, PaginationPrevious } from '@/components/ui/pagination';\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\ninterface StockSummaryData {\r\n  productId: string;\r\n  productName: string;\r\n  itemNumber: string;\r\n  imageUrl?: string | null;\r\n  costPrice: number;\r\n  sellingPrice: number;\r\n  openingStock: number;\r\n  itemsSold: number;\r\n  stockIn: number;\r\n  transferOut: number;\r\n  returnIn: number;\r\n  returnOut: number;\r\n  returnOut: number;\r\n  adjustmentsIn: number;\r\n  adjustmentsOut: number;\r\n  closingStock: number;\r\n  category?: string;\r\n  revaluation: number;\r\n}\r\n\r\ninterface StockSummaryTableProps {\r\n  data: StockSummaryData[];\r\n  isLoading: boolean;\r\n  onProductClick: (productId: string) => void;\r\n  onFilteredDataChange?: (filteredData: StockSummaryData[]) => void;\r\n  currentProducts?: Product[];\r\n}\r\n\r\ntype SortField = 'productName' | 'category' | 'openingStock' | 'itemsSold' | 'stockIn' | 'transferOut' | 'returnIn' | 'returnOut' | 'closingStock';\r\ntype SortOrder = 'asc' | 'desc';\r\n\r\ninterface TableFilters {\r\n  searchTerm: string;\r\n  categoryFilter: string;\r\n  stockStatusFilter: string;\r\n  sortField: SortField;\r\n  sortOrder: SortOrder;\r\n}\r\n\r\nconst StockSummaryTable: React.FC<StockSummaryTableProps> = ({\r\n  data,\r\n  isLoading,\r\n  onProductClick,\r\n  onFilteredDataChange,\r\n  currentProducts = []\r\n}) => {\r\n  const { currentBusiness } = useBusiness();\r\n  const { canViewCostPrice } = useFinancialVisibility();\r\n\r\n  // Generate cache key for table filters\r\n  const getTableFiltersCacheKey = () => {\r\n    return `stockSummaryTableFilters_${currentBusiness?.id || 'default'}`;\r\n  };\r\n\r\n  // Load persisted table filters\r\n  const getPersistedTableFilters = (): TableFilters => {\r\n    try {\r\n      const saved = localStorage.getItem(getTableFiltersCacheKey());\r\n      if (saved) {\r\n        return JSON.parse(saved);\r\n      }\r\n    } catch (error) {\r\n      console.warn('Error loading persisted table filters:', error);\r\n    }\r\n    return {\r\n      searchTerm: '',\r\n      categoryFilter: 'all',\r\n      stockStatusFilter: 'all',\r\n      sortField: 'productName',\r\n      sortOrder: 'asc'\r\n    };\r\n  };\r\n\r\n  const persistedFilters = getPersistedTableFilters();\r\n  const [searchTerm, setSearchTerm] = useState(persistedFilters.searchTerm);\r\n  const [categoryFilter, setCategoryFilter] = useState(persistedFilters.categoryFilter);\r\n  const [stockStatusFilter, setStockStatusFilter] = useState(persistedFilters.stockStatusFilter);\r\n  const [sortField, setSortField] = useState<SortField>(persistedFilters.sortField);\r\n  const [sortOrder, setSortOrder] = useState<SortOrder>(persistedFilters.sortOrder);\r\n\r\n  // Pagination state\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const itemsPerPage = 15;\r\n\r\n  // Persist table filters whenever they change\r\n  useEffect(() => {\r\n    const filtersToSave: TableFilters = {\r\n      searchTerm,\r\n      categoryFilter,\r\n      stockStatusFilter,\r\n      sortField,\r\n      sortOrder\r\n    };\r\n    localStorage.setItem(getTableFiltersCacheKey(), JSON.stringify(filtersToSave));\r\n  }, [searchTerm, categoryFilter, stockStatusFilter, sortField, sortOrder, currentBusiness?.id]);\r\n\r\n  // Check if closing stock matches current quantity\r\n  const isStockMismatch = (item: StockSummaryData): boolean => {\r\n    const currentProduct = currentProducts.find(p => p.id === item.productId);\r\n    return currentProduct ? currentProduct.quantity !== item.closingStock : false;\r\n  };\r\n\r\n  // Get unique categories from data\r\n  const categories = useMemo(() => {\r\n    const uniqueCategories = Array.from(new Set(data.map(item => item.category).filter(Boolean)));\r\n    return uniqueCategories.sort();\r\n  }, [data]);\r\n\r\n  // Filter and sort data\r\n  const filteredAndSortedData = useMemo(() => {\r\n    let filtered = data.filter(item => {\r\n      // Search filter\r\n      if (searchTerm) {\r\n        const searchLower = searchTerm.toLowerCase();\r\n        const matchesSearch =\r\n          item.productName.toLowerCase().includes(searchLower) ||\r\n          item.itemNumber.toLowerCase().includes(searchLower) ||\r\n          (item.category && item.category.toLowerCase().includes(searchLower));\r\n        if (!matchesSearch) return false;\r\n      }\r\n\r\n      // Category filter\r\n      if (categoryFilter !== 'all' && item.category !== categoryFilter) {\r\n        return false;\r\n      }\r\n\r\n      // Stock status filter\r\n      if (stockStatusFilter !== 'all') {\r\n        if (stockStatusFilter === 'in-stock' && item.closingStock <= 0) return false;\r\n        if (stockStatusFilter === 'out-of-stock' && item.closingStock > 0) return false;\r\n        if (stockStatusFilter === 'low-stock' && (item.closingStock > 10 || item.closingStock <= 0)) return false;\r\n      }\r\n\r\n      return true;\r\n    });\r\n\r\n    // Sort data\r\n    filtered.sort((a, b) => {\r\n      let comparison = 0;\r\n\r\n      switch (sortField) {\r\n        case 'productName':\r\n          comparison = a.productName.localeCompare(b.productName);\r\n          break;\r\n        case 'category':\r\n          comparison = (a.category || '').localeCompare(b.category || '');\r\n          break;\r\n        case 'openingStock':\r\n          comparison = a.openingStock - b.openingStock;\r\n          break;\r\n        case 'itemsSold':\r\n          comparison = a.itemsSold - b.itemsSold;\r\n          break;\r\n        case 'stockIn':\r\n          comparison = a.stockIn - b.stockIn;\r\n          break;\r\n        case 'transferOut':\r\n          comparison = a.transferOut - b.transferOut;\r\n          break;\r\n        case 'returnIn':\r\n          comparison = a.returnIn - b.returnIn;\r\n          break;\r\n        case 'returnOut':\r\n          comparison = a.returnOut - b.returnOut;\r\n          break;\r\n        case 'closingStock':\r\n          comparison = a.closingStock - b.closingStock;\r\n          break;\r\n      }\r\n\r\n      return sortOrder === 'asc' ? comparison : -comparison;\r\n    });\r\n\r\n    return filtered;\r\n  }, [data, searchTerm, categoryFilter, stockStatusFilter, sortField, sortOrder]);\r\n\r\n  // Pagination calculations\r\n  const totalPages = Math.ceil(filteredAndSortedData.length / itemsPerPage);\r\n  const startIndex = (currentPage - 1) * itemsPerPage;\r\n  const endIndex = startIndex + itemsPerPage;\r\n  const paginatedData = filteredAndSortedData.slice(startIndex, endIndex);\r\n\r\n  // Reset page when filters change\r\n  useEffect(() => {\r\n    setCurrentPage(1);\r\n  }, [searchTerm, categoryFilter, stockStatusFilter]);\r\n\r\n  // Notify parent component when filtered data changes\r\n  useEffect(() => {\r\n    if (onFilteredDataChange) {\r\n      onFilteredDataChange(filteredAndSortedData);\r\n    }\r\n  }, [filteredAndSortedData, onFilteredDataChange]);\r\n\r\n  const handleSort = (field: SortField) => {\r\n    if (sortField === field) {\r\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\r\n    } else {\r\n      setSortField(field);\r\n      setSortOrder('asc');\r\n    }\r\n  };\r\n\r\n  const getSortIcon = (field: SortField) => {\r\n    if (sortField !== field) {\r\n      return <ArrowUpDown className=\"h-4 w-4\" />;\r\n    }\r\n    return sortOrder === 'asc' ? <ArrowUp className=\"h-4 w-4\" /> : <ArrowDown className=\"h-4 w-4\" />;\r\n  };\r\n\r\n  const totals = React.useMemo(() => {\r\n    return filteredAndSortedData.reduce((acc, item) => ({\r\n      openingStock: acc.openingStock + item.openingStock,\r\n      itemsSold: acc.itemsSold + item.itemsSold,\r\n      stockIn: acc.stockIn + item.stockIn,\r\n      transferOut: acc.transferOut + item.transferOut,\r\n      returnIn: acc.returnIn + item.returnIn,\r\n      returnOut: acc.returnOut + item.returnOut,\r\n      returnOut: acc.returnOut + item.returnOut,\r\n      adjustmentsIn: acc.adjustmentsIn + (item.adjustmentsIn || 0),\r\n      adjustmentsOut: acc.adjustmentsOut + (item.adjustmentsOut || 0),\r\n      closingStock: acc.closingStock + item.closingStock\r\n    }), {\r\n      openingStock: 0,\r\n      itemsSold: 0,\r\n      stockIn: 0,\r\n      transferOut: 0,\r\n      returnIn: 0,\r\n      returnOut: 0,\r\n      adjustmentsIn: 0,\r\n      adjustmentsOut: 0,\r\n      closingStock: 0\r\n    });\r\n  }, [filteredAndSortedData]);\r\n\r\n  const handlePageChange = (page: number) => {\r\n    setCurrentPage(page);\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex justify-center py-8\">\r\n        <LoadingSpinner />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Filters */}\r\n      <div className=\"flex flex-col md:flex-row gap-4\">\r\n        {/* Search */}\r\n        <div className=\"flex items-center relative flex-grow\">\r\n          <Search className=\"h-4 w-4 absolute left-3 text-gray-400\" />\r\n          <Input\r\n            placeholder=\"Search products...\"\r\n            className=\"pl-9\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n          />\r\n        </div>\r\n\r\n        {/* Category Filter */}\r\n        <div className=\"min-w-[180px]\">\r\n          <Select value={categoryFilter} onValueChange={setCategoryFilter}>\r\n            <SelectTrigger>\r\n              <SelectValue placeholder=\"All Categories\" />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"all\">All Categories</SelectItem>\r\n              {categories.map((category) => (\r\n                <SelectItem key={category} value={category}>\r\n                  {category}\r\n                </SelectItem>\r\n              ))}\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n\r\n        {/* Stock Status Filter */}\r\n        <div className=\"min-w-[150px]\">\r\n          <Select value={stockStatusFilter} onValueChange={setStockStatusFilter}>\r\n            <SelectTrigger>\r\n              <SelectValue placeholder=\"Stock Status\" />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"all\">All Stock</SelectItem>\r\n              <SelectItem value=\"in-stock\">In Stock</SelectItem>\r\n              <SelectItem value=\"low-stock\">Low Stock (10)</SelectItem>\r\n              <SelectItem value=\"out-of-stock\">Out of Stock</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n\r\n        {/* Results count */}\r\n        <div className=\"flex items-center gap-4\">\r\n          <Badge variant=\"secondary\" className=\"text-xs\">\r\n            {filteredAndSortedData.length} {filteredAndSortedData.length === 1 ? 'product' : 'products'} found\r\n          </Badge>\r\n          {totalPages > 1 && (\r\n            <div className=\"text-xs text-muted-foreground\">\r\n              Page {currentPage} of {totalPages}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <TooltipProvider>\r\n        <div className=\"overflow-x-auto\">\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow>\r\n                <TableHead className=\"w-[80px]\">Image</TableHead>\r\n                <TableHead>Item #</TableHead>\r\n                <TableHead>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => handleSort('productName')}\r\n                    className=\"h-auto p-0 font-medium text-left justify-start hover:bg-transparent\"\r\n                  >\r\n                    Product Name {getSortIcon('productName')}\r\n                  </Button>\r\n                </TableHead>\r\n                <TableHead>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => handleSort('category')}\r\n                    className=\"h-auto p-0 font-medium text-left justify-start hover:bg-transparent\"\r\n                  >\r\n                    Category {getSortIcon('category')}\r\n                  </Button>\r\n                </TableHead>\r\n                <TableHead className=\"text-right\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => handleSort('openingStock')}\r\n                    className=\"h-auto p-0 font-medium text-right justify-end hover:bg-transparent\"\r\n                  >\r\n                    Opening Stock {getSortIcon('openingStock')}\r\n                  </Button>\r\n                </TableHead>\r\n                <TableHead className=\"text-right\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => handleSort('stockIn')}\r\n                    className=\"h-auto p-0 font-medium text-right justify-end hover:bg-transparent\"\r\n                  >\r\n                    Stock In {getSortIcon('stockIn')}\r\n                  </Button>\r\n                </TableHead>\r\n                <TableHead className=\"text-right\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => handleSort('transferOut')}\r\n                    /* Using transferOut sort key for Stock Out generally, though it's a mix */\r\n                    className=\"h-auto p-0 font-medium text-right justify-end hover:bg-transparent\"\r\n                  >\r\n                    Stock Out\r\n                  </Button>\r\n                </TableHead>\r\n                <TableHead className=\"text-right\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => handleSort('closingStock')}\r\n                    className=\"h-auto p-0 font-medium text-right justify-end hover:bg-transparent\"\r\n                  >\r\n                    Closing Stock {getSortIcon('closingStock')}\r\n                  </Button>\r\n                </TableHead>\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {paginatedData.map((item) => (\r\n                <TableRow\r\n                  key={item.productId}\r\n                  className={`cursor-pointer hover:bg-muted/50 transition-colors ${isStockMismatch(item) ? 'bg-red-50 hover:bg-red-100 border-l-4 border-l-red-500' : ''\r\n                    }`}\r\n                  onClick={() => onProductClick(item.productId)}\r\n                >\r\n                  <TableCell>\r\n                    <ProductImage imageUrl={item.imageUrl} alt={item.productName} size=\"sm\" />\r\n                  </TableCell>\r\n                  <TableCell className=\"font-medium truncate max-w-[120px]\">#{item.itemNumber}</TableCell>\r\n                  <TableCell className=\"truncate max-w-[200px]\">\r\n                    <Tooltip>\r\n                      <TooltipTrigger asChild>\r\n                        <span className=\"cursor-help\">{item.productName}</span>\r\n                      </TooltipTrigger>\r\n                      <TooltipContent side=\"top\" className=\"max-w-xs\">\r\n                        <div className=\"space-y-1\">\r\n                          <p className=\"font-bold break-words whitespace-normal\">{item.productName}</p>\r\n                          {item.category && (\r\n                            <p className=\"text-xs text-muted-foreground\">Category: {item.category}</p>\r\n                          )}\r\n                        </div>\r\n                      </TooltipContent>\r\n                    </Tooltip>\r\n                  </TableCell>\r\n                  <TableCell>{item.category || '-'}</TableCell>\r\n                  <TableCell className=\"text-right\">{item.openingStock}</TableCell>\r\n                  {/* Stock In = Stock In + Return In + Positive Adjustments */}\r\n                  <TableCell className=\"text-right text-green-600 font-medium\">\r\n                    {item.stockIn + item.returnIn + (item.adjustmentsIn || 0)}\r\n                  </TableCell>\r\n                  {/* Stock Out = Sold + Transfer Out + Return Out + Negative Adjustments (abs) */}\r\n                  <TableCell className=\"text-right text-red-600 font-medium\">\r\n                    {item.itemsSold + item.transferOut + item.returnOut + (item.adjustmentsOut || 0)}\r\n                  </TableCell>\r\n                  <TableCell className=\"text-right font-bold\">{item.closingStock}</TableCell>\r\n                </TableRow>\r\n              ))}\r\n              {filteredAndSortedData.length > 0 && (\r\n                <TableRow className=\"font-semibold bg-muted/50 border-t-2\">\r\n                  <TableCell colSpan={4}>Total</TableCell>\r\n                  <TableCell className=\"text-right\">{totals.openingStock}</TableCell>\r\n                  <TableCell className=\"text-right text-green-700\">\r\n                    {totals.stockIn + totals.returnIn + totals.adjustmentsIn}\r\n                  </TableCell>\r\n                  <TableCell className=\"text-right text-red-700\">\r\n                    {totals.itemsSold + totals.transferOut + totals.returnOut + totals.adjustmentsOut}\r\n                  </TableCell>\r\n                  <TableCell className=\"text-right\">{totals.closingStock}</TableCell>\r\n                </TableRow>\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n\r\n          {filteredAndSortedData.length === 0 && !isLoading && (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              No products found matching your filters.\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Pagination */}\r\n        {totalPages > 1 && (\r\n          <div className=\"flex justify-center mt-6\">\r\n            <Pagination>\r\n              <PaginationContent>\r\n                <PaginationItem>\r\n                  <PaginationPrevious\r\n                    onClick={() => handlePageChange(Math.max(1, currentPage - 1))}\r\n                    className={currentPage === 1 ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                  />\r\n                </PaginationItem>\r\n\r\n                {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\r\n                  let pageNumber;\r\n                  if (totalPages <= 5) {\r\n                    pageNumber = i + 1;\r\n                  } else if (currentPage <= 3) {\r\n                    pageNumber = i + 1;\r\n                  } else if (currentPage >= totalPages - 2) {\r\n                    pageNumber = totalPages - 4 + i;\r\n                  } else {\r\n                    pageNumber = currentPage - 2 + i;\r\n                  }\r\n\r\n                  return (\r\n                    <PaginationItem key={pageNumber}>\r\n                      <PaginationLink\r\n                        onClick={() => handlePageChange(pageNumber)}\r\n                        isActive={currentPage === pageNumber}\r\n                        className=\"cursor-pointer\"\r\n                      >\r\n                        {pageNumber}\r\n                      </PaginationLink>\r\n                    </PaginationItem>\r\n                  );\r\n                })}\r\n\r\n                <PaginationItem>\r\n                  <PaginationNext\r\n                    onClick={() => handlePageChange(Math.min(totalPages, currentPage + 1))}\r\n                    className={currentPage === totalPages ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                  />\r\n                </PaginationItem>\r\n              </PaginationContent>\r\n            </Pagination>\r\n          </div>\r\n        )}\r\n      </TooltipProvider>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StockSummaryTable;\r\n","\r\nimport React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { formatNumber } from '@/lib/utils';\r\n\r\ninterface StockSummaryData {\r\n  productId: string;\r\n  productName: string;\r\n  itemNumber: string;\r\n  imageUrl?: string | null;\r\n  costPrice: number;\r\n  sellingPrice: number;\r\n  openingStock: number;\r\n  itemsSold: number;\r\n  stockIn: number;\r\n  transferOut: number;\r\n  returnIn: number;\r\n  returnOut: number;\r\n  adjustmentsIn: number;\r\n  adjustmentsOut: number;\r\n  closingStock: number;\r\n  revaluation: number;\r\n}\r\n\r\ninterface StockSummaryOverviewProps {\r\n  data: StockSummaryData[];\r\n}\r\n\r\nconst StockSummaryOverview: React.FC<StockSummaryOverviewProps> = ({ data }) => {\r\n  const { canViewCostPrice } = useFinancialVisibility();\r\n  const { settings } = useBusinessSettings();\r\n  const currency = settings?.currency || 'UGX';\r\n\r\n  const formatCurrencyValue = (amount: number) => {\r\n    return `${currency} ${formatNumber(amount)}`;\r\n  };\r\n\r\n  const financialTotals = React.useMemo(() => {\r\n    const totals = data.reduce((acc, item) => ({\r\n      openingStock: acc.openingStock + (item.openingStock * item.costPrice),\r\n      // Aggregate Stock In (Stock In + Return In + Adjustments In)\r\n      stockIn: acc.stockIn + ((item.stockIn + item.returnIn + (item.adjustmentsIn || 0)) * item.costPrice),\r\n      // Aggregate Stock Out (Items Sold + Transfer Out + Return Out + Adjustments Out)\r\n      stockOut: acc.stockOut + ((item.itemsSold + item.transferOut + item.returnOut + (item.adjustmentsOut || 0)) * item.costPrice)\r\n    }), {\r\n      openingStock: 0,\r\n      stockIn: 0,\r\n      stockOut: 0\r\n    });\r\n\r\n    // Calculate closing stock value derived from the aggregated totals\r\n    // Closing = Opening + StockIn - StockOut\r\n    const closingStock = totals.openingStock + totals.stockIn - totals.stockOut;\r\n\r\n    return { ...totals, closingStock };\r\n  }, [data]);\r\n\r\n  if (data.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <CardTitle>Stock Summary Overview</CardTitle>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-6\">\r\n          <div className=\"space-y-2\">\r\n            <p className=\"text-sm text-muted-foreground font-medium uppercase\">Opening Stock Value</p>\r\n            <p className=\"text-xl font-bold text-blue-600\">\r\n              {canViewCostPrice ? formatCurrencyValue(financialTotals.openingStock) : ''}\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <p className=\"text-sm text-muted-foreground font-medium uppercase\">Total Stock In Value</p>\r\n            <p className=\"text-xl font-bold text-green-600\">\r\n              {canViewCostPrice ? formatCurrencyValue(financialTotals.stockIn) : ''}\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <p className=\"text-sm text-muted-foreground font-medium uppercase\">Total Stock Out Value</p>\r\n            <p className=\"text-xl font-bold text-red-600\">\r\n              {canViewCostPrice ? formatCurrencyValue(financialTotals.stockOut) : ''}\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <p className=\"text-sm text-muted-foreground font-medium uppercase\">Closing Stock Value</p>\r\n            <p className=\"text-xl font-bold text-purple-600\">\r\n              {canViewCostPrice ? formatCurrencyValue(financialTotals.closingStock) : ''}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default StockSummaryOverview;\r\n","import jsPDF from 'jspdf';\r\nimport { format } from 'date-fns';\r\n\r\ninterface StockSummaryData {\r\n  productId: string;\r\n  productName: string;\r\n  itemNumber: string;\r\n  openingStock: number;\r\n  itemsSold: number;\r\n  stockIn: number;\r\n  transferOut: number;\r\n  returnIn: number;\r\n  returnOut: number;\r\n  closingStock: number;\r\n}\r\n\r\nexport const exportStockSummaryToPDF = (\r\n  data: StockSummaryData[],\r\n  period: string,\r\n  dateRange?: { from: Date | undefined; to: Date | undefined }\r\n) => {\r\n  // Create new PDF document in landscape orientation\r\n  const pdf = new jsPDF({\r\n    orientation: 'landscape',\r\n    unit: 'mm',\r\n    format: 'a4',\r\n    compress: true\r\n  });\r\n\r\n  const pageWidth = pdf.internal.pageSize.getWidth();\r\n  const pageHeight = pdf.internal.pageSize.getHeight();\r\n  const margins = { top: 15, right: 15, bottom: 15, left: 15 };\r\n  const contentWidth = pageWidth - margins.left - margins.right;\r\n  \r\n  let currentY = margins.top;\r\n\r\n  // Function to add watermark to current page\r\n  const addWatermark = () => {\r\n    pdf.setFontSize(8);\r\n    pdf.setFont('helvetica', 'normal');\r\n    pdf.setTextColor(150, 150, 150); // Light gray color\r\n    pdf.text('Created By Gonza Systems', pageWidth / 2, pageHeight - 10, { align: 'center' });\r\n    pdf.setTextColor(0, 0, 0); // Reset to black\r\n  };\r\n\r\n  // Table setup - optimized for landscape orientation\r\n  const colWidths = [20, 50, 30, 25, 25, 25, 25, 25, 25]; // Item #, Product, Opening, Sold, Stock In, Transfer Out, Return In, Return Out, Closing\r\n  const rowHeight = 7;\r\n  const headerHeight = 8;\r\n\r\n  // Table headers\r\n  const headers = [\r\n    'Item #',\r\n    'Product Name',\r\n    'Opening Stock',\r\n    'Items Sold',\r\n    'Stock In',\r\n    'Transfer Out',\r\n    'Return In',\r\n    'Return Out',\r\n    'Closing Stock'\r\n  ];\r\n\r\n  // Function to draw table headers\r\n  const drawTableHeaders = () => {\r\n    // Draw header background\r\n    pdf.setFillColor(243, 244, 246);\r\n    pdf.rect(margins.left, currentY - 2, contentWidth, headerHeight, 'F');\r\n\r\n    // Draw header borders\r\n    pdf.setLineWidth(0.2);\r\n    pdf.rect(margins.left, currentY - 2, contentWidth, headerHeight);\r\n\r\n    // Header text\r\n    pdf.setFontSize(9);\r\n    pdf.setFont('helvetica', 'bold');\r\n    let currentX = margins.left;\r\n    \r\n    headers.forEach((header, index) => {\r\n      const colWidth = colWidths[index];\r\n      const textWidth = pdf.getTextWidth(header);\r\n      const textX = currentX + (colWidth - textWidth) / 2;\r\n      pdf.text(header, textX, currentY + 5);\r\n      \r\n      if (index < headers.length - 1) {\r\n        pdf.line(currentX + colWidth, currentY - 2, currentX + colWidth, currentY + headerHeight - 2);\r\n      }\r\n      \r\n      currentX += colWidth;\r\n    });\r\n\r\n    currentY += headerHeight;\r\n  };\r\n\r\n  // Helper function to check if we need a new page\r\n  const checkPageBreak = (neededHeight: number) => {\r\n    if (currentY + neededHeight > pageHeight - margins.bottom - 15) { // Reserve space for watermark\r\n      addWatermark(); // Add watermark to current page before creating new one\r\n      pdf.addPage();\r\n      currentY = margins.top;\r\n      drawTableHeaders();\r\n      pdf.setFont('helvetica', 'normal');\r\n      pdf.setFontSize(8);\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  // Title\r\n  pdf.setFontSize(18);\r\n  pdf.setFont('helvetica', 'bold');\r\n  const title = `Stock Summary Report`;\r\n  const titleWidth = pdf.getTextWidth(title);\r\n  pdf.text(title, (pageWidth - titleWidth) / 2, currentY);\r\n  currentY += 8;\r\n\r\n  // Date range display - always show exact dates in DD/MM/YYYY format\r\n  if (dateRange?.from && dateRange?.to) {\r\n    pdf.setFontSize(12);\r\n    pdf.setFont('helvetica', 'normal');\r\n    const fromDate = format(dateRange.from, 'dd/MM/yyyy');\r\n    const toDate = format(dateRange.to, 'dd/MM/yyyy');\r\n    \r\n    const dateText = fromDate === toDate ? fromDate : `${fromDate} - ${toDate}`;\r\n    const dateWidth = pdf.getTextWidth(dateText);\r\n    pdf.text(dateText, (pageWidth - dateWidth) / 2, currentY);\r\n    currentY += 12;\r\n  } else {\r\n    // Fallback to current date if no range provided\r\n    pdf.setFontSize(12);\r\n    pdf.setFont('helvetica', 'normal');\r\n    const dateText = format(new Date(), 'dd/MM/yyyy');\r\n    const dateWidth = pdf.getTextWidth(dateText);\r\n    pdf.text(dateText, (pageWidth - dateWidth) / 2, currentY);\r\n    currentY += 12;\r\n  }\r\n\r\n  if (data.length === 0) {\r\n    // No data message\r\n    pdf.setFontSize(14);\r\n    pdf.setFont('helvetica', 'normal');\r\n    const noDataText = 'No stock data available for the selected period.';\r\n    const noDataWidth = pdf.getTextWidth(noDataText);\r\n    pdf.text(noDataText, (pageWidth - noDataWidth) / 2, currentY + 30);\r\n  } else {\r\n    // Draw initial table headers\r\n    checkPageBreak(headerHeight + 10);\r\n    drawTableHeaders();\r\n\r\n    // Table data\r\n    pdf.setFont('helvetica', 'normal');\r\n    pdf.setFontSize(8);\r\n\r\n    data.forEach((item, index) => {\r\n      checkPageBreak(rowHeight + 5);\r\n\r\n      const rowData = [\r\n        item.itemNumber,\r\n        item.productName,\r\n        item.openingStock.toString(),\r\n        item.itemsSold.toString(),\r\n        item.stockIn.toString(),\r\n        item.transferOut.toString(),\r\n        item.returnIn.toString(),\r\n        item.returnOut.toString(),\r\n        item.closingStock.toString()\r\n      ];\r\n\r\n      // Draw row background (alternating)\r\n      if (index % 2 === 0) {\r\n        pdf.setFillColor(249, 250, 251);\r\n        pdf.rect(margins.left, currentY - 1, contentWidth, rowHeight, 'F');\r\n      }\r\n\r\n      pdf.setLineWidth(0.1);\r\n      pdf.rect(margins.left, currentY - 1, contentWidth, rowHeight);\r\n\r\n      let currentX = margins.left;\r\n      \r\n      rowData.forEach((data, colIndex) => {\r\n        const colWidth = colWidths[colIndex];\r\n        let text = data;\r\n        \r\n        // Truncate text if too long\r\n        if (colIndex === 1) { // Product name\r\n          while (pdf.getTextWidth(text) > colWidth - 2 && text.length > 3) {\r\n            text = text.substring(0, text.length - 4) + '...';\r\n          }\r\n        }\r\n        \r\n        let textX = currentX + 1;\r\n        if (colIndex >= 2) { // Numeric columns\r\n          const textWidth = pdf.getTextWidth(text);\r\n          textX = currentX + colWidth - textWidth - 1;\r\n        } else if (colIndex === 0) { // Item number - center align\r\n          const textWidth = pdf.getTextWidth(text);\r\n          textX = currentX + (colWidth - textWidth) / 2;\r\n        }\r\n        \r\n        pdf.text(text, textX, currentY + 4);\r\n        \r\n        if (colIndex < rowData.length - 1) {\r\n          pdf.line(currentX + colWidth, currentY - 1, currentX + colWidth, currentY + rowHeight - 1);\r\n        }\r\n        \r\n        currentX += colWidth;\r\n      });\r\n\r\n      currentY += rowHeight;\r\n    });\r\n\r\n    // Summary section - Add more space before summary\r\n    currentY += 15;\r\n    checkPageBreak(35);\r\n\r\n    // Summary title\r\n    pdf.setFontSize(16);\r\n    pdf.setFont('helvetica', 'bold');\r\n    pdf.text('Summary', margins.left, currentY);\r\n    currentY += 8;\r\n\r\n    // Calculate totals\r\n    const totalProducts = data.length;\r\n    const totalOpeningStock = data.reduce((sum, item) => sum + item.openingStock, 0);\r\n    const totalItemsSold = data.reduce((sum, item) => sum + item.itemsSold, 0);\r\n    const totalStockIn = data.reduce((sum, item) => sum + item.stockIn, 0);\r\n    const totalClosingStock = data.reduce((sum, item) => sum + item.closingStock, 0);\r\n\r\n    // Draw summary box\r\n    const summaryBoxHeight = 30;\r\n    const summaryBoxWidth = contentWidth * 0.8;\r\n    \r\n    pdf.setFillColor(248, 249, 250);\r\n    pdf.rect(margins.left, currentY - 3, summaryBoxWidth, summaryBoxHeight, 'F');\r\n    pdf.setLineWidth(0.3);\r\n    pdf.setDrawColor(200, 200, 200);\r\n    pdf.rect(margins.left, currentY - 3, summaryBoxWidth, summaryBoxHeight);\r\n\r\n    // Summary data in two columns\r\n    pdf.setFontSize(11);\r\n    pdf.setFont('helvetica', 'normal');\r\n    \r\n    const leftColumn = [\r\n      ['Total Products:', totalProducts.toString()],\r\n      ['Total Opening Stock:', totalOpeningStock.toString()],\r\n      ['Total Items Sold:', totalItemsSold.toString()]\r\n    ];\r\n\r\n    const rightColumn = [\r\n      ['Total Stock In:', totalStockIn.toString()],\r\n      ['Total Closing Stock:', totalClosingStock.toString()]\r\n    ];\r\n\r\n    let summaryY = currentY + 6;\r\n    const leftColumnX = margins.left + 15;\r\n    const rightColumnX = margins.left + summaryBoxWidth / 2 + 15;\r\n\r\n    // Draw left column\r\n    leftColumn.forEach(([label, value]) => {\r\n      pdf.setFont('helvetica', 'bold');\r\n      pdf.text(label, leftColumnX, summaryY);\r\n      pdf.setFont('helvetica', 'normal');\r\n      const labelWidth = pdf.getTextWidth(label);\r\n      pdf.text(value, leftColumnX + labelWidth + 5, summaryY);\r\n      summaryY += 6;\r\n    });\r\n\r\n    // Reset Y for right column\r\n    summaryY = currentY + 6;\r\n\r\n    // Draw right column\r\n    rightColumn.forEach(([label, value]) => {\r\n      pdf.setFont('helvetica', 'bold');\r\n      pdf.text(label, rightColumnX, summaryY);\r\n      pdf.setFont('helvetica', 'normal');\r\n      const labelWidth = pdf.getTextWidth(label);\r\n      pdf.text(value, rightColumnX + labelWidth + 5, summaryY);\r\n      summaryY += 6;\r\n    });\r\n  }\r\n\r\n  // Add watermark to the final page\r\n  addWatermark();\r\n\r\n  // Generate filename based on report date range\r\n  let filename: string;\r\n  \r\n  if (dateRange?.from && dateRange?.to) {\r\n    const fromDate = format(dateRange.from, 'yyyy-MM-dd');\r\n    const toDate = format(dateRange.to, 'yyyy-MM-dd');\r\n    \r\n    if (fromDate === toDate) {\r\n      filename = `stock-summary-${fromDate}.pdf`;\r\n    } else {\r\n      filename = `stock-summary-${fromDate}_to_${toDate}.pdf`;\r\n    }\r\n  } else {\r\n    // Fallback to current date if no range provided\r\n    filename = `stock-summary-${format(new Date(), 'yyyy-MM-dd')}.pdf`;\r\n  }\r\n\r\n  pdf.save(filename);\r\n};\r\n","\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { RefreshCw } from 'lucide-react';\r\nimport { format, startOfDay, endOfDay, startOfWeek, endOfWeek, startOfMonth, endOfMonth } from 'date-fns';\r\nimport StockSummaryFilters from './StockSummaryFilters';\r\nimport StockSummaryTable from './StockSummaryTable';\r\nimport StockSummaryOverview from './StockSummaryOverview';\r\nimport { useStockSummaryData } from '@/hooks/useStockSummaryData';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { exportStockSummaryToPDF } from '@/utils/exportStockSummaryToPDF';\r\n\r\ninterface StockSummaryData {\r\n  productId: string;\r\n  productName: string;\r\n  itemNumber: string;\r\n  imageUrl?: string | null;\r\n  costPrice: number;\r\n  sellingPrice: number;\r\n  openingStock: number;\r\n  itemsSold: number;\r\n  stockIn: number;\r\n  transferOut: number;\r\n  returnIn: number;\r\n  returnOut: number;\r\n  returnOut: number;\r\n  adjustmentsIn: number;\r\n  adjustmentsOut: number;\r\n  closingStock: number;\r\n  category?: string;\r\n  revaluation: number;\r\n}\r\n\r\nconst StockSummaryTab = () => {\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const { products } = useProducts(user?.id, 10000); // Load all products for filtering\r\n\r\n  // Load persisted state from localStorage\r\n  const getPersistedState = () => {\r\n    try {\r\n      const saved = localStorage.getItem('stockSummaryFilters');\r\n      if (saved) {\r\n        const parsed = JSON.parse(saved);\r\n        return {\r\n          period: parsed.period || 'this-month',\r\n          dateRange: parsed.dateRange ? {\r\n            from: parsed.dateRange.from ? new Date(parsed.dateRange.from) : startOfMonth(new Date()),\r\n            to: parsed.dateRange.to ? new Date(parsed.dateRange.to) : endOfMonth(new Date())\r\n          } : {\r\n            from: startOfMonth(new Date()),\r\n            to: endOfMonth(new Date())\r\n          },\r\n          specificDay: parsed.specificDay ? new Date(parsed.specificDay) : undefined\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading persisted stock summary filters:', error);\r\n    }\r\n    return {\r\n      period: 'all-time' as const,\r\n      dateRange: {\r\n        from: new Date(2020, 0, 1),\r\n        to: endOfDay(new Date())\r\n      },\r\n      specificDay: undefined\r\n    };\r\n  };\r\n\r\n  const persistedState = getPersistedState();\r\n  const [period, setPeriod] = useState<'today' | 'yesterday' | 'this-week' | 'last-week' | 'this-month' | 'last-month' | 'this-year' | 'all-time' | 'specific-day' | 'custom'>('all-time');\r\n  const [dateRange, setDateRange] = useState<{ from: Date | undefined; to: Date | undefined }>(persistedState.dateRange);\r\n  const [specificDay, setSpecificDay] = useState<Date | undefined>(persistedState.specificDay);\r\n  const [filteredStockData, setFilteredStockData] = useState<StockSummaryData[]>([]);\r\n\r\n  const { stockSummaryData, isLoading, loadStockSummaryData, clearCache } = useStockSummaryData(dateRange);\r\n\r\n  // Handle manual refresh with cache clearing\r\n  const handleRefresh = async () => {\r\n    clearCache();\r\n    await loadStockSummaryData();\r\n  };\r\n\r\n  // Listen for stock updates from other components\r\n  useEffect(() => {\r\n    const handleStockUpdate = () => {\r\n      console.log('Stock updated, refreshing stock summary data');\r\n      clearCache();\r\n      loadStockSummaryData();\r\n    };\r\n\r\n    window.addEventListener('stock-updated', handleStockUpdate);\r\n\r\n    return () => {\r\n      window.removeEventListener('stock-updated', handleStockUpdate);\r\n    };\r\n  }, [clearCache, loadStockSummaryData]);\r\n\r\n  // Persist state to localStorage whenever filters change\r\n  useEffect(() => {\r\n    const stateToSave = {\r\n      period,\r\n      dateRange: {\r\n        from: dateRange.from?.toISOString(),\r\n        to: dateRange.to?.toISOString()\r\n      },\r\n      specificDay: specificDay?.toISOString()\r\n    };\r\n    localStorage.setItem('stockSummaryFilters', JSON.stringify(stateToSave));\r\n  }, [period, dateRange, specificDay]);\r\n\r\n  // Update date range when period changes\r\n  useEffect(() => {\r\n    const now = new Date();\r\n    let newRange: { from: Date; to: Date };\r\n\r\n    switch (period) {\r\n      case 'today':\r\n        newRange = {\r\n          from: startOfDay(now),\r\n          to: endOfDay(now)\r\n        };\r\n        break;\r\n      case 'yesterday':\r\n        const yesterday = new Date(now);\r\n        yesterday.setDate(yesterday.getDate() - 1);\r\n        newRange = {\r\n          from: startOfDay(yesterday),\r\n          to: endOfDay(yesterday)\r\n        };\r\n        break;\r\n      case 'this-week':\r\n        newRange = {\r\n          from: startOfWeek(now),\r\n          to: endOfWeek(now)\r\n        };\r\n        break;\r\n      case 'last-week':\r\n        const lastWeek = new Date(now);\r\n        lastWeek.setDate(lastWeek.getDate() - 7);\r\n        newRange = {\r\n          from: startOfWeek(lastWeek),\r\n          to: endOfWeek(lastWeek)\r\n        };\r\n        break;\r\n      case 'this-month':\r\n        newRange = {\r\n          from: startOfMonth(now),\r\n          to: endOfMonth(now)\r\n        };\r\n        break;\r\n      case 'last-month':\r\n        const lastMonth = new Date(now);\r\n        lastMonth.setMonth(lastMonth.getMonth() - 1);\r\n        newRange = {\r\n          from: startOfMonth(lastMonth),\r\n          to: endOfMonth(lastMonth)\r\n        };\r\n        break;\r\n      case 'this-year':\r\n        newRange = {\r\n          from: new Date(now.getFullYear(), 0, 1),\r\n          to: new Date(now.getFullYear(), 11, 31)\r\n        };\r\n        break;\r\n      case 'all-time':\r\n        newRange = {\r\n          from: new Date(2020, 0, 1), // Go back far enough to cover everything\r\n          to: endOfDay(now) // Ensure we cover up to the very end of today\r\n        };\r\n        break;\r\n      case 'specific-day':\r\n        if (specificDay) {\r\n          newRange = {\r\n            from: startOfDay(specificDay),\r\n            to: endOfDay(specificDay)\r\n          };\r\n        } else {\r\n          return; // Don't update if no specific day is selected\r\n        }\r\n        break;\r\n      default:\r\n        return; // Don't change for custom\r\n    }\r\n\r\n    setDateRange(newRange);\r\n  }, [period, specificDay]);\r\n\r\n  const exportToCSV = () => {\r\n    const headers = [\r\n      'Item Number',\r\n      'Product Name',\r\n      'Category',\r\n      'Opening Stock',\r\n      'Items Sold',\r\n      'Stock In',\r\n      'Transfer Out',\r\n      'Return In',\r\n      'Return Out',\r\n      'Closing Stock'\r\n    ];\r\n\r\n    const rows = filteredStockData.map(item => [\r\n      item.itemNumber,\r\n      item.productName,\r\n      item.category || '',\r\n      item.openingStock.toString(),\r\n      item.itemsSold.toString(),\r\n      item.stockIn.toString(),\r\n      item.transferOut.toString(),\r\n      item.returnIn.toString(),\r\n      item.returnOut.toString(),\r\n      item.closingStock.toString()\r\n    ]);\r\n\r\n    const csvContent = [\r\n      headers.join(','),\r\n      ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv' });\r\n    const url = window.URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = `stock-summary-filtered-${format(dateRange?.from || new Date(), 'yyyy-MM-dd')}.csv`;\r\n    link.click();\r\n    window.URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const exportToPDF = () => {\r\n    exportStockSummaryToPDF(filteredStockData, 'Current Period', dateRange);\r\n  };\r\n\r\n  const handleProductClick = (productId: string) => {\r\n    navigate(`/inventory/${productId}`);\r\n  };\r\n\r\n  const handleFilteredDataChange = (filteredData: StockSummaryData[]) => {\r\n    setFilteredStockData(filteredData);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header and Filters */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"flex items-center justify-end mb-4\">\r\n            <Button\r\n              onClick={handleRefresh}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              disabled={isLoading}\r\n              className=\"gap-2\"\r\n            >\r\n              <RefreshCw className={`h-4 w-4 ${isLoading ? 'animate-spin' : ''}`} />\r\n              Refresh Data\r\n            </Button>\r\n          </div>\r\n          <StockSummaryFilters\r\n            period={period}\r\n            setPeriod={setPeriod}\r\n            dateRange={dateRange}\r\n            setDateRange={setDateRange}\r\n            specificDay={specificDay}\r\n            setSpecificDay={setSpecificDay}\r\n            onExportCSV={exportToCSV}\r\n            onExportPDF={exportToPDF}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Stock Summary Table */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <StockSummaryTable\r\n            data={stockSummaryData}\r\n            isLoading={isLoading}\r\n            onProductClick={handleProductClick}\r\n            onFilteredDataChange={handleFilteredDataChange}\r\n            currentProducts={products}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Stock Summary Overview */}\r\n      <StockSummaryOverview data={filteredStockData} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StockSummaryTab;\r\n","\r\nimport React from 'react';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Calendar } from 'lucide-react';\r\n\r\ninterface StockHistoryDateFilterProps {\r\n  selectedFilter: string;\r\n  onFilterChange: (filter: string) => void;\r\n}\r\n\r\nconst StockHistoryDateFilter: React.FC<StockHistoryDateFilterProps> = ({\r\n  selectedFilter,\r\n  onFilterChange\r\n}) => {\r\n  return (\r\n    <div className=\"flex items-center gap-2\">\r\n      <Calendar size={16} />\r\n      <Select value={selectedFilter} onValueChange={onFilterChange}>\r\n        <SelectTrigger className=\"w-[180px]\">\r\n          <SelectValue placeholder=\"Select date range\" />\r\n        </SelectTrigger>\r\n        <SelectContent>\r\n          <SelectItem value=\"today\">Today</SelectItem>\r\n          <SelectItem value=\"yesterday\">Yesterday</SelectItem>\r\n          <SelectItem value=\"this-week\">This Week</SelectItem>\r\n          <SelectItem value=\"last-week\">Last Week</SelectItem>\r\n          <SelectItem value=\"this-month\">This Month</SelectItem>\r\n          <SelectItem value=\"last-month\">Last Month</SelectItem>\r\n          <SelectItem value=\"this-year\">This Year</SelectItem>\r\n          <SelectItem value=\"all\">All Time</SelectItem>\r\n        </SelectContent>\r\n      </Select>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StockHistoryDateFilter;\r\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { StockHistoryEntry } from '@/types';\r\nimport { format } from 'date-fns';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\n\r\ninterface EditGroupDateDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    group: { supplier?: string; invoice?: string; date: Date; entries: StockHistoryEntry[] } | null;\r\n    onConfirm: (newDate: Date) => Promise<boolean>;\r\n}\r\n\r\nexport const EditGroupDateDialog: React.FC<EditGroupDateDialogProps> = ({\r\n    open,\r\n    onOpenChange,\r\n    group,\r\n    onConfirm,\r\n}) => {\r\n    const { user } = useAuth();\r\n    const { products } = useProducts(user?.id);\r\n    const [newDate, setNewDate] = useState<string>('');\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [validationError, setValidationError] = useState<string>('');\r\n    const { toast } = useToast();\r\n\r\n    useEffect(() => {\r\n        if (group) {\r\n            setNewDate(format(new Date(group.date), 'yyyy-MM-dd'));\r\n            setValidationError('');\r\n        }\r\n    }, [group]);\r\n\r\n    const handleDateChange = (value: string) => {\r\n        setNewDate(value);\r\n        setValidationError('');\r\n    };\r\n\r\n    const validateDate = (): boolean => {\r\n        if (!group || !newDate) return false;\r\n\r\n        const selectedDate = new Date(newDate);\r\n        selectedDate.setHours(23, 59, 59, 999); // Allow same day\r\n\r\n        // Check against all products in the group\r\n        for (const entry of group.entries) {\r\n            const product = products.find(p => p.id === entry.productId);\r\n            if (product && product.createdAt) {\r\n                const createdAt = new Date(product.createdAt);\r\n                if (selectedDate < createdAt) {\r\n                    setValidationError(`New date cannot be earlier than product creation date (${format(createdAt, 'PP')}) for ${product.name}.`);\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        if (!group || !newDate) return;\r\n\r\n        if (!validateDate()) return;\r\n\r\n        setIsSubmitting(true);\r\n        try {\r\n            const success = await onConfirm(new Date(newDate));\r\n            if (success) {\r\n                toast({\r\n                    title: \"Dates updated\",\r\n                    description: \"All entries in this invoice have been updated to the new date.\"\r\n                });\r\n                onOpenChange(false);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error updating group date:', error);\r\n            toast({\r\n                title: \"Update failed\",\r\n                description: \"An error occurred while updating the dates.\",\r\n                variant: \"destructive\"\r\n            });\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    if (!group) return null;\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-md\">\r\n                <DialogHeader>\r\n                    <DialogTitle>Edit Invoice Date</DialogTitle>\r\n                    <DialogDescription>\r\n                        This will update the date for all {group.entries.length} items in this invoice.\r\n                        Time settings for each item will be preserved.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <div className=\"space-y-4 py-4\">\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"date\">New Date</Label>\r\n                        <Input\r\n                            id=\"date\"\r\n                            type=\"date\"\r\n                            value={newDate}\r\n                            onChange={(e) => handleDateChange(e.target.value)}\r\n                            className={validationError ? 'border-destructive' : ''}\r\n                        />\r\n                        {validationError && (\r\n                            <p className=\"text-sm text-destructive\">{validationError}</p>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"bg-muted p-3 rounded-lg text-sm space-y-1\">\r\n                        {group.supplier && <div><strong>Supplier:</strong> {group.supplier}</div>}\r\n                        {group.invoice && <div><strong>Invoice:</strong> {group.invoice}</div>}\r\n                        <div><strong>Current Date:</strong> {format(new Date(group.date), 'PP')}</div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex justify-end gap-2 mt-4\">\r\n                    <Button variant=\"outline\" onClick={() => onOpenChange(false)} disabled={isSubmitting}>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={handleSubmit} disabled={isSubmitting}>\r\n                        {isSubmitting ? 'Updating...' : 'Update Dates'}\r\n                    </Button>\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n};\r\n","import React from 'react';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from '@/components/ui/alert-dialog';\r\nimport { StockHistoryEntry } from '@/types';\r\n\r\ninterface DeleteInvoiceDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  group: {\r\n    supplier: string;\r\n    invoice: string;\r\n    entries: StockHistoryEntry[];\r\n  } | null;\r\n  onConfirm: (entryIds: string[]) => Promise<boolean>;\r\n}\r\n\r\nexport const DeleteInvoiceDialog: React.FC<DeleteInvoiceDialogProps> = ({\r\n  open,\r\n  onOpenChange,\r\n  group,\r\n  onConfirm\r\n}) => {\r\n  const handleConfirm = async () => {\r\n    if (!group) return;\r\n    \r\n    const entryIds = group.entries.map(entry => entry.id);\r\n    const success = await onConfirm(entryIds);\r\n    if (success) {\r\n      onOpenChange(false);\r\n    }\r\n  };\r\n\r\n  if (!group) return null;\r\n\r\n  return (\r\n    <AlertDialog open={open} onOpenChange={onOpenChange}>\r\n      <AlertDialogContent>\r\n        <AlertDialogHeader>\r\n          <AlertDialogTitle>Delete Entire Invoice</AlertDialogTitle>\r\n          <AlertDialogDescription className=\"space-y-2\">\r\n            <p>\r\n              Are you sure you want to delete all stock entries for this invoice?\r\n            </p>\r\n            <div className=\"bg-muted p-3 rounded-lg\">\r\n              <p><strong>Supplier:</strong> {group.supplier}</p>\r\n              <p><strong>Invoice:</strong> {group.invoice}</p>\r\n              <p><strong>Items:</strong> {group.entries.length} products will be affected</p>\r\n            </div>\r\n            <p className=\"text-destructive text-sm\">\r\n              This will permanently remove all stock history entries for this purchase and recalculate stock levels. This action cannot be undone.\r\n            </p>\r\n          </AlertDialogDescription>\r\n        </AlertDialogHeader>\r\n        <AlertDialogFooter>\r\n          <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n          <AlertDialogAction\r\n            onClick={handleConfirm}\r\n            className=\"bg-destructive hover:bg-destructive/90\"\r\n          >\r\n            Delete Invoice\r\n          </AlertDialogAction>\r\n        </AlertDialogFooter>\r\n      </AlertDialogContent>\r\n    </AlertDialog>\r\n  );\r\n};","import React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { getActivityByEntityIdsAction, updateStockHistoryDatesAction } from '@/app/actions/inventory';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { History, Edit, Trash2, Search } from 'lucide-react';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useStockHistory } from '@/hooks/useStockHistory';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { useStockSummaryData } from '@/hooks/useStockSummaryData';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { format } from 'date-fns';\r\nimport { getDateRangeFromFilter } from '@/utils/dateFilters';\r\nimport StockHistoryDateFilter from './StockHistoryDateFilter';\r\nimport EditStockHistoryDialog from './EditStockHistoryDialog';\r\nimport { EditGroupDateDialog } from './EditGroupDateDialog';\r\nimport DeleteStockHistoryDialog from './DeleteStockHistoryDialog';\r\nimport { DeleteInvoiceDialog } from './DeleteInvoiceDialog';\r\nimport { StockHistoryEntry } from '@/types';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from '@/components/ui/dropdown-menu';\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\nconst StockInputHistory = () => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const { stockHistory, isLoading, updateStockHistoryEntry, deleteStockHistoryEntry, deleteMultipleStockHistoryEntries, recalculateProductStock, loadStockHistory } = useStockHistory(user?.id);\r\n  const { products, loadProducts } = useProducts(user?.id, 10000);\r\n  const { settings } = useBusinessSettings();\r\n  const { clearAllLocationCaches } = useStockSummaryData({ from: undefined, to: undefined });\r\n  const { formatFinancial, canViewCostPrice } = useFinancialVisibility();\r\n\r\n  const [dateFilter, setDateFilter] = useState<string>('this-month');\r\n  const [searchTerm, setSearchTerm] = useState<string>('');\r\n  const [debouncedSearchTerm, setDebouncedSearchTerm] = useState<string>('');\r\n  const [editHistoryDialog, setEditHistoryDialog] = useState<{ open: boolean; entry: StockHistoryEntry | null }>({ open: false, entry: null });\r\n  const [editGroupDateDialog, setEditGroupDateDialog] = useState<{ open: boolean; group: { date: Date; entries: StockHistoryEntry[]; supplier?: string; invoice?: string } | null }>({ open: false, group: null });\r\n  const [deleteHistoryDialog, setDeleteHistoryDialog] = useState<{ open: boolean; entry: StockHistoryEntry | null }>({ open: false, entry: null });\r\n  const [deleteInvoiceDialog, setDeleteInvoiceDialog] = useState<{ open: boolean; group: { supplier: string; invoice: string; entries: StockHistoryEntry[] } | null }>({ open: false, group: null });\r\n  const [scavengedNames, setScavengedNames] = useState<Record<string, string>>({});\r\n  const [isScavenging, setIsScavenging] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedSearchTerm(searchTerm);\r\n    }, 300);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [searchTerm]);\r\n\r\n  const getCurrencySymbol = (currency: string) => {\r\n    const symbols: Record<string, string> = {\r\n      'USD': '$',\r\n      'EUR': '',\r\n      'GBP': '',\r\n      'NGN': '',\r\n      'GHS': '',\r\n      'KES': 'KSh',\r\n      'ZAR': 'R',\r\n      'EGP': 'E'\r\n    };\r\n    return symbols[currency] || currency;\r\n  };\r\n\r\n  const currencySymbol = getCurrencySymbol(settings.currency);\r\n\r\n  useEffect(() => {\r\n    const handleStockHistoryUpdate = () => {\r\n      loadStockHistory();\r\n    };\r\n\r\n    window.addEventListener('stock-history-updated', handleStockHistoryUpdate);\r\n\r\n    return () => {\r\n      window.removeEventListener('stock-history-updated', handleStockHistoryUpdate);\r\n    };\r\n  }, [loadStockHistory]);\r\n\r\n  useEffect(() => {\r\n    const scavengeNames = async () => {\r\n      if (!stockHistory.length || products.length === 0 || isScavenging) return;\r\n\r\n      const missingProductIds = Array.from(new Set(\r\n        stockHistory\r\n          .map(entry => entry.productId)\r\n          .filter(id => {\r\n            if (!id) return false;\r\n            const exists = products.some(p => p.id === id || p.itemNumber === id);\r\n            return !exists && !scavengedNames[id];\r\n          })\r\n      ));\r\n\r\n      if (missingProductIds.length === 0) return;\r\n\r\n      setIsScavenging(true);\r\n      try {\r\n        // Fetch entity names from activity history via server action\r\n        const result = await getActivityByEntityIdsAction(missingProductIds);\r\n        const newNames: Record<string, string> = { ...scavengedNames };\r\n\r\n        if (result.success && result.data) {\r\n          result.data.forEach((item: any) => {\r\n            if (item.entityId && item.entityName && !newNames[item.entityId]) {\r\n              newNames[item.entityId] = item.entityName;\r\n            }\r\n          });\r\n        }\r\n\r\n        if (Object.keys(newNames).length > Object.keys(scavengedNames).length) {\r\n          setScavengedNames(newNames);\r\n        }\r\n      } catch (err) {\r\n        console.error('Error scavenging names:', err);\r\n      } finally {\r\n        setIsScavenging(false);\r\n      }\r\n    };\r\n\r\n    scavengeNames();\r\n  }, [stockHistory, products, isScavenging, scavengedNames]);\r\n\r\n  const formatNumber = (num: number) => {\r\n    return parseFloat(num.toFixed(5)).toLocaleString();\r\n  };\r\n\r\n  const dateRange = dateFilter === 'all' ? null : getDateRangeFromFilter(dateFilter);\r\n\r\n  const { filteredBulkGroups, filteredRegularGroups } = useMemo(() => {\r\n    try {\r\n      if (isLoading || !stockHistory.length) {\r\n        return { filteredBulkGroups: [], filteredRegularGroups: [] };\r\n      }\r\n\r\n      const filteredHistory = stockHistory.filter(entry => {\r\n        try {\r\n          const entryDate = new Date(entry.createdAt);\r\n          let isInDateRange = true;\r\n\r\n          if (dateRange) {\r\n            isInDateRange = entryDate >= dateRange.from && entryDate <= dateRange.to;\r\n          }\r\n\r\n          return isInDateRange && entry.newQuantity > entry.oldQuantity;\r\n        } catch {\r\n          return false;\r\n        }\r\n      });\r\n\r\n      const bulkStockAdditions = filteredHistory.filter(entry => {\r\n        const reason = entry.changeReason?.toLowerCase() || '';\r\n        return reason.includes('purchase:') ||\r\n          reason.includes('invoice:') ||\r\n          reason.includes('supplier:') ||\r\n          reason.includes('session:');\r\n      });\r\n\r\n      const regularStockAdditions = filteredHistory.filter(entry => {\r\n        const reason = entry.changeReason?.toLowerCase() || '';\r\n        return !reason.includes('purchase:') &&\r\n          !reason.includes('invoice:') &&\r\n          !reason.includes('supplier:') &&\r\n          !reason.includes('session:');\r\n      });\r\n\r\n      const groupedBulkHistory = bulkStockAdditions.reduce((groups, entry) => {\r\n        try {\r\n          const sessionMatch = entry.changeReason?.match(/Session: (\\d+)/);\r\n          const sessionId = sessionMatch ? sessionMatch[1] : entry.createdAt.toString();\r\n\r\n          if (!groups[sessionId]) {\r\n            const supplierMatch = entry.changeReason?.match(/Purchase: ([^|]+)/);\r\n            const invoiceMatch = entry.changeReason?.match(/Invoice: ([^|]+)/);\r\n\r\n            groups[sessionId] = {\r\n              date: entry.createdAt,\r\n              sessionId,\r\n              supplier: supplierMatch ? supplierMatch[1].trim() : 'Unknown Supplier',\r\n              invoice: invoiceMatch ? invoiceMatch[1].trim() : 'N/A',\r\n              entries: []\r\n            };\r\n          }\r\n\r\n          groups[sessionId].entries.push(entry);\r\n          return groups;\r\n        } catch {\r\n          return groups;\r\n        }\r\n      }, {} as Record<string, { date: Date; sessionId: string; supplier: string; invoice: string; entries: typeof bulkStockAdditions }>);\r\n\r\n      Object.values(groupedBulkHistory).forEach(group => {\r\n        try {\r\n          group.entries.sort((a, b) => {\r\n            const seqA = a.changeReason?.match(/Seq: (\\d+)/);\r\n            const seqB = b.changeReason?.match(/Seq: (\\d+)/);\r\n\r\n            if (seqA && seqB) {\r\n              return parseInt(seqA[1]) - parseInt(seqB[1]);\r\n            }\r\n\r\n            return new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime();\r\n          });\r\n        } catch {\r\n        }\r\n      });\r\n\r\n      const groupedRegularHistory = regularStockAdditions.reduce((groups, entry) => {\r\n        try {\r\n          const dateKey = format(new Date(entry.createdAt), 'yyyy-MM-dd');\r\n\r\n          if (!groups[dateKey]) {\r\n            groups[dateKey] = {\r\n              date: entry.createdAt,\r\n              entries: []\r\n            };\r\n          }\r\n\r\n          groups[dateKey].entries.push(entry);\r\n          return groups;\r\n        } catch {\r\n          return groups;\r\n        }\r\n      }, {} as Record<string, { date: Date; entries: typeof regularStockAdditions }>);\r\n\r\n      Object.values(groupedRegularHistory).forEach(group => {\r\n        try {\r\n          group.entries.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\r\n        } catch {\r\n        }\r\n      });\r\n\r\n      const sortedBulkGroups = Object.values(groupedBulkHistory).sort(\r\n        (a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()\r\n      );\r\n\r\n      const sortedRegularGroups = Object.values(groupedRegularHistory).sort(\r\n        (a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()\r\n      );\r\n\r\n      const filteredBulkGroups = sortedBulkGroups.filter(group => {\r\n        if (!debouncedSearchTerm.trim()) return true;\r\n\r\n        try {\r\n          const searchLower = debouncedSearchTerm.toLowerCase().trim();\r\n          const matchesSupplier = group.supplier?.toLowerCase()?.includes(searchLower) || false;\r\n          const matchesInvoice = group.invoice?.toLowerCase()?.includes(searchLower) || false;\r\n\r\n          const matchesProduct = group.entries.some(entry => {\r\n            if (!entry?.productId) return false;\r\n            try {\r\n              const productDetails = getProductDetails(entry);\r\n              return productDetails.name.toLowerCase().includes(searchLower);\r\n            } catch {\r\n              return false;\r\n            }\r\n          });\r\n\r\n          return matchesSupplier || matchesInvoice || matchesProduct;\r\n        } catch {\r\n          return false;\r\n        }\r\n      });\r\n\r\n      const filteredRegularGroups = sortedRegularGroups.filter(group => {\r\n        if (!debouncedSearchTerm.trim()) return true;\r\n\r\n        try {\r\n          const searchLower = debouncedSearchTerm.toLowerCase().trim();\r\n          return group.entries.some(entry => {\r\n            try {\r\n              if (!entry?.productId) {\r\n                return entry.changeReason?.toLowerCase()?.includes(searchLower) || false;\r\n              }\r\n              const productDetails = getProductDetails(entry);\r\n              const matchesProduct = productDetails.name.toLowerCase().includes(searchLower);\r\n              const matchesReason = entry.changeReason?.toLowerCase()?.includes(searchLower) || false;\r\n              return matchesProduct || matchesReason;\r\n            } catch {\r\n              return false;\r\n            }\r\n          });\r\n        } catch {\r\n          return false;\r\n        }\r\n      });\r\n\r\n      return { filteredBulkGroups, filteredRegularGroups };\r\n    } catch (error) {\r\n      console.error('Error in filtering logic:', error);\r\n      return { filteredBulkGroups: [], filteredRegularGroups: [] };\r\n    }\r\n  }, [stockHistory, products, dateRange, debouncedSearchTerm, isLoading]);\r\n\r\n  const getProductDetails = useCallback((entry: StockHistoryEntry) => {\r\n    try {\r\n      if (!entry) return { name: \"Unknown\", costPrice: 0, sellingPrice: 0 };\r\n\r\n      const { productId, changeReason, product: joinedProduct } = entry;\r\n\r\n      if (joinedProduct) {\r\n        return {\r\n          name: joinedProduct.name,\r\n          costPrice: joinedProduct.costPrice,\r\n          sellingPrice: joinedProduct.sellingPrice\r\n        };\r\n      }\r\n\r\n      const cachedProduct = products.find(p => p.id === productId || p.itemNumber === productId);\r\n      if (cachedProduct) {\r\n        return {\r\n          name: cachedProduct.name,\r\n          costPrice: cachedProduct.costPrice,\r\n          sellingPrice: cachedProduct.sellingPrice\r\n        };\r\n      }\r\n\r\n      if (changeReason) {\r\n        const nameMatch = changeReason.match(/^\\[(.*?)\\]\\s*\\|/);\r\n        if (nameMatch) {\r\n          return {\r\n            name: nameMatch[1],\r\n            costPrice: 0,\r\n            sellingPrice: 0\r\n          };\r\n        }\r\n      }\r\n\r\n      if (scavengedNames[productId]) {\r\n        return {\r\n          name: scavengedNames[productId],\r\n          costPrice: 0,\r\n          sellingPrice: 0\r\n        };\r\n      }\r\n\r\n      const idStr = productId || \"\";\r\n      return {\r\n        name: `Deleted Product (${idStr.length > 8 ? idStr.slice(-8) : idStr})`,\r\n        costPrice: 0,\r\n        sellingPrice: 0\r\n      };\r\n    } catch (err) {\r\n      console.error('Error in getProductDetails:', err);\r\n      return {\r\n        name: \"Deleted Product\",\r\n        costPrice: 0,\r\n        sellingPrice: 0\r\n      };\r\n    }\r\n  }, [products, scavengedNames]);\r\n\r\n  const calculateGroupTotals = (entries: StockHistoryEntry[]) => {\r\n    return entries.reduce((totals, entry) => {\r\n      const productDetails = getProductDetails(entry);\r\n      const qtyAdded = entry.newQuantity - entry.oldQuantity;\r\n      const amount = qtyAdded * productDetails.costPrice;\r\n\r\n      return {\r\n        totalQty: totals.totalQty + qtyAdded,\r\n        totalAmount: totals.totalAmount + amount\r\n      };\r\n    }, { totalQty: 0, totalAmount: 0 });\r\n  };\r\n\r\n  const handleProductClick = (productId: string) => {\r\n    navigate(`/inventory/${productId}`);\r\n  };\r\n\r\n  const handleEditStockHistory = async (entryId: string, newQuantity: number, newReason: string, newDate?: Date) => {\r\n    const entry = stockHistory.find(e => e.id === entryId);\r\n    if (!entry) return false;\r\n\r\n    const success = await updateStockHistoryEntry(entryId, newQuantity, newReason, newDate);\r\n    if (success) {\r\n      clearAllLocationCaches();\r\n      await Promise.all([\r\n        recalculateProductStock(entry.productId),\r\n        loadStockHistory()\r\n      ]);\r\n    }\r\n    return success;\r\n  };\r\n\r\n  const handleDeleteStockHistory = async (entryId: string) => {\r\n    const entry = stockHistory.find(e => e.id === entryId);\r\n    if (!entry) return false;\r\n\r\n    const success = await deleteStockHistoryEntry(entryId);\r\n    if (success) {\r\n      clearAllLocationCaches();\r\n      await Promise.all([\r\n        recalculateProductStock(entry.productId),\r\n        loadStockHistory()\r\n      ]);\r\n    }\r\n    return success;\r\n  };\r\n\r\n  const handleDeleteInvoice = (group: { supplier: string; invoice: string; entries: StockHistoryEntry[] }) => {\r\n    setDeleteInvoiceDialog({ open: true, group });\r\n  };\r\n\r\n  const handleEditGroupDate = (group: { date: Date; entries: StockHistoryEntry[]; supplier?: string; invoice?: string }) => {\r\n    setEditGroupDateDialog({ open: true, group });\r\n  };\r\n\r\n  const handleEditGroupDateConfirm = async (newDate: Date) => {\r\n    if (!editGroupDateDialog.group) return false;\r\n\r\n    const entryIds = editGroupDateDialog.group.entries.map(e => e.id);\r\n    const productIds = Array.from(new Set(editGroupDateDialog.group.entries.map(e => e.productId)));\r\n\r\n    try {\r\n      const result = await updateStockHistoryDatesAction(entryIds, newDate.toISOString());\r\n      if (!result.success) throw new Error(result.error);\r\n\r\n      await Promise.all(productIds.map(id => recalculateProductStock(id)));\r\n\r\n      clearAllLocationCaches();\r\n      await Promise.all([\r\n        loadStockHistory(),\r\n        loadProducts()\r\n      ]);\r\n\r\n      return true;\r\n    } catch (err) {\r\n      console.error('Error updating invoice date:', err);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const handleDeleteInvoiceConfirm = async (entryIds: string[]) => {\r\n    const success = await deleteMultipleStockHistoryEntries(entryIds);\r\n    if (success) {\r\n      clearAllLocationCaches();\r\n      await Promise.all([\r\n        loadStockHistory(),\r\n        loadProducts()\r\n      ]);\r\n      window.dispatchEvent(new CustomEvent('stock-updated'));\r\n    }\r\n    return success;\r\n  };\r\n\r\n  return (\r\n    <Card className=\"mt-6 shadow-sm\">\r\n      <CardHeader className=\"pb-3 md:pb-6\">\r\n        <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <History size={20} />\r\n            <div>\r\n              <CardTitle className=\"text-base md:text-lg\">Stock Input History</CardTitle>\r\n              <p className=\"text-sm text-muted-foreground mt-1\">\r\n                View all stock additions and increases\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <StockHistoryDateFilter\r\n            selectedFilter={dateFilter}\r\n            onFilterChange={setDateFilter}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"mt-4\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4\" />\r\n            <Input\r\n              placeholder=\"Search by supplier, invoice, or item name...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"pl-10\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </CardHeader>\r\n\r\n      <CardContent className=\"p-0\">\r\n        {isLoading ? (\r\n          <div className=\"flex items-center justify-center py-8\">\r\n            <div className=\"text-sm text-muted-foreground\">Loading history...</div>\r\n          </div>\r\n        ) : filteredBulkGroups.length === 0 && filteredRegularGroups.length === 0 ? (\r\n          <div className=\"text-center py-8 text-muted-foreground\">\r\n            <History size={48} className=\"mx-auto mb-4 opacity-50\" />\r\n            <p>{searchTerm.trim() ? 'No matching stock history found.' : 'No stock input history found for the selected date range.'}</p>\r\n          </div>\r\n        ) : (\r\n          <TooltipProvider>\r\n            <div className=\"space-y-6 p-4\">\r\n              {filteredBulkGroups.length > 0 && (\r\n                <div>\r\n                  <div className=\"mb-4\">\r\n                    <h3 className=\"text-lg font-semibold text-primary\">Stock Purchases</h3>\r\n                    <p className=\"text-sm text-muted-foreground\">Stock purchased from suppliers</p>\r\n                  </div>\r\n                  <div className=\"space-y-6\">\r\n                    {filteredBulkGroups.map((group, groupIndex) => {\r\n                      const groupTotals = calculateGroupTotals(group.entries);\r\n\r\n                      return (\r\n                        <div key={`purchase-${groupIndex}`} className=\"border rounded-lg overflow-hidden\">\r\n                          <div className=\"bg-primary/5 px-4 py-3 border-b\">\r\n                            <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-2\">\r\n                              <div className=\"space-y-1\">\r\n                                <div className=\"flex items-center gap-4\">\r\n                                  <h4 className=\"font-semibold text-base\">\r\n                                    {format(new Date(group.date), 'PPP')}\r\n                                  </h4>\r\n                                  <span className=\"text-xs bg-primary/20 text-primary px-2 py-1 rounded-full\">\r\n                                    {group.entries.length} item{group.entries.length > 1 ? 's' : ''}\r\n                                  </span>\r\n                                </div>\r\n                                <div className=\"flex flex-col md:flex-row md:items-center gap-1 md:gap-4 text-sm text-muted-foreground\">\r\n                                  <span><strong>Supplier:</strong> {group.supplier}</span>\r\n                                  <span><strong>Invoice:</strong> {group.invoice}</span>\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"flex gap-2\">\r\n                                <Button\r\n                                  variant=\"outline\"\r\n                                  size=\"sm\"\r\n                                  onClick={() => handleEditGroupDate(group)}\r\n                                  className=\"h-8 px-3 text-xs\"\r\n                                >\r\n                                  <Edit className=\"h-3 w-3 mr-1\" />\r\n                                  Edit Date\r\n                                </Button>\r\n                                <Button\r\n                                  variant=\"ghost\"\r\n                                  size=\"sm\"\r\n                                  onClick={() => handleDeleteInvoice(group)}\r\n                                  className=\"h-8 px-3 text-xs text-destructive hover:text-destructive\"\r\n                                >\r\n                                  <Trash2 className=\"h-3 w-3 mr-1\" />\r\n                                  Delete Invoice\r\n                                </Button>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div className=\"overflow-x-auto\">\r\n                            <Table>\r\n                              <TableHeader>\r\n                                <TableRow>\r\n                                  <TableHead className=\"w-[200px]\">Item</TableHead>\r\n                                  <TableHead className=\"w-[100px]\">Qty Added</TableHead>\r\n                                  <TableHead className=\"w-[100px]\">Price</TableHead>\r\n                                  <TableHead className=\"w-[100px]\">Amount</TableHead>\r\n                                  <TableHead className=\"w-[100px]\">Time</TableHead>\r\n                                  <TableHead className=\"w-[60px]\">Actions</TableHead>\r\n                                </TableRow>\r\n                              </TableHeader>\r\n                              <TableBody>\r\n                                {group.entries.map((entry) => {\r\n                                  const productDetails = getProductDetails(entry);\r\n                                  const qtyAdded = entry.newQuantity - entry.oldQuantity;\r\n                                  const price = productDetails.costPrice;\r\n                                  const amount = qtyAdded * price;\r\n                                  const productExistsInCache = products.some(p => p.id === entry.productId || p.itemNumber === entry.productId);\r\n\r\n                                  return (\r\n                                    <TableRow key={entry.id}>\r\n                                      <TableCell className=\"font-medium\">\r\n                                        {productExistsInCache ? (\r\n                                          <Tooltip>\r\n                                            <TooltipTrigger asChild>\r\n                                              <button\r\n                                                onClick={() => handleProductClick(entry.productId)}\r\n                                                className=\"text-left hover:text-primary hover:underline cursor-pointer transition-colors max-w-[200px] truncate\"\r\n                                              >\r\n                                                {productDetails.name}\r\n                                              </button>\r\n                                            </TooltipTrigger>\r\n                                            <TooltipContent side=\"top\" className=\"max-w-xs\">\r\n                                              <div className=\"space-y-1\">\r\n                                                <p className=\"font-bold break-words whitespace-normal\">{productDetails.name}</p>\r\n                                                {entry.changeReason && (\r\n                                                  <p className=\"text-xs text-muted-foreground\">{entry.changeReason}</p>\r\n                                                )}\r\n                                              </div>\r\n                                            </TooltipContent>\r\n                                          </Tooltip>\r\n                                        ) : (\r\n                                          <span className=\"max-w-[200px] truncate block\">{productDetails.name}</span>\r\n                                        )}\r\n                                      </TableCell>\r\n                                      <TableCell className=\"text-green-700 bg-green-50 font-medium px-3 py-2 rounded-lg border border-green-200\">\r\n                                        {entry.oldQuantity}  {entry.newQuantity} (+{formatNumber(qtyAdded)})\r\n                                      </TableCell>\r\n                                      <TableCell>\r\n                                        {canViewCostPrice ? `${currencySymbol}${formatFinancial(price, 'cost')}` : ''}\r\n                                      </TableCell>\r\n                                      <TableCell className=\"font-medium\">\r\n                                        {canViewCostPrice ? `${currencySymbol}${formatNumber(amount)}` : ''}\r\n                                      </TableCell>\r\n                                      <TableCell className=\"text-sm text-muted-foreground\">\r\n                                        {format(new Date(entry.createdAt), 'p')}\r\n                                      </TableCell>\r\n                                      <TableCell>\r\n                                        <div className=\"flex gap-1\">\r\n                                          <Button\r\n                                            variant=\"ghost\"\r\n                                            size=\"sm\"\r\n                                            onClick={() => setEditHistoryDialog({ open: true, entry })}\r\n                                            className=\"h-8 w-8 p-0\"\r\n                                          >\r\n                                            <Edit className=\"h-4 w-4\" />\r\n                                          </Button>\r\n                                          <Button\r\n                                            variant=\"ghost\"\r\n                                            size=\"sm\"\r\n                                            onClick={() => setDeleteHistoryDialog({ open: true, entry })}\r\n                                            className=\"h-8 w-8 p-0 text-destructive hover:text-destructive\"\r\n                                          >\r\n                                            <Trash2 className=\"h-4 w-4\" />\r\n                                          </Button>\r\n                                        </div>\r\n                                      </TableCell>\r\n                                    </TableRow>\r\n                                  );\r\n                                })}\r\n                                <TableRow className=\"bg-primary/5 font-semibold border-t-2\">\r\n                                  <TableCell className=\"font-bold\">\r\n                                    Total\r\n                                  </TableCell>\r\n                                  <TableCell className=\"text-green-700 bg-green-50 font-bold px-3 py-2 rounded-lg border border-green-200\">\r\n                                    Total: +{formatNumber(groupTotals.totalQty)}\r\n                                  </TableCell>\r\n                                  <TableCell>\r\n                                    -\r\n                                  </TableCell>\r\n                                  <TableCell className=\"font-bold\">\r\n                                    {canViewCostPrice ? `${currencySymbol}${formatNumber(groupTotals.totalAmount)}` : ''}\r\n                                  </TableCell>\r\n                                  <TableCell>\r\n                                    -\r\n                                  </TableCell>\r\n                                  <TableCell>\r\n                                    -\r\n                                  </TableCell>\r\n                                </TableRow>\r\n                              </TableBody>\r\n                            </Table>\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {filteredRegularGroups.length > 0 && (\r\n                <div>\r\n                  <div className=\"mb-4\">\r\n                    <h3 className=\"text-lg font-semibold text-muted-foreground\">Regular Stock Additions</h3>\r\n                    <p className=\"text-sm text-muted-foreground\">Individual stock additions and manual adjustments</p>\r\n                  </div>\r\n                  <div className=\"space-y-4\">\r\n                    {filteredRegularGroups.map((group, groupIndex) => {\r\n                      const groupTotals = calculateGroupTotals(group.entries);\r\n\r\n                      return (\r\n                        <div key={`regular-${groupIndex}`} className=\"border rounded-lg overflow-hidden\">\r\n                          <div className=\"bg-muted/50 px-4 py-2 border-b\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                              <h4 className=\"font-medium text-sm\">\r\n                                {format(new Date(group.date), 'PPP')}\r\n                              </h4>\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <span className=\"text-xs text-muted-foreground\">\r\n                                  {group.entries.length} item{group.entries.length > 1 ? 's' : ''}\r\n                                </span>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div className=\"overflow-x-auto\">\r\n                            <Table>\r\n                              <TableHeader>\r\n                                <TableRow>\r\n                                  <TableHead className=\"w-[200px]\">Item</TableHead>\r\n                                  <TableHead className=\"w-[100px]\">Qty Added</TableHead>\r\n                                  <TableHead className=\"w-[100px]\">Price</TableHead>\r\n                                  <TableHead className=\"w-[100px]\">Amount</TableHead>\r\n                                  <TableHead className=\"w-[100px]\">Time</TableHead>\r\n                                  <TableHead className=\"w-[120px]\">Type</TableHead>\r\n                                </TableRow>\r\n                              </TableHeader>\r\n                              <TableBody>\r\n                                {group.entries.map((entry) => {\r\n                                  const productDetails = getProductDetails(entry);\r\n                                  const qtyAdded = entry.newQuantity - entry.oldQuantity;\r\n                                  const price = productDetails.costPrice;\r\n                                  const amount = qtyAdded * price;\r\n                                  const productExistsInCache = products.some(p => p.id === entry.productId || p.itemNumber === entry.productId);\r\n\r\n                                  return (\r\n                                    <TableRow key={entry.id}>\r\n                                      <TableCell className=\"font-medium\">\r\n                                        {productExistsInCache ? (\r\n                                          <Tooltip>\r\n                                            <TooltipTrigger asChild>\r\n                                              <button\r\n                                                onClick={() => handleProductClick(entry.productId)}\r\n                                                className=\"text-left hover:text-primary hover:underline cursor-pointer transition-colors max-w-[200px] truncate\"\r\n                                              >\r\n                                                {productDetails.name}\r\n                                              </button>\r\n                                            </TooltipTrigger>\r\n                                            <TooltipContent side=\"top\" className=\"max-w-xs\">\r\n                                              <div className=\"space-y-1\">\r\n                                                <p className=\"font-bold break-words whitespace-normal\">{productDetails.name}</p>\r\n                                                {entry.changeReason && (\r\n                                                  <p className=\"text-xs text-muted-foreground\">{entry.changeReason}</p>\r\n                                                )}\r\n                                              </div>\r\n                                            </TooltipContent>\r\n                                          </Tooltip>\r\n                                        ) : (\r\n                                          <span className=\"max-w-[200px] truncate block\">{productDetails.name}</span>\r\n                                        )}\r\n                                      </TableCell>\r\n                                      <TableCell className=\"text-green-700 bg-green-50 font-medium px-3 py-2 rounded-lg border border-green-200\">\r\n                                        {entry.oldQuantity}  {entry.newQuantity} (+{formatNumber(qtyAdded)})\r\n                                      </TableCell>\r\n                                      <TableCell>\r\n                                        {canViewCostPrice ? `${currencySymbol}${formatFinancial(price, 'cost')}` : ''}\r\n                                      </TableCell>\r\n                                      <TableCell className=\"font-medium\">\r\n                                        {canViewCostPrice ? `${currencySymbol}${formatNumber(amount)}` : ''}\r\n                                      </TableCell>\r\n                                      <TableCell className=\"text-sm text-muted-foreground\">\r\n                                        {format(new Date(entry.createdAt), 'p')}\r\n                                      </TableCell>\r\n                                      <TableCell>\r\n                                        <span className=\"text-xs bg-muted text-muted-foreground px-2 py-1 rounded-full\">\r\n                                          {entry.changeReason}\r\n                                        </span>\r\n                                      </TableCell>\r\n                                    </TableRow>\r\n                                  );\r\n                                })}\r\n                                <TableRow className=\"bg-muted/30 font-semibold border-t-2\">\r\n                                  <TableCell className=\"font-bold\">\r\n                                    Total\r\n                                  </TableCell>\r\n                                  <TableCell className=\"text-green-700 bg-green-50 font-bold px-3 py-2 rounded-lg border border-green-200\">\r\n                                    Total: +{formatNumber(groupTotals.totalQty)}\r\n                                  </TableCell>\r\n                                  <TableCell>\r\n                                    -\r\n                                  </TableCell>\r\n                                  <TableCell className=\"font-bold\">\r\n                                    {canViewCostPrice ? `${currencySymbol}${formatNumber(groupTotals.totalAmount)}` : ''}\r\n                                  </TableCell>\r\n                                  <TableCell>\r\n                                    -\r\n                                  </TableCell>\r\n                                  <TableCell>\r\n                                    -\r\n                                  </TableCell>\r\n                                </TableRow>\r\n                              </TableBody>\r\n                            </Table>\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </TooltipProvider>\r\n        )}\r\n      </CardContent>\r\n\r\n      <EditStockHistoryDialog\r\n        open={editHistoryDialog.open}\r\n        onOpenChange={(open) => setEditHistoryDialog({ open, entry: null })}\r\n        entry={editHistoryDialog.entry}\r\n        onConfirm={handleEditStockHistory}\r\n        productCreatedAt={editHistoryDialog.entry ? (() => {\r\n          const product = products.find(p => p.id === editHistoryDialog.entry?.productId);\r\n          return product ? new Date(product.createdAt) : undefined;\r\n        })() : undefined}\r\n      />\r\n\r\n      <DeleteStockHistoryDialog\r\n        open={deleteHistoryDialog.open}\r\n        onOpenChange={(open) => setDeleteHistoryDialog({ open, entry: null })}\r\n        entry={deleteHistoryDialog.entry}\r\n        onConfirm={handleDeleteStockHistory}\r\n      />\r\n\r\n      <DeleteInvoiceDialog\r\n        open={deleteInvoiceDialog.open}\r\n        onOpenChange={(open) => setDeleteInvoiceDialog({ open, group: null })}\r\n        group={deleteInvoiceDialog.group}\r\n        onConfirm={handleDeleteInvoiceConfirm}\r\n      />\r\n\r\n      <EditGroupDateDialog\r\n        open={editGroupDateDialog.open}\r\n        onOpenChange={(open) => setEditGroupDateDialog({ open, group: null })}\r\n        group={editGroupDateDialog.group}\r\n        onConfirm={handleEditGroupDateConfirm}\r\n      />\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default StockInputHistory;\r\n","import React, { useState, useCallback, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\r\nimport { Calendar } from '@/components/ui/calendar';\r\nimport { Plus, Trash2, Save, CalendarIcon, ChevronUp, ChevronDown } from 'lucide-react';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { useStockHistory } from '@/hooks/useStockHistory';\r\nimport { Product } from '@/types';\r\nimport ProductSuggestionsPanel from './ProductSuggestionsPanel';\r\nimport { useProductSuggestions } from '@/hooks/useProductSuggestions';\r\nimport StockInputHistory from './StockInputHistory';\r\nimport { format } from 'date-fns';\r\nimport { cn } from '@/lib/utils';\r\ninterface StockAddRow {\r\n  id: string;\r\n  productId: string;\r\n  productName: string;\r\n  quantity: number;\r\n  price: number;\r\n  amount: number;\r\n  searchTerm: string;\r\n}\r\nconst STORAGE_KEY = 'bulkStockAddRows';\r\n\r\n// Mobile Stock Row Component\r\nconst MobileStockRow = ({\r\n  row,\r\n  index,\r\n  onUpdateRow,\r\n  onRemoveRow,\r\n  onProductSelect,\r\n  onInputFocus,\r\n  onAddRowAfter,\r\n  onKeyDown,\r\n  onMoveRow,\r\n  settings,\r\n  canRemove,\r\n  products,\r\n  stockEntryDate,\r\n  isLastRow,\r\n  totalRows\r\n}: {\r\n  row: StockAddRow;\r\n  index: number;\r\n  onUpdateRow: (id: string, field: keyof StockAddRow, value: string | number) => void;\r\n  onRemoveRow: (id: string) => void;\r\n  onProductSelect: (product: Product, rowId: string) => void;\r\n  onInputFocus: (rowId: string) => void;\r\n  onAddRowAfter: (rowId: string) => void;\r\n  onKeyDown: (e: React.KeyboardEvent, rowId: string) => void;\r\n  onMoveRow: (rowId: string, direction: 'up' | 'down') => void;\r\n  settings: any;\r\n  canRemove: boolean;\r\n  products: Product[];\r\n  stockEntryDate: Date;\r\n  isLastRow: boolean;\r\n  totalRows: number;\r\n}) => {\r\n  const formatNumber = (num: number) => {\r\n    return Math.round(num).toLocaleString();\r\n  };\r\n\r\n  // Check if product has date conflict\r\n  const hasDateConflict = row.productId ? (() => {\r\n    const product = products.find(p => p.id === row.productId);\r\n    if (product) {\r\n      const productCreationDate = new Date(product.createdAt);\r\n      const selectedDate = new Date(stockEntryDate);\r\n      const productDate = new Date(productCreationDate.getFullYear(), productCreationDate.getMonth(), productCreationDate.getDate());\r\n      const entryDate = new Date(selectedDate.getFullYear(), selectedDate.getMonth(), selectedDate.getDate());\r\n      return productDate.getTime() > entryDate.getTime();\r\n    }\r\n    return false;\r\n  })() : false;\r\n  const conflictProduct = hasDateConflict ? products.find(p => p.id === row.productId) : null;\r\n  return <Card className={cn(\"mb-4 shadow-sm\", hasDateConflict && \"border-destructive border-2\")}>\r\n    <CardHeader className=\"pb-3\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <CardTitle className=\"text-sm font-medium\">Item #{index + 1}</CardTitle>\r\n        <div className=\"flex gap-2\">\r\n          {/* Move Up/Down buttons */}\r\n          <Button variant=\"outline\" size=\"icon\" onClick={() => onMoveRow(row.id, 'up')} disabled={index === 0} className=\"h-8 w-8\">\r\n            <ChevronUp size={14} />\r\n          </Button>\r\n          <Button variant=\"outline\" size=\"icon\" onClick={() => onMoveRow(row.id, 'down')} disabled={index === totalRows - 1} className=\"h-8 w-8\">\r\n            <ChevronDown size={14} />\r\n          </Button>\r\n          <Button variant=\"outline\" size=\"icon\" onClick={() => onRemoveRow(row.id)} disabled={!canRemove} className=\"h-8 w-8\">\r\n            <Trash2 size={14} />\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </CardHeader>\r\n    <CardContent className=\"space-y-4\">\r\n      {/* Product Search */}\r\n      <div className=\"relative\">\r\n        <label className=\"text-xs font-medium text-muted-foreground mb-1 block\">\r\n          Product\r\n        </label>\r\n        <Input placeholder=\"Type to search products...\" value={row.searchTerm} onChange={e => onUpdateRow(row.id, 'searchTerm', e.target.value)} onFocus={() => onInputFocus(row.id)} onKeyDown={e => onKeyDown(e, row.id)} className={cn(\"w-full\", hasDateConflict && \"border-destructive\")} />\r\n        {hasDateConflict && conflictProduct && <p className=\"text-xs text-destructive mt-1\">\r\n          Product was created on {format(new Date(conflictProduct.createdAt), 'PPP')} - after selected date\r\n        </p>}\r\n      </div>\r\n\r\n      {/* Quantity and Price Row */}\r\n      <div className=\"grid grid-cols-2 gap-3\">\r\n        <div>\r\n          <label className=\"text-xs font-medium text-muted-foreground mb-1 block\">\r\n            Quantity\r\n          </label>\r\n          <Input type=\"number\" min=\"0\" step=\"0.01\" value={row.quantity || ''} onChange={e => onUpdateRow(row.id, 'quantity', parseFloat(e.target.value) || 0)} onKeyDown={e => onKeyDown(e, row.id)} placeholder=\"0\" />\r\n        </div>\r\n        <div>\r\n          <label className=\"text-xs font-medium text-muted-foreground mb-1 block\">\r\n            Price\r\n          </label>\r\n          <Input type=\"number\" min=\"0\" step=\"0.01\" value={row.price || ''} onChange={e => onUpdateRow(row.id, 'price', parseFloat(e.target.value) || 0)} onKeyDown={e => onKeyDown(e, row.id)} placeholder=\"0.00\" />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Amount Display */}\r\n      <div className=\"bg-muted/50 p-3 rounded-md\">\r\n        <div className=\"flex justify-between items-center\">\r\n          <span className=\"text-xs font-medium text-muted-foreground\">Amount:</span>\r\n          <span className=\"font-semibold\">\r\n            {settings.currency} {formatNumber(row.amount)}\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Add Row Button - only show on last row */}\r\n      {isLastRow && <div className=\"flex justify-center pt-2\">\r\n        <Button variant=\"ghost\" size=\"sm\" onClick={() => onAddRowAfter(row.id)} className=\"gap-2 text-muted-foreground hover:text-foreground\">\r\n          <Plus size={14} />\r\n          Add row below\r\n        </Button>\r\n      </div>}\r\n    </CardContent>\r\n  </Card>;\r\n};\r\nconst BulkStockAddTab = () => {\r\n  const {\r\n    user\r\n  } = useAuth();\r\n  const {\r\n    products,\r\n    updateProduct,\r\n    loadProducts\r\n  } = useProducts(user?.id, 10000); // Load all products for proper lookup\r\n  const {\r\n    settings\r\n  } = useBusinessSettings();\r\n  const {\r\n    toast\r\n  } = useToast();\r\n  const isMobile = useIsMobile();\r\n  const {\r\n    stockHistory,\r\n    loadStockHistory\r\n  } = useStockHistory(user?.id);\r\n\r\n  // Get the initial stock date (chronologically first entry)\r\n  const getInitialStockDate = (): Date | null => {\r\n    if (stockHistory.length === 0) return null;\r\n    const sortedHistory = [...stockHistory].sort((a, b) => a.createdAt.getTime() - b.createdAt.getTime());\r\n    return sortedHistory[0]?.createdAt || null;\r\n  };\r\n  const validateStockDate = (date: Date): string => {\r\n    const initialStockDate = getInitialStockDate();\r\n    if (!initialStockDate) return '';\r\n\r\n    // Compare dates at start of day level\r\n    const proposedDate = new Date(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0);\r\n    const initialDate = new Date(initialStockDate.getFullYear(), initialStockDate.getMonth(), initialStockDate.getDate(), 0, 0, 0);\r\n\r\n    // Check if the proposed date is exactly the same as the initial stock date\r\n    if (proposedDate.getTime() === initialDate.getTime()) {\r\n      return `Date cannot be the same as the initial stock entry date (${format(initialStockDate, 'PPP')})`;\r\n    }\r\n\r\n    // Check if the proposed date is before the initial stock date\r\n    if (proposedDate.getTime() < initialDate.getTime()) {\r\n      return `Date cannot be earlier than initial stock date (${format(initialStockDate, 'PPP')})`;\r\n    }\r\n    return '';\r\n  };\r\n\r\n  // Format number with commas and no decimals\r\n  const formatNumber = (num: number) => {\r\n    return Math.round(num).toLocaleString();\r\n  };\r\n\r\n  // State for stock entry date and purchase details\r\n  const [stockEntryDate, setStockEntryDate] = useState<Date>(new Date());\r\n  const [supplierName, setSupplierName] = useState<string>('');\r\n  const [invoiceNumber, setInvoiceNumber] = useState<string>('');\r\n\r\n  // Initialize state with data from localStorage or default row\r\n  const [stockRows, setStockRows] = useState<StockAddRow[]>(() => {\r\n    try {\r\n      const saved = localStorage.getItem(STORAGE_KEY);\r\n      if (saved) {\r\n        const parsedRows = JSON.parse(saved);\r\n        // Ensure we have at least one row and sync searchTerm with productName\r\n        const syncedRows = parsedRows.map((row: StockAddRow) => ({\r\n          ...row,\r\n          searchTerm: row.searchTerm || row.productName || '' // Use productName if searchTerm is empty\r\n        }));\r\n        return syncedRows.length > 0 ? syncedRows : [{\r\n          id: '1',\r\n          productId: '',\r\n          productName: '',\r\n          quantity: 0,\r\n          price: 0,\r\n          amount: 0,\r\n          searchTerm: ''\r\n        }];\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading saved stock rows:', error);\r\n    }\r\n    return [{\r\n      id: '1',\r\n      productId: '',\r\n      productName: '',\r\n      quantity: 0,\r\n      price: 0,\r\n      amount: 0,\r\n      searchTerm: ''\r\n    }];\r\n  });\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [focusedRowId, setFocusedRowId] = useState<string | null>(null);\r\n\r\n  // Save to localStorage whenever stockRows changes\r\n  useEffect(() => {\r\n    try {\r\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(stockRows));\r\n    } catch (error) {\r\n      console.error('Error saving stock rows:', error);\r\n    }\r\n  }, [stockRows]);\r\n\r\n  // Clear localStorage when component unmounts or user saves successfully\r\n  const clearStoredData = useCallback(() => {\r\n    try {\r\n      localStorage.removeItem(STORAGE_KEY);\r\n    } catch (error) {\r\n      console.error('Error clearing stored data:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Create individual product suggestions hook for the focused row\r\n  const focusedRow = stockRows.find(row => row.id === focusedRowId);\r\n  const {\r\n    suggestions,\r\n    isOpen: panelOpen,\r\n    closePanel\r\n  } = useProductSuggestions(products, focusedRow?.searchTerm || '');\r\n  const addNewRow = useCallback(() => {\r\n    const newRow: StockAddRow = {\r\n      id: Date.now().toString(),\r\n      productId: '',\r\n      productName: '',\r\n      quantity: 0,\r\n      price: 0,\r\n      amount: 0,\r\n      searchTerm: ''\r\n    };\r\n    setStockRows(prev => [...prev, newRow]);\r\n  }, []);\r\n  const addRowAfter = useCallback((afterRowId: string) => {\r\n    const newRow: StockAddRow = {\r\n      id: Date.now().toString(),\r\n      productId: '',\r\n      productName: '',\r\n      quantity: 0,\r\n      price: 0,\r\n      amount: 0,\r\n      searchTerm: ''\r\n    };\r\n    setStockRows(prev => {\r\n      const index = prev.findIndex(row => row.id === afterRowId);\r\n      const newRows = [...prev];\r\n      newRows.splice(index + 1, 0, newRow);\r\n      return newRows;\r\n    });\r\n  }, []);\r\n  const moveRow = useCallback((rowId: string, direction: 'up' | 'down') => {\r\n    setStockRows(prev => {\r\n      const index = prev.findIndex(row => row.id === rowId);\r\n      if (index === -1) return prev;\r\n      const newIndex = direction === 'up' ? index - 1 : index + 1;\r\n      if (newIndex < 0 || newIndex >= prev.length) return prev;\r\n      const newRows = [...prev];\r\n      [newRows[index], newRows[newIndex]] = [newRows[newIndex], newRows[index]];\r\n      return newRows;\r\n    });\r\n  }, []);\r\n  const handleKeyDown = useCallback((e: React.KeyboardEvent, rowId: string) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      addRowAfter(rowId);\r\n    }\r\n  }, [addRowAfter]);\r\n  const removeRow = useCallback((id: string) => {\r\n    if (stockRows.length > 1) {\r\n      setStockRows(prev => prev.filter(row => row.id !== id));\r\n      if (focusedRowId === id) {\r\n        setFocusedRowId(null);\r\n      }\r\n    }\r\n  }, [stockRows.length, focusedRowId]);\r\n  const updateRow = useCallback((id: string, field: keyof StockAddRow, value: string | number) => {\r\n    setStockRows(prev => prev.map(row => {\r\n      if (row.id === id) {\r\n        const updatedRow = {\r\n          ...row,\r\n          [field]: value\r\n        };\r\n\r\n        // If searchTerm is updated, clear product selection if it doesn't match\r\n        if (field === 'searchTerm' && typeof value === 'string') {\r\n          const matchingProduct = products.find(p => p.name.toLowerCase() === value.toLowerCase());\r\n          if (!matchingProduct) {\r\n            updatedRow.productId = '';\r\n            updatedRow.productName = '';\r\n            updatedRow.price = 0;\r\n          }\r\n        }\r\n\r\n        // Recalculate amount when quantity or price changes\r\n        if (field === 'quantity' || field === 'price') {\r\n          updatedRow.amount = updatedRow.quantity * updatedRow.price;\r\n        }\r\n        return updatedRow;\r\n      }\r\n      return row;\r\n    }));\r\n  }, [products]);\r\n  const handleProductSelect = useCallback((product: Product) => {\r\n    if (!focusedRowId) return;\r\n\r\n    setStockRows(prev => {\r\n      // Find if this product is already in another row (not the one being edited)\r\n      const existingRowIndex = prev.findIndex(row => row.productId === product.id && row.id !== focusedRowId);\r\n\r\n      if (existingRowIndex !== -1) {\r\n        // Get the current row's potentially entered quantity\r\n        const currentRow = prev.find(row => row.id === focusedRowId);\r\n        const quantityToAdd = currentRow?.quantity || 0;\r\n\r\n        // Merge into the existing row\r\n        const newRows = prev.map((row, idx) => {\r\n          if (idx === existingRowIndex) {\r\n            const newQuantity = row.quantity + quantityToAdd;\r\n            return {\r\n              ...row,\r\n              quantity: newQuantity,\r\n              amount: newQuantity * row.price\r\n            };\r\n          }\r\n          return row;\r\n        });\r\n\r\n        // Remove the focused row\r\n        const finalRows = newRows.filter(row => row.id !== focusedRowId);\r\n\r\n        toast({\r\n          title: \"Product already in list\",\r\n          description: `Merged \"${product.name}\" quantity.`,\r\n        });\r\n\r\n        return finalRows.length > 0 ? finalRows : [{\r\n          id: Date.now().toString(),\r\n          productId: '',\r\n          productName: '',\r\n          quantity: 0,\r\n          price: 0,\r\n          amount: 0,\r\n          searchTerm: ''\r\n        }];\r\n      }\r\n\r\n      // Standard update if no duplicate found\r\n      return prev.map(row => {\r\n        if (row.id === focusedRowId) {\r\n          return {\r\n            ...row,\r\n            productId: product.id,\r\n            productName: product.name,\r\n            searchTerm: product.name,\r\n            price: product.costPrice,\r\n            amount: row.quantity * product.costPrice\r\n          };\r\n        }\r\n        return row;\r\n      });\r\n    });\r\n\r\n    setFocusedRowId(null);\r\n  }, [focusedRowId, toast]);\r\n  const handleInputFocus = useCallback((rowId: string) => {\r\n    setFocusedRowId(rowId);\r\n  }, []);\r\n  const validateRows = useCallback(() => {\r\n    const errors: string[] = [];\r\n    stockRows.forEach((row, index) => {\r\n      if (!row.productId) {\r\n        errors.push(`Row ${index + 1}: Please select a product`);\r\n      }\r\n      if (row.quantity <= 0) {\r\n        errors.push(`Row ${index + 1}: Quantity must be greater than 0`);\r\n      }\r\n      if (row.price < 0) {\r\n        errors.push(`Row ${index + 1}: Price cannot be negative`);\r\n      }\r\n\r\n      // Check if product existed before the selected date\r\n      if (row.productId) {\r\n        const product = products.find(p => p.id === row.productId);\r\n        if (product) {\r\n          const productCreationDate = new Date(product.createdAt);\r\n          const selectedDate = new Date(stockEntryDate);\r\n\r\n          // Compare at date level (ignore time)\r\n          const productDate = new Date(productCreationDate.getFullYear(), productCreationDate.getMonth(), productCreationDate.getDate());\r\n          const entryDate = new Date(selectedDate.getFullYear(), selectedDate.getMonth(), selectedDate.getDate());\r\n          if (productDate.getTime() > entryDate.getTime()) {\r\n            errors.push(`Row ${index + 1}: Product \"${product.name}\" was created on ${format(productCreationDate, 'PPP')} which is after the selected stock date`);\r\n          }\r\n        }\r\n      }\r\n    });\r\n    return errors;\r\n  }, [stockRows, products, stockEntryDate]);\r\n  const handleBulkSave = useCallback(async () => {\r\n    const errors = validateRows();\r\n\r\n    // Add date validation\r\n    const dateError = validateStockDate(stockEntryDate);\r\n    if (dateError) {\r\n      errors.push(dateError);\r\n    }\r\n    if (errors.length > 0) {\r\n      toast({\r\n        title: \"Validation Error\",\r\n        description: errors.join(', '),\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n    setIsLoading(true);\r\n    try {\r\n      let successCount = 0;\r\n      let failureCount = 0;\r\n\r\n      // Consolidate duplicates that might have been entered manually/pasted\r\n      const consolidatedRowsMap = new Map<string, StockAddRow>();\r\n      stockRows.forEach(row => {\r\n        if (!row.productId) return;\r\n        if (consolidatedRowsMap.has(row.productId)) {\r\n          const existing = consolidatedRowsMap.get(row.productId)!;\r\n          existing.quantity += row.quantity;\r\n          // Use the latest price from the list\r\n          existing.price = row.price;\r\n          existing.amount = existing.quantity * existing.price;\r\n        } else {\r\n          consolidatedRowsMap.set(row.productId, { ...row });\r\n        }\r\n      });\r\n\r\n      const consolidatedRows = Array.from(consolidatedRowsMap.values());\r\n\r\n      // Create a unique purchase session ID\r\n      const purchaseSessionId = Date.now().toString();\r\n      const changeReason = `Purchase: ${supplierName || 'Unknown Supplier'} | Invoice: ${invoiceNumber || 'N/A'} | Session: ${purchaseSessionId}`;\r\n\r\n      for (let i = 0; i < consolidatedRows.length; i++) {\r\n        const row = consolidatedRows[i];\r\n        const currentProduct = products.find(p => p.id === row.productId);\r\n        if (currentProduct) {\r\n          const newQuantity = currentProduct.quantity + row.quantity;\r\n          // Include sequence number to maintain order\r\n          const sequencedChangeReason = `${changeReason} | Seq: ${i + 1}`;\r\n          const success = await updateProduct(row.productId, {\r\n            quantity: newQuantity,\r\n            costPrice: row.price\r\n          }, undefined, false, sequencedChangeReason, stockEntryDate);\r\n          if (success) {\r\n            successCount++;\r\n          } else {\r\n            failureCount++;\r\n          }\r\n        }\r\n      }\r\n      if (successCount > 0) {\r\n        toast({\r\n          title: \"Stock Added Successfully\",\r\n          description: `Added stock for ${successCount} product${successCount > 1 ? 's' : ''}`\r\n        });\r\n\r\n        // Clear the form and localStorage\r\n        const newEmptyRow = {\r\n          id: Date.now().toString(),\r\n          productId: '',\r\n          productName: '',\r\n          quantity: 0,\r\n          price: 0,\r\n          amount: 0,\r\n          searchTerm: ''\r\n        };\r\n        setStockRows([newEmptyRow]);\r\n        setSupplierName('');\r\n        setInvoiceNumber('');\r\n        clearStoredData();\r\n\r\n        // Refresh products and stock history immediately\r\n        await Promise.all([loadProducts(), loadStockHistory()]);\r\n\r\n        // Small delay to ensure UI updates\r\n        setTimeout(() => {\r\n          // Force re-render of any cached components\r\n          window.dispatchEvent(new CustomEvent('inventory-updated'));\r\n          window.dispatchEvent(new CustomEvent('stock-history-updated'));\r\n        }, 100);\r\n      }\r\n      if (failureCount > 0) {\r\n        toast({\r\n          title: \"Some Updates Failed\",\r\n          description: `${failureCount} product${failureCount > 1 ? 's' : ''} could not be updated`,\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in bulk stock addition:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to add stock. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [stockRows, products, updateProduct, loadProducts, loadStockHistory, toast, validateRows, clearStoredData, stockEntryDate, supplierName, invoiceNumber]);\r\n  const totalAmount = stockRows.reduce((sum, row) => sum + row.amount, 0);\r\n  const totalQuantity = stockRows.reduce((sum, row) => sum + row.quantity, 0);\r\n  return <div className=\"space-y-4 md:space-y-6\">\r\n    <Card className=\"shadow-sm\">\r\n      <CardHeader className=\"pb-3 md:pb-6\">\r\n        <div className=\"space-y-3 md:space-y-0 md:flex md:items-center md:justify-between\">\r\n          <div>\r\n            <CardTitle className=\"text-base md:text-lg\">Restock in Bulk</CardTitle>\r\n            <p className=\"text-sm text-muted-foreground mt-1\">\r\n              Add stock for multiple products at once\r\n            </p>\r\n          </div>\r\n\r\n          {/* Purchase Details Section */}\r\n          <div className=\"space-y-3\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\r\n              {/* Date Picker */}\r\n              <Popover>\r\n                <PopoverTrigger asChild>\r\n                  <Button variant=\"outline\" className=\"gap-2 justify-start text-left font-normal w-full\">\r\n                    <CalendarIcon size={16} />\r\n                    {format(stockEntryDate, \"MMM d, yyyy\")}\r\n                  </Button>\r\n                </PopoverTrigger>\r\n                <PopoverContent className=\"w-auto p-0 z-[100] bg-white shadow-lg\" align=\"start\">\r\n                  <Calendar mode=\"single\" selected={stockEntryDate} onSelect={date => date && setStockEntryDate(date)} disabled={date => {\r\n                    // Find the earliest product creation date from selected products\r\n                    const selectedProducts = stockRows.filter(row => row.productId).map(row => products.find(p => p.id === row.productId)).filter(Boolean);\r\n                    if (selectedProducts.length === 0) return date < new Date('2000-01-01') || date > new Date();\r\n                    const earliestCreationDate = selectedProducts.reduce((earliest, product) => {\r\n                      const productDate = new Date(product!.createdAt);\r\n                      return !earliest || productDate < earliest ? productDate : earliest;\r\n                    }, null as Date | null);\r\n                    return date < (earliestCreationDate || new Date('2000-01-01')) || date > new Date();\r\n                  }} className={cn(\"p-3 pointer-events-auto\", validateStockDate(stockEntryDate) && \"border-destructive\")} initialFocus />\r\n                  {validateStockDate(stockEntryDate) && <div className=\"p-3 border-t bg-destructive/5\">\r\n                    <p className=\"text-sm text-destructive\">{validateStockDate(stockEntryDate)}</p>\r\n                  </div>}\r\n                </PopoverContent>\r\n              </Popover>\r\n\r\n              {/* Supplier Name */}\r\n              <Input placeholder=\"Supplier name\" value={supplierName} onChange={e => setSupplierName(e.target.value)} className=\"w-full\" />\r\n\r\n              {/* Invoice Number */}\r\n              <Input placeholder=\"Invoice number\" value={invoiceNumber} onChange={e => setInvoiceNumber(e.target.value)} className=\"w-full\" />\r\n            </div>\r\n\r\n            {/* Action buttons */}\r\n            <div className=\"flex space-x-2\">\r\n              <Button onClick={addNewRow} variant=\"outline\" className=\"gap-2 flex-1 md:flex-none\">\r\n                <Plus size={16} /> Add Row\r\n              </Button>\r\n              <Button onClick={handleBulkSave} disabled={isLoading || stockRows.length === 0} className=\"gap-2 flex-1 md:flex-none\">\r\n                <Save size={16} />\r\n                {isLoading ? 'Saving...' : `Save All (${stockRows.length})`}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </CardHeader>\r\n\r\n      <CardContent className=\"p-0 md:p-6\">\r\n        {isMobile ?\r\n          // Mobile Card Layout\r\n          <div className=\"p-4 space-y-4\">\r\n            {stockRows.map((row, index) => <MobileStockRow key={row.id} row={row} index={index} onUpdateRow={updateRow} onRemoveRow={removeRow} onProductSelect={handleProductSelect} onInputFocus={handleInputFocus} onAddRowAfter={addRowAfter} onKeyDown={handleKeyDown} onMoveRow={moveRow} settings={settings} canRemove={stockRows.length > 1} products={products} stockEntryDate={stockEntryDate} isLastRow={index === stockRows.length - 1} totalRows={stockRows.length} />)}\r\n\r\n            {/* Mobile Total */}\r\n            <Card className=\"bg-primary/5 border-primary/20\">\r\n              <CardContent className=\"p-4\">\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <span className=\"font-medium\">Total Quantity:</span>\r\n                    <span className=\"text-lg font-bold text-primary\">\r\n                      {formatNumber(totalQuantity)}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <span className=\"font-medium\">Total Amount:</span>\r\n                    <span className=\"text-lg font-bold text-primary\">\r\n                      {settings.currency} {formatNumber(totalAmount)}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div> :\r\n          // Desktop Table Layout\r\n          <div className=\"overflow-x-auto\">\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead className=\"w-[300px]\">Item</TableHead>\r\n                  <TableHead className=\"w-[120px]\">Qty</TableHead>\r\n                  <TableHead className=\"w-[120px]\">Price</TableHead>\r\n                  <TableHead className=\"w-[120px]\">Amount</TableHead>\r\n                  <TableHead className=\"w-[140px]\">Actions</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {stockRows.map((row, index) => {\r\n                  // Check if product has date conflict\r\n                  const hasDateConflict = row.productId ? (() => {\r\n                    const product = products.find(p => p.id === row.productId);\r\n                    if (product) {\r\n                      const productCreationDate = new Date(product.createdAt);\r\n                      const selectedDate = new Date(stockEntryDate);\r\n                      const productDate = new Date(productCreationDate.getFullYear(), productCreationDate.getMonth(), productCreationDate.getDate());\r\n                      const entryDate = new Date(selectedDate.getFullYear(), selectedDate.getMonth(), selectedDate.getDate());\r\n                      return productDate.getTime() > entryDate.getTime();\r\n                    }\r\n                    return false;\r\n                  })() : false;\r\n                  const conflictProduct = hasDateConflict ? products.find(p => p.id === row.productId) : null;\r\n                  return <TableRow key={row.id} className={hasDateConflict ? \"border-destructive border-2 bg-destructive/5\" : \"\"}>\r\n                    <TableCell>\r\n                      <div className=\"relative\">\r\n                        <Input placeholder=\"Type to search products...\" value={row.searchTerm} onChange={e => updateRow(row.id, 'searchTerm', e.target.value)} onFocus={() => handleInputFocus(row.id)} onKeyDown={e => handleKeyDown(e, row.id)} className={cn(\"w-full\", hasDateConflict && \"border-destructive\")} />\r\n                        {hasDateConflict && conflictProduct && <p className=\"text-xs text-destructive mt-1\">\r\n                          Product was created on {format(new Date(conflictProduct.createdAt), 'PPP')} - after selected date\r\n                        </p>}\r\n                      </div>\r\n                    </TableCell>\r\n\r\n                    <TableCell>\r\n                      <Input type=\"number\" min=\"0\" step=\"0.01\" value={row.quantity || ''} onChange={e => updateRow(row.id, 'quantity', parseFloat(e.target.value) || 0)} onKeyDown={e => handleKeyDown(e, row.id)} placeholder=\"0\" />\r\n                    </TableCell>\r\n\r\n                    <TableCell>\r\n                      <Input type=\"number\" min=\"0\" step=\"0.01\" value={row.price || ''} onChange={e => updateRow(row.id, 'price', parseFloat(e.target.value) || 0)} onKeyDown={e => handleKeyDown(e, row.id)} placeholder=\"0.00\" />\r\n                    </TableCell>\r\n\r\n                    <TableCell>\r\n                      <div className=\"font-medium\">\r\n                        {settings.currency} {formatNumber(row.amount)}\r\n                      </div>\r\n                    </TableCell>\r\n\r\n                    <TableCell>\r\n                      <div className=\"flex gap-1\">\r\n                        <Button variant=\"outline\" size=\"icon\" onClick={() => moveRow(row.id, 'up')} disabled={index === 0} className=\"h-8 w-8\">\r\n                          <ChevronUp size={14} />\r\n                        </Button>\r\n                        <Button variant=\"outline\" size=\"icon\" onClick={() => moveRow(row.id, 'down')} disabled={index === stockRows.length - 1} className=\"h-8 w-8\">\r\n                          <ChevronDown size={14} />\r\n                        </Button>\r\n                        <Button variant=\"outline\" size=\"icon\" onClick={() => removeRow(row.id)} disabled={stockRows.length === 1} className=\"h-8 w-8\">\r\n                          <Trash2 size={14} />\r\n                        </Button>\r\n                      </div>\r\n                    </TableCell>\r\n                  </TableRow>;\r\n                })}\r\n\r\n                {/* Add Row Below button - only on the last row */}\r\n                <TableRow className=\"border-none\">\r\n                  <TableCell colSpan={5} className=\"py-1 text-center\">\r\n                    <Button variant=\"ghost\" size=\"sm\" onClick={() => addRowAfter(stockRows[stockRows.length - 1].id)} className=\"gap-2 text-muted-foreground hover:text-foreground text-xs\">\r\n                      <Plus size={12} />\r\n                      Add row below\r\n                    </Button>\r\n                  </TableCell>\r\n                </TableRow>\r\n\r\n                {/* Total Row */}\r\n                <TableRow className=\"border-t-2\">\r\n                  <TableCell className=\"text-right font-medium\">\r\n                    Total Quantity:\r\n                  </TableCell>\r\n                  <TableCell className=\"font-bold text-lg\">\r\n                    {formatNumber(totalQuantity)}\r\n                  </TableCell>\r\n                  <TableCell className=\"text-right font-medium\">\r\n                    Total Amount:\r\n                  </TableCell>\r\n                  <TableCell className=\"font-bold text-lg\">\r\n                    {settings.currency} {formatNumber(totalAmount)}\r\n                  </TableCell>\r\n                  <TableCell></TableCell>\r\n                </TableRow>\r\n              </TableBody>\r\n            </Table>\r\n          </div>}\r\n\r\n        {stockRows.length === 0 && <div className=\"text-center py-8 text-muted-foreground\">\r\n          No stock entries. Click \"Add Row\" to start adding stock.\r\n        </div>}\r\n      </CardContent>\r\n    </Card>\r\n\r\n    {/* Product Suggestions Panel - positioned here to appear above Stock Input History */}\r\n    <ProductSuggestionsPanel suggestions={suggestions} isOpen={panelOpen} onClose={closePanel} onSelectProduct={handleProductSelect} searchTerm={focusedRow?.searchTerm || ''} />\r\n\r\n    <StockInputHistory />\r\n  </div>;\r\n};\r\nexport default BulkStockAddTab;","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ScanBarcode\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMyA3VjVhMiAyIDAgMCAxIDItMmgyIiAvPgogIDxwYXRoIGQ9Ik0xNyAzaDJhMiAyIDAgMCAxIDIgMnYyIiAvPgogIDxwYXRoIGQ9Ik0yMSAxN3YyYTIgMiAwIDAgMS0yIDJoLTIiIC8+CiAgPHBhdGggZD0iTTcgMjFINWEyIDIgMCAwIDEtMi0ydi0yIiAvPgogIDxwYXRoIGQ9Ik04IDd2MTAiIC8+CiAgPHBhdGggZD0iTTEyIDd2MTAiIC8+CiAgPHBhdGggZD0iTTE3IDd2MTAiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/scan-barcode\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ScanBarcode = createLucideIcon('ScanBarcode', [\n  ['path', { d: 'M3 7V5a2 2 0 0 1 2-2h2', key: 'aa7l1z' }],\n  ['path', { d: 'M17 3h2a2 2 0 0 1 2 2v2', key: '4qcy5o' }],\n  ['path', { d: 'M21 17v2a2 2 0 0 1-2 2h-2', key: '6vwrx8' }],\n  ['path', { d: 'M7 21H5a2 2 0 0 1-2-2v-2', key: 'ioqczr' }],\n  ['path', { d: 'M8 7v10', key: '23sfjj' }],\n  ['path', { d: 'M12 7v10', key: 'jspqdw' }],\n  ['path', { d: 'M17 7v10', key: '578dap' }],\n]);\n\nexport default ScanBarcode;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ClipboardList\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cmVjdCB3aWR0aD0iOCIgaGVpZ2h0PSI0IiB4PSI4IiB5PSIyIiByeD0iMSIgcnk9IjEiIC8+CiAgPHBhdGggZD0iTTE2IDRoMmEyIDIgMCAwIDEgMiAydjE0YTIgMiAwIDAgMS0yIDJINmEyIDIgMCAwIDEtMi0yVjZhMiAyIDAgMCAxIDItMmgyIiAvPgogIDxwYXRoIGQ9Ik0xMiAxMWg0IiAvPgogIDxwYXRoIGQ9Ik0xMiAxNmg0IiAvPgogIDxwYXRoIGQ9Ik04IDExaC4wMSIgLz4KICA8cGF0aCBkPSJNOCAxNmguMDEiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/clipboard-list\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ClipboardList = createLucideIcon('ClipboardList', [\n  ['rect', { width: '8', height: '4', x: '8', y: '2', rx: '1', ry: '1', key: 'tgr4d6' }],\n  [\n    'path',\n    {\n      d: 'M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2',\n      key: '116196',\n    },\n  ],\n  ['path', { d: 'M12 11h4', key: '1jrz19' }],\n  ['path', { d: 'M12 16h4', key: 'n85exb' }],\n  ['path', { d: 'M8 11h.01', key: '1dfujw' }],\n  ['path', { d: 'M8 16h.01', key: '18s6g9' }],\n]);\n\nexport default ClipboardList;\n","import { format } from 'date-fns';\r\nimport jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\nimport { Product } from '@/types';\r\n\r\ninterface StockCountExportData {\r\n    product: Product;\r\n    actualStock: number;\r\n    variation: number;\r\n}\r\n\r\nexport const exportStockCountToCSV = (data: StockCountExportData[]) => {\r\n    const headers = ['Product Name', 'Barcode', 'System Stock', 'Actual Stock', 'Variation'];\r\n    const rows = data.map(item => [\r\n        item.product.name,\r\n        item.product.barcode || 'N/A',\r\n        item.product.quantity.toString(),\r\n        item.actualStock.toString(),\r\n        item.variation.toString()\r\n    ]);\r\n\r\n    const csvContent = [\r\n        headers.join(','),\r\n        ...rows.map(row => row.map(cell => `\"${cell.replace(/\"/g, '\"\"')}\"`).join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n    const url = URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.setAttribute('href', url);\r\n    link.setAttribute('download', `stock_count_${format(new Date(), 'yyyy-MM-dd_HHmm')}.csv`);\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n};\r\n\r\nexport const exportStockCountToPDF = (\r\n    data: StockCountExportData[],\r\n    businessName: string = 'Gonza Systems',\r\n    metadata?: { auditorName?: string; contactPerson?: string; auditNumber?: number; auditId?: string }\r\n) => {\r\n    const doc = new jsPDF() as any;\r\n    const pageWidth = doc.internal.pageSize.getWidth();\r\n\r\n    // Header\r\n    doc.setFontSize(20);\r\n    const headerText = metadata?.auditId\r\n        ? `Stock Count Report - ${metadata.auditId}`\r\n        : `Stock Count / Audit Report ${metadata?.auditNumber ? `#${metadata.auditNumber}` : ''}`;\r\n    doc.text(headerText, 14, 22);\r\n    doc.setFontSize(11);\r\n    doc.setTextColor(100);\r\n    doc.text(`Business: ${businessName}`, 14, 30);\r\n    doc.text(`Date: ${format(new Date(), 'PPP p')}`, 14, 36);\r\n\r\n    if (metadata?.auditorName || metadata?.contactPerson) {\r\n        let metaY = 42;\r\n        if (metadata.auditorName) {\r\n            doc.text(`Auditor: ${metadata.auditorName}`, 14, metaY);\r\n            metaY += 6;\r\n        }\r\n        if (metadata.contactPerson) {\r\n            doc.text(`Contact Person: ${metadata.contactPerson}`, 14, metaY);\r\n        }\r\n    }\r\n\r\n    // Table\r\n    const tableColumn = [\"Product Name\", \"Barcode\", \"System\", \"Actual\", \"Variation\"];\r\n    const tableRows = data.map(item => [\r\n        item.product.name,\r\n        item.product.barcode || 'N/A',\r\n        item.product.quantity.toString(),\r\n        item.actualStock.toString(),\r\n        {\r\n            content: item.variation > 0 ? `+${item.variation}` : item.variation.toString(),\r\n            styles: { textColor: (item.variation < 0 ? [220, 38, 38] : item.variation > 0 ? [22, 163, 74] : [100, 116, 139]) as [number, number, number] }\r\n        }\r\n    ]);\r\n\r\n    autoTable(doc, {\r\n        head: [tableColumn],\r\n        body: tableRows,\r\n        startY: metadata?.auditorName || metadata?.contactPerson ? 55 : 45,\r\n        theme: 'striped',\r\n        headStyles: { fillColor: [59, 130, 246] },\r\n        alternateRowStyles: { fillColor: [248, 250, 252] },\r\n        margin: { top: 45 },\r\n    });\r\n\r\n    // Signatures\r\n    const finalY = (doc as any).lastAutoTable.finalY + 25;\r\n    if (finalY < doc.internal.pageSize.getHeight() - 40) {\r\n        doc.setDrawColor(200);\r\n        doc.line(14, finalY, 80, finalY);\r\n        doc.line(pageWidth - 80, finalY, pageWidth - 14, finalY);\r\n\r\n        doc.setFontSize(9);\r\n        doc.setTextColor(50);\r\n        doc.text('Auditor Signature', 14, finalY + 5);\r\n        doc.text('Stock Manager Signature', pageWidth - 80, finalY + 5);\r\n    }\r\n\r\n    // Footer\r\n    const pageCount = (doc as any).internal.getNumberOfPages();\r\n    for (let i = 1; i <= pageCount; i++) {\r\n        doc.setPage(i);\r\n        doc.setFontSize(8);\r\n        doc.setTextColor(150);\r\n        doc.text(\r\n            'Created By Gonza Systems',\r\n            doc.internal.pageSize.getWidth() / 2,\r\n            doc.internal.pageSize.getHeight() - 10,\r\n            { align: 'center' }\r\n        );\r\n    }\r\n\r\n    doc.save(`stock_audit_${format(new Date(), 'yyyy-MM-dd_HHmm')}.pdf`);\r\n};\r\n","import React, { useState, useCallback, useEffect, useMemo, useRef } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Trash2, Save, Search, ScanBarcode, TrendingUp, TrendingDown, ClipboardList, Filter, Edit, AlertTriangle } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { toast } from 'sonner';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { Product, mapDbProductToProduct } from '@/types';\r\nimport { cn } from '@/lib/utils';\r\nimport { exportStockCountToCSV, exportStockCountToPDF } from '@/utils/exportStockCount';\r\nimport {\r\n    AlertDialog,\r\n    AlertDialogAction,\r\n    AlertDialogCancel,\r\n    AlertDialogContent,\r\n    AlertDialogDescription,\r\n    AlertDialogFooter,\r\n    AlertDialogHeader,\r\n    AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport { Download, FileDown, History as HistoryIcon, Clock, ChevronRight, Info } from 'lucide-react';\r\nimport { useStockHistory } from '@/hooks/useStockHistory';\r\nimport { lookupProductByBarcodeAction } from '@/app/actions/products';\r\n\r\n\r\n// State stored in localStorage: Record<productId, actualStock>\r\nconst STORAGE_KEY = 'stockCountData';\r\n\r\n// Sub-component for the tables to keep main component clean\r\nconst AuditTable = ({ rows, onUpdate, onRemove, isAuditMode, lastScannedId }: any) => (\r\n    <div className=\"overflow-x-auto\">\r\n        <Table>\r\n            <TableHeader>\r\n                <TableRow className=\"bg-muted/50 border-b-2\">\r\n                    <TableHead className=\"min-w-[200px] font-bold text-gray-700\">Item Details</TableHead>\r\n                    <TableHead className=\"text-center w-[120px] font-bold text-gray-700\">System</TableHead>\r\n                    <TableHead className=\"text-center w-[150px] font-bold text-gray-700\">Actual Count</TableHead>\r\n                    <TableHead className=\"text-center w-[150px] font-bold text-gray-700\">Variation</TableHead>\r\n                    {!isAuditMode && <TableHead className=\"text-right w-[80px]\"></TableHead>}\r\n                </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n                {rows.length === 0 ? (\r\n                    <TableRow>\r\n                        <TableCell colSpan={isAuditMode ? 4 : 5} className=\"h-48 text-center bg-slate-50\">\r\n                            <div className=\"flex flex-col items-center gap-2 text-muted-foreground\">\r\n                                <Filter className=\"h-8 w-8 opacity-20\" />\r\n                                <p>{isAuditMode ? 'No products match your search' : 'No items recorded yet'}</p>\r\n                            </div>\r\n                        </TableCell>\r\n                    </TableRow>\r\n                ) : (\r\n                    rows.map(({ product, actualStock, variation }: any) => (\r\n                        <TableRow\r\n                            key={product.id}\r\n                            id={`row-${product.id}`}\r\n                            className={cn(\r\n                                \"hover:bg-muted/30 transition-colors\",\r\n                                variation !== 0 && \"bg-orange-50/20\",\r\n                                lastScannedId === product.id && \"row-highlight\"\r\n                            )}\r\n                        >\r\n                            <TableCell className=\"py-4\">\r\n                                <div className=\"font-bold text-gray-900 leading-tight\">{product.name}</div>\r\n                                <div className=\"text-[10px] text-muted-foreground font-mono mt-1 uppercase tracking-tighter\">\r\n                                    {product.barcode || 'NO BARCODE'}\r\n                                </div>\r\n                            </TableCell>\r\n\r\n                            <TableCell className=\"text-center text-sm font-medium text-slate-500\">\r\n                                {product.quantity}\r\n                            </TableCell>\r\n\r\n                            <TableCell className=\"text-center\">\r\n                                <div className=\"flex items-center justify-center gap-2\">\r\n                                    <Button\r\n                                        variant=\"outline\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-8 w-8 rounded-full\"\r\n                                        onClick={() => onUpdate(product, -1, true)}\r\n                                    >\r\n                                        -\r\n                                    </Button>\r\n                                    <Input\r\n                                        type=\"number\"\r\n                                        className=\"w-20 text-center font-black text-lg border-2\"\r\n                                        value={actualStock}\r\n                                        onChange={(e) => onUpdate(product, parseFloat(e.target.value) || 0, false)}\r\n                                    />\r\n                                    <Button\r\n                                        variant=\"outline\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-8 w-8 rounded-full bg-slate-100\"\r\n                                        onClick={() => onUpdate(product, 1, true)}\r\n                                    >\r\n                                        +\r\n                                    </Button>\r\n                                </div>\r\n                            </TableCell>\r\n\r\n                            <TableCell className=\"text-center\">\r\n                                <div className={cn(\r\n                                    \"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-black ring-1\",\r\n                                    variation > 0 ? \"text-emerald-700 bg-emerald-50 ring-emerald-200\" :\r\n                                        variation < 0 ? \"text-rose-700 bg-rose-50 ring-rose-200\" :\r\n                                            \"text-slate-500 bg-slate-50 ring-slate-200\"\r\n                                )}>\r\n                                    {variation > 0 ? <TrendingUp className=\"h-3 w-3 mr-1\" /> : variation < 0 ? <TrendingDown className=\"h-3 w-3 mr-1\" /> : null}\r\n                                    {variation > 0 ? '+' : ''}{variation}\r\n                                </div>\r\n                            </TableCell>\r\n\r\n                            {!isAuditMode && (\r\n                                <TableCell className=\"text-right px-4\">\r\n                                    <Button\r\n                                        variant=\"ghost\"\r\n                                        size=\"icon\"\r\n                                        onClick={() => onRemove(product.id)}\r\n                                        className=\"hover:bg-red-50 hover:text-red-600 rounded-full\"\r\n                                    >\r\n                                        <Trash2 className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                </TableCell>\r\n                            )}\r\n                        </TableRow>\r\n                    ))\r\n                )}\r\n            </TableBody>\r\n        </Table>\r\n    </div>\r\n);\r\n\r\nconst StockCountTab = () => {\r\n    const { user } = useAuth();\r\n    const userId = user?.id;\r\n    const { currentBusiness } = useBusiness();\r\n    const { products, updateProduct, updateProductsBulk, loadProducts } = useProducts(userId, 10000);\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [activeTab, setActiveTab] = useState('quick');\r\n    const [lastScannedId, setLastScannedId] = useState<string | null>(null);\r\n    const [showCommitDialog, setShowCommitDialog] = useState(false);\r\n    const [selectedAuditId, setSelectedAuditId] = useState<string | null>(null);\r\n    const [auditorName, setAuditorName] = useState('');\r\n    const [contactPerson, setContactPerson] = useState('');\r\n    const [editingSessionId, setEditingSessionId] = useState<string | null>(null);\r\n    const [deleteDialogSession, setDeleteDialogSession] = useState<typeof auditSessions[0] | null>(null);\r\n\r\n    const { stockHistory, isLoading: isLoadingHistory, loadStockHistory } = useStockHistory(userId);\r\n\r\n    // Local counts database: productId -> actualCount\r\n    const [counts, setCounts] = useState<Record<string, number>>(() => {\r\n        try {\r\n            const saved = localStorage.getItem(STORAGE_KEY);\r\n            return saved ? JSON.parse(saved) : {};\r\n        } catch (e) {\r\n            return {};\r\n        }\r\n    });\r\n\r\n    // Persist counts\r\n    useEffect(() => {\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(counts));\r\n    }, [counts]);\r\n\r\n    // Generate a unique session ID for the audit (proper UUID for database)\r\n    const generateSessionId = () => crypto.randomUUID();\r\n\r\n    // Shared function to update or add a count\r\n    const handleCountUpdate = useCallback((product: Product, value: number, isRelative: boolean = true) => {\r\n        setCounts(prev => {\r\n            const current = prev[product.id] || 0;\r\n            const newValue = isRelative ? current + value : value;\r\n            return {\r\n                ...prev,\r\n                [product.id]: Math.max(0, newValue)\r\n            };\r\n        });\r\n    }, []);\r\n\r\n    const handleScanSuccess = useCallback((product: Product) => {\r\n        handleCountUpdate(product, 1, true);\r\n        setLastScannedId(product.id);\r\n        toast.success(`Tally: ${product.name}`, { duration: 1000, position: 'bottom-center' });\r\n\r\n        // Remove highlight after 2 seconds\r\n        setTimeout(() => setLastScannedId(null), 2000);\r\n    }, [handleCountUpdate]);\r\n\r\n    // Auto-scroll logic\r\n    useEffect(() => {\r\n        if (lastScannedId) {\r\n            const element = document.getElementById(`row-${lastScannedId}`);\r\n            if (element) {\r\n                element.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n            }\r\n        }\r\n    }, [lastScannedId]);\r\n\r\n    const scannerBufferRef = useRef('');\r\n    const lastKeyTimeRef = useRef(Date.now());\r\n\r\n    // Global Barcode Listener\r\n    useEffect(() => {\r\n        const handleKeyDown = (e: KeyboardEvent) => {\r\n            const target = e.target as HTMLElement;\r\n            const currentTime = Date.now();\r\n            const delay = currentTime - lastKeyTimeRef.current;\r\n            lastKeyTimeRef.current = currentTime;\r\n\r\n            // Threshold increased to 60ms for broader scanner compatibility\r\n            const isRapidTyping = delay < 60;\r\n            const isAlphanumeric = /^[a-zA-Z0-9\\-_]$/.test(e.key);\r\n\r\n            // Aggressive Interception: If NOT in an input field, suppress ALL alphanumeric keys\r\n            const isInput = target.tagName === 'INPUT' || target.tagName === 'TEXTAREA' || target.contentEditable === 'true';\r\n            if (!isInput && isAlphanumeric) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n\r\n            if (e.key === 'Enter') {\r\n                const scannedBarcode = scannerBufferRef.current.trim();\r\n                if (scannedBarcode.length >= 2) {\r\n                    // Always prevent Enter/Return from being processed by browser/console\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n\r\n                    console.log(`[StockCount Scanner] Processing: \"${scannedBarcode}\"`);\r\n\r\n                    // Perform direct server-side lookup via Prisma action\r\n                    const performServerLookup = async (code: string): Promise<Product | null> => {\r\n                        const result = await lookupProductByBarcodeAction(code, currentBusiness?.id || '');\r\n                        return result ? mapDbProductToProduct(result) : null;\r\n                    };\r\n\r\n\r\n                    const handleScan = async () => {\r\n                        const product = await performServerLookup(scannedBarcode);\r\n\r\n                        if (product) {\r\n                            const referenceCode = product.barcode || product.itemNumber || scannedBarcode;\r\n                            console.log(`[StockCount Scanner]  Server Match: ${product.name}`);\r\n                            console.log(`[StockCount Scanner]  Mapping \"${scannedBarcode}\" -> System Code \"${referenceCode}\"`);\r\n\r\n                            handleScanSuccess(product);\r\n                        } else {\r\n                            console.warn(`[StockCount Scanner]  No server match for: \"${scannedBarcode}\"`);\r\n                        }\r\n                    };\r\n\r\n                    handleScan();\r\n                    scannerBufferRef.current = '';\r\n                    return;\r\n                }\r\n\r\n                // Always clear and block Enter if not in input\r\n                if (!isInput || scannedBarcode.length >= 2) {\r\n                    scannerBufferRef.current = '';\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (e.key.length === 1) {\r\n                // Only prevent default if this is rapid typing (scanner) AND in an input field\r\n                // OR if not in an input field at all\r\n                if (isRapidTyping && isInput && isAlphanumeric) {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                }\r\n\r\n                // Update buffer\r\n                if (delay > 100) {\r\n                    scannerBufferRef.current = e.key;\r\n                } else {\r\n                    scannerBufferRef.current += e.key;\r\n                }\r\n            }\r\n        };\r\n\r\n\r\n        window.addEventListener('keydown', handleKeyDown, true);\r\n        return () => window.removeEventListener('keydown', handleKeyDown, true);\r\n    }, [userId, currentBusiness?.id]);\r\n\r\n    // Main data for the \"Full List\" table\r\n    const tableRows = useMemo(() => {\r\n        return products\r\n            .filter(p => {\r\n                // When editing an audit, only show products from that audit session\r\n                if (editingSessionId) {\r\n                    return counts.hasOwnProperty(p.id);\r\n                }\r\n                // Otherwise show products that have counts recorded\r\n                return counts.hasOwnProperty(p.id);\r\n            })\r\n            .map(product => {\r\n                const actualStock = counts[product.id];\r\n                if (actualStock === undefined) return null;\r\n                return {\r\n                    product,\r\n                    actualStock,\r\n                    variation: Number((actualStock - product.quantity).toFixed(2))\r\n                };\r\n            })\r\n            .filter((row): row is NonNullable<typeof row> => row !== null);\r\n    }, [counts, products, editingSessionId]);\r\n\r\n    // Derived data for the Quick Scan table (same as tableRows for now)\r\n    const quickRows = tableRows;\r\n\r\n    // Filtered data for the Audit List table\r\n    const auditRows = useMemo(() => {\r\n        const searchLow = searchTerm.toLowerCase();\r\n        return products\r\n            .filter(p => !searchTerm ||\r\n                p.name.toLowerCase().includes(searchLow) ||\r\n                (p.barcode && p.barcode.toLowerCase().includes(searchLow)) ||\r\n                (p.itemNumber && p.itemNumber.toLowerCase().includes(searchLow)) ||\r\n                (p.manufacturerBarcode && p.manufacturerBarcode.toLowerCase().includes(searchLow))\r\n            )\r\n            .map(product => {\r\n                const actualStock = counts[product.id] ?? 0;\r\n                return {\r\n                    product,\r\n                    actualStock,\r\n                    variation: Number((actualStock - product.quantity).toFixed(2))\r\n                };\r\n            });\r\n    }, [counts, products, searchTerm]);\r\n\r\n    const commitStockCount = async (shouldUpdateInventory: boolean) => {\r\n        const affectedIds = Object.keys(counts);\r\n        if (affectedIds.length === 0) return;\r\n\r\n        // Guard against double-submission\r\n        if (isSubmitting) {\r\n            console.warn(' Commit already in progress, ignoring duplicate call');\r\n            return;\r\n        }\r\n\r\n        setIsSubmitting(true);\r\n        setShowCommitDialog(false);\r\n\r\n        const sessionId = editingSessionId || generateSessionId();\r\n\r\n        // Generate user-friendly audit ID (AUD-0001 format)\r\n        const auditCount = auditSessions.length + 1;\r\n        const auditId = `AUD-${String(auditCount).padStart(4, '0')}`;\r\n\r\n        const reasonPrefix = editingSessionId ? 'Stock Count Edit' : 'Stock Count Update';\r\n        const finalReason = `${auditId} | ${reasonPrefix}${auditorName ? ` | Auditor: ${auditorName}` : ''}${contactPerson ? ` | Contact: ${contactPerson}` : ''}`;\r\n\r\n        console.log(' Stock Count Commit Debug:', {\r\n            shouldUpdateInventory,\r\n            affectedIds,\r\n            sessionId,\r\n            auditId,\r\n            finalReason,\r\n            userId,\r\n            updateCount: affectedIds.length\r\n        });\r\n\r\n        try {\r\n            if (shouldUpdateInventory) {\r\n                const updates = affectedIds.map(id => {\r\n                    const product = products.find(p => p.id === id);\r\n                    if (!product) return null;\r\n                    return {\r\n                        id,\r\n                        updated: { quantity: counts[id] }\r\n                    };\r\n                }).filter((u): u is NonNullable<typeof u> => u !== null);\r\n\r\n                if (updates.length > 0) {\r\n                    if (editingSessionId) {\r\n                        // REVERT OLD AUDIT FIRST\r\n                        const sessionToDelete = auditSessions.find(s => s.id === editingSessionId);\r\n                        if (sessionToDelete) {\r\n                            const entryIds = sessionToDelete.items.map(i => i.id);\r\n                            const poductIds = Array.from(new Set(sessionToDelete.items.map(i => i.productId)));\r\n\r\n                            await deleteMultipleStockHistoryEntries(entryIds);\r\n                            for (const pid of poductIds) {\r\n                                await recalculateStockChain(pid);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    const success = await updateProductsBulk(\r\n                        updates,\r\n                        userId,\r\n                        finalReason,\r\n                        sessionId\r\n                    );\r\n                    if (success) {\r\n                        toast.success(`Inventory updated! ${updates.length} items corrected.`);\r\n                    } else {\r\n                        throw new Error(\"Bulk update failed\");\r\n                    }\r\n                }\r\n            } else {\r\n                toast.success(`Audit completed and cleared (Inventory not changed).`);\r\n            }\r\n\r\n            setCounts({});\r\n            setAuditorName('');\r\n            setContactPerson('');\r\n            setEditingSessionId(null);\r\n            localStorage.removeItem(STORAGE_KEY);\r\n            await loadProducts();\r\n\r\n            // Force reload stock history to show new audit immediately\r\n            await loadStockHistory();\r\n        } catch (error) {\r\n            console.error(\"Commit error:\", error);\r\n            toast.error(\"An error occurred during completion.\");\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    const handleExportCSV = () => {\r\n        const data = activeTab === 'quick' ? quickRows : auditRows;\r\n\r\n        if (data.length === 0) {\r\n            toast.error(\"No items to export.\");\r\n            return;\r\n        }\r\n        exportStockCountToCSV(data);\r\n    };\r\n\r\n    const handleExportPDF = () => {\r\n        const data = activeTab === 'quick' ? quickRows : auditRows;\r\n\r\n        if (data.length === 0) {\r\n            toast.error(\"No items to export.\");\r\n            return;\r\n        }\r\n        exportStockCountToPDF(data, currentBusiness?.name, {\r\n            auditorName,\r\n            contactPerson\r\n        });\r\n    };\r\n\r\n    const clearAll = () => {\r\n        if (Object.keys(counts).length === 0) return;\r\n        if (window.confirm(\"Clear all recorded counts? progress will be lost.\")) {\r\n            setCounts({});\r\n            localStorage.removeItem(STORAGE_KEY);\r\n            toast.info(\"Progress cleared.\");\r\n        }\r\n    };\r\n\r\n    // Process history for the \"History\" tab\r\n    const auditSessions = useMemo(() => {\r\n        const auditEntries = stockHistory.filter(h =>\r\n            h.changeReason?.includes('Stock Count Update') || h.changeReason?.includes('Stock Count Edit')\r\n        );\r\n        const groups: Record<string, { id: string, date: Date, items: typeof auditEntries, auditId?: string, isEdited?: boolean }> = {};\r\n\r\n        auditEntries.forEach(entry => {\r\n            const sessionId = entry.referenceId || 'unknown';\r\n\r\n            // Extract audit ID from change reason (AUD-0001 format)\r\n            const auditIdMatch = entry.changeReason?.match(/AUD-\\d{4}/);\r\n            const auditId = auditIdMatch ? auditIdMatch[0] : undefined;\r\n\r\n            // Check if this entry was from an edit\r\n            const isEdited = entry.changeReason?.includes('Stock Count Edit') || false;\r\n\r\n            if (!groups[sessionId]) {\r\n                groups[sessionId] = {\r\n                    id: sessionId,\r\n                    date: entry.createdAt,\r\n                    items: [],\r\n                    auditId,\r\n                    isEdited: false\r\n                };\r\n            }\r\n\r\n            // Mark session as edited if any entry is an edit\r\n            if (isEdited) {\r\n                groups[sessionId].isEdited = true;\r\n            }\r\n\r\n            // Defensive: Only add if this specific history ID isn't already in the group\r\n            if (!groups[sessionId].items.find(item => item.id === entry.id)) {\r\n                groups[sessionId].items.push(entry);\r\n            }\r\n        });\r\n\r\n        const sorted = Object.values(groups).sort((a, b) => a.date.getTime() - b.date.getTime());\r\n        // Assign sequence numbers based on chronological order\r\n        return sorted.map((session, index) => ({\r\n            ...session,\r\n            auditNumber: index + 1\r\n        })).reverse(); // Newest first for display\r\n    }, [stockHistory]);\r\n\r\n    const handleSessionExportCSV = (session: typeof auditSessions[0]) => {\r\n        const data = session.items.map(item => ({\r\n            product: {\r\n                ...item.product,\r\n                id: item.productId,\r\n                quantity: item.oldQuantity // System stock at time of audit\r\n            } as Product,\r\n            actualStock: item.newQuantity,\r\n            variation: item.newQuantity - item.oldQuantity\r\n        }));\r\n        exportStockCountToCSV(data);\r\n    };\r\n\r\n    const handleSessionExportPDF = (session: typeof auditSessions[0]) => {\r\n        const data = session.items.map(item => ({\r\n            product: {\r\n                ...item.product,\r\n                id: item.productId,\r\n                quantity: item.oldQuantity // System stock at time of audit\r\n            } as Product,\r\n            actualStock: item.newQuantity,\r\n            variation: item.newQuantity - item.oldQuantity\r\n        }));\r\n\r\n        // Try to extract auditor/contact from changeReason\r\n        const firstReason = session.items[0]?.changeReason || '';\r\n        const auditorMatch = firstReason.match(/Auditor: ([^|]*)/);\r\n        const contactMatch = firstReason.match(/Contact: ([^|]*)/);\r\n\r\n        exportStockCountToPDF(data, currentBusiness?.name, {\r\n            auditNumber: session.auditNumber,\r\n            auditorName: auditorMatch ? auditorMatch[1].trim() : undefined,\r\n            contactPerson: contactMatch ? contactMatch[1].trim() : undefined,\r\n            auditId: session.auditId\r\n        });\r\n    };\r\n\r\n    const handleSessionEdit = (session: typeof auditSessions[0]) => {\r\n        const editCounts: Record<string, number> = {};\r\n        session.items.forEach(item => {\r\n            editCounts[item.productId] = item.newQuantity;\r\n        });\r\n\r\n        const firstReason = session.items[0]?.changeReason || '';\r\n        const auditorMatch = firstReason.match(/Auditor: ([^|]*)/);\r\n        const contactMatch = firstReason.match(/Contact: ([^|]*)/);\r\n\r\n        setCounts(editCounts);\r\n        setAuditorName(auditorMatch ? auditorMatch[1].trim() : '');\r\n        setContactPerson(contactMatch ? contactMatch[1].trim() : '');\r\n        setEditingSessionId(session.id);\r\n        setActiveTab('audit');\r\n        toast.info(`Editing Audit #${session.auditNumber}`);\r\n    };\r\n\r\n    const { deleteMultipleStockHistoryEntries, recalculateStockChain } = useStockHistory(userId);\r\n\r\n    const handleSessionDelete = async (session: typeof auditSessions[0]) => {\r\n        setDeleteDialogSession(null);\r\n        setIsSubmitting(true);\r\n        try {\r\n            const entryIds = session.items.map(i => i.id);\r\n            const productIds = Array.from(new Set(session.items.map(i => i.productId)));\r\n\r\n            // Delete entries\r\n            const success = await deleteMultipleStockHistoryEntries(entryIds);\r\n\r\n            if (success) {\r\n                // Recalculate chain for each affected product to restore stock\r\n                for (const pid of productIds) {\r\n                    await recalculateStockChain(pid);\r\n                }\r\n                toast.success(\"Audit deleted and stock restored!\");\r\n                await loadProducts(); // Refresh UI stock\r\n            } else {\r\n                toast.error(\"Failed to delete audit.\");\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Delete session error:\", error);\r\n            toast.error(\"An error occurred.\");\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    const removeProduct = (id: string) => {\r\n        const newCounts = { ...counts };\r\n        delete newCounts[id];\r\n        setCounts(newCounts);\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            <style dangerouslySetInnerHTML={{\r\n                __html: `\r\n                @keyframes highlight-fade {\r\n                    0% { background-color: rgba(59, 130, 246, 0.2); }\r\n                    100% { background-color: transparent; }\r\n                }\r\n                .row-highlight {\r\n                    animation: highlight-fade 2s ease-out forwards;\r\n                }\r\n            `}} />\r\n            <Card className=\"shadow-sm border-2\">\r\n                <CardHeader className=\"pb-3 px-4 md:px-6 bg-muted/20\">\r\n                    <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n                        <div>\r\n                            <CardTitle className=\"text-xl flex items-center gap-2\">\r\n                                <ScanBarcode className=\"h-6 w-6 text-sales-primary\" />\r\n                                Inventory Audit\r\n                            </CardTitle>\r\n                            <p className=\"text-sm text-muted-foreground mt-1\">\r\n                                Counts are saved locally. Click \"Complete Audit\" to update the system.\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"flex flex-wrap gap-2\">\r\n                            <div className=\"flex gap-1 mr-2 border-r pr-2\">\r\n                                <Button\r\n                                    variant=\"outline\"\r\n                                    size=\"sm\"\r\n                                    onClick={handleExportCSV}\r\n                                    disabled={activeTab === 'history' || (activeTab === 'quick' && quickRows.length === 0) || (activeTab === 'audit' && auditRows.length === 0)}\r\n                                    className=\"h-9 gap-2\"\r\n                                >\r\n                                    <Download className=\"h-4 w-4\" />\r\n                                    CSV\r\n                                </Button>\r\n                                <Button\r\n                                    variant=\"outline\"\r\n                                    size=\"sm\"\r\n                                    onClick={handleExportPDF}\r\n                                    disabled={activeTab === 'history' || (activeTab === 'quick' && quickRows.length === 0) || (activeTab === 'audit' && auditRows.length === 0)}\r\n                                    className=\"h-9 gap-2\"\r\n                                >\r\n                                    <FileDown className=\"h-4 w-4\" />\r\n                                    PDF\r\n                                </Button>\r\n                            </div>\r\n                            <Button\r\n                                variant=\"outline\"\r\n                                onClick={clearAll}\r\n                                disabled={isSubmitting || Object.keys(counts).length === 0}\r\n                                className=\"text-red-500 border-red-200 hover:bg-red-50 h-9\"\r\n                            >\r\n                                <Trash2 className=\"h-4 w-4 mr-2\" />\r\n                                Reset\r\n                            </Button>\r\n                            <Button\r\n                                onClick={() => setShowCommitDialog(true)}\r\n                                disabled={isSubmitting || Object.keys(counts).length === 0}\r\n                                className=\"gap-2 bg-sales-primary hover:bg-sales-primary/90 shadow-md h-9 px-4\"\r\n                            >\r\n                                <Save className=\"h-4 w-4\" />\r\n                                {isSubmitting ? 'Syncing...' : 'Complete Audit'}\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                </CardHeader>\r\n\r\n                <CardContent className=\"p-0\">\r\n                    <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\r\n                        <div className=\"px-4 md:px-6 pt-4 border-b\">\r\n                            <TabsList className=\"flex w-full md:w-[450px] mb-4 overflow-x-auto\">\r\n                                <TabsTrigger value=\"quick\" className=\"flex-1 gap-2 whitespace-nowrap\">\r\n                                    <ScanBarcode className=\"h-4 w-4\" />\r\n                                    Quick Scan\r\n                                </TabsTrigger>\r\n                                <TabsTrigger value=\"audit\" className=\"flex-1 gap-2 whitespace-nowrap\">\r\n                                    <ClipboardList className=\"h-4 w-4\" />\r\n                                    Full List\r\n                                </TabsTrigger>\r\n                                <TabsTrigger value=\"history\" className=\"flex-1 gap-2 whitespace-nowrap\">\r\n                                    <HistoryIcon className=\"h-4 w-4\" />\r\n                                    Audit History\r\n                                </TabsTrigger>\r\n                            </TabsList>\r\n                        </div>\r\n\r\n                        <TabsContent value=\"quick\" className=\"m-0\">\r\n                            <div className=\"p-6 text-center bg-sales-primary/5 border-b\">\r\n                                <div className=\"inline-flex items-center justify-center p-3 rounded-full bg-white shadow-sm mb-4\">\r\n                                    <ScanBarcode className=\"h-8 w-8 text-sales-primary animate-pulse\" />\r\n                                </div>\r\n                                <h3 className=\"text-lg font-semibold text-gray-900\">Scan to Start</h3>\r\n                                <p className=\"text-sm text-muted-foreground max-w-xs mx-auto\">\r\n                                    Just start scanning barcodes. Scanned items will appear below.\r\n                                </p>\r\n                            </div>\r\n\r\n                            <AuditTable\r\n                                rows={quickRows}\r\n                                onUpdate={handleCountUpdate}\r\n                                onRemove={removeProduct}\r\n                                isAuditMode={false}\r\n                                lastScannedId={lastScannedId}\r\n                            />\r\n                        </TabsContent>\r\n\r\n                        <TabsContent value=\"audit\" className=\"space-y-4\">\r\n                            {editingSessionId && (\r\n                                <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-center gap-2 mx-4 md:mx-6 mt-4\">\r\n                                    <Edit className=\"h-4 w-4 text-amber-600\" />\r\n                                    <span className=\"text-sm font-medium text-amber-900\">\r\n                                        Editing Mode: Only showing items from this audit session\r\n                                    </span>\r\n                                </div>\r\n                            )}\r\n                            <div className=\"p-4 border-b flex items-center gap-4 bg-muted/10\">\r\n                                <div className=\"relative flex-1 max-w-md\">\r\n                                    <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n                                    <Input\r\n                                        placeholder=\"Search name or barcode...\"\r\n                                        className=\"pl-10 barcode-friendly\"\r\n                                        value={searchTerm}\r\n                                        onChange={(e) => setSearchTerm(e.target.value)}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"text-sm font-medium text-muted-foreground\">\r\n                                    Showing {auditRows.length} of {products.length} items\r\n                                </div>\r\n                            </div>\r\n\r\n                            <AuditTable\r\n                                rows={auditRows}\r\n                                onUpdate={handleCountUpdate}\r\n                                isAuditMode={true}\r\n                                lastScannedId={lastScannedId}\r\n                            />\r\n                        </TabsContent>\r\n\r\n                        <TabsContent value=\"history\" className=\"m-0 bg-slate-50/50\">\r\n                            <div className=\"p-4 md:p-8\">\r\n                                <div className=\"max-w-4xl mx-auto space-y-6\">\r\n                                    {isLoadingHistory ? (\r\n                                        <div className=\"flex flex-col items-center justify-center py-20 gap-4\">\r\n                                            <div className=\"w-8 h-8 border-4 border-sales-primary border-t-transparent rounded-full animate-spin\" />\r\n                                            <p className=\"text-sm text-muted-foreground\">Loading history...</p>\r\n                                        </div>\r\n                                    ) : auditSessions.length === 0 ? (\r\n                                        <div className=\"flex flex-col items-center justify-center py-20 text-center space-y-3 bg-white border-2 border-dashed rounded-3xl\">\r\n                                            <div className=\"p-4 rounded-full bg-slate-50\">\r\n                                                <HistoryIcon className=\"h-10 w-10 text-slate-300\" />\r\n                                            </div>\r\n                                            <div>\r\n                                                <h3 className=\"text-xl font-bold text-gray-900\">No Audits Found</h3>\r\n                                                <p className=\"text-sm text-muted-foreground\">Once you complete a stock count, it will appear here.</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"space-y-4\">\r\n                                            {auditSessions.map((session) => (\r\n                                                <div\r\n                                                    key={session.id}\r\n                                                    className=\"bg-white rounded-2xl shadow-sm border overflow-hidden hover:shadow-md transition-all cursor-pointer group\"\r\n                                                    onClick={() => setSelectedAuditId(selectedAuditId === session.id ? null : session.id)}\r\n                                                >\r\n                                                    <div className=\"p-5 flex items-center justify-between gap-4\">\r\n                                                        <div className=\"flex items-center gap-4\">\r\n                                                            <div className=\"h-12 w-12 rounded-xl bg-sales-primary/10 flex items-center justify-center\">\r\n                                                                <Clock className=\"h-6 w-6 text-sales-primary\" />\r\n                                                            </div>\r\n                                                            <div className=\"flex items-center justify-between\">\r\n                                                                <div>\r\n                                                                    <div className=\"font-bold text-gray-900 flex items-center gap-2\">\r\n                                                                        {session.auditId && (\r\n                                                                            <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-mono font-bold bg-blue-100 text-blue-700 border border-blue-200\">\r\n                                                                                {session.auditId}\r\n                                                                            </span>\r\n                                                                        )}\r\n                                                                        <span>Audit #{session.auditNumber}  {format(session.date, 'PPP')}</span>\r\n                                                                        {session.isEdited && (\r\n                                                                            <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-amber-100 text-amber-700 border border-amber-200\">\r\n                                                                                Edited\r\n                                                                            </span>\r\n                                                                        )}\r\n                                                                    </div>\r\n                                                                    <div className=\"text-xs text-muted-foreground flex items-center gap-2\">\r\n                                                                        <span className=\"font-medium bg-slate-100 px-2 py-0.5 rounded-full\">{session.items.length} Items</span>\r\n                                                                        <span></span>\r\n                                                                        <span>{format(session.date, 'p')}</span>\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                        <div className=\"flex items-center gap-3\">\r\n                                                            <div className=\"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity mr-2\">\r\n                                                                <Button\r\n                                                                    variant=\"outline\"\r\n                                                                    size=\"icon\"\r\n                                                                    className=\"h-8 w-8 rounded-lg\"\r\n                                                                    onClick={(e) => { e.stopPropagation(); handleSessionExportCSV(session); }}\r\n                                                                    title=\"Export CSV\"\r\n                                                                >\r\n                                                                    <Download className=\"h-4 w-4\" />\r\n                                                                </Button>\r\n                                                                <Button\r\n                                                                    variant=\"outline\"\r\n                                                                    size=\"icon\"\r\n                                                                    className=\"h-8 w-8 rounded-lg\"\r\n                                                                    onClick={(e) => { e.stopPropagation(); handleSessionExportPDF(session); }}\r\n                                                                    title=\"Export PDF\"\r\n                                                                >\r\n                                                                    <FileDown className=\"h-4 w-4\" />\r\n                                                                </Button>\r\n                                                                <Button\r\n                                                                    variant=\"outline\"\r\n                                                                    size=\"icon\"\r\n                                                                    className=\"h-8 w-8 rounded-lg text-amber-600 hover:bg-amber-50 hover:text-amber-700 border-amber-100\"\r\n                                                                    onClick={(e) => { e.stopPropagation(); handleSessionEdit(session); }}\r\n                                                                    title=\"Edit Audit\"\r\n                                                                >\r\n                                                                    <Edit className=\"h-4 w-4\" />\r\n                                                                </Button>\r\n                                                                <Button\r\n                                                                    variant=\"outline\"\r\n                                                                    size=\"icon\"\r\n                                                                    className=\"h-8 w-8 rounded-lg text-red-500 hover:bg-red-50 hover:text-red-600 border-red-100\"\r\n                                                                    onClick={(e) => {\r\n                                                                        e.stopPropagation();\r\n                                                                        setDeleteDialogSession(session);\r\n                                                                    }}\r\n                                                                    title=\"Delete & Restore Stock\"\r\n                                                                >\r\n                                                                    <Trash2 className=\"h-4 w-4\" />\r\n                                                                </Button>\r\n                                                            </div>\r\n                                                            <Button variant=\"ghost\" size=\"icon\" className={cn(\"rounded-full transition-transform\", selectedAuditId === session.id && \"rotate-90\")}>\r\n                                                                <ChevronRight className=\"h-5 w-5\" />\r\n                                                            </Button>\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    {selectedAuditId === session.id && (\r\n                                                        <div className=\"border-t bg-slate-50 p-5 pt-0\">\r\n                                                            <div className=\"overflow-x-auto\">\r\n                                                                <Table>\r\n                                                                    <TableHeader>\r\n                                                                        <TableRow className=\"border-b bg-transparent hover:bg-transparent px-0\">\r\n                                                                            <TableHead className=\"h-10 px-0\">Product</TableHead>\r\n                                                                            <TableHead className=\"h-10 text-center\">System</TableHead>\r\n                                                                            <TableHead className=\"h-10 text-center\">Actual</TableHead>\r\n                                                                            <TableHead className=\"h-10 text-right\">Var</TableHead>\r\n                                                                        </TableRow>\r\n                                                                    </TableHeader>\r\n                                                                    <TableBody>\r\n                                                                        {session.items.map((entry) => (\r\n                                                                            <TableRow key={entry.id} className=\"hover:bg-transparent px-0\">\r\n                                                                                <TableCell className=\"px-0 py-3\">\r\n                                                                                    <div className=\"flex items-center gap-2\">\r\n                                                                                        <div className=\"font-medium text-sm\">{entry.product?.name || 'Deleted Product'}</div>\r\n                                                                                        {entry.changeReason?.includes('Stock Count Edit') && (\r\n                                                                                            <span className=\"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-bold bg-amber-100 text-amber-700 border border-amber-200\">\r\n                                                                                                EDITED\r\n                                                                                            </span>\r\n                                                                                        )}\r\n                                                                                    </div>\r\n                                                                                    {entry.referenceId && entry.referenceId !== 'unknown' && (\r\n                                                                                        <div className=\"text-[10px] text-muted-foreground font-mono opacity-50\">Session: {entry.referenceId.split('-').pop()}</div>\r\n                                                                                    )}\r\n                                                                                </TableCell>\r\n                                                                                <TableCell className=\"text-center text-sm py-3\">{entry.oldQuantity}</TableCell>\r\n                                                                                <TableCell className=\"text-center text-sm py-3 font-bold\">{entry.newQuantity}</TableCell>\r\n                                                                                <TableCell className=\"text-right py-3\">\r\n                                                                                    <span className={cn(\r\n                                                                                        \"text-xs font-bold px-2 py-0.5 rounded-full\",\r\n                                                                                        entry.newQuantity > entry.oldQuantity ? \"text-emerald-700 bg-emerald-100\" :\r\n                                                                                            entry.newQuantity < entry.oldQuantity ? \"text-rose-700 bg-rose-100\" :\r\n                                                                                                \"text-slate-600 bg-slate-100\"\r\n                                                                                    )}>\r\n                                                                                        {entry.newQuantity - entry.oldQuantity > 0 ? '+' : ''}\r\n                                                                                        {entry.newQuantity - entry.oldQuantity}\r\n                                                                                    </span>\r\n                                                                                </TableCell>\r\n                                                                            </TableRow>\r\n                                                                        ))}\r\n                                                                    </TableBody>\r\n                                                                </Table>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </TabsContent>\r\n                    </Tabs>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Background Overlay Hint */}\r\n            <div className=\"fixed bottom-6 right-6 pointer-events-none active:opacity-50 transition-opacity\">\r\n                <div className=\"bg-black/80 text-white px-4 py-3 rounded-2xl shadow-2xl flex items-center gap-3 backdrop-blur-md border border-white/20\">\r\n                    <div className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\" />\r\n                    <span className=\"text-xs font-bold tracking-widest uppercase\">Scanner Active</span>\r\n                </div>\r\n            </div>\r\n\r\n            <AlertDialog open={showCommitDialog} onOpenChange={setShowCommitDialog}>\r\n                <AlertDialogContent className=\"w-[95vw] sm:max-w-md rounded-xl\">\r\n                    <AlertDialogHeader>\r\n                        <AlertDialogTitle>Complete Stock Audit</AlertDialogTitle>\r\n                        <AlertDialogDescription className=\"flex flex-col gap-2\">\r\n                            <span>You have recorded counts for {Object.keys(counts).length} items.</span>\r\n                            {editingSessionId ? (\r\n                                <span className=\"p-2 bg-amber-50 text-amber-800 rounded border border-amber-100 text-xs flex items-center gap-2\">\r\n                                    <Info className=\"h-4 w-4 shrink-0 text-amber-500\" />\r\n                                    This will replace the previous records for this audit session with your new counts. All changes will be logged.\r\n                                </span>\r\n                            ) : (\r\n                                <span>Fill in the details below to complete this session.</span>\r\n                            )}\r\n                        </AlertDialogDescription>\r\n                    </AlertDialogHeader>\r\n\r\n                    <div className=\"space-y-4 py-4\">\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-xs font-bold text-muted-foreground uppercase\">Name</label>\r\n                                <Input\r\n                                    placeholder=\"Auditor name...\"\r\n                                    value={auditorName}\r\n                                    onChange={(e) => setAuditorName(e.target.value)}\r\n                                    className=\"h-10\"\r\n                                />\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-xs font-bold text-muted-foreground uppercase\">Phone Number</label>\r\n                                <Input\r\n                                    placeholder=\"Contact number...\"\r\n                                    value={contactPerson}\r\n                                    onChange={(e) => setContactPerson(e.target.value)}\r\n                                    className=\"h-10\"\r\n                                    type=\"tel\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"pt-2 border-t\">\r\n                            <label className=\"text-xs font-bold text-muted-foreground uppercase block mb-3\">Action</label>\r\n                            <div className=\"grid grid-cols-1 gap-3\">\r\n                                <Button\r\n                                    className=\"w-full justify-start h-auto py-4 px-6 flex flex-col items-start gap-1 whitespace-normal text-left\"\r\n                                    onClick={() => commitStockCount(true)}\r\n                                >\r\n                                    <span className=\"font-bold flex items-center gap-2 w-full text-left\">\r\n                                        <Save className=\"h-4 w-4 shrink-0\" />\r\n                                        Update Inventory Stock\r\n                                    </span>\r\n                                    <span className=\"text-xs font-normal opacity-80 w-full text-left\">\r\n                                        This will change the quantities in your system to match what you counted.\r\n                                    </span>\r\n                                </Button>\r\n                                <Button\r\n                                    variant=\"outline\"\r\n                                    className=\"w-full justify-start h-auto py-4 px-6 flex flex-col items-start gap-1 border-2 whitespace-normal text-left\"\r\n                                    onClick={() => commitStockCount(false)}\r\n                                >\r\n                                    <span className=\"font-bold flex items-center gap-2 w-full text-left\">\r\n                                        <ClipboardList className=\"h-4 w-4 shrink-0\" />\r\n                                        Finish Without Updating\r\n                                    </span>\r\n                                    <span className=\"text-xs font-normal text-muted-foreground w-full text-left\">\r\n                                        Just clear the list and finish. Use this if you already updated manually or just wanted a report.\r\n                                    </span>\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <AlertDialogFooter>\r\n                        <AlertDialogCancel className=\"w-full\">Cancel</AlertDialogCancel>\r\n                    </AlertDialogFooter>\r\n                </AlertDialogContent>\r\n            </AlertDialog>\r\n\r\n            {/* Delete Confirmation Dialog */}\r\n            <AlertDialog open={!!deleteDialogSession} onOpenChange={(open) => !open && setDeleteDialogSession(null)}>\r\n                <AlertDialogContent className=\"w-[95vw] sm:max-w-lg\">\r\n                    <AlertDialogHeader>\r\n                        <div className=\"flex items-center gap-3 mb-2\">\r\n                            <div className=\"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center\">\r\n                                <AlertTriangle className=\"h-6 w-6 text-red-600\" />\r\n                            </div>\r\n                            <div>\r\n                                <AlertDialogTitle className=\"text-lg\">Delete Audit Session?</AlertDialogTitle>\r\n                                {deleteDialogSession && (\r\n                                    <p className=\"text-sm text-muted-foreground mt-1\">\r\n                                        {deleteDialogSession.auditId || `Audit #${deleteDialogSession.auditNumber}`}  {format(deleteDialogSession.date, 'PPP')}\r\n                                    </p>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                        <AlertDialogDescription className=\"space-y-3 pt-2\">\r\n                            <p className=\"text-base\">\r\n                                This action will <strong>permanently delete</strong> this audit session and all its records.\r\n                            </p>\r\n                            <div className=\"p-3 bg-amber-50 border border-amber-200 rounded-lg\">\r\n                                <p className=\"text-sm text-amber-900 font-medium\">\r\n                                     Stock levels will be recalculated as if this audit never happened.\r\n                                </p>\r\n                            </div>\r\n                            {deleteDialogSession && (\r\n                                <div className=\"text-sm text-muted-foreground\">\r\n                                    <strong>{deleteDialogSession.items.length} product entries</strong> will be removed from history.\r\n                                </div>\r\n                            )}\r\n                            <p className=\"text-sm font-medium text-red-600\">\r\n                                This action cannot be undone.\r\n                            </p>\r\n                        </AlertDialogDescription>\r\n                    </AlertDialogHeader>\r\n                    <AlertDialogFooter className=\"gap-2 sm:gap-2\">\r\n                        <AlertDialogCancel className=\"flex-1\">Cancel</AlertDialogCancel>\r\n                        <Button\r\n                            variant=\"destructive\"\r\n                            className=\"flex-1\"\r\n                            onClick={() => deleteDialogSession && handleSessionDelete(deleteDialogSession)}\r\n                        >\r\n                            <Trash2 className=\"h-4 w-4 mr-2\" />\r\n                            Delete Audit\r\n                        </Button>\r\n                    </AlertDialogFooter>\r\n                </AlertDialogContent>\r\n            </AlertDialog>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StockCountTab;\r\n","import { useState, useEffect } from 'react';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport {\r\n  getRequisitionsAction,\r\n  createRequisitionAction,\r\n  updateRequisitionAction,\r\n  deleteRequisitionAction\r\n} from '@/app/actions/inventory';\r\n\r\nexport interface Requisition {\r\n  id: string;\r\n  userId: string;\r\n  locationId: string;\r\n  requisitionNumber: string;\r\n  title: string;\r\n  items: RequisitionItem[];\r\n  notes: string | null;\r\n  status: 'draft' | 'submitted' | 'approved' | 'completed';\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nexport interface RequisitionItem {\r\n  id: string;\r\n  productId: string;\r\n  productName: string;\r\n  quantity: number;\r\n  urgentItem?: boolean;\r\n}\r\n\r\nexport const useRequisitions = (userId: string | undefined, locationId: string | undefined) => {\r\n  const [requisitions, setRequisitions] = useState<Requisition[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const { toast } = useToast();\r\n\r\n  const loadRequisitions = async () => {\r\n    if (!userId || !locationId) {\r\n      setRequisitions([]);\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true);\r\n      const result = await getRequisitionsAction(userId, locationId);\r\n      if (result.success && result.data) {\r\n        setRequisitions(result.data.map((req: any) => ({\r\n          ...req,\r\n          createdAt: new Date(req.createdAt),\r\n          updatedAt: new Date(req.updatedAt)\r\n        })));\r\n      } else {\r\n        throw new Error(result.error);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading requisitions:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to load requisitions. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadRequisitions();\r\n  }, [userId, locationId]);\r\n\r\n  const createRequisition = async (\r\n    title: string,\r\n    items: RequisitionItem[],\r\n    notes?: string\r\n  ): Promise<Requisition | null> => {\r\n    if (!userId || !locationId) return null;\r\n\r\n    try {\r\n      const requisitionNumber = generateRequisitionNumber();\r\n\r\n      const result = await createRequisitionAction({\r\n        userId,\r\n        locationId,\r\n        requisitionNumber,\r\n        title,\r\n        items,\r\n        notes: notes || null,\r\n        status: 'draft'\r\n      });\r\n\r\n      if (!result.success || !result.data) {\r\n        throw new Error(result.error);\r\n      }\r\n\r\n      const data = result.data;\r\n      const newRequisition: Requisition = {\r\n        ...data,\r\n        createdAt: new Date(data.createdAt),\r\n        updatedAt: new Date(data.updatedAt)\r\n      };\r\n\r\n      setRequisitions(prev => [newRequisition, ...prev]);\r\n\r\n      toast({\r\n        title: \"Requisition created\",\r\n        description: `Requisition ${requisitionNumber} has been created successfully.`\r\n      });\r\n\r\n      return newRequisition;\r\n    } catch (error) {\r\n      console.error('Error creating requisition:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to create requisition. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const updateRequisition = async (\r\n    id: string,\r\n    updates: Partial<{\r\n      title: string;\r\n      items: RequisitionItem[];\r\n      notes: string;\r\n      status: 'draft' | 'submitted' | 'approved' | 'completed';\r\n    }>\r\n  ): Promise<boolean> => {\r\n    if (!userId) return false;\r\n\r\n    try {\r\n      const result = await updateRequisitionAction(id, userId, updates);\r\n\r\n      if (!result.success || !result.data) {\r\n        throw new Error(result.error);\r\n      }\r\n\r\n      const data = result.data;\r\n      const updatedRequisition: Requisition = {\r\n        ...data,\r\n        createdAt: new Date(data.createdAt),\r\n        updatedAt: new Date(data.updatedAt)\r\n      };\r\n\r\n      setRequisitions(prev => prev.map(req => req.id === id ? updatedRequisition : req));\r\n\r\n      toast({\r\n        title: \"Requisition updated\",\r\n        description: \"Requisition has been updated successfully.\"\r\n      });\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error updating requisition:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to update requisition. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const deleteRequisition = async (id: string): Promise<boolean> => {\r\n    if (!userId) return false;\r\n\r\n    try {\r\n      const result = await deleteRequisitionAction(id, userId);\r\n\r\n      if (!result.success) {\r\n        throw new Error(result.error);\r\n      }\r\n\r\n      setRequisitions(prev => prev.filter(req => req.id !== id));\r\n\r\n      toast({\r\n        title: \"Requisition deleted\",\r\n        description: \"Requisition has been deleted successfully.\"\r\n      });\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error deleting requisition:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to delete requisition. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  return {\r\n    requisitions,\r\n    isLoading,\r\n    loadRequisitions,\r\n    createRequisition,\r\n    updateRequisition,\r\n    deleteRequisition\r\n  };\r\n};\r\n\r\nconst generateRequisitionNumber = () => {\r\n  const date = new Date();\r\n  const year = date.getFullYear().toString().slice(-2);\r\n  const month = (date.getMonth() + 1).toString().padStart(2, '0');\r\n  const day = date.getDate().toString().padStart(2, '0');\r\n  const time = date.getTime().toString().slice(-4);\r\n  return `REQ${year}${month}${day}${time}`;\r\n};","import React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n  Download,\r\n  Eye,\r\n  Edit,\r\n  Trash2,\r\n  Calendar,\r\n  Package,\r\n  AlertTriangle\r\n} from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { usePagination } from '@/hooks/usePagination';\r\nimport { Pagination, PaginationContent, PaginationItem, PaginationLink, PaginationNext, PaginationPrevious } from '@/components/ui/pagination';\r\nimport { cn } from '@/lib/utils';\r\nimport { Requisition } from '@/hooks/useRequisitions';\r\n\r\n// Alternative PDF generation using HTML\r\nconst generateAlternativePDF = async (requisition: Requisition, businessName: string) => {\r\n  // Create a temporary HTML element for PDF generation\r\n  const tempDiv = document.createElement('div');\r\n  tempDiv.style.position = 'absolute';\r\n  tempDiv.style.left = '-9999px';\r\n  tempDiv.style.width = '800px';\r\n  tempDiv.style.padding = '40px';\r\n  tempDiv.style.backgroundColor = 'white';\r\n  tempDiv.style.fontFamily = 'Arial, sans-serif';\r\n\r\n  const validItems = requisition.items.filter(item => item.quantity > 0);\r\n  const totalQuantity = validItems.reduce((sum, item) => sum + item.quantity, 0);\r\n  const urgentItems = validItems.filter(item => item.urgentItem).length;\r\n\r\n  tempDiv.innerHTML = `\r\n    <div style=\"text-align: center; margin-bottom: 40px;\">\r\n      <h1 style=\"color: #2563eb; font-size: 24px; margin: 0;\">PURCHASE REQUISITION</h1>\r\n    </div>\r\n    \r\n    <div style=\"margin-bottom: 30px;\">\r\n      <p><strong>Business:</strong> ${businessName}</p>\r\n      <p><strong>Date:</strong> ${format(requisition.createdAt, 'PPP')}</p>\r\n      <p><strong>Requisition #:</strong> ${requisition.requisitionNumber}</p>\r\n      <p><strong>Title:</strong> ${requisition.title}</p>\r\n      <p><strong>Status:</strong> ${requisition.status.toUpperCase()}</p>\r\n    </div>\r\n    \r\n    ${validItems.length > 0 ? `\r\n      <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 30px;\">\r\n        <thead>\r\n          <tr style=\"background-color: #2563eb; color: white;\">\r\n            <th style=\"border: 1px solid #ddd; padding: 8px; text-align: left;\">#</th>\r\n            <th style=\"border: 1px solid #ddd; padding: 8px; text-align: left;\">Item Description</th>\r\n            <th style=\"border: 1px solid #ddd; padding: 8px; text-align: left;\">Quantity</th>\r\n            <th style=\"border: 1px solid #ddd; padding: 8px; text-align: left;\">Urgent</th>\r\n            <th style=\"border: 1px solid #ddd; padding: 8px; text-align: left;\">Supplier/Price</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          ${validItems.map((item, index) => `\r\n            <tr style=\"${item.urgentItem ? 'background-color: #fef3c7;' : ''}\">\r\n              <td style=\"border: 1px solid #ddd; padding: 8px;\">${index + 1}</td>\r\n              <td style=\"border: 1px solid #ddd; padding: 8px;\">${item.productName}</td>\r\n              <td style=\"border: 1px solid #ddd; padding: 8px;\">${Math.round(item.quantity).toLocaleString()}</td>\r\n              <td style=\"border: 1px solid #ddd; padding: 8px;\">${item.urgentItem ? 'Yes' : 'No'}</td>\r\n              <td style=\"border: 1px solid #ddd; padding: 8px;\"></td>\r\n            </tr>\r\n          `).join('')}\r\n        </tbody>\r\n      </table>\r\n      \r\n      <div style=\"margin-bottom: 30px; padding: 15px; background-color: #f8fafc; border-radius: 8px;\">\r\n        <h3 style=\"margin: 0 0 10px 0; color: #1e40af;\">SUMMARY</h3>\r\n        <p><strong>Total Items:</strong> ${validItems.length}</p>\r\n        <p><strong>Total Quantity:</strong> ${totalQuantity.toLocaleString()}</p>\r\n        <p><strong>Urgent Items:</strong> ${urgentItems}</p>\r\n      </div>\r\n    ` : `\r\n      <p>No items in this requisition.</p>\r\n    `}\r\n    \r\n    ${requisition.notes ? `\r\n      <div style=\"margin-bottom: 30px;\">\r\n        <h3 style=\"color: #1e40af;\">NOTES</h3>\r\n        <p style=\"padding: 10px; background-color: #f1f5f9; border-radius: 4px;\">${requisition.notes}</p>\r\n      </div>\r\n    ` : ''}\r\n    \r\n    <div style=\"margin-top: 60px;\">\r\n      <div style=\"display: flex; justify-content: space-between; margin-bottom: 20px;\">\r\n        <div>\r\n          <p>Requested by: _____________________</p>\r\n          <p>Date: _____________</p>\r\n        </div>\r\n        <div>\r\n          <p>Approved by: _____________________</p>\r\n          <p>Date: _____________</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  document.body.appendChild(tempDiv);\r\n\r\n  try {\r\n    const { generateVectorPDF } = await import('@/utils/generateVectorPDF');\r\n    await generateVectorPDF(tempDiv, {\r\n      filename: `Requisition_${requisition.requisitionNumber}.pdf`,\r\n      orientation: 'portrait',\r\n      format: 'a4',\r\n      margins: { top: 10, right: 10, bottom: 10, left: 10 }\r\n    });\r\n  } finally {\r\n    document.body.removeChild(tempDiv);\r\n  }\r\n};\r\n\r\ninterface SavedRequisitionsProps {\r\n  requisitions: Requisition[];\r\n  isLoading: boolean;\r\n  onRefresh: () => void;\r\n  onDelete: (id: string) => void;\r\n  businessName?: string;\r\n}\r\n\r\nconst SavedRequisitions = ({\r\n  requisitions,\r\n  isLoading,\r\n  onRefresh,\r\n  onDelete,\r\n  businessName = 'Your Business Name'\r\n}: SavedRequisitionsProps) => {\r\n  const isMobile = useIsMobile();\r\n  const [selectedRequisition, setSelectedRequisition] = useState<Requisition | null>(null);\r\n\r\n  const {\r\n    currentPage,\r\n    setCurrentPage,\r\n    paginatedItems,\r\n    totalPages\r\n  } = usePagination({ items: requisitions, itemsPerPage: 10 });\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'draft': return 'bg-gray-100 text-gray-800';\r\n      case 'submitted': return 'bg-blue-100 text-blue-800';\r\n      case 'approved': return 'bg-green-100 text-green-800';\r\n      case 'completed': return 'bg-purple-100 text-purple-800';\r\n      default: return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const formatNumber = (num: number) => {\r\n    return Math.round(num).toLocaleString();\r\n  };\r\n\r\n  const generateRequisitionPDF = async (requisition: Requisition) => {\r\n    try {\r\n      console.log('Starting PDF generation for requisition:', requisition.requisitionNumber);\r\n\r\n      // Use the alternative PDF generation method\r\n      await generateAlternativePDF(requisition, businessName);\r\n      console.log('PDF generated successfully using alternative method');\r\n\r\n    } catch (error) {\r\n      console.error('PDF generation failed:', error);\r\n      console.error('Error message:', error.message);\r\n      console.error('Error stack:', error.stack);\r\n\r\n      // Show user-friendly error message\r\n      alert(`Failed to generate PDF: ${error.message || 'Unknown error occurred'}`);\r\n    }\r\n  };\r\n\r\n  const RequisitionCard = ({ requisition }: { requisition: Requisition }) => {\r\n    const totalQuantity = requisition.items.reduce((sum, item) => sum + item.quantity, 0);\r\n    const urgentItems = requisition.items.filter(item => item.urgentItem).length;\r\n\r\n    return (\r\n      <Card className=\"mb-4\">\r\n        <CardHeader className=\"pb-3\">\r\n          <div className=\"flex items-start justify-between\">\r\n            <div>\r\n              <CardTitle className=\"text-sm font-medium\">{requisition.title}</CardTitle>\r\n              <p className=\"text-xs text-muted-foreground mt-1\">\r\n                {requisition.requisitionNumber}  {format(requisition.createdAt, 'MMM d, yyyy')}\r\n              </p>\r\n            </div>\r\n            <Badge className={cn('text-xs', getStatusColor(requisition.status))}>\r\n              {requisition.status}\r\n            </Badge>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"pt-0\">\r\n          <div className=\"space-y-2 text-xs\">\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-muted-foreground\">Items:</span>\r\n              <span>{requisition.items.length}</span>\r\n            </div>\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-muted-foreground\">Total Qty:</span>\r\n              <span>{formatNumber(totalQuantity)}</span>\r\n            </div>\r\n            {urgentItems > 0 && (\r\n              <div className=\"flex justify-between text-orange-600\">\r\n                <span className=\"flex items-center gap-1\">\r\n                  <AlertTriangle size={12} />\r\n                  Urgent:\r\n                </span>\r\n                <span>{urgentItems}</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"flex gap-2 mt-4\">\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setSelectedRequisition(requisition)}\r\n              className=\"flex-1\"\r\n            >\r\n              <Eye size={14} className=\"mr-1\" />\r\n              View\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => generateRequisitionPDF(requisition)}\r\n              className=\"flex-1\"\r\n            >\r\n              <Download size={14} className=\"mr-1\" />\r\n              PDF\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => onDelete(requisition.id)}\r\n              className=\"px-2\"\r\n            >\r\n              <Trash2 size={14} />\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"text-center py-8\">\r\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\r\n            <p className=\"mt-2 text-muted-foreground\">Loading requisitions...</p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  if (requisitions.length === 0) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"text-center py-8\">\r\n            <Package className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n            <h3 className=\"text-lg font-medium mb-2\">No requisitions yet</h3>\r\n            <p className=\"text-muted-foreground\">\r\n              Create your first requisition to see it appear here.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center justify-between\">\r\n            <CardTitle>Saved Requisitions ({requisitions.length})</CardTitle>\r\n            <Button variant=\"outline\" size=\"sm\" onClick={onRefresh}>\r\n              Refresh\r\n            </Button>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {isMobile ? (\r\n            <div className=\"space-y-4\">\r\n              {paginatedItems.map(requisition => (\r\n                <RequisitionCard key={requisition.id} requisition={requisition} />\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"overflow-x-auto\">\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead>Title</TableHead>\r\n                    <TableHead>Number</TableHead>\r\n                    <TableHead>Date</TableHead>\r\n                    <TableHead>Items</TableHead>\r\n                    <TableHead>Total Qty</TableHead>\r\n                    <TableHead>Status</TableHead>\r\n                    <TableHead>Actions</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n                <TableBody>\r\n                  {paginatedItems.map(requisition => {\r\n                    const totalQuantity = requisition.items.reduce((sum, item) => sum + item.quantity, 0);\r\n                    const urgentItems = requisition.items.filter(item => item.urgentItem).length;\r\n\r\n                    return (\r\n                      <TableRow key={requisition.id}>\r\n                        <TableCell>\r\n                          <div>\r\n                            <div className=\"font-medium\">{requisition.title}</div>\r\n                            {urgentItems > 0 && (\r\n                              <div className=\"flex items-center gap-1 text-orange-600 text-xs mt-1\">\r\n                                <AlertTriangle size={10} />\r\n                                {urgentItems} urgent\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </TableCell>\r\n                        <TableCell className=\"font-mono text-sm\">\r\n                          {requisition.requisitionNumber}\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          {format(requisition.createdAt, 'MMM d, yyyy')}\r\n                        </TableCell>\r\n                        <TableCell>{requisition.items.length}</TableCell>\r\n                        <TableCell>{formatNumber(totalQuantity)}</TableCell>\r\n                        <TableCell>\r\n                          <Badge className={cn('text-xs', getStatusColor(requisition.status))}>\r\n                            {requisition.status}\r\n                          </Badge>\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          <div className=\"flex gap-1\">\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              onClick={() => setSelectedRequisition(requisition)}\r\n                            >\r\n                              <Eye size={14} />\r\n                            </Button>\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              onClick={() => generateRequisitionPDF(requisition)}\r\n                            >\r\n                              <Download size={14} />\r\n                            </Button>\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              onClick={() => onDelete(requisition.id)}\r\n                            >\r\n                              <Trash2 size={14} />\r\n                            </Button>\r\n                          </div>\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    );\r\n                  })}\r\n                </TableBody>\r\n              </Table>\r\n            </div>\r\n          )}\r\n\r\n          {totalPages > 1 && (\r\n            <div className=\"mt-4\">\r\n              <Pagination>\r\n                <PaginationContent>\r\n                  <PaginationItem>\r\n                    <PaginationPrevious\r\n                      onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\r\n                      className={currentPage === 1 ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                    />\r\n                  </PaginationItem>\r\n                  {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (\r\n                    <PaginationItem key={page}>\r\n                      <PaginationLink\r\n                        onClick={() => setCurrentPage(page)}\r\n                        isActive={currentPage === page}\r\n                        className=\"cursor-pointer\"\r\n                      >\r\n                        {page}\r\n                      </PaginationLink>\r\n                    </PaginationItem>\r\n                  ))}\r\n                  <PaginationItem>\r\n                    <PaginationNext\r\n                      onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\r\n                      className={currentPage === totalPages ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                    />\r\n                  </PaginationItem>\r\n                </PaginationContent>\r\n              </Pagination>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Requisition Detail Modal */}\r\n      {selectedRequisition && (\r\n        <Card className=\"fixed inset-4 z-50 overflow-auto bg-background border shadow-lg\">\r\n          <CardHeader>\r\n            <div className=\"flex items-start justify-between\">\r\n              <div>\r\n                <CardTitle>{selectedRequisition.title}</CardTitle>\r\n                <p className=\"text-sm text-muted-foreground mt-1\">\r\n                  {selectedRequisition.requisitionNumber}  {format(selectedRequisition.createdAt, 'PPP')}\r\n                </p>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Badge className={cn('text-xs', getStatusColor(selectedRequisition.status))}>\r\n                  {selectedRequisition.status}\r\n                </Badge>\r\n                <Button variant=\"outline\" size=\"sm\" onClick={() => setSelectedRequisition(null)}>\r\n                  Close\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-4\">\r\n              {selectedRequisition.notes && (\r\n                <div>\r\n                  <h4 className=\"font-medium mb-2\">Notes:</h4>\r\n                  <p className=\"text-sm text-muted-foreground\">{selectedRequisition.notes}</p>\r\n                </div>\r\n              )}\r\n\r\n              <div>\r\n                <h4 className=\"font-medium mb-2\">Items ({selectedRequisition.items.length}):</h4>\r\n                <div className=\"overflow-x-auto\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Item</TableHead>\r\n                        <TableHead>Quantity</TableHead>\r\n                        <TableHead>Urgent</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {selectedRequisition.items.map((item, index) => (\r\n                        <TableRow key={index} className={item.urgentItem ? \"bg-orange-50\" : \"\"}>\r\n                          <TableCell>{item.productName}</TableCell>\r\n                          <TableCell>{formatNumber(item.quantity)}</TableCell>\r\n                          <TableCell>\r\n                            {item.urgentItem && (\r\n                              <Badge variant=\"destructive\" className=\"text-xs\">\r\n                                <AlertTriangle size={10} className=\"mr-1\" />\r\n                                Urgent\r\n                              </Badge>\r\n                            )}\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SavedRequisitions;","import React, { useState, useCallback, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Plus, Trash2, Download, ChevronUp, ChevronDown, AlertTriangle, ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { Product } from '@/types';\r\nimport ProductSuggestionsPanel from './ProductSuggestionsPanel';\r\nimport { useProductSuggestions } from '@/hooks/useProductSuggestions';\r\nimport { format } from 'date-fns';\r\nimport { cn } from '@/lib/utils';\r\nimport { useRequisitions } from '@/hooks/useRequisitions';\r\nimport SavedRequisitions from './SavedRequisitions';\r\nimport jsPDF from 'jspdf';\r\nimport 'jspdf-autotable';\r\n\r\n// Extend jsPDF type to include autoTable\r\ndeclare module 'jspdf' {\r\n  interface jsPDF {\r\n    autoTable: (options: any) => jsPDF;\r\n    lastAutoTable: any;\r\n  }\r\n}\r\n\r\ninterface RequisitionItem {\r\n  id: string;\r\n  productId: string;\r\n  productName: string;\r\n  quantity: number;\r\n  searchTerm: string;\r\n  urgentItem?: boolean;\r\n}\r\n\r\ninterface MobileRequisitionRowProps {\r\n  row: RequisitionItem;\r\n  index: number;\r\n  onUpdateRow: (id: string, field: keyof RequisitionItem, value: string | number | boolean) => void;\r\n  onRemoveRow: (id: string) => void;\r\n  onProductSelect: (product: Product, rowId: string) => void;\r\n  onInputFocus: (rowId: string) => void;\r\n  onAddRowAfter: (rowId: string) => void;\r\n  onKeyDown: (e: React.KeyboardEvent, rowId: string) => void;\r\n  onMoveRow: (rowId: string, direction: 'up' | 'down') => void;\r\n  canRemove: boolean;\r\n  isLastRow: boolean;\r\n  totalRows: number;\r\n}\r\n\r\nconst MobileRequisitionRow = ({\r\n  row,\r\n  index,\r\n  onUpdateRow,\r\n  onRemoveRow,\r\n  onProductSelect,\r\n  onInputFocus,\r\n  onAddRowAfter,\r\n  onKeyDown,\r\n  onMoveRow,\r\n  canRemove,\r\n  isLastRow,\r\n  totalRows\r\n}: MobileRequisitionRowProps) => {\r\n  return (\r\n    <Card className={cn(\"mb-4 shadow-sm\", row.urgentItem && \"border-destructive\")}>\r\n      <CardHeader className=\"pb-3\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Item #{index + 1}</CardTitle>\r\n            {row.urgentItem && (\r\n              <Badge variant=\"destructive\" className=\"text-xs\">\r\n                <AlertTriangle size={10} className=\"mr-1\" />\r\n                Urgent\r\n              </Badge>\r\n            )}\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"icon\"\r\n              onClick={() => onMoveRow(row.id, 'up')}\r\n              disabled={index === 0}\r\n              className=\"h-8 w-8\"\r\n            >\r\n              <ChevronUp size={14} />\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"icon\"\r\n              onClick={() => onMoveRow(row.id, 'down')}\r\n              disabled={index === totalRows - 1}\r\n              className=\"h-8 w-8\"\r\n            >\r\n              <ChevronDown size={14} />\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"icon\"\r\n              onClick={() => onRemoveRow(row.id)}\r\n              disabled={!canRemove}\r\n              className=\"h-8 w-8\"\r\n            >\r\n              <Trash2 size={14} />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">\r\n        {/* Product Search */}\r\n        <div className=\"relative\">\r\n          <label className=\"text-xs font-medium text-muted-foreground mb-1 block\">\r\n            Product\r\n          </label>\r\n          <Input\r\n            placeholder=\"Type to search products...\"\r\n            value={row.searchTerm}\r\n            onChange={(e) => onUpdateRow(row.id, 'searchTerm', e.target.value)}\r\n            onFocus={() => onInputFocus(row.id)}\r\n            onKeyDown={(e) => onKeyDown(e, row.id)}\r\n            className=\"w-full\"\r\n          />\r\n        </div>\r\n\r\n        {/* Quantity and Urgent Flag */}\r\n        <div className=\"grid grid-cols-2 gap-3\">\r\n          <div>\r\n            <label className=\"text-xs font-medium text-muted-foreground mb-1 block\">\r\n              Quantity\r\n            </label>\r\n            <Input\r\n              type=\"number\"\r\n              min=\"0\"\r\n              step=\"1\"\r\n              value={row.quantity || ''}\r\n              onChange={(e) => onUpdateRow(row.id, 'quantity', parseInt(e.target.value) || 0)}\r\n              onKeyDown={(e) => onKeyDown(e, row.id)}\r\n              placeholder=\"0\"\r\n            />\r\n          </div>\r\n          <div className=\"flex items-end\">\r\n            <label className=\"flex items-center gap-2 text-xs font-medium cursor-pointer\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={row.urgentItem || false}\r\n                onChange={(e) => onUpdateRow(row.id, 'urgentItem', e.target.checked)}\r\n                className=\"rounded\"\r\n              />\r\n              Mark as urgent\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Add Row Button - only show on last row */}\r\n        {isLastRow && (\r\n          <div className=\"flex justify-center pt-2\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() => onAddRowAfter(row.id)}\r\n              className=\"gap-2 text-muted-foreground hover:text-foreground\"\r\n            >\r\n              <Plus size={14} />\r\n              Add row below\r\n            </Button>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nconst RequisitionTab = () => {\r\n  const { user } = useAuth();\r\n  const { products } = useProducts(user?.id, 10000); // Load all products for proper lookup\r\n  const { settings } = useBusinessSettings();\r\n  const { currentBusiness } = useBusiness();\r\n  const { toast } = useToast();\r\n  const isMobile = useIsMobile();\r\n\r\n  const [requisitionItems, setRequisitionItems] = useState<RequisitionItem[]>([\r\n    {\r\n      id: '1',\r\n      productId: '',\r\n      productName: '',\r\n      quantity: 0,\r\n      searchTerm: '',\r\n      urgentItem: false\r\n    }\r\n  ]);\r\n\r\n  const [requisitionTitle, setRequisitionTitle] = useState<string>('');\r\n  const [notes, setNotes] = useState<string>('');\r\n  const [focusedRowId, setFocusedRowId] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  // Product suggestions hook\r\n  const focusedRow = requisitionItems.find(row => row.id === focusedRowId);\r\n  const {\r\n    suggestions,\r\n    isOpen: panelOpen,\r\n    closePanel\r\n  } = useProductSuggestions(products, focusedRow?.searchTerm || '');\r\n\r\n  // Get low stock items (items below minimum stock level)\r\n  const lowStockItems = products.filter(product =>\r\n    product.quantity <= product.minimumStock\r\n  );\r\n\r\n  // Low stock pagination\r\n  const [lowStockExpanded, setLowStockExpanded] = useState(false);\r\n  const [lowStockPage, setLowStockPage] = useState(1);\r\n  const lowStockItemsPerPage = 15;\r\n\r\n  const paginatedLowStockItems = lowStockItems.slice(\r\n    (lowStockPage - 1) * lowStockItemsPerPage,\r\n    lowStockPage * lowStockItemsPerPage\r\n  );\r\n\r\n  const totalLowStockPages = Math.ceil(lowStockItems.length / lowStockItemsPerPage);\r\n\r\n  // Initialize requisitions hook\r\n  const {\r\n    requisitions,\r\n    isLoading: requisitionsLoading,\r\n    loadRequisitions,\r\n    createRequisition,\r\n    deleteRequisition\r\n  } = useRequisitions(user?.id, currentBusiness?.id);\r\n\r\n  const formatNumber = (num: number) => {\r\n    return Math.round(num).toLocaleString();\r\n  };\r\n\r\n  // Calculate total amount for requisition items\r\n  const calculateTotalAmount = () => {\r\n    return requisitionItems.reduce((total, item) => {\r\n      if (!item.productId || !item.quantity) return total;\r\n      const product = products.find(p => p.id === item.productId);\r\n      if (!product) return total;\r\n      return total + (product.costPrice * item.quantity);\r\n    }, 0);\r\n  };\r\n\r\n  const totalAmount = calculateTotalAmount();\r\n\r\n  const addNewRow = useCallback(() => {\r\n    const newRow: RequisitionItem = {\r\n      id: Date.now().toString(),\r\n      productId: '',\r\n      productName: '',\r\n      quantity: 0,\r\n      searchTerm: '',\r\n      urgentItem: false\r\n    };\r\n    setRequisitionItems(prev => [...prev, newRow]);\r\n  }, []);\r\n\r\n  const addRowAfter = useCallback((afterRowId: string) => {\r\n    const newRow: RequisitionItem = {\r\n      id: Date.now().toString(),\r\n      productId: '',\r\n      productName: '',\r\n      quantity: 0,\r\n      searchTerm: '',\r\n      urgentItem: false\r\n    };\r\n    setRequisitionItems(prev => {\r\n      const index = prev.findIndex(row => row.id === afterRowId);\r\n      const newRows = [...prev];\r\n      newRows.splice(index + 1, 0, newRow);\r\n      return newRows;\r\n    });\r\n  }, []);\r\n\r\n  const moveRow = useCallback((rowId: string, direction: 'up' | 'down') => {\r\n    setRequisitionItems(prev => {\r\n      const index = prev.findIndex(row => row.id === rowId);\r\n      if (index === -1) return prev;\r\n      const newIndex = direction === 'up' ? index - 1 : index + 1;\r\n      if (newIndex < 0 || newIndex >= prev.length) return prev;\r\n      const newRows = [...prev];\r\n      [newRows[index], newRows[newIndex]] = [newRows[newIndex], newRows[index]];\r\n      return newRows;\r\n    });\r\n  }, []);\r\n\r\n  const handleKeyDown = useCallback((e: React.KeyboardEvent, rowId: string) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      addRowAfter(rowId);\r\n    }\r\n  }, [addRowAfter]);\r\n\r\n  const removeRow = useCallback((id: string) => {\r\n    if (requisitionItems.length > 1) {\r\n      setRequisitionItems(prev => prev.filter(row => row.id !== id));\r\n      if (focusedRowId === id) {\r\n        setFocusedRowId(null);\r\n      }\r\n    }\r\n  }, [requisitionItems.length, focusedRowId]);\r\n\r\n  const updateRow = useCallback((id: string, field: keyof RequisitionItem, value: string | number | boolean) => {\r\n    setRequisitionItems(prev => prev.map(row => {\r\n      if (row.id === id) {\r\n        const updatedRow = { ...row, [field]: value };\r\n\r\n        // If searchTerm is updated, clear product selection if it doesn't match\r\n        if (field === 'searchTerm' && typeof value === 'string') {\r\n          const matchingProduct = products.find(p => p.name.toLowerCase() === value.toLowerCase());\r\n          if (!matchingProduct) {\r\n            updatedRow.productId = '';\r\n            updatedRow.productName = '';\r\n          }\r\n        }\r\n\r\n        return updatedRow;\r\n      }\r\n      return row;\r\n    }));\r\n  }, [products]);\r\n\r\n  const handleProductSelect = useCallback((product: Product) => {\r\n    if (!focusedRowId) return;\r\n    setRequisitionItems(prev => prev.map(row => {\r\n      if (row.id === focusedRowId) {\r\n        return {\r\n          ...row,\r\n          productId: product.id,\r\n          productName: product.name,\r\n          searchTerm: product.name\r\n        };\r\n      }\r\n      return row;\r\n    }));\r\n    setFocusedRowId(null);\r\n  }, [focusedRowId]);\r\n\r\n  const handleInputFocus = useCallback((rowId: string) => {\r\n    setFocusedRowId(rowId);\r\n  }, []);\r\n\r\n  const addLowStockItem = useCallback((product: Product) => {\r\n    const existingRow = requisitionItems.find(row => row.productId === product.id);\r\n    if (existingRow) {\r\n      toast({\r\n        title: \"Item already added\",\r\n        description: `${product.name} is already in the requisition list.`,\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    const newRow: RequisitionItem = {\r\n      id: Date.now().toString(),\r\n      productId: product.id,\r\n      productName: product.name,\r\n      quantity: Math.max(1, product.minimumStock - product.quantity),\r\n      searchTerm: product.name,\r\n      urgentItem: product.quantity === 0 // Mark as urgent if out of stock\r\n    };\r\n    setRequisitionItems(prev => [...prev, newRow]);\r\n  }, [requisitionItems, toast]);\r\n\r\n  const generateRequisitionNumber = () => {\r\n    const date = new Date();\r\n    const year = date.getFullYear().toString().slice(-2);\r\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\r\n    const day = date.getDate().toString().padStart(2, '0');\r\n    const time = date.getTime().toString().slice(-4);\r\n    return `REQ${year}${month}${day}${time}`;\r\n  };\r\n\r\n  const generatePDF = useCallback(() => {\r\n    const doc = new jsPDF();\r\n    const pageWidth = doc.internal.pageSize.width;\r\n\r\n    // Header\r\n    doc.setFontSize(20);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text('PURCHASE REQUISITION', pageWidth / 2, 20, { align: 'center' });\r\n\r\n    // Business info\r\n    doc.setFontSize(12);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.text(`Business: ${settings.businessName || 'Your Business Name'}`, 20, 40);\r\n    doc.text(`Date: ${format(new Date(), 'PPP')}`, 20, 50);\r\n    doc.text(`Requisition #: ${generateRequisitionNumber()}`, 20, 60);\r\n\r\n    if (requisitionTitle) {\r\n      doc.text(`Title: ${requisitionTitle}`, 20, 70);\r\n    }\r\n\r\n    // Filter items with products selected and quantity > 0\r\n    const validItems = requisitionItems.filter(item => item.productId && item.quantity > 0);\r\n\r\n    if (validItems.length === 0) {\r\n      doc.text('No items to requisition.', 20, 90);\r\n    } else {\r\n      // Calculate amounts for each item\r\n      const tableData = validItems.map((item, index) => {\r\n        const product = products.find(p => p.id === item.productId);\r\n        const amount = product ? product.costPrice * item.quantity : 0;\r\n        return [\r\n          index + 1,\r\n          item.productName,\r\n          formatNumber(item.quantity),\r\n          product ? `${settings.currency} ${formatNumber(product.costPrice)}` : '-',\r\n          `${settings.currency} ${formatNumber(amount)}`,\r\n          item.urgentItem ? 'Yes' : 'No'\r\n        ];\r\n      });\r\n\r\n      // Table\r\n      doc.autoTable({\r\n        head: [['#', 'Item Description', 'Qty', 'Unit Cost', 'Amount', 'Urgent']],\r\n        body: tableData,\r\n        startY: requisitionTitle ? 80 : 70,\r\n        theme: 'grid',\r\n        styles: {\r\n          fontSize: 10,\r\n          cellPadding: 3\r\n        },\r\n        headStyles: {\r\n          fillColor: [41, 128, 185],\r\n          textColor: 255\r\n        },\r\n        columnStyles: {\r\n          0: { cellWidth: 15 },\r\n          1: { cellWidth: 60 },\r\n          2: { cellWidth: 20 },\r\n          3: { cellWidth: 30 },\r\n          4: { cellWidth: 30 },\r\n          5: { cellWidth: 20 }\r\n        }\r\n      });\r\n\r\n      // Summary\r\n      const totalQuantity = validItems.reduce((sum, item) => sum + item.quantity, 0);\r\n      const urgentItems = validItems.filter(item => item.urgentItem).length;\r\n\r\n      let yPos = doc.lastAutoTable.finalY + 20;\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.text('SUMMARY:', 20, yPos);\r\n      doc.setFont('helvetica', 'normal');\r\n      doc.text(`Total Items: ${validItems.length}`, 20, yPos + 10);\r\n      doc.text(`Total Quantity: ${formatNumber(totalQuantity)}`, 20, yPos + 20);\r\n      doc.text(`Total Amount: ${settings.currency} ${formatNumber(totalAmount)}`, 20, yPos + 30);\r\n      doc.text(`Urgent Items: ${urgentItems}`, 20, yPos + 40);\r\n    }\r\n\r\n    // Notes section\r\n    if (notes) {\r\n      let notesY = validItems.length > 0 ? doc.lastAutoTable.finalY + 70 : 110;\r\n      if (notesY > 250) {\r\n        doc.addPage();\r\n        notesY = 30;\r\n      }\r\n\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.text('NOTES:', 20, notesY);\r\n      doc.setFont('helvetica', 'normal');\r\n\r\n      const splitNotes = doc.splitTextToSize(notes, pageWidth - 40);\r\n      doc.text(splitNotes, 20, notesY + 10);\r\n    }\r\n\r\n    // Footer\r\n    const finalY = doc.internal.pageSize.height - 30;\r\n    doc.setFontSize(10);\r\n    doc.text('Requested by: _____________________', 20, finalY);\r\n    doc.text('Date: _____________', 120, finalY);\r\n    doc.text('Approved by: _____________________', 20, finalY + 10);\r\n    doc.text('Date: _____________', 120, finalY + 10);\r\n\r\n    const fileName = `Requisition_${generateRequisitionNumber()}.pdf`;\r\n    doc.save(fileName);\r\n\r\n    return fileName;\r\n  }, [requisitionItems, requisitionTitle, notes, settings.businessName, products, settings.currency, totalAmount]);\r\n\r\n  const saveRequisition = useCallback(async () => {\r\n    if (!user || !currentBusiness) return;\r\n\r\n    const validItems = requisitionItems.filter(item => item.productId && item.quantity > 0);\r\n\r\n    if (validItems.length === 0) {\r\n      toast({\r\n        title: \"No items to save\",\r\n        description: \"Please add at least one item with a quantity greater than 0.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (!requisitionTitle.trim()) {\r\n      toast({\r\n        title: \"Title required\",\r\n        description: \"Please enter a title for this requisition.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const requisitionData = validItems.map(item => ({\r\n        id: item.id,\r\n        productId: item.productId,\r\n        productName: item.productName,\r\n        quantity: item.quantity,\r\n        urgentItem: item.urgentItem || false\r\n      }));\r\n\r\n      await createRequisition(requisitionTitle, requisitionData, notes);\r\n\r\n      // Reset form but keep it visible\r\n      setRequisitionItems([{\r\n        id: Date.now().toString(),\r\n        productId: '',\r\n        productName: '',\r\n        quantity: 0,\r\n        searchTerm: '',\r\n        urgentItem: false\r\n      }]);\r\n      setRequisitionTitle('');\r\n      setNotes('');\r\n\r\n    } catch (error) {\r\n      console.error('Error saving requisition:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to save requisition. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [user, currentBusiness, requisitionItems, requisitionTitle, notes, toast, createRequisition]);\r\n\r\n  const handleDownloadPDF = useCallback(() => {\r\n    const validItems = requisitionItems.filter(item => item.productId && item.quantity > 0);\r\n\r\n    if (validItems.length === 0) {\r\n      toast({\r\n        title: \"No items to download\",\r\n        description: \"Please add at least one item with a quantity greater than 0.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    const fileName = generatePDF();\r\n    toast({\r\n      title: \"PDF downloaded\",\r\n      description: `Requisition has been downloaded as ${fileName}.`\r\n    });\r\n  }, [requisitionItems, generatePDF, toast]);\r\n\r\n  const totalQuantity = requisitionItems.reduce((sum, row) => sum + row.quantity, 0);\r\n\r\n  return (\r\n    <div className=\"space-y-4 md:space-y-6\">\r\n      {/* Low Stock Alert */}\r\n      {lowStockItems.length > 0 && (\r\n        <Card className=\"border-orange-200 bg-orange-50\">\r\n          <CardHeader className=\"pb-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <CardTitle className=\"text-orange-800 flex items-center gap-2\">\r\n                <AlertTriangle size={20} />\r\n                Low Stock Items ({lowStockItems.length})\r\n              </CardTitle>\r\n              {!lowStockExpanded && lowStockItems.length > lowStockItemsPerPage && (\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={() => setLowStockExpanded(true)}\r\n                  className=\"text-orange-700 hover:text-orange-800\"\r\n                >\r\n                  View All\r\n                </Button>\r\n              )}\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <p className=\"text-sm text-orange-700 mb-3\">\r\n              The following items are running low or out of stock. Click to add them to your requisition:\r\n            </p>\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              {(lowStockExpanded ? paginatedLowStockItems : lowStockItems.slice(0, 5)).map(product => (\r\n                <Button\r\n                  key={product.id}\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => addLowStockItem(product)}\r\n                  className=\"text-xs border-orange-300 hover:bg-orange-100\"\r\n                >\r\n                  {product.name} ({product.quantity}/{product.minimumStock})\r\n                </Button>\r\n              ))}\r\n              {!lowStockExpanded && lowStockItems.length > 5 && (\r\n                <span className=\"text-xs text-orange-600 self-center\">\r\n                  +{lowStockItems.length - 5} more items\r\n                </span>\r\n              )}\r\n            </div>\r\n\r\n            {lowStockExpanded && (\r\n              <div className=\"mt-4 flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => setLowStockPage(prev => Math.max(1, prev - 1))}\r\n                    disabled={lowStockPage === 1}\r\n                  >\r\n                    <ChevronLeft size={14} />\r\n                    Previous\r\n                  </Button>\r\n                  <span className=\"text-xs text-muted-foreground\">\r\n                    Page {lowStockPage} of {totalLowStockPages}\r\n                  </span>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => setLowStockPage(prev => Math.min(totalLowStockPages, prev + 1))}\r\n                    disabled={lowStockPage === totalLowStockPages}\r\n                  >\r\n                    Next\r\n                    <ChevronRight size={14} />\r\n                  </Button>\r\n                </div>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={() => {\r\n                    setLowStockExpanded(false);\r\n                    setLowStockPage(1);\r\n                  }}\r\n                  className=\"text-orange-700 hover:text-orange-800\"\r\n                >\r\n                  Show Less\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Main Requisition Form */}\r\n      <Card className=\"shadow-sm\">\r\n        <CardHeader className=\"pb-3 md:pb-6\">\r\n          <div className=\"space-y-3 md:space-y-0 md:flex md:items-start md:justify-between\">\r\n            <div className=\"space-y-3 flex-1\">\r\n              <CardTitle className=\"text-base md:text-lg\">Purchase Requisition</CardTitle>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                <div>\r\n                  <label className=\"text-sm font-medium text-muted-foreground mb-1 block\">\r\n                    Requisition Title *\r\n                  </label>\r\n                  <Input\r\n                    placeholder=\"Enter requisition title\"\r\n                    value={requisitionTitle}\r\n                    onChange={(e) => setRequisitionTitle(e.target.value)}\r\n                    className=\"w-full\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"text-sm font-medium text-muted-foreground mb-1 block\">\r\n                    Notes\r\n                  </label>\r\n                  <Textarea\r\n                    placeholder=\"Additional notes or requirements\"\r\n                    value={notes}\r\n                    onChange={(e) => setNotes(e.target.value)}\r\n                    className=\"w-full min-h-[60px]\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Action buttons */}\r\n            <div className=\"flex gap-2\">\r\n              <Button\r\n                onClick={addNewRow}\r\n                variant=\"outline\"\r\n                className=\"gap-2 flex-1 md:flex-none\"\r\n              >\r\n                <Plus size={16} /> Add Item\r\n              </Button>\r\n              <Button\r\n                onClick={saveRequisition}\r\n                disabled={isLoading}\r\n                variant=\"secondary\"\r\n                className=\"gap-2 flex-1 md:flex-none\"\r\n              >\r\n                Save\r\n              </Button>\r\n              <Button\r\n                onClick={handleDownloadPDF}\r\n                className=\"gap-2 flex-1 md:flex-none\"\r\n              >\r\n                <Download size={16} /> PDF\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"p-0 md:p-6\">\r\n          {isMobile ? (\r\n            // Mobile Card Layout\r\n            <div className=\"p-4 space-y-4\">\r\n              {requisitionItems.map((row, index) => (\r\n                <MobileRequisitionRow\r\n                  key={row.id}\r\n                  row={row}\r\n                  index={index}\r\n                  onUpdateRow={updateRow}\r\n                  onRemoveRow={removeRow}\r\n                  onProductSelect={handleProductSelect}\r\n                  onInputFocus={handleInputFocus}\r\n                  onAddRowAfter={addRowAfter}\r\n                  onKeyDown={handleKeyDown}\r\n                  onMoveRow={moveRow}\r\n                  canRemove={requisitionItems.length > 1}\r\n                  isLastRow={index === requisitionItems.length - 1}\r\n                  totalRows={requisitionItems.length}\r\n                />\r\n              ))}\r\n\r\n              {/* Mobile Total */}\r\n              <Card className=\"bg-primary/5 border-primary/20\">\r\n                <CardContent className=\"p-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <span className=\"font-medium\">Total Quantity:</span>\r\n                      <span className=\"text-lg font-bold text-primary\">\r\n                        {formatNumber(totalQuantity)}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <span className=\"font-medium\">Total Amount:</span>\r\n                      <span className=\"text-lg font-bold text-primary\">\r\n                        {settings.currency} {formatNumber(totalAmount)}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          ) : (\r\n            // Desktop Table Layout\r\n            <div className=\"overflow-x-auto\">\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead className=\"w-[250px]\">Item</TableHead>\r\n                    <TableHead className=\"w-[80px]\">Qty</TableHead>\r\n                    <TableHead className=\"w-[100px]\">Unit Cost</TableHead>\r\n                    <TableHead className=\"w-[100px]\">Amount</TableHead>\r\n                    <TableHead className=\"w-[80px]\">Urgent</TableHead>\r\n                    <TableHead className=\"w-[140px]\">Actions</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n                <TableBody>\r\n                  {requisitionItems.map((row, index) => {\r\n                    const product = products.find(p => p.id === row.productId);\r\n                    const itemAmount = product && row.quantity ? product.costPrice * row.quantity : 0;\r\n\r\n                    return (\r\n                      <TableRow key={row.id} className={row.urgentItem ? \"bg-destructive/5\" : \"\"}>\r\n                        <TableCell>\r\n                          <div className=\"relative\">\r\n                            <Input\r\n                              placeholder=\"Type to search products...\"\r\n                              value={row.searchTerm}\r\n                              onChange={(e) => updateRow(row.id, 'searchTerm', e.target.value)}\r\n                              onFocus={() => handleInputFocus(row.id)}\r\n                              onKeyDown={(e) => handleKeyDown(e, row.id)}\r\n                              className=\"w-full\"\r\n                            />\r\n                          </div>\r\n                        </TableCell>\r\n\r\n                        <TableCell>\r\n                          <Input\r\n                            type=\"number\"\r\n                            min=\"0\"\r\n                            step=\"1\"\r\n                            value={row.quantity || ''}\r\n                            onChange={(e) => updateRow(row.id, 'quantity', parseInt(e.target.value) || 0)}\r\n                            onKeyDown={(e) => handleKeyDown(e, row.id)}\r\n                            placeholder=\"0\"\r\n                          />\r\n                        </TableCell>\r\n\r\n                        <TableCell className=\"text-sm\">\r\n                          {product ? `${settings.currency} ${formatNumber(product.costPrice)}` : '-'}\r\n                        </TableCell>\r\n\r\n                        <TableCell className=\"text-sm font-medium\">\r\n                          {itemAmount > 0 ? `${settings.currency} ${formatNumber(itemAmount)}` : '-'}\r\n                        </TableCell>\r\n\r\n                        <TableCell>\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={row.urgentItem || false}\r\n                            onChange={(e) => updateRow(row.id, 'urgentItem', e.target.checked)}\r\n                            className=\"rounded\"\r\n                          />\r\n                        </TableCell>\r\n\r\n                        <TableCell>\r\n                          <div className=\"flex gap-1\">\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"icon\"\r\n                              onClick={() => moveRow(row.id, 'up')}\r\n                              disabled={index === 0}\r\n                              className=\"h-8 w-8\"\r\n                            >\r\n                              <ChevronUp size={14} />\r\n                            </Button>\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"icon\"\r\n                              onClick={() => moveRow(row.id, 'down')}\r\n                              disabled={index === requisitionItems.length - 1}\r\n                              className=\"h-8 w-8\"\r\n                            >\r\n                              <ChevronDown size={14} />\r\n                            </Button>\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"icon\"\r\n                              onClick={() => removeRow(row.id)}\r\n                              disabled={requisitionItems.length === 1}\r\n                              className=\"h-8 w-8\"\r\n                            >\r\n                              <Trash2 size={14} />\r\n                            </Button>\r\n                          </div>\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    );\r\n                  })}\r\n\r\n                  {/* Add Row Below button */}\r\n                  <TableRow className=\"border-none\">\r\n                    <TableCell colSpan={6} className=\"py-1 text-center\">\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => addRowAfter(requisitionItems[requisitionItems.length - 1].id)}\r\n                        className=\"gap-2 text-muted-foreground hover:text-foreground text-xs\"\r\n                      >\r\n                        <Plus size={12} />\r\n                        Add row below\r\n                      </Button>\r\n                    </TableCell>\r\n                  </TableRow>\r\n\r\n                  {/* Total Row */}\r\n                  <TableRow className=\"border-t-2\">\r\n                    <TableCell className=\"text-right font-medium\">\r\n                      Totals:\r\n                    </TableCell>\r\n                    <TableCell className=\"font-bold text-lg\">\r\n                      {formatNumber(totalQuantity)}\r\n                    </TableCell>\r\n                    <TableCell></TableCell>\r\n                    <TableCell className=\"font-bold text-lg\">\r\n                      {settings.currency} {formatNumber(totalAmount)}\r\n                    </TableCell>\r\n                    <TableCell colSpan={2}></TableCell>\r\n                  </TableRow>\r\n                </TableBody>\r\n              </Table>\r\n            </div>\r\n          )}\r\n\r\n          {requisitionItems.length === 0 && (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              No items added. Click \"Add Item\" to start creating your requisition.\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Product Suggestions Panel */}\r\n      <ProductSuggestionsPanel\r\n        suggestions={suggestions}\r\n        isOpen={panelOpen}\r\n        onClose={closePanel}\r\n        onSelectProduct={handleProductSelect}\r\n        searchTerm={focusedRow?.searchTerm || ''}\r\n      />\r\n\r\n      {/* Saved Requisitions */}\r\n      <SavedRequisitions\r\n        requisitions={requisitions}\r\n        isLoading={requisitionsLoading}\r\n        onRefresh={loadRequisitions}\r\n        onDelete={deleteRequisition}\r\n        businessName={settings.businessName}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RequisitionTab;","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ListFilter\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMyA2aDE4IiAvPgogIDxwYXRoIGQ9Ik03IDEyaDEwIiAvPgogIDxwYXRoIGQ9Ik0xMCAxOGg0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/list-filter\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ListFilter = createLucideIcon('ListFilter', [\n  ['path', { d: 'M3 6h18', key: 'd0wm0j' }],\n  ['path', { d: 'M7 12h10', key: 'b7w52i' }],\n  ['path', { d: 'M10 18h4', key: '1ulq68' }],\n]);\n\nexport default ListFilter;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Truck\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTQgMThWNmEyIDIgMCAwIDAtMi0ySDRhMiAyIDAgMCAwLTIgMnYxMWExIDEgMCAwIDAgMSAxaDIiIC8+CiAgPHBhdGggZD0iTTE1IDE4SDkiIC8+CiAgPHBhdGggZD0iTTE5IDE4aDJhMSAxIDAgMCAwIDEtMXYtMy42NWExIDEgMCAwIDAtLjIyLS42MjRsLTMuNDgtNC4zNUExIDEgMCAwIDAgMTcuNTIgOEgxNCIgLz4KICA8Y2lyY2xlIGN4PSIxNyIgY3k9IjE4IiByPSIyIiAvPgogIDxjaXJjbGUgY3g9IjciIGN5PSIxOCIgcj0iMiIgLz4KPC9zdmc+) - https://lucide.dev/icons/truck\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Truck = createLucideIcon('Truck', [\n  ['path', { d: 'M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2', key: 'wrbu53' }],\n  ['path', { d: 'M15 18H9', key: '1lyqi6' }],\n  [\n    'path',\n    {\n      d: 'M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14',\n      key: 'lysw3i',\n    },\n  ],\n  ['circle', { cx: '17', cy: '18', r: '2', key: '332jqn' }],\n  ['circle', { cx: '7', cy: '18', r: '2', key: '19iecd' }],\n]);\n\nexport default Truck;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name FileUp\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTUgMkg2YTIgMiAwIDAgMC0yIDJ2MTZhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMi0yVjdaIiAvPgogIDxwYXRoIGQ9Ik0xNCAydjRhMiAyIDAgMCAwIDIgMmg0IiAvPgogIDxwYXRoIGQ9Ik0xMiAxMnY2IiAvPgogIDxwYXRoIGQ9Im0xNSAxNS0zLTMtMyAzIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/file-up\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst FileUp = createLucideIcon('FileUp', [\n  ['path', { d: 'M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z', key: '1rqfz7' }],\n  ['path', { d: 'M14 2v4a2 2 0 0 0 2 2h4', key: 'tnqrlb' }],\n  ['path', { d: 'M12 12v6', key: '3ahymv' }],\n  ['path', { d: 'm15 15-3-3-3 3', key: '15xj92' }],\n]);\n\nexport default FileUp;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Scale\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTYgMTYgMy04IDMgOGMtLjg3LjY1LTEuOTIgMS0zIDFzLTIuMTMtLjM1LTMtMVoiIC8+CiAgPHBhdGggZD0ibTIgMTYgMy04IDMgOGMtLjg3LjY1LTEuOTIgMS0zIDFzLTIuMTMtLjM1LTMtMVoiIC8+CiAgPHBhdGggZD0iTTcgMjFoMTAiIC8+CiAgPHBhdGggZD0iTTEyIDN2MTgiIC8+CiAgPHBhdGggZD0iTTMgN2gyYzIgMCA1LTEgNy0yIDIgMSA1IDIgNyAyaDIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/scale\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Scale = createLucideIcon('Scale', [\n  ['path', { d: 'm16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z', key: '7g6ntu' }],\n  ['path', { d: 'm2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z', key: 'ijws7r' }],\n  ['path', { d: 'M7 21h10', key: '1b0cd5' }],\n  ['path', { d: 'M12 3v18', key: '108xh3' }],\n  ['path', { d: 'M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2', key: '3gwbw2' }],\n]);\n\nexport default Scale;\n","import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Plus, RefreshCw, ListFilter, Search, Truck, FileDown, FileUp, Scale } from 'lucide-react';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\n\r\ninterface InventoryHeaderProps {\r\n  isLoading: boolean;\r\n  onRefresh: () => Promise<void>;\r\n  onDownloadTemplate: () => void;\r\n  onCSVUpload: () => void;\r\n}\r\n\r\nconst InventoryHeader: React.FC<InventoryHeaderProps> = ({\r\n  isLoading,\r\n  onRefresh,\r\n  onDownloadTemplate,\r\n  onCSVUpload\r\n}) => {\r\n  const navigate = useNavigate();\r\n  const isMobile = useIsMobile();\r\n  const { hasPermission } = useProfiles();\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"flex flex-col gap-3 md:flex-row md:items-center md:justify-between\">\r\n        <div className=\"space-y-1\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <h1 className=\"text-xl md:text-2xl lg:text-3xl font-bold text-sales-dark\">Inventory Overview</h1>\r\n          </div>\r\n          <p className=\"text-sm md:text-base text-muted-foreground\">\r\n            Monitor your inventory health and analyze sales performance\r\n          </p>\r\n        </div>\r\n\r\n        {/* Mobile Action Buttons - Improved Layout */}\r\n        {isMobile ? (\r\n          <div className=\"space-y-3\">\r\n            <div className=\"flex gap-2\">\r\n              {hasPermission('inventory', 'create') && (\r\n                <Button onClick={() => navigate('/inventory/new')} className=\"flex-1 gap-2 min-h-[44px]\">\r\n                  <Plus size={16} /> Add Product\r\n                </Button>\r\n              )}\r\n              <Button\r\n                onClick={onRefresh}\r\n                variant=\"outline\"\r\n                size=\"icon\"\r\n                disabled={isLoading}\r\n                className=\"shrink-0 min-h-[44px] min-w-[44px]\"\r\n              >\r\n                <RefreshCw className={`h-4 w-4 ${isLoading ? 'animate-spin' : ''}`} />\r\n              </Button>\r\n            </div>\r\n            <div className=\"grid grid-cols-2 gap-2\">\r\n              <Button onClick={() => navigate('/products')} variant=\"outline\" className=\"gap-1 text-xs min-h-[40px]\">\r\n                <ListFilter size={14} /> Products\r\n              </Button>\r\n              {hasPermission('inventory', 'view') && (\r\n                <Button onClick={() => navigate('/inventory/carriage-inwards')} variant=\"outline\" className=\"gap-1 text-xs min-h-[40px]\">\r\n                  <Truck size={14} /> Carriage\r\n                </Button>\r\n              )}\r\n            </div>\r\n            {hasPermission('inventory', 'create') && (\r\n              <div className=\"grid grid-cols-2 gap-2\">\r\n                <Button onClick={onDownloadTemplate} variant=\"outline\" className=\"gap-1 text-xs min-h-[40px]\">\r\n                  <FileDown size={14} /> Template\r\n                </Button>\r\n                <Button onClick={onCSVUpload} variant=\"outline\" className=\"gap-1 text-xs min-h-[40px]\">\r\n                  <FileUp size={14} /> Upload\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          // Desktop Action Buttons\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              onClick={onRefresh}\r\n              variant=\"outline\"\r\n              size=\"icon\"\r\n              disabled={isLoading}\r\n              className=\"relative\"\r\n              title=\"Refresh data\"\r\n            >\r\n              <RefreshCw className={`h-4 w-4 ${isLoading ? 'animate-spin' : ''}`} />\r\n              <span className=\"sr-only\">Refresh data</span>\r\n            </Button>\r\n\r\n            {hasPermission('inventory', 'create') && (\r\n              <>\r\n                <Button\r\n                  onClick={onDownloadTemplate}\r\n                  variant=\"outline\"\r\n                  className=\"gap-2\"\r\n                  title=\"Download CSV template\"\r\n                >\r\n                  <FileDown size={16} /> CSV Template\r\n                </Button>\r\n                <Button\r\n                  onClick={onCSVUpload}\r\n                  variant=\"outline\"\r\n                  className=\"gap-2\"\r\n                  title=\"Upload products via CSV\"\r\n                >\r\n                  <FileUp size={16} /> Upload CSV\r\n                </Button>\r\n              </>\r\n            )}\r\n            {hasPermission('inventory', 'view') && (\r\n              <Button onClick={() => navigate('/inventory/carriage-inwards')} variant=\"outline\" className=\"gap-2\">\r\n                <Truck size={16} /> Carriage Inwards\r\n              </Button>\r\n            )}\r\n            {hasPermission('inventory', 'stock_adjustment') && (\r\n              <Button onClick={() => navigate('/inventory/reconcile')} variant=\"outline\" className=\"gap-2\" title=\"Reconcile stock discrepancies\">\r\n                <Scale size={16} /> Reconcile\r\n              </Button>\r\n            )}\r\n            <Button onClick={() => navigate('/products')} variant=\"outline\" className=\"gap-2\">\r\n              <ListFilter size={16} /> All Products\r\n            </Button>\r\n            {hasPermission('inventory', 'create') && (\r\n              <Button onClick={() => navigate('/inventory/new')} className=\"gap-2\">\r\n                <Plus size={16} /> Add Product\r\n              </Button>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InventoryHeader;","import React, { useState, useEffect } from 'react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Search } from 'lucide-react';\r\nimport { Product, ProductFilters } from '@/types';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\n\r\ninterface InventorySearchBarProps {\r\n    filters: ProductFilters;\r\n    setFilters: (filters: ProductFilters) => void;\r\n    products: Product[];\r\n    onSearchChange?: (e: React.ChangeEvent<HTMLInputElement>) => void;\r\n    onSearchSubmit?: (e: React.ChangeEvent<HTMLInputElement>) => void;\r\n    onSearchFocus?: () => void;\r\n}\r\n\r\nconst InventorySearchBar: React.FC<InventorySearchBarProps> = ({\r\n    filters,\r\n    setFilters,\r\n    products,\r\n    onSearchChange,\r\n    onSearchSubmit,\r\n    onSearchFocus\r\n}) => {\r\n    const isMobile = useIsMobile();\r\n    // Local state for the input field to allow smooth typing\r\n    const [localSearch, setLocalSearch] = useState(filters.search || '');\r\n\r\n    // Sync local state when external filters change\r\n    useEffect(() => {\r\n        const searchVal = filters.search || '';\r\n        setLocalSearch(searchVal);\r\n    }, [filters.search]);\r\n\r\n    // Handle typing - update local state and trigger suggestions (no database fetch)\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        setLocalSearch(e.target.value);\r\n        // Trigger live search for suggestions only\r\n        if (onSearchChange) {\r\n            onSearchChange(e);\r\n        }\r\n    };\r\n\r\n    // Submit on Enter key - Triggers database fetch\r\n    const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n        if (e.key === 'Enter') {\r\n            e.preventDefault();\r\n\r\n            if (onSearchSubmit) {\r\n                const fakeEvent = {\r\n                    target: { value: localSearch }\r\n                } as React.ChangeEvent<HTMLInputElement>;\r\n                onSearchSubmit(fakeEvent);\r\n            } else {\r\n                // Apply the filter to the table (DB Level)\r\n                setFilters({\r\n                    ...filters,\r\n                    search: localSearch\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    // Submit on Blur - Triggers database fetch\r\n    const handleBlur = () => {\r\n        if (localSearch !== filters.search) {\r\n            if (onSearchSubmit) {\r\n                const fakeEvent = {\r\n                    target: { value: localSearch }\r\n                } as React.ChangeEvent<HTMLInputElement>;\r\n                onSearchSubmit(fakeEvent);\r\n            } else {\r\n                setFilters({\r\n                    ...filters,\r\n                    search: localSearch\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"relative w-full\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4\" />\r\n            <Input\r\n                placeholder=\"Search products...\"\r\n                value={localSearch}\r\n                onChange={handleChange}\r\n                onKeyDown={handleKeyDown}\r\n                onBlur={handleBlur}\r\n                onFocus={onSearchFocus}\r\n                className=\"pl-9 w-full bg-white transition-all duration-200 focus:shadow-md\"\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default InventorySearchBar;\r\n","import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport { Button } from '@/components/ui/button';\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from '@/components/ui/dropdown-menu';\r\nimport { FileDown, ChevronDown } from 'lucide-react';\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\nimport { TopSellingItem } from '@/hooks/useInventoryData';\r\nimport { formatNumber, formatCashCurrency } from '@/lib/utils';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\nimport { usePagination } from '@/hooks/usePagination';\r\nimport SalesTablePagination from '@/components/sales/SalesTablePagination';\r\nimport jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\n\r\ninterface TopSellingProductsTableProps {\r\n  products: TopSellingItem[];\r\n  onExport?: () => void;\r\n  period?: string;\r\n}\r\n\r\nconst TopSellingProductsTable: React.FC<TopSellingProductsTableProps> = ({\r\n  products,\r\n  onExport,\r\n  period = 'this-month'\r\n}) => {\r\n  const { settings } = useBusinessSettings();\r\n  const { canViewCostPrice, canViewProfit, canViewSellingPrice } = useFinancialVisibility();\r\n  const navigate = useNavigate();\r\n\r\n  // Pagination\r\n  const {\r\n    currentPage,\r\n    setCurrentPage,\r\n    paginatedItems,\r\n    totalPages\r\n  } = usePagination<TopSellingItem>({\r\n    items: products,\r\n    itemsPerPage: 10\r\n  });\r\n\r\n  const handleCSVExport = () => {\r\n    const headers = [\r\n      'Rank',\r\n      'Item Description',\r\n      'Quantity Sold',\r\n      'Average Price',\r\n      'Total Amount',\r\n      'Average Cost',\r\n      'Total Cost',\r\n      'Total Profit'\r\n    ];\r\n\r\n    const rows = products.map((item, index) => [\r\n      (index + 1).toString(),\r\n      item.description,\r\n      item.totalQuantity.toString(),\r\n      canViewSellingPrice ? item.averagePrice.toFixed(2) : 'RESTRICTED',\r\n      canViewSellingPrice ? item.totalAmount.toFixed(2) : 'RESTRICTED',\r\n      canViewCostPrice ? (item.averageCost || 0).toFixed(2) : 'RESTRICTED',\r\n      canViewCostPrice ? item.totalCost.toFixed(2) : 'RESTRICTED',\r\n      canViewProfit ? item.totalProfit.toFixed(2) : 'RESTRICTED'\r\n    ]);\r\n\r\n    const csvContent = [\r\n      headers.join(','),\r\n      ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv' });\r\n    const url = window.URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    const periodLabel = period.replace('-', ' ').replace(/\\b\\w/g, l => l.toUpperCase());\r\n    link.download = `top-selling-items-${periodLabel.toLowerCase().replace(/\\s+/g, '-')}-${new Date().toISOString().split('T')[0]}.csv`;\r\n    link.click();\r\n    window.URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const handlePDFExport = () => {\r\n    const doc = new jsPDF('landscape');\r\n    const periodLabel = period.replace('-', ' ').replace(/\\b\\w/g, l => l.toUpperCase());\r\n\r\n    // Add title\r\n    doc.setFontSize(18);\r\n    doc.setFont(undefined, 'bold');\r\n    doc.text('Top Selling Items Report', 14, 22);\r\n\r\n    // Add period and date\r\n    doc.setFontSize(12);\r\n    doc.setFont(undefined, 'normal');\r\n    doc.text(`Period: ${periodLabel}`, 14, 32);\r\n    doc.text(`Generated: ${new Date().toLocaleDateString()}`, 14, 40);\r\n\r\n    // Prepare table data\r\n    const tableData = products.map((item, index) => [\r\n      (index + 1).toString(),\r\n      item.description.length > 50 ? item.description.substring(0, 47) + '...' : item.description,\r\n      item.totalQuantity.toString(),\r\n      canViewSellingPrice ? `${settings.currency} ${formatNumber(item.averagePrice)}` : 'RESTRICTED',\r\n      canViewSellingPrice ? `${settings.currency} ${formatNumber(item.totalAmount)}` : 'RESTRICTED',\r\n      canViewCostPrice ? `${settings.currency} ${formatNumber(item.averageCost || 0)}` : 'RESTRICTED',\r\n      canViewCostPrice ? `${settings.currency} ${formatNumber(item.totalCost)}` : 'RESTRICTED',\r\n      canViewProfit ? `${settings.currency} ${formatNumber(item.totalProfit)}` : 'RESTRICTED'\r\n    ]);\r\n\r\n    // Add table\r\n    autoTable(doc, {\r\n      head: [['Rank', 'Item Description', 'Qty Sold', 'Avg Price', 'Total Amount', 'Avg Cost', 'Total Cost', 'Profit']],\r\n      body: tableData,\r\n      startY: 50,\r\n      styles: { fontSize: 9 },\r\n      headStyles: { fillColor: [66, 139, 202] },\r\n      columnStyles: {\r\n        0: { halign: 'center', cellWidth: 15 },\r\n        1: { cellWidth: 80 },\r\n        2: { halign: 'center', cellWidth: 25 },\r\n        3: { halign: 'right', cellWidth: 30 },\r\n        4: { halign: 'right', cellWidth: 35 },\r\n        5: { halign: 'right', cellWidth: 30 },\r\n        6: { halign: 'right', cellWidth: 30 },\r\n        7: { halign: 'right', cellWidth: 30 }\r\n      }\r\n    });\r\n\r\n    // Save the PDF\r\n    doc.save(`top-selling-items-${periodLabel.toLowerCase().replace(/\\s+/g, '-')}-${new Date().toISOString().split('T')[0]}.pdf`);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Export Dropdown */}\r\n      <div className=\"flex justify-end\">\r\n        <DropdownMenu>\r\n          <DropdownMenuTrigger asChild>\r\n            <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\r\n              <FileDown size={16} />\r\n              Export\r\n              <ChevronDown size={16} />\r\n            </Button>\r\n          </DropdownMenuTrigger>\r\n          <DropdownMenuContent align=\"end\">\r\n            <DropdownMenuItem onClick={onExport || handleCSVExport}>\r\n              Export as CSV\r\n            </DropdownMenuItem>\r\n            <DropdownMenuItem onClick={handlePDFExport}>\r\n              Export as PDF\r\n            </DropdownMenuItem>\r\n          </DropdownMenuContent>\r\n        </DropdownMenu>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <TooltipProvider>\r\n        <div className=\"overflow-x-auto rounded-md border\">\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow className=\"bg-muted/50\">\r\n                <TableHead className=\"w-[60px] min-w-[60px]\">Rank</TableHead>\r\n                <TableHead className=\"min-w-[200px]\">Item Description</TableHead>\r\n                <TableHead className=\"w-[100px] min-w-[100px] text-right\">Qty Sold</TableHead>\r\n                {canViewSellingPrice && (\r\n                  <>\r\n                    <TableHead className=\"w-[120px] min-w-[120px] text-right\">Avg Price</TableHead>\r\n                    <TableHead className=\"w-[120px] min-w-[120px] text-right\">Total Amount</TableHead>\r\n                  </>\r\n                )}\r\n                {canViewCostPrice && (\r\n                  <>\r\n                    <TableHead className=\"w-[120px] min-w-[120px] text-right\">Avg Cost</TableHead>\r\n                    <TableHead className=\"w-[120px] min-w-[120px] text-right\">Total Cost</TableHead>\r\n                  </>\r\n                )}\r\n                {canViewProfit && (\r\n                  <TableHead className=\"w-[120px] min-w-[120px] text-right\">Profit</TableHead>\r\n                )}\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {products.length === 0 ? (\r\n                <TableRow>\r\n                  <TableCell colSpan={8} className=\"text-center py-8 text-muted-foreground\">\r\n                    No sales data for the selected period\r\n                  </TableCell>\r\n                </TableRow>\r\n              ) : (\r\n                paginatedItems.map((item, index) => {\r\n                  const actualRank = (currentPage - 1) * 10 + index + 1;\r\n                  // Get the first product ID if available\r\n                  const productId = item.productIds && item.productIds.length > 0 ? item.productIds[0] : null;\r\n\r\n                  return (\r\n                    <TableRow\r\n                      key={`${item.description}-${index}`}\r\n                      className=\"hover:bg-gray-50 cursor-pointer\"\r\n                      onClick={() => productId && navigate(`/inventory/${productId}`)}\r\n                    >\r\n                      <TableCell className=\"text-center\">\r\n                        <span className=\"text-xs bg-primary/10 text-primary rounded-full w-6 h-6 inline-flex items-center justify-center font-bold\">\r\n                          {actualRank}\r\n                        </span>\r\n                      </TableCell>\r\n                      <TableCell className=\"font-medium\">\r\n                        <Tooltip>\r\n                          <TooltipTrigger asChild>\r\n                            <span className=\"cursor-help\">{item.description}</span>\r\n                          </TooltipTrigger>\r\n                          <TooltipContent side=\"top\" className=\"max-w-xs\">\r\n                            <p className=\"font-bold break-words whitespace-normal\">{item.description}</p>\r\n                          </TooltipContent>\r\n                        </Tooltip>\r\n                      </TableCell>\r\n                      <TableCell className=\"text-right font-medium text-green-600\">\r\n                        {item.totalQuantity % 1 === 0 ? item.totalQuantity : item.totalQuantity.toFixed(2)}\r\n                      </TableCell>\r\n                      {canViewSellingPrice && (\r\n                        <>\r\n                          <TableCell className=\"text-right font-medium tabular-nums\">\r\n                            {formatCashCurrency(item.averagePrice, settings.currency)}\r\n                          </TableCell>\r\n                          <TableCell className=\"text-right font-medium tabular-nums\">\r\n                            {formatCashCurrency(item.totalAmount, settings.currency)}\r\n                          </TableCell>\r\n                        </>\r\n                      )}\r\n                      {canViewCostPrice && (\r\n                        <>\r\n                          <TableCell className=\"text-right font-medium tabular-nums\">\r\n                            {formatCashCurrency(item.averageCost || 0, settings.currency)}\r\n                          </TableCell>\r\n                          <TableCell className=\"text-right font-medium tabular-nums\">\r\n                            {formatCashCurrency(item.totalCost, settings.currency)}\r\n                          </TableCell>\r\n                        </>\r\n                      )}\r\n                      {canViewProfit && (\r\n                        <TableCell className=\"text-right font-medium tabular-nums\">\r\n                          <span className={item.totalProfit >= 0 ? 'text-green-600' : 'text-red-600'}>\r\n                            {formatCashCurrency(item.totalProfit, settings.currency)}\r\n                          </span>\r\n                        </TableCell>\r\n                      )}\r\n                    </TableRow>\r\n                  );\r\n                })\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n        </div>\r\n      </TooltipProvider>\r\n\r\n      {/* Pagination Controls */}\r\n      {products.length > 0 && (\r\n        <div className=\"mt-4\">\r\n          <SalesTablePagination\r\n            currentPage={currentPage}\r\n            totalPages={totalPages}\r\n            onPageChange={setCurrentPage}\r\n          />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TopSellingProductsTable;","import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport TopSellingProductsTable from '@/components/inventory/TopSellingProductsTable';\r\nimport { TopSellingItem } from '@/hooks/useInventoryData';\r\n\r\ninterface TopSellingProductsCardProps {\r\n  topSellingProducts: TopSellingItem[];\r\n  period: 'today' | 'yesterday' | 'this-week' | 'last-week' | 'this-month' | 'last-month' | 'all-time';\r\n  onPeriodChange: (period: 'today' | 'yesterday' | 'this-week' | 'last-week' | 'this-month' | 'last-month' | 'all-time') => void;\r\n}\r\n\r\nconst TopSellingProductsCard: React.FC<TopSellingProductsCardProps> = ({\r\n  topSellingProducts,\r\n  period,\r\n  onPeriodChange\r\n}) => {\r\n  return (\r\n    <Card className=\"shadow-sm border-t-0 bg-white\">\r\n      <CardHeader className=\"pb-3 md:pb-6\">\r\n        <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\r\n          <CardTitle className=\"text-base md:text-lg\">Top Selling Products</CardTitle>\r\n          <div className=\"flex items-center gap-2\">\r\n            <span className=\"text-sm text-muted-foreground\">Period:</span>\r\n            <Select value={period} onValueChange={(value) => onPeriodChange(value as typeof period)}>\r\n              <SelectTrigger className=\"w-[180px]\">\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"today\">Today</SelectItem>\r\n                <SelectItem value=\"yesterday\">Yesterday</SelectItem>\r\n                <SelectItem value=\"this-week\">This Week</SelectItem>\r\n                <SelectItem value=\"last-week\">Last Week</SelectItem>\r\n                <SelectItem value=\"this-month\">This Month</SelectItem>\r\n                <SelectItem value=\"last-month\">Last Month</SelectItem>\r\n                <SelectItem value=\"all-time\">All Time</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent className=\"p-0\">\r\n        <TopSellingProductsTable\r\n          products={topSellingProducts}\r\n          period={period}\r\n        />\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default TopSellingProductsCard;","\r\nimport React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n  Legend,\r\n} from 'recharts';\r\nimport { Product } from '@/types';\r\n\r\ninterface StockLevelChartProps {\r\n  products: Product[];\r\n}\r\n\r\nconst StockLevelChart: React.FC<StockLevelChartProps> = ({ products }) => {\r\n  // Calculate aggregated stock data\r\n  const totalInStock = products.filter(p => p.quantity > p.minimumStock).reduce((sum, p) => sum + p.quantity, 0);\r\n  const totalLowStock = products.filter(p => p.quantity > 0 && p.quantity <= p.minimumStock).reduce((sum, p) => sum + p.quantity, 0);\r\n  const totalMinimumLevel = products.reduce((sum, p) => sum + p.minimumStock, 0);\r\n  \r\n  // Create data array with each stock category as a separate object\r\n  const chartData = [\r\n    { name: 'In Stock', value: totalInStock, fill: '#4ade80' },\r\n    { name: 'Low Stock', value: totalLowStock, fill: '#f87171' },\r\n    { name: 'Minimum Level', value: totalMinimumLevel, fill: '#94a3b8' }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"w-full\">\r\n      <div className=\"h-[300px] w-full\">\r\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n          <BarChart\r\n            data={chartData}\r\n            margin={{ top: 20, right: 30, left: 20, bottom: 5 }}\r\n          >\r\n            <CartesianGrid strokeDasharray=\"3 3\" />\r\n            <XAxis dataKey=\"name\" />\r\n            <YAxis />\r\n            <Tooltip\r\n              formatter={(value, name, props) => {\r\n                return [value, props.payload.name];\r\n              }}\r\n            />\r\n            <Bar dataKey=\"value\" fill=\"#8884d8\" barSize={40}>\r\n              {chartData.map((entry, index) => (\r\n                <Bar key={`bar-${index}`} dataKey=\"value\" fill={entry.fill} />\r\n              ))}\r\n            </Bar>\r\n          </BarChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n      <div className=\"flex justify-center mt-4 space-x-6\">\r\n        <div className=\"flex items-center\">\r\n          <div className=\"w-3 h-3 bg-[#4ade80] rounded-full mr-2\"></div>\r\n          <span className=\"text-sm\">In Stock</span>\r\n        </div>\r\n        <div className=\"flex items-center\">\r\n          <div className=\"w-3 h-3 bg-[#f87171] rounded-full mr-2\"></div>\r\n          <span className=\"text-sm\">Low Stock</span>\r\n        </div>\r\n        <div className=\"flex items-center\">\r\n          <div className=\"w-3 h-3 bg-[#94a3b8] rounded-full mr-2\"></div>\r\n          <span className=\"text-sm\">Minimum Level</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StockLevelChart;\r\n","import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport StockLevelChart from '@/components/inventory/StockLevelChart';\r\nimport { Product } from '@/types';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\n\r\ninterface StockLevelOverviewCardProps {\r\n  products: Product[];\r\n}\r\n\r\nconst StockLevelOverviewCard: React.FC<StockLevelOverviewCardProps> = ({ products }) => {\r\n  const isMobile = useIsMobile();\r\n\r\n  // Only show on desktop or if there are products\r\n  if (isMobile && products.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Card className=\"shadow-sm overflow-hidden\">\r\n      <CardHeader className=\"pb-3 md:pb-6\">\r\n        <CardTitle className=\"text-base md:text-lg\">Stock Level Overview</CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"pt-0\">\r\n        <StockLevelChart products={products} />\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default StockLevelOverviewCard;","import { useMemo } from 'react';\r\nimport { Product } from '@/types';\r\nimport { Sale } from '@/types';\r\nimport { format, startOfDay, endOfDay, startOfWeek, endOfWeek, startOfMonth, endOfMonth } from 'date-fns';\r\nimport { calculateItemActualAmount, calculateItemActualPrice } from '@/utils/discountCalculations';\r\n\r\nexport interface TopSellingItem {\r\n  description: string;\r\n  totalQuantity: number;\r\n  averagePrice: number;\r\n  totalAmount: number;\r\n  totalCost: number;\r\n  totalProfit: number;\r\n  totalDiscount: number;\r\n  averageCost?: number;\r\n  productIds: string[];\r\n}\r\n\r\nexport const useInventoryData = (\r\n  filteredProducts: Product[],\r\n  sales: Sale[],\r\n  period: 'today' | 'yesterday' | 'this-week' | 'last-week' | 'this-month' | 'last-month' | 'all-time'\r\n) => {\r\n  // Calculate date range based on selected period\r\n  const dateRange = useMemo(() => {\r\n    const now = new Date();\r\n    switch (period) {\r\n      case 'today':\r\n        return { from: startOfDay(now), to: endOfDay(now) };\r\n      case 'yesterday':\r\n        const yesterday = new Date(now);\r\n        yesterday.setDate(yesterday.getDate() - 1);\r\n        return { from: startOfDay(yesterday), to: endOfDay(yesterday) };\r\n      case 'this-week':\r\n        return { from: startOfWeek(now), to: endOfWeek(now) };\r\n      case 'last-week':\r\n        const lastWeek = new Date(now);\r\n        lastWeek.setDate(lastWeek.getDate() - 7);\r\n        return { from: startOfWeek(lastWeek), to: endOfWeek(lastWeek) };\r\n      case 'this-month':\r\n        return { from: startOfMonth(now), to: endOfMonth(now) };\r\n      case 'last-month':\r\n        const lastMonth = new Date(now);\r\n        lastMonth.setMonth(lastMonth.getMonth() - 1);\r\n        return { from: startOfMonth(lastMonth), to: endOfMonth(lastMonth) };\r\n      case 'all-time':\r\n      default:\r\n        return { from: new Date(0), to: now };\r\n    }\r\n  }, [period]);\r\n\r\n  // Memoize top selling products (aggregated by item description from sales)\r\n  const topSellingProducts = useMemo(() => {\r\n    try {\r\n      // Early return if no data\r\n      if (!sales || sales.length === 0) {\r\n        return [];\r\n      }\r\n\r\n      // Filter sales by date range and payment status with safer date handling\r\n      const filteredSales = sales.filter(sale => {\r\n        try {\r\n          if (!sale || sale.paymentStatus === 'Quote') return false;\r\n          const saleDate = new Date(sale.date);\r\n          // Check for invalid date\r\n          if (isNaN(saleDate.getTime())) return false;\r\n          return saleDate >= dateRange.from && saleDate <= dateRange.to;\r\n        } catch (error) {\r\n          console.warn('Error filtering sale:', error);\r\n          return false;\r\n        }\r\n      });\r\n\r\n      // Aggregate items by description (same logic as useSoldItemsData)\r\n      const itemsMap = new Map<string, {\r\n        totalQuantity: number;\r\n        totalAmount: number;\r\n        totalCost: number;\r\n        totalProfit: number;\r\n        totalDiscount: number;\r\n        prices: number[];\r\n        costs: number[];\r\n        productIds: string[]\r\n      }>();\r\n\r\n      filteredSales.forEach(sale => {\r\n        try {\r\n          if (!sale.items || !Array.isArray(sale.items)) return;\r\n\r\n          sale.items.forEach(item => {\r\n            const key = item.description;\r\n            const subtotal = item.price * item.quantity;\r\n            const amount = calculateItemActualAmount(item);\r\n            const discount = subtotal - amount;\r\n            const cost = (item.cost || 0) * item.quantity;\r\n            const profit = amount - cost;\r\n            const actualPrice = calculateItemActualPrice(item);\r\n\r\n            if (itemsMap.has(key)) {\r\n              const existing = itemsMap.get(key)!;\r\n              existing.totalQuantity += item.quantity;\r\n              existing.totalAmount += amount;\r\n              existing.totalCost += cost;\r\n              existing.totalProfit += profit;\r\n              existing.totalDiscount += discount;\r\n              existing.prices.push(actualPrice);\r\n              existing.costs.push(item.cost || 0);\r\n              if (item.productId && !existing.productIds.includes(item.productId)) {\r\n                existing.productIds.push(item.productId);\r\n              }\r\n            } else {\r\n              itemsMap.set(key, {\r\n                totalQuantity: item.quantity,\r\n                totalAmount: amount,\r\n                totalCost: cost,\r\n                totalProfit: profit,\r\n                totalDiscount: discount,\r\n                prices: [actualPrice],\r\n                costs: [item.cost || 0],\r\n                productIds: item.productId ? [item.productId] : []\r\n              });\r\n            }\r\n          });\r\n        } catch (error) {\r\n          console.warn('Error processing sale items:', error);\r\n        }\r\n      });\r\n\r\n      // Convert to array and sort by total quantity sold\r\n      const result: TopSellingItem[] = Array.from(itemsMap.entries()).map(([description, data]) => ({\r\n        description,\r\n        totalQuantity: data.totalQuantity,\r\n        averagePrice: data.prices.reduce((sum, price) => sum + price, 0) / data.prices.length,\r\n        totalAmount: data.totalAmount,\r\n        totalCost: data.totalCost,\r\n        totalProfit: data.totalProfit,\r\n        totalDiscount: data.totalDiscount,\r\n        averageCost: data.costs.reduce((sum, cost) => sum + cost, 0) / data.costs.length,\r\n        productIds: data.productIds\r\n      }));\r\n\r\n      // Sort by total quantity and return all\r\n      return result\r\n        .sort((a, b) => b.totalQuantity - a.totalQuantity);\r\n    } catch (error) {\r\n      console.error('Error calculating top selling products:', error);\r\n      return [];\r\n    }\r\n  }, [sales, dateRange]);\r\n\r\n  return {\r\n    topSellingProducts,\r\n    dateRange\r\n  };\r\n};","import React, { useCallback } from 'react';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport InventoryStats from '@/components/inventory/InventoryStats';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport ProductSuggestionsPanel from '@/components/inventory/ProductSuggestionsPanel';\r\nimport { useProductSuggestions } from '@/hooks/useProductSuggestions';\r\nimport { Product } from '@/types';\r\nimport SoldItemsTab from '@/components/inventory/SoldItemsTab';\r\nimport StockSummaryTab from '@/components/inventory/StockSummaryTab';\r\nimport CSVUploadDialog from '@/components/inventory/CSVUploadDialog';\r\nimport { useBulkProducts } from '@/hooks/useBulkProducts';\r\nimport { generateProductCSVTemplate } from '@/utils/csvTemplate';\r\nimport { useCategories } from '@/hooks/useCategories';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\nimport BulkStockAddTab from '@/components/inventory/BulkStockAddTab';\r\nimport StockCountTab from '@/components/inventory/StockCountTab';\r\nimport RequisitionTab from '@/components/inventory/RequisitionTab';\r\nimport { useSalesData } from '@/hooks/useSalesData';\r\nimport InventoryPageSkeleton from '@/components/inventory/InventoryPageSkeleton';\r\nimport InventoryHeader from '@/components/inventory/InventoryHeader';\r\nimport InventorySearchBar from '@/components/inventory/InventorySearchBar';\r\nimport TopSellingProductsCard from '@/components/inventory/TopSellingProductsCard';\r\nimport StockLevelOverviewCard from '@/components/inventory/StockLevelOverviewCard';\r\nimport { useInventoryData } from '@/hooks/useInventoryData';\r\nimport { useQueryClient } from '@tanstack/react-query';\r\n\r\n\r\n\r\n\r\nconst Inventory = () => {\r\n  const { user } = useAuth();\r\n  const { currentBusiness, isLoading: businessLoading } = useBusiness();\r\n  const { toast } = useToast();\r\n  const isMobile = useIsMobile();\r\n  const { hasPermission } = useProfiles();\r\n  const navigate = useNavigate();\r\n\r\n  const {\r\n    products,\r\n    isLoading,\r\n    isFetching,\r\n    loadProducts,\r\n    filters,\r\n    setFilters,\r\n    filteredProducts,\r\n    totalCount,\r\n    refetch\r\n  } = useProducts(user?.id);\r\n\r\n  const { categories } = useCategories(user?.id);\r\n  const { bulkCreateProducts } = useBulkProducts();\r\n  const { sales } = useSalesData(user?.id);\r\n\r\n  // Add state for CSV upload dialog\r\n  const [csvUploadOpen, setCsvUploadOpen] = React.useState(false);\r\n\r\n  // Add state for period filtering\r\n  const [period, setPeriod] = React.useState<'today' | 'yesterday' | 'this-week' | 'last-week' | 'this-month' | 'last-month' | 'all-time'>('this-month');\r\n\r\n  // Add live search state for instant suggestions without triggering DB fetches\r\n  const [liveSearch, setLiveSearch] = React.useState(filters.search || '');\r\n\r\n  // Global stats hook\r\n  const { data: globalStats, refetch: refetchGlobalStats } = useGlobalInventoryStats(currentBusiness?.id);\r\n  const queryClient = useQueryClient();\r\n\r\n  // Sync live search when filters change (e.g. on mount or from storage)\r\n  React.useEffect(() => {\r\n    setLiveSearch(filters.search || '');\r\n  }, [filters.search]);\r\n\r\n\r\n  // Realtime product sync removed (Supabase-specific). Stats refresh handled by\r\n  // manual refetch on handleRefresh and React Query stale-time settings.\r\n\r\n  // Use inventory data hook\r\n  const { topSellingProducts } = useInventoryData(filteredProducts, sales, period);\r\n\r\n  // Product suggestions hook - uses liveSearch for zero lag\r\n  const {\r\n    suggestions,\r\n    isOpen: panelOpen,\r\n    openPanel,\r\n    closePanel\r\n  } = useProductSuggestions(products, liveSearch);\r\n\r\n  // Memoize handlers to prevent unnecessary re-renders\r\n  const handleRefresh = useCallback(async () => {\r\n    // Clear the specific new cache keys if we want to force EVERYTHING (optional with React Query but good for \"Refresh\" button)\r\n    queryClient.invalidateQueries({ queryKey: ['inventory_global_stats'] });\r\n    queryClient.invalidateQueries({ queryKey: ['products'] });\r\n\r\n    // Force immediate reload of global stats\r\n    await refetchGlobalStats();\r\n\r\n    // Reload products from server\r\n    await refetch();\r\n\r\n    toast({\r\n      title: \"Inventory refreshed\",\r\n      description: \"Your inventory data and stats have been updated with fresh server data.\",\r\n    });\r\n  }, [refetch, toast, refetchGlobalStats, queryClient]);\r\n\r\n\r\n  // Memoize search input changes handler - updates only liveSearch for performance\r\n  const handleSearchChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const searchValue = e.target.value;\r\n    setLiveSearch(searchValue);\r\n\r\n    // Open suggestions panel as user types\r\n    if (searchValue.length >= 1) {\r\n      openPanel();\r\n    } else {\r\n      closePanel();\r\n    }\r\n  }, [openPanel, closePanel]);\r\n\r\n  // Handle Enter key or final search submit\r\n  const handleSearchSubmit = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const searchValue = e.target.value;\r\n    setFilters({\r\n      ...filters,\r\n      search: searchValue\r\n    });\r\n\r\n    // Ensure panel is open if there's content\r\n    if (searchValue.length > 0) {\r\n      openPanel();\r\n    }\r\n  }, [filters, setFilters, openPanel]);\r\n\r\n  // Handle product selection from suggestions - navigate to product details\r\n  const handleProductSelect = (product: Product) => {\r\n    // Update live search too so the input stays in sync if it re-renders\r\n    setLiveSearch(product.name);\r\n    navigate(`/inventory/${product.id}`);\r\n    closePanel();\r\n  };\r\n\r\n  // Handle input focus for desktop search\r\n  const handleSearchFocus = useCallback(() => {\r\n    if (liveSearch) {\r\n      openPanel();\r\n    }\r\n  }, [liveSearch, openPanel]);\r\n\r\n  // Add CSV template download handler\r\n  const handleDownloadTemplate = React.useCallback(() => {\r\n    generateProductCSVTemplate();\r\n    toast({\r\n      title: \"Template downloaded\",\r\n      description: \"CSV template has been downloaded to your device.\",\r\n    });\r\n  }, [toast]);\r\n\r\n  // Add CSV upload handler\r\n  const handleCSVUpload = React.useCallback(async (products: any[]) => {\r\n    try {\r\n      await bulkCreateProducts(products);\r\n      setCsvUploadOpen(false);\r\n      await loadProducts();\r\n    } catch (error) {\r\n      console.error('CSV upload failed:', error);\r\n      toast({\r\n        title: \"Upload failed\",\r\n        description: \"There was an error uploading your products. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  }, [bulkCreateProducts, loadProducts, toast]);\r\n\r\n  if (businessLoading || !currentBusiness || isLoading) {\r\n    return <InventoryPageSkeleton />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-2 md:p-6 space-y-4 md:space-y-6 max-w-full\">\r\n      {/* Header Section */}\r\n      <InventoryHeader\r\n        isLoading={isLoading}\r\n        onRefresh={handleRefresh}\r\n        onDownloadTemplate={handleDownloadTemplate}\r\n        onCSVUpload={() => setCsvUploadOpen(true)}\r\n      />\r\n\r\n      {/* CSV Upload Dialog */}\r\n      <CSVUploadDialog\r\n        open={csvUploadOpen}\r\n        onOpenChange={setCsvUploadOpen}\r\n        onUpload={handleCSVUpload}\r\n        categories={categories.map(cat => cat.name)}\r\n      />\r\n\r\n      {/* Stats Cards */}\r\n      <InventoryStats\r\n        products={products}\r\n        totalCountOverride={totalCount}\r\n        totalCostValueOverride={globalStats?.totalCostValue}\r\n        lowStockOverride={globalStats?.lowStockCount}\r\n        outOfStockOverride={globalStats?.outOfStockCount}\r\n        totalStockValueOverride={globalStats?.totalStockValue}\r\n      />\r\n\r\n      {/* Main Content with Tabs */}\r\n      <Tabs defaultValue=\"overview\" className=\"space-y-3 md:space-y-6\">\r\n        <TabsList className={`grid w-full ${isMobile ? 'grid-cols-4 gap-1' : 'grid-cols-6'} h-auto p-1`}>\r\n          <TabsTrigger value=\"overview\" className=\"text-xs md:text-sm px-1 md:px-2 py-2 min-h-[44px]\">\r\n            {isMobile ? 'Overview' : 'Overview'}\r\n          </TabsTrigger>\r\n          <TabsTrigger value=\"requisition\" className=\"text-xs md:text-sm px-1 md:px-2 py-2 min-h-[44px]\">\r\n            {isMobile ? 'Request' : 'Requisition'}\r\n          </TabsTrigger>\r\n          {hasPermission('inventory', 'stock_adjustment') && (\r\n            <>\r\n              <TabsTrigger value=\"add-stock\" className=\"text-xs md:text-sm px-1 md:px-2 py-2 min-h-[44px]\">\r\n                {isMobile ? 'Restock' : 'Restock'}\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"stock-count\" className=\"text-xs md:text-sm px-1 md:px-2 py-2 min-h-[44px]\">\r\n                {isMobile ? 'Count' : 'Stock Count'}\r\n              </TabsTrigger>\r\n            </>\r\n          )}\r\n          {!isMobile && (\r\n            <>\r\n              <TabsTrigger value=\"sold-items\" className=\"text-xs md:text-sm px-1 md:px-2 py-2 min-h-[44px]\">\r\n                Items Sold\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"stock-summary\" className=\"text-xs md:text-sm px-1 md:px-2 py-2 min-h-[44px]\">\r\n                Stock Summary\r\n              </TabsTrigger>\r\n            </>\r\n          )}\r\n        </TabsList>\r\n\r\n        {/* Mobile: Additional tabs in dropdown or secondary row */}\r\n        {isMobile && (\r\n          <div className=\"flex gap-1 overflow-x-auto pb-2\">\r\n            <TabsList className=\"grid grid-cols-2 gap-1 w-auto min-w-fit p-1\">\r\n              <TabsTrigger value=\"sold-items\" className=\"text-xs px-2 py-2 min-h-[44px] whitespace-nowrap\">\r\n                Items Sold\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"stock-summary\" className=\"text-xs px-2 py-2 min-h-[44px] whitespace-nowrap\">\r\n                Stock Summary\r\n              </TabsTrigger>\r\n            </TabsList>\r\n          </div>\r\n        )}\r\n\r\n        <TabsContent value=\"overview\" className=\"space-y-4 md:space-y-6\">\r\n          {/* Search Bar with Local Suggestions */}\r\n          <div className=\"relative\">\r\n            <InventorySearchBar\r\n              filters={filters}\r\n              setFilters={setFilters}\r\n              products={products}\r\n              onSearchChange={handleSearchChange}\r\n              onSearchSubmit={handleSearchSubmit}\r\n              onSearchFocus={handleSearchFocus}\r\n            />\r\n\r\n            {/* Mobile Suggestions Dropdown - Uses liveSearch for zero lag */}\r\n            {isMobile && (\r\n              <div className=\"absolute top-full left-0 right-0 z-50 mt-1\">\r\n                <ProductSuggestionsPanel\r\n                  suggestions={suggestions}\r\n                  isOpen={panelOpen}\r\n                  onClose={closePanel}\r\n                  onSelectProduct={handleProductSelect}\r\n                  searchTerm={liveSearch}\r\n                  isLoading={isFetching}\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Stock Level Overview Chart */}\r\n          <StockLevelOverviewCard products={products} />\r\n\r\n          {/* Top Selling Products */}\r\n          <TopSellingProductsCard\r\n            topSellingProducts={topSellingProducts}\r\n            period={period}\r\n            onPeriodChange={setPeriod}\r\n          />\r\n        </TabsContent>\r\n\r\n        {hasPermission('inventory', 'stock_adjustment') && (\r\n          <>\r\n            <TabsContent value=\"add-stock\">\r\n              <BulkStockAddTab />\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"stock-count\">\r\n              <StockCountTab />\r\n            </TabsContent>\r\n          </>\r\n        )}\r\n\r\n        <TabsContent value=\"requisition\">\r\n          <RequisitionTab />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"sold-items\">\r\n          <SoldItemsTab />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"stock-summary\">\r\n          <StockSummaryTab />\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Desktop Product Suggestions Panel - Uses liveSearch for zero lag */}\r\n      {!isMobile && (\r\n        <ProductSuggestionsPanel\r\n          suggestions={suggestions}\r\n          isOpen={panelOpen}\r\n          onClose={closePanel}\r\n          onSelectProduct={handleProductSelect}\r\n          searchTerm={liveSearch}\r\n          isLoading={isFetching}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Inventory;\r\n","import { PagesRouteModule } from '../../server/route-modules/pages/module.compiled'\nimport { RouteKind } from '../../server/route-kind'\n\nimport { hoist } from './helpers'\n\n// Import the app and document modules.\nimport * as document from 'VAR_MODULE_DOCUMENT'\nimport * as app from 'VAR_MODULE_APP'\n\n// Import the userland code.\nimport * as userland from 'VAR_USERLAND'\nimport { getHandler } from '../../server/route-modules/pages/pages-handler'\n\n// Re-export the component (should be the default export).\nexport default hoist(userland, 'default')\n\n// Re-export methods.\nexport const getStaticProps = hoist(userland, 'getStaticProps')\nexport const getStaticPaths = hoist(userland, 'getStaticPaths')\nexport const getServerSideProps = hoist(userland, 'getServerSideProps')\nexport const config = hoist(userland, 'config')\nexport const reportWebVitals = hoist(userland, 'reportWebVitals')\n\n// Re-export legacy methods.\nexport const unstable_getStaticProps = hoist(\n  userland,\n  'unstable_getStaticProps'\n)\nexport const unstable_getStaticPaths = hoist(\n  userland,\n  'unstable_getStaticPaths'\n)\nexport const unstable_getStaticParams = hoist(\n  userland,\n  'unstable_getStaticParams'\n)\nexport const unstable_getServerProps = hoist(\n  userland,\n  'unstable_getServerProps'\n)\nexport const unstable_getServerSideProps = hoist(\n  userland,\n  'unstable_getServerSideProps'\n)\n\n// Create and export the route module that will be consumed.\nexport const routeModule = new PagesRouteModule({\n  definition: {\n    kind: RouteKind.PAGES,\n    page: 'VAR_DEFINITION_PAGE',\n    pathname: 'VAR_DEFINITION_PATHNAME',\n    // The following aren't used in production.\n    bundlePath: '',\n    filename: '',\n  },\n  distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n  relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n  components: {\n    // default export might not exist when optimized for data only\n    App: app.default,\n    Document: document.default,\n  },\n  userland,\n})\n\nexport const handler = getHandler({\n  srcPage: 'VAR_DEFINITION_PAGE',\n  config,\n  userland,\n  routeModule,\n  getStaticPaths,\n  getStaticProps,\n  getServerSideProps,\n})\n"],"names":["PagesRouteModule","RouteKind","hoist","document","app","userland","getHandler","getStaticProps","getStaticPaths","getServerSideProps","config","reportWebVitals","unstable_getStaticProps","unstable_getStaticPaths","unstable_getStaticParams","unstable_getServerProps","unstable_getServerSideProps","routeModule","definition","kind","PAGES","page","pathname","bundlePath","filename","distDir","process","env","__NEXT_RELATIVE_DIST_DIR","relativeProjectDir","__NEXT_RELATIVE_PROJECT_DIR","components","App","default","Document","handler","srcPage"],"mappings":"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","ignoreList":[11,21,22,28,29,30,31,40]}