module.exports=[3048,(a,b,c)=>{let d=Error("Could not parse module '[project]/src/app/actions/products.ts'\n\n'import', and 'export' cannot be used outside of module code");throw d.code="MODULE_UNPARSABLE",d},347778,282141,a=>{"use strict";var b=a.i(572131),c=a.i(866102),d=a.i(169819),e=a.i(433217),f=a.i(937927);let g=a=>{};a.s(["clearInventoryCaches",0,g],282141);var h=a.i(3048);a.s(["useProducts",0,(a,i=50)=>{let[j,k]=(0,b.useState)([]),[l,m]=(0,b.useState)(1),[n,o]=(0,b.useState)(i),[p,q]=(0,b.useState)(0),[r,s]=(0,b.useState)(!1),{settings:t}=(0,c.useBusinessSettings)(),{currentBusiness:u}=(0,d.useBusiness)(),v=(0,f.useQueryClient)(),[w,x]=(0,b.useState)({search:"",category:"all",stockStatus:"all"}),[y,z]=(0,b.useState)(null),A=(0,b.useCallback)(a=>{a.search!==w.search&&(s(!0),y&&clearTimeout(y),z(setTimeout(()=>{s(!1)},600))),x(a)},[w.search,y]),B=(0,b.useCallback)(async()=>{if(!a||!u)return{products:[],count:0};try{return await (0,h.getProductsAction)({userId:a,businessId:u.id,page:l,pageSize:n,search:w.search,category:"all"===w.category?void 0:w.category,stockStatus:w.stockStatus})}catch(a){return console.error("Error loading products from server action:",a),{products:[],count:0}}},[a,u?.id,l,n,w.search,w.category,w.stockStatus]),C=(0,b.useMemo)(()=>["products",a,u?.id],[a,u?.id]),D=(0,b.useMemo)(()=>[...C,l,n,w.search,w.category,w.stockStatus],[C,l,n,w.search,w.category,w.stockStatus]),{data:E,isLoading:F,isFetching:G,refetch:H}=(0,e.useQuery)({queryKey:D,queryFn:B,enabled:!!a&&!!u?.id,staleTime:3e4,gcTime:18e5,refetchOnWindowFocus:!0,refetchOnReconnect:!0});(0,b.useEffect)(()=>{E&&(k(E.products),q(E.count))},[E]);let I=async b=>{try{if(!a)return null;return console.warn("Image upload redirecting to server action (TODO)"),null}catch(a){return console.error("Error in uploadProductImage:",a),null}};return{products:j,isLoading:F&&!E&&!r,loadProducts:B,page:l,setPage:m,pageSize:n,setPageSize:o,totalCount:p,createProduct:async b=>{try{if(!a||!u)return null;let c=await (0,h.createProductAction)({...b,userId:a,businessId:u.id});if(!c)return null;return k(a=>[c,...a]),q(a=>a+1),v.invalidateQueries({queryKey:C}),g(v),c}catch(a){return console.error("Error creating product:",a),null}},updateProduct:async(b,c,d,e=!1,f,i,j,k)=>{try{if(!a||!u)return!1;let i=c.imageUrl;if(d&&(i=await I(d)),!await (0,h.updateProductAction)(b,{...c,imageUrl:i,userId:a,businessId:u.id,isFromSale:e,customChangeReason:f,referenceId:j}))return!1;return v.invalidateQueries({queryKey:C}),g(v),!0}catch(a){return console.error("Error updating product:",a),!1}},updateProductsBulk:async(b,c,d,e,f,i)=>{try{if(!a||!u)return!1;let c=await (0,h.updateProductsBulkAction)(b.map(a=>({id:a.id,updated:a.updated})),u.id);return c&&(v.invalidateQueries({queryKey:C}),g(v)),c}catch(a){return console.error("Error in bulk update:",a),!1}},deleteProduct:async b=>{try{if(!a)return!1;if(await (0,h.deleteProductAction)(b))return v.invalidateQueries({queryKey:C}),g(v),!0;return!1}catch(a){return console.error("Error deleting product:",a),!1}},uploadProductImage:I,refetch:H,isFetching:G,filters:w,setFilters:A}}],347778)},349774,a=>{"use strict";var b=a.i(391956);a.s(["useCurrentUser",0,()=>{let{user:a}=(0,b.useAuth)();return{userId:a?.id}}])},730769,a=>{"use strict";var b=a.i(667937);a.s(["CalendarIcon",()=>b.default])},206222,a=>{"use strict";function b(a){let b=["","thousand","million","billion","trillion","quadrillion"],c=["","ten","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],d=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],e=a=>{let b=a.toFixed(2).split("."),c=f(parseInt(b[0]));return b.length>1&&parseInt(b[1])>0?`${c} and ${b[1]}/100`:c},f=a=>{if(0===a)return"zero";if(a<0)return`negative ${f(Math.abs(a))}`;let c="",d=0;for(;a>0;)a%1e3!=0&&(c=`${g(a%1e3)} ${b[d]} ${c}`),a=Math.floor(a/1e3),d++;return c.trim()},g=a=>{if(0===a)return"";let b="";return a>=100&&(b=`${d[Math.floor(a/100)]} hundred `,0==(a%=100))?b.trim():(a<20?b+=d[a]:(b+=`${c[Math.floor(a/10)]}`,a%10>0&&(b+=`-${d[a%10]}`)),b.trim())};return e(a).trim().charAt(0).toUpperCase()+e(a).trim().slice(1)}a.s(["numberToWords",()=>b])},653774,a=>{"use strict";var b,c,d,e;let f,g,h,i,j,k;(c=b||(b={})).Unimplemented="UNIMPLEMENTED",c.Unavailable="UNAVAILABLE";class l extends Error{constructor(a,b,c){super(a),this.message=a,this.code=b,this.data=c}}let m=(f=(e=d="u">typeof globalThis?globalThis:"u">typeof self?self:a.g).CapacitorCustomPlatform||null,h=(g=e.Capacitor||{}).Plugins=g.Plugins||{},i=()=>{var a,b;return null!==f?f.name:(null==e?void 0:e.androidBridge)?"android":(null==(b=null==(a=null==e?void 0:e.webkit)?void 0:a.messageHandlers)?void 0:b.bridge)?"ios":"web"},j=a=>{var b;return null==(b=g.PluginHeaders)?void 0:b.find(b=>b.name===a)},k=new Map,g.convertFileSrc||(g.convertFileSrc=a=>a),g.getPlatform=i,g.handleError=a=>e.console.error(a),g.isNativePlatform=()=>"web"!==i(),g.isPluginAvailable=a=>{let b=k.get(a);return!!((null==b?void 0:b.platforms.has(i()))||j(a))},g.registerPlugin=(a,c={})=>{let d,e=k.get(a);if(e)return console.warn(`Capacitor plugin "${a}" already registered. Cannot register plugins twice.`),e.proxy;let m=i(),n=j(a),o=async()=>(!d&&m in c?d=d="function"==typeof c[m]?await c[m]():c[m]:null!==f&&!d&&"web"in c&&(d=d="function"==typeof c.web?await c.web():c.web),d),p=c=>{let d,e=(...e)=>{let f=o().then(f=>{let h=((c,d)=>{var e,f;if(n){let b=null==n?void 0:n.methods.find(a=>d===a.name);if(b)if("promise"===b.rtype)return b=>g.nativePromise(a,d.toString(),b);else return(b,c)=>g.nativeCallback(a,d.toString(),b,c);if(c)return null==(e=c[d])?void 0:e.bind(c)}else if(c)return null==(f=c[d])?void 0:f.bind(c);else throw new l(`"${a}" plugin is not implemented on ${m}`,b.Unimplemented)})(f,c);if(h){let a=h(...e);return d=null==a?void 0:a.remove,a}throw new l(`"${a}.${c}()" is not implemented on ${m}`,b.Unimplemented)});return"addListener"===c&&(f.remove=async()=>d()),f};return e.toString=()=>`${c.toString()}() { [capacitor code] }`,Object.defineProperty(e,"name",{value:c,writable:!1,configurable:!1}),e},q=p("addListener"),r=p("removeListener"),s=(a,b)=>{let c=q({eventName:a},b),d=async()=>{r({eventName:a,callbackId:await c},b)},e=new Promise(a=>c.then(()=>a({remove:d})));return e.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await d()},e},t=new Proxy({},{get(a,b){switch(b){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return n?s:q;case"removeListener":return r;default:return p(b)}}});return h[a]=t,k.set(a,{name:a,proxy:t,platforms:new Set([...Object.keys(c),...n?[m]:[]])}),t},g.Exception=l,g.DEBUG=!!g.DEBUG,g.isLoggingEnabled=!!g.isLoggingEnabled,d.Capacitor=g),n=m.registerPlugin;class o{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(a,b){let c=!1;this.listeners[a]||(this.listeners[a]=[],c=!0),this.listeners[a].push(b);let d=this.windowListeners[a];return d&&!d.registered&&this.addWindowListener(d),c&&this.sendRetainedArgumentsForEvent(a),Promise.resolve({remove:async()=>this.removeListener(a,b)})}async removeAllListeners(){for(let a in this.listeners={},this.windowListeners)this.removeWindowListener(this.windowListeners[a]);this.windowListeners={}}notifyListeners(a,b,c){let d=this.listeners[a];if(!d){if(c){let c=this.retainedEventArguments[a];c||(c=[]),c.push(b),this.retainedEventArguments[a]=c}return}d.forEach(a=>a(b))}hasListeners(a){var b;return!!(null==(b=this.listeners[a])?void 0:b.length)}registerWindowListener(a,b){this.windowListeners[b]={registered:!1,windowEventName:a,pluginEventName:b,handler:a=>{this.notifyListeners(b,a)}}}unimplemented(a="not implemented"){return new m.Exception(a,b.Unimplemented)}unavailable(a="not available"){return new m.Exception(a,b.Unavailable)}async removeListener(a,b){let c=this.listeners[a];if(!c)return;let d=c.indexOf(b);this.listeners[a].splice(d,1),this.listeners[a].length||this.removeWindowListener(this.windowListeners[a])}addWindowListener(a){window.addEventListener(a.windowEventName,a.handler),a.registered=!0}removeWindowListener(a){a&&(window.removeEventListener(a.windowEventName,a.handler),a.registered=!1)}sendRetainedArgumentsForEvent(a){let b=this.retainedEventArguments[a];b&&(delete this.retainedEventArguments[a],b.forEach(b=>{this.notifyListeners(a,b)}))}}let p=a=>encodeURIComponent(a).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);class q extends o{async getCookies(){let a=document.cookie,b={};return a.split(";").forEach(a=>{if(a.length<=0)return;let[c,d]=a.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");c=c.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent).trim(),d=d.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent).trim(),b[c]=d}),b}async setCookie(a){try{let b=p(a.key),c=p(a.value),d=a.expires?`; expires=${a.expires.replace("expires=","")}`:"",e=(a.path||"/").replace("path=",""),f=null!=a.url&&a.url.length>0?`domain=${a.url}`:"";document.cookie=`${b}=${c||""}${d}; path=${e}; ${f};`}catch(a){return Promise.reject(a)}}async deleteCookie(a){try{document.cookie=`${a.key}=; Max-Age=0`}catch(a){return Promise.reject(a)}}async clearCookies(){try{for(let a of document.cookie.split(";")||[])document.cookie=a.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(a){return Promise.reject(a)}}async clearAllCookies(){try{await this.clearCookies()}catch(a){return Promise.reject(a)}}}n("CapacitorCookies",{web:()=>new q});let r=async a=>new Promise((b,c)=>{let d=new FileReader;d.onload=()=>{let a=d.result;b(a.indexOf(",")>=0?a.split(",")[1]:a)},d.onerror=a=>c(a),d.readAsDataURL(a)});class s extends o{async request(a){let b,c,d=((a,b={})=>{let c=Object.assign({method:a.method||"GET",headers:a.headers},b),d=((a={})=>{let b=Object.keys(a);return Object.keys(a).map(a=>a.toLocaleLowerCase()).reduce((c,d,e)=>(c[d]=a[b[e]],c),{})})(a.headers)["content-type"]||"";if("string"==typeof a.data)c.body=a.data;else if(d.includes("application/x-www-form-urlencoded")){let b=new URLSearchParams;for(let[c,d]of Object.entries(a.data||{}))b.set(c,d);c.body=b.toString()}else if(d.includes("multipart/form-data")||a.data instanceof FormData){let b=new FormData;if(a.data instanceof FormData)a.data.forEach((a,c)=>{b.append(c,a)});else for(let c of Object.keys(a.data))b.append(c,a.data[c]);c.body=b;let d=new Headers(c.headers);d.delete("content-type"),c.headers=d}else(d.includes("application/json")||"object"==typeof a.data)&&(c.body=JSON.stringify(a.data));return c})(a,a.webFetchExtra),e=((a,b=!0)=>a?Object.entries(a).reduce((a,c)=>{let d,e,[f,g]=c;return Array.isArray(g)?(e="",g.forEach(a=>{d=b?encodeURIComponent(a):a,e+=`${f}=${d}&`}),e.slice(0,-1)):(d=b?encodeURIComponent(g):g,e=`${f}=${d}`),`${a}&${e}`},"").substr(1):null)(a.params,a.shouldEncodeUrlParams),f=e?`${a.url}?${e}`:a.url,g=await fetch(f,d),h=g.headers.get("content-type")||"",{responseType:i="text"}=g.ok?a:{};switch(h.includes("application/json")&&(i="json"),i){case"arraybuffer":case"blob":c=await g.blob(),b=await r(c);break;case"json":b=await g.json();break;default:b=await g.text()}let j={};return g.headers.forEach((a,b)=>{j[b]=a}),{data:b,headers:j,status:g.status,url:g.url}}async get(a){return this.request(Object.assign(Object.assign({},a),{method:"GET"}))}async post(a){return this.request(Object.assign(Object.assign({},a),{method:"POST"}))}async put(a){return this.request(Object.assign(Object.assign({},a),{method:"PUT"}))}async patch(a){return this.request(Object.assign(Object.assign({},a),{method:"PATCH"}))}async delete(a){return this.request(Object.assign(Object.assign({},a),{method:"DELETE"}))}}n("CapacitorHttp",{web:()=>new s}),a.s(["Capacitor",()=>m,"WebPlugin",()=>o,"registerPlugin",()=>n])},918646,a=>{"use strict";var b=a.i(932596);let c=(a,b="Ush")=>{let c=Math.round(a).toLocaleString();return`${b} ${c}`},d=async(a,d)=>{let{filename:e,orientation:f="portrait",format:g="a4",margins:h={top:20,right:20,bottom:20,left:20},returnBlob:i=!1}=d,j=new b.default({orientation:f,unit:"mm",format:g,compress:!0}),k=j.internal.pageSize.getWidth(),l=j.internal.pageSize.getHeight(),m=k-h.left-h.right,n=h.top,o=()=>{j.setLineWidth(.2)},p=(a,b,c,d={})=>{let{fontSize:e=10,fontStyle:f="normal",align:g="left",maxWidth:h}=d;if(j.setFontSize(e),j.setFont("helvetica",f),!h)return j.text(a,b,c,{align:g}),.35*e;{let d=j.splitTextToSize(a,h);return j.text(d,b,c,{align:g}),d.length*(.35*e)}},q=(a,b,c,d,e={})=>{let{fontSize:f=10,fontStyle:g="normal",align:h="left",lineHeight:i=1.2}=e;j.setFontSize(f),j.setFont("helvetica",g);let k=j.splitTextToSize(a,d),l=.35*f*i;return k.forEach((a,d)=>{j.text(a,b,c+d*l,{align:h})}),k.length*l},r=(a,b,c,d)=>{o(),j.line(a,b,c,d)},s=(a,b,c,d,e="S")=>{o(),j.rect(a,b,c,d,e)},t=()=>{s(h.left,h.top,m,l-h.top-h.bottom,"S")},u=a=>n+a>l-h.bottom&&(j.addPage(),n=h.top+10,t(),!0);t();let v=h.left+8,w=m-16;if(n+=8,a.businessLogo)try{let b=new Image;b.crossOrigin="anonymous",await new Promise((c,d)=>{b.onload=()=>{try{let a=document.createElement("canvas"),c=a.getContext("2d");if(c){a.width=b.width,a.height=b.height,c.drawImage(b,0,0);let d=a.toDataURL("image/png"),e=b.width/b.height;j.addImage(d,"PNG",v,n,15*e,15)}}catch(a){console.error("Error adding logo to PDF:",a)}c()},b.onerror=()=>{console.error("Error loading logo image"),c()},b.src=a.businessLogo})}catch(a){console.error("Error processing logo:",a)}let x=.75*w,y=v+w,z=n;if(a.businessName&&(z+=p(a.businessName,y,z,{fontSize:14,fontStyle:"bold",align:"right"}),z+=1.5),a.businessAddress){let b=j.splitTextToSize(a.businessAddress,x);b.forEach((a,b)=>{j.setFontSize(10),j.setFont("helvetica","normal"),j.text(a,y,z+3.15*b,{align:"right"})}),z+=3.15*b.length+.5}a.businessPhone&&(z+=p(`Phone: ${a.businessPhone}`,y,z,{fontSize:9,align:"right"}),z+=.5),a.businessEmail&&(z+=p(`Email: ${a.businessEmail}`,y,z,{fontSize:9,align:"right"}),z+=.5),n=Math.max(n+18,z)+5,u(20),r(v,n,v+w,n),n+=6,n+=p(a.documentTitle.toUpperCase(),k/2,n,{fontSize:16,fontStyle:"bold",align:"center"});let A=n+=4,B=A;B+=p(`${a.documentNumberLabel} ${a.receiptNumber}`,v,B,{fontSize:11,fontStyle:"bold"}),B+=2,B+=p(`Date: ${a.date}`,v,B,{fontSize:10}),B+=2,B+=p(`Time: ${a.time}`,v,B,{fontSize:10});let C=v+.7*w;if(p(`Status: ${a.status}`,C,A,{fontSize:11,fontStyle:"bold",align:"left"}),n=B+4,a.customerName&&""!==a.customerName.trim()){if(u(30),n+=p("Customer Information:",v,n,{fontSize:11,fontStyle:"bold"}),n+=3,n+=p(a.customerName,v,n,{fontSize:10}),n+=2.5,a.customerAddress&&""!==a.customerAddress.trim()){let b=q(a.customerAddress,v,n,.8*w,{fontSize:10,lineHeight:1});n+=b,n+=2.5}a.customerContact&&""!==a.customerContact.trim()&&(n+=p(a.customerContact,v,n,{fontSize:10}),n+=2.5),n+=3}let D=a.items.some(a=>(a.discountPercentage||0)>0||(a.discountAmount||0)>0),E=D?["Description","Qty","Unit Price","Discount","Amount"]:["Description","Qty","Unit Price","Amount"],F=D?[.35*w,.15*w,.18*w,.12*w,.2*w]:[.45*w,.15*w,.2*w,.2*w];j.setFillColor(245,245,245),s(v,n-2,w,10,"F"),s(v,n-2,w,10,"S");let G=v;E.forEach((a,b)=>{p(a,G+3,n+4,{fontSize:10,fontStyle:"bold"}),b<E.length-1&&r(G+F[b],n-2,G+F[b],n+8),G+=F[b]}),n+=10;let H=0;a.items.forEach((b,d)=>{j.setFontSize(9);let e=Math.max(8,3.5*j.splitTextToSize(b.description,F[0]-6).length+4);u(e+5),b.unitPrice,b.quantity,b.discountAmount;let f=b.amount;if(H+=f,d%2==1&&(j.setFillColor(250,250,250),s(v,n,w,e,"F")),s(v,n,w,e,"S"),G=v,q(b.description,G+3,n+4,F[0]-6,{fontSize:9,lineHeight:1.1}),r(G+=F[0],n,G,n+e),p(b.quantity.toString(),G+F[1]-3,n+e/2+1.5,{fontSize:9,align:"right"}),r(G+=F[1],n,G,n+e),p(c(b.unitPrice,a.currency),G+F[2]-3,n+e/2+1.5,{fontSize:9,align:"right"}),r(G+=F[2],n,G,n+e),D){let d="-";(b.discountPercentage||0)>0?d=`${b.discountPercentage}%`:(b.discountAmount||0)>0&&(d=c(b.discountAmount,a.currency)),p(d,G+F[3]-3,n+e/2+1.5,{fontSize:9,align:"right"}),r(G+=F[3],n,G,n+e)}p(c(f,a.currency),G+F[D?4:3]-3,n+e/2+1.5,{fontSize:9,align:"right"}),n+=e,d<a.items.length-1&&r(v,n,v+w,n)}),n+=5,u(70);let I=v+.45*w,J=.55*w,K=.55*J,L=.45*J,M=a.items.reduce((a,b)=>{let c=b.unitPrice*b.quantity;return a+("amount"===b.discountType?b.discountAmount||0:c*(b.discountPercentage||0)/100)},0);if(M>0&&(s(I,n,J,8,"S"),j.setFillColor(248,248,248),s(I,n,J,8,"F"),p("Subtotal (before discount):",I+4,n+5.5,{fontSize:10,fontStyle:"normal"}),r(I+K,n,I+K,n+8),p(c(H+M,a.currency),I+K+L-4,n+5.5,{fontSize:10,fontStyle:"normal",align:"right"}),s(I,n+=8,J,8,"S"),j.setFillColor(255,240,220),s(I,n,J,8,"F"),p("Total Discount:",I+4,n+5.5,{fontSize:10,fontStyle:"normal"}),r(I+K,n,I+K,n+8),p(`-${c(M,a.currency)}`,I+K+L-4,n+5.5,{fontSize:10,fontStyle:"normal",align:"right"}),n+=8),s(I,n,J,8,"S"),j.setFillColor(248,248,248),s(I,n,J,8,"F"),p(M>0?"Subtotal (after discount):":"Subtotal:",I+4,n+5.5,{fontSize:10,fontStyle:"normal"}),r(I+K,n,I+K,n+8),p(c(H,a.currency),I+K+L-4,n+5.5,{fontSize:10,fontStyle:"normal",align:"right"}),n+=8,a.showTaxRow&&a.taxAmount>0&&(s(I,n,J,8,"S"),j.setFillColor(250,250,250),s(I,n,J,8,"F"),p(`Tax (${a.taxRate}%):`,I+4,n+5.5,{fontSize:10,fontStyle:"normal"}),r(I+K,n,I+K,n+8),p(c(a.taxAmount,a.currency),I+K+L-4,n+5.5,{fontSize:10,fontStyle:"normal",align:"right"}),n+=8),s(I,n,J,12,"S"),j.setFillColor(220,220,220),s(I,n,J,12,"F"),p("TOTAL:",I+4,n+7.5,{fontSize:12,fontStyle:"bold"}),r(I+K,n,I+K,n+12),p(c(a.totalAmount,a.currency),I+K+L-4,n+7.5,{fontSize:12,fontStyle:"bold",align:"right"}),n+=12,a.isInstallmentSale&&(void 0!==a.amountPaid&&(s(I,n,J,8,"S"),j.setFillColor(240,248,255),s(I,n,J,8,"F"),p("Amount Paid:",I+4,n+5.5,{fontSize:10,fontStyle:"bold"}),r(I+K,n,I+K,n+8),p(c(a.amountPaid,a.currency),I+K+L-4,n+5.5,{fontSize:10,fontStyle:"bold",align:"right"}),n+=8),void 0!==a.amountDue&&(s(I,n,J,8,"S"),j.setFillColor(255,240,240),s(I,n,J,8,"F"),p("Amount Due:",I+4,n+5.5,{fontSize:10,fontStyle:"bold"}),r(I+K,n,I+K,n+8),p(c(a.amountDue,a.currency),I+K+L-4,n+5.5,{fontSize:10,fontStyle:"bold",align:"right"}),n+=8)),n+=7,a.totalAmountInWords){u(20),p("Amount in words:",v,n+=2,{fontSize:10,fontStyle:"bold"}),n+=4;let b=q(`${a.currency} ${a.totalAmountInWords} only`,v,n,.9*w,{fontSize:10,fontStyle:"italic",lineHeight:1.4});n+=b+4}if(a.hasPaymentInfo&&a.paymentMethods&&a.paymentMethods.length>0){u(40),r(v,n,v+w,n),p("Payment Information:",v,n+=5,{fontSize:11,fontStyle:"bold"}),n+=4;let b=["Payment Method","Account Number","Account Name"],c=[.28*w,.36*w,.36*w];j.setFillColor(240,240,240),s(v,n-2,w,10,"F"),s(v,n-2,w,10,"S");let d=v;b.forEach((a,e)=>{p(a,d+4,n+4,{fontSize:9,fontStyle:"bold"}),e<b.length-1&&r(d+c[e],n-2,d+c[e],n+10-2),d+=c[e]}),n+=10,a.paymentMethods.filter(a=>a.method.trim()||a.accountNumber.trim()||a.accountName.trim()).forEach((a,b)=>{u(15),b%2==1&&(j.setFillColor(248,248,248),s(v,n,w,10,"F")),s(v,n,w,10,"S"),d=v,p(a.method,d+4,n+5,{fontSize:9,fontStyle:"bold"}),r(d+=c[0],n,d,n+10),p(a.accountNumber,d+4,n+5,{fontSize:9}),r(d+=c[1],n,d,n+10),p(a.accountName,d+4,n+5,{fontSize:9}),n+=10}),n+=4}if(a.notes&&a.notes.trim()){u(25),r(v,n,v+w,n),p("Notes:",v,n+=4,{fontSize:11,fontStyle:"bold"}),n+=6;let b=w-8;j.splitTextToSize(a.notes,b).forEach(a=>{u(8),p(a,v+4,n,{fontSize:10}),n+=5}),n+=4}if(a.signature)try{u(35);let b=new Image;b.crossOrigin="anonymous",await new Promise(c=>{b.onload=()=>{try{let a=document.createElement("canvas"),c=a.getContext("2d");if(c){let d,e;a.width=b.width,a.height=b.height,c.drawImage(b,0,0);let f=a.toDataURL("image/png"),g=b.width/b.height;g>2?(d=40,e=40/g):(e=20,d=20*g);let h=v+w-d;r(v,n,v+w,n),n+=4,j.addImage(f,"PNG",h,n,d,e),n+=e+2,p("Authorized Signature",h+d/2,n,{fontSize:8,align:"center"}),n+=4}}catch(a){console.error("Error adding signature to PDF:",a)}c()},b.onerror=()=>{console.error("Error loading signature image"),c()},b.src=a.signature})}catch(a){console.error("Error processing signature:",a)}if(u(25),p("Thank you for your business!",k/2,n+=6,{fontSize:11,fontStyle:"bold",align:"center"}),p("Created by Gonza Systems",k/2,n+=5,{fontSize:9,align:"center"}),i)return j.output("blob");e&&j.save(e)};a.s(["generateReceiptVectorPDF",0,d])},625361,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(272922),e=a.i(368114);let f=({shouldScaleBackground:a=!0,...c})=>(0,b.jsx)(d.Drawer.Root,{shouldScaleBackground:a,...c});f.displayName="Drawer",d.Drawer.Trigger;let g=d.Drawer.Portal,h=d.Drawer.Close,i=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(d.Drawer.Overlay,{ref:f,className:(0,e.cn)("fixed inset-0 z-50 bg-black/80",a),...c}));i.displayName=d.Drawer.Overlay.displayName;let j=c.forwardRef(({className:a,children:c,...f},h)=>(0,b.jsxs)(g,{children:[(0,b.jsx)(i,{}),(0,b.jsxs)(d.Drawer.Content,{ref:h,className:(0,e.cn)("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",a),...f,children:[(0,b.jsx)("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),c]})]}));j.displayName="DrawerContent";let k=({className:a,...c})=>(0,b.jsx)("div",{className:(0,e.cn)("grid gap-1.5 p-4 text-center sm:text-left",a),...c});k.displayName="DrawerHeader";let l=({className:a,...c})=>(0,b.jsx)("div",{className:(0,e.cn)("mt-auto flex flex-col gap-2 p-4",a),...c});l.displayName="DrawerFooter";let m=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(d.Drawer.Title,{ref:f,className:(0,e.cn)("text-lg font-semibold leading-none tracking-tight",a),...c}));m.displayName=d.Drawer.Title.displayName,c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(d.Drawer.Description,{ref:f,className:(0,e.cn)("text-sm text-muted-foreground",a),...c})).displayName=d.Drawer.Description.displayName,a.s(["Drawer",()=>f,"DrawerClose",()=>h,"DrawerContent",()=>j,"DrawerFooter",()=>l,"DrawerHeader",()=>k,"DrawerTitle",()=>m])},596221,a=>{"use strict";let b=(0,a.i(170106).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],596221)},292e3,a=>{"use strict";let b=(0,a.i(170106).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],292e3)},429246,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(368114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("textarea",{className:(0,d.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:e,...c}));e.displayName="Textarea",a.s(["Textarea",()=>e])},814747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},522734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},37702,(a,b,c)=>{b.exports=a.x("worker_threads",()=>require("worker_threads"))},104720,a=>{"use strict";let b=(0,a.i(170106).default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);a.s(["FileText",()=>b],104720)},866102,a=>{"use strict";var b=a.i(572131),c=a.i(433217),d=a.i(478793),e=a.i(169819),f=a.i(405050);let g=(0,f.createServerReference)("40290a4fc6b8571a026afeb877566edb807919e482",f.callServer,void 0,f.findSourceMapURL,"getBusinessSettingsAction");var h=a.i(682242);let i=()=>({businessName:"",businessAddress:"",businessPhone:"",businessEmail:"",currency:"UGX",paymentInfo:"",defaultPrintFormat:"standard"});a.s(["convertPaymentMethodsToString",0,a=>a.filter(a=>""!==a.method.trim()||""!==a.accountNumber.trim()||""!==a.accountName.trim()).map(a=>`${a.method}
${a.accountNumber}
${a.accountName}`).join("\n"),"parsePaymentInfo",0,a=>{if(!a||""===a.trim())return[];let b=a.split("\n").filter(a=>""!==a.trim()),c=[];for(let a=0;a<b.length;a+=3)a+2<b.length&&c.push({method:b[a].trim(),accountNumber:b[a+1].trim(),accountName:b[a+2].trim()});return c},"useBusinessSettings",0,()=>{let[a,f]=(0,b.useState)(i()),[j,k]=(0,b.useState)(!1),{toast:l}=(0,d.useToast)(),{currentBusiness:m}=(0,e.useBusiness)(),n=async()=>{if(!m)return i();try{let a=await g(m.id);if(!a)return i();{let b=a.metadata&&"object"==typeof a.metadata&&a.metadata.payment_info||"";return{id:a.id,businessName:a.business_name||"",businessAddress:a.business_address||"",businessPhone:a.business_phone||"",businessEmail:a.business_email||"",businessLogo:a.business_logo||void 0,currency:a.currency||"UGX",signature:a.signature||void 0,paymentInfo:b,defaultPrintFormat:a.metadata&&"object"==typeof a.metadata&&a.metadata.default_print_format||"standard",defaultPrinterName:a.metadata&&"object"==typeof a.metadata&&a.metadata.default_printer_name||"",defaultPrinterType:a.metadata&&"object"==typeof a.metadata&&a.metadata.default_printer_type||"USB",printerPaperSize:a.metadata&&"object"==typeof a.metadata&&a.metadata.printer_paper_size||"58mm"}}}catch(a){return console.error("Error loading business settings:",a),l({title:"Error",description:"Failed to load business settings. Please try again.",variant:"destructive"}),i()}},o=async b=>{if(!m)return console.error("No business selected for updating settings"),l({title:"Error",description:"No business selected",variant:"destructive"}),!1;try{let c={payment_info:b.hasOwnProperty("paymentInfo")?b.paymentInfo:a.paymentInfo||"",default_print_format:b.hasOwnProperty("defaultPrintFormat")?b.defaultPrintFormat:a.defaultPrintFormat||"standard",default_printer_name:b.hasOwnProperty("defaultPrinterName")?b.defaultPrinterName:a.defaultPrinterName||"",default_printer_type:b.hasOwnProperty("defaultPrinterType")?b.defaultPrinterType:a.defaultPrinterType||"USB",printer_paper_size:b.hasOwnProperty("printerPaperSize")?b.printerPaperSize:a.printerPaperSize||"58mm"},d={business_name:b.hasOwnProperty("businessName")?b.businessName:a.businessName,business_address:b.hasOwnProperty("businessAddress")?b.businessAddress:a.businessAddress,business_phone:b.hasOwnProperty("businessPhone")?b.businessPhone:a.businessPhone,business_email:b.hasOwnProperty("businessEmail")?b.businessEmail:a.businessEmail,business_logo:b.hasOwnProperty("businessLogo")?b.businessLogo:a.businessLogo,currency:b.hasOwnProperty("currency")?b.currency:a.currency,signature:b.hasOwnProperty("signature")?b.signature:a.signature,metadata:c},e=await (0,h.upsertBusinessSettingsAction)(m.id,"00000000-0000-0000-0000-000000000000",d);if(!e.success)throw console.error("Supabase error updating business settings:",e.error),Error(e.error);return l({title:"Success",description:"Business settings updated successfully"}),s(),!0}catch(a){return console.error("Error updating business settings:",a),l({title:"Error",description:"Failed to update business settings. Please try again.",variant:"destructive"}),!1}},{data:p,isLoading:q,isFetching:r,refetch:s}=(0,c.useQuery)({queryKey:["businessSettings",m?.id],queryFn:n,enabled:!!m?.id,staleTime:3e5,gcTime:18e5,refetchOnWindowFocus:!1,refetchOnReconnect:!1});return(0,b.useEffect)(()=>{p?f(p):m||f(i())},[p,m]),(0,b.useEffect)(()=>{k(q||r)},[q,r]),{settings:a,isLoading:j,updateSettings:o,loadSettings:n}}],866102)},774016,959296,42724,a=>{"use strict";let b=Symbol.for("constructDateFrom");function c(a,c){return"function"==typeof a?a(c):a&&"object"==typeof a&&b in a?a[b](c):a instanceof Date?new a.constructor(c):new Date(c)}function d(a,b){return c(b||a,a)}a.s(["constructFromSymbol",0,b,"millisecondsInDay",0,864e5,"millisecondsInHour",0,36e5,"millisecondsInMinute",0,6e4,"millisecondsInSecond",0,1e3,"millisecondsInWeek",0,6048e5,"minutesInDay",0,1440,"minutesInMonth",0,43200],959296),a.s(["constructFrom",()=>c],42724),a.s(["toDate",()=>d],774016)},400291,a=>{"use strict";var b=a.i(890914);a.s(["useFinancialVisibility",0,()=>{let{hasPermission:a}=(0,b.useProfiles)(),c=a("inventory","view_cost_price"),d=a("inventory","view_profit"),e=a("inventory","view_selling_price"),f=a("dashboard","view_total_sales"),g=a("dashboard","view_gross_profit"),h=a("dashboard","view_total_expenses"),i=a("dashboard","view_inventory_value"),j=a("dashboard","view_sales_types"),k=a("dashboard","view_avg_price"),l=a("dashboard","view_total_amount"),m=a("finance","manage_accounts"),n=a("finance","view"),o=a("expenses","view"),p=a("expenses","create"),q=a("expenses","edit");return{canViewCostPrice:c,canViewProfit:d,canViewSellingPrice:e,canViewTotalSales:f,canViewTotalGrossProfit:g,canViewTotalExpenses:h,canViewInventoryValue:i,canViewSalesTypes:j,canViewAvgPrice:k,canViewTotalAmount:l,canManageFinanceAccounts:m,canViewFinance:n,canViewExpenses:o,canCreateExpenses:p,canEditExpenses:q,canDeleteExpenses:a("expenses","delete"),formatFinancial:(a,b)=>"cost"===b&&c||"selling"===b&&e||"profit"===b&&d?a?.toLocaleString()||"0":"•••"}}])},206015,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(368114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{className:"relative w-full overflow-auto",children:(0,b.jsx)("table",{ref:e,className:(0,d.cn)("w-full caption-bottom text-sm",a),...c})}));e.displayName="Table";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("thead",{ref:e,className:(0,d.cn)("[&_tr]:border-b",a),...c}));f.displayName="TableHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tbody",{ref:e,className:(0,d.cn)("[&_tr:last-child]:border-0",a),...c}));g.displayName="TableBody",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tfoot",{ref:e,className:(0,d.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...c})).displayName="TableFooter";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tr",{ref:e,className:(0,d.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...c}));h.displayName="TableRow";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("th",{ref:e,className:(0,d.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...c}));i.displayName="TableHead";let j=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("td",{ref:e,className:(0,d.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...c}));j.displayName="TableCell",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("caption",{ref:e,className:(0,d.cn)("mt-4 text-sm text-muted-foreground",a),...c})).displayName="TableCaption",a.s(["Table",()=>e,"TableBody",()=>g,"TableCell",()=>j,"TableHead",()=>i,"TableHeader",()=>f,"TableRow",()=>h])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__5e63ad44._.js.map