{"version":3,"sources":["../../../../src/app/billing-history/page.tsx","../../../../src/app/actions/data%3A9dbdd2%20%3Ctext/javascript%3E","../../../../src/app/actions/data%3A1efd39%20%3Ctext/javascript%3E"],"sourcesContent":["\"use client\";\r\n\r\nimport React from 'react';\r\nimport { useOnboarding } from '@/hooks/useOnboarding';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { getSubscriptionPaymentsAction, initiateSubscriptionPaymentAction } from '@/app/actions/billing';\r\nimport {\r\n    CreditCard,\r\n    Calendar,\r\n    Clock,\r\n    CheckCircle2,\r\n    AlertCircle,\r\n    Download,\r\n    Receipt,\r\n    Building2,\r\n    ChevronRight,\r\n    FileText,\r\n    TrendingUp\r\n} from 'lucide-react';\r\nimport { format, addMonths, addDays } from 'date-fns';\r\nimport { cn } from '@/lib/utils';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { generateSubscriptionInvoice } from '@/utils/generateSubscriptionInvoice';\r\nimport LoadingSpinner from '@/components/LoadingSpinner';\r\n\r\ninterface SubscriptionPayment {\r\n    id: string;\r\n    created_at: string;\r\n    billing_cycle: string | null;\r\n    amount: number;\r\n    payment_status: string | null;\r\n}\r\n\r\nexport default function BillingHistory() {\r\n    const { user } = useAuth();\r\n    const { currentBusiness } = useBusiness();\r\n    const [isInitiatingPayment, setIsInitiatingPayment] = React.useState(false);\r\n    const [pesapalRedirectUrl, setPesapalRedirectUrl] = React.useState<string | null>(null);\r\n\r\n    const {\r\n        daysRemaining,\r\n        billingAmount,\r\n        billingDuration,\r\n        nextBillingDate,\r\n        isFrozen,\r\n        isLoading: isSubscriptionLoading,\r\n        refetch: refetchOnboarding\r\n    } = useOnboarding();\r\n\r\n    const { data: rawPayments, isLoading: isPaymentsLoading } = useQuery({\r\n        queryKey: ['subscription-payments', user?.id],\r\n        queryFn: async () => {\r\n            if (!user?.id) return [];\r\n            const data = await getSubscriptionPaymentsAction(user.id);\r\n            return data as SubscriptionPayment[];\r\n        },\r\n        enabled: !!user\r\n    });\r\n\r\n    const payments = React.useMemo(() => {\r\n        if (!rawPayments) return [];\r\n        return rawPayments.map((p, index) => ({\r\n            ...p,\r\n            invoice_number: index + 1,\r\n            business_name: currentBusiness?.name || 'Gonzo System User'\r\n        })).sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime());\r\n    }, [rawPayments, currentBusiness]);\r\n\r\n    const getStatusColor = (days: number, frozen: boolean) => {\r\n        if (frozen || days <= 0) return 'text-red-600 bg-red-50 border-red-100';\r\n        if (days <= 7) return 'text-amber-600 bg-amber-50 border-amber-100';\r\n        return 'text-emerald-600 bg-emerald-50 border-emerald-100';\r\n    };\r\n\r\n    const getStatusText = (days: number, frozen: boolean) => {\r\n        if (frozen) return 'Account Paused';\r\n        if (days <= 0) return 'Expired';\r\n        if (days <= 7) return 'Expiring Soon';\r\n        return 'Active';\r\n    };\r\n\r\n    const handleDownloadInvoice = async (payment: any, type: 'receipt' | 'invoice' = 'invoice') => {\r\n        await generateSubscriptionInvoice(payment, type);\r\n    };\r\n\r\n    const handleRenew = async () => {\r\n        if (!user || !billingAmount) return;\r\n\r\n        setIsInitiatingPayment(true);\r\n        try {\r\n            const purchaseId = crypto.randomUUID();\r\n            const locationId = currentBusiness?.id || (user as any).location_id || '00000000-0000-0000-0000-000000000000';\r\n\r\n            const phone = user.user_metadata?.phone || user.phone || '0700000000';\r\n\r\n            const result = await initiateSubscriptionPaymentAction(\r\n                user.id,\r\n                locationId,\r\n                billingAmount,\r\n                billingDuration || 'monthly',\r\n                phone\r\n            );\r\n\r\n            if (!result.success) {\r\n                throw new Error(result.error);\r\n            }\r\n\r\n            if (result.redirect_url) {\r\n                setPesapalRedirectUrl(result.redirect_url);\r\n            }\r\n        } catch (error: any) {\r\n            console.error('Subscription Renewal Error:', error);\r\n\r\n            const errorMsg = error.message || error.error || \"Failed to connect to Pesapal.\";\r\n            alert(`Payment Error: ${errorMsg}. Please try again later.`);\r\n        } finally {\r\n            setIsInitiatingPayment(false);\r\n        }\r\n    };\r\n\r\n    const handleDownloadUpcomingInvoice = async () => {\r\n        if (!nextBillingDate || !billingAmount) return;\r\n\r\n        // Create a mock payment object for the upcoming renewal\r\n        const upcomingPayment = {\r\n            id: `PRO-FORMA-${format(new Date(), 'yyyyMMdd')}`,\r\n            created_at: new Date().toISOString(), // Today's date for creation\r\n            due_date: nextBillingDate, // Renewal date as due date\r\n            amount: billingAmount,\r\n            billing_cycle: billingDuration || 'Monthly',\r\n            payment_status: 'pending',\r\n            user_id: user?.id,\r\n            isProForma: true,\r\n            business_name: currentBusiness?.name || 'Gonzo System User',\r\n            invoice_number: (payments?.length || 0) + 1 // Next in sequence\r\n        };\r\n\r\n        await generateSubscriptionInvoice(upcomingPayment, 'invoice');\r\n    };\r\n\r\n    if (isSubscriptionLoading || isPaymentsLoading) {\r\n        return (\r\n            <div className=\"flex flex-col items-center justify-center min-h-[60vh]\">\r\n                <LoadingSpinner message=\"Loading billing data...\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-6 lg:p-10 max-w-7xl mx-auto space-y-10 animate-in fade-in slide-in-from-bottom-4 duration-700\">\r\n            {pesapalRedirectUrl && (\r\n                <div className=\"fixed inset-0 z-[100] bg-background/80 backdrop-blur-sm flex flex-col items-center justify-center p-4\">\r\n                    <div className=\"w-full max-w-4xl h-[85vh] bg-white rounded-2xl shadow-2xl border border-border/40 overflow-hidden relative flex flex-col scale-in-center\">\r\n                        <div className=\"p-4 border-b border-border/40 flex items-center justify-between bg-white\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className=\"w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center\">\r\n                                    <CreditCard className=\"w-4 h-4 text-blue-600\" />\r\n                                </div>\r\n                                <div>\r\n                                    <h3 className=\"text-sm font-bold uppercase tracking-wider\">Secure Payment</h3>\r\n                                    <p className=\"text-[10px] text-muted-foreground font-mono italic\">Powered by Pesapal</p>\r\n                                </div>\r\n                            </div>\r\n                            <button\r\n                                onClick={() => {\r\n                                    setPesapalRedirectUrl(null);\r\n                                    refetchOnboarding();\r\n                                }}\r\n                                className=\"px-4 py-2 text-[10px] font-bold uppercase tracking-widest text-muted-foreground hover:text-red-600 hover:bg-red-50 rounded-lg transition-all\"\r\n                            >\r\n                                Close & Sync\r\n                            </button>\r\n                        </div>\r\n                        <iframe\r\n                            src={pesapalRedirectUrl}\r\n                            className=\"w-full flex-1 border-none\"\r\n                            title=\"Pesapal Payment\"\r\n                        />\r\n                    </div>\r\n                    <p className=\"mt-4 text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-medium opacity-60\">\r\n                        Do not close this window until the payment is complete\r\n                    </p>\r\n                </div>\r\n            )}\r\n\r\n            {/* Header */}\r\n            <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold tracking-tight text-foreground\">Billing & Subscription</h1>\r\n                    <p className=\"text-muted-foreground mt-1 text-sm\">Manage your plan, track payments, and download invoices.</p>\r\n                </div>\r\n                <div className=\"flex items-center flex-wrap gap-3\">\r\n                    <button\r\n                        onClick={handleRenew}\r\n                        disabled={isInitiatingPayment}\r\n                        className=\"px-6 py-2.5 bg-blue-600 text-white rounded-xl text-[11px] font-bold uppercase tracking-widest hover:bg-blue-700 transition-all flex items-center gap-2 shadow-lg shadow-blue-200 disabled:opacity-50\"\r\n                    >\r\n                        {isInitiatingPayment ? (\r\n                            <div className=\"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin\" />\r\n                        ) : (\r\n                            <CreditCard className=\"w-4 h-4\" />\r\n                        )}\r\n                        Renew / Pay Now\r\n                    </button>\r\n                    <button\r\n                        onClick={handleDownloadUpcomingInvoice}\r\n                        className=\"px-4 py-2.5 bg-slate-100 text-slate-700 border border-slate-200 rounded-xl text-[11px] font-bold uppercase tracking-widest hover:bg-slate-200 transition-all flex items-center gap-2\"\r\n                    >\r\n                        <FileText className=\"w-4 h-4\" />\r\n                        Upcoming Invoice\r\n                    </button>\r\n                    <div className={cn(\r\n                        \"px-4 py-2.5 rounded-xl border text-[11px] font-bold uppercase tracking-widest flex items-center gap-2 w-fit\",\r\n                        getStatusColor(daysRemaining, isFrozen)\r\n                    )}>\r\n                        {isFrozen || daysRemaining <= 0 ? <AlertCircle className=\"w-3.5 h-3.5\" /> : <CheckCircle2 className=\"w-3.5 h-3.5\" />}\r\n                        {getStatusText(daysRemaining, isFrozen)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Metrics Grid */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                <div className=\"bg-white border border-border/40 rounded-2xl p-6 shadow-sm hover:shadow-md transition-shadow group\">\r\n                    <div className=\"flex items-center gap-3 mb-4\">\r\n                        <div className=\"w-10 h-10 rounded-xl bg-primary/5 flex items-center justify-center group-hover:scale-110 transition-transform\">\r\n                            <Receipt className=\"w-5 h-5 text-primary\" />\r\n                        </div>\r\n                        <span className=\"text-[10px] font-bold uppercase tracking-widest text-muted-foreground\">Current Plan</span>\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                        <h3 className=\"text-2xl font-bold\">UGX {billingAmount?.toLocaleString()}</h3>\r\n                        <p className=\"text-sm font-medium text-muted-foreground uppercase tracking-wider\">{billingDuration}</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-white border border-border/40 rounded-2xl p-6 shadow-sm hover:shadow-md transition-shadow group\">\r\n                    <div className=\"flex items-center gap-3 mb-4\">\r\n                        <div className=\"w-10 h-10 rounded-xl bg-orange-50 flex items-center justify-center group-hover:scale-110 transition-transform\">\r\n                            <Clock className=\"w-5 h-5 text-orange-600\" />\r\n                        </div>\r\n                        <span className=\"text-[10px] font-bold uppercase tracking-widest text-muted-foreground\">Days Remaining</span>\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                        <h3 className={cn(\"text-2xl font-bold\", daysRemaining <= 7 ? \"text-orange-600\" : \"text-foreground\")}>\r\n                            {daysRemaining <= 0 ? '0' : daysRemaining} Days\r\n                        </h3>\r\n                        <p className=\"text-sm font-medium text-muted-foreground uppercase tracking-wider\">Left on Subscription</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-white border border-border/40 rounded-2xl p-6 shadow-sm hover:shadow-md transition-shadow group\">\r\n                    <div className=\"flex items-center gap-3 mb-4\">\r\n                        <div className=\"w-10 h-10 rounded-xl bg-blue-50 flex items-center justify-center group-hover:scale-110 transition-transform\">\r\n                            <Calendar className=\"w-5 h-5 text-blue-600\" />\r\n                        </div>\r\n                        <span className=\"text-[10px] font-bold uppercase tracking-widest text-muted-foreground\">Next Billing</span>\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                        <h3 className=\"text-2xl font-bold\">\r\n                            {nextBillingDate ? format(new Date(nextBillingDate), 'MMM dd, yyyy') : 'No Date Set'}\r\n                        </h3>\r\n                        <p className=\"text-sm font-medium text-muted-foreground uppercase tracking-wider\">Scheduled Renewal</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* History Table */}\r\n            <div className=\"bg-white border border-border/40 rounded-2xl overflow-hidden shadow-sm\">\r\n                <div className=\"p-6 border-b border-border/40 bg-muted/5 flex items-center justify-between\">\r\n                    <h3 className=\"text-sm font-bold uppercase tracking-widest flex items-center gap-2\">\r\n                        <HistoryIcon className=\"w-4 h-4 text-muted-foreground\" />\r\n                        Payment History\r\n                    </h3>\r\n                    <div className=\"text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full border border-emerald-100 tracking-tighter uppercase\">\r\n                        Finalized Payments\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"overflow-x-auto\">\r\n                    <table className=\"w-full text-left border-collapse\">\r\n                        <thead>\r\n                            <tr className=\"bg-muted/10 h-12\">\r\n                                <th className=\"px-6 text-[10px] font-bold text-muted-foreground uppercase tracking-widest\">Date</th>\r\n                                <th className=\"px-6 text-[10px] font-bold text-muted-foreground uppercase tracking-widest\">Description</th>\r\n                                <th className=\"px-6 text-right text-[10px] font-bold text-muted-foreground uppercase tracking-widest\">Amount</th>\r\n                                <th className=\"px-6 text-center text-[10px] font-bold text-muted-foreground uppercase tracking-widest\">Status</th>\r\n                                <th className=\"px-6 text-right text-[10px] font-bold text-muted-foreground uppercase tracking-widest\">Action</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y divide-border/20\">\r\n                            {payments && payments.length > 0 ? (\r\n                                payments.map((payment) => (\r\n                                    <tr key={payment.id} className=\"h-16 hover:bg-muted/5 transition-colors group\">\r\n                                        <td className=\"px-6 py-4\">\r\n                                            <div className=\"flex flex-col\">\r\n                                                <span className=\"text-[13px] font-bold\">{format(new Date(payment.created_at), 'MMM dd, yyyy')}</span>\r\n                                                <span className=\"text-[10px] text-muted-foreground font-mono\">{payment.id.split('-')[0].toUpperCase()}</span>\r\n                                            </div>\r\n                                        </td>\r\n                                        <td className=\"px-6 py-4\">\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <CreditCard className=\"w-3.5 h-3.5 text-muted-foreground\" />\r\n                                                <span className=\"text-[13px] font-medium text-foreground\">\r\n                                                    {payment.billing_cycle} Subscription Renewal\r\n                                                </span>\r\n                                            </div>\r\n                                        </td>\r\n                                        <td className=\"px-6 py-4 text-right\">\r\n                                            <span className=\"text-[13px] font-bold\">UGX {payment.amount.toLocaleString()}</span>\r\n                                        </td>\r\n                                        <td className=\"px-6 py-4\">\r\n                                            <div className=\"flex justify-center\">\r\n                                                <span className={cn(\r\n                                                    \"px-2.5 py-1 rounded-md text-[9px] font-bold uppercase tracking-tight border\",\r\n                                                    payment.payment_status === 'completed' || payment.payment_status === 'success'\r\n                                                        ? \"bg-emerald-50 text-emerald-600 border-emerald-100\"\r\n                                                        : payment.payment_status === 'pending'\r\n                                                            ? \"bg-amber-50 text-amber-600 border-amber-100\"\r\n                                                            : \"bg-red-50 text-red-600 border-red-100\"\r\n                                                )}>\r\n                                                    {payment.payment_status}\r\n                                                </span>\r\n                                            </div>\r\n                                        </td>\r\n                                        <td className=\"px-6 py-4 text-right\">\r\n                                            <div className=\"flex justify-end gap-2\">\r\n                                                <button\r\n                                                    onClick={() => handleDownloadInvoice(payment, 'invoice')}\r\n                                                    className=\"p-2 hover:bg-primary/5 rounded-lg text-primary transition-colors inline-flex items-center gap-2 text-[11px] font-bold uppercase tracking-widest\"\r\n                                                    title=\"Download Invoice\"\r\n                                                >\r\n                                                    <FileText className=\"w-3.5 h-3.5\" />\r\n                                                    <span className=\"hidden sm:inline\">Invoice</span>\r\n                                                </button>\r\n                                                <button\r\n                                                    onClick={() => handleDownloadInvoice(payment, 'receipt')}\r\n                                                    className=\"p-2 hover:bg-emerald-50 rounded-lg text-emerald-600 transition-colors inline-flex items-center gap-2 text-[11px] font-bold uppercase tracking-widest\"\r\n                                                    title=\"Download Receipt\"\r\n                                                >\r\n                                                    <Download className=\"w-3.5 h-3.5\" />\r\n                                                    <span className=\"hidden sm:inline\">Receipt</span>\r\n                                                </button>\r\n                                            </div>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))\r\n                            ) : (\r\n                                <tr>\r\n                                    <td colSpan={5} className=\"py-20 text-center\">\r\n                                        <div className=\"flex flex-col items-center gap-3\">\r\n                                            <div className=\"w-12 h-12 rounded-full bg-muted/20 flex items-center justify-center\">\r\n                                                <Receipt className=\"w-6 h-6 text-muted-foreground/30\" />\r\n                                            </div>\r\n                                            <p className=\"text-xs font-bold text-muted-foreground uppercase tracking-widest\">No transaction history found</p>\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n                            )}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Footer Support */}\r\n            <div className=\"bg-blue-600 rounded-2xl p-8 lg:p-10 text-white relative overflow-hidden group\">\r\n                <div className=\"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -mr-32 -mt-32 blur-3xl group-hover:scale-110 transition-transform duration-700\" />\r\n                <div className=\"relative z-10 flex flex-col md:flex-row items-center justify-between gap-8\">\r\n                    <div className=\"max-w-md text-center md:text-left\">\r\n                        <h3 className=\"text-xl font-bold mb-2\">Need a custom plan or help?</h3>\r\n                        <p className=\"text-blue-100 text-sm\">Our team is here to help you scale your business with the right tools and support.</p>\r\n                    </div>\r\n                    <div className=\"flex flex-col sm:flex-row items-center gap-4\">\r\n                        <a\r\n                            href=\"mailto:support@gonzasystems.com\"\r\n                            className=\"px-6 py-3 bg-white text-blue-600 rounded-xl text-[11px] font-bold uppercase tracking-widest hover:bg-blue-50 transition-colors shadow-lg\"\r\n                        >\r\n                            Contact Support\r\n                        </a>\r\n                        <a\r\n                            href=\"tel:+256758519696\"\r\n                            className=\"px-6 py-3 bg-blue-500 text-white border border-blue-400 rounded-xl text-[11px] font-bold uppercase tracking-widest hover:bg-blue-400 transition-colors\"\r\n                        >\r\n                            Call +256 758519696\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction HistoryIcon({ className }: { className?: string }) {\r\n    return (\r\n        <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            width=\"24\"\r\n            height=\"24\"\r\n            viewBox=\"0 0 24 24\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            strokeWidth=\"2\"\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            className={className}\r\n        >\r\n            <path d=\"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\" />\r\n            <path d=\"M3 3v5h5\" />\r\n            <path d=\"M12 7v5l4 2\" />\r\n        </svg>\r\n    );\r\n}\r\n","/* __next_internal_action_entry_do_not_use__ [{\"40ba16ec3b325b2283f3e465df8c454e2cd68b45a2\":\"getSubscriptionPaymentsAction\"},\"src/app/actions/billing.ts\",\"\"] */\"use turbopack no side effects\";import{createServerReference,callServer,findSourceMapURL}from\"private-next-rsc-action-client-wrapper\";const $$RSC_SERVER_ACTION_0=/*#__PURE__*/createServerReference(\"40ba16ec3b325b2283f3e465df8c454e2cd68b45a2\",callServer,void 0,findSourceMapURL,\"getSubscriptionPaymentsAction\");export{$$RSC_SERVER_ACTION_0 as getSubscriptionPaymentsAction};","/* __next_internal_action_entry_do_not_use__ [{\"7cf9757e320c46f955c6d99f3b8c16f72db910a81d\":\"initiateSubscriptionPaymentAction\"},\"src/app/actions/billing.ts\",\"\"] */\"use turbopack no side effects\";import{createServerReference,callServer,findSourceMapURL}from\"private-next-rsc-action-client-wrapper\";const $$RSC_SERVER_ACTION_1=/*#__PURE__*/createServerReference(\"7cf9757e320c46f955c6d99f3b8c16f72db910a81d\",callServer,void 0,findSourceMapURL,\"initiateSubscriptionPaymentAction\");export{$$RSC_SERVER_ACTION_1 as initiateSubscriptionPaymentAction};"],"names":[],"mappings":"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"}