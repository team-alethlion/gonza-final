{"version":3,"sources":["../../../../src/components/inventory/InventoryStats.tsx","../../../../node_modules/lucide-react/src/icons/ban.ts","../../../../src/hooks/useBulkProducts.ts","../../../../src/components/inventory/BulkOperationProgress.tsx","../../../../src/components/inventory/CSVUploadDialog.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Product } from '@/types';\r\nimport { Package, AlertTriangle, Ban, TrendingUp, DollarSign } from 'lucide-react';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\ninterface InventoryStatsProps {\r\n  products: Product[];\r\n  hideStockValue?: boolean;\r\n  // Optional overrides to show totals beyond the current page without fetching all rows here\r\n  totalCountOverride?: number;\r\n  totalCostValueOverride?: number;\r\n  lowStockOverride?: number;\r\n  outOfStockOverride?: number;\r\n  totalStockValueOverride?: number;\r\n}\r\n\r\nconst InventoryStats: React.FC<InventoryStatsProps> = ({\r\n  products,\r\n  hideStockValue = false,\r\n  totalCountOverride,\r\n  totalCostValueOverride,\r\n  lowStockOverride,\r\n  outOfStockOverride,\r\n  totalStockValueOverride\r\n}) => {\r\n\r\n  const { settings } = useBusinessSettings();\r\n  const { canViewCostPrice, canViewSellingPrice } = useFinancialVisibility();\r\n\r\n\r\n  // Calculate stats\r\n  const totalProducts = typeof totalCountOverride === 'number' ? totalCountOverride : products.length;\r\n  const lowStockProducts = typeof lowStockOverride === 'number' ? lowStockOverride : products.filter(p => p.quantity > 0 && p.quantity <= p.minimumStock).length;\r\n  const outOfStockProducts = typeof outOfStockOverride === 'number' ? outOfStockOverride : products.filter(p => p.quantity === 0).length;\r\n\r\n  const totalInventoryValue = typeof totalCostValueOverride === 'number'\r\n    ? totalCostValueOverride\r\n    : products.reduce((sum, product) => sum + (product.costPrice * product.quantity), 0);\r\n\r\n  const totalStockValue = typeof totalStockValueOverride === 'number'\r\n    ? totalStockValueOverride\r\n    : products.reduce((sum, product) => {\r\n      return sum + (product.sellingPrice * product.quantity);\r\n    }, 0);\r\n\r\n  // Get dynamic font size based on text length\r\n  const getDynamicFontSize = (text: string) => {\r\n    const length = text.length;\r\n    if (length > 15) return \"text-sm md:text-lg\"; // Very long numbers\r\n    if (length > 12) return \"text-base md:text-xl\"; // Long numbers\r\n    if (length > 8) return \"text-lg md:text-xl\"; // Medium numbers\r\n    return \"text-lg md:text-2xl\"; // Short numbers (default)\r\n  };\r\n\r\n  return (\r\n    <div className={`grid gap-3 md:gap-4 mb-6 ${hideStockValue ? 'grid-cols-2 md:grid-cols-4' : 'grid-cols-2 md:grid-cols-3 xl:grid-cols-5'}`}>\r\n      <Card className=\"overflow-hidden\">\r\n        <CardContent className=\"p-4 md:p-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-blue-100 text-blue-500\">\r\n              <Package className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n            </div>\r\n            <div className=\"ml-3 md:ml-4 min-w-0\">\r\n              <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Total Products</p>\r\n              <h3 className=\"text-lg md:text-2xl font-bold\">{totalProducts}</h3>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card className=\"overflow-hidden\">\r\n        <CardContent className=\"p-4 md:p-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-amber-100 text-amber-500\">\r\n              <AlertTriangle className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n            </div>\r\n            <div className=\"ml-3 md:ml-4 min-w-0\">\r\n              <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Low Stock</p>\r\n              <h3 className=\"text-lg md:text-2xl font-bold\">{lowStockProducts}</h3>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card className=\"overflow-hidden\">\r\n        <CardContent className=\"p-4 md:p-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-red-100 text-red-500\">\r\n              <Ban className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n            </div>\r\n            <div className=\"ml-3 md:ml-4 min-w-0\">\r\n              <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Out of Stock</p>\r\n              <h3 className=\"text-lg md:text-2xl font-bold\">{outOfStockProducts}</h3>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card className=\"overflow-hidden\">\r\n        <CardContent className=\"p-4 md:p-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-green-100 text-green-500\">\r\n              <TrendingUp className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n            </div>\r\n            <div className=\"ml-3 md:ml-4 min-w-0 flex-1\">\r\n              <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Cost Value</p>\r\n              <h3 className={`${getDynamicFontSize(`${settings.currency} ${formatNumber(totalInventoryValue)}`)} font-bold break-all leading-tight`}>\r\n                {canViewCostPrice ? `${settings.currency} ${formatNumber(totalInventoryValue)}` : '•••'}\r\n              </h3>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {!hideStockValue && (\r\n        <Card className=\"overflow-hidden\">\r\n          <CardContent className=\"p-4 md:p-6\">\r\n            <div className=\"flex items-center\">\r\n              <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-purple-100 text-purple-500\">\r\n                <DollarSign className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n              </div>\r\n              <div className=\"ml-3 md:ml-4 min-w-0 flex-1\">\r\n                <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Stock Value</p>\r\n                <h3 className={`${getDynamicFontSize(`${settings.currency} ${formatNumber(totalStockValue)}`)} font-bold break-all leading-tight`}>\r\n                  {canViewSellingPrice ? `${settings.currency} ${formatNumber(totalStockValue)}` : '•••'}\r\n                </h3>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InventoryStats;\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Ban\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cGF0aCBkPSJtNC45IDQuOSAxNC4yIDE0LjIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/ban\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Ban = createLucideIcon('Ban', [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['path', { d: 'm4.9 4.9 14.2 14.2', key: '1m5liu' }],\n]);\n\nexport default Ban;\n","\r\nimport { useState } from 'react';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useCategories } from '@/hooks/useCategories';\r\nimport { ProductFormData } from '@/types';\r\nimport { toast } from 'sonner';\r\n\r\nexport const useBulkProducts = () => {\r\n  const { user } = useAuth();\r\n  const { createProduct } = useProducts(user?.id);\r\n  const { categories, createCategory } = useCategories(user?.id);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n\r\n  const createMissingCategories = async (productCategories: string[]) => {\r\n    const existingCategoryNames = categories.map(cat => cat.name.toLowerCase());\r\n    const uniqueCategories = [...new Set(productCategories.filter(cat => cat.trim() !== ''))];\r\n    const missingCategories = uniqueCategories.filter(\r\n      category => !existingCategoryNames.includes(category.toLowerCase())\r\n    );\r\n\r\n    const createdCategories: string[] = [];\r\n    const failedCategories: string[] = [];\r\n\r\n    for (const categoryName of missingCategories) {\r\n      try {\r\n        const result = await createCategory(categoryName);\r\n        if (result) {\r\n          createdCategories.push(categoryName);\r\n        } else {\r\n          failedCategories.push(categoryName);\r\n        }\r\n      } catch (error) {\r\n        console.error(`Failed to create category ${categoryName}:`, error);\r\n        failedCategories.push(categoryName);\r\n      }\r\n    }\r\n\r\n    return { createdCategories, failedCategories };\r\n  };\r\n\r\n  const bulkCreateProducts = async (\r\n    products: ProductFormData[], \r\n    progressCallback?: (current: number, total: number) => void\r\n  ) => {\r\n    if (!user?.id) {\r\n      throw new Error('User not authenticated');\r\n    }\r\n\r\n    setIsUploading(true);\r\n    let successCount = 0;\r\n    let failureCount = 0;\r\n    const errors: string[] = [];\r\n\r\n    try {\r\n      // Extract all categories from products\r\n      const productCategories = products.map(p => p.category).filter(Boolean);\r\n      \r\n      // Create missing categories first\r\n      if (productCategories.length > 0) {\r\n        const { createdCategories, failedCategories } = await createMissingCategories(productCategories);\r\n        \r\n        if (createdCategories.length > 0) {\r\n          toast.success(`Created ${createdCategories.length} new categories`);\r\n        }\r\n        \r\n        if (failedCategories.length > 0) {\r\n          toast.error(`Failed to create ${failedCategories.length} categories`);\r\n        }\r\n      }\r\n\r\n      // Now create products with progress tracking\r\n      for (let i = 0; i < products.length; i++) {\r\n        const productData = products[i];\r\n        \r\n        try {\r\n          const result = await createProduct(productData);\r\n          if (result) {\r\n            successCount++;\r\n          } else {\r\n            failureCount++;\r\n            errors.push(`Failed to create product: ${productData.name}`);\r\n          }\r\n        } catch (error) {\r\n          failureCount++;\r\n          errors.push(`Error creating ${productData.name}: ${error}`);\r\n          console.error(`Error creating product ${productData.name}:`, error);\r\n        }\r\n        \r\n        // Update progress after each product\r\n        if (progressCallback) {\r\n          progressCallback(successCount + failureCount, products.length);\r\n        }\r\n      }\r\n\r\n      // Show summary toast only if no progress callback (for regular usage)\r\n      if (!progressCallback) {\r\n        if (successCount > 0) {\r\n          toast.success(`Successfully created ${successCount} products`);\r\n        }\r\n        \r\n        if (failureCount > 0) {\r\n          toast.error(`${failureCount} products failed to upload`);\r\n        }\r\n      }\r\n\r\n      return { successCount, failureCount, errors };\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  const detectNewCategories = (products: ProductFormData[]) => {\r\n    const existingCategoryNames = categories.map(cat => cat.name.toLowerCase());\r\n    const productCategories = products.map(p => p.category).filter(Boolean);\r\n    const uniqueCategories = [...new Set(productCategories)];\r\n    \r\n    return uniqueCategories.filter(\r\n      category => !existingCategoryNames.includes(category.toLowerCase())\r\n    );\r\n  };\r\n\r\n  return {\r\n    bulkCreateProducts,\r\n    detectNewCategories,\r\n    isUploading\r\n  };\r\n};\r\n","import React from 'react';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { CheckCircle, AlertCircle, Info } from 'lucide-react';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\n\r\ninterface BulkOperationProgressProps {\r\n    title: string;\r\n    currentCount: number;\r\n    totalCount: number;\r\n    status: 'processing' | 'completed' | 'failed';\r\n    successCount?: number;\r\n    failureCount?: number;\r\n    onClose?: () => void;\r\n}\r\n\r\nexport const BulkOperationProgress: React.FC<BulkOperationProgressProps> = ({\r\n    title,\r\n    currentCount,\r\n    totalCount,\r\n    status,\r\n    successCount,\r\n    failureCount,\r\n}) => {\r\n    const progressPercentage = Math.round((currentCount / totalCount) * 100);\r\n\r\n    return (\r\n        <div className=\"space-y-6 py-4\">\r\n            {status === 'processing' && (\r\n                <Alert>\r\n                    <Info className=\"h-4 w-4\" />\r\n                    <AlertDescription>\r\n                        <strong>Please do not close this tab or dialog until the process is complete.</strong>\r\n                    </AlertDescription>\r\n                </Alert>\r\n            )}\r\n\r\n            <div className=\"text-center space-y-4\">\r\n                {status === 'processing' ? (\r\n                    <div className=\"mx-auto h-12 w-12 animate-spin rounded-full border-4 border-muted border-t-primary\"></div>\r\n                ) : status === 'completed' ? (\r\n                    <CheckCircle className=\"mx-auto h-12 w-12 text-green-500\" />\r\n                ) : (\r\n                    <AlertCircle className=\"mx-auto h-12 w-12 text-destructive\" />\r\n                )}\r\n\r\n                <div>\r\n                    <h3 className=\"text-lg font-semibold\">{title}</h3>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                        {status === 'processing'\r\n                            ? `Processing item ${currentCount} of ${totalCount}`\r\n                            : status === 'completed'\r\n                                ? `Successfully processed ${successCount ?? totalCount} items${failureCount ? `, ${failureCount} failed` : ''}`\r\n                                : 'The operation failed to complete.'\r\n                        }\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between text-xs font-medium text-muted-foreground\">\r\n                    <span>Progress</span>\r\n                    <span>{progressPercentage}%</span>\r\n                </div>\r\n                <Progress value={progressPercentage} className=\"h-2 w-full\" />\r\n            </div>\r\n\r\n            {(successCount !== undefined || failureCount !== undefined) && status === 'completed' && (\r\n                <div className=\"grid grid-cols-2 gap-4 pt-2\">\r\n                    <div className=\"bg-green-50 border border-green-100 rounded-lg p-3 text-center\">\r\n                        <div className=\"text-xl font-bold text-green-700\">{successCount ?? 0}</div>\r\n                        <div className=\"text-xs text-green-600 font-medium\">Successful</div>\r\n                    </div>\r\n                    <div className=\"bg-red-50 border border-red-100 rounded-lg p-3 text-center\">\r\n                        <div className=\"text-xl font-bold text-red-700\">{failureCount ?? 0}</div>\r\n                        <div className=\"text-xs text-red-600 font-medium\">Failed</div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","import React, { useState, useRef } from 'react';\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Upload, FileText, AlertCircle, CheckCircle, Download, Plus, Info } from 'lucide-react';\r\nimport { parseCSV, generateErrorLogCSV, ValidationError, CSVProductRow, extractUniqueCategories } from '@/utils/csvParser';\r\nimport { ProductFormData } from '@/types';\r\nimport { cn } from '@/lib/utils';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useBulkProducts } from '@/hooks/useBulkProducts';\r\nimport { BulkOperationProgress } from './BulkOperationProgress';\r\n\r\ninterface CSVUploadDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  onUpload: (products: ProductFormData[]) => Promise<void>;\r\n  categories: string[];\r\n}\r\n\r\ninterface UploadState {\r\n  step: 'select' | 'preview' | 'uploading' | 'complete';\r\n  file: File | null;\r\n  validRows: CSVProductRow[];\r\n  errors: ValidationError[];\r\n  totalRows: number;\r\n  uploadProgress: number;\r\n  successCount: number;\r\n  failureCount: number;\r\n  newCategories: string[];\r\n  currentProductIndex: number;\r\n}\r\n\r\nconst CSVUploadDialog: React.FC<CSVUploadDialogProps> = ({\r\n  open,\r\n  onOpenChange,\r\n  onUpload,\r\n  categories\r\n}) => {\r\n  const { detectNewCategories, bulkCreateProducts } = useBulkProducts();\r\n  const [state, setState] = useState<UploadState>({\r\n    step: 'select',\r\n    file: null,\r\n    validRows: [],\r\n    errors: [],\r\n    totalRows: 0,\r\n    uploadProgress: 0,\r\n    successCount: 0,\r\n    failureCount: 0,\r\n    newCategories: [],\r\n    currentProductIndex: 0\r\n  });\r\n\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n\r\n  const handleFileSelect = async (file: File) => {\r\n    if (!file.name.endsWith('.csv')) {\r\n      alert('Please select a CSV file');\r\n      return;\r\n    }\r\n\r\n    const text = await file.text();\r\n    const result = parseCSV(text);\r\n\r\n    // Convert CSV rows to ProductFormData to detect new categories\r\n    const products = result.validRows.map(convertCSVRowToProduct);\r\n    const newCategories = detectNewCategories(products);\r\n\r\n    setState({\r\n      ...state,\r\n      step: 'preview',\r\n      file,\r\n      validRows: result.validRows,\r\n      errors: result.errors,\r\n      totalRows: result.totalRows,\r\n      newCategories\r\n    });\r\n  };\r\n\r\n  const handleFileInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      handleFileSelect(file);\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    setIsDragging(false);\r\n\r\n    const file = e.dataTransfer.files[0];\r\n    if (file) {\r\n      handleFileSelect(file);\r\n    }\r\n  };\r\n\r\n  const handleDragOver = (e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    setIsDragging(true);\r\n  };\r\n\r\n  const handleDragLeave = () => {\r\n    setIsDragging(false);\r\n  };\r\n\r\n  const convertCSVRowToProduct = (row: CSVProductRow): ProductFormData => {\r\n    let creationDate = new Date();\r\n\r\n    // Accept any date format - try multiple parsing approaches\r\n    const dateValue = row['Creation Date'];\r\n    if (dateValue) {\r\n      // Try DD/MM/YYYY format first\r\n      const ddmmyyyyMatch = dateValue.match(/^(\\d{1,2})\\/(\\d{1,2})\\/(\\d{4})$/);\r\n      if (ddmmyyyyMatch) {\r\n        const [, day, month, year] = ddmmyyyyMatch;\r\n        creationDate = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));\r\n      } else {\r\n        // Try standard date parsing for other formats\r\n        const parsedDate = new Date(dateValue);\r\n        if (!isNaN(parsedDate.getTime())) {\r\n          creationDate = parsedDate;\r\n        }\r\n      }\r\n    }\r\n\r\n    return {\r\n      name: row['Product Name'],\r\n      category: row['Category'] || '',\r\n      description: row['Description'] || '',\r\n      supplier: row['Supplier'] || '',\r\n      quantity: row['Initial Stock'] ? Number(row['Initial Stock']) : 0,\r\n      minimumStock: row['Minimum Stock Level'] ? Number(row['Minimum Stock Level']) : undefined,\r\n      costPrice: row['Cost Price'] ? Number(row['Cost Price']) : undefined,\r\n      sellingPrice: row['Selling Price'] ? Number(row['Selling Price']) : undefined,\r\n      manufacturerBarcode: row['Manufacturer Barcode'] || '',\r\n      imageFile: null,\r\n      imageUrl: null,\r\n      createdAt: creationDate\r\n    };\r\n  };\r\n\r\n  const handleConfirmUpload = async () => {\r\n    setState(prev => ({ ...prev, step: 'uploading', uploadProgress: 0, currentProductIndex: 0 }));\r\n    setIsUploading(true);\r\n\r\n    const products = state.validRows.map(convertCSVRowToProduct);\r\n\r\n    try {\r\n      // Use the bulk upload function directly with progress tracking\r\n      await bulkCreateProducts(products, (current, total) => {\r\n        const progress = Math.round((current / total) * 100);\r\n        setState(prev => ({\r\n          ...prev,\r\n          uploadProgress: progress,\r\n          currentProductIndex: current,\r\n          successCount: current,\r\n          failureCount: 0\r\n        }));\r\n      });\r\n\r\n      setState(prev => ({\r\n        ...prev,\r\n        step: 'complete',\r\n        uploadProgress: 100,\r\n        successCount: products.length,\r\n        failureCount: 0,\r\n        currentProductIndex: products.length\r\n      }));\r\n    } catch (error) {\r\n      console.error('Bulk upload failed:', error);\r\n      setState(prev => ({\r\n        ...prev,\r\n        step: 'complete',\r\n        uploadProgress: 100,\r\n        successCount: 0,\r\n        failureCount: products.length,\r\n        currentProductIndex: products.length\r\n      }));\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    // Prevent closing during upload\r\n    if (isUploading) return;\r\n\r\n    // Check if we just completed a successful upload\r\n    const wasSuccessfulUpload = state.step === 'complete' && state.successCount > 0;\r\n\r\n    setState({\r\n      step: 'select',\r\n      file: null,\r\n      validRows: [],\r\n      errors: [],\r\n      totalRows: 0,\r\n      uploadProgress: 0,\r\n      successCount: 0,\r\n      failureCount: 0,\r\n      newCategories: [],\r\n      currentProductIndex: 0\r\n    });\r\n\r\n    onOpenChange(false);\r\n\r\n    // Trigger refresh if upload was successful\r\n    if (wasSuccessfulUpload) {\r\n      // Small delay to ensure dialog closes first\r\n      setTimeout(() => {\r\n        window.location.reload();\r\n      }, 100);\r\n    }\r\n  };\r\n\r\n  const handleOpenChange = (newOpen: boolean) => {\r\n    // Prevent dialog from closing during upload\r\n    if (!isUploading) {\r\n      onOpenChange(newOpen);\r\n    }\r\n  };\r\n\r\n  const renderFileSelection = () => (\r\n    <div className=\"space-y-4\">\r\n      <div\r\n        className={cn(\r\n          \"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\",\r\n          isDragging ? \"border-blue-500 bg-blue-50\" : \"border-gray-300 hover:border-gray-400\"\r\n        )}\r\n        onDrop={handleDrop}\r\n        onDragOver={handleDragOver}\r\n        onDragLeave={handleDragLeave}\r\n        onClick={() => fileInputRef.current?.click()}\r\n      >\r\n        <Upload className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\r\n        <p className=\"text-lg font-medium text-gray-900 mb-2\">\r\n          Upload CSV File\r\n        </p>\r\n        <p className=\"text-sm text-gray-500\">\r\n          Drag and drop your CSV file here, or click to browse\r\n        </p>\r\n        <p className=\"text-xs text-gray-400 mt-2\">\r\n          Supports all date formats | Accepts negative values | Use quotes for fields with commas\r\n        </p>\r\n      </div>\r\n\r\n      <input\r\n        ref={fileInputRef}\r\n        type=\"file\"\r\n        accept=\".csv\"\r\n        onChange={handleFileInputChange}\r\n        className=\"hidden\"\r\n      />\r\n    </div>\r\n  );\r\n\r\n  const renderPreview = () => (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"grid grid-cols-3 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-2xl font-bold text-green-600\">{state.validRows.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Valid products</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-2xl font-bold text-red-600\">{state.errors.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Errors found</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-2xl font-bold text-blue-600\">{state.totalRows}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Total rows</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {state.newCategories.length > 0 && (\r\n        <Alert>\r\n          <Plus className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            <div className=\"space-y-2\">\r\n              <p>The following {state.newCategories.length} new categories will be created:</p>\r\n              <div className=\"flex flex-wrap gap-1\">\r\n                {state.newCategories.map((category, index) => (\r\n                  <Badge key={index} variant=\"outline\" className=\"text-xs\">\r\n                    {category}\r\n                  </Badge>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {state.errors.length > 0 && (\r\n        <Alert variant=\"destructive\">\r\n          <AlertCircle className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            {state.errors.length} rows have errors and will be skipped.\r\n            <Button\r\n              variant=\"link\"\r\n              className=\"p-0 h-auto ml-2\"\r\n              onClick={() => generateErrorLogCSV(state.errors)}\r\n            >\r\n              <Download className=\"h-3 w-3 mr-1\" />\r\n              Download error log\r\n            </Button>\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      <div className=\"flex justify-end space-x-2\">\r\n        <Button variant=\"outline\" onClick={() => setState(prev => ({ ...prev, step: 'select' }))}>\r\n          Back\r\n        </Button>\r\n        <Button\r\n          onClick={handleConfirmUpload}\r\n          disabled={state.validRows.length === 0}\r\n        >\r\n          Upload {state.validRows.length} Products\r\n          {state.newCategories.length > 0 && ` & Create ${state.newCategories.length} Categories`}\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderUploading = () => (\r\n    <BulkOperationProgress\r\n      title=\"Uploading Products...\"\r\n      currentCount={state.currentProductIndex}\r\n      totalCount={state.validRows.length}\r\n      status=\"processing\"\r\n    />\r\n  );\r\n\r\n  const renderComplete = () => (\r\n    <div className=\"space-y-4\">\r\n      <BulkOperationProgress\r\n        title=\"Upload Complete!\"\r\n        currentCount={state.currentProductIndex}\r\n        totalCount={state.validRows.length}\r\n        status={state.failureCount > 0 ? 'failed' : 'completed'}\r\n        successCount={state.successCount}\r\n        failureCount={state.failureCount}\r\n      />\r\n      <div className=\"flex justify-center\">\r\n        <Button onClick={handleClose}>Close</Button>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleOpenChange}>\r\n      <DialogContent className=\"sm:max-w-[500px] pointer-events-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <FileText className=\"h-5 w-5\" />\r\n            Upload Products via CSV\r\n          </DialogTitle>\r\n          <DialogDescription>\r\n            Upload multiple products at once using a CSV file (DD/MM/YYYY date format)\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        {state.step === 'select' && renderFileSelection()}\r\n        {state.step === 'preview' && renderPreview()}\r\n        {state.step === 'uploading' && renderUploading()}\r\n        {state.step === 'complete' && renderComplete()}\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default CSVUploadDialog;\r\n"],"names":[],"mappings":"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","ignoreList":[1]}