module.exports=[2026,a=>{"use strict";let b=(0,a.i(564375).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],2026)},957143,a=>{"use strict";let b=(0,a.i(564375).default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);a.s(["Search",()=>b],957143)},818703,a=>{"use strict";let b=(0,a.i(564375).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],818703)},691098,a=>{"use strict";let b=(0,a.i(564375).default)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);a.s(["CreditCard",()=>b],691098)},886586,a=>{"use strict";let b=(0,a.i(564375).default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);a.s(["MessageSquare",()=>b],886586)},223028,a=>{"use strict";let b=(0,a.i(564375).default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);a.s(["Users",()=>b],223028)},120327,a=>{"use strict";let b=(0,a.i(564375).default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);a.s(["Filter",()=>b],120327)},352519,a=>{"use strict";let b=(0,a.i(564375).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);a.s(["DollarSign",()=>b],352519)},199105,a=>a.a(async(b,c)=>{try{var d=a.i(150848),e=b([d]);async function f(a){try{return await d.db.activityHistory.create({data:{userId:a.userId,locationId:a.locationId,activityType:a.activityType,module:a.module,entityType:a.entityType,entityId:a.entityId||null,entityName:a.entityName,description:a.description,metadata:a.metadata||null,profileId:a.profileId||null,profileName:a.profileName||null}}),{success:!0}}catch(a){return console.error("Error logging activity:",a),{success:!1,error:a.message}}}async function g(a,b,c=1,e=20,f){try{let g={locationId:a,userId:b};if(f&&(f.activityType&&"ALL"!==f.activityType&&(g.activityType=f.activityType),f.module&&"ALL"!==f.module&&(g.module=f.module),f.search&&(g.OR=[{entityName:{contains:f.search,mode:"insensitive"}},{description:{contains:f.search,mode:"insensitive"}}]),f.dateFrom||f.dateTo)&&(g.createdAt={},f.dateFrom&&(g.createdAt.gte=new Date(f.dateFrom)),f.dateTo)){let a=new Date(f.dateTo);a.setHours(23,59,59,999),g.createdAt.lte=a}let[h,i]=await Promise.all([d.db.activityHistory.findMany({where:g,skip:(c-1)*e,take:e,orderBy:{createdAt:"desc"}}),d.db.activityHistory.count({where:g})]);return{success:!0,data:{activities:h.map(a=>({...a,created_at:a.createdAt.toISOString(),activity_type:a.activityType,location_id:a.locationId,user_id:a.userId,entity_type:a.entityType,entity_id:a.entityId,entity_name:a.entityName,profile_id:a.profileId,profile_name:a.profileName})),count:i}}}catch(a){return console.error("Error fetching activity history:",a),{success:!1,error:a.message}}}[d]=e.then?(await e)():e,a.s(["getActivityHistoryAction",()=>g,"logActivityAction",()=>f]),c()}catch(a){c(a)}},!1),411418,a=>a.a(async(b,c)=>{try{var d=a.i(531811),e=b([d]);[d]=e.then?(await e)():e,a.s(["useCurrentUser",0,()=>{let{user:a}=(0,d.useAuth)();return{userId:a?.id}}]),c()}catch(a){c(a)}},!1),199987,a=>{"use strict";let b=(0,a.i(564375).default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);a.s(["FileText",()=>b],199987)},852741,(a,b,c)=>{let d=Error("Could not parse module '[project]/src/app/actions/products.ts'\n\n'import', and 'export' cannot be used outside of module code");throw d.code="MODULE_UNPARSABLE",d},121677,a=>{"use strict";a.s(["clearInventoryCaches",0,a=>{}])},482331,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(224993),f=a.i(964889),g=a.i(500885),h=a.i(121677),i=a.i(852741),j=b([e,f,g]);[e,f,g]=j.then?(await j)():j,a.s(["useProducts",0,(a,b=50)=>{let[c,j]=(0,d.useState)([]),[k,l]=(0,d.useState)(1),[m,n]=(0,d.useState)(b),[o,p]=(0,d.useState)(0),[q,r]=(0,d.useState)(!1),{settings:s}=(0,e.useBusinessSettings)(),{currentBusiness:t}=(0,f.useBusiness)(),u=(0,g.useQueryClient)(),[v,w]=(0,d.useState)({search:"",category:"all",stockStatus:"all"}),[x,y]=(0,d.useState)(null),z=(0,d.useCallback)(a=>{if(a.search!==v.search){r(!0),x&&clearTimeout(x);let a=setTimeout(()=>{r(!1)},600);y(a)}w(a)},[v.search,x]),A=(0,d.useCallback)(async()=>{if(!a||!t)return{products:[],count:0};try{return await (0,i.getProductsAction)({userId:a,businessId:t.id,page:k,pageSize:m,search:v.search,category:"all"===v.category?void 0:v.category,stockStatus:v.stockStatus})}catch(a){return console.error("Error loading products from server action:",a),{products:[],count:0}}},[a,t?.id,k,m,v.search,v.category,v.stockStatus]),B=(0,d.useMemo)(()=>["products",a,t?.id],[a,t?.id]),C=(0,d.useMemo)(()=>[...B,k,m,v.search,v.category,v.stockStatus],[B,k,m,v.search,v.category,v.stockStatus]),{data:D,isLoading:E,isFetching:F,refetch:G}=(0,g.useQuery)({queryKey:C,queryFn:A,enabled:!!a&&!!t?.id,staleTime:3e4,gcTime:18e5,refetchOnWindowFocus:!0,refetchOnReconnect:!0});(0,d.useEffect)(()=>{D&&(j(D.products),p(D.count))},[D]);let H=E&&!D&&!q,I=async b=>{try{if(!a)return null;return console.warn("Image upload redirecting to server action (TODO)"),null}catch(a){return console.error("Error in uploadProductImage:",a),null}},J=async b=>{try{if(!a||!t)return null;let c=await (0,i.createProductAction)({...b,userId:a,businessId:t.id});if(!c)return null;return j(a=>[c,...a]),p(a=>a+1),u.invalidateQueries({queryKey:B}),(0,h.clearInventoryCaches)(u),c}catch(a){return console.error("Error creating product:",a),null}},K=async(b,c,d,e=!1,f,g,j,k)=>{try{if(!a||!t)return!1;let g=c.imageUrl;if(d&&(g=await I(d)),!await (0,i.updateProductAction)(b,{...c,imageUrl:g,userId:a,businessId:t.id,isFromSale:e,customChangeReason:f,referenceId:j}))return!1;return u.invalidateQueries({queryKey:B}),(0,h.clearInventoryCaches)(u),!0}catch(a){return console.error("Error updating product:",a),!1}},L=async b=>{try{if(!a)return!1;if(await (0,i.deleteProductAction)(b))return u.invalidateQueries({queryKey:B}),(0,h.clearInventoryCaches)(u),!0;return!1}catch(a){return console.error("Error deleting product:",a),!1}},M=async(b,c,d,e,f,g)=>{try{if(!a||!t)return!1;let c=await (0,i.updateProductsBulkAction)(b.map(a=>({id:a.id,updated:a.updated})),t.id);return c&&(u.invalidateQueries({queryKey:B}),(0,h.clearInventoryCaches)(u)),c}catch(a){return console.error("Error in bulk update:",a),!1}};return{products:c,isLoading:H,loadProducts:A,page:k,setPage:l,pageSize:m,setPageSize:n,totalCount:o,createProduct:J,updateProduct:K,updateProductsBulk:M,deleteProduct:L,uploadProductImage:I,refetch:G,isFetching:F,filters:v,setFilters:z}}]),c()}catch(a){c(a)}},!1),809694,a=>{"use strict";var b=a.i(490988),c=a.i(873492);function d(a,d,e){let f=(0,c.toDate)(a,e?.in);return isNaN(d)?(0,b.constructFrom)(e?.in||a,NaN):(d&&f.setDate(f.getDate()+d),f)}a.s(["addDays",()=>d])},445475,a=>{"use strict";var b=a.i(490988),c=a.i(873492);function d(a,d,e){let f=(0,c.toDate)(a,e?.in);if(isNaN(d))return(0,b.constructFrom)(e?.in||a,NaN);if(!d)return f;let g=f.getDate(),h=(0,b.constructFrom)(e?.in||a,f.getTime());return(h.setMonth(f.getMonth()+d+1,0),g>=h.getDate())?h:(f.setFullYear(h.getFullYear(),h.getMonth(),g),f)}a.s(["addMonths",()=>d])},460716,a=>{"use strict";var b=a.i(445475);function c(a,c,d){return(0,b.addMonths)(a,-c,d)}a.s(["subMonths",()=>c])},671117,a=>a.a(async(b,c)=>{try{let b=await a.y("@radix-ui/react-tabs-b68482203efb9b9e");a.n(b),c()}catch(a){c(a)}},!0),148608,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(671117),g=a.i(799856),h=b([f,g]);[f,g]=h.then?(await h)():h;let i=f.Root,j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.List,{ref:c,className:(0,g.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...b}));j.displayName=f.List.displayName;let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.Trigger,{ref:c,className:(0,g.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...b}));k.displayName=f.Trigger.displayName;let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.Content,{ref:c,className:(0,g.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...b}));l.displayName=f.Content.displayName,a.s(["Tabs",()=>i,"TabsContent",()=>l,"TabsList",()=>j,"TabsTrigger",()=>k]),c()}catch(a){c(a)}},!1),284177,a=>{"use strict";var b=a.i(809694);function c(a,c,d){return(0,b.addDays)(a,-c,d)}a.s(["subDays",()=>c])},778856,a=>{"use strict";let b=(0,a.i(564375).default)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);a.s(["Wallet",()=>b],778856)},248586,a=>{"use strict";let b=(0,a.i(564375).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],248586)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__fd632745._.js.map