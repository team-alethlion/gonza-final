module.exports=[292e3,a=>{"use strict";let b=(0,a.i(170106).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],292e3)},816201,a=>{"use strict";let b=(0,a.i(170106).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],816201)},732860,a=>{"use strict";let b=(0,a.i(170106).default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);a.s(["ArrowRight",()=>b],732860)},862722,a=>{"use strict";let b=(0,a.i(170106).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],862722)},463535,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(357999),e=a.i(665967),f=a.i(816201),g=a.i(862722);let h=(0,a.i(170106).default)("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);var i=a.i(292e3),j=a.i(682478),k=a.i(732860);a.s(["default",0,()=>{let[a]=(0,d.useSearchParams)(),l=(0,e.useNavigate)(),[m,n]=(0,c.useState)("loading"),[o,p]=(0,c.useState)("Verifying your payment with PesaPal..."),[q,r]=(0,c.useState)(null),s=a.get("OrderTrackingId"),t=a.get("purchase_id");return(0,c.useEffect)(()=>{(async()=>{if(!s){console.error("[PaymentCallback] No OrderTrackingId found in URL parameters."),n("failed"),p("Missing payment reference. We couldn't track this transaction.");return}try{console.log("--- [PaymentCallback] Initiating Verification ---"),console.log("Tracking ID:",s),console.log("Purchase ID:",t),n("loading");let a=await fetch("/api/verify-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderTrackingId:s,purchaseId:t})}),b=await a.json();if(!a.ok)throw console.error("[PaymentCallback] HTTP error:",a.status),Error(`HTTP ${a.status}`);console.log("[PaymentCallback] Backend Response:",b);let c=b.is_subscription;if(console.log("[PaymentCallback] Function Result:",b),!1===b.success){console.error("[PaymentCallback] Business Error:",b.error),n("failed"),p(b.error||"Verification failed on the server.");return}let d="completed"===b.payment_status;r(b),console.log("Result Analysis:",{isCompleted:d,isSubscription:c,value:b.value_added}),d?(n("success"),p(`Access Restored! Your subscription has been extended by ${b.value_added} days.`),setTimeout(()=>{console.log("[PaymentCallback] Auto-redirecting to dashboard"),l("/")},4e3)):"failed"===b.payment_status?(n("failed"),p("The transaction was declined by PesaPal. Please try again.")):"cancelled"===b.payment_status?(n("cancelled"),p("The payment process was cancelled.")):(n("loading"),p("Your payment is still being processed by the network. Please wait..."),setTimeout(()=>{console.log("[PaymentCallback] Refreshing to check status again..."),window.location.reload()},6e3))}catch(a){console.error("[PaymentCallback] Unexpected Error:",a),n("failed"),p(a.message||"An unexpected error occurred while verifying your payment.")}})()},[s,t,l]),(0,b.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-[#fafafa] p-6",children:(0,b.jsxs)("div",{className:"w-full max-w-md animate-in fade-in slide-in-from-bottom-4 duration-1000",children:[(0,b.jsxs)("div",{className:"bg-white border border-border/40 shadow-[0_32px_64px_-12px_rgba(0,0,0,0.06)] rounded-3xl p-10 text-center relative overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600"}),(0,b.jsxs)("div",{className:"mb-10 relative",children:["loading"===m&&(0,b.jsxs)("div",{className:"w-24 h-24 bg-blue-50/50 text-blue-600 rounded-3xl flex items-center justify-center mx-auto border border-blue-100/50 relative overflow-hidden",children:[(0,b.jsx)(h,{className:"w-10 h-10 animate-spin relative z-10"}),(0,b.jsx)("div",{className:"absolute inset-0 bg-blue-100/20 animate-pulse"})]}),"success"===m&&(0,b.jsx)("div",{className:"w-24 h-24 bg-green-50/50 text-green-600 rounded-3xl flex items-center justify-center mx-auto border border-green-100/50 rotate-3 scale-110 duration-500",children:(0,b.jsx)(f.CheckCircle,{className:"w-12 h-12 -rotate-3"})}),"failed"===m&&(0,b.jsx)("div",{className:"w-24 h-24 bg-red-50/50 text-red-600 rounded-3xl flex items-center justify-center mx-auto border border-red-100/50 rotate-3 animate-in shake-in",children:(0,b.jsx)(g.XCircle,{className:"w-12 h-12 -rotate-3"})}),"cancelled"===m&&(0,b.jsx)("div",{className:"w-24 h-24 bg-amber-50/50 text-amber-600 rounded-3xl flex items-center justify-center mx-auto border border-amber-100/50 rotate-3",children:(0,b.jsx)(i.AlertCircle,{className:"w-12 h-12 -rotate-3"})})]}),(0,b.jsxs)("h1",{className:"text-2xl font-bold text-foreground mb-4 font-inter tracking-tight",children:["loading"===m&&"Verifying Payment","success"===m&&"Payment Successful","failed"===m&&"Transaction Failed","cancelled"===m&&"Payment Cancelled"]}),(0,b.jsx)("p",{className:"text-[15px] text-muted-foreground leading-relaxed mb-10 px-4",children:o}),"success"===m&&q&&(0,b.jsxs)("div",{className:"bg-[#f8faff] rounded-2xl p-6 border border-blue-50/50 mb-10 text-left animate-in slide-in-from-bottom-2 duration-700",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-widest text-blue-600/60",children:"Subscription Details"}),(0,b.jsx)(j.Rocket,{className:"w-3 h-3 text-blue-500"})]}),(0,b.jsxs)("div",{className:"flex items-end justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-foreground font-bold text-lg",children:[q.value_added," Days Access"]}),(0,b.jsx)("p",{className:"text-[10px] uppercase tracking-wider font-medium text-muted-foreground/80",children:"Value Added to Account"})]}),(0,b.jsx)("div",{className:"text-right",children:(0,b.jsx)("p",{className:"text-foreground/40 font-mono text-[10px] truncate max-w-[100px]",children:q.tracking_id})})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:["loading"!==m&&(0,b.jsxs)("button",{onClick:()=>l("/"),className:"group relative w-full h-14 bg-foreground text-background font-bold text-[12px] uppercase tracking-widest rounded-2xl transition-all hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center gap-2 overflow-hidden shadow-lg shadow-black/5",children:[(0,b.jsxs)("span",{className:"relative z-10 flex items-center gap-2",children:["Continue to Dashboard",(0,b.jsx)(k.ArrowRight,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]}),(0,b.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity"})]}),"loading"===m&&(0,b.jsx)("div",{className:"py-4",children:(0,b.jsx)("p",{className:"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-medium opacity-60 animate-pulse",children:"Secured by PesaPal Integrated"})})]})]}),(0,b.jsxs)("p",{className:"mt-8 text-center text-[11px] text-muted-foreground/40 font-medium",children:["Â© ",new Date().getFullYear()," Gonza Systems. All rights reserved."]})]})})}],463535)}];

//# sourceMappingURL=_66755281._.js.map