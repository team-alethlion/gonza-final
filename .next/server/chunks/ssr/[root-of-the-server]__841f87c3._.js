module.exports=[818703,a=>{"use strict";let b=(0,a.i(564375).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],818703)},499239,a=>{"use strict";let b=(0,a.i(564375).default)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);a.s(["Package",()=>b],499239)},2026,a=>{"use strict";let b=(0,a.i(564375).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],2026)},111628,a=>a.a(async(b,c)=>{try{let b=await a.y("@radix-ui/react-switch-0610ba11c925567c");a.n(b),c()}catch(a){c(a)}},!0),366736,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(111628),g=a.i(799856),h=b([f,g]);[f,g]=h.then?(await h)():h;let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.Root,{className:(0,g.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...b,ref:c,children:(0,d.jsx)(f.Thumb,{className:(0,g.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));i.displayName=f.Root.displayName,a.s(["Switch",()=>i]),c()}catch(a){c(a)}},!1),126741,a=>{"use strict";let b=(0,a.i(564375).default)("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);a.s(["Printer",()=>b],126741)},852741,(a,b,c)=>{let d=Error("Could not parse module '[project]/src/app/actions/products.ts'\n\n'import', and 'export' cannot be used outside of module code");throw d.code="MODULE_UNPARSABLE",d},121677,a=>{"use strict";a.s(["clearInventoryCaches",0,a=>{}])},482331,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(224993),f=a.i(964889),g=a.i(500885),h=a.i(121677),i=a.i(852741),j=b([e,f,g]);[e,f,g]=j.then?(await j)():j,a.s(["useProducts",0,(a,b=50)=>{let[c,j]=(0,d.useState)([]),[k,l]=(0,d.useState)(1),[m,n]=(0,d.useState)(b),[o,p]=(0,d.useState)(0),[q,r]=(0,d.useState)(!1),{settings:s}=(0,e.useBusinessSettings)(),{currentBusiness:t}=(0,f.useBusiness)(),u=(0,g.useQueryClient)(),[v,w]=(0,d.useState)({search:"",category:"all",stockStatus:"all"}),[x,y]=(0,d.useState)(null),z=(0,d.useCallback)(a=>{if(a.search!==v.search){r(!0),x&&clearTimeout(x);let a=setTimeout(()=>{r(!1)},600);y(a)}w(a)},[v.search,x]),A=(0,d.useCallback)(async()=>{if(!a||!t)return{products:[],count:0};try{return await (0,i.getProductsAction)({userId:a,businessId:t.id,page:k,pageSize:m,search:v.search,category:"all"===v.category?void 0:v.category,stockStatus:v.stockStatus})}catch(a){return console.error("Error loading products from server action:",a),{products:[],count:0}}},[a,t?.id,k,m,v.search,v.category,v.stockStatus]),B=(0,d.useMemo)(()=>["products",a,t?.id],[a,t?.id]),C=(0,d.useMemo)(()=>[...B,k,m,v.search,v.category,v.stockStatus],[B,k,m,v.search,v.category,v.stockStatus]),{data:D,isLoading:E,isFetching:F,refetch:G}=(0,g.useQuery)({queryKey:C,queryFn:A,enabled:!!a&&!!t?.id,staleTime:3e4,gcTime:18e5,refetchOnWindowFocus:!0,refetchOnReconnect:!0});(0,d.useEffect)(()=>{D&&(j(D.products),p(D.count))},[D]);let H=E&&!D&&!q,I=async b=>{try{if(!a)return null;return console.warn("Image upload redirecting to server action (TODO)"),null}catch(a){return console.error("Error in uploadProductImage:",a),null}},J=async b=>{try{if(!a||!t)return null;let c=await (0,i.createProductAction)({...b,userId:a,businessId:t.id});if(!c)return null;return j(a=>[c,...a]),p(a=>a+1),u.invalidateQueries({queryKey:B}),(0,h.clearInventoryCaches)(u),c}catch(a){return console.error("Error creating product:",a),null}},K=async(b,c,d,e=!1,f,g,j,k)=>{try{if(!a||!t)return!1;let g=c.imageUrl;if(d&&(g=await I(d)),!await (0,i.updateProductAction)(b,{...c,imageUrl:g,userId:a,businessId:t.id,isFromSale:e,customChangeReason:f,referenceId:j}))return!1;return u.invalidateQueries({queryKey:B}),(0,h.clearInventoryCaches)(u),!0}catch(a){return console.error("Error updating product:",a),!1}},L=async b=>{try{if(!a)return!1;if(await (0,i.deleteProductAction)(b))return u.invalidateQueries({queryKey:B}),(0,h.clearInventoryCaches)(u),!0;return!1}catch(a){return console.error("Error deleting product:",a),!1}},M=async(b,c,d,e,f,g)=>{try{if(!a||!t)return!1;let c=await (0,i.updateProductsBulkAction)(b.map(a=>({id:a.id,updated:a.updated})),t.id);return c&&(u.invalidateQueries({queryKey:B}),(0,h.clearInventoryCaches)(u)),c}catch(a){return console.error("Error in bulk update:",a),!1}};return{products:c,isLoading:H,loadProducts:A,page:k,setPage:l,pageSize:m,setPageSize:n,totalCount:o,createProduct:J,updateProduct:K,updateProductsBulk:M,deleteProduct:L,uploadProductImage:I,refetch:G,isFetching:F,filters:v,setFilters:z}}]),c()}catch(a){c(a)}},!1),506766,a=>{"use strict";let b=(0,a.i(564375).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);a.s(["RefreshCw",()=>b],506766)},369773,a=>{"use strict";let b=(0,a.i(564375).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);a.s(["AlertTriangle",()=>b],369773)},142499,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(964889),f=a.i(942348),g=b([e,f]);[e,f]=g.then?(await g)():g,a.s(["useStockHistory",0,(a,b)=>{let[c,g]=(0,d.useState)([]),[h,i]=(0,d.useState)(!0),{currentBusiness:j}=(0,e.useBusiness)(),k=(0,d.useCallback)(async()=>{if(!a||!j){g([]),i(!1);return}try{i(!0);let a=await (0,f.getStockHistoryAction)(j.id,b);if(!a.success||!a.data)throw Error(a.error||"Failed to fetch stock history");let c=a.data.map(a=>({id:a.id,productId:a.productId,oldQuantity:a.oldQuantity,newQuantity:a.newQuantity,changeReason:a.changeReason,createdAt:new Date(a.createdAt),referenceId:a.referenceId,receiptNumber:a.receiptNumber,product:a.product}));g(c)}catch(a){console.error("Error loading stock history:",a)}finally{i(!1)}},[a,j?.id,b]);(0,d.useEffect)(()=>{k()},[k]);let l=async(b,c,d,e,g,h,i,l)=>{try{if(!a||!j)return!1;let m=l?`[${l}] | ${e}`:e,n=await (0,f.createStockHistoryAction)({userId:a,locationId:j.id,productId:b,previousQuantity:c,newQuantity:d,changeReason:m,referenceId:g,receiptNumber:i,createdAt:h?.toISOString()});if(!n.success)return console.error("Error creating stock history entry:",n.error),!1;return await k(),!0}catch(a){return console.error("Error creating stock history:",a),!1}},m=async a=>{try{if(!j)return!1;let b=await (0,f.deleteStockHistoryEntriesByReferenceAction)(a,j.id);if(!b.success)throw Error(b.error);return await k(),!0}catch(a){return console.error("Error deleting stock history entries:",a),!1}},n=async a=>{try{if(!j)return!1;let b=await (0,f.recalculateStockChainAction)(a,j.id);if(!b.success)throw Error(b.error);return await k(),!0}catch(a){return console.error("Error recalculating stock chain:",a),!1}},o=async(a,b)=>{try{if(!j)return!1;let c=await (0,f.updateStockHistoryDatesByReferenceAction)(a,j.id,b.toISOString());if(!c.success)throw Error(c.error);return await k(),!0}catch(a){return console.error("Error updating stock history dates:",a),!1}},p=async a=>{try{if(!j)return{repaired:0,failed:0};let a=await (0,f.repairStockChainsAction)(j.id);if(a.success&&a.data)return a.data;return{repaired:0,failed:0}}catch(a){return console.error("Error repairing all chains:",a),{repaired:0,failed:0}}},q=async a=>{try{if(!j)return[];let a=await (0,f.getStockRepairsPreviewAction)(j.id);if(a.success&&a.data)return a.data;return[]}catch(a){return console.error("Error previewing repairs:",a),[]}};return{stockHistory:c,isLoading:h,createStockHistoryEntry:l,deleteMultipleStockHistoryEntriesByReference:m,recalculateStockChain:n,updateStockHistoryDatesBySaleId:o,repairAllStockChains:p,previewStockChainRepairs:q,refreshHistory:k}}]),c()}catch(a){c(a)}},!1),942348,a=>a.a(async(b,c)=>{try{var d=a.i(150848),e=a.i(348287),f=b([d]);async function g(a,b){try{let c={locationId:a};b&&(c.productId=b);let e=await d.db.productHistory.findMany({where:c,include:{product:{select:{name:!0,costPrice:!0,sellingPrice:!0,sku:!0}}},orderBy:[{createdAt:"desc"},{id:"desc"}]});return{success:!0,data:e.map(a=>({id:a.id,productId:a.productId,oldQuantity:a.previousQuantity,newQuantity:a.newQuantity,changeReason:a.changeReason,createdAt:a.createdAt.toISOString(),referenceId:a.referenceId,receiptNumber:a.receiptNumber,product:a.product?{name:a.product.name,costPrice:a.product.costPrice,sellingPrice:a.product.sellingPrice,itemNumber:a.product.sku}:void 0}))}}catch(a){return console.error("Error fetching stock history:",a),{success:!1,error:a.message}}}async function h(a){try{let b=await d.db.$transaction(async b=>{let c=await b.productHistory.create({data:{userId:a.userId,locationId:a.locationId,productId:a.productId,previousQuantity:a.previousQuantity,newQuantity:a.newQuantity,changeReason:a.changeReason,referenceId:a.referenceId||null,receiptNumber:a.receiptNumber||null,createdAt:a.createdAt?new Date(a.createdAt):void 0}});return await b.product.update({where:{id:a.productId},data:{stock:a.newQuantity}}),c});return(0,e.revalidatePath)("/inventory"),{success:!0,data:b}}catch(a){return console.error("Error creating stock history:",a),{success:!1,error:a.message}}}async function i(a,b){try{let c=await d.db.$transaction(async c=>{let d=await c.productHistory.findMany({where:{productId:a,locationId:b},orderBy:[{createdAt:"asc"},{id:"asc"}]});if(0===d.length)return{finalQuantity:0};let e=0,f=[];for(let a of d){let b=a.newQuantity-a.previousQuantity,d=e,g=d+b;(a.previousQuantity!==d||a.newQuantity!==g)&&f.push(c.productHistory.update({where:{id:a.id},data:{previousQuantity:d,newQuantity:g}})),e=g}return f.length>0&&await Promise.all(f),await c.product.update({where:{id:a},data:{stock:e}}),{finalQuantity:e}});return(0,e.revalidatePath)("/inventory"),{success:!0,data:c}}catch(a){return console.error("Error recalculating stock chain:",a),{success:!1,error:a.message}}}async function j(a,b){try{let c=await d.db.$transaction(async c=>{let d=await c.productHistory.findMany({where:{referenceId:a,locationId:b},select:{productId:!0}}),e=[...new Set(d.map(a=>a.productId))];for(let d of(await c.productHistory.deleteMany({where:{referenceId:a,locationId:b}}),e))await l(c,d,b);return{affectedProducts:e.length}});return(0,e.revalidatePath)("/inventory"),{success:!0,data:c}}catch(a){return console.error("Error deleting stock history by reference:",a),{success:!1,error:a.message}}}async function k(a,b,c){try{let f=await d.db.productHistory.updateMany({where:{referenceId:a,locationId:b},data:{createdAt:new Date(c)}});return(0,e.revalidatePath)("/inventory"),{success:!0,data:f}}catch(a){return console.error("Error updating stock history dates:",a),{success:!1,error:a.message}}}async function l(a,b,c){let d=await a.productHistory.findMany({where:{productId:b,locationId:c},orderBy:[{createdAt:"asc"},{id:"asc"}]}),e=0;for(let b of d){let c=b.newQuantity-b.previousQuantity,d=e,f=d+c;(b.previousQuantity!==d||b.newQuantity!==f)&&await a.productHistory.update({where:{id:b.id},data:{previousQuantity:d,newQuantity:f}}),e=f}await a.product.update({where:{id:b},data:{stock:e}})}async function m(a,b){try{let c=await d.db.requisition.findMany({where:{userId:a,locationId:b},orderBy:{createdAt:"desc"}});return{success:!0,data:c.map(a=>({id:a.id,userId:a.userId,locationId:a.branchId,requisitionNumber:a.requisitionNumber,title:a.title||"",items:a.items||[],notes:a.notes,status:a.status,createdAt:a.createdAt.toISOString(),updatedAt:a.updatedAt.toISOString()}))}}catch(a){return console.error("Error fetching requisitions:",a),{success:!1,error:a.message}}}async function n(a){try{let b=await d.db.requisition.create({data:{userId:a.userId,branchId:a.locationId,requisitionNumber:a.requisitionNumber,title:a.title,items:a.items,notes:a.notes,status:a.status||"draft"}});return(0,e.revalidatePath)("/requisitions"),{success:!0,data:{id:b.id,userId:b.userId,locationId:b.branchId,requisitionNumber:b.requisitionNumber,title:b.title||"",items:b.items||[],notes:b.notes,status:b.status,createdAt:b.createdAt.toISOString(),updatedAt:b.updatedAt.toISOString()}}}catch(a){return console.error("Error creating requisition:",a),{success:!1,error:a.message}}}async function o(a,b,c){try{let f=await d.db.requisition.update({where:{id:a,userId:b},data:{title:c.title,items:c.items,notes:c.notes,status:c.status,updatedAt:new Date}});return(0,e.revalidatePath)("/requisitions"),{success:!0,data:{id:f.id,userId:f.userId,locationId:f.branchId,requisitionNumber:f.requisitionNumber,title:f.title||"",items:f.items||[],notes:f.notes,status:f.status,createdAt:f.createdAt.toISOString(),updatedAt:f.updatedAt.toISOString()}}}catch(a){return console.error("Error updating requisition:",a),{success:!1,error:a.message}}}async function p(a,b){try{return await d.db.requisition.delete({where:{id:a,userId:b}}),(0,e.revalidatePath)("/requisitions"),{success:!0}}catch(a){return console.error("Error deleting requisition:",a),{success:!1,error:a.message}}}async function q(a,b,c){try{let e=new Date(b),f=new Date(c),g=await d.db.product.findMany({where:{branchId:a},include:{category:!0}}),h=await Promise.all(g.map(async b=>{let c=await d.db.productHistory.findMany({where:{productId:b.id,locationId:a,createdAt:{gte:e,lte:f}},orderBy:{createdAt:"asc"}}),g=0,h=0,i=0,j=0;c.forEach(a=>{let b=a.newQuantity-a.previousQuantity;"SALE"===a.changeReason?g+=Math.abs(b):"STOCK_IN"===a.changeReason||"RESTOCK"===a.changeReason?h+=b:b>0?i+=b:j+=Math.abs(b)});let k=await d.db.productHistory.findFirst({where:{productId:b.id,locationId:a,createdAt:{lte:f}},orderBy:{createdAt:"desc"}}),l=k?k.newQuantity:0,m=l-(h+i-g-j);return{productId:b.id,productName:b.name,itemNumber:b.sku||b.id,imageUrl:b.imageUrl,costPrice:Number(b.costPrice),sellingPrice:Number(b.sellingPrice),category:b.category?.name,openingStock:m,itemsSold:g,stockIn:h,transferOut:0,returnIn:0,returnOut:0,adjustmentsIn:i,adjustmentsOut:j,closingStock:l,revaluation:l*Number(b.costPrice)}}));return{success:!0,data:h}}catch(a){return console.error("Error generating stock summary report:",a),{success:!1,error:a.message}}}async function r(a,b){try{let c=await d.db.product.findUnique({where:{id:b},include:{category:!0}});if(!c)return{success:!1,error:"Product not found"};let e=await d.db.productHistory.findMany({where:{productId:b,locationId:a},orderBy:[{createdAt:"asc"},{id:"asc"}]}),f=await d.db.sale.findMany({where:{branchId:a},orderBy:{date:"asc"}}),g=e.length>0?e[0].newStock:0,h=e.length>0?e[0].createdAt:null,i=new Map,j=0;f.forEach(a=>{let c=(a.items||[]).filter(a=>a.productId===b).reduce((a,b)=>a+(Number(b.quantity)||0),0);if(c>0)if(h&&a.date<h)j+=c;else{let b=a.date.toISOString().split("T")[0],d=i.get(b)||{itemsSold:0,stockAdded:0,transferOut:0,returnIn:0,returnOut:0,adjustments:0};d.itemsSold+=c,i.set(b,d)}}),e.slice(1).forEach(a=>{let b=a.createdAt.toISOString().split("T")[0],c=a.newStock-a.oldStock,d=(a.changeReason||"").toLowerCase(),e=i.get(b)||{itemsSold:0,stockAdded:0,transferOut:0,returnIn:0,returnOut:0,adjustments:0};"RESTOCK"===a.type||d.includes("purchase")||d.includes("addition")?e.stockAdded+=c:d.includes("transfer out")?e.transferOut+=Math.abs(c):d.includes("customer return")?e.returnIn+=c:d.includes("return to supplier")?e.returnOut+=Math.abs(c):"SALE"!==a.type&&(e.adjustments+=c),i.set(b,e)});let k=Array.from(i.keys()).sort(),l=[],m=g;for(let a of k){let b=i.get(a),c=m,d=c-b.itemsSold+b.stockAdded-b.transferOut+b.returnIn-b.returnOut+b.adjustments;l.push({date:a,startingStock:c,...b,endingStock:d}),m=d}return{success:!0,data:{product:{id:c.id,name:c.name,quantity:c.stock,itemNumber:c.sku},currentStock:c.stock,calculatedStock:m,discrepancy:c.stock-m,openingStock:g,openingDate:h?.toISOString(),excludedSalesQty:j,dailyBreakdown:l}}}catch(a){return console.error("Error in reconciliation action:",a),{success:!1,error:a.message}}}async function s(a){try{let b=await d.db.product.findMany({where:{branchId:a},select:{id:!0,name:!0,stock:!0}}),c=[];for(let e of b){let b=await d.db.productHistory.findMany({where:{productId:e.id,locationId:a},orderBy:[{createdAt:"asc"},{id:"asc"}]});if(0===b.length)continue;let f=0,g=[];for(let a of b){let b=a.newStock-a.oldStock,c=f,d=c+b;(a.oldStock!==c||a.newStock!==d)&&g.push({entryId:a.id,createdAt:a.createdAt.toISOString(),changeReason:a.changeReason,currentPrevQty:a.oldStock,currentNewQty:a.newStock,fixedPrevQty:c,fixedNewQty:d}),f=d}(g.length>0||Math.abs(e.stock-f)>.001)&&c.push({productId:e.id,productName:e.name,totalEntries:b.length,brokenEntries:g,finalFixedQty:f,currentProductQty:e.stock})}return{success:!0,data:c}}catch(a){return{success:!1,error:a.message}}}async function t(a,b){try{let c=b||(await d.db.product.findMany({where:{branchId:a},select:{id:!0}})).map(a=>a.id),e=0,f=0;for(let b of c)try{await i(b,a),e++}catch(a){f++}return{success:!0,data:{repaired:e,failed:f}}}catch(a){return{success:!1,error:a.message}}}async function u(a){try{let b=await d.db.activityHistory.findMany({where:{entityId:{in:a}},select:{entityId:!0,entityName:!0}});return{success:!0,data:b}}catch(a){return{success:!1,error:a.message,data:[]}}}async function v(a,b){try{return await d.db.productHistory.updateMany({where:{id:{in:a}},data:{createdAt:new Date(b)}}),{success:!0}}catch(a){return{success:!1,error:a.message}}}[d]=f.then?(await f)():f,a.s(["createRequisitionAction",()=>n,"createStockHistoryAction",()=>h,"deleteRequisitionAction",()=>p,"deleteStockHistoryEntriesByReferenceAction",()=>j,"getActivityByEntityIdsAction",()=>u,"getProductReconciliationAction",()=>r,"getRequisitionsAction",()=>m,"getStockHistoryAction",()=>g,"getStockRepairsPreviewAction",()=>s,"getStockSummaryReportAction",()=>q,"recalculateStockChainAction",()=>i,"repairStockChainsAction",()=>t,"updateRequisitionAction",()=>o,"updateStockHistoryDatesAction",()=>v,"updateStockHistoryDatesByReferenceAction",()=>k]),c()}catch(a){c(a)}},!1),834122,a=>a.a(async(b,c)=>{try{var d=a.i(531811),e=a.i(964889),f=a.i(500885),g=a.i(942348),h=b([d,e,f,g]);[d,e,f,g]=h.then?(await h)():h,a.s(["useStockSummaryData",0,a=>{let{user:b}=(0,d.useAuth)(),{currentBusiness:c}=(0,e.useBusiness)(),h=(0,f.useQueryClient)(),i=async()=>{if(!b?.id||!c?.id||!a?.from||!a?.to)return[];try{let b=await (0,g.getStockSummaryReportAction)(c.id,a.from.toISOString(),a.to.toISOString());if(b.success&&b.data)return b.data;throw Error(b.error)}catch(a){throw console.error("[StockSummary] Error fetching report:",a.message),a}},{data:j=[],isLoading:k,refetch:l}=(0,f.useQuery)({queryKey:["stockSummary",c?.id,a.from?.toISOString(),a.to?.toISOString()],queryFn:i,enabled:!!b?.id&&!!c?.id&&!!a?.from&&!!a?.to,staleTime:3e5,gcTime:18e5});return{stockSummaryData:j,isLoading:k,loadStockSummaryData:l,clearCache:()=>{h.invalidateQueries({queryKey:["stockSummary"]})},clearAllLocationCaches:()=>{h.invalidateQueries({queryKey:["stockSummary"]})}}}]),c()}catch(a){c(a)}},!1),283554,(a,b,c)=>{b.exports=a.x("html2canvas-2cd317ce0361f606",()=>require("html2canvas-2cd317ce0361f606"))},687989,(a,b,c)=>{b.exports=a.x("react-barcode-d3088eeb3fd8eaaf",()=>require("react-barcode-d3088eeb3fd8eaaf"))},550548,(a,b,c)=>{b.exports=a.x("react-dom/client",()=>require("react-dom/client"))},966643,a=>{"use strict";var b=a.i(127669),c=a.i(959866),d=a.i(283554),e=a.i(687989),f=a.i(550548);let g=async a=>{let{productName:c,barcodeValue:g,price:h,currency:i="KES",showPrice:j=!0}=a,k=document.createElement("div");k.style.position="absolute",k.style.left="-9999px",k.style.top="-9999px",k.style.width="300px",k.style.padding="15px",k.style.backgroundColor="white",k.style.fontFamily="Arial, sans-serif",document.body.appendChild(k);try{let a=document.createElement("div");a.style.display="flex",a.style.flexDirection="column",a.style.alignItems="center",a.style.gap="8px";let l=document.createElement("div");l.textContent=c.length>30?c.substring(0,27)+"...":c,l.style.fontSize="14px",l.style.fontWeight="bold",l.style.textAlign="center",l.style.maxWidth="100%",l.style.wordWrap="break-word",a.appendChild(l);let m=document.createElement("div");if(m.id="barcode-svg-container",a.appendChild(m),j&&void 0!==h){let b=document.createElement("div");b.textContent=`${i} ${h.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,b.style.fontSize="14px",b.style.fontWeight="bold",b.style.textAlign="center",a.appendChild(b)}k.appendChild(a);let n=(0,f.createRoot)(m);await new Promise(a=>{let c=e.default;n.render(b.default.createElement(c,{value:g,width:1.5,height:60,fontSize:12})),setTimeout(()=>a(),100)});let o=(await (0,d.default)(k,{backgroundColor:"#ffffff",scale:2})).toDataURL("image/jpeg",.95);return n.unmount(),document.body.removeChild(k),o}catch(a){throw document.body.removeChild(k),a}},h=async a=>{try{let b=await g(a),d=new c.default({orientation:"portrait",unit:"mm",format:"a4"});d.setFontSize(16),d.text("Product Barcode",105,20,{align:"center"}),d.addImage(b,"JPEG",82.5,40,45,30);let e=a.productName.replace(/[^a-z0-9]/gi,"_").toLowerCase();d.save(`barcode_${e}_${Date.now()}.pdf`)}catch(a){throw console.error("Error exporting barcode to PDF:",a),a}},i=async(a,b={})=>{let{showPrice:d=!0,currency:e="KES"}=b;try{let b=a.filter(a=>a.barcode);if(0===b.length)throw Error("No products with barcodes to export");let f=new c.default({orientation:"portrait",unit:"mm",format:"a4"}),h=Math.floor(4.085106382978723),i=Math.floor(8.71875),j=h*i,k=(210-(45*h+(h-1)*2))/2,l=(297-(30*i+(i-1)*2))/2,m=0;for(let a of b){m>0&&m%j==0&&f.addPage();let b=m%j,c=Math.floor(b/h),i=b%h,n=k+47*i,o=l+32*c,p=await g({productName:a.name,barcodeValue:a.barcode,price:a.sellingPrice,currency:e,showPrice:d});f.setDrawColor(200,200,200),f.rect(n,o,45,30);f.addImage(p,"JPEG",n+2,o+2,41,26),m++}f.setPage(1),f.setFontSize(10),f.setTextColor(100,100,100),f.text(`Total barcodes: ${b.length}`,105,5,{align:"center"});let n=new Date().toISOString().split("T")[0];f.save(`barcodes_bulk_${n}_${b.length}_items.pdf`)}catch(a){throw console.error("Error exporting bulk barcodes to PDF:",a),a}};a.s(["exportBulkBarcodesToPDF",0,i,"exportSingleBarcodeToPDF",0,h])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__841f87c3._.js.map