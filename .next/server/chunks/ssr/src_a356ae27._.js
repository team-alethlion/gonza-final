module.exports=[895121,a=>{"use strict";var b=a.i(187924),c=a.i(591119),d=a.i(883497),e=a.i(73570);let f=(0,a.i(170106).default)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);var g=a.i(724669),h=a.i(790166),i=a.i(866102),j=a.i(368114),k=a.i(400291);a.s(["default",0,({products:a,hideStockValue:l=!1,totalCountOverride:m,totalCostValueOverride:n,lowStockOverride:o,outOfStockOverride:p,totalStockValueOverride:q})=>{let{settings:r}=(0,i.useBusinessSettings)(),{canViewCostPrice:s,canViewSellingPrice:t}=(0,k.useFinancialVisibility)(),u="number"==typeof m?m:a.length,v="number"==typeof o?o:a.filter(a=>a.quantity>0&&a.quantity<=a.minimumStock).length,w="number"==typeof p?p:a.filter(a=>0===a.quantity).length,x="number"==typeof n?n:a.reduce((a,b)=>a+b.costPrice*b.quantity,0),y="number"==typeof q?q:a.reduce((a,b)=>a+b.sellingPrice*b.quantity,0),z=a=>{let b=a.length;return b>15?"text-sm md:text-lg":b>12?"text-base md:text-xl":b>8?"text-lg md:text-xl":"text-lg md:text-2xl"};return(0,b.jsxs)("div",{className:`grid gap-3 md:gap-4 mb-6 ${l?"grid-cols-2 md:grid-cols-4":"grid-cols-2 md:grid-cols-3 xl:grid-cols-5"}`,children:[(0,b.jsx)(c.Card,{className:"overflow-hidden",children:(0,b.jsx)(c.CardContent,{className:"p-4 md:p-6",children:(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("div",{className:"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-blue-100 text-blue-500",children:(0,b.jsx)(d.Package,{className:"h-4 w-4 md:h-5 md:w-5"})}),(0,b.jsxs)("div",{className:"ml-3 md:ml-4 min-w-0",children:[(0,b.jsx)("p",{className:"text-xs md:text-sm font-medium text-gray-500 truncate",children:"Total Products"}),(0,b.jsx)("h3",{className:"text-lg md:text-2xl font-bold",children:u})]})]})})}),(0,b.jsx)(c.Card,{className:"overflow-hidden",children:(0,b.jsx)(c.CardContent,{className:"p-4 md:p-6",children:(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("div",{className:"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-amber-100 text-amber-500",children:(0,b.jsx)(e.AlertTriangle,{className:"h-4 w-4 md:h-5 md:w-5"})}),(0,b.jsxs)("div",{className:"ml-3 md:ml-4 min-w-0",children:[(0,b.jsx)("p",{className:"text-xs md:text-sm font-medium text-gray-500 truncate",children:"Low Stock"}),(0,b.jsx)("h3",{className:"text-lg md:text-2xl font-bold",children:v})]})]})})}),(0,b.jsx)(c.Card,{className:"overflow-hidden",children:(0,b.jsx)(c.CardContent,{className:"p-4 md:p-6",children:(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("div",{className:"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-red-100 text-red-500",children:(0,b.jsx)(f,{className:"h-4 w-4 md:h-5 md:w-5"})}),(0,b.jsxs)("div",{className:"ml-3 md:ml-4 min-w-0",children:[(0,b.jsx)("p",{className:"text-xs md:text-sm font-medium text-gray-500 truncate",children:"Out of Stock"}),(0,b.jsx)("h3",{className:"text-lg md:text-2xl font-bold",children:w})]})]})})}),(0,b.jsx)(c.Card,{className:"overflow-hidden",children:(0,b.jsx)(c.CardContent,{className:"p-4 md:p-6",children:(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("div",{className:"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-green-100 text-green-500",children:(0,b.jsx)(g.TrendingUp,{className:"h-4 w-4 md:h-5 md:w-5"})}),(0,b.jsxs)("div",{className:"ml-3 md:ml-4 min-w-0 flex-1",children:[(0,b.jsx)("p",{className:"text-xs md:text-sm font-medium text-gray-500 truncate",children:"Cost Value"}),(0,b.jsx)("h3",{className:`${z(`${r.currency} ${(0,j.formatNumber)(x)}`)} font-bold break-all leading-tight`,children:s?`${r.currency} ${(0,j.formatNumber)(x)}`:"•••"})]})]})})}),!l&&(0,b.jsx)(c.Card,{className:"overflow-hidden",children:(0,b.jsx)(c.CardContent,{className:"p-4 md:p-6",children:(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("div",{className:"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-purple-100 text-purple-500",children:(0,b.jsx)(h.DollarSign,{className:"h-4 w-4 md:h-5 md:w-5"})}),(0,b.jsxs)("div",{className:"ml-3 md:ml-4 min-w-0 flex-1",children:[(0,b.jsx)("p",{className:"text-xs md:text-sm font-medium text-gray-500 truncate",children:"Stock Value"}),(0,b.jsx)("h3",{className:`${z(`${r.currency} ${(0,j.formatNumber)(y)}`)} font-bold break-all leading-tight`,children:t?`${r.currency} ${(0,j.formatNumber)(y)}`:"•••"})]})]})})})]})}],895121)},972270,a=>{"use strict";var b=a.i(572131),c=a.i(391956),d=a.i(347778),e=a.i(973308),f=a.i(823292);a.s(["useBulkProducts",0,()=>{let{user:a}=(0,c.useAuth)(),{createProduct:g}=(0,d.useProducts)(a?.id),{categories:h,createCategory:i}=(0,e.useCategories)(a?.id),[j,k]=(0,b.useState)(!1),l=async a=>{let b=h.map(a=>a.name.toLowerCase()),c=[...new Set(a.filter(a=>""!==a.trim()))].filter(a=>!b.includes(a.toLowerCase())),d=[],e=[];for(let a of c)try{await i(a)?d.push(a):e.push(a)}catch(b){console.error(`Failed to create category ${a}:`,b),e.push(a)}return{createdCategories:d,failedCategories:e}};return{bulkCreateProducts:async(b,c)=>{if(!a?.id)throw Error("User not authenticated");k(!0);let d=0,e=0,h=[];try{let a=b.map(a=>a.category).filter(Boolean);if(a.length>0){let{createdCategories:b,failedCategories:c}=await l(a);b.length>0&&f.toast.success(`Created ${b.length} new categories`),c.length>0&&f.toast.error(`Failed to create ${c.length} categories`)}for(let a=0;a<b.length;a++){let f=b[a];try{await g(f)?d++:(e++,h.push(`Failed to create product: ${f.name}`))}catch(a){e++,h.push(`Error creating ${f.name}: ${a}`),console.error(`Error creating product ${f.name}:`,a)}c&&c(d+e,b.length)}return!c&&(d>0&&f.toast.success(`Successfully created ${d} products`),e>0&&f.toast.error(`${e} products failed to upload`)),{successCount:d,failureCount:e,errors:h}}finally{k(!1)}},detectNewCategories:a=>{let b=h.map(a=>a.name.toLowerCase());return[...new Set(a.map(a=>a.category).filter(Boolean))].filter(a=>!b.includes(a.toLowerCase()))},isUploading:j}}])},201699,a=>{"use strict";var b=a.i(187924),c=a.i(173390),d=a.i(816201),e=a.i(292e3),f=a.i(797063),g=a.i(124348);a.s(["BulkOperationProgress",0,({title:a,currentCount:h,totalCount:i,status:j,successCount:k,failureCount:l})=>{let m=Math.round(h/i*100);return(0,b.jsxs)("div",{className:"space-y-6 py-4",children:["processing"===j&&(0,b.jsxs)(g.Alert,{children:[(0,b.jsx)(f.Info,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertDescription,{children:(0,b.jsx)("strong",{children:"Please do not close this tab or dialog until the process is complete."})})]}),(0,b.jsxs)("div",{className:"text-center space-y-4",children:["processing"===j?(0,b.jsx)("div",{className:"mx-auto h-12 w-12 animate-spin rounded-full border-4 border-muted border-t-primary"}):"completed"===j?(0,b.jsx)(d.CheckCircle,{className:"mx-auto h-12 w-12 text-green-500"}):(0,b.jsx)(e.AlertCircle,{className:"mx-auto h-12 w-12 text-destructive"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:a}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"processing"===j?`Processing item ${h} of ${i}`:"completed"===j?`Successfully processed ${k??i} items${l?`, ${l} failed`:""}`:"The operation failed to complete."})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-xs font-medium text-muted-foreground",children:[(0,b.jsx)("span",{children:"Progress"}),(0,b.jsxs)("span",{children:[m,"%"]})]}),(0,b.jsx)(c.Progress,{value:m,className:"h-2 w-full"})]}),(void 0!==k||void 0!==l)&&"completed"===j&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[(0,b.jsxs)("div",{className:"bg-green-50 border border-green-100 rounded-lg p-3 text-center",children:[(0,b.jsx)("div",{className:"text-xl font-bold text-green-700",children:k??0}),(0,b.jsx)("div",{className:"text-xs text-green-600 font-medium",children:"Successful"})]}),(0,b.jsxs)("div",{className:"bg-red-50 border border-red-100 rounded-lg p-3 text-center",children:[(0,b.jsx)("div",{className:"text-xl font-bold text-red-700",children:l??0}),(0,b.jsx)("div",{className:"text-xs text-red-600 font-medium",children:"Failed"})]})]})]})}])},520606,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(814574),e=a.i(699570),f=a.i(591119),g=a.i(124348),h=a.i(773320),i=a.i(104720),j=a.i(292e3),k=a.i(284505),l=a.i(915618),m=a.i(899078),n=a.i(368114),o=a.i(786304),p=a.i(972270),q=a.i(201699);a.s(["default",0,({open:a,onOpenChange:r,onUpload:s,categories:t})=>{let{detectNewCategories:u,bulkCreateProducts:v}=(0,p.useBulkProducts)(),[w,x]=(0,c.useState)({step:"select",file:null,validRows:[],errors:[],totalRows:0,uploadProgress:0,successCount:0,failureCount:0,newCategories:[],currentProductIndex:0}),y=(0,c.useRef)(null),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1),D=async a=>{if(!a.name.endsWith(".csv"))return void alert("Please select a CSV file");let b=await a.text(),c=(0,m.parseCSV)(b),d=u(c.validRows.map(E));x({...w,step:"preview",file:a,validRows:c.validRows,errors:c.errors,totalRows:c.totalRows,newCategories:d})},E=a=>{let b=new Date,c=a["Creation Date"];if(c){let a=c.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(a){let[,c,d,e]=a;b=new Date(parseInt(e),parseInt(d)-1,parseInt(c))}else{let a=new Date(c);isNaN(a.getTime())||(b=a)}}return{name:a["Product Name"],category:a.Category||"",description:a.Description||"",supplier:a.Supplier||"",quantity:a["Initial Stock"]?Number(a["Initial Stock"]):0,minimumStock:a["Minimum Stock Level"]?Number(a["Minimum Stock Level"]):void 0,costPrice:a["Cost Price"]?Number(a["Cost Price"]):void 0,sellingPrice:a["Selling Price"]?Number(a["Selling Price"]):void 0,manufacturerBarcode:a["Manufacturer Barcode"]||"",imageFile:null,imageUrl:null,createdAt:b}},F=async()=>{x(a=>({...a,step:"uploading",uploadProgress:0,currentProductIndex:0})),C(!0);let a=w.validRows.map(E);try{await v(a,(a,b)=>{let c=Math.round(a/b*100);x(b=>({...b,uploadProgress:c,currentProductIndex:a,successCount:a,failureCount:0}))}),x(b=>({...b,step:"complete",uploadProgress:100,successCount:a.length,failureCount:0,currentProductIndex:a.length}))}catch(b){console.error("Bulk upload failed:",b),x(b=>({...b,step:"complete",uploadProgress:100,successCount:0,failureCount:a.length,currentProductIndex:a.length}))}finally{C(!1)}};return(0,b.jsx)(d.Dialog,{open:a,onOpenChange:a=>{B||r(a)},children:(0,b.jsxs)(d.DialogContent,{className:"sm:max-w-[500px] pointer-events-auto",children:[(0,b.jsxs)(d.DialogHeader,{children:[(0,b.jsxs)(d.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(i.FileText,{className:"h-5 w-5"}),"Upload Products via CSV"]}),(0,b.jsx)(d.DialogDescription,{children:"Upload multiple products at once using a CSV file (DD/MM/YYYY date format)"})]}),"select"===w.step&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:(0,n.cn)("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors",z?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"),onDrop:a=>{a.preventDefault(),A(!1);let b=a.dataTransfer.files[0];b&&D(b)},onDragOver:a=>{a.preventDefault(),A(!0)},onDragLeave:()=>{A(!1)},onClick:()=>y.current?.click(),children:[(0,b.jsx)(h.Upload,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,b.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload CSV File"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Drag and drop your CSV file here, or click to browse"}),(0,b.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"Supports all date formats | Accepts negative values | Use quotes for fields with commas"})]}),(0,b.jsx)("input",{ref:y,type:"file",accept:".csv",onChange:a=>{let b=a.target.files?.[0];b&&D(b)},className:"hidden"})]}),"preview"===w.step&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"pt-6",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:w.validRows.length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Valid products"})]})}),(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"pt-6",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-red-600",children:w.errors.length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Errors found"})]})}),(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"pt-6",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:w.totalRows}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total rows"})]})})]}),w.newCategories.length>0&&(0,b.jsxs)(g.Alert,{children:[(0,b.jsx)(l.Plus,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertDescription,{children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("p",{children:["The following ",w.newCategories.length," new categories will be created:"]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:w.newCategories.map((a,c)=>(0,b.jsx)(o.Badge,{variant:"outline",className:"text-xs",children:a},c))})]})})]}),w.errors.length>0&&(0,b.jsxs)(g.Alert,{variant:"destructive",children:[(0,b.jsx)(j.AlertCircle,{className:"h-4 w-4"}),(0,b.jsxs)(g.AlertDescription,{children:[w.errors.length," rows have errors and will be skipped.",(0,b.jsxs)(e.Button,{variant:"link",className:"p-0 h-auto ml-2",onClick:()=>(0,m.generateErrorLogCSV)(w.errors),children:[(0,b.jsx)(k.Download,{className:"h-3 w-3 mr-1"}),"Download error log"]})]})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>x(a=>({...a,step:"select"})),children:"Back"}),(0,b.jsxs)(e.Button,{onClick:F,disabled:0===w.validRows.length,children:["Upload ",w.validRows.length," Products",w.newCategories.length>0&&` & Create ${w.newCategories.length} Categories`]})]})]}),"uploading"===w.step&&(0,b.jsx)(q.BulkOperationProgress,{title:"Uploading Products...",currentCount:w.currentProductIndex,totalCount:w.validRows.length,status:"processing"}),"complete"===w.step&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(q.BulkOperationProgress,{title:"Upload Complete!",currentCount:w.currentProductIndex,totalCount:w.validRows.length,status:w.failureCount>0?"failed":"completed",successCount:w.successCount,failureCount:w.failureCount}),(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)(e.Button,{onClick:()=>{if(B)return;let a="complete"===w.step&&w.successCount>0;x({step:"select",file:null,validRows:[],errors:[],totalRows:0,uploadProgress:0,successCount:0,failureCount:0,newCategories:[],currentProductIndex:0}),r(!1),a&&setTimeout(()=>{window.location.reload()},100)},children:"Close"})})]})]})})}])}];

//# sourceMappingURL=src_a356ae27._.js.map