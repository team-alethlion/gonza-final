{"version":3,"sources":["../../../../src/utils/exportBarcodeToJPEG.ts","../../../../src/components/inventory/ProductDetails.tsx","../../../../src/pages/ProductDetail.tsx","../../../../src/components/inventory/DeleteProductDialog.tsx","../../../../src/components/inventory/ProductStockHistory.tsx","../../../../node_modules/lucide-react/src/icons/minus.ts","../../../../node_modules/lucide-react/src/icons/file-image.ts","../../../../node_modules/lucide-react/src/icons/copy.ts"],"sourcesContent":["import React from 'react';\r\nimport html2canvas from 'html2canvas';\r\nimport Barcode from 'react-barcode';\r\nimport { createRoot } from 'react-dom/client';\r\n\r\ninterface BarcodeExportOptions {\r\n    productName: string;\r\n    barcodeValue: string;\r\n    price?: number;\r\n    currency?: string;\r\n    showPrice?: boolean;\r\n}\r\n\r\n/**\r\n * Export a single barcode as a JPEG file\r\n */\r\nexport const exportBarcodeToJPEG = async (options: BarcodeExportOptions): Promise<void> => {\r\n    const { productName, barcodeValue, price, currency = 'KES', showPrice = true } = options;\r\n\r\n    // Create a temporary container\r\n    const container = document.createElement('div');\r\n    container.style.position = 'absolute';\r\n    container.style.left = '-9999px';\r\n    container.style.top = '-9999px';\r\n    container.style.width = '340px'; // Approx 45mm width label (scaled 2x)\r\n    container.style.padding = '20px';\r\n    container.style.backgroundColor = 'white';\r\n    container.style.fontFamily = 'Arial, sans-serif';\r\n    document.body.appendChild(container);\r\n\r\n    try {\r\n        // Create the barcode container with styling\r\n        const barcodeContainer = document.createElement('div');\r\n        barcodeContainer.style.display = 'flex';\r\n        barcodeContainer.style.flexDirection = 'column';\r\n        barcodeContainer.style.alignItems = 'center';\r\n        barcodeContainer.style.gap = '10px';\r\n\r\n        // Product name\r\n        const nameElement = document.createElement('div');\r\n        nameElement.textContent = productName;\r\n        nameElement.style.fontSize = '18px';\r\n        nameElement.style.fontWeight = 'bold';\r\n        nameElement.style.textAlign = 'center';\r\n        nameElement.style.maxWidth = '100%';\r\n        nameElement.style.wordWrap = 'break-word';\r\n        barcodeContainer.appendChild(nameElement);\r\n\r\n        // Barcode SVG container\r\n        const svgContainer = document.createElement('div');\r\n        svgContainer.id = 'barcode-svg-container';\r\n        barcodeContainer.appendChild(svgContainer);\r\n\r\n        // Price (if applicable)\r\n        if (showPrice && price !== undefined) {\r\n            const priceElement = document.createElement('div');\r\n            priceElement.textContent = `${currency} ${price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;\r\n            priceElement.style.fontSize = '18px';\r\n            priceElement.style.fontWeight = 'bold';\r\n            priceElement.style.textAlign = 'center';\r\n            barcodeContainer.appendChild(priceElement);\r\n        }\r\n\r\n        container.appendChild(barcodeContainer);\r\n\r\n        // Render the barcode using React\r\n        const root = createRoot(svgContainer);\r\n        await new Promise<void>((resolve) => {\r\n            const BarcodeComponent = Barcode as any;\r\n            root.render(\r\n                React.createElement(BarcodeComponent, {\r\n                    value: barcodeValue,\r\n                    width: 2,\r\n                    height: 80,\r\n                    fontSize: 16\r\n                })\r\n            );\r\n            // Give React time to render\r\n            setTimeout(() => resolve(), 100);\r\n        });\r\n\r\n        // Convert to canvas\r\n        const canvas = await html2canvas(container, {\r\n            backgroundColor: '#ffffff',\r\n            scale: 2, // Higher quality\r\n        });\r\n\r\n        // Convert canvas to JPEG blob\r\n        canvas.toBlob((blob) => {\r\n            if (blob) {\r\n                const url = URL.createObjectURL(blob);\r\n                const link = document.createElement('a');\r\n                const sanitizedName = productName.replace(/[^a-z0-9]/gi, '_').toLowerCase();\r\n                link.download = `barcode_${sanitizedName}_${Date.now()}.jpg`;\r\n                link.href = url;\r\n                link.click();\r\n                URL.revokeObjectURL(url);\r\n            }\r\n        }, 'image/jpeg', 0.95);\r\n\r\n        // Cleanup\r\n        root.unmount();\r\n    } catch (error) {\r\n        console.error('Error exporting barcode to JPEG:', error);\r\n        throw error;\r\n    } finally {\r\n        // Remove the temporary container\r\n        document.body.removeChild(container);\r\n    }\r\n};\r\n","import React, { useState } from 'react';\r\n// @ts-ignore - react-barcode may not have types installed\r\nimport Barcode from 'react-barcode';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Product, StockHistoryEntry } from '@/types';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Edit, Package, AlertCircle, ArrowLeft, Trash2, Copy, RefreshCw, Printer, Download, FileImage, Plus, Minus } from 'lucide-react';\r\nimport { exportBarcodeToJPEG } from '@/utils/exportBarcodeToJPEG';\r\nimport { exportSingleBarcodeToPDF } from '@/utils/exportBarcodeToPDF';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\nimport { format } from 'date-fns';\r\nimport DeleteProductDialog from './DeleteProductDialog';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useStockHistory } from '@/hooks/useStockHistory';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { toast } from 'sonner';\r\nimport { Input } from '@/components/ui/input';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\nimport { Alert, AlertTitle, AlertDescription } from '@/components/ui/alert';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { Label } from '@/components/ui/label';\r\n\r\ninterface ProductDetailsProps {\r\n  product: Product;\r\n  stockHistory: StockHistoryEntry[];\r\n  isLoadingHistory: boolean;\r\n  onStockUpdate?: () => void;\r\n}\r\n\r\nconst ProductDetails: React.FC<ProductDetailsProps> = ({\r\n  product,\r\n  stockHistory,\r\n  isLoadingHistory,\r\n  onStockUpdate\r\n}) => {\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const { currentBusiness } = useBusiness();\r\n  const { settings } = useBusinessSettings();\r\n  const { updateProduct, deleteProduct } = useProducts(user?.id);\r\n  const { createStockHistoryEntry, stockHistory: allStockHistory } = useStockHistory(user?.id, product.id);\r\n  const { hasPermission } = useProfiles();\r\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\r\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\r\n  const [adjustmentType, setAdjustmentType] = useState<'Stock In' | 'Stock Out'>('Stock In');\r\n  const [adjustmentQuantity, setAdjustmentQuantity] = useState<number>(0);\r\n  const [adjustmentReason, setAdjustmentReason] = useState<string>('');\r\n  const [adjustmentDate, setAdjustmentDate] = useState<string>(new Date().toISOString().split('T')[0]);\r\n  const [adjustmentTime, setAdjustmentTime] = useState<string>(new Date().toTimeString().split(' ')[0]);\r\n  const [isApplying, setIsApplying] = useState(false);\r\n  const [barcodeDialogOpen, setBarcodeDialogOpen] = useState(false);\r\n  const [showPriceOnBarcode, setShowPriceOnBarcode] = useState(true);\r\n  const [printQuantity, setPrintQuantity] = useState(1);\r\n  const [isExporting, setIsExporting] = useState(false);\r\n  const { formatFinancial, canViewCostPrice, canViewProfit, canViewSellingPrice } = useFinancialVisibility();\r\n\r\n  const handleDeleteProduct = async () => {\r\n    const result = await deleteProduct(product.id);\r\n    if (result) {\r\n      toast.success(\"Product deleted successfully\");\r\n      navigate('/inventory');\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const handleDuplicateProduct = () => {\r\n    toast.success(\"Duplicating product...\");\r\n    // Navigate to new product page with product data for duplication\r\n    navigate('/inventory/new', {\r\n      state: {\r\n        duplicateData: {\r\n          name: `${product.name} (Copy)`,\r\n          description: product.description,\r\n          category: product.category,\r\n          supplier: product.supplier,\r\n          costPrice: product.costPrice,\r\n          sellingPrice: product.sellingPrice,\r\n          imageUrl: product.imageUrl,\r\n          createdAt: product.createdAt,\r\n          minimumStock: product.minimumStock\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const getStockStatusBadge = () => {\r\n    if (product.quantity === 0) {\r\n      return <Badge variant=\"destructive\" className=\"text-sm\">Out of stock</Badge>;\r\n    }\r\n\r\n    if (product.quantity <= product.minimumStock) {\r\n      return <Badge variant=\"warning\" className=\"bg-amber-500 text-sm\">Low stock</Badge>;\r\n    }\r\n\r\n    return <Badge variant=\"success\" className=\"bg-green-600 text-sm\">In stock</Badge>;\r\n  };\r\n\r\n  // Get the initial stock date (chronologically first entry)\r\n  const getInitialStockDate = (): Date | null => {\r\n    const historyToCheck = stockHistory.length > 0 ? stockHistory : allStockHistory;\r\n    if (historyToCheck.length === 0) return null;\r\n    const sortedHistory = [...historyToCheck].sort((a, b) => a.createdAt.getTime() - b.createdAt.getTime());\r\n    return sortedHistory[0]?.createdAt || null;\r\n  };\r\n\r\n  const validateAdjustmentDateTime = (dateStr: string, timeStr: string): string => {\r\n    if (!dateStr) return '';\r\n\r\n    const initialStockDate = getInitialStockDate();\r\n    if (!initialStockDate) return '';\r\n\r\n    // Create the proposed datetime with selected date and time\r\n    const [year, month, day] = dateStr.split('-').map(Number);\r\n    const timeParts = timeStr.split(':').map(Number);\r\n    const [hours, minutes, seconds = 0] = timeParts;\r\n    const proposedDateTime = new Date(year, month - 1, day, hours, minutes, seconds);\r\n\r\n    if (proposedDateTime < initialStockDate) {\r\n      return `Date and time cannot be before the initial stock date and time (${format(initialStockDate, 'PPP p')})`;\r\n    }\r\n\r\n    return '';\r\n  };\r\n\r\n  const handleStockAdjustment = async () => {\r\n    if (!adjustmentQuantity || adjustmentQuantity <= 0) {\r\n      toast.error(\"Please enter a valid quantity greater than zero\");\r\n      return;\r\n    }\r\n\r\n    // Validate adjustment date and time\r\n    const dateTimeError = validateAdjustmentDateTime(adjustmentDate, adjustmentTime);\r\n    if (dateTimeError) {\r\n      toast.error(dateTimeError);\r\n      return;\r\n    }\r\n\r\n    setIsApplying(true);\r\n\r\n    try {\r\n      const previousQuantity = product.quantity;\r\n      let newQuantity = previousQuantity;\r\n      // Use standardized reason format\r\n      let changeReason = adjustmentReason.trim()\r\n        ? `${adjustmentType}: ${adjustmentReason}`\r\n        : adjustmentType;\r\n\r\n      if (adjustmentType === 'Stock In') {\r\n        newQuantity = previousQuantity + adjustmentQuantity;\r\n      } else if (adjustmentType === 'Stock Out') {\r\n        newQuantity = Math.max(0, previousQuantity - adjustmentQuantity);\r\n        if (newQuantity === 0 && previousQuantity < adjustmentQuantity) {\r\n          toast.warning(`Attempted to remove ${adjustmentQuantity} items but only ${previousQuantity} were available. Stock is now 0.`);\r\n        }\r\n      }\r\n\r\n      // Create proper datetime for the adjustment using selected date and time\r\n      const [year, month, day] = adjustmentDate.split('-').map(Number);\r\n      const timeParts = adjustmentTime.split(':').map(Number);\r\n      const [hours, minutes, seconds = 0] = timeParts;\r\n      const adjustmentDateTime = new Date(year, month - 1, day, hours, minutes, seconds);\r\n\r\n      // Create the stock history entry which will automatically recalculate the stock chain\r\n      const success = await createStockHistoryEntry(\r\n        product.id,\r\n        previousQuantity,\r\n        newQuantity,\r\n        changeReason,\r\n        undefined,\r\n        adjustmentDateTime,\r\n        undefined,\r\n        product.name\r\n      );\r\n\r\n      if (success) {\r\n        // IMPORTANT: Also update the product record directly to ensure consistency\r\n        const updated = await updateProduct(\r\n          product.id,\r\n          { quantity: newQuantity },\r\n          undefined,\r\n          false,\r\n          'skip-history'\r\n        );\r\n\r\n        if (updated) {\r\n          toast.success(\"Stock updated successfully\");\r\n          if (onStockUpdate) {\r\n            onStockUpdate();\r\n          }\r\n          setAdjustmentQuantity(0);\r\n          setAdjustmentReason('');\r\n          setAdjustmentDate(new Date().toISOString().split('T')[0]);\r\n          setAdjustmentTime(new Date().toTimeString().split(' ')[0]);\r\n        } else {\r\n          toast.error(\"History logged, but failed to update product quantity.\");\r\n        }\r\n      } else {\r\n        toast.error(\"Failed to update stock history\");\r\n      }\r\n    } catch (error) {\r\n      console.error('Error applying stock adjustment:', error);\r\n      toast.error(\"Failed to apply stock adjustment. Please try again.\");\r\n    } finally {\r\n      setIsApplying(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header with Navigation and Actions */}\r\n      <div className=\"bg-white border border-gray-200 rounded-lg p-3 md:p-4 shadow-sm\">\r\n        <div className=\"flex flex-col space-y-3 lg:flex-row lg:justify-between lg:items-center lg:space-y-0 lg:gap-4\">\r\n          {/* Navigation and Refresh - Same Line */}\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => navigate('/products')}\r\n              className=\"flex items-center gap-2 hover:bg-gray-50 text-sm\"\r\n            >\r\n              <ArrowLeft className=\"h-4 w-4\" />\r\n              Back to Products\r\n            </Button>\r\n\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={onStockUpdate}\r\n              className=\"flex items-center gap-1 text-sm\"\r\n            >\r\n              <RefreshCw className=\"h-4 w-4\" />\r\n              Refresh Data\r\n            </Button>\r\n          </div>\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"flex flex-col space-y-2 lg:flex-row lg:items-center lg:space-y-0 lg:gap-2\">\r\n            {/* Duplicate Button */}\r\n            {hasPermission('inventory', 'create') && (\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={handleDuplicateProduct}\r\n                className=\"flex items-center justify-center gap-2 w-full lg:w-auto hover:bg-blue-50 hover:border-blue-300 text-sm\"\r\n              >\r\n                <Copy className=\"h-4 w-4\" />\r\n                Duplicate\r\n              </Button>\r\n            )}\r\n\r\n            {/* Primary Action - Edit Button with Secondary Color */}\r\n            {hasPermission('inventory', 'edit') && (\r\n              <Button\r\n                onClick={() => navigate(`/inventory/edit/${product.id}`)}\r\n                className=\"flex items-center justify-center gap-2 w-full lg:w-auto bg-secondary hover:bg-secondary/90 text-sm\"\r\n                size=\"sm\"\r\n              >\r\n                <Edit className=\"h-4 w-4\" />\r\n                Edit Product\r\n              </Button>\r\n            )}\r\n\r\n            {/* Barcode Label Dialog Button */}\r\n            <Dialog open={barcodeDialogOpen} onOpenChange={setBarcodeDialogOpen}>\r\n              <DialogTrigger asChild>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  className=\"flex items-center justify-center gap-2 w-full lg:w-auto hover:bg-green-50 hover:border-green-300 text-sm\"\r\n                >\r\n                  <Printer className=\"h-4 w-4\" />\r\n                  Barcode Label\r\n                </Button>\r\n              </DialogTrigger>\r\n              <DialogContent className=\"sm:max-w-md\">\r\n                <DialogHeader>\r\n                  <DialogTitle>Barcode Label Preview</DialogTitle>\r\n                </DialogHeader>\r\n\r\n                <div className=\"flex flex-col items-center justify-center py-6 bg-gray-50 rounded-lg border border-dashed\">\r\n                  {product.barcode ? (\r\n                    <div className=\"bg-white p-6 shadow-sm rounded-md flex flex-col items-center\">\r\n                      <span className=\"text-lg font-bold mb-2 truncate max-w-[280px]\">{product.name}</span>\r\n                      <Barcode\r\n                        value={product.barcode}\r\n                        width={2}\r\n                        height={80}\r\n                        fontSize={16}\r\n                      />\r\n                      {showPriceOnBarcode && (\r\n                        <span className=\"text-lg font-bold mt-2\">\r\n                          {settings.currency} {formatNumber(product.sellingPrice)}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"text-center p-6 text-muted-foreground\">\r\n                      <AlertCircle className=\"h-10 w-10 mx-auto mb-2 opacity-50\" />\r\n                      <p>No barcode available for this selection.</p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"space-y-4 pt-4 border-t\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"space-y-0.5\">\r\n                      <Label className=\"text-sm font-medium\">Show Price</Label>\r\n                      <p className=\"text-xs text-muted-foreground\">Include price on the printed label</p>\r\n                    </div>\r\n                    <Switch\r\n                      checked={showPriceOnBarcode}\r\n                      onCheckedChange={setShowPriceOnBarcode}\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"space-y-0.5\">\r\n                      <Label className=\"text-sm font-medium\">Quantity to Print</Label>\r\n                      <p className=\"text-xs text-muted-foreground\">Number of labels to print</p>\r\n                    </div>\r\n                    <Input\r\n                      type=\"number\"\r\n                      min=\"1\"\r\n                      className=\"w-20\"\r\n                      value={printQuantity}\r\n                      onChange={(e) => setPrintQuantity(parseInt(e.target.value) || 1)}\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"flex flex-col gap-2\">\r\n                    {/* Print Button */}\r\n                    <Button\r\n                      className=\"w-full gap-2\"\r\n                      disabled={!product.barcode}\r\n                      onClick={() => {\r\n                        const priceText = showPriceOnBarcode\r\n                          ? `TEXT 15,180,\"3\",0,1,1,\"${settings.currency} ${formatNumber(product.sellingPrice)}\"\\n`\r\n                          : '';\r\n\r\n                        fetch('http://localhost:5000/print/label', {\r\n                          method: 'POST',\r\n                          headers: { 'Content-Type': 'application/json' },\r\n                          mode: 'cors',\r\n                          body: JSON.stringify({\r\n                            PrinterName: settings.defaultPrinterName || 'Label Printer',\r\n                            Content: `SIZE 50 mm, 30 mm\\nGAP 3 mm, 0 mm\\nCLS\\nTEXT 15,20,\"3\",0,1,1,\"${product.name}\"\\nBARCODE 15,70,\"128\",60,1,0,2,2,\"${product.barcode}\"\\n${priceText}PRINT ${printQuantity}\\n`\r\n                          })\r\n                        }).then(() => {\r\n                          toast.success(`${printQuantity} label${printQuantity > 1 ? 's' : ''} sent to printer`);\r\n                        }).catch(err => {\r\n                          console.error('Failed to print label:', err);\r\n                          toast.error('Printing failed. Make sure Printer Bridge is running.');\r\n                        });\r\n                      }}\r\n                    >\r\n                      <Printer className=\"h-4 w-4\" />\r\n                      Print {printQuantity} Label{printQuantity > 1 ? 's' : ''}\r\n                    </Button>\r\n\r\n                    {/* Divider */}\r\n                    <div className=\"relative\">\r\n                      <div className=\"absolute inset-0 flex items-center\">\r\n                        <span className=\"w-full border-t\" />\r\n                      </div>\r\n                      <div className=\"relative flex justify-center text-xs uppercase\">\r\n                        <span className=\"bg-background px-2 text-muted-foreground\">Or Download</span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Export Buttons */}\r\n                    <div className=\"grid grid-cols-2 gap-2\">\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        className=\"gap-2\"\r\n                        disabled={!product.barcode || isExporting}\r\n                        onClick={async () => {\r\n                          setIsExporting(true);\r\n                          try {\r\n                            await exportBarcodeToJPEG({\r\n                              productName: product.name,\r\n                              barcodeValue: product.barcode,\r\n                              price: product.sellingPrice,\r\n                              currency: settings.currency,\r\n                              showPrice: showPriceOnBarcode,\r\n                            });\r\n                            toast.success('Barcode exported as JPEG');\r\n                          } catch (error) {\r\n                            console.error('Export failed:', error);\r\n                            toast.error('Failed to export barcode');\r\n                          } finally {\r\n                            setIsExporting(false);\r\n                          }\r\n                        }}\r\n                      >\r\n                        <FileImage className=\"h-4 w-4\" />\r\n                        JPEG\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        className=\"gap-2\"\r\n                        disabled={!product.barcode || isExporting}\r\n                        onClick={async () => {\r\n                          setIsExporting(true);\r\n                          try {\r\n                            await exportSingleBarcodeToPDF({\r\n                              productName: product.name,\r\n                              barcodeValue: product.barcode,\r\n                              price: product.sellingPrice,\r\n                              currency: settings.currency,\r\n                              showPrice: showPriceOnBarcode,\r\n                            });\r\n                            toast.success('Barcode exported as PDF');\r\n                          } catch (error) {\r\n                            console.error('Export failed:', error);\r\n                            toast.error('Failed to export barcode');\r\n                          } finally {\r\n                            setIsExporting(false);\r\n                          }\r\n                        }}\r\n                      >\r\n                        <Download className=\"h-4 w-4\" />\r\n                        PDF\r\n                      </Button>\r\n                    </div>\r\n\r\n                    <Button variant=\"outline\" className=\"w-full\" onClick={() => setBarcodeDialogOpen(false)}>\r\n                      Close\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </DialogContent>\r\n            </Dialog>\r\n\r\n            {/* Delete Button - Below Edit */}\r\n            {hasPermission('inventory', 'delete') && (\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => setDeleteDialogOpen(true)}\r\n                className=\"flex items-center justify-center gap-2 w-full lg:w-auto text-red-600 hover:text-red-700 border-red-200 hover:border-red-300 hover:bg-red-50 text-sm\"\r\n              >\r\n                <Trash2 className=\"h-4 w-4\" />\r\n                Delete\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid md:grid-cols-3 gap-6\">\r\n        <Card className=\"md:col-span-2\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex justify-between items-center\">\r\n              <span>Product Details</span>\r\n              {getStockStatusBadge()}\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-6\">\r\n            <div className=\"flex flex-col md:flex-row gap-6\">\r\n              {product.imageUrl && (\r\n                <div className=\"md:w-1/3\">\r\n                  <img\r\n                    src={product.imageUrl}\r\n                    alt={product.name}\r\n                    className=\"w-full h-auto object-contain border rounded-md\"\r\n                  />\r\n                </div>\r\n              )}\r\n\r\n              <div className={product.imageUrl ? 'md:w-2/3' : 'w-full'}>\r\n                <h2 className=\"text-2xl font-bold mb-2\">{product.name}</h2>\r\n\r\n                <div className=\"mb-4 flex flex-wrap gap-2\">\r\n                  <Badge variant=\"outline\">{product.category}</Badge>\r\n                  <Badge variant=\"secondary\">#{product.itemNumber}</Badge>\r\n                </div>\r\n\r\n                {product.description && (\r\n                  <p className=\"text-gray-700 mb-4\">{product.description}</p>\r\n                )}\r\n\r\n                <dl className=\"grid grid-cols-2 gap-x-4 gap-y-2\">\r\n                  <dt className=\"text-gray-500\">Item Number:</dt>\r\n                  <dd className=\"font-semibold\">#{product.itemNumber}</dd>\r\n\r\n                  {product.manufacturerBarcode && (\r\n                    <>\r\n                      <dt className=\"text-gray-500\">Manufacturer Barcode:</dt>\r\n                      <dd className=\"font-semibold\">{product.manufacturerBarcode}</dd>\r\n                    </>\r\n                  )}\r\n\r\n                  <dt className=\"text-gray-500\">Quantity in Stock:</dt>\r\n                  <dd className=\"font-semibold\">{product.quantity % 1 === 0 ? product.quantity : product.quantity.toFixed(2)}</dd>\r\n\r\n                  <dt className=\"text-gray-500\">Minimum Stock Level:</dt>\r\n                  <dd>{product.minimumStock}</dd>\r\n\r\n                  <dt className=\"text-gray-500\">Cost Price:</dt>\r\n                  <dd>{canViewCostPrice ? `${settings.currency} ${formatFinancial(product.costPrice, 'cost')}` : '•••'}</dd>\r\n\r\n                  <dt className=\"text-gray-500\">Selling Price:</dt>\r\n                  <dd>{canViewSellingPrice ? `${settings.currency} ${formatFinancial(product.sellingPrice, 'selling')}` : '•••'}</dd>\r\n\r\n                  <dt className=\"text-gray-500\">Total Cost:</dt>\r\n                  <dd className=\"font-semibold\">{canViewCostPrice ? `${settings.currency} ${formatNumber(product.quantity * product.costPrice)}` : '•••'}</dd>\r\n\r\n                  <dt className=\"text-gray-500\">Profit Margin:</dt>\r\n                  <dd>\r\n                    {canViewProfit ?\r\n                      `${((product.sellingPrice - product.costPrice) / product.sellingPrice * 100).toFixed(2)}%`\r\n                      : '•••'}\r\n                  </dd>\r\n\r\n                  {product.supplier && (\r\n                    <>\r\n                      <dt className=\"text-gray-500\">Supplier:</dt>\r\n                      <dd>{product.supplier}</dd>\r\n                    </>\r\n                  )}\r\n\r\n                  <dt className=\"text-gray-500\">Created:</dt>\r\n                  <dd>{format(product.createdAt, 'MMM d, yyyy')}</dd>\r\n\r\n                  <dt className=\"text-gray-500\">Last Updated:</dt>\r\n                  <dd>{format(product.updatedAt, 'MMM d, yyyy')}</dd>\r\n                </dl>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex flex-wrap gap-4\">\r\n              {product.quantity <= product.minimumStock && (\r\n                <div className=\"bg-amber-50 border border-amber-200 rounded-md p-4 w-full flex items-center gap-3\">\r\n                  <AlertCircle className=\"text-amber-600 h-6 w-6 flex-shrink-0\" />\r\n                  <div>\r\n                    <h4 className=\"font-medium text-amber-800\">Low Stock Alert</h4>\r\n                    <p className=\"text-sm text-amber-700\">\r\n                      Current stock ({product.quantity}) is below or equal to the minimum threshold ({product.minimumStock}).\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <div className=\"space-y-6\">\r\n          <Card>\r\n            <CardHeader className=\"pb-2\">\r\n              <CardTitle className=\"text-lg\">Stock Management</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {hasPermission('inventory', 'stock_adjustment') ? (\r\n                <div className=\"space-y-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium mb-1\">Adjustment Type</label>\r\n                    <div className=\"grid grid-cols-2 gap-4 mb-2\">\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant={adjustmentType === 'Stock In' ? 'default' : 'outline'}\r\n                        onClick={() => setAdjustmentType('Stock In')}\r\n                        className={`w-full ${adjustmentType === 'Stock In' ? 'bg-orange-600 hover:bg-orange-700' : ''}`}\r\n                      >\r\n                        <Plus className=\"mr-2 h-4 w-4\" />\r\n                        Stock In\r\n                      </Button>\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant={adjustmentType === 'Stock Out' ? 'default' : 'outline'}\r\n                        onClick={() => setAdjustmentType('Stock Out')}\r\n                        className={`w-full ${adjustmentType === 'Stock Out' ? 'bg-orange-600 hover:bg-orange-700' : ''}`}\r\n                      >\r\n                        <Minus className=\"mr-2 h-4 w-4\" />\r\n                        Stock Out\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium mb-1\">Quantity</label>\r\n                    <Input\r\n                      type=\"number\"\r\n                      min=\"0.01\"\r\n                      step=\"0.01\"\r\n                      value={adjustmentQuantity || ''}\r\n                      onChange={(e) => setAdjustmentQuantity(parseFloat(e.target.value) || 0)}\r\n                      placeholder=\"Enter quantity\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium mb-1\">Reason (Optional)</label>\r\n                    <Input\r\n                      type=\"text\"\r\n                      value={adjustmentReason}\r\n                      onChange={(e) => setAdjustmentReason(e.target.value)}\r\n                      placeholder=\"e.g., Weekly restock, Damaged goods\"\r\n                      maxLength={100}\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-2 gap-2\">\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium mb-1\">Date</label>\r\n                      <Input\r\n                        type=\"date\"\r\n                        value={adjustmentDate}\r\n                        onChange={(e) => setAdjustmentDate(e.target.value)}\r\n                        min={product.createdAt ? new Date(product.createdAt).toISOString().split('T')[0] : undefined}\r\n                        max={new Date().toISOString().split('T')[0]}\r\n                        className={validateAdjustmentDateTime(adjustmentDate, adjustmentTime) ? 'border-destructive border-2 bg-destructive/5' : ''}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium mb-1\">Time</label>\r\n                      <Input\r\n                        type=\"time\"\r\n                        step=\"1\"\r\n                        value={adjustmentTime}\r\n                        onChange={(e) => setAdjustmentTime(e.target.value)}\r\n                        className={validateAdjustmentDateTime(adjustmentDate, adjustmentTime) ? 'border-destructive border-2 bg-destructive/5' : ''}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  {validateAdjustmentDateTime(adjustmentDate, adjustmentTime) && (\r\n                    <p className=\"text-sm text-destructive mt-1\">{validateAdjustmentDateTime(adjustmentDate, adjustmentTime)}</p>\r\n                  )}\r\n\r\n                  <Button\r\n                    onClick={handleStockAdjustment}\r\n                    disabled={isApplying || adjustmentQuantity <= 0 || !!validateAdjustmentDateTime(adjustmentDate, adjustmentTime)}\r\n                    className=\"w-full bg-orange-600 hover:bg-orange-700\"\r\n                  >\r\n                    <Package className=\"mr-2 h-4 w-4\" />\r\n                    {isApplying ? 'Applying...' : `Apply ${adjustmentType}`}\r\n                  </Button>\r\n                </div>\r\n              ) : (\r\n                <div className=\"py-4 text-center space-y-2\">\r\n                  <AlertCircle className=\"h-8 w-8 text-muted-foreground mx-auto opacity-50\" />\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    You do not have permission to perform stock adjustments.\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n\r\n      <DeleteProductDialog\r\n        open={deleteDialogOpen}\r\n        onOpenChange={setDeleteDialogOpen}\r\n        product={product}\r\n        onConfirm={handleDeleteProduct}\r\n      />\r\n    </div >\r\n  );\r\n};\r\n\r\nexport default ProductDetails;","\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useStockHistory } from '@/hooks/useStockHistory';\r\nimport { useStockSummaryData } from '@/hooks/useStockSummaryData';\r\nimport { Product } from '@/types';\r\nimport { toast } from 'sonner';\r\nimport ProductDetails from '@/components/inventory/ProductDetails';\r\nimport ProductStockHistory from '@/components/inventory/ProductStockHistory';\r\n\r\nconst ProductDetail = () => {\r\n  const { id } = useParams<{ id: string }>();\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const { products, isLoading, loadProducts, refetch } = useProducts(user?.id, 10000); // Load all products\r\n  const [product, setProduct] = useState<Product | null>(null);\r\n  const { stockHistory, isLoading: isLoadingHistory, loadStockHistory, updateStockHistoryEntry, deleteStockHistoryEntry, recalculateProductStock } = useStockHistory(user?.id, id);\r\n  const { clearAllLocationCaches } = useStockSummaryData({ from: undefined, to: undefined });\r\n  const [isRefreshing, setIsRefreshing] = useState(false);\r\n  const [refreshKey, setRefreshKey] = useState(0);\r\n\r\n  const loadProductData = async () => {\r\n    if (id) {\r\n      setIsRefreshing(true);\r\n      const { data: refetchedData } = await refetch();\r\n      const fetchedProducts = refetchedData?.products || [];\r\n\r\n      const foundProduct = fetchedProducts.find(p => p.id === id);\r\n      if (foundProduct) {\r\n        setProduct(foundProduct);\r\n      } else {\r\n        toast.error('Product not found');\r\n        navigate('/inventory');\r\n      }\r\n\r\n      setIsRefreshing(false);\r\n    }\r\n  };\r\n\r\n  // Handle stock update callback - refresh both product and stock history\r\n  const handleStockUpdate = async () => {\r\n    await loadProductData();\r\n    if (id && loadStockHistory) {\r\n      await loadStockHistory();\r\n    }\r\n    setRefreshKey(prev => prev + 1);\r\n  };\r\n\r\n  // Stock history handlers\r\n  const handleEditStockHistory = async (entryId: string, newQuantity: number, newReason: string, newDate?: Date) => {\r\n    const success = await updateStockHistoryEntry(entryId, newQuantity, newReason, newDate);\r\n    if (success) {\r\n      // Clear stock summary cache to ensure data consistency\r\n      clearAllLocationCaches();\r\n      // updateStockHistoryEntry already recalculates the entire stock chain\r\n      // Just refresh the UI data\r\n      await Promise.all([\r\n        loadStockHistory(),\r\n        loadProductData()\r\n      ]);\r\n    }\r\n    return success;\r\n  };\r\n\r\n  const handleDeleteStockHistory = async (entryId: string) => {\r\n    const success = await deleteStockHistoryEntry(entryId);\r\n    if (success) {\r\n      // Clear stock summary cache to ensure data consistency\r\n      clearAllLocationCaches();\r\n      await Promise.all([\r\n        recalculateProductStock(product!.id),\r\n        loadStockHistory(),\r\n        loadProductData()\r\n      ]);\r\n    }\r\n    return success;\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!isLoading && products.length > 0 && id) {\r\n      const foundProduct = products.find(p => p.id === id);\r\n\r\n      if (foundProduct) {\r\n        setProduct(foundProduct);\r\n      } else {\r\n        toast.error('Product not found');\r\n        navigate('/inventory');\r\n      }\r\n    }\r\n  }, [id, products, isLoading, navigate]);\r\n\r\n  // Listen for stock updates from other components\r\n  useEffect(() => {\r\n    const handleStockUpdateEvent = () => {\r\n      console.log('Stock updated, refreshing product data');\r\n      handleStockUpdate();\r\n    };\r\n\r\n    window.addEventListener('stock-updated', handleStockUpdateEvent);\r\n\r\n    return () => {\r\n      window.removeEventListener('stock-updated', handleStockUpdateEvent);\r\n    };\r\n  }, [handleStockUpdate]);\r\n\r\n  if (isLoading || isRefreshing || !product) {\r\n    return (\r\n      <div className=\"flex flex-col items-center justify-center min-h-[60vh] space-y-4\">\r\n        <img\r\n          src=\"/lovable-uploads/7f7549a3-e9df-4762-b8b9-8e041e34f55d.png\"\r\n          alt=\"Loading\"\r\n          className=\"w-16 h-16 animate-spin\"\r\n        />\r\n        <p className=\"text-muted-foreground\">Loading product data...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Product Details Section */}\r\n      <ProductDetails\r\n        key={`details-${refreshKey}`}\r\n        product={product}\r\n        stockHistory={stockHistory}\r\n        isLoadingHistory={isLoadingHistory}\r\n        onStockUpdate={handleStockUpdate}\r\n      />\r\n\r\n      {/* Stock History Section */}\r\n      <ProductStockHistory\r\n        key={`history-${refreshKey}`}\r\n        stockHistory={stockHistory}\r\n        isLoadingHistory={isLoadingHistory}\r\n        onEditStockHistory={handleEditStockHistory}\r\n        onDeleteStockHistory={handleDeleteStockHistory}\r\n        products={products}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductDetail;\r\n","\r\nimport React from 'react';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport { Product } from '@/types';\r\n\r\ninterface DeleteProductDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  product: Product | null;\r\n  onConfirm: () => void;\r\n}\r\n\r\nconst DeleteProductDialog: React.FC<DeleteProductDialogProps> = ({\r\n  open,\r\n  onOpenChange,\r\n  product,\r\n  onConfirm,\r\n}) => {\r\n  const handleConfirm = () => {\r\n    onConfirm();\r\n    onOpenChange(false);\r\n  };\r\n\r\n  return (\r\n    <AlertDialog open={open} onOpenChange={onOpenChange}>\r\n      <AlertDialogContent>\r\n        <AlertDialogHeader>\r\n          <AlertDialogTitle>Are you sure?</AlertDialogTitle>\r\n          <AlertDialogDescription>\r\n            This will delete the product \"{product?.name}\" and all its associated data.\r\n            This action cannot be undone.\r\n          </AlertDialogDescription>\r\n        </AlertDialogHeader>\r\n        <AlertDialogFooter>\r\n          <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n          <AlertDialogAction onClick={handleConfirm} className=\"bg-red-600 hover:bg-red-700\">\r\n            Delete\r\n          </AlertDialogAction>\r\n        </AlertDialogFooter>\r\n      </AlertDialogContent>\r\n    </AlertDialog>\r\n  );\r\n};\r\n\r\nexport default DeleteProductDialog;\r\n","import React, { useState, useMemo } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { StockHistoryEntry } from '@/types';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Edit, Clock, Trash2, History } from 'lucide-react';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuTrigger,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuLabel,\r\n  DropdownMenuSeparator\r\n} from '@/components/ui/dropdown-menu';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\nimport { format } from 'date-fns';\r\nimport EditStockHistoryDialog from './EditStockHistoryDialog';\r\nimport DeleteStockHistoryDialog from './DeleteStockHistoryDialog';\r\n\r\ninterface ProductStockHistoryProps {\r\n  stockHistory: StockHistoryEntry[];\r\n  isLoadingHistory: boolean;\r\n  onEditStockHistory: (entryId: string, newQuantity: number, newReason: string, newDate?: Date) => Promise<boolean>;\r\n  onDeleteStockHistory: (entryId: string) => Promise<boolean>;\r\n  products: any[];\r\n}\r\n\r\nconst ProductStockHistory: React.FC<ProductStockHistoryProps> = ({\r\n  stockHistory,\r\n  isLoadingHistory,\r\n  onEditStockHistory,\r\n  onDeleteStockHistory,\r\n  products\r\n}) => {\r\n  const { hasPermission } = useProfiles();\r\n  const [editHistoryDialog, setEditHistoryDialog] = useState<{ open: boolean; entry: StockHistoryEntry | null }>({ open: false, entry: null });\r\n  const [deleteHistoryDialog, setDeleteHistoryDialog] = useState<{ open: boolean; entry: StockHistoryEntry | null }>({ open: false, entry: null });\r\n  const [expandedSale, setExpandedSale] = useState<string | null>(null);\r\n  const [expandedManual, setExpandedManual] = useState<string | null>(null);\r\n\r\n  // Check if a stock history entry was created by a sale operation\r\n  const isSaleRelatedEntry = (entry: StockHistoryEntry): boolean => {\r\n    const saleReasons = ['Sale', 'Delete sale', 'Deleted Sale', 'Sale qty edit'];\r\n    return saleReasons.some(reason => entry.changeReason.toLowerCase().includes(reason.toLowerCase()));\r\n  };\r\n\r\n  const formatChangeReason = (reason: string): string => {\r\n    return reason\r\n      .replace('Deleted sale', 'Deleted Sale');\r\n  };\r\n\r\n  // Check if a stock history entry is initial stock (first entry chronologically)\r\n  const isInitialStockEntry = (entry: StockHistoryEntry): boolean => {\r\n    if (stockHistory.length === 0) return false;\r\n\r\n    // Sort by creation date to find the chronologically first entry\r\n    const sortedHistory = [...stockHistory].sort((a, b) => a.createdAt.getTime() - b.createdAt.getTime());\r\n    return sortedHistory[0]?.id === entry.id;\r\n  };\r\n\r\n  // Prepare unified display items\r\n  const displayItems = useMemo(() => {\r\n    const saleGroups: Record<string, StockHistoryEntry[]> = {};\r\n    const singles: StockHistoryEntry[] = [];\r\n\r\n    // 1. Organize entries\r\n    stockHistory.forEach(entry => {\r\n      if (isSaleRelatedEntry(entry)) {\r\n        const key = entry.receiptNumber || entry.referenceId || entry.id;\r\n        if (!saleGroups[key]) saleGroups[key] = [];\r\n        saleGroups[key].push(entry);\r\n      } else {\r\n        singles.push(entry);\r\n      }\r\n    });\r\n\r\n    // 2. Create standardized items\r\n    const items = [\r\n      // Add sale groups\r\n      ...Object.values(saleGroups).map(group => {\r\n        // Sort inside group by date (Oldest -> Newest for correct timeline in details)\r\n        // If you want details to be Newest on top, swap a and b.\r\n        // User asked for \"Progressive order\", so let's stick to Oldest -> Newest for details too to be consistent.\r\n        // BUT current UI logic for \"main\" uses sorted[0] as display. Let's see.\r\n        // If I strictly follow chronological, details should be Oldest -> Newest.\r\n        // The previous code had `new Date(b.createdAt) - new Date(a.createdAt)` (Newest first).\r\n\r\n        // Let's sort Newest First for the \"main\" display (so we show the latest state),\r\n        // but for the sorting of the *Card* itself, we use the LATEST date (what is displayed) to avoid visual confusion.\r\n        const sortedForMain = [...group].sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\r\n        // const sortedForTimeline = [...group].sort((a, b) => new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime());\r\n\r\n        return {\r\n          type: 'sale' as const,\r\n          main: sortedForMain[0], // Display the latest state\r\n          all: sortedForMain, // Details table (Newest first is clearer for \"Recent actions\")\r\n          // Sort Key: Use the *displayed* date (Latest) to place it chronologically in the timeline relative to other events\r\n          sortDate: sortedForMain[0].createdAt\r\n        };\r\n      }),\r\n      // Add single entries\r\n      ...singles.map(entry => ({\r\n        type: 'single' as const,\r\n        entry,\r\n        sortDate: entry.createdAt\r\n      }))\r\n    ];\r\n\r\n    // 3. Sort main list Descending (Newest at Top, Oldest at Bottom)\r\n    // Ensure progressive order from bottom to top\r\n    return items.sort((a, b) => {\r\n      const dateA = new Date(a.sortDate).getTime();\r\n      const dateB = new Date(b.sortDate).getTime();\r\n      // console.log('Sort comparison:', { dateA, dateB, diff: dateB - dateA });\r\n      return dateB - dateA;\r\n    });\r\n  }, [stockHistory]);\r\n\r\n  const stockHistoryList = isLoadingHistory ? (\r\n    <div className=\"animate-pulse text-center py-8\">\r\n      <div className=\"w-16 h-16 bg-gray-200 rounded-full mx-auto mb-4\"></div>\r\n      <p className=\"text-gray-500\">Loading stock history...</p>\r\n    </div>\r\n  ) : stockHistory.length === 0 ? (\r\n    <div className=\"text-center py-8 text-gray-500\">\r\n      <History size={48} className=\"mx-auto mb-4 opacity-50\" />\r\n      <p>No stock history available for this product</p>\r\n      <p className=\"text-sm mt-2\">Stock changes will appear here once you make adjustments</p>\r\n    </div>\r\n  ) : (\r\n    <div className=\"space-y-3\">\r\n      {displayItems.map((item) => {\r\n        // SALE ITEM RENDER\r\n        if (item.type === 'sale') {\r\n          const { main, all } = item;\r\n          const saleKey = main.receiptNumber || main.referenceId || main.id;\r\n          const isExpanded = expandedSale === saleKey;\r\n\r\n          // Per-sale summary data (all is sorted Newest -> Oldest)\r\n          const currentRef = all[0];\r\n          const originalRef = all[all.length - 1];\r\n          const hasHistory = all.length > 1;\r\n\r\n          return (\r\n            <div key={main.id} className={`border rounded-lg p-4 transition-colors ${main.newQuantity > main.oldQuantity\r\n              ? 'bg-green-50 border-green-200 hover:bg-green-100'\r\n              : main.newQuantity < main.oldQuantity\r\n                ? 'bg-red-50 border-red-200 hover:bg-red-100'\r\n                : 'border-gray-200 hover:bg-gray-50'\r\n              }`}>\r\n              <div className=\"flex justify-between items-start\">\r\n                <div className=\"flex-1\">\r\n                  <div className=\"flex items-center gap-2 mb-2\">\r\n                    <Badge variant=\"outline\" className=\"text-xs\">\r\n                      Sale - {main.receiptNumber || main.referenceId || main.id}\r\n                    </Badge>\r\n                    {hasHistory && (\r\n                      <Badge variant=\"secondary\" className=\"text-[10px] h-5\">\r\n                        Edited\r\n                      </Badge>\r\n                    )}\r\n                  </div>\r\n\r\n                  <div className=\"flex items-center gap-2 mt-1\">\r\n                    {hasHistory ? (\r\n                      <>\r\n                        <Badge variant=\"outline\" className=\"text-xs bg-muted/50 font-normal\">\r\n                          Original: {originalRef.oldQuantity} → {originalRef.newQuantity} ({originalRef.newQuantity - originalRef.oldQuantity > 0 ? '+' : ''}{originalRef.newQuantity - originalRef.oldQuantity})\r\n                        </Badge>\r\n                        <span className=\"text-muted-foreground\">→</span>\r\n                        <Badge variant=\"secondary\" className=\"text-xs font-normal\">\r\n                          Current: {currentRef.oldQuantity} → {currentRef.newQuantity} ({currentRef.newQuantity - currentRef.oldQuantity > 0 ? '+' : ''}{currentRef.newQuantity - currentRef.oldQuantity})\r\n                        </Badge>\r\n                      </>\r\n                    ) : (\r\n                      <Badge variant=\"outline\" className=\"text-xs bg-muted/50 font-normal\">\r\n                        Qty: {main.oldQuantity} → {main.newQuantity} ({main.newQuantity - main.oldQuantity > 0 ? '+' : ''}{main.newQuantity - main.oldQuantity})\r\n                      </Badge>\r\n                    )}\r\n                    {!hasHistory && (\r\n                      <div className=\"text-sm text-gray-500 flex items-center gap-1 ml-2\">\r\n                        <Clock className=\"inline-block w-3 h-3\" />\r\n                        {format(main.createdAt, 'MMM d, yyyy h:mm a')}\r\n                      </div>\r\n                    )}\r\n                    {hasHistory && (\r\n                      <div className=\"text-sm text-gray-500 flex items-center gap-1 ml-2\">\r\n                        <Clock className=\"inline-block w-3 h-3\" />\r\n                        {/* Show Last Edit Time */}\r\n                        {format(currentRef.createdAt, 'MMM d, yyyy h:mm a')}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"h-8 px-2 text-xs\"\r\n                    onClick={() => setExpandedSale(isExpanded ? null : saleKey)}\r\n                  >\r\n                    {isExpanded ? 'Hide Details' : 'View Details'}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n              {isExpanded && (\r\n                <div className=\"mt-4 border-t pt-3\">\r\n                  <div className=\"font-semibold mb-2 text-sm text-muted-foreground\">Sale Actions</div>\r\n                  <div className=\"overflow-x-auto\">\r\n                    <table className=\"min-w-full text-xs border\">\r\n                      <thead>\r\n                        <tr className=\"bg-muted/50\">\r\n                          <th className=\"px-2 py-1 text-left\">Action</th>\r\n                          <th className=\"px-2 py-1 text-left\">Date</th>\r\n                          <th className=\"px-2 py-1 text-left\">Qty Change</th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody>\r\n                        {all.map((entry) => (\r\n                          <tr key={entry.id} className=\"border-b last:border-b-0\">\r\n                            <td className=\"px-2 py-1 font-medium\">{formatChangeReason(entry.changeReason)}</td>\r\n                            <td className=\"px-2 py-1 text-muted-foreground\">{format(entry.createdAt, 'MMM d, yyyy h:mm a')}</td>\r\n                            <td className=\"px-2 py-1\">{entry.oldQuantity} → {entry.newQuantity} ({entry.newQuantity - entry.oldQuantity > 0 ? '+' : ''}{entry.newQuantity - entry.oldQuantity})</td>\r\n                          </tr>\r\n                        ))}\r\n                      </tbody>\r\n                    </table>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        } else {\r\n          // SINGLE ENTRY RENDER\r\n          const { entry } = item;\r\n          const isExpanded = expandedManual === entry.id;\r\n          return (\r\n            <div key={entry.id} className={`border rounded-lg p-4 transition-colors ${entry.newQuantity > entry.oldQuantity\r\n              ? 'bg-green-50 border-green-200 hover:bg-green-100'\r\n              : entry.newQuantity < entry.oldQuantity\r\n                ? 'bg-red-50 border-red-200 hover:bg-red-100'\r\n                : 'border-gray-200 hover:bg-gray-50'\r\n              }`}>\r\n              <div className=\"flex justify-between items-start\">\r\n                <div className=\"flex-1\">\r\n                  <div className=\"flex items-center gap-2 mb-2\">\r\n                    <Badge variant=\"outline\" className=\"text-xs\">\r\n                      {formatChangeReason(entry.changeReason)}\r\n                      {entry.receiptNumber && ` - #${entry.receiptNumber}`}\r\n                    </Badge>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2 mt-1\">\r\n                    <Badge variant=\"outline\" className=\"text-xs bg-muted/50 font-normal\">\r\n                      Qty: {entry.oldQuantity} → {entry.newQuantity} ({entry.newQuantity - entry.oldQuantity > 0 ? '+' : ''}{entry.newQuantity - entry.oldQuantity})\r\n                    </Badge>\r\n                    <div className=\"text-sm text-gray-500 flex items-center gap-1 ml-2\">\r\n                      <Clock className=\"inline-block w-3 h-3\" />\r\n                      {format(entry.createdAt, 'MMM d, yyyy h:mm a')}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"h-8 px-2 text-xs\"\r\n                    onClick={() => setExpandedManual(isExpanded ? null : entry.id)}\r\n                  >\r\n                    {isExpanded ? 'Hide Details' : 'View Details'}\r\n                  </Button>\r\n                  {isInitialStockEntry(entry) ? (\r\n                    <>\r\n                      {hasPermission('inventory', 'edit') && (\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => setEditHistoryDialog({ open: true, entry })}\r\n                          className=\"h-8 px-2\"\r\n                        >\r\n                          <Edit className=\"h-3 w-3\" />\r\n                        </Button>\r\n                      )}\r\n                      <div className=\"text-xs text-muted-foreground px-2 py-1 bg-blue-100 text-blue-800 rounded\">\r\n                        Initial Stock\r\n                      </div>\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      {hasPermission('inventory', 'edit') && (\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => setEditHistoryDialog({ open: true, entry })}\r\n                          className=\"h-8 px-2\"\r\n                        >\r\n                          <Edit className=\"h-3 w-3\" />\r\n                        </Button>\r\n                      )}\r\n                      {hasPermission('inventory', 'delete') && (\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => setDeleteHistoryDialog({ open: true, entry })}\r\n                          className=\"h-8 px-2 text-destructive hover:text-destructive\"\r\n                        >\r\n                          <Trash2 className=\"h-3 w-3\" />\r\n                        </Button>\r\n                      )}\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              {isExpanded && (\r\n                <div className=\"mt-4 border-t pt-3\">\r\n                  <div className=\"font-semibold mb-2 text-sm text-muted-foreground\">Details</div>\r\n                  <div className=\"overflow-x-auto\">\r\n                    <table className=\"min-w-full text-xs border\">\r\n                      <thead>\r\n                        <tr className=\"bg-muted/50\">\r\n                          <th className=\"px-2 py-1 text-left\">Reason</th>\r\n                          <th className=\"px-2 py-1 text-left\">Date</th>\r\n                          <th className=\"px-2 py-1 text-left\">Qty Change</th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody>\r\n                        <tr className=\"border-b last:border-b-0\">\r\n                          <td className=\"px-2 py-1 font-medium\">{formatChangeReason(entry.changeReason)}</td>\r\n                          <td className=\"px-2 py-1 text-muted-foreground\">{format(entry.createdAt, 'MMM d, yyyy h:mm a')}</td>\r\n                          <td className=\"px-2 py-1\">{entry.oldQuantity} → {entry.newQuantity} ({entry.newQuantity - entry.oldQuantity > 0 ? '+' : ''}{entry.newQuantity - entry.oldQuantity})</td>\r\n                        </tr>\r\n                      </tbody>\r\n                    </table>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        }\r\n      })}\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center justify-between\">\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <History className=\"h-5 w-5\" />\r\n              Stock History\r\n              {stockHistory.length > 0 && (\r\n                <Badge variant=\"secondary\" className=\"ml-2\">\r\n                  {stockHistory.length} entries\r\n                </Badge>\r\n              )}\r\n            </CardTitle>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {stockHistoryList}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <EditStockHistoryDialog\r\n        open={editHistoryDialog.open}\r\n        onOpenChange={(open) => setEditHistoryDialog({ open, entry: null })}\r\n        entry={editHistoryDialog.entry}\r\n        onConfirm={onEditStockHistory}\r\n        isInitialStock={editHistoryDialog.entry ? isInitialStockEntry(editHistoryDialog.entry) : false}\r\n        stockHistory={stockHistory}\r\n        productCreatedAt={editHistoryDialog.entry ? (() => {\r\n          const product = products.find(p => p.id === editHistoryDialog.entry?.productId);\r\n          return product ? new Date(product.createdAt) : undefined;\r\n        })() : undefined}\r\n      />\r\n\r\n      <DeleteStockHistoryDialog\r\n        open={deleteHistoryDialog.open}\r\n        onOpenChange={(open) => setDeleteHistoryDialog({ open, entry: null })}\r\n        entry={deleteHistoryDialog.entry}\r\n        onConfirm={onDeleteStockHistory}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ProductStockHistory;","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Minus\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNSAxMmgxNCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/minus\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Minus = createLucideIcon('Minus', [['path', { d: 'M5 12h14', key: '1ays0h' }]]);\n\nexport default Minus;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name FileImage\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTUgMkg2YTIgMiAwIDAgMC0yIDJ2MTZhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMi0yVjdaIiAvPgogIDxwYXRoIGQ9Ik0xNCAydjRhMiAyIDAgMCAwIDIgMmg0IiAvPgogIDxjaXJjbGUgY3g9IjEwIiBjeT0iMTIiIHI9IjIiIC8+CiAgPHBhdGggZD0ibTIwIDE3LTEuMjk2LTEuMjk2YTIuNDEgMi40MSAwIDAgMC0zLjQwOCAwTDkgMjIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/file-image\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst FileImage = createLucideIcon('FileImage', [\n  ['path', { d: 'M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z', key: '1rqfz7' }],\n  ['path', { d: 'M14 2v4a2 2 0 0 0 2 2h4', key: 'tnqrlb' }],\n  ['circle', { cx: '10', cy: '12', r: '2', key: '737tya' }],\n  ['path', { d: 'm20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22', key: 'wt3hpn' }],\n]);\n\nexport default FileImage;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Copy\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cmVjdCB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHg9IjgiIHk9IjgiIHJ4PSIyIiByeT0iMiIgLz4KICA8cGF0aCBkPSJNNCAxNmMtMS4xIDAtMi0uOS0yLTJWNGMwLTEuMS45LTIgMi0yaDEwYzEuMSAwIDIgLjkgMiAyIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/copy\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Copy = createLucideIcon('Copy', [\n  ['rect', { width: '14', height: '14', x: '8', y: '8', rx: '2', ry: '2', key: '17jyea' }],\n  ['path', { d: 'M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2', key: 'zix9uf' }],\n]);\n\nexport default Copy;\n"],"names":[],"mappings":"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","ignoreList":[5,6,7]}