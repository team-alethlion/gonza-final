module.exports=[383436,a=>{"use strict";let b=(0,a.i(564375).default)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);a.s(["Ban",()=>b],383436)},437322,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(811705),f=a.i(499239),g=a.i(369773),h=a.i(383436),i=a.i(515016),j=a.i(352519),k=a.i(224993),l=a.i(799856),m=a.i(625250),n=b([e,k,l,m]);[e,k,l,m]=n.then?(await n)():n,a.s(["default",0,({products:a,hideStockValue:b=!1,totalCountOverride:c,totalCostValueOverride:n,lowStockOverride:o,outOfStockOverride:p,totalStockValueOverride:q})=>{let{settings:r}=(0,k.useBusinessSettings)(),{canViewCostPrice:s,canViewSellingPrice:t}=(0,m.useFinancialVisibility)(),u="number"==typeof c?c:a.length,v="number"==typeof o?o:a.filter(a=>a.quantity>0&&a.quantity<=a.minimumStock).length,w="number"==typeof p?p:a.filter(a=>0===a.quantity).length,x="number"==typeof n?n:a.reduce((a,b)=>a+b.costPrice*b.quantity,0),y="number"==typeof q?q:a.reduce((a,b)=>a+b.sellingPrice*b.quantity,0),z=a=>{let b=a.length;return b>15?"text-sm md:text-lg":b>12?"text-base md:text-xl":b>8?"text-lg md:text-xl":"text-lg md:text-2xl"};return(0,d.jsxs)("div",{className:`grid gap-3 md:gap-4 mb-6 ${b?"grid-cols-2 md:grid-cols-4":"grid-cols-2 md:grid-cols-3 xl:grid-cols-5"}`,children:[(0,d.jsx)(e.Card,{className:"overflow-hidden",children:(0,d.jsx)(e.CardContent,{className:"p-4 md:p-6",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-blue-100 text-blue-500",children:(0,d.jsx)(f.Package,{className:"h-4 w-4 md:h-5 md:w-5"})}),(0,d.jsxs)("div",{className:"ml-3 md:ml-4 min-w-0",children:[(0,d.jsx)("p",{className:"text-xs md:text-sm font-medium text-gray-500 truncate",children:"Total Products"}),(0,d.jsx)("h3",{className:"text-lg md:text-2xl font-bold",children:u})]})]})})}),(0,d.jsx)(e.Card,{className:"overflow-hidden",children:(0,d.jsx)(e.CardContent,{className:"p-4 md:p-6",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-amber-100 text-amber-500",children:(0,d.jsx)(g.AlertTriangle,{className:"h-4 w-4 md:h-5 md:w-5"})}),(0,d.jsxs)("div",{className:"ml-3 md:ml-4 min-w-0",children:[(0,d.jsx)("p",{className:"text-xs md:text-sm font-medium text-gray-500 truncate",children:"Low Stock"}),(0,d.jsx)("h3",{className:"text-lg md:text-2xl font-bold",children:v})]})]})})}),(0,d.jsx)(e.Card,{className:"overflow-hidden",children:(0,d.jsx)(e.CardContent,{className:"p-4 md:p-6",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-red-100 text-red-500",children:(0,d.jsx)(h.Ban,{className:"h-4 w-4 md:h-5 md:w-5"})}),(0,d.jsxs)("div",{className:"ml-3 md:ml-4 min-w-0",children:[(0,d.jsx)("p",{className:"text-xs md:text-sm font-medium text-gray-500 truncate",children:"Out of Stock"}),(0,d.jsx)("h3",{className:"text-lg md:text-2xl font-bold",children:w})]})]})})}),(0,d.jsx)(e.Card,{className:"overflow-hidden",children:(0,d.jsx)(e.CardContent,{className:"p-4 md:p-6",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-green-100 text-green-500",children:(0,d.jsx)(i.TrendingUp,{className:"h-4 w-4 md:h-5 md:w-5"})}),(0,d.jsxs)("div",{className:"ml-3 md:ml-4 min-w-0 flex-1",children:[(0,d.jsx)("p",{className:"text-xs md:text-sm font-medium text-gray-500 truncate",children:"Cost Value"}),(0,d.jsx)("h3",{className:`${z(`${r.currency} ${(0,l.formatNumber)(x)}`)} font-bold break-all leading-tight`,children:s?`${r.currency} ${(0,l.formatNumber)(x)}`:"•••"})]})]})})}),!b&&(0,d.jsx)(e.Card,{className:"overflow-hidden",children:(0,d.jsx)(e.CardContent,{className:"p-4 md:p-6",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-purple-100 text-purple-500",children:(0,d.jsx)(j.DollarSign,{className:"h-4 w-4 md:h-5 md:w-5"})}),(0,d.jsxs)("div",{className:"ml-3 md:ml-4 min-w-0 flex-1",children:[(0,d.jsx)("p",{className:"text-xs md:text-sm font-medium text-gray-500 truncate",children:"Stock Value"}),(0,d.jsx)("h3",{className:`${z(`${r.currency} ${(0,l.formatNumber)(y)}`)} font-bold break-all leading-tight`,children:t?`${r.currency} ${(0,l.formatNumber)(y)}`:"•••"})]})]})})})]})}]),c()}catch(a){c(a)}},!1),217093,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(531811),f=a.i(482331),g=a.i(985522),h=a.i(169320),i=b([e,f,g,h]);[e,f,g,h]=i.then?(await i)():i,a.s(["useBulkProducts",0,()=>{let{user:a}=(0,e.useAuth)(),{createProduct:b}=(0,f.useProducts)(a?.id),{categories:c,createCategory:i}=(0,g.useCategories)(a?.id),[j,k]=(0,d.useState)(!1),l=async a=>{let b=c.map(a=>a.name.toLowerCase()),d=[...new Set(a.filter(a=>""!==a.trim()))].filter(a=>!b.includes(a.toLowerCase())),e=[],f=[];for(let a of d)try{await i(a)?e.push(a):f.push(a)}catch(b){console.error(`Failed to create category ${a}:`,b),f.push(a)}return{createdCategories:e,failedCategories:f}};return{bulkCreateProducts:async(c,d)=>{if(!a?.id)throw Error("User not authenticated");k(!0);let e=0,f=0,g=[];try{let a=c.map(a=>a.category).filter(Boolean);if(a.length>0){let{createdCategories:b,failedCategories:c}=await l(a);b.length>0&&h.toast.success(`Created ${b.length} new categories`),c.length>0&&h.toast.error(`Failed to create ${c.length} categories`)}for(let a=0;a<c.length;a++){let h=c[a];try{await b(h)?e++:(f++,g.push(`Failed to create product: ${h.name}`))}catch(a){f++,g.push(`Error creating ${h.name}: ${a}`),console.error(`Error creating product ${h.name}:`,a)}d&&d(e+f,c.length)}return!d&&(e>0&&h.toast.success(`Successfully created ${e} products`),f>0&&h.toast.error(`${f} products failed to upload`)),{successCount:e,failureCount:f,errors:g}}finally{k(!1)}},detectNewCategories:a=>{let b=c.map(a=>a.name.toLowerCase()),d=a.map(a=>a.category).filter(Boolean);return[...new Set(d)].filter(a=>!b.includes(a.toLowerCase()))},isUploading:j}}]),c()}catch(a){c(a)}},!1),468996,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(482626),f=a.i(73679),g=a.i(436028),h=a.i(114748),i=a.i(289118),j=b([e,i]);[e,i]=j.then?(await j)():j,a.s(["BulkOperationProgress",0,({title:a,currentCount:b,totalCount:c,status:j,successCount:k,failureCount:l})=>{let m=Math.round(b/c*100);return(0,d.jsxs)("div",{className:"space-y-6 py-4",children:["processing"===j&&(0,d.jsxs)(i.Alert,{children:[(0,d.jsx)(h.Info,{className:"h-4 w-4"}),(0,d.jsx)(i.AlertDescription,{children:(0,d.jsx)("strong",{children:"Please do not close this tab or dialog until the process is complete."})})]}),(0,d.jsxs)("div",{className:"text-center space-y-4",children:["processing"===j?(0,d.jsx)("div",{className:"mx-auto h-12 w-12 animate-spin rounded-full border-4 border-muted border-t-primary"}):"completed"===j?(0,d.jsx)(f.CheckCircle,{className:"mx-auto h-12 w-12 text-green-500"}):(0,d.jsx)(g.AlertCircle,{className:"mx-auto h-12 w-12 text-destructive"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-lg font-semibold",children:a}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"processing"===j?`Processing item ${b} of ${c}`:"completed"===j?`Successfully processed ${k??c} items${l?`, ${l} failed`:""}`:"The operation failed to complete."})]})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex justify-between text-xs font-medium text-muted-foreground",children:[(0,d.jsx)("span",{children:"Progress"}),(0,d.jsxs)("span",{children:[m,"%"]})]}),(0,d.jsx)(e.Progress,{value:m,className:"h-2 w-full"})]}),(void 0!==k||void 0!==l)&&"completed"===j&&(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[(0,d.jsxs)("div",{className:"bg-green-50 border border-green-100 rounded-lg p-3 text-center",children:[(0,d.jsx)("div",{className:"text-xl font-bold text-green-700",children:k??0}),(0,d.jsx)("div",{className:"text-xs text-green-600 font-medium",children:"Successful"})]}),(0,d.jsxs)("div",{className:"bg-red-50 border border-red-100 rounded-lg p-3 text-center",children:[(0,d.jsx)("div",{className:"text-xl font-bold text-red-700",children:l??0}),(0,d.jsx)("div",{className:"text-xs text-red-600 font-medium",children:"Failed"})]})]})]})}]),c()}catch(a){c(a)}},!1),965549,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(109254),g=a.i(396465),h=a.i(811705),i=a.i(289118),j=a.i(455756),k=a.i(199987),l=a.i(436028),m=a.i(532572),n=a.i(493901),o=a.i(176452),p=a.i(799856),q=a.i(899054),r=a.i(217093),s=a.i(468996),t=b([f,g,h,i,p,q,r,s]);[f,g,h,i,p,q,r,s]=t.then?(await t)():t,a.s(["default",0,({open:a,onOpenChange:b,onUpload:c,categories:t})=>{let{detectNewCategories:u,bulkCreateProducts:v}=(0,r.useBulkProducts)(),[w,x]=(0,e.useState)({step:"select",file:null,validRows:[],errors:[],totalRows:0,uploadProgress:0,successCount:0,failureCount:0,newCategories:[],currentProductIndex:0}),y=(0,e.useRef)(null),[z,A]=(0,e.useState)(!1),[B,C]=(0,e.useState)(!1),D=async a=>{if(!a.name.endsWith(".csv"))return void alert("Please select a CSV file");let b=await a.text(),c=(0,o.parseCSV)(b),d=c.validRows.map(E),e=u(d);x({...w,step:"preview",file:a,validRows:c.validRows,errors:c.errors,totalRows:c.totalRows,newCategories:e})},E=a=>{let b=new Date,c=a["Creation Date"];if(c){let a=c.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(a){let[,c,d,e]=a;b=new Date(parseInt(e),parseInt(d)-1,parseInt(c))}else{let a=new Date(c);isNaN(a.getTime())||(b=a)}}return{name:a["Product Name"],category:a.Category||"",description:a.Description||"",supplier:a.Supplier||"",quantity:a["Initial Stock"]?Number(a["Initial Stock"]):0,minimumStock:a["Minimum Stock Level"]?Number(a["Minimum Stock Level"]):void 0,costPrice:a["Cost Price"]?Number(a["Cost Price"]):void 0,sellingPrice:a["Selling Price"]?Number(a["Selling Price"]):void 0,manufacturerBarcode:a["Manufacturer Barcode"]||"",imageFile:null,imageUrl:null,createdAt:b}},F=async()=>{x(a=>({...a,step:"uploading",uploadProgress:0,currentProductIndex:0})),C(!0);let a=w.validRows.map(E);try{await v(a,(a,b)=>{let c=Math.round(a/b*100);x(b=>({...b,uploadProgress:c,currentProductIndex:a,successCount:a,failureCount:0}))}),x(b=>({...b,step:"complete",uploadProgress:100,successCount:a.length,failureCount:0,currentProductIndex:a.length}))}catch(b){console.error("Bulk upload failed:",b),x(b=>({...b,step:"complete",uploadProgress:100,successCount:0,failureCount:a.length,currentProductIndex:a.length}))}finally{C(!1)}};return(0,d.jsx)(f.Dialog,{open:a,onOpenChange:a=>{B||b(a)},children:(0,d.jsxs)(f.DialogContent,{className:"sm:max-w-[500px] pointer-events-auto",children:[(0,d.jsxs)(f.DialogHeader,{children:[(0,d.jsxs)(f.DialogTitle,{className:"flex items-center gap-2",children:[(0,d.jsx)(k.FileText,{className:"h-5 w-5"}),"Upload Products via CSV"]}),(0,d.jsx)(f.DialogDescription,{children:"Upload multiple products at once using a CSV file (DD/MM/YYYY date format)"})]}),"select"===w.step&&(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:(0,p.cn)("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors",z?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"),onDrop:a=>{a.preventDefault(),A(!1);let b=a.dataTransfer.files[0];b&&D(b)},onDragOver:a=>{a.preventDefault(),A(!0)},onDragLeave:()=>{A(!1)},onClick:()=>y.current?.click(),children:[(0,d.jsx)(j.Upload,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,d.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload CSV File"}),(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Drag and drop your CSV file here, or click to browse"}),(0,d.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"Supports all date formats | Accepts negative values | Use quotes for fields with commas"})]}),(0,d.jsx)("input",{ref:y,type:"file",accept:".csv",onChange:a=>{let b=a.target.files?.[0];b&&D(b)},className:"hidden"})]}),"preview"===w.step&&(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,d.jsx)(h.Card,{children:(0,d.jsxs)(h.CardContent,{className:"pt-6",children:[(0,d.jsx)("div",{className:"text-2xl font-bold text-green-600",children:w.validRows.length}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:"Valid products"})]})}),(0,d.jsx)(h.Card,{children:(0,d.jsxs)(h.CardContent,{className:"pt-6",children:[(0,d.jsx)("div",{className:"text-2xl font-bold text-red-600",children:w.errors.length}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:"Errors found"})]})}),(0,d.jsx)(h.Card,{children:(0,d.jsxs)(h.CardContent,{className:"pt-6",children:[(0,d.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:w.totalRows}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total rows"})]})})]}),w.newCategories.length>0&&(0,d.jsxs)(i.Alert,{children:[(0,d.jsx)(n.Plus,{className:"h-4 w-4"}),(0,d.jsx)(i.AlertDescription,{children:(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("p",{children:["The following ",w.newCategories.length," new categories will be created:"]}),(0,d.jsx)("div",{className:"flex flex-wrap gap-1",children:w.newCategories.map((a,b)=>(0,d.jsx)(q.Badge,{variant:"outline",className:"text-xs",children:a},b))})]})})]}),w.errors.length>0&&(0,d.jsxs)(i.Alert,{variant:"destructive",children:[(0,d.jsx)(l.AlertCircle,{className:"h-4 w-4"}),(0,d.jsxs)(i.AlertDescription,{children:[w.errors.length," rows have errors and will be skipped.",(0,d.jsxs)(g.Button,{variant:"link",className:"p-0 h-auto ml-2",onClick:()=>(0,o.generateErrorLogCSV)(w.errors),children:[(0,d.jsx)(m.Download,{className:"h-3 w-3 mr-1"}),"Download error log"]})]})]}),(0,d.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,d.jsx)(g.Button,{variant:"outline",onClick:()=>x(a=>({...a,step:"select"})),children:"Back"}),(0,d.jsxs)(g.Button,{onClick:F,disabled:0===w.validRows.length,children:["Upload ",w.validRows.length," Products",w.newCategories.length>0&&` & Create ${w.newCategories.length} Categories`]})]})]}),"uploading"===w.step&&(0,d.jsx)(s.BulkOperationProgress,{title:"Uploading Products...",currentCount:w.currentProductIndex,totalCount:w.validRows.length,status:"processing"}),"complete"===w.step&&(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)(s.BulkOperationProgress,{title:"Upload Complete!",currentCount:w.currentProductIndex,totalCount:w.validRows.length,status:w.failureCount>0?"failed":"completed",successCount:w.successCount,failureCount:w.failureCount}),(0,d.jsx)("div",{className:"flex justify-center",children:(0,d.jsx)(g.Button,{onClick:()=>{if(B)return;let a="complete"===w.step&&w.successCount>0;x({step:"select",file:null,validRows:[],errors:[],totalRows:0,uploadProgress:0,successCount:0,failureCount:0,newCategories:[],currentProductIndex:0}),b(!1),a&&setTimeout(()=>{window.location.reload()},100)},children:"Close"})})]})]})})}]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=_af77d944._.js.map