module.exports=[270602,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(25670),f=a.i(396465),g=a.i(199987),h=b([f]);[f]=h.then?(await h)():h,a.s(["default",0,()=>{let a=(0,e.useRouter)();return(0,d.jsx)("div",{className:"text-center py-12 bg-white rounded-lg shadow-md p-8",children:(0,d.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,d.jsx)("div",{className:"bg-slate-100 rounded-full p-4 w-16 h-16 flex items-center justify-center",children:(0,d.jsx)(g.FileText,{className:"h-8 w-8 text-slate-400"})}),(0,d.jsx)("h3",{className:"text-xl font-semibold",children:"No sales records found"}),(0,d.jsx)("p",{className:"text-gray-500 mb-4",children:"Create your first sale to start tracking your business performance"}),(0,d.jsx)(f.Button,{onClick:()=>a.push("/new-sale"),className:"mt-2",children:"Create Your First Sale"})]})})}]),c()}catch(a){c(a)}},!1),339027,a=>{"use strict";var b=a.i(508171);a.s(["default",0,()=>(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-border/50",children:[(0,b.jsx)("div",{className:"p-4 sm:p-6 border-b border-border/50",children:(0,b.jsx)("div",{className:"flex flex-col gap-4",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"h-8 bg-gray-200 rounded w-48 animate-pulse"}),(0,b.jsx)("div",{className:"h-4 bg-gray-200 rounded w-32 mt-2 animate-pulse"})]}),(0,b.jsx)("div",{className:"h-10 bg-gray-200 rounded w-32 animate-pulse"})]})})}),(0,b.jsx)("div",{className:"p-4 sm:p-6",children:(0,b.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)("div",{className:"h-16 bg-gray-100 rounded animate-pulse"},c))})})]})])},129298,a=>{"use strict";var b=a.i(508171),c=a.i(25670);a.s(["default",0,()=>{let a=(0,c.useRouter)();return(0,b.jsx)("div",{className:"p-6 text-center",children:(0,b.jsxs)("div",{className:"bg-amber-50 border border-amber-200 p-4 rounded-md",children:[(0,b.jsx)("p",{className:"text-amber-800 mb-4",children:"No business location found. Please create a business location to manage sales."}),(0,b.jsx)("button",{onClick:()=>a.push("/business-management"),className:"bg-amber-600 text-white px-4 py-2 rounded hover:bg-amber-700",children:"Manage Business Locations"})]})})}])},128904,a=>{"use strict";var b=a.i(792071);a.s(["exportToCSV",0,a=>{let c=new Blob([["Receipt #,Date,Customer,Items,Items Count,Total Amount,Amount Paid,Amount Due,Status",...a.map(a=>{let c=a.items.reduce((a,b)=>a+b.price*b.quantity,0),d=a.items.map(a=>a.description).join("; ");return[a.receiptNumber,(0,b.format)(new Date(a.date),"yyyy-MM-dd HH:mm"),a.customerName,d,a.items.length.toString(),c.toFixed(2),(a.amountPaid||0).toFixed(2),(a.amountDue||0).toFixed(2),a.paymentStatus]}).map(a=>a.map(a=>`"${a.toString().replace(/"/g,'""')}"`).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a");if(void 0!==d.download){let a=URL.createObjectURL(c);d.setAttribute("href",a),d.setAttribute("download",`sales_export_${(0,b.format)(new Date,"yyyy-MM-dd_HHmm")}.csv`),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d)}}])},40821,a=>{"use strict";var b=a.i(959866),c=a.i(792071);a.s(["generateSalesReportVectorPDF",0,(a,d,e="USD",f,g)=>{let h,i=new b.default({orientation:"landscape",unit:"mm",format:"a4",compress:!0}),j=i.internal.pageSize.getWidth(),k=i.internal.pageSize.getHeight(),l=j-15-15,m=15,n=()=>{i.setFontSize(8),i.setFont("helvetica","normal"),i.setTextColor(150,150,150),i.text("Created By Gonza Systems",j/2,k-10,{align:"center"}),i.setTextColor(0,0,0)},o=[18,20,28,45,16,20,22,18,20,18,28],p=["Receipt #","Date","Customer","Items","Qty","Unit Price","Subtotal","Discount","Net","Tax","Total"],q=()=>{i.setFillColor(243,244,246),i.rect(15,m-2,l,12,"F"),i.setLineWidth(.3),i.rect(15,m-2,l,12),i.setFontSize(9),i.setFont("helvetica","bold");let a=15;p.forEach((b,c)=>{let d=o[c],e=i.getTextWidth(b),f=a+(d-e)/2;i.text(b,f,m+7),c<p.length-1&&i.line(a+d,m-2,a+d,m+12-2),a+=d}),m+=12},r=a=>m+a>k-15-15&&(n(),i.addPage(),m=15,q(),i.setFont("helvetica","normal"),i.setFontSize(8),!0),s=m;g&&(i.setFontSize(12),i.setFont("helvetica","bold"),i.text(g.businessName,15,m),m+=6,i.setFontSize(9),i.setFont("helvetica","normal"),i.text(g.businessAddress,15,m),m+=5,i.text(g.businessPhone,15,m),m+=5,i.text(g.businessEmail,15,m)),m=s,i.setFontSize(20),i.setFont("helvetica","bold");let t=`Comprehensive Sales Report (${e})`,u=i.getTextWidth(t);if(i.text(t,j-15-u,m),m+=12,f?.from&&f?.to){i.setFontSize(14),i.setFont("helvetica","normal");let a=(0,c.format)(f.from,"dd/MM/yyyy"),b=(0,c.format)(f.to,"dd/MM/yyyy"),d=a===b?a:`${a} - ${b}`,e=i.getTextWidth(d);i.text(d,j-15-e,m),m+=15}else{i.setFontSize(14),i.setFont("helvetica","normal");let a=(0,c.format)(new Date,"dd/MM/yyyy"),b=i.getTextWidth(a);i.text(a,j-15-b,m),m+=15}if(m=Math.max(m,s+25),0===a.length){i.setFontSize(16),i.setFont("helvetica","normal");let a="No sales data available for the selected period.",b=i.getTextWidth(a);i.text(a,(j-b)/2,m+30)}else{r(22),q(),i.setFont("helvetica","normal"),i.setFontSize(8);let b=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:!0}),d=0;a.forEach(a=>{let e=a.items.reduce((a,b)=>a+b.total,0)-a.items.reduce((a,b)=>a+(b.discount_amount||0),0),f=a.total_amount-e,g=e>0?f/e:0;a.items.forEach((e,f)=>{r(13);let h=e.discount_amount||0,j=e.total-h,k=j*g,n=[0===f?a.receipt_number:"",0===f?(0,c.format)(new Date(a.sale_date),"dd/MM/yyyy"):"",0===f?a.customer_name||"Walk-in":"",e.product_name,e.quantity.toString(),b.format(e.price),b.format(e.total),h>0?b.format(h):"-",b.format(j),b.format(k),b.format(j+k)];d%2==0&&(i.setFillColor(249,250,251),i.rect(15,m-1,l,8,"F")),i.setLineWidth(.1),i.rect(15,m-1,l,8);let p=15;n.forEach((a,b)=>{let c=o[b],d=a;if(2===b)for(;i.getTextWidth(d)>c-4&&d.length>3;)d=d.substring(0,d.length-4)+"...";else if(3===b)for(;i.getTextWidth(d)>c-4&&d.length>5;)d=d.substring(0,d.length-4)+"...";else if(b>=4)for(;i.getTextWidth(d)>c-4&&d.length>3;)d=d.includes(",")?d.replace(/,/g,""):d.substring(0,d.length-1);let e=p+2;if(b>=4){let a=i.getTextWidth(d);e=p+c-a-2}i.text(d,e,m+5),b<n.length-1&&i.line(p+c,m-1,p+c,m+8-1),p+=c}),m+=8}),d++}),m+=15,r(60),i.setFontSize(18),i.setFont("helvetica","bold"),i.text("Comprehensive Sales Summary",15,m),m+=10;let e=a.length,f=a.reduce((a,b)=>a+b.total_amount,0),g=a.reduce((a,b)=>a+b.items.reduce((a,b)=>a+b.total,0),0),h=a.reduce((a,b)=>a+b.items.reduce((a,b)=>a+(b.discount_amount||0),0),0),j=g-h,k=a.reduce((a,b)=>a+b.items.reduce((a,b)=>a+b.quantity,0),0),n=a.filter(a=>"paid"===a.payment_status.toLowerCase()).length,p=a.filter(a=>"not paid"===a.payment_status.toLowerCase()).length,s=a.filter(a=>"quote"===a.payment_status.toLowerCase()).length,t=a.filter(a=>"installment sale"===a.payment_status.toLowerCase()).length,u=e>0?k/e:0,v=e>0?h/e:0,w=g>0?h/g*100:0;i.setFillColor(248,249,250),i.rect(15,m-3,l,60,"F"),i.setLineWidth(.3),i.setDrawColor(200,200,200),i.rect(15,m-3,l,60),i.setFontSize(10),i.setFont("helvetica","normal");let x=[["Total Sales:",e.toString()],["Total Items Sold:",k.toString()],["Average Items/Sale:",u.toFixed(1)],["Paid Sales:",n.toString()],["Pending Sales:",p.toString()],["Avg Discount/Sale:",b.format(v)]],y=[["Total Amount:",b.format(f)],["Subtotal (before discount):",b.format(g)],["Total Discounts:",b.format(h)],["Net Amount (after discount):",b.format(j)],["Total Tax:",b.format(f-j)],["Discount Rate:",`${w.toFixed(1)}%`]],z=m+6,A=30,B=15+l/2+15;x.forEach(([a,b])=>{i.setFont("helvetica","bold"),i.text(a,A,z),i.setFont("helvetica","normal");let c=i.getTextWidth(a);i.text(b,A+c+5,z),z+=7}),z=m+6,y.forEach(([a,b])=>{i.setFont("helvetica","bold"),i.text(a,B,z),i.setFont("helvetica","normal");let c=i.getTextWidth(a);i.text(b,B+c+5,z),z+=7}),(s>0||t>0)&&(m+=70,r(25),i.setFontSize(14),i.setFont("helvetica","bold"),i.text("Payment Status Breakdown",15,m),m+=8,i.setFontSize(10),i.setFont("helvetica","normal"),[[`Quotes: ${s}`,`Installment Sales: ${t}`]].forEach(([a,b])=>{i.text(a,A,m),i.text(b,B,m),m+=6}))}if(n(),f?.from&&f?.to){let a=(0,c.format)(f.from,"yyyy-MM-dd"),b=(0,c.format)(f.to,"yyyy-MM-dd");h=a===b?`sales_report_${a}.pdf`:`sales_report_${a}_to_${b}.pdf`}else h=`sales_report_${(0,c.format)(new Date,"yyyy-MM-dd")}.pdf`;i.save(h)}])},232557,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(25670),f=a.i(396465),g=a.i(637610),h=a.i(199987),i=a.i(493901),j=a.i(128904),k=a.i(40821),l=a.i(108191),m=a.i(224993),n=a.i(257257),o=a.i(805297),p=b([f,m,o]);[f,m,o]=p.then?(await p)():p,a.s(["default",0,({filteredSales:a,allSales:b,currency:c,dateFilter:p="all",dateRange:q,specificDate:r})=>{let s=(0,e.useRouter)(),{toast:t}=(0,l.useToast)(),{settings:u}=(0,m.useBusinessSettings)(),{hasPermission:v}=(0,o.useProfiles)(),w=async()=>{try{let d,e=a.length>0?a:b,f=e.map(a=>{let b=a.items.reduce((a,b)=>a+b.price*b.quantity,0),c=a.items.reduce((a,b)=>a+(b.discountAmount||0),0),d=(b-c)*(1+(a.taxRate||0)/100);return{receipt_number:a.receiptNumber,customer_name:a.customerName,total_amount:d,payment_status:a.paymentStatus.toLowerCase(),created_at:a.date.toISOString(),sale_date:a.date.toISOString().split("T")[0],items:a.items.map(a=>({product_name:a.description,quantity:a.quantity,price:a.price,total:a.price*a.quantity,discount_amount:a.discountAmount||0,discount_percentage:a.discountPercentage||0,discount_type:a.discountType||void 0}))}});if(r)d={from:r,to:r};else if(q?.from&&q?.to)d=q;else if(p&&"all"!==p)d=(0,n.getDateRangeFromFilter)(p);else if(e.length>0){let a=e.map(a=>a.date),b=new Date(Math.min(...a.map(a=>a.getTime()))),c=new Date(Math.max(...a.map(a=>a.getTime())));d={from:b,to:c}}else{let a=new Date;d={from:a,to:a}}(0,k.generateSalesReportVectorPDF)(f,"Current Period",c,d,{businessName:u.businessName,businessAddress:u.businessAddress,businessPhone:u.businessPhone,businessEmail:u.businessEmail}),t({title:"Report Generated",description:"PDF sales report has been created successfully."})}catch(a){console.error("Error generating PDF report:",a),t({title:"Error",description:"Failed to generate PDF report. Please try again.",variant:"destructive"})}};return(0,d.jsxs)("div",{className:"flex flex-col gap-3 w-full",children:[(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,d.jsxs)(f.Button,{onClick:()=>{(0,j.exportToCSV)(a.length>0?a:b)},variant:"outline",size:"lg",className:"gap-2 h-12 text-sm border-border/50 font-medium",children:[(0,d.jsx)(g.FileDown,{className:"h-4 w-4 shrink-0"}),"CSV"]}),(0,d.jsxs)(f.Button,{onClick:w,variant:"outline",size:"lg",className:"gap-2 h-12 text-sm border-border/50 font-medium",children:[(0,d.jsx)(h.FileText,{className:"h-4 w-4 shrink-0"}),"PDF"]})]}),v("sales","create")&&(0,d.jsxs)(f.Button,{onClick:()=>s.push("/new-sale"),size:"lg",className:"w-full gap-2 h-12 text-sm font-medium",children:[(0,d.jsx)(i.Plus,{className:"h-4 w-4 shrink-0"}),"New Sale"]})]})}]),c()}catch(a){c(a)}},!1),359368,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(112779),f=a.i(688272),g=a.i(396465),h=a.i(914619),i=a.i(158799),j=a.i(393551),k=a.i(792071),l=a.i(957143),m=a.i(120327),n=a.i(279780),o=a.i(755760),p=a.i(864369),q=b([e,f,g,i,j,o,p]);[e,f,g,i,j,o,p]=q.then?(await q)():q,a.s(["default",0,({searchQuery:a,setSearchQuery:b,paymentFilter:c,setPaymentFilter:q,cashTransactionFilter:r,setCashTransactionFilter:s,categoryFilter:t,setCategoryFilter:u,dateFilter:v,setDateFilter:w,dateRange:x,setDateRange:y,specificDate:z,setSpecificDate:A,isCustomRange:B,isSpecificDate:C,sortOrder:D="desc",setSortOrder:E})=>{let{categories:F}=(0,p.useSalesCategories)();return(0,d.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(l.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,d.jsx)(e.Input,{placeholder:"Search by customer, item, or receipt number...",className:"pl-10 bg-white border-border/50 focus:border-primary h-10",value:a,onChange:a=>{b(a.target.value)}})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-3",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10 pointer-events-none",children:(0,d.jsx)(m.Filter,{className:"h-4 w-4 text-muted-foreground"})}),(0,d.jsxs)(f.Select,{value:c,onValueChange:q,children:[(0,d.jsx)(f.SelectTrigger,{className:"bg-white border-border/50 pl-10 h-10",children:(0,d.jsx)(f.SelectValue,{placeholder:"Payment Status"})}),(0,d.jsxs)(f.SelectContent,{className:"bg-white shadow-lg border border-border/50",children:[(0,d.jsx)(f.SelectItem,{value:"all",children:"All Payment Statuses"}),(0,d.jsx)(f.SelectItem,{value:"Paid",children:"Paid"}),(0,d.jsx)(f.SelectItem,{value:"NOT PAID",children:"NOT PAID"}),(0,d.jsx)(f.SelectItem,{value:"Quote",children:"Quote"}),(0,d.jsx)(f.SelectItem,{value:"Installment Sale",children:"Installment Sale"})]})]})]}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10 pointer-events-none",children:(0,d.jsx)(m.Filter,{className:"h-4 w-4 text-muted-foreground"})}),(0,d.jsxs)(f.Select,{value:r,onValueChange:s,children:[(0,d.jsx)(f.SelectTrigger,{className:"bg-white border-border/50 pl-10 h-10",children:(0,d.jsx)(f.SelectValue,{placeholder:"Cash Transaction"})}),(0,d.jsxs)(f.SelectContent,{className:"bg-white shadow-lg border border-border/50",children:[(0,d.jsx)(f.SelectItem,{value:"all",children:"All Sales"}),(0,d.jsx)(f.SelectItem,{value:"linked",children:"Linked to Cash"}),(0,d.jsx)(f.SelectItem,{value:"unlinked",children:"Not Linked to Cash"})]})]})]}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10 pointer-events-none",children:(0,d.jsx)(n.Tag,{className:"h-4 w-4 text-muted-foreground"})}),(0,d.jsxs)(f.Select,{value:t,onValueChange:u,children:[(0,d.jsx)(f.SelectTrigger,{className:"bg-white border-border/50 pl-10 h-10",children:(0,d.jsx)(f.SelectValue,{placeholder:"Category"})}),(0,d.jsxs)(f.SelectContent,{className:"bg-white shadow-lg border border-border/50",children:[(0,d.jsx)(f.SelectItem,{value:"all",children:"All Categories"}),(0,d.jsx)(f.SelectItem,{value:"none",children:"No Source"}),F.map(a=>(0,d.jsx)(f.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10 pointer-events-none",children:(0,d.jsx)(h.Calendar,{className:"h-4 w-4 text-muted-foreground"})}),(0,d.jsxs)(f.Select,{value:v,onValueChange:a=>{w(a)},children:[(0,d.jsx)(f.SelectTrigger,{className:"bg-white border-border/50 pl-10 h-10",children:(0,d.jsx)(f.SelectValue,{placeholder:"Date Range"})}),(0,d.jsxs)(f.SelectContent,{className:"bg-white shadow-lg border border-border/50",children:[(0,d.jsx)(f.SelectItem,{value:"today",children:"Today"}),(0,d.jsx)(f.SelectItem,{value:"yesterday",children:"Yesterday"}),(0,d.jsx)(f.SelectItem,{value:"this-week",children:"This Week"}),(0,d.jsx)(f.SelectItem,{value:"last-week",children:"Last Week"}),(0,d.jsx)(f.SelectItem,{value:"this-month",children:"This Month"}),(0,d.jsx)(f.SelectItem,{value:"last-month",children:"Last Month"}),(0,d.jsx)(f.SelectItem,{value:"this-year",children:"This Year"}),(0,d.jsx)(f.SelectItem,{value:"specific",children:"Specific Date"}),(0,d.jsx)(f.SelectItem,{value:"custom",children:"Custom Range"}),(0,d.jsx)(f.SelectItem,{value:"all",children:"All Time"})]})]})]})]})]}),C&&(0,d.jsx)("div",{className:"pt-2 pb-1 border-t border-border/20",children:(0,d.jsx)("div",{className:"flex items-center space-x-2",children:(0,d.jsxs)(i.Popover,{children:[(0,d.jsx)(i.PopoverTrigger,{asChild:!0,children:(0,d.jsxs)(g.Button,{variant:"outline",className:"bg-white flex items-center gap-2 h-10 pl-3 text-left font-normal",children:[(0,d.jsx)(h.Calendar,{className:"h-4 w-4"}),(0,d.jsx)("span",{children:z?(0,k.format)(z,"MMM d, yyyy"):"Select Date"})]})}),(0,d.jsx)(i.PopoverContent,{className:"w-auto p-0 z-[100] bg-white shadow-lg",align:"start",children:(0,d.jsx)(j.Calendar,{initialFocus:!0,mode:"single",defaultMonth:z,selected:z,onSelect:A,className:"p-3 pointer-events-auto",showOutsideDays:!0})})]})})}),B&&(0,d.jsx)("div",{className:"pt-2 pb-1 border-t border-border/20",children:(0,d.jsx)(o.default,{dateRange:x,onDateRangeChange:y})})]})}]),c()}catch(a){c(a)}},!1),539113,a=>{"use strict";let b=(0,a.i(564375).default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);a.s(["Heart",()=>b],539113)},835583,a=>{"use strict";var b=a.i(456501);let c=a=>{let b=a.replace(/[^\d+]/g,"");return b.startsWith("+"),b};a.s(["canSendSMS",0,a=>!!(a.phoneNumber&&a.phoneNumber.trim()),"formatMessageForSMS",0,(a,b)=>{let c=a.replace(/[\u00A0\u1680\u180e\u2000-\u2009\u200a\u200b\u202f\u205f\u3000]/g," ").replace(/\n\s*\n/g,"\n\n").replace(/^\s+|\s+$/g,"").substring(0,800);return b&&(c+=`

- ${b}`),c},"getThankYouMessage",0,(a,b)=>{let c=a.items.reduce((a,b)=>{let c=b.price*b.quantity,d="amount"===b.discountType?b.discountAmount||0:c*(b.discountPercentage||0)/100;return a+(c-d)},0),d=c*((a.taxRate||0)/100),e=a.items.map(a=>`• ${a.description} (Qty: ${a.quantity})`).join("\n");return`Dear ${a.customerName},

We wanted to take a moment to express our sincere gratitude for your continued support and trust in our business.

Receipt Number: ${a.receiptNumber}

Items Purchased:
${e}

Total Amount: ${b.currency} ${(c+d).toLocaleString()}

In case of any inquiries please call ${b.businessPhone&&"(123) 456-7890"!==b.businessPhone?b.businessPhone:"our office"}.

We appreciate your business and look forward to serving you again.

Yours faithfully,
${b.businessName||"Management"}`},"openSMSApp",0,a=>{let d,{phoneNumber:e,message:f}=a,g=c(e),h=encodeURIComponent(f);d=(0,b.isIOS)()?`sms:${g}&body=${h}`:`sms:${g}?body=${h}`;try{window.open(d,"_self")}catch(a){console.error("Failed to open SMS app:",a),navigator.clipboard?.writeText(f).then(()=>{alert("SMS app not available. Message copied to clipboard.")}).catch(()=>{alert("SMS app not available and clipboard access denied.")})}},"openWhatsApp",0,a=>{let{phoneNumber:b,message:d}=a,e=c(b),f=encodeURIComponent(d),g=`https://wa.me/${e}?text=${f}`;try{window.open(g,"_blank")}catch(a){console.error("Failed to open WhatsApp:",a),navigator.clipboard?.writeText(d).then(()=>{alert("WhatsApp not available. Message copied to clipboard.")}).catch(()=>{alert("WhatsApp not available and clipboard access denied.")})}}])},578994,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(792071),f=a.i(540629),g=a.i(396465),h=a.i(899054),i=a.i(126741),j=a.i(445916),k=a.i(946032),l=a.i(199987),m=a.i(539113),n=a.i(886586),o=a.i(805297),p=a.i(767810),q=a.i(799856),r=a.i(466890),s=a.i(413890),t=a.i(558277),u=a.i(835583),v=a.i(749260),w=a.i(625250),x=b([f,g,h,o,p,q,r,s,v,w]);[f,g,h,o,p,q,r,s,v,w]=x.then?(await x)():x,a.s(["default",0,({sale:a,currency:b,onViewReceipt:c,onEditSale:x,onDeleteSale:y,onSendPaymentReminder:z,onSendThankYouNotice:A,onSendPaymentReminderSMS:B,onSendThankYouSMS:C})=>{let{accounts:D}=(0,r.useCashAccounts)(),{transactions:E}=(0,s.useCashTransactions)(),F=(0,t.useIsMobile)(),{payments:G}=(0,v.useInstallmentPayments)(a.id),{hasPermission:H}=(0,o.useProfiles)(),{formatFinancial:I,canViewCostPrice:J,canViewProfit:K}=(0,w.useFinancialVisibility)(),L=a.items.reduce((a,b)=>a+b.quantity,0),M=a.items.reduce((a,b)=>a+b.price,0),N=L>0?M/a.items.length:0,O=a.items.reduce((a,b)=>{let c=b.price*b.quantity,d="amount"===b.discountType?b.discountAmount||0:c*(b.discountPercentage||0)/100;return a+(c-d)},0),P=a.items.reduce((a,b)=>{let c=b.price*b.quantity,d="amount"===b.discountType?b.discountAmount||0:c*(b.discountPercentage||0)/100;return a+d},0),Q=a.taxRate||0,R=O+Q/100*O,S=a.items.reduce((a,b)=>a+b.cost*b.quantity,0),T="No items";a.items&&Array.isArray(a.items)&&a.items.length>0&&(T=a.items[0].description,a.items.length>1&&(T+=` (+${a.items.length-1} more)`));let U=(()=>{if(!a.cashTransactionId)return console.log("No cash transaction ID for sale:",a.id),null;console.log("Looking for transaction with ID:",a.cashTransactionId),console.log("Available transactions count:",E.length);let b=E.find(b=>b.id===a.cashTransactionId);if(!b)return console.log("No linked transaction found for sale:",a.id,"transaction ID:",a.cashTransactionId),console.log("All transaction IDs:",E.map(a=>a.id)),null;if(console.log("Found linked transaction:",b),!b.accountId)return console.log("Linked transaction has no accountId:",b),null;let c=D.find(a=>a.id===b.accountId);return c?(console.log("Successfully resolved cash account:",c.name),c.name):(console.log("No linked account found for accountId:",b.accountId),console.log("Available accounts:",D.map(a=>({id:a.id,name:a.name}))),null)})(),V="Installment Sale"===a.paymentStatus?G.reduce((a,b)=>a+b.amount,0):a.amountPaid||0,W="Installment Sale"===a.paymentStatus?Math.max(0,R-V):a.amountDue||0,X="NOT PAID"===a.paymentStatus,Y="Installment Sale"===a.paymentStatus&&W>0,Z={phoneNumber:a.customerContact||null},$=(0,u.canSendSMS)(Z),_=F&&$;return(0,d.jsxs)(f.TableRow,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>c(a),children:[(0,d.jsx)(f.TableCell,{className:"font-medium",children:(0,e.format)(new Date(a.date),"dd/MM/yyyy")}),(0,d.jsx)(f.TableCell,{children:a.receiptNumber}),(0,d.jsx)(f.TableCell,{children:(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)("div",{children:a.customerName}),U&&(0,d.jsx)(h.Badge,{variant:"outline",className:"text-xs bg-green-50 text-green-700 border-green-200",children:U}),"Installment Sale"===a.paymentStatus&&W>0&&(0,d.jsxs)(h.Badge,{variant:"outline",className:"text-xs bg-red-50 text-red-700 border-red-200",children:["Due: ",b," ",(0,q.formatNumber)(W)]})]})}),(0,d.jsx)(f.TableCell,{children:(0,d.jsxs)(p.Tooltip,{children:[(0,d.jsx)(p.TooltipTrigger,{asChild:!0,children:(0,d.jsx)("span",{className:"line-clamp-1 cursor-help",children:T})}),(0,d.jsx)(p.TooltipContent,{side:"top",className:"max-w-xs",children:(0,d.jsx)("div",{className:"space-y-1",children:(0,d.jsx)("p",{className:"font-bold break-words whitespace-normal",children:T})})})]})}),(0,d.jsx)(f.TableCell,{className:"text-right",children:L}),(0,d.jsxs)(f.TableCell,{className:"text-right",children:[b," ",(0,q.formatNumber)(N)]}),(0,d.jsx)(f.TableCell,{className:"text-right",children:P>0?(0,d.jsxs)("span",{className:"text-orange-600",children:["-",b," ",(0,q.formatNumber)(P)]}):(0,d.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,d.jsx)(f.TableCell,{className:"text-right",children:J?`${b} ${I(S,"cost")}`:"•••"}),(0,d.jsx)(f.TableCell,{className:"text-right",children:(0,d.jsx)("span",{className:"text-green-600 font-medium",children:K?`${b} ${(0,q.formatNumber)(R-S)}`:"•••"})}),(0,d.jsxs)(f.TableCell,{className:"text-right",children:[b," ",(0,q.formatNumber)(R),"Installment Sale"===a.paymentStatus&&V>0&&(0,d.jsxs)("div",{className:"text-xs text-green-600",children:["Paid: ",b," ",(0,q.formatNumber)(V)]})]}),(0,d.jsx)(f.TableCell,{children:(0,d.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(()=>{switch(a.paymentStatus){case"Paid":return"bg-green-100 text-green-800";case"Quote":return"bg-purple-100 text-purple-800";case"Installment Sale":return"bg-blue-100 text-blue-800";default:return"bg-yellow-100 text-yellow-800"}})()}`,children:"Installment Sale"===a.paymentStatus?"Installment":a.paymentStatus})}),(0,d.jsx)(f.TableCell,{onClick:a=>a.stopPropagation(),children:(0,d.jsxs)("div",{className:"flex justify-end gap-1",children:[(0,d.jsxs)(g.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),c(a)},children:[(0,d.jsx)(i.Printer,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"View Receipt"})]}),X&&z&&(0,d.jsxs)(g.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),z(a)},className:"text-orange-600 hover:text-orange-700 hover:bg-orange-50",title:"Send Payment Reminder",children:[(0,d.jsx)(l.FileText,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Send Payment Reminder"})]}),Y&&z&&(0,d.jsxs)(g.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),z(a)},className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"Send Due Payment Reminder",children:[(0,d.jsx)(l.FileText,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Send Due Payment Reminder"})]}),X&&_&&B&&(0,d.jsxs)(g.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),B(a)},className:"text-orange-600 hover:text-orange-700 hover:bg-orange-50",title:"Send Payment Reminder SMS",children:[(0,d.jsx)(n.MessageSquare,{className:"h-3 w-3"}),(0,d.jsx)("span",{className:"sr-only",children:"Send Payment Reminder SMS"})]}),A&&(0,d.jsxs)(g.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),A(a)},className:"text-purple-600 hover:text-purple-700 hover:bg-purple-50",title:"Send Thank You Notice",children:[(0,d.jsx)(m.Heart,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Send Thank You Notice"})]}),_&&C&&(0,d.jsxs)(g.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),C(a)},className:"text-purple-600 hover:text-purple-700 hover:bg-purple-50",title:"Send Thank You SMS",children:[(0,d.jsx)(n.MessageSquare,{className:"h-3 w-3"}),(0,d.jsx)("span",{className:"sr-only",children:"Send Thank You SMS"})]}),H("sales","edit")&&(0,d.jsxs)(g.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),x(a)},children:[(0,d.jsx)(j.Edit,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Edit Sale"})]}),H("sales","delete")&&(0,d.jsxs)(g.Button,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),y(a)},children:[(0,d.jsx)(k.Trash2,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Delete Sale"})]})]})})]})}]),c()}catch(a){c(a)}},!1),477753,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(893759),f=b([e]);[e]=f.then?(await f)():f,a.s(["default",0,({isOpen:a,onOpenChange:b,onConfirm:c,isDeleting:f=!1})=>(0,d.jsx)(e.AlertDialog,{open:a,onOpenChange:b,children:(0,d.jsxs)(e.AlertDialogContent,{children:[(0,d.jsxs)(e.AlertDialogHeader,{children:[(0,d.jsx)(e.AlertDialogTitle,{children:"Are you sure?"}),(0,d.jsx)(e.AlertDialogDescription,{children:"This action cannot be undone. This will permanently delete this sale record."})]}),(0,d.jsxs)(e.AlertDialogFooter,{children:[(0,d.jsx)(e.AlertDialogCancel,{disabled:f,children:"Cancel"}),(0,d.jsx)(e.AlertDialogAction,{onClick:c,disabled:f,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90 disabled:opacity-50",children:f?"Deleting...":"Delete"})]})]})})]),c()}catch(a){c(a)}},!1),342061,a=>{"use strict";let b=(0,a.i(564375).default)("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);a.s(["Wand2",()=>b],342061)},447629,a=>{"use strict";var b=a.i(959866),c=a.i(792071);let d=async(a,d)=>{let e=new b.default,f=e.internal.pageSize.getWidth(),g=e.internal.pageSize.getHeight(),h=20,i=()=>{e.setFontSize(8),e.setFont("helvetica","normal"),e.setTextColor(150,150,150),e.text("Created By Gonza Systems",f/2,g-10,{align:"center"}),e.setTextColor(0,0,0)};try{e.setFont("helvetica","normal");let b=a=>{h+a>g-20-15&&(i(),e.addPage(),h=20)},j=(a,c,d,f,g=11)=>(e.setFontSize(g),e.splitTextToSize(a,f).forEach(a=>{b(6),e.text(a,c,h),h+=5}),h);if(d.businessLogo)try{let a=new Image;a.src=d.businessLogo,await new Promise((b,c)=>{a.onload=b,a.onerror=c,a.complete&&b(a)});let b=a.width/a.height,c=40,f=40/b;f>20&&(c=(f=20)*b),e.addImage(d.businessLogo,"JPEG",20,h,c,f)}catch(a){console.error("Error adding business logo:",a)}let k=f-20;if(e.setFontSize(16),e.setFont("helvetica","bold"),e.text(d.businessName||"Business Name",k,h+5,{align:"right"}),h+=12,e.setFontSize(10),e.setFont("helvetica","normal"),d.businessAddress){let a=e.splitTextToSize(d.businessAddress,80);a.forEach((a,b)=>{e.text(a,k,h+4*b,{align:"right"})}),h+=4*a.length-4}d.businessPhone&&(h+=4,e.text(`Phone: ${d.businessPhone}`,k,h,{align:"right"})),d.businessEmail&&(h+=4,e.text(`Email: ${d.businessEmail}`,k,h,{align:"right"})),h+=8,e.setLineWidth(.5),e.line(20,h,f-20,h),h+=15,b(15),e.setFontSize(11);let l=(0,c.format)(new Date,"MMMM d, yyyy");if(e.text(`Date: ${l}`,20,h),h+=12,b(25),e.setFont("helvetica","bold"),e.text(a.customer.fullName||"Valued Customer",20,h),h+=5,e.setFont("helvetica","normal"),a.customer.location&&(h=j(a.customer.location,20,h,f-40,11)+2),a.customer.email&&(b(8),e.text(a.customer.email,20,h),h+=5),h+=8,a.subject&&(b(15),e.setFont("helvetica","bold"),e.setFontSize(12),h=j(`Re: ${a.subject}`,20,h,f-40,12)+6),b(15),e.setFont("helvetica","normal"),e.setFontSize(11),e.text(`Dear ${a.customer.fullName||"Valued Customer"},`,20,h),h+=8,a.content){let c=a.content.split("\n\n").filter(a=>""!==a.trim());c.forEach((a,d)=>{let e=Math.ceil(a.length/80);b(5*e+10),h=j(a.trim(),20,h,f-40,11),d<c.length-1&&(h+=6)}),h+=10}if(b(60),e.text("Yours faithfully,",20,h),h+=20,d.signature)try{let a=new Image;a.src=d.signature,await new Promise((b,c)=>{a.onload=b,a.onerror=c,a.complete&&b(a)});let b=a.width/a.height,c=50,f=50/b;f>25&&(c=(f=25)*b),e.addImage(d.signature,"JPEG",20,h,c,f),h+=f+5}catch(a){console.error("Error adding signature:",a),h+=15}else h+=15;e.setFont("helvetica","bold"),e.setFontSize(11);let m=a.senderName||d.businessName||"Management";e.text(m,20,h),h+=5,d.businessName&&a.senderName&&(e.setFont("helvetica","normal"),e.text(d.businessName,20,h)),i();let n=a.customer.fullName?.replace(/[^a-zA-Z0-9]/g,"_")||"Customer",o=(0,c.format)(new Date,"yyyy-MM-dd"),p=`Notice_${n}_${o}.pdf`;e.save(p)}catch(a){throw console.error("Error generating notice PDF:",a),Error("Failed to generate notice PDF. Please try again.")}};a.s(["generateNoticePDF",0,d])},393746,a=>{"use strict";a.s(["enhanceForBusiness",0,a=>{if(!a||""===a.trim())return a;let b=(a=>{if(!a||""===a.trim())return a;let b=a;return Object.entries({"can't":"cannot","won't":"will not","don't":"do not","didn't":"did not","haven't":"have not","hasn't":"has not","isn't":"is not","aren't":"are not","wasn't":"was not","weren't":"were not","I'm":"I am","you're":"you are","we're":"we are","they're":"they are","it's":"it is","that's":"that is","here's":"here is","there's":"there is","we've":"we have","they've":"they have","I've":"I have","you've":"you have",ok:"acceptable",okay:"acceptable",thanks:"thank you",hi:"greetings",bye:"goodbye",asap:"as soon as possible",fyi:"for your information",btw:"incidentally",etc:"and so forth",gonna:"going to",wanna:"want to",gotta:"have to",kinda:"somewhat",sorta:"somewhat",get:"receive",got:"received",give:"provide",gave:"provided",ask:"request",asked:"requested",tell:"inform",told:"informed",show:"demonstrate",showed:"demonstrated",help:"assist",helped:"assisted",fix:"resolve",fixed:"resolved",buy:"purchase",bought:"purchased",sell:"offer",sold:"provided"}).forEach(([a,c])=>{let d=RegExp(`\\b${a}\\b`,"gi");b=b.replace(d,c)}),(b=(b=b.replace(/(^|\. )([a-z])/g,(a,b,c)=>b+c.toUpperCase())).trim()).endsWith(".")||b.endsWith("!")||b.endsWith("?")||(b+="."),b})(a);return!b.toLowerCase().includes("we are")&&!b.toLowerCase().includes("we would like")&&!b.toLowerCase().includes("please")&&(b.toLowerCase().startsWith("our")||b.toLowerCase().startsWith("the"))&&(b=`We would like to inform you that ${b.charAt(0).toLowerCase()+b.slice(1)}`),(b.toLowerCase().includes("you must")||b.toLowerCase().includes("you have to"))&&(b=(b=b.replace(/you must/gi,"we kindly request that you")).replace(/you have to/gi,"we would appreciate if you could")),b}])},840626,a=>{"use strict";let b=[{id:"payment_reminder",name:"Payment Reminder",subject:"Payment Reminder - Account Status",content:`We hope this letter finds you well. We are writing to kindly remind you about your outstanding payment.

We appreciate your prompt attention to this matter and thank you for your continued business.`,category:"payment"},{id:"policy_update",name:"Policy Update",subject:"Important Update to Our Business Policies",content:`We are writing to inform you of important updates to our business policies that may affect your account.

These changes will take effect shortly. We appreciate your understanding and continued partnership.`,category:"policy"},{id:"thank_you",name:"Thank You Letter",subject:"Thank You for Your Business",content:`We wanted to take a moment to express our sincere gratitude for your continued support and trust in our business.

We look forward to serving you for many years to come.`,category:"gratitude"},{id:"service_announcement",name:"Service Announcement",subject:"Important Service Update",content:`We are excited to share some important updates about our services that will enhance your experience with us.

We believe these improvements will provide you with even better service and value.`,category:"announcement"},{id:"account_update",name:"Account Status Update",subject:"Account Status Update",content:`We are writing to provide you with an important update regarding your account with us.

If you have any questions or concerns, please don't hesitate to contact us.`,category:"general"},{id:"general_notice",name:"General Business Communication",subject:"Business Communication",content:`We hope this message finds you well. We wanted to reach out to you regarding an important matter.

Thank you for your attention to this matter.`,category:"general"}];a.s(["getTemplateById",0,a=>b.find(b=>b.id===a),"noticeTemplates",0,b])},137007,a=>{"use strict";let b=(0,a.i(564375).default)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);a.s(["MessageCircle",()=>b],137007)},188855,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(688272),f=a.i(899054),g=a.i(840626),h=b([e,f]);[e,f]=h.then?(await h)():h,a.s(["default",0,({selectedTemplate:a,onTemplateChange:b,onTemplateSelect:c})=>{let h=Array.isArray(g.noticeTemplates)?g.noticeTemplates:[];return(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Choose a Template (Optional)"}),(0,d.jsxs)(e.Select,{value:a,onValueChange:a=>{if(b(a),"none"===a)return;let d=g.noticeTemplates.find(b=>b.id===a);d&&c(d)},children:[(0,d.jsx)(e.SelectTrigger,{className:"w-full",children:(0,d.jsx)(e.SelectValue,{placeholder:"Select a notice template or start from scratch"})}),(0,d.jsxs)(e.SelectContent,{className:"max-h-80",children:[(0,d.jsx)(e.SelectItem,{value:"none",children:"Start from scratch"}),h.length>0&&h.map(a=>{var b;let c;return(0,d.jsx)(e.SelectItem,{value:a.id,children:(0,d.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,d.jsx)("span",{className:"font-medium",children:a.name}),(0,d.jsx)(f.Badge,{variant:"outline",className:`ml-2 text-xs ${(b=a.category,(c={payment:"bg-red-50 text-red-700 border-red-200",policy:"bg-blue-50 text-blue-700 border-blue-200",general:"bg-gray-50 text-gray-700 border-gray-200",announcement:"bg-green-50 text-green-700 border-green-200",gratitude:"bg-purple-50 text-purple-700 border-purple-200"})[b]||c.general)}`,children:a.category})]})},a.id)})]})]}),a&&"none"!==a&&(0,d.jsxs)("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-md",children:[(0,d.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,d.jsx)("strong",{children:"Template selected:"})," ",h.find(b=>b.id===a)?.name]}),(0,d.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"The template content has been added to your message. You can edit it as needed."})]})]})}]),c()}catch(a){c(a)}},!1),350102,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(109254),g=a.i(396465),h=a.i(330281),i=a.i(112779),j=a.i(397625),k=a.i(811705),l=a.i(199987),m=a.i(342061),n=a.i(532572),o=a.i(436028),p=a.i(886586),q=a.i(224993),r=a.i(108191),s=a.i(447629),t=a.i(393746),u=a.i(840626),v=a.i(835583),w=a.i(558277),x=a.i(137007),y=a.i(188855),z=b([f,g,h,i,j,k,q,y]);[f,g,h,i,j,k,q,y]=z.then?(await z)():z,a.s(["default",0,({customer:a,open:b,onClose:c,defaultTemplate:z,sale:A})=>{let[B,C]=(0,e.useState)("none"),[D,E]=(0,e.useState)(""),[F,G]=(0,e.useState)(""),[H,I]=(0,e.useState)(""),[J,K]=(0,e.useState)(!1),[L,M]=(0,e.useState)(!1),{settings:N}=(0,q.useBusinessSettings)(),{toast:O}=(0,r.useToast)(),P=(0,w.useIsMobile)();(0,e.useEffect)(()=>{if(b&&z){let a=(0,u.getTemplateById)(z);if(a)if(C(z),E(a.subject),"thank_you"===z&&A){let b=A.items.reduce((a,b)=>{let c=b.price*b.quantity,d="amount"===b.discountType?b.discountAmount||0:c*(b.discountPercentage||0)/100;return a+(c-d)},0),c=b*((A.taxRate||0)/100),d=A.items.map(a=>`• ${a.description} (Qty: ${a.quantity})`).join("\n"),e=`${a.content}

Receipt Number: ${A.receiptNumber}

Items Purchased:
${d}

Total Amount: ${N.currency} ${(b+c).toFixed(2)}

In case of any inquiries please call ${N.businessPhone&&"(123) 456-7890"!==N.businessPhone?N.businessPhone:"our office"}.

We appreciate your business and look forward to serving you again.`;G(e)}else G(a.content)}},[b,z,A,N.currency,N.businessPhone]);let Q=async()=>{if(!F.trim()||"Write your message here..."===F||"Write your specific message here..."===F)return void O({title:"Message required",description:"Please enter a message before generating the notice.",variant:"destructive"});K(!0);try{await (0,s.generateNoticePDF)({customer:a,subject:D||"Business Notice",content:F,senderName:H||void 0},N),O({title:"Notice generated successfully!",description:"Your professional business notice has been downloaded as a PDF."}),G(""),E(""),C("none"),I(""),c()}catch(a){console.error("Error generating notice:",a),O({title:"Generation failed",description:"Failed to generate the notice. Please try again.",variant:"destructive"})}finally{K(!1)}},R=()=>{G(""),E(""),C("none"),I(""),M(!1),c()},S=P&&(0,v.canSendSMS)(a);return(0,d.jsx)(f.Dialog,{open:b,onOpenChange:R,children:(0,d.jsxs)(f.DialogContent,{className:"w-[95vw] sm:max-w-4xl max-h-[90vh] overflow-y-auto p-4 sm:p-6",children:[(0,d.jsx)(f.DialogHeader,{children:(0,d.jsxs)(f.DialogTitle,{className:"flex items-center gap-2 text-base sm:text-lg",children:[(0,d.jsx)(l.FileText,{className:"h-5 w-5"}),"Send Notice to ",a.fullName]})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-2",children:[(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-base sm:text-lg font-semibold mb-3",children:"Compose Your Notice"}),(0,d.jsx)(y.default,{selectedTemplate:B,onTemplateChange:C,onTemplateSelect:a=>{E(a.subject),G(a.content)}})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(j.Label,{htmlFor:"subject",className:"text-sm",children:"Subject Line"}),(0,d.jsx)(i.Input,{id:"subject",value:D,onChange:a=>E(a.target.value),placeholder:"Enter the subject of your notice",className:"text-sm h-9"})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(j.Label,{htmlFor:"message",className:"text-sm",children:"Your Message"}),(0,d.jsxs)(g.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{if(!F.trim()||"Write your message here..."===F||"Write your specific message here..."===F)return void O({title:"No message to enhance",description:"Please enter your message first.",variant:"destructive"});try{let a=(0,t.enhanceForBusiness)(F);G(a),O({title:"Message enhanced!",description:"Your message has been made more formal and professional."})}catch(a){console.error("Error enhancing message:",a),O({title:"Enhancement failed",description:"Could not enhance the message. Please try again.",variant:"destructive"})}},className:"text-[10px] h-7 px-2",disabled:!F.trim()||"Write your message here..."===F||"Write your specific message here..."===F,children:[(0,d.jsx)(m.Wand2,{className:"h-3 w-3 mr-1"}),"Make Formal"]})]}),(0,d.jsx)(h.Textarea,{id:"message",value:F,onChange:a=>G(a.target.value),placeholder:"What do you want to inform the customer about?",rows:P?6:8,className:"resize-none text-sm"}),(0,d.jsx)("p",{className:"text-[10px] text-gray-500 leading-tight",children:"none"!==B?"Template content loaded. Edit as needed.":"Write in your own words - we'll format it professionally."})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(j.Label,{htmlFor:"sender",className:"text-sm",children:"Sender Name (Optional)"}),(0,d.jsx)(i.Input,{id:"sender",value:H,onChange:a=>I(a.target.value),placeholder:"Your name (defaults to business name)",className:"text-sm h-9"})]}),(!N.businessLogo||!N.signature)&&(0,d.jsx)(k.Card,{className:"border-amber-200 bg-amber-50",children:(0,d.jsx)(k.CardContent,{className:"p-3",children:(0,d.jsxs)("div",{className:"flex items-start gap-2",children:[(0,d.jsx)(o.AlertCircle,{className:"h-4 w-4 text-amber-600 mt-0.5 flex-shrink-0"}),(0,d.jsxs)("div",{className:"text-[11px] sm:text-xs",children:[(0,d.jsx)("p",{className:"text-amber-800 font-medium",children:"Enhance your notices"}),(0,d.jsxs)("p",{className:"text-amber-700",children:[!N.businessLogo&&"Add logo ",!N.businessLogo&&!N.signature&&"and ",!N.signature&&"upload signature ","in settings for better notices."]})]})]})})})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h3",{className:"text-base sm:text-lg font-semibold",children:"Preview"}),(0,d.jsxs)(g.Button,{variant:"outline",size:"sm",onClick:()=>M(!L),className:"h-8 text-xs",children:[L?"Hide":"Show"," Preview"]})]}),L&&(0,d.jsx)(k.Card,{className:"border-gray-200 shadow-sm",children:(0,d.jsx)(k.CardContent,{className:"p-4 overflow-x-hidden",children:(0,d.jsxs)("div",{className:"space-y-3 text-[11px] sm:text-sm",children:[(0,d.jsxs)("div",{className:"border-b pb-2",children:[(0,d.jsx)("div",{className:"font-bold text-sm sm:text-base",children:N.businessName||"Your Business"}),(0,d.jsxs)("div",{className:"text-gray-600 space-y-0.5",children:[N.businessAddress&&(0,d.jsx)("div",{className:"truncate",children:N.businessAddress}),N.businessPhone&&(0,d.jsxs)("div",{children:["Phone: ",N.businessPhone]}),N.businessEmail&&(0,d.jsxs)("div",{className:"truncate",children:["Email: ",N.businessEmail]})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[(0,d.jsxs)("div",{children:["Date: ",new Date().toLocaleDateString()]}),(0,d.jsx)("div",{className:"font-medium truncate",children:a.fullName})]}),D&&(0,d.jsx)("div",{className:"bg-gray-50 p-2 rounded",children:(0,d.jsxs)("strong",{children:["Re: ",D]})}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"italic",children:["Dear ",a.fullName,","]}),(0,d.jsx)("div",{className:"whitespace-pre-wrap leading-relaxed text-gray-800",children:F||"Your message will appear here..."}),(0,d.jsx)("div",{children:"Yours faithfully,"}),(0,d.jsx)("div",{className:"mt-4 font-bold",children:H||N.businessName||"Management"})]})]})})})]})]}),(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-3 pt-4 border-t mt-2",children:[(0,d.jsxs)("div",{className:"flex gap-2 w-full sm:w-auto",children:[(0,d.jsx)(g.Button,{variant:"outline",onClick:R,className:"flex-1 sm:flex-none h-10 text-sm",children:"Cancel"}),(0,v.canSendSMS)(a)&&(0,d.jsxs)(g.Button,{variant:"outline",onClick:()=>{(0,v.openWhatsApp)({phoneNumber:a.phoneNumber,message:`${D?D+"\n\n":""}Dear ${a.fullName},

${F}

Yours faithfully,
${H||N.businessName||"Management"}`}),O({title:"WhatsApp opened",description:"Your message has been prepared in WhatsApp."})},disabled:!F.trim()||"Write your message here..."===F||"Write your specific message here..."===F,className:"flex-1 sm:flex-none gap-2 text-green-600 hover:text-green-700 hover:bg-green-50 h-10 text-sm",children:[(0,d.jsx)(x.MessageCircle,{className:"h-4 w-4"}),"WhatsApp"]})]}),(0,d.jsxs)("div",{className:"flex gap-2 w-full sm:w-auto",children:[S&&(0,d.jsxs)(g.Button,{variant:"outline",onClick:()=>{if(!F.trim()||"Write your message here..."===F||"Write your specific message here..."===F)return void O({title:"Message required",description:"Please enter a message before sending SMS.",variant:"destructive"});if(!(0,v.canSendSMS)(a))return void O({title:"Phone number required",description:"Customer phone number is not available.",variant:"destructive"});try{let b=`${D?D+"\n\n":""}Dear ${a.fullName},

${F}

Yours faithfully,
${H||N.businessName||"Management"}`,c=(0,v.formatMessageForSMS)(b,N.businessName);(0,v.openSMSApp)({phoneNumber:a.phoneNumber,message:c}),O({title:"SMS app opened",description:"Your message has been prepared in the SMS app."})}catch(a){console.error("Error sending SMS:",a),O({title:"SMS failed",description:"Failed to open SMS app. Please try again.",variant:"destructive"})}},disabled:!F.trim()||"Write your message here..."===F||"Write your specific message here..."===F,className:"flex-1 sm:flex-none gap-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 h-10 text-sm",children:[(0,d.jsx)(p.MessageSquare,{className:"h-4 w-4"}),"SMS"]}),(0,d.jsxs)(g.Button,{onClick:Q,disabled:!F.trim()||"Write your message here..."===F||"Write your specific message here..."===F||J,className:"flex-1 sm:flex-none gap-2 h-10 text-sm",children:[(0,d.jsx)(n.Download,{className:"h-4 w-4"}),J?"PDF...":"PDF"]})]})]})]})})}]),c()}catch(a){c(a)}},!1),909503,a=>a.a(async(b,c)=>{try{var d=a.i(959866),e=a.i(647952),f=a.i(792071),g=a.i(799856),h=b([e,g]);[e,g]=h.then?(await h)():h;let i=async(a,b,c,h,i,j="save")=>{try{let k=new d.default,l=k.internal.pageSize.width,m=k.internal.pageSize.height;k.setFontSize(20),k.setFont("helvetica","bold"),k.text("PAYMENT REMINDER NOTICE",l/2,30,{align:"center"}),k.setFontSize(12),k.setFont("helvetica","normal");let n=50;k.text(h.businessName,20,n),n+=6,k.text(h.businessAddress,20,n),n+=6,k.text(`Phone: ${h.businessPhone}`,20,n),n+=6,k.text(`Email: ${h.businessEmail}`,20,n),n+=15,k.text(`Date: ${(0,f.format)(new Date,"MMMM d, yyyy")}`,l-20-60,50,{align:"left"}),k.setFont("helvetica","bold"),k.text("TO:",20,n),n+=8,k.setFont("helvetica","normal"),k.text(a.fullName,20,n),n+=6,a.phoneNumber&&(k.text(`Phone: ${a.phoneNumber}`,20,n),n+=6),a.email&&(k.text(`Email: ${a.email}`,20,n),n+=6),a.location&&(k.text(`Address: ${a.location}`,20,n),n+=6),n+=15,k.setFont("helvetica","normal"),k.text(`Dear ${a.fullName},`,20,n),n+=8;let o=k.splitTextToSize(i||"Our records show that you have pending payments for the following items purchased on credit. We kindly request you to complete payment at your earliest convenience.\n\nPlease reach out to us if you need any assistance or clarification.",l-40);k.text(o,20,n),n+=6*o.length+10;let p=b.flatMap(a=>{let b=a.items.reduce((a,b)=>a+b.price*b.quantity,0),c=b*((a.taxRate||0)/100),d=b+c;return a.items.map(b=>[a.receiptNumber,b.description,b.quantity.toString(),`${h.currency} ${(0,g.formatNumber)(b.price)}`,`${h.currency} ${(0,g.formatNumber)(b.price*b.quantity)}`,(0,f.format)(a.date,"MMM d, yyyy"),`${h.currency} ${(0,g.formatNumber)(d)}`])});p.push(["","","","","TOTAL OUTSTANDING:",`${h.currency} ${(0,g.formatNumber)(c)}`,""]),(0,e.default)(k,{startY:n,head:[["Invoice #","Product Name","Qty","Price","Total","Sale Date","Sale Total"]],body:p,theme:"grid",headStyles:{fillColor:[255,145,77],textColor:255,fontStyle:"bold"},bodyStyles:{fontSize:10},didParseCell:function(a){a.row.index===p.length-1&&(a.cell.styles.fillColor=[255,200,150],a.cell.styles.fontStyle="bold")},margin:{left:20,right:20}});let q=k.lastAutoTable.finalY+20;k.setFont("helvetica","bold"),k.text("Thank you for your continued support.",20,q),k.setFont("helvetica","normal"),k.setFontSize(10),k.text(`${h.businessName} - Payment Reminder`,20,q+15),k.setFontSize(8),k.setFont("helvetica","normal"),k.setTextColor(150,150,150),k.text("Created By Gonza Systems",l/2,m-10,{align:"center"}),k.setTextColor(0,0,0);let r=`Payment_Reminder_${a.fullName.replace(/\s+/g,"_")}_${(0,f.format)(new Date,"yyyy-MM-dd")}.pdf`;if("blob"===j)return k.output("blob");if("dataurl"===j)return k.output("datauristring");k.save(r)}catch(a){throw console.error("Error generating payment reminder PDF:",a),Error("Failed to generate payment reminder PDF")}};a.s(["generatePaymentReminderPDF",0,i]),c()}catch(a){c(a)}},!1),247434,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(109254),g=a.i(569834),h=a.i(396465),i=a.i(558277),j=a.i(532572),k=a.i(126741),l=a.i(570223),m=a.i(734637),n=a.i(311988),o=a.i(909503),p=a.i(224993),q=a.i(108191),r=b([f,g,h,o,p]);[f,g,h,o,p]=r.then?(await r)():r,a.s(["default",0,({isOpen:a,onOpenChange:b,sale:c,customer:r,unpaidSales:s})=>{let t=(0,i.useIsMobile)(),{settings:u,isLoading:v}=(0,p.useBusinessSettings)(),{toast:w}=(0,q.useToast)(),[x,y]=(0,e.useState)(null),[z,A]=(0,e.useState)(null),[B,C]=(0,e.useState)(!1),D=r||(c?{id:"placeholder",fullName:c.customerName,phoneNumber:c.customerContact,email:null,location:c.customerAddress,createdAt:new Date,updatedAt:new Date,loyaltyPoints:0,totalSpent:0,lastVisit:null,categoryId:null,birthday:null,socialMedia:null,gender:null,tags:null,notes:null}:null),E=s||(c?[c]:[]),F=E.reduce((a,b)=>{let c=b.items.reduce((a,b)=>a+b.price*b.quantity,0),d=c*((b.taxRate||0)/100);return a+c+d},0);(0,e.useEffect)(()=>{a&&D&&E.length>0&&u?G():!a&&x&&(URL.revokeObjectURL(x),y(null))},[a,u]);let G=async()=>{if(D&&0!==E.length&&u){C(!0);try{let a=await (0,o.generatePaymentReminderPDF)(D,E,F,u,void 0,"blob"),b=URL.createObjectURL(a);y(b),A(a)}catch(a){console.error("Error generating preview:",a),w({title:"Error",description:"Failed to generate PDF preview.",variant:"destructive"})}finally{C(!1)}}},H=async()=>{if(D&&0!==E.length&&u)try{await (0,o.generatePaymentReminderPDF)(D,E,F,u,void 0,"save")}catch(a){w({title:"Error",description:"Failed to download PDF.",variant:"destructive"})}},I=()=>{if(x){let a=window.open(x);a&&a.addEventListener("load",()=>{a.print()})}},J=async()=>{let a=`Payment_Reminder_${D?.fullName.replace(/\s+/g,"_")||"Customer"}.pdf`,b=`Hello ${D?.fullName||"Customer"}, this is a payment reminder from ${u?.businessName||"our business"} regarding your outstanding balance of ${u?.currency||""} ${F.toLocaleString()}.`;if(navigator.share&&z)try{let c=new File([z],a,{type:"application/pdf"});if(navigator.canShare&&navigator.canShare({files:[c]}))return void await navigator.share({files:[c],title:"Payment Reminder",text:b});await navigator.share({title:"Payment Reminder",text:b})}catch(a){"AbortError"!==a.name&&console.error("Error sharing:",a)}else if(navigator.share)try{await navigator.share({title:"Payment Reminder",text:b})}catch(a){"AbortError"!==a.name&&console.error("Error sharing:",a)}else try{await navigator.clipboard.writeText(b),w({title:"Copied to clipboard",description:"Payment reminder summary copied to clipboard."})}catch(a){w({title:"Share failed",description:"Could not share or copy the message.",variant:"destructive"})}},K=()=>(0,d.jsxs)("div",{className:"flex flex-col h-full space-y-4",children:[(0,d.jsxs)("div",{className:"flex flex-wrap gap-2 justify-center py-2 order-first",children:[(0,d.jsxs)(h.Button,{variant:"outline",onClick:J,className:"flex-1 min-w-[120px] bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100",children:[(0,d.jsx)(l.Share2,{className:"h-4 w-4 mr-2 text-blue-600"}),"Share"]}),(0,d.jsxs)(h.Button,{variant:"outline",onClick:I,className:"flex-1 min-w-[120px]",disabled:!x,children:[(0,d.jsx)(k.Printer,{className:"h-4 w-4 mr-2"}),"Print"]}),(0,d.jsxs)(h.Button,{onClick:H,className:"flex-1 min-w-[120px] bg-orange-500 hover:bg-orange-600",children:[(0,d.jsx)(j.Download,{className:"h-4 w-4 mr-2"}),"Download"]})]}),(0,d.jsx)("div",{className:"flex-1 bg-gray-100 rounded-lg overflow-hidden min-h-[600px] relative",children:B?(0,d.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center space-y-4 bg-white/50 backdrop-blur-sm",children:[(0,d.jsx)(n.Loader2,{className:"h-8 w-8 animate-spin text-orange-500"}),(0,d.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Generating preview..."})]}):x?(0,d.jsx)("iframe",{src:x,className:"w-full h-full min-h-[600px] border-none",title:"Payment Reminder Preview"}):(0,d.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Preview not available."})})})]});return t?(0,d.jsx)(g.Drawer,{open:a,onOpenChange:b,children:(0,d.jsxs)(g.DrawerContent,{className:"max-h-[95vh]",children:[(0,d.jsx)(g.DrawerHeader,{className:"border-b pb-2",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(g.DrawerTitle,{children:"Payment Reminder Preview"}),(0,d.jsx)(g.DrawerClose,{asChild:!0,children:(0,d.jsx)(h.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,d.jsx)(m.X,{className:"h-4 w-4"})})})]})}),(0,d.jsx)("div",{className:"px-4 py-4 overflow-y-auto",children:(0,d.jsx)(K,{})}),(0,d.jsx)(g.DrawerFooter,{className:"pt-2 border-t",children:(0,d.jsx)(h.Button,{variant:"outline",onClick:()=>b(!1),children:"Close"})})]})}):(0,d.jsx)(f.Dialog,{open:a,onOpenChange:b,children:(0,d.jsxs)(f.DialogContent,{className:"max-w-4xl max-h-[90vh] flex flex-col p-0 overflow-hidden",children:[(0,d.jsx)(f.DialogHeader,{className:"px-6 py-4 border-b",children:(0,d.jsx)(f.DialogTitle,{children:"Payment Reminder Preview"})}),(0,d.jsx)("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-50/50",children:(0,d.jsx)(K,{})})]})})}]),c()}catch(a){c(a)}},!1),654099,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(396465),g=a.i(112779),h=a.i(397625),i=a.i(109254),j=a.i(893759),k=a.i(493901),l=a.i(445916),m=a.i(946032),n=a.i(864369),o=b([f,g,h,i,j,n]);[f,g,h,i,j,n]=o.then?(await o)():o,a.s(["default",0,()=>{let{categories:a,createCategory:b,updateCategory:c,deleteCategory:o,createDefaultCategories:p}=(0,n.useSalesCategories)(),[q,r]=(0,e.useState)(!1),[s,t]=(0,e.useState)(""),[u,v]=(0,e.useState)(null),[w,x]=(0,e.useState)(""),[y,z]=(0,e.useState)(!1),[A,B]=(0,e.useState)(null),C=async()=>{!s.trim()||await b(s.trim())&&t("")},D=async()=>{u&&w.trim()&&await c(u.id,w.trim())&&(v(null),x(""))},E=async()=>{!A||await o(A.id)&&(z(!1),B(null))},F=async()=>{await p()};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(i.Dialog,{open:q,onOpenChange:r,children:[(0,d.jsx)(i.DialogTrigger,{asChild:!0}),(0,d.jsxs)(i.DialogContent,{className:"max-w-2xl",children:[(0,d.jsx)(i.DialogHeader,{children:(0,d.jsx)(i.DialogTitle,{children:"Manage Sales Categories"})}),(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(h.Label,{htmlFor:"new-category",children:"Add New Category"}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(g.Input,{id:"new-category",placeholder:"Category name",value:s,onChange:a=>t(a.target.value),onKeyPress:a=>"Enter"===a.key&&C()}),(0,d.jsxs)(f.Button,{onClick:C,disabled:!s.trim(),children:[(0,d.jsx)(k.Plus,{className:"h-4 w-4 mr-2"}),"Add"]})]})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)(h.Label,{children:"Existing Categories"}),0===a.length&&(0,d.jsx)(f.Button,{variant:"outline",size:"sm",onClick:F,children:"Create Default Categories"})]}),a.length>0?(0,d.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:a.map(a=>(0,d.jsx)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:u?.id===a.id?(0,d.jsxs)("div",{className:"flex gap-2 flex-1",children:[(0,d.jsx)(g.Input,{value:w,onChange:a=>x(a.target.value),onKeyPress:a=>"Enter"===a.key&&D(),className:"flex-1"}),(0,d.jsx)(f.Button,{size:"sm",onClick:D,children:"Save"}),(0,d.jsx)(f.Button,{size:"sm",variant:"outline",onClick:()=>v(null),children:"Cancel"})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"font-medium",children:a.name}),a.is_default&&(0,d.jsx)("span",{className:"text-xs bg-muted px-2 py-1 rounded",children:"Default"})]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(f.Button,{size:"sm",variant:"outline",onClick:()=>{v(a),x(a.name)},children:(0,d.jsx)(l.Edit,{className:"h-4 w-4"})}),(0,d.jsx)(f.Button,{size:"sm",variant:"outline",onClick:()=>{B(a),z(!0)},children:(0,d.jsx)(m.Trash2,{className:"h-4 w-4"})})]})]})},a.id))}):(0,d.jsx)("p",{className:"text-muted-foreground text-sm",children:"No categories found. Create your first category above."})]})]})]})]}),(0,d.jsx)(j.AlertDialog,{open:y,onOpenChange:z,children:(0,d.jsxs)(j.AlertDialogContent,{children:[(0,d.jsxs)(j.AlertDialogHeader,{children:[(0,d.jsx)(j.AlertDialogTitle,{children:"Delete Category"}),(0,d.jsxs)(j.AlertDialogDescription,{children:['Are you sure you want to delete "',A?.name,'"? This action cannot be undone.']})]}),(0,d.jsxs)(j.AlertDialogFooter,{children:[(0,d.jsx)(j.AlertDialogCancel,{children:"Cancel"}),(0,d.jsx)(j.AlertDialogAction,{onClick:E,children:"Delete"})]})]})})]})}]),c()}catch(a){c(a)}},!1),997807,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(811705),g=a.i(799856),h=a.i(515016),i=a.i(352519),j=a.i(778856),k=a.i(625250),l=b([f,g,k]);[f,g,k]=l.then?(await l)():l,a.s(["SalesSummaryCards",0,({sales:a,currency:b})=>{let{formatFinancial:c,canViewCostPrice:l,canViewProfit:m,canViewTotalAmount:n,canViewSellingPrice:o}=(0,k.useFinancialVisibility)(),p=(0,e.useMemo)(()=>a.reduce((a,b)=>{let c=b.items.reduce((a,b)=>{let c=b.price*b.quantity,d="amount"===b.discountType?b.discountAmount||0:c*(b.discountPercentage||0)/100;return a+(c-d)},0),d=b.taxRate||0,e=c+d/100*c,f=b.items.reduce((a,b)=>a+b.cost*b.quantity,0);return{totalSales:a.totalSales+e,totalCost:a.totalCost+f,totalProfit:a.totalProfit+(e-f)}},{totalSales:0,totalCost:0,totalProfit:0}),[a]);return(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,d.jsx)(f.Card,{className:"bg-blue-50 border-blue-100",children:(0,d.jsxs)(f.CardContent,{className:"p-6 flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm font-medium text-blue-600 mb-1",children:"Total Sales"}),(0,d.jsx)("h3",{className:"text-2xl font-bold text-blue-900",children:n||o?`${b} ${(0,g.formatNumber)(p.totalSales)}`:"•••"}),(0,d.jsxs)("p",{className:"text-xs text-blue-500 mt-1",children:["Based on ",a.length," records"]})]}),(0,d.jsx)("div",{className:"h-12 w-12 bg-blue-100 rounded-full flex items-center justify-center",children:(0,d.jsx)(h.TrendingUp,{className:"h-6 w-6 text-blue-600"})})]})}),(0,d.jsx)(f.Card,{className:"bg-orange-50 border-orange-100",children:(0,d.jsxs)(f.CardContent,{className:"p-6 flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm font-medium text-orange-600 mb-1",children:"Total Cost"}),(0,d.jsx)("h3",{className:"text-2xl font-bold text-orange-900",children:l?`${b} ${(0,g.formatNumber)(p.totalCost)}`:"•••"}),(0,d.jsx)("p",{className:"text-xs text-orange-500 mt-1",children:"Cost of goods sold"})]}),(0,d.jsx)("div",{className:"h-12 w-12 bg-orange-100 rounded-full flex items-center justify-center",children:(0,d.jsx)(j.Wallet,{className:"h-6 w-6 text-orange-600"})})]})}),(0,d.jsx)(f.Card,{className:"bg-green-50 border-green-100",children:(0,d.jsxs)(f.CardContent,{className:"p-6 flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm font-medium text-green-600 mb-1",children:"Total Profit"}),(0,d.jsx)("h3",{className:"text-2xl font-bold text-green-900",children:m?`${b} ${(0,g.formatNumber)(p.totalProfit)}`:"•••"}),(0,d.jsx)("p",{className:"text-xs text-green-500 mt-1",children:"Net earnings"})]}),(0,d.jsx)("div",{className:"h-12 w-12 bg-green-100 rounded-full flex items-center justify-center",children:(0,d.jsx)(i.DollarSign,{className:"h-6 w-6 text-green-600"})})]})})]})}]),c()}catch(a){c(a)}},!1),756321,a=>{"use strict";var b=a.i(127669),c=a.i(257257),d=a.i(837692);a.s(["useSalesFilters",0,a=>{let e=(()=>{try{let a=localStorage.getItem("salesFilters");if(a){let b=JSON.parse(a);return{searchQuery:b.searchQuery||"",dateFilter:b.dateFilter||"this-month",paymentFilter:b.paymentFilter||"all",cashTransactionFilter:b.cashTransactionFilter||"all",categoryFilter:b.categoryFilter||"all",dateRange:b.dateRange?{from:b.dateRange.from?new Date(b.dateRange.from):void 0,to:b.dateRange.to?new Date(b.dateRange.to):void 0}:{from:void 0,to:void 0},specificDate:b.specificDate?new Date(b.specificDate):void 0}}}catch(a){console.error("Error loading persisted sales filters:",a)}return{searchQuery:"",dateFilter:"this-month",paymentFilter:"all",cashTransactionFilter:"all",categoryFilter:"all",dateRange:{from:void 0,to:void 0},specificDate:void 0}})(),[f,g]=(0,b.useState)(e.searchQuery),[h,i]=(0,b.useState)(e.paymentFilter),[j,k]=(0,b.useState)(e.cashTransactionFilter),[l,m]=(0,b.useState)(e.categoryFilter),[n,o]=(0,b.useState)(e.dateFilter),[p,q]=(0,b.useState)(e.dateRange),[r,s]=(0,b.useState)(e.specificDate);(0,b.useEffect)(()=>{let a={searchQuery:f,dateFilter:n,paymentFilter:h,cashTransactionFilter:j,categoryFilter:l,dateRange:{from:p.from?.toISOString(),to:p.to?.toISOString()},specificDate:r?.toISOString()};localStorage.setItem("salesFilters",JSON.stringify(a))},[f,n,h,j,l,p,r]);let t="custom"===n,u="specific"===n,v=(0,b.useMemo)(()=>{let b=[...a];if(f.trim()){let a=f.toLowerCase();b=b.filter(b=>b.customerName.toLowerCase().includes(a)||b.receiptNumber.toLowerCase().includes(a)||b.items.some(b=>b.description.toLowerCase().includes(a)))}if("all"!==h&&(b=b.filter(a=>a.paymentStatus===h)),"all"!==j&&("linked"===j?b=b.filter(a=>a.cashTransactionId):"unlinked"===j&&(b=b.filter(a=>!a.cashTransactionId))),"all"!==l&&(b="none"===l?b.filter(a=>!a.categoryId):b.filter(a=>a.categoryId===l)),"all"!==n)if(u&&r)b=b.filter(a=>{let b=new Date(a.date);return(0,d.isSameDay)(b,r)});else if(t&&p.from&&p.to){let a=p.from,c=p.to;b=b.filter(b=>{let d=new Date(b.date);return d>=a&&d<=c})}else{let a=(0,c.getDateRangeFromFilter)(n),d=a.from,e=a.to;b=b.filter(a=>{let b=new Date(a.date);return b>=d&&b<=e})}return b},[a,f,h,j,l,n,p,r,t,u]);return{searchQuery:f,setSearchQuery:g,paymentFilter:h,setPaymentFilter:i,cashTransactionFilter:j,setCashTransactionFilter:k,categoryFilter:l,setCategoryFilter:m,dateFilter:n,setDateFilter:o,dateRange:p,setDateRange:q,specificDate:r,setSpecificDate:s,isCustomRange:t,isSpecificDate:u,filteredSales:v}}])},451790,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(540629),g=a.i(232557),h=a.i(359368),i=a.i(578994),j=a.i(996217),k=a.i(270602),l=a.i(477753),m=a.i(350102),n=a.i(247434),o=a.i(654099),p=a.i(997807),q=a.i(756321),r=a.i(630227),s=a.i(558277),t=a.i(805297),u=a.i(466890),v=a.i(413890),w=a.i(224993),x=a.i(108191),y=a.i(749260),z=a.i(625250),A=a.i(811705),B=a.i(396465),C=a.i(899054),D=a.i(445916),E=a.i(946032),F=a.i(131724),G=a.i(199987),H=a.i(54904),I=a.i(539113),J=a.i(799856),K=a.i(835583),L=a.i(767810),M=b([f,g,h,i,j,k,l,m,n,o,p,t,u,v,w,y,z,A,B,C,J,L]);[f,g,h,i,j,k,l,m,n,o,p,t,u,v,w,y,z,A,B,C,J,L]=M.then?(await M)():M;let N={businessName:"Your Business Name",businessAddress:"Your Business Address",businessPhone:"(123) 456-7890",businessEmail:"support@yourbusiness.com",businessLogo:"",currency:"UGX"},O=e.default.memo(({sale:a,settings:b,onViewReceipt:c,onEditSale:e,onDeleteSale:f,onSendPaymentReminder:g,onSendThankYouNotice:h,cashAccountName:i})=>{let{payments:j}=(0,y.useInstallmentPayments)(a.id),{hasPermission:k}=(0,t.useProfiles)(),{canViewCostPrice:l,canViewProfit:m,canViewSellingPrice:n,canViewTotalAmount:o}=(0,z.useFinancialVisibility)(),p=a.items.reduce((a,b)=>{let c=b.price*b.quantity,d="amount"===b.discountType?b.discountAmount||0:c*(b.discountPercentage||0)/100;return a+(c-d)},0),q=a.items.reduce((a,b)=>{let c=b.price*b.quantity,d="amount"===b.discountType?b.discountAmount||0:c*(b.discountPercentage||0)/100;return a+d},0),r=a.taxRate||0,s=p+r/100*p,u=a.items.reduce((a,b)=>a+b.cost*b.quantity,0),v="Installment Sale"===a.paymentStatus?j.reduce((a,b)=>a+b.amount,0):a.amountPaid||0,w="Installment Sale"===a.paymentStatus?Math.max(0,s-v):a.amountDue||0,x="No items";a.items&&Array.isArray(a.items)&&a.items.length>0&&(x=a.items[0].description,a.items.length>1&&(x+=` (+${a.items.length-1} more)`));let K="NOT PAID"===a.paymentStatus,M="Installment Sale"===a.paymentStatus&&w>0,N=(()=>{switch(a.paymentStatus){case"Paid":default:return F.Receipt;case"NOT PAID":return G.FileText;case"Quote":return H.Quote}})(),O=(()=>{switch(a.paymentStatus){case"Paid":default:return"Receipt";case"NOT PAID":return"Invoice";case"Quote":return"Quotation"}})();return(0,d.jsx)(A.Card,{className:`mb-3 bg-white border shadow-sm ${i?"border-l-4 border-l-green-500 border-green-200":"border-gray-200"}`,children:(0,d.jsxs)(A.CardContent,{className:"p-4",children:[i&&(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-2 p-2 bg-green-50 rounded-md border border-green-200",children:[(0,d.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),(0,d.jsxs)("span",{className:"text-xs font-medium text-green-700 truncate",children:["Linked to: ",i]})]}),(0,d.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0 pr-2",children:[(0,d.jsx)("p",{className:"font-semibold text-gray-900 text-sm truncate",children:a.customerName}),(0,d.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:new Date(a.date).toLocaleDateString("en-GB")}),"Installment Sale"===a.paymentStatus&&w>0&&(0,d.jsxs)(C.Badge,{variant:"outline",className:"text-xs bg-red-50 text-red-700 border-red-200 mt-1",children:["Due: ",n||o?`${b.currency} ${(0,J.formatNumber)(w)}`:"•••"]})]}),(0,d.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${(()=>{switch(a.paymentStatus){case"Paid":return"bg-green-100 text-green-700";case"Quote":return"bg-purple-100 text-purple-700";case"Installment Sale":return"bg-blue-100 text-blue-700";default:return"bg-yellow-100 text-yellow-700"}})()}`,children:"Installment Sale"===a.paymentStatus?"Installment":"NOT PAID"===a.paymentStatus?"Credit":a.paymentStatus})]}),(0,d.jsxs)(L.Tooltip,{children:[(0,d.jsx)(L.TooltipTrigger,{asChild:!0,children:(0,d.jsx)("p",{className:"text-xs text-gray-600 mb-3 line-clamp-1 cursor-help",children:x})}),(0,d.jsx)(L.TooltipContent,{side:"top",className:"max-w-xs",children:(0,d.jsx)("div",{className:"space-y-1",children:(0,d.jsx)("p",{className:"font-bold break-words whitespace-normal",children:x})})})]}),(0,d.jsxs)("div",{className:"space-y-3 mb-3",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsxs)("div",{className:"text-left",children:[(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Cost"}),(0,d.jsx)("p",{className:"font-semibold text-gray-900",children:l?`${b.currency} ${(0,J.formatNumber)(u)}`:"•••"})]}),q>0?(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Discount"}),(0,d.jsx)("p",{className:"font-semibold text-orange-600",children:n?`-${b.currency} ${(0,J.formatNumber)(q)}`:"•••"})]}):(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Discount"}),(0,d.jsx)("p",{className:"font-semibold text-gray-400",children:"-"})]})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsxs)("div",{className:"text-left",children:[(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Total Amount"}),(0,d.jsx)("p",{className:"font-semibold text-gray-900",children:o||n?`${b.currency} ${(0,J.formatNumber)(s)}`:"•••"}),r>0&&(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Tax incl."}),"Installment Sale"===a.paymentStatus&&v>0&&(0,d.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["Paid: ",o||n?`${b.currency} ${(0,J.formatNumber)(v)}`:"•••"]})]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Profit"}),(0,d.jsx)("p",{className:"font-semibold text-green-600",children:m?`${b.currency} ${(0,J.formatNumber)(s-u)}`:"•••"})]})]})]}),(0,d.jsxs)("div",{className:"pt-3 border-t border-gray-100 space-y-2",children:[(0,d.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,d.jsxs)(B.Button,{variant:"outline",size:"sm",onClick:()=>c(a),className:"flex items-center gap-1.5 text-xs h-8 border-gray-200 flex-1 min-w-0",children:[(0,d.jsx)(N,{className:"h-3 w-3 flex-shrink-0"}),(0,d.jsx)("span",{className:"truncate",children:O})]}),K&&(0,d.jsxs)(B.Button,{variant:"outline",size:"sm",onClick:()=>g(a),className:"flex items-center gap-1.5 text-xs h-8 border-orange-200 text-orange-600 hover:bg-orange-50 flex-1 min-w-0",children:[(0,d.jsx)(G.FileText,{className:"h-3 w-3 flex-shrink-0"}),(0,d.jsx)("span",{className:"truncate",children:"Reminder"})]}),M&&(0,d.jsxs)(B.Button,{variant:"outline",size:"sm",onClick:()=>g(a),className:"flex items-center gap-1.5 text-xs h-8 border-blue-200 text-blue-600 hover:bg-blue-50 flex-1 min-w-0",children:[(0,d.jsx)(G.FileText,{className:"h-3 w-3 flex-shrink-0"}),(0,d.jsx)("span",{className:"truncate",children:"Due Reminder"})]}),(0,d.jsxs)(B.Button,{variant:"outline",size:"sm",onClick:()=>h(a),className:"flex items-center gap-1.5 text-xs h-8 border-purple-200 text-purple-600 hover:bg-purple-50 flex-1 min-w-0",children:[(0,d.jsx)(I.Heart,{className:"h-3 w-3 flex-shrink-0"}),(0,d.jsx)("span",{className:"truncate",children:"Thanks"})]})]}),(0,d.jsxs)("div",{className:"flex justify-center gap-2",children:[k("sales","edit")&&(0,d.jsxs)(B.Button,{variant:"ghost",size:"sm",onClick:()=>e(a),className:"h-8 px-3 hover:bg-blue-50 hover:text-blue-600 flex items-center gap-1",children:[(0,d.jsx)(D.Edit,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"text-xs",children:"Edit"})]}),k("sales","delete")&&(0,d.jsxs)(B.Button,{variant:"ghost",size:"sm",onClick:()=>f(a),className:"h-8 px-3 hover:bg-red-50 hover:text-red-600 flex items-center gap-1",children:[(0,d.jsx)(E.Trash2,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"text-xs",children:"Delete"})]})]})]})]})})});O.displayName="MobileCard",a.s(["default",0,({sales:a,onViewReceipt:b,onEditSale:c,onDeleteSale:t,currency:y="USD",onDateFilterChange:z,onDateRangeChange:A,isLoading:B=!1,mobileOptimized:C=!1})=>{let[D,E]=(0,e.useState)({...N,currency:y}),[I,J]=(0,e.useState)(null),[M,P]=(0,e.useState)(!1),[Q,R]=(0,e.useState)(!1),[S,T]=(0,e.useState)(null),[U,V]=(0,e.useState)(!1),[W,X]=(0,e.useState)(null),[Y,Z]=(0,e.useState)(!1),{accounts:$}=(0,u.useCashAccounts)(),{transactions:_}=(0,v.useCashTransactions)(),{settings:aa}=(0,w.useBusinessSettings)(),{toast:ab}=(0,x.useToast)(),ac=(0,s.useIsMobile)(),{searchQuery:ad,setSearchQuery:ae,paymentFilter:af,setPaymentFilter:ag,cashTransactionFilter:ah,setCashTransactionFilter:ai,categoryFilter:aj,setCategoryFilter:ak,dateFilter:al,setDateFilter:am,dateRange:an,setDateRange:ao,specificDate:ap,setSpecificDate:aq,isCustomRange:ar,isSpecificDate:as,filteredSales:at}=(0,q.useSalesFilters)(a),au=(0,e.useMemo)(()=>at,[at]),{currentPage:av,setCurrentPage:aw,paginatedItems:ax,totalPages:ay}=(0,r.usePagination)({items:au,itemsPerPage:C?5:10});(0,e.useEffect)(()=>{z&&z(al)},[al,z]),(0,e.useEffect)(()=>{A&&ar&&A(an)},[an,ar,A]),(0,e.useEffect)(()=>{E(a=>({...a,currency:y}));let a=localStorage.getItem("businessSettings");if(a){let b=JSON.parse(a);E({...b,currency:y||b.currency})}},[y]);let az=(0,e.useCallback)(a=>{if(!a.cashTransactionId)return null;let b=_.find(b=>b.id===a.cashTransactionId);if(!b||!b.accountId)return null;let c=$.find(a=>a.id===b.accountId);return c?c.name:null},[_,$]);(0,e.useCallback)(a=>{switch(a){case"Paid":default:return"Receipt";case"NOT PAID":return"Invoice";case"Quote":return"Quotation"}},[]),(0,e.useCallback)(a=>{switch(a){case"Paid":default:return F.Receipt;case"NOT PAID":return G.FileText;case"Quote":return H.Quote}},[]);let aA=(0,e.useCallback)(a=>{J(a),P(!0)},[]),aB=(0,e.useCallback)(async()=>{if(I&&!Q){R(!0);try{await t(I),P(!1),J(null)}finally{R(!1)}}},[I,t,Q]),aC=(0,e.useCallback)(a=>{Q||a||(P(!1),J(null))},[Q]),aD=(0,e.useCallback)(a=>{T(a),V(!0)},[]),aE=(0,e.useCallback)(()=>{V(!1),T(null)},[]),aF=(0,e.useCallback)(async a=>{try{a.customerId,a.customerName,a.customerContact,a.customerAddress,a.items.reduce((a,b)=>a+b.price*b.quantity,0),a.taxRate,X(a),Z(!0)}catch(a){console.error("Error generating payment reminder:",a),ab({title:"Error",description:"Failed to generate payment reminder. Please try again.",variant:"destructive"})}},[aa,D,ab]);return((0,e.useCallback)(a=>{if(!(0,K.canSendSMS)({phoneNumber:a.customerContact}))return void ab({title:"Phone number required",description:"Customer phone number is not available for WhatsApp.",variant:"destructive"});let b=(0,K.getThankYouMessage)(a,aa||D);(0,K.openWhatsApp)({phoneNumber:a.customerContact,message:b}),ab({title:"WhatsApp Opened",description:`Opening WhatsApp chat for ${a.customerName}`})},[aa,D,ab]),B)?(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[40vh] space-y-4",children:[(0,d.jsx)("img",{src:"/lovable-uploads/7f7549a3-e9df-4762-b8b9-8e041e34f55d.png",alt:"Loading",className:"w-12 h-12 animate-spin"}),(0,d.jsx)("p",{className:"text-muted-foreground text-sm",children:"Loading sales..."})]}):(0,d.jsx)(L.TooltipProvider,{children:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-border/50",children:[(0,d.jsx)("div",{className:"p-4 sm:p-6 border-b border-border/50",children:(0,d.jsx)("div",{className:"flex flex-col gap-4",children:(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-foreground",children:"Sales Records"}),(0,d.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[au.length," ",1===au.length?"record":"records"," found"]})]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(o.default,{}),(0,d.jsx)("div",{className:"w-full sm:w-auto",children:(0,d.jsx)(g.default,{filteredSales:au,allSales:a,currency:D.currency})})]})]})})}),(0,d.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,d.jsx)(p.SalesSummaryCards,{sales:au,currency:D.currency}),(0,d.jsx)(h.default,{searchQuery:ad,setSearchQuery:ae,paymentFilter:af,setPaymentFilter:ag,cashTransactionFilter:ah,setCashTransactionFilter:ai,categoryFilter:aj,setCategoryFilter:ak,dateFilter:al,setDateFilter:am,dateRange:an,setDateRange:ao,specificDate:ap,setSpecificDate:aq,isCustomRange:ar,isSpecificDate:as}),au.length>0?(0,d.jsxs)(d.Fragment,{children:[ac?(0,d.jsx)("div",{className:"space-y-3",children:ax.map(a=>(0,d.jsx)(O,{sale:a,settings:D,onViewReceipt:b,onEditSale:c,onDeleteSale:aA,onSendPaymentReminder:aF,onSendThankYouNotice:aD,cashAccountName:az(a)},a.id))}):(0,d.jsx)("div",{className:"overflow-x-auto border rounded-lg",children:(0,d.jsxs)(f.Table,{children:[(0,d.jsx)(f.TableHeader,{children:(0,d.jsxs)(f.TableRow,{children:[(0,d.jsx)(f.TableHead,{children:"Date"}),(0,d.jsx)(f.TableHead,{children:"Receipt #"}),(0,d.jsx)(f.TableHead,{children:"Customer"}),(0,d.jsx)(f.TableHead,{children:"Item"}),(0,d.jsx)(f.TableHead,{className:"text-right",children:"Total Qty"}),(0,d.jsx)(f.TableHead,{className:"text-right",children:"Avg Price"}),(0,d.jsx)(f.TableHead,{className:"text-right",children:"Discount"}),(0,d.jsx)(f.TableHead,{className:"text-right",children:"Cost"}),(0,d.jsx)(f.TableHead,{className:"text-right",children:"Profit"}),(0,d.jsx)(f.TableHead,{className:"text-right",children:"Total (incl. Tax)"}),(0,d.jsx)(f.TableHead,{children:"Status"}),(0,d.jsx)(f.TableHead,{className:"text-right",children:"Actions"})]})}),(0,d.jsx)(f.TableBody,{children:ax.map(a=>(0,d.jsx)(i.default,{sale:a,currency:D.currency,onViewReceipt:b,onEditSale:c,onDeleteSale:aA,onSendPaymentReminder:aF,onSendThankYouNotice:aD},a.id))})]})}),(0,d.jsx)("div",{className:"mt-6",children:(0,d.jsx)(j.default,{currentPage:av,totalPages:ay,onPageChange:aw})})]}):(0,d.jsx)(k.default,{})]})]}),(0,d.jsx)(l.default,{isOpen:M,onOpenChange:aC,onConfirm:aB,isDeleting:Q}),S&&(0,d.jsx)(m.default,{customer:{id:S.customerId||"",fullName:S.customerName,phoneNumber:S.customerContact||"",email:"",location:S.customerAddress||"",categoryId:null,createdAt:new Date,updatedAt:new Date,birthday:null,socialMedia:null,gender:null,tags:null,notes:null},open:U,onClose:aE,defaultTemplate:"thank_you",sale:S}),(0,d.jsx)(n.default,{isOpen:Y,onOpenChange:Z,sale:W})]})})}]),c()}catch(a){c(a)}},!1),891968,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(451790),g=a.i(339027),h=b([f]);[f]=h.then?(await h)():h,a.s(["default",0,({sales:a,onViewReceipt:b,onEditSale:c,onDeleteSale:h,currency:i,isLoading:j})=>(0,d.jsx)("div",{className:"space-y-6",children:(0,d.jsx)(e.Suspense,{fallback:(0,d.jsx)(g.default,{}),children:(0,d.jsx)(f.default,{sales:a,onViewReceipt:b,onEditSale:c,onDeleteSale:h,currency:i,isLoading:j,mobileOptimized:!1})})})]),c()}catch(a){c(a)}},!1),808082,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(800735),f=b([e]);[e]=f.then?(await f)():f,a.s(["default",0,({selectedSale:a,isOpen:b,onOpenChange:c,currency:f})=>a?(0,d.jsx)(e.default,{sale:a,isOpen:b,onOpenChange:c,currency:f}):null]),c()}catch(a){c(a)}},!1),563919,a=>{"use strict";let b=(0,a.i(564375).default)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);a.s(["Trophy",()=>b],563919)},575639,a=>{"use strict";let b=(0,a.i(564375).default)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);a.s(["Target",()=>b],575639)},200788,a=>{"use strict";let b=(0,a.i(564375).default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);a.s(["Edit2",()=>b],200788)},52104,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(811705),g=a.i(396465),h=a.i(112779),i=a.i(540629),j=a.i(893759),k=a.i(688272),l=a.i(393551),m=a.i(158799),n=a.i(864369),o=a.i(558277),p=a.i(515016),q=a.i(352519),r=a.i(413646),s=a.i(563919);a.i(575639);var t=a.i(200788),u=a.i(946032),v=a.i(493901),w=a.i(597435),x=a.i(734637),y=a.i(645872),z=a.i(585459),A=a.i(169320),B=a.i(792071),C=a.i(665376),D=a.i(128069),E=a.i(122460),F=a.i(126554),G=a.i(759447),H=a.i(178465),I=a.i(385674),J=a.i(304050),K=a.i(284177),L=a.i(671693),M=a.i(460716),N=a.i(799856),O=a.i(625250),P=b([f,g,h,i,j,k,l,m,n,A,N,O]);[f,g,h,i,j,k,l,m,n,A,N,O]=P.then?(await P)():P,a.s(["default",0,({sales:a,formatCurrency:b})=>{let{canViewProfit:c}=(0,O.useFinancialVisibility)(),{categories:P,createCategory:Q,updateCategory:R,deleteCategory:S}=(0,n.useSalesCategories)(),T=(0,o.useIsMobile)(),[U,V]=(0,e.useState)(null),[W,X]=(0,e.useState)(""),[Y,Z]=(0,e.useState)(""),[$,_]=(0,e.useState)(!1),[aa,ab]=(0,e.useState)(null),[ac,ad]=(0,e.useState)(!1),[ae,af]=(0,e.useState)(!1),[ag,ah]=(0,e.useState)("all-time"),[ai,aj]=(0,e.useState)(),[ak,al]=(0,e.useState)(),[am,an]=(0,e.useState)(),ao=(0,e.useMemo)(()=>{let b=a,c=(a=>{let b=new Date;switch(a){case"today":return{start:(0,C.startOfDay)(b),end:(0,D.endOfDay)(b)};case"yesterday":let c=(0,K.subDays)(b,1);return{start:(0,C.startOfDay)(c),end:(0,D.endOfDay)(c)};case"this-week":return{start:(0,E.startOfWeek)(b),end:(0,F.endOfWeek)(b)};case"last-week":let d=(0,E.startOfWeek)((0,L.subWeeks)(b,1)),e=(0,F.endOfWeek)((0,L.subWeeks)(b,1));return{start:d,end:e};case"this-month":return{start:(0,G.startOfMonth)(b),end:(0,H.endOfMonth)(b)};case"last-month":let f=(0,G.startOfMonth)((0,M.subMonths)(b,1)),g=(0,H.endOfMonth)((0,M.subMonths)(b,1));return{start:f,end:g};case"this-year":return{start:(0,I.startOfYear)(b),end:(0,J.endOfYear)(b)};case"specific-date":if(am)return{start:(0,C.startOfDay)(am),end:(0,D.endOfDay)(am)};return null;case"custom-range":if(ai&&ak)return{start:(0,C.startOfDay)(ai),end:(0,D.endOfDay)(ak)};if(ai)return{start:(0,C.startOfDay)(ai),end:(0,D.endOfDay)(b)};if(ak)return{start:(0,C.startOfDay)(new Date(0)),end:(0,D.endOfDay)(ak)};return null;default:return null}})(ag);c&&(b=a.filter(a=>{let b=new Date(a.date);return b>=c.start&&b<=c.end}));let d=P.map(a=>{let c=b.filter(b=>b.categoryId===a.id),d=c.reduce((a,b)=>{let c=b.items.reduce((a,b)=>a+b.quantity*b.price,0);return a+c},0),e=c.reduce((a,b)=>a+(b.profit||0),0),f=c.length;return{name:a.name,revenue:d,profit:e,transactions:f,averageValue:f>0?d/f:0}}),e=b.filter(a=>!a.categoryId);if(e.length>0){let a=e.reduce((a,b)=>{let c=b.items.reduce((a,b)=>a+b.quantity*b.price,0);return a+c},0),b=e.reduce((a,b)=>a+(b.profit||0),0),c=e.length;d.push({name:"Uncategorized",revenue:a,profit:b,transactions:c,averageValue:c>0?a/c:0})}return d.sort((a,b)=>b.revenue-a.revenue)},[a,P,ag,ai,ak,am]);(0,e.useMemo)(()=>ao.filter(a=>a.revenue>0).map((a,b)=>({...a,fill:`hsl(var(--chart-${b%5+1}))`})),[ao]);let ap=async()=>{if(U&&W.trim())try{await R(U,W.trim()),V(null),X(""),A.toast.success("Category updated successfully")}catch(a){A.toast.error("Failed to update category")}},aq=()=>{V(null),X("")},ar=async()=>{if(aa){af(!0);try{await S(aa.id),A.toast.success("Category deleted successfully"),_(!1),ab(null)}catch(a){A.toast.error("Failed to delete category")}finally{af(!1)}}},as=async()=>{if(Y.trim()){ad(!0);try{await Q(Y.trim()),Z(""),A.toast.success("Category created successfully")}catch(a){A.toast.error("Failed to create category")}finally{ad(!1)}}};return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)(f.Card,{className:"shadow-sm",children:[(0,d.jsxs)(f.CardHeader,{children:[(0,d.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,d.jsx)(y.Settings,{className:"w-5 h-5 text-primary"}),"Manage Sales Sources"]}),(0,d.jsx)(f.CardDescription,{children:"Create, edit, or delete sales sources"})]}),(0,d.jsx)(f.CardContent,{children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex gap-2 p-3 bg-muted/30 rounded-lg",children:[(0,d.jsx)(h.Input,{placeholder:"Enter New Sales Source",value:Y,onChange:a=>Z(a.target.value),onKeyDown:a=>"Enter"===a.key&&as(),className:"flex-1"}),(0,d.jsx)(g.Button,{onClick:as,disabled:!Y.trim()||ac,size:"sm",className:"shrink-0",children:ac?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"w-4 h-4 mr-1 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Adding..."]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(v.Plus,{className:"w-4 h-4 mr-1"}),"Add"]})})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[P.map(a=>(0,d.jsx)("div",{className:"flex items-center gap-2 p-3 border rounded-lg bg-background hover:bg-muted/20 transition-colors",children:U===a.id?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h.Input,{value:W,onChange:a=>X(a.target.value),onKeyDown:a=>{"Enter"===a.key&&ap(),"Escape"===a.key&&aq()},className:"flex-1",autoFocus:!0}),(0,d.jsx)(g.Button,{size:"sm",variant:"outline",onClick:ap,children:(0,d.jsx)(w.Check,{className:"w-4 h-4"})}),(0,d.jsx)(g.Button,{size:"sm",variant:"outline",onClick:aq,children:(0,d.jsx)(x.X,{className:"w-4 h-4"})})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"flex-1 font-medium",children:a.name}),(0,d.jsx)(g.Button,{size:"sm",variant:"outline",onClick:()=>{V(a.id),X(a.name)},children:(0,d.jsx)(t.Edit2,{className:"w-4 h-4"})}),(0,d.jsx)(g.Button,{size:"sm",variant:"outline",onClick:()=>{ab(a),_(!0)},className:"text-destructive hover:bg-destructive hover:text-destructive-foreground",children:(0,d.jsx)(u.Trash2,{className:"w-4 h-4"})})]})},a.id)),0===P.length&&(0,d.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No sources found. Create your first source above."})]})]})})]}),(0,d.jsxs)(f.Card,{className:"shadow-sm",children:[(0,d.jsxs)(f.CardHeader,{children:[(0,d.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,d.jsx)(z.CalendarIcon,{className:"w-5 h-5 text-primary"}),"Date Filter"]}),(0,d.jsx)(f.CardDescription,{children:"Filter source performance by time period"})]}),(0,d.jsxs)(f.CardContent,{children:[(0,d.jsx)("div",{className:"flex flex-col sm:flex-row gap-4 items-end",children:(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Time Period"}),(0,d.jsxs)(k.Select,{value:ag,onValueChange:ah,children:[(0,d.jsx)(k.SelectTrigger,{className:"w-full",children:(0,d.jsx)(k.SelectValue,{placeholder:"Select time period"})}),(0,d.jsxs)(k.SelectContent,{className:"bg-background border shadow-lg z-50",children:[(0,d.jsx)(k.SelectItem,{value:"today",children:"Today"}),(0,d.jsx)(k.SelectItem,{value:"yesterday",children:"Yesterday"}),(0,d.jsx)(k.SelectItem,{value:"this-week",children:"This Week"}),(0,d.jsx)(k.SelectItem,{value:"last-week",children:"Last Week"}),(0,d.jsx)(k.SelectItem,{value:"this-month",children:"This Month"}),(0,d.jsx)(k.SelectItem,{value:"last-month",children:"Last Month"}),(0,d.jsx)(k.SelectItem,{value:"this-year",children:"This Year"}),(0,d.jsx)(k.SelectItem,{value:"all-time",children:"All Time"}),(0,d.jsx)(k.SelectItem,{value:"specific-date",children:"Specific Date"}),(0,d.jsx)(k.SelectItem,{value:"custom-range",children:"Custom Range"})]})]})]})}),"custom-range"===ag&&(0,d.jsxs)("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"From Date"}),(0,d.jsxs)(m.Popover,{children:[(0,d.jsx)(m.PopoverTrigger,{asChild:!0,children:(0,d.jsxs)(g.Button,{variant:"outline",className:(0,N.cn)("w-full justify-start text-left font-normal",!ai&&"text-muted-foreground"),children:[(0,d.jsx)(z.CalendarIcon,{className:"mr-2 h-4 w-4"}),ai?(0,B.format)(ai,"PPP"):(0,d.jsx)("span",{children:"Pick start date"})]})}),(0,d.jsx)(m.PopoverContent,{className:"w-auto p-0",align:"start",children:(0,d.jsx)(l.Calendar,{mode:"single",selected:ai,onSelect:aj,initialFocus:!0,className:(0,N.cn)("p-3 pointer-events-auto")})})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"To Date"}),(0,d.jsxs)(m.Popover,{children:[(0,d.jsx)(m.PopoverTrigger,{asChild:!0,children:(0,d.jsxs)(g.Button,{variant:"outline",className:(0,N.cn)("w-full justify-start text-left font-normal",!ak&&"text-muted-foreground"),children:[(0,d.jsx)(z.CalendarIcon,{className:"mr-2 h-4 w-4"}),ak?(0,B.format)(ak,"PPP"):(0,d.jsx)("span",{children:"Pick end date"})]})}),(0,d.jsx)(m.PopoverContent,{className:"w-auto p-0",align:"start",children:(0,d.jsx)(l.Calendar,{mode:"single",selected:ak,onSelect:al,initialFocus:!0,className:(0,N.cn)("p-3 pointer-events-auto")})})]})]})]}),"specific-date"===ag&&(0,d.jsxs)("div",{className:"mt-4",children:[(0,d.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Select Date"}),(0,d.jsxs)(m.Popover,{children:[(0,d.jsx)(m.PopoverTrigger,{asChild:!0,children:(0,d.jsxs)(g.Button,{variant:"outline",className:(0,N.cn)("w-full sm:w-64 justify-start text-left font-normal",!am&&"text-muted-foreground"),children:[(0,d.jsx)(z.CalendarIcon,{className:"mr-2 h-4 w-4"}),am?(0,B.format)(am,"PPP"):(0,d.jsx)("span",{children:"Pick a date"})]})}),(0,d.jsx)(m.PopoverContent,{className:"w-auto p-0",align:"start",children:(0,d.jsx)(l.Calendar,{mode:"single",selected:am,onSelect:an,initialFocus:!0,className:(0,N.cn)("p-3 pointer-events-auto")})})]})]}),"all-time"!==ag&&(0,d.jsx)("div",{className:"mt-4 p-3 bg-muted/30 rounded-lg",children:(0,d.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Showing results for: ",(0,d.jsx)("span",{className:"font-medium",children:"today"===ag?"Today":"yesterday"===ag?"Yesterday":"this-week"===ag?"This Week":"last-week"===ag?"Last Week":"this-month"===ag?"This Month":"last-month"===ag?"Last Month":"this-year"===ag?"This Year":"specific-date"===ag&&am?(0,B.format)(am,"PPP"):"custom-range"===ag&&ai&&ak?`${(0,B.format)(ai,"PPP")} to ${(0,B.format)(ak,"PPP")}`:"custom-range"===ag&&ai?`From ${(0,B.format)(ai,"PPP")}`:"custom-range"===ag&&ak?`Until ${(0,B.format)(ak,"PPP")}`:"Custom Period"})]})})]})]}),(0,d.jsxs)(f.Card,{className:"shadow-sm",children:[(0,d.jsxs)(f.CardHeader,{children:[(0,d.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,d.jsx)(s.Trophy,{className:"w-5 h-5 text-primary"}),"Source Rankings"]}),(0,d.jsx)(f.CardDescription,{children:"Best performing sources ranked by revenue"})]}),(0,d.jsx)(f.CardContent,{children:ao.length>0?T?(0,d.jsx)("div",{className:"space-y-3",children:ao.map((a,e)=>(0,d.jsx)(f.Card,{className:"border border-border bg-card",children:(0,d.jsxs)(f.CardContent,{className:"p-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary text-primary-foreground text-sm font-bold",children:e+1}),(0,d.jsx)("h3",{className:"font-semibold text-lg",children:a.name})]}),(0,d.jsx)(s.Trophy,{className:"w-5 h-5 text-primary"})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/30 rounded-lg",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(q.DollarSign,{className:"w-4 h-4 text-green-600"}),(0,d.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"Total Revenue"})]}),(0,d.jsx)("span",{className:"font-semibold",children:b(a.revenue)})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/30 rounded-lg",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(p.TrendingUp,{className:"w-4 h-4 text-blue-600"}),(0,d.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"Total Profit"})]}),(0,d.jsx)("span",{className:"font-semibold",children:c?b(a.profit):"•••"})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/30 rounded-lg",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(r.ShoppingCart,{className:"w-4 h-4 text-purple-600"}),(0,d.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"Number of Sales"})]}),(0,d.jsx)("span",{className:"font-semibold",children:a.transactions})]})]})]})},a.name))}):(0,d.jsxs)(i.Table,{children:[(0,d.jsx)(i.TableHeader,{children:(0,d.jsxs)(i.TableRow,{children:[(0,d.jsx)(i.TableHead,{className:"w-12",children:"#"}),(0,d.jsx)(i.TableHead,{children:"Source Name"}),(0,d.jsx)(i.TableHead,{className:"text-right",children:"Total Revenue"}),(0,d.jsx)(i.TableHead,{className:"text-right",children:"Total Profit"}),(0,d.jsx)(i.TableHead,{className:"text-right",children:"Number of Sales"})]})}),(0,d.jsx)(i.TableBody,{children:ao.map((a,e)=>(0,d.jsxs)(i.TableRow,{children:[(0,d.jsx)(i.TableCell,{className:"font-medium",children:(0,d.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-muted text-xs font-bold",children:e+1})}),(0,d.jsx)(i.TableCell,{className:"font-medium",children:a.name}),(0,d.jsx)(i.TableCell,{className:"text-right font-mono",children:b(a.revenue)}),(0,d.jsx)(i.TableCell,{className:"text-right font-mono",children:c?b(a.profit):"•••"}),(0,d.jsx)(i.TableCell,{className:"text-right",children:a.transactions})]},a.name))})]}):(0,d.jsx)("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:"No performance data available"})})]}),(0,d.jsx)(j.AlertDialog,{open:$,onOpenChange:_,children:(0,d.jsxs)(j.AlertDialogContent,{children:[(0,d.jsxs)(j.AlertDialogHeader,{children:[(0,d.jsx)(j.AlertDialogTitle,{children:"Delete Source"}),(0,d.jsxs)(j.AlertDialogDescription,{children:['Are you sure you want to delete the source "',aa?.name,'"? This action cannot be undone. All sales in this source will be moved to "Uncategorized".']})]}),(0,d.jsxs)(j.AlertDialogFooter,{children:[(0,d.jsx)(j.AlertDialogCancel,{onClick:()=>ab(null),children:"Cancel"}),(0,d.jsx)(j.AlertDialogAction,{onClick:ar,disabled:ae,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:ae?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"w-4 h-4 mr-2 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Deleting..."]}):"Delete Source"})]})]})})]})}]),c()}catch(a){c(a)}},!1),138609,a=>{"use strict";let b=(0,a.i(564375).default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);a.s(["User",()=>b],138609)},278137,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(540629),f=a.i(899054),g=a.i(792071),h=a.i(946032),i=a.i(138609),j=a.i(818703),k=b([e,f]);[e,f]=k.then?(await k)():k,a.s(["DeletedSalesTable",0,({sales:a,isLoading:b,currency:c="UGX"})=>b?(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[(0,d.jsx)("div",{className:"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin"}),(0,d.jsx)("p",{className:"text-muted-foreground text-sm",children:"Loading deleted sales history..."})]}):0===a.length?(0,d.jsxs)("div",{className:"text-center py-12 border rounded-lg bg-muted/20",children:[(0,d.jsx)(h.Trash2,{className:"mx-auto h-12 w-12 text-muted-foreground opacity-20 mb-4"}),(0,d.jsx)("h3",{className:"text-lg font-medium",children:"Deleted Sales history is empty"}),(0,d.jsx)("p",{className:"text-muted-foreground",children:"Deleted sales logs will appear here."})]}):(0,d.jsx)("div",{className:"border rounded-lg overflow-hidden bg-white",children:(0,d.jsxs)(e.Table,{children:[(0,d.jsx)(e.TableHeader,{className:"bg-muted/50",children:(0,d.jsxs)(e.TableRow,{children:[(0,d.jsx)(e.TableHead,{children:"Receipt #"}),(0,d.jsx)(e.TableHead,{children:"Customer"}),(0,d.jsx)(e.TableHead,{children:"Items"}),(0,d.jsx)(e.TableHead,{className:"text-right",children:"Total Qty"}),(0,d.jsx)(e.TableHead,{className:"text-right",children:"Total Amount"}),(0,d.jsx)(e.TableHead,{children:"Deleted At"}),(0,d.jsx)(e.TableHead,{children:"Deleted By"})]})}),(0,d.jsx)(e.TableBody,{children:a.map(a=>(0,d.jsxs)(e.TableRow,{className:"hover:bg-muted/30",children:[(0,d.jsx)(e.TableCell,{className:"font-mono font-medium",children:a.receiptNumber}),(0,d.jsx)(e.TableCell,{children:a.customerName}),(0,d.jsx)(e.TableCell,{children:(0,d.jsx)("div",{className:"max-w-[250px]",children:(0,d.jsx)("div",{className:"flex flex-wrap gap-1",children:a.items.map((a,b)=>{let c=a.quantity??a.qty??0;return(0,d.jsxs)(f.Badge,{variant:"outline",className:"text-[10px] py-0 h-4 bg-muted/30",children:[c,"x ",a.description]},b)})})})}),(0,d.jsx)(e.TableCell,{className:"text-right font-medium",children:a.totalQuantity}),(0,d.jsxs)(e.TableCell,{className:"text-right font-semibold",children:[c," ",a.amount.toLocaleString()]}),(0,d.jsx)(e.TableCell,{children:(0,d.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[(0,d.jsx)(j.Clock,{className:"h-3 w-3"}),(0,g.format)(new Date(a.deletedAt),"MMM d, h:mm a")]})}),(0,d.jsx)(e.TableCell,{children:(0,d.jsxs)("div",{className:"flex items-center gap-1.5 text-xs",children:[(0,d.jsx)(i.User,{className:"h-3 w-3 text-muted-foreground"}),a.deletedBy]})})]},a.id))})]})})]),c()}catch(a){c(a)}},!1),665561,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(964889),f=a.i(411418),g=a.i(199105),h=b([e,f,g]);[e,f,g]=h.then?(await h)():h,a.s(["useDeletedSales",0,()=>{let[a,b]=(0,d.useState)([]),[c,h]=(0,d.useState)(!1),{currentBusiness:i}=(0,e.useBusiness)(),{userId:j}=(0,f.useCurrentUser)(),k=(0,d.useCallback)(async()=>{if(i?.id&&j){h(!0);try{let a=await (0,g.getActivityHistoryAction)(i.id,"SALES","DELETE");if(!a.success)throw Error(a.error);let c=(a.data||[]).map(a=>{let b=a.metadata||{},c=Array.isArray(b.items)?b.items:[],d=Number(b.totalAmount||0);0===d&&c.length>0&&(d=c.reduce((a,b)=>{let c=Number(b.total)||Number(b.price||0)*Number(b.quantity||0);return a+c},0));let e=c.reduce((a,b)=>a+Number(b.quantity??b.qty??0),0);return{id:a.id,receiptNumber:b.receiptNumber||"N/A",customerName:b.customerName||"Unknown",amount:d,totalQuantity:e,deletedAt:a.createdAt,deletedBy:a.profileName||"Admin",items:c,fullMetadata:b}});b(c)}catch(a){console.error("Error fetching deleted sales:",a)}finally{h(!1)}}},[i?.id,j]);return(0,d.useEffect)(()=>{k()},[k]),{deletedSales:a,isLoading:c,refetch:k}}]),c()}catch(a){c(a)}},!1),730796,a=>{"use strict";var b=a.i(127669),c=a.i(25670);a.s(["useSalesActions",0,()=>{let a=(0,c.useRouter)(),[d,e]=(0,b.useState)(null),[f,g]=(0,b.useState)(!1),[h,i]=(0,b.useState)(!1),j=(0,b.useCallback)(b=>{a.push(`/new-sale?editId=${b.id}`)},[a]),k=(0,b.useCallback)(a=>{e(a),g(!0)},[]);return{selectedSale:d,isReceiptDialogOpen:f,isDeletingSale:h,handleEditSale:j,handleViewReceipt:k,handleDeleteSale:(0,b.useCallback)(a=>async b=>{i(!0);try{await a(b.id)}finally{i(!1)}},[]),handleCloseReceiptDialog:(0,b.useCallback)(a=>{g(a),a||e(null)},[])}}])},769263,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(148608),g=a.i(270602),h=a.i(339027),i=a.i(129298),j=a.i(891968),k=a.i(808082),l=a.i(52104),m=a.i(278137),n=a.i(385375),o=a.i(665561),p=a.i(224993),q=a.i(964889),r=a.i(411418),s=a.i(730796),t=a.i(506766),u=a.i(946032),v=a.i(396465),w=b([f,g,j,k,l,m,n,o,p,q,r,v]);[f,g,j,k,l,m,n,o,p,q,r,v]=w.then?(await w)():w,a.s(["SalesContent",0,()=>{let[a,b]=(0,e.useState)("overview"),{currentBusiness:c,isLoading:w}=(0,q.useBusiness)(),{settings:x}=(0,p.useBusinessSettings)(),{userId:y}=(0,r.useCurrentUser)(),{sales:z,isLoading:A,deleteSale:B,refetch:C,isFetching:D}=(0,n.useSalesData)(y,"desc"),{deletedSales:E,isLoading:F,refetch:G}=(0,o.useDeletedSales)(),{selectedSale:H,isReceiptDialogOpen:I,handleEditSale:J,handleViewReceipt:K,handleDeleteSale:L,handleCloseReceiptDialog:M}=(0,s.useSalesActions)();if(w||!y)return(0,d.jsx)("div",{className:"p-6 space-y-6",children:(0,d.jsx)(h.default,{})});if(!c)return(0,d.jsx)(i.default,{});let N=async()=>{"deleted-sales"===a?await G():await C()};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"p-6",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Sales Management"}),(0,d.jsxs)(v.Button,{variant:"outline",size:"sm",onClick:N,className:"flex items-center gap-2",disabled:D||F,children:[(0,d.jsx)(t.RefreshCw,{className:`h-4 w-4 ${D||F?"animate-spin":""}`}),D||F?"Refreshing...":"Refresh"]})]}),(0,d.jsxs)(f.Tabs,{value:a,onValueChange:b,children:[(0,d.jsxs)(f.TabsList,{className:"grid w-full grid-cols-3",children:[(0,d.jsx)(f.TabsTrigger,{value:"overview",children:"Sales Overview"}),(0,d.jsx)(f.TabsTrigger,{value:"analysis",children:"Sales Source"}),(0,d.jsxs)(f.TabsTrigger,{value:"deleted-sales",className:"flex items-center gap-2 text-destructive data-[state=active]:text-destructive",children:[(0,d.jsx)(u.Trash2,{className:"h-4 w-4"}),"Deleted Sales"]})]}),(0,d.jsx)(f.TabsContent,{value:"overview",className:"mt-0",children:A&&!z.length?(0,d.jsx)(h.default,{}):0===z.length?(0,d.jsx)(g.default,{}):(0,d.jsx)(j.default,{sales:z,onViewReceipt:K,onEditSale:J,onDeleteSale:L(B),currency:x.currency,isLoading:A})}),(0,d.jsx)(f.TabsContent,{value:"analysis",className:"mt-6",children:(0,d.jsx)(l.default,{sales:z,formatCurrency:a=>new Intl.NumberFormat("en-US",{style:"currency",currency:x.currency||"UGX",minimumFractionDigits:0,maximumFractionDigits:2}).format(a)})}),(0,d.jsx)(f.TabsContent,{value:"deleted-sales",className:"mt-6",children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,d.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,d.jsx)(u.Trash2,{className:"h-5 w-5 text-muted-foreground"}),"Deleted Sales History"]}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"View and manage recently deleted sales records."})]}),(0,d.jsx)(m.DeletedSalesTable,{sales:E,isLoading:F,currency:x.currency})]})})]})]}),(0,d.jsx)(k.default,{selectedSale:H,isOpen:I,onOpenChange:M,currency:x.currency})]})}]),c()}catch(a){c(a)}},!1),695100,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(769263),f=b([e]);[e]=f.then?(await f)():f,a.s(["default",0,()=>(0,d.jsx)(e.SalesContent,{})]),c()}catch(a){c(a)}},!1),365660,a=>a.a(async(b,c)=>{try{var d=a.i(579168),e=a.i(627068),f=a.i(332759),g=a.i(539141),h=a.i(706555),i=a.i(695100),j=a.i(509193),k=b([i]);[i]=k.then?(await k)():k;let l=(0,f.hoist)(i,"default"),m=(0,f.hoist)(i,"getStaticProps"),n=(0,f.hoist)(i,"getStaticPaths"),o=(0,f.hoist)(i,"getServerSideProps"),p=(0,f.hoist)(i,"config"),q=(0,f.hoist)(i,"reportWebVitals"),r=(0,f.hoist)(i,"unstable_getStaticProps"),s=(0,f.hoist)(i,"unstable_getStaticPaths"),t=(0,f.hoist)(i,"unstable_getStaticParams"),u=(0,f.hoist)(i,"unstable_getServerProps"),v=(0,f.hoist)(i,"unstable_getServerSideProps"),w=new d.PagesRouteModule({definition:{kind:e.RouteKind.PAGES,page:"/Sales",pathname:"/Sales",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:h.default,Document:g.default},userland:i}),x=(0,j.getHandler)({srcPage:"/Sales",config:p,userland:i,routeModule:w,getStaticPaths:n,getStaticProps:m,getServerSideProps:o});a.s(["config",0,p,"default",0,l,"getServerSideProps",0,o,"getStaticPaths",0,n,"getStaticProps",0,m,"handler",0,x,"reportWebVitals",0,q,"routeModule",0,w,"unstable_getServerProps",0,u,"unstable_getServerSideProps",0,v,"unstable_getStaticParams",0,t,"unstable_getStaticPaths",0,s,"unstable_getStaticProps",0,r]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=_1fa09fc3._.js.map