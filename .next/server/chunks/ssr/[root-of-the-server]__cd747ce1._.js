module.exports=[436028,a=>{"use strict";let b=(0,a.i(564375).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],436028)},289118,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(197499),g=a.i(799856),h=b([f,g]);[f,g]=h.then?(await h)():h;let i=(0,f.cva)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),j=e.forwardRef(({className:a,variant:b,...c},e)=>(0,d.jsx)("div",{ref:e,role:"alert",className:(0,g.cn)(i({variant:b}),a),...c}));j.displayName="Alert";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h5",{ref:c,className:(0,g.cn)("mb-1 font-medium leading-none tracking-tight",a),...b}));k.displayName="AlertTitle";let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,g.cn)("text-sm [&_p]:leading-relaxed",a),...b}));l.displayName="AlertDescription",a.s(["Alert",()=>j,"AlertDescription",()=>l,"AlertTitle",()=>k]),c()}catch(a){c(a)}},!1),201516,a=>a.a(async(b,c)=>{try{let b=await a.y("@radix-ui/react-checkbox-b6f9146c5e147ec6");a.n(b),c()}catch(a){c(a)}},!0),459502,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(201516),g=a.i(597435),h=a.i(799856),i=b([f,h]);[f,h]=i.then?(await i)():i;let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.Root,{ref:c,className:(0,h.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...b,children:(0,d.jsx)(f.Indicator,{className:(0,h.cn)("flex items-center justify-center text-current"),children:(0,d.jsx)(g.Check,{className:"h-4 w-4"})})}));j.displayName=f.Root.displayName,a.s(["Checkbox",()=>j]),c()}catch(a){c(a)}},!1),86352,a=>a.a(async(b,c)=>{try{let b=await a.y("react-hook-form-486e25653ef3f41b");a.n(b),c()}catch(a){c(a)}},!0),340001,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(799856),f=b([e]);function g({className:a,...b}){return(0,d.jsx)("div",{className:(0,e.cn)("animate-pulse rounded-md bg-muted",a),...b})}[e]=f.then?(await f)():f,a.s(["Skeleton",()=>g]),c()}catch(a){c(a)}},!1),168065,a=>a.a(async(b,c)=>{try{let b=await a.y("@radix-ui/react-dropdown-menu-37c3be7a592c068a");a.n(b),c()}catch(a){c(a)}},!0),535741,a=>{"use strict";let b=(0,a.i(564375).default)("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);a.s(["Circle",()=>b],535741)},589984,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(168065),g=a.i(597435),h=a.i(643228),i=a.i(535741),j=a.i(799856),k=b([f,j]);[f,j]=k.then?(await k)():k;let l=f.Root,m=f.Trigger;f.Group,f.Portal,f.Sub,f.RadioGroup,e.forwardRef(({className:a,inset:b,children:c,...e},g)=>{let i=a=>{a.stopPropagation()};return(0,d.jsxs)(f.SubTrigger,{ref:g,className:(0,j.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",b&&"pl-8",a),onTouchStart:i,onTouchEnd:i,onTouchMove:i,...e,children:[c,(0,d.jsx)(h.ChevronRight,{className:"ml-auto h-4 w-4"})]})}).displayName=f.SubTrigger.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.SubContent,{ref:c,className:(0,j.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...b})).displayName=f.SubContent.displayName;let n=e.forwardRef(({className:a,sideOffset:b=4,...c},e)=>{let g=a=>{a.stopPropagation()};return(0,d.jsx)(f.Portal,{children:(0,d.jsx)(f.Content,{ref:e,sideOffset:b,className:(0,j.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),onTouchStart:g,onTouchEnd:g,onTouchMove:g,...c})})});n.displayName=f.Content.displayName;let o=e.forwardRef(({className:a,inset:b,...c},e)=>(0,d.jsx)(f.Item,{ref:e,className:(0,j.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",b&&"pl-8",a),...c}));o.displayName=f.Item.displayName,e.forwardRef(({className:a,children:b,checked:c,...e},h)=>(0,d.jsxs)(f.CheckboxItem,{ref:h,className:(0,j.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:c,...e,children:[(0,d.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(f.ItemIndicator,{children:(0,d.jsx)(g.Check,{className:"h-4 w-4"})})}),b]})).displayName=f.CheckboxItem.displayName,e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(f.RadioItem,{ref:e,className:(0,j.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,d.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(f.ItemIndicator,{children:(0,d.jsx)(i.Circle,{className:"h-2 w-2 fill-current"})})}),b]})).displayName=f.RadioItem.displayName;let p=e.forwardRef(({className:a,inset:b,...c},e)=>(0,d.jsx)(f.Label,{ref:e,className:(0,j.cn)("px-2 py-1.5 text-sm font-semibold",b&&"pl-8",a),...c}));p.displayName=f.Label.displayName;let q=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.Separator,{ref:c,className:(0,j.cn)("-mx-1 my-1 h-px bg-muted",a),...b}));q.displayName=f.Separator.displayName,a.s(["DropdownMenu",()=>l,"DropdownMenuContent",()=>n,"DropdownMenuItem",()=>o,"DropdownMenuLabel",()=>p,"DropdownMenuSeparator",()=>q,"DropdownMenuTrigger",()=>m]),c()}catch(a){c(a)}},!1),852741,(a,b,c)=>{let d=Error("Could not parse module '[project]/src/app/actions/products.ts'\n\n'import', and 'export' cannot be used outside of module code");throw d.code="MODULE_UNPARSABLE",d},121677,a=>{"use strict";a.s(["clearInventoryCaches",0,a=>{}])},482331,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(224993),f=a.i(964889),g=a.i(500885),h=a.i(121677),i=a.i(852741),j=b([e,f,g]);[e,f,g]=j.then?(await j)():j,a.s(["useProducts",0,(a,b=50)=>{let[c,j]=(0,d.useState)([]),[k,l]=(0,d.useState)(1),[m,n]=(0,d.useState)(b),[o,p]=(0,d.useState)(0),[q,r]=(0,d.useState)(!1),{settings:s}=(0,e.useBusinessSettings)(),{currentBusiness:t}=(0,f.useBusiness)(),u=(0,g.useQueryClient)(),[v,w]=(0,d.useState)({search:"",category:"all",stockStatus:"all"}),[x,y]=(0,d.useState)(null),z=(0,d.useCallback)(a=>{if(a.search!==v.search){r(!0),x&&clearTimeout(x);let a=setTimeout(()=>{r(!1)},600);y(a)}w(a)},[v.search,x]),A=(0,d.useCallback)(async()=>{if(!a||!t)return{products:[],count:0};try{return await (0,i.getProductsAction)({userId:a,businessId:t.id,page:k,pageSize:m,search:v.search,category:"all"===v.category?void 0:v.category,stockStatus:v.stockStatus})}catch(a){return console.error("Error loading products from server action:",a),{products:[],count:0}}},[a,t?.id,k,m,v.search,v.category,v.stockStatus]),B=(0,d.useMemo)(()=>["products",a,t?.id],[a,t?.id]),C=(0,d.useMemo)(()=>[...B,k,m,v.search,v.category,v.stockStatus],[B,k,m,v.search,v.category,v.stockStatus]),{data:D,isLoading:E,isFetching:F,refetch:G}=(0,g.useQuery)({queryKey:C,queryFn:A,enabled:!!a&&!!t?.id,staleTime:3e4,gcTime:18e5,refetchOnWindowFocus:!0,refetchOnReconnect:!0});(0,d.useEffect)(()=>{D&&(j(D.products),p(D.count))},[D]);let H=E&&!D&&!q,I=async b=>{try{if(!a)return null;return console.warn("Image upload redirecting to server action (TODO)"),null}catch(a){return console.error("Error in uploadProductImage:",a),null}},J=async b=>{try{if(!a||!t)return null;let c=await (0,i.createProductAction)({...b,userId:a,businessId:t.id});if(!c)return null;return j(a=>[c,...a]),p(a=>a+1),u.invalidateQueries({queryKey:B}),(0,h.clearInventoryCaches)(u),c}catch(a){return console.error("Error creating product:",a),null}},K=async(b,c,d,e=!1,f,g,j,k)=>{try{if(!a||!t)return!1;let g=c.imageUrl;if(d&&(g=await I(d)),!await (0,i.updateProductAction)(b,{...c,imageUrl:g,userId:a,businessId:t.id,isFromSale:e,customChangeReason:f,referenceId:j}))return!1;return u.invalidateQueries({queryKey:B}),(0,h.clearInventoryCaches)(u),!0}catch(a){return console.error("Error updating product:",a),!1}},L=async b=>{try{if(!a)return!1;if(await (0,i.deleteProductAction)(b))return u.invalidateQueries({queryKey:B}),(0,h.clearInventoryCaches)(u),!0;return!1}catch(a){return console.error("Error deleting product:",a),!1}},M=async(b,c,d,e,f,g)=>{try{if(!a||!t)return!1;let c=await (0,i.updateProductsBulkAction)(b.map(a=>({id:a.id,updated:a.updated})),t.id);return c&&(u.invalidateQueries({queryKey:B}),(0,h.clearInventoryCaches)(u)),c}catch(a){return console.error("Error in bulk update:",a),!1}};return{products:c,isLoading:H,loadProducts:A,page:k,setPage:l,pageSize:m,setPageSize:n,totalCount:o,createProduct:J,updateProduct:K,updateProductsBulk:M,deleteProduct:L,uploadProductImage:I,refetch:G,isFetching:F,filters:v,setFilters:z}}]),c()}catch(a){c(a)}},!1),199105,a=>a.a(async(b,c)=>{try{var d=a.i(150848),e=b([d]);async function f(a){try{return await d.db.activityHistory.create({data:{userId:a.userId,locationId:a.locationId,activityType:a.activityType,module:a.module,entityType:a.entityType,entityId:a.entityId||null,entityName:a.entityName,description:a.description,metadata:a.metadata||null,profileId:a.profileId||null,profileName:a.profileName||null}}),{success:!0}}catch(a){return console.error("Error logging activity:",a),{success:!1,error:a.message}}}async function g(a,b,c=1,e=20,f){try{let g={locationId:a,userId:b};if(f&&(f.activityType&&"ALL"!==f.activityType&&(g.activityType=f.activityType),f.module&&"ALL"!==f.module&&(g.module=f.module),f.search&&(g.OR=[{entityName:{contains:f.search,mode:"insensitive"}},{description:{contains:f.search,mode:"insensitive"}}]),f.dateFrom||f.dateTo)&&(g.createdAt={},f.dateFrom&&(g.createdAt.gte=new Date(f.dateFrom)),f.dateTo)){let a=new Date(f.dateTo);a.setHours(23,59,59,999),g.createdAt.lte=a}let[h,i]=await Promise.all([d.db.activityHistory.findMany({where:g,skip:(c-1)*e,take:e,orderBy:{createdAt:"desc"}}),d.db.activityHistory.count({where:g})]);return{success:!0,data:{activities:h.map(a=>({...a,created_at:a.createdAt.toISOString(),activity_type:a.activityType,location_id:a.locationId,user_id:a.userId,entity_type:a.entityType,entity_id:a.entityId,entity_name:a.entityName,profile_id:a.profileId,profile_name:a.profileName})),count:i}}}catch(a){return console.error("Error fetching activity history:",a),{success:!1,error:a.message}}}[d]=e.then?(await e)():e,a.s(["getActivityHistoryAction",()=>g,"logActivityAction",()=>f]),c()}catch(a){c(a)}},!1),411418,a=>a.a(async(b,c)=>{try{var d=a.i(531811),e=b([d]);[d]=e.then?(await e)():e,a.s(["useCurrentUser",0,()=>{let{user:a}=(0,d.useAuth)();return{userId:a?.id}}]),c()}catch(a){c(a)}},!1),778856,a=>{"use strict";let b=(0,a.i(564375).default)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);a.s(["Wallet",()=>b],778856)},837692,a=>{"use strict";var b=a.i(150769),c=a.i(665376);function d(a,d,e){let[f,g]=(0,b.normalizeDates)(e?.in,a,d);return+(0,c.startOfDay)(f)==+(0,c.startOfDay)(g)}a.s(["isSameDay",()=>d])},304050,a=>{"use strict";var b=a.i(873492);function c(a,c){let d=(0,b.toDate)(a,c?.in),e=d.getFullYear();return d.setFullYear(e+1,0,0),d.setHours(23,59,59,999),d}a.s(["endOfYear",()=>c])},671693,a=>{"use strict";var b=a.i(340151);function c(a,c,d){return(0,b.addWeeks)(a,-c,d)}a.s(["subWeeks",()=>c])},284177,a=>{"use strict";var b=a.i(809694);function c(a,c,d){return(0,b.addDays)(a,-c,d)}a.s(["subDays",()=>c])},178465,a=>{"use strict";var b=a.i(873492);function c(a,c){let d=(0,b.toDate)(a,c?.in),e=d.getMonth();return d.setFullYear(d.getFullYear(),e+1,0),d.setHours(23,59,59,999),d}a.s(["endOfMonth",()=>c])},128069,a=>{"use strict";var b=a.i(873492);function c(a,c){let d=(0,b.toDate)(a,c?.in);return d.setHours(23,59,59,999),d}a.s(["endOfDay",()=>c])},126554,a=>{"use strict";var b=a.i(226707),c=a.i(873492);function d(a,d){let e=(0,b.getDefaultOptions)(),f=d?.weekStartsOn??d?.locale?.options?.weekStartsOn??e.weekStartsOn??e.locale?.options?.weekStartsOn??0,g=(0,c.toDate)(a,d?.in),h=g.getDay();return g.setDate(g.getDate()+((h<f?-7:0)+6-(h-f))),g.setHours(23,59,59,999),g}a.s(["endOfWeek",()=>d])},759447,a=>{"use strict";var b=a.i(873492);function c(a,c){let d=(0,b.toDate)(a,c?.in);return d.setDate(1),d.setHours(0,0,0,0),d}a.s(["startOfMonth",()=>c])},671117,a=>a.a(async(b,c)=>{try{let b=await a.y("@radix-ui/react-tabs-b68482203efb9b9e");a.n(b),c()}catch(a){c(a)}},!0),148608,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(671117),g=a.i(799856),h=b([f,g]);[f,g]=h.then?(await h)():h;let i=f.Root,j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.List,{ref:c,className:(0,g.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...b}));j.displayName=f.List.displayName;let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.Trigger,{ref:c,className:(0,g.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...b}));k.displayName=f.Trigger.displayName;let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.Content,{ref:c,className:(0,g.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...b}));l.displayName=f.Content.displayName,a.s(["Tabs",()=>i,"TabsContent",()=>l,"TabsList",()=>j,"TabsTrigger",()=>k]),c()}catch(a){c(a)}},!1),809694,a=>{"use strict";var b=a.i(490988),c=a.i(873492);function d(a,d,e){let f=(0,c.toDate)(a,e?.in);return isNaN(d)?(0,b.constructFrom)(e?.in||a,NaN):(d&&f.setDate(f.getDate()+d),f)}a.s(["addDays",()=>d])},445475,a=>{"use strict";var b=a.i(490988),c=a.i(873492);function d(a,d,e){let f=(0,c.toDate)(a,e?.in);if(isNaN(d))return(0,b.constructFrom)(e?.in||a,NaN);if(!d)return f;let g=f.getDate(),h=(0,b.constructFrom)(e?.in||a,f.getTime());return(h.setMonth(f.getMonth()+d+1,0),g>=h.getDate())?h:(f.setFullYear(h.getFullYear(),h.getMonth(),g),f)}a.s(["addMonths",()=>d])},460716,a=>{"use strict";var b=a.i(445475);function c(a,c,d){return(0,b.addMonths)(a,-c,d)}a.s(["subMonths",()=>c])},340151,a=>{"use strict";var b=a.i(809694);function c(a,c,d){return(0,b.addDays)(a,7*c,d)}a.s(["addWeeks",()=>c])},718192,a=>{"use strict";let b=(0,a.i(564375).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);a.s(["MoreHorizontal",()=>b],718192)},42720,a=>a.a(async(b,c)=>{try{let b=await a.y("@radix-ui/react-alert-dialog-c4990a6b721eb22e");a.n(b),c()}catch(a){c(a)}},!0),893759,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(42720),g=a.i(799856),h=a.i(396465),i=b([f,g,h]);[f,g,h]=i.then?(await i)():i;let j=f.Root,k=f.Trigger,l=f.Portal,m=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.Overlay,{className:(0,g.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b,ref:c}));m.displayName=f.Overlay.displayName;let n=e.forwardRef(({className:a,...b},c)=>(0,d.jsxs)(l,{children:[(0,d.jsx)(m,{}),(0,d.jsx)(f.Content,{ref:c,className:(0,g.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...b})]}));n.displayName=f.Content.displayName;let o=({className:a,...b})=>(0,d.jsx)("div",{className:(0,g.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...b});o.displayName="AlertDialogHeader";let p=({className:a,...b})=>(0,d.jsx)("div",{className:(0,g.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...b});p.displayName="AlertDialogFooter";let q=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.Title,{ref:c,className:(0,g.cn)("text-lg font-semibold",a),...b}));q.displayName=f.Title.displayName;let r=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.Description,{ref:c,className:(0,g.cn)("text-sm text-muted-foreground",a),...b}));r.displayName=f.Description.displayName;let s=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.Action,{ref:c,className:(0,g.cn)((0,h.buttonVariants)(),a),...b}));s.displayName=f.Action.displayName;let t=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.Cancel,{ref:c,className:(0,g.cn)((0,h.buttonVariants)({variant:"outline"}),"mt-2 sm:mt-0",a),...b}));t.displayName=f.Cancel.displayName,a.s(["AlertDialog",()=>j,"AlertDialogAction",()=>s,"AlertDialogCancel",()=>t,"AlertDialogContent",()=>n,"AlertDialogDescription",()=>r,"AlertDialogFooter",()=>p,"AlertDialogHeader",()=>o,"AlertDialogTitle",()=>q,"AlertDialogTrigger",()=>k]),c()}catch(a){c(a)}},!1),257257,a=>{"use strict";var b=a.i(665376),c=a.i(128069),d=a.i(122460),e=a.i(126554),f=a.i(759447),g=a.i(178465),h=a.i(385674),i=a.i(304050),j=a.i(284177),k=a.i(671693),l=a.i(460716);a.s(["getDateRangeFromFilter",0,a=>{let m=new Date,n=(0,b.startOfDay)(m);switch(a){case"today":return{from:n,to:(0,c.endOfDay)(m)};case"yesterday":let o=(0,j.subDays)(n,1);return{from:o,to:(0,c.endOfDay)(o)};case"this-week":return{from:(0,d.startOfWeek)(m),to:(0,e.endOfWeek)(m)};case"last-week":let p=(0,d.startOfWeek)((0,k.subWeeks)(m,1));return{from:p,to:(0,e.endOfWeek)(p)};case"this-month":return{from:(0,f.startOfMonth)(m),to:(0,g.endOfMonth)(m)};case"last-month":let q=(0,f.startOfMonth)((0,l.subMonths)(m,1));return{from:q,to:(0,g.endOfMonth)(q)};case"this-year":return{from:(0,h.startOfYear)(m),to:(0,i.endOfYear)(m)};default:return{from:new Date(2e3,0,1),to:(0,c.endOfDay)(m)}}},"isDateInRange",0,(a,b,c)=>!b&&!c||(b?c?a>=b&&a<=c:a>=b:a<=c)])},942348,a=>a.a(async(b,c)=>{try{var d=a.i(150848),e=a.i(348287),f=b([d]);async function g(a,b){try{let c={locationId:a};b&&(c.productId=b);let e=await d.db.productHistory.findMany({where:c,include:{product:{select:{name:!0,costPrice:!0,sellingPrice:!0,sku:!0}}},orderBy:[{createdAt:"desc"},{id:"desc"}]});return{success:!0,data:e.map(a=>({id:a.id,productId:a.productId,oldQuantity:a.previousQuantity,newQuantity:a.newQuantity,changeReason:a.changeReason,createdAt:a.createdAt.toISOString(),referenceId:a.referenceId,receiptNumber:a.receiptNumber,product:a.product?{name:a.product.name,costPrice:a.product.costPrice,sellingPrice:a.product.sellingPrice,itemNumber:a.product.sku}:void 0}))}}catch(a){return console.error("Error fetching stock history:",a),{success:!1,error:a.message}}}async function h(a){try{let b=await d.db.$transaction(async b=>{let c=await b.productHistory.create({data:{userId:a.userId,locationId:a.locationId,productId:a.productId,previousQuantity:a.previousQuantity,newQuantity:a.newQuantity,changeReason:a.changeReason,referenceId:a.referenceId||null,receiptNumber:a.receiptNumber||null,createdAt:a.createdAt?new Date(a.createdAt):void 0}});return await b.product.update({where:{id:a.productId},data:{stock:a.newQuantity}}),c});return(0,e.revalidatePath)("/inventory"),{success:!0,data:b}}catch(a){return console.error("Error creating stock history:",a),{success:!1,error:a.message}}}async function i(a,b){try{let c=await d.db.$transaction(async c=>{let d=await c.productHistory.findMany({where:{productId:a,locationId:b},orderBy:[{createdAt:"asc"},{id:"asc"}]});if(0===d.length)return{finalQuantity:0};let e=0,f=[];for(let a of d){let b=a.newQuantity-a.previousQuantity,d=e,g=d+b;(a.previousQuantity!==d||a.newQuantity!==g)&&f.push(c.productHistory.update({where:{id:a.id},data:{previousQuantity:d,newQuantity:g}})),e=g}return f.length>0&&await Promise.all(f),await c.product.update({where:{id:a},data:{stock:e}}),{finalQuantity:e}});return(0,e.revalidatePath)("/inventory"),{success:!0,data:c}}catch(a){return console.error("Error recalculating stock chain:",a),{success:!1,error:a.message}}}async function j(a,b){try{let c=await d.db.$transaction(async c=>{let d=await c.productHistory.findMany({where:{referenceId:a,locationId:b},select:{productId:!0}}),e=[...new Set(d.map(a=>a.productId))];for(let d of(await c.productHistory.deleteMany({where:{referenceId:a,locationId:b}}),e))await l(c,d,b);return{affectedProducts:e.length}});return(0,e.revalidatePath)("/inventory"),{success:!0,data:c}}catch(a){return console.error("Error deleting stock history by reference:",a),{success:!1,error:a.message}}}async function k(a,b,c){try{let f=await d.db.productHistory.updateMany({where:{referenceId:a,locationId:b},data:{createdAt:new Date(c)}});return(0,e.revalidatePath)("/inventory"),{success:!0,data:f}}catch(a){return console.error("Error updating stock history dates:",a),{success:!1,error:a.message}}}async function l(a,b,c){let d=await a.productHistory.findMany({where:{productId:b,locationId:c},orderBy:[{createdAt:"asc"},{id:"asc"}]}),e=0;for(let b of d){let c=b.newQuantity-b.previousQuantity,d=e,f=d+c;(b.previousQuantity!==d||b.newQuantity!==f)&&await a.productHistory.update({where:{id:b.id},data:{previousQuantity:d,newQuantity:f}}),e=f}await a.product.update({where:{id:b},data:{stock:e}})}async function m(a,b){try{let c=await d.db.requisition.findMany({where:{userId:a,locationId:b},orderBy:{createdAt:"desc"}});return{success:!0,data:c.map(a=>({id:a.id,userId:a.userId,locationId:a.branchId,requisitionNumber:a.requisitionNumber,title:a.title||"",items:a.items||[],notes:a.notes,status:a.status,createdAt:a.createdAt.toISOString(),updatedAt:a.updatedAt.toISOString()}))}}catch(a){return console.error("Error fetching requisitions:",a),{success:!1,error:a.message}}}async function n(a){try{let b=await d.db.requisition.create({data:{userId:a.userId,branchId:a.locationId,requisitionNumber:a.requisitionNumber,title:a.title,items:a.items,notes:a.notes,status:a.status||"draft"}});return(0,e.revalidatePath)("/requisitions"),{success:!0,data:{id:b.id,userId:b.userId,locationId:b.branchId,requisitionNumber:b.requisitionNumber,title:b.title||"",items:b.items||[],notes:b.notes,status:b.status,createdAt:b.createdAt.toISOString(),updatedAt:b.updatedAt.toISOString()}}}catch(a){return console.error("Error creating requisition:",a),{success:!1,error:a.message}}}async function o(a,b,c){try{let f=await d.db.requisition.update({where:{id:a,userId:b},data:{title:c.title,items:c.items,notes:c.notes,status:c.status,updatedAt:new Date}});return(0,e.revalidatePath)("/requisitions"),{success:!0,data:{id:f.id,userId:f.userId,locationId:f.branchId,requisitionNumber:f.requisitionNumber,title:f.title||"",items:f.items||[],notes:f.notes,status:f.status,createdAt:f.createdAt.toISOString(),updatedAt:f.updatedAt.toISOString()}}}catch(a){return console.error("Error updating requisition:",a),{success:!1,error:a.message}}}async function p(a,b){try{return await d.db.requisition.delete({where:{id:a,userId:b}}),(0,e.revalidatePath)("/requisitions"),{success:!0}}catch(a){return console.error("Error deleting requisition:",a),{success:!1,error:a.message}}}async function q(a,b,c){try{let e=new Date(b),f=new Date(c),g=await d.db.product.findMany({where:{branchId:a},include:{category:!0}}),h=await Promise.all(g.map(async b=>{let c=await d.db.productHistory.findMany({where:{productId:b.id,locationId:a,createdAt:{gte:e,lte:f}},orderBy:{createdAt:"asc"}}),g=0,h=0,i=0,j=0;c.forEach(a=>{let b=a.newQuantity-a.previousQuantity;"SALE"===a.changeReason?g+=Math.abs(b):"STOCK_IN"===a.changeReason||"RESTOCK"===a.changeReason?h+=b:b>0?i+=b:j+=Math.abs(b)});let k=await d.db.productHistory.findFirst({where:{productId:b.id,locationId:a,createdAt:{lte:f}},orderBy:{createdAt:"desc"}}),l=k?k.newQuantity:0,m=l-(h+i-g-j);return{productId:b.id,productName:b.name,itemNumber:b.sku||b.id,imageUrl:b.imageUrl,costPrice:Number(b.costPrice),sellingPrice:Number(b.sellingPrice),category:b.category?.name,openingStock:m,itemsSold:g,stockIn:h,transferOut:0,returnIn:0,returnOut:0,adjustmentsIn:i,adjustmentsOut:j,closingStock:l,revaluation:l*Number(b.costPrice)}}));return{success:!0,data:h}}catch(a){return console.error("Error generating stock summary report:",a),{success:!1,error:a.message}}}async function r(a,b){try{let c=await d.db.product.findUnique({where:{id:b},include:{category:!0}});if(!c)return{success:!1,error:"Product not found"};let e=await d.db.productHistory.findMany({where:{productId:b,locationId:a},orderBy:[{createdAt:"asc"},{id:"asc"}]}),f=await d.db.sale.findMany({where:{branchId:a},orderBy:{date:"asc"}}),g=e.length>0?e[0].newStock:0,h=e.length>0?e[0].createdAt:null,i=new Map,j=0;f.forEach(a=>{let c=(a.items||[]).filter(a=>a.productId===b).reduce((a,b)=>a+(Number(b.quantity)||0),0);if(c>0)if(h&&a.date<h)j+=c;else{let b=a.date.toISOString().split("T")[0],d=i.get(b)||{itemsSold:0,stockAdded:0,transferOut:0,returnIn:0,returnOut:0,adjustments:0};d.itemsSold+=c,i.set(b,d)}}),e.slice(1).forEach(a=>{let b=a.createdAt.toISOString().split("T")[0],c=a.newStock-a.oldStock,d=(a.changeReason||"").toLowerCase(),e=i.get(b)||{itemsSold:0,stockAdded:0,transferOut:0,returnIn:0,returnOut:0,adjustments:0};"RESTOCK"===a.type||d.includes("purchase")||d.includes("addition")?e.stockAdded+=c:d.includes("transfer out")?e.transferOut+=Math.abs(c):d.includes("customer return")?e.returnIn+=c:d.includes("return to supplier")?e.returnOut+=Math.abs(c):"SALE"!==a.type&&(e.adjustments+=c),i.set(b,e)});let k=Array.from(i.keys()).sort(),l=[],m=g;for(let a of k){let b=i.get(a),c=m,d=c-b.itemsSold+b.stockAdded-b.transferOut+b.returnIn-b.returnOut+b.adjustments;l.push({date:a,startingStock:c,...b,endingStock:d}),m=d}return{success:!0,data:{product:{id:c.id,name:c.name,quantity:c.stock,itemNumber:c.sku},currentStock:c.stock,calculatedStock:m,discrepancy:c.stock-m,openingStock:g,openingDate:h?.toISOString(),excludedSalesQty:j,dailyBreakdown:l}}}catch(a){return console.error("Error in reconciliation action:",a),{success:!1,error:a.message}}}async function s(a){try{let b=await d.db.product.findMany({where:{branchId:a},select:{id:!0,name:!0,stock:!0}}),c=[];for(let e of b){let b=await d.db.productHistory.findMany({where:{productId:e.id,locationId:a},orderBy:[{createdAt:"asc"},{id:"asc"}]});if(0===b.length)continue;let f=0,g=[];for(let a of b){let b=a.newStock-a.oldStock,c=f,d=c+b;(a.oldStock!==c||a.newStock!==d)&&g.push({entryId:a.id,createdAt:a.createdAt.toISOString(),changeReason:a.changeReason,currentPrevQty:a.oldStock,currentNewQty:a.newStock,fixedPrevQty:c,fixedNewQty:d}),f=d}(g.length>0||Math.abs(e.stock-f)>.001)&&c.push({productId:e.id,productName:e.name,totalEntries:b.length,brokenEntries:g,finalFixedQty:f,currentProductQty:e.stock})}return{success:!0,data:c}}catch(a){return{success:!1,error:a.message}}}async function t(a,b){try{let c=b||(await d.db.product.findMany({where:{branchId:a},select:{id:!0}})).map(a=>a.id),e=0,f=0;for(let b of c)try{await i(b,a),e++}catch(a){f++}return{success:!0,data:{repaired:e,failed:f}}}catch(a){return{success:!1,error:a.message}}}async function u(a){try{let b=await d.db.activityHistory.findMany({where:{entityId:{in:a}},select:{entityId:!0,entityName:!0}});return{success:!0,data:b}}catch(a){return{success:!1,error:a.message,data:[]}}}async function v(a,b){try{return await d.db.productHistory.updateMany({where:{id:{in:a}},data:{createdAt:new Date(b)}}),{success:!0}}catch(a){return{success:!1,error:a.message}}}[d]=f.then?(await f)():f,a.s(["createRequisitionAction",()=>n,"createStockHistoryAction",()=>h,"deleteRequisitionAction",()=>p,"deleteStockHistoryEntriesByReferenceAction",()=>j,"getActivityByEntityIdsAction",()=>u,"getProductReconciliationAction",()=>r,"getRequisitionsAction",()=>m,"getStockHistoryAction",()=>g,"getStockRepairsPreviewAction",()=>s,"getStockSummaryReportAction",()=>q,"recalculateStockChainAction",()=>i,"repairStockChainsAction",()=>t,"updateRequisitionAction",()=>o,"updateStockHistoryDatesAction",()=>v,"updateStockHistoryDatesByReferenceAction",()=>k]),c()}catch(a){c(a)}},!1),834122,a=>a.a(async(b,c)=>{try{var d=a.i(531811),e=a.i(964889),f=a.i(500885),g=a.i(942348),h=b([d,e,f,g]);[d,e,f,g]=h.then?(await h)():h,a.s(["useStockSummaryData",0,a=>{let{user:b}=(0,d.useAuth)(),{currentBusiness:c}=(0,e.useBusiness)(),h=(0,f.useQueryClient)(),i=async()=>{if(!b?.id||!c?.id||!a?.from||!a?.to)return[];try{let b=await (0,g.getStockSummaryReportAction)(c.id,a.from.toISOString(),a.to.toISOString());if(b.success&&b.data)return b.data;throw Error(b.error)}catch(a){throw console.error("[StockSummary] Error fetching report:",a.message),a}},{data:j=[],isLoading:k,refetch:l}=(0,f.useQuery)({queryKey:["stockSummary",c?.id,a.from?.toISOString(),a.to?.toISOString()],queryFn:i,enabled:!!b?.id&&!!c?.id&&!!a?.from&&!!a?.to,staleTime:3e5,gcTime:18e5});return{stockSummaryData:j,isLoading:k,loadStockSummaryData:l,clearCache:()=>{h.invalidateQueries({queryKey:["stockSummary"]})},clearAllLocationCaches:()=>{h.invalidateQueries({queryKey:["stockSummary"]})}}}]),c()}catch(a){c(a)}},!1),38735,a=>a.a(async(b,c)=>{try{var d=a.i(150848),e=b([d]);async function f(a){try{let b=await d.db.carriageInward.findMany({where:{branchId:a},orderBy:[{date:"desc"},{createdAt:"desc"}]});return{success:!0,data:b.map(a=>({id:a.id,userId:a.userId,locationId:a.branchId,supplierName:a.supplierName,details:a.details,amount:Number(a.amount),date:a.date.toISOString(),cashAccountId:a.cashAccountId,cashTransactionId:a.cashTransactionId,createdAt:a.createdAt.toISOString(),updatedAt:a.updatedAt.toISOString()}))}}catch(a){return{success:!1,error:a.message}}}async function g(a,b,c){try{let e=await d.db.carriageInward.create({data:{userId:a,branchId:b,supplierName:c.supplierName,details:c.details,amount:c.amount,date:c.date,cashAccountId:c.cashAccountId||null}});return{success:!0,data:e}}catch(a){return{success:!1,error:a.message}}}async function h(a,b,c){try{let e={};return void 0!==c.supplierName&&(e.supplierName=c.supplierName),void 0!==c.details&&(e.details=c.details),void 0!==c.amount&&(e.amount=c.amount),void 0!==c.date&&(e.date=c.date),await d.db.carriageInward.update({where:{id:a,branchId:b},data:e}),{success:!0}}catch(a){return{success:!1,error:a.message}}}async function i(a,b){try{return await d.db.carriageInward.delete({where:{id:a,branchId:b}}),{success:!0}}catch(a){return{success:!1,error:a.message}}}[d]=e.then?(await e)():e,a.s(["createCarriageInwardAction",()=>g,"deleteCarriageInwardAction",()=>i,"getCarriageInwardsAction",()=>f,"updateCarriageInwardAction",()=>h]),c()}catch(a){c(a)}},!1),751184,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(531811),f=a.i(964889),g=a.i(108191),h=a.i(38735),i=b([e,f,h]);[e,f,h]=i.then?(await i)():i,a.s(["useCarriageInwards",0,()=>{let[a,b]=(0,d.useState)([]),[c,i]=(0,d.useState)(!1),{user:j}=(0,e.useAuth)(),{currentBusiness:k}=(0,f.useBusiness)(),{toast:l}=(0,g.useToast)(),m=(0,d.useCallback)(async()=>{if(!j||!k){b([]),i(!1);return}i(!0);try{let a=await (0,h.getCarriageInwardsAction)(k.id);if(!a.success)throw Error(a.error);b((a.data||[]).map(a=>({...a,date:new Date(a.date),createdAt:new Date(a.createdAt),updatedAt:new Date(a.updatedAt)})))}catch(a){console.error("Error loading carriage inwards:",a),l({title:"Error",description:"Failed to load carriage inwards records.",variant:"destructive"})}finally{i(!1)}},[j,k?.id,l]),n=async a=>{if(!j||!k)throw Error("User not authenticated or no business selected");let b=await (0,h.createCarriageInwardAction)(j.id,k.id,a);if(!b.success)throw Error(b.error);return await m(),l({title:"Success",description:"Carriage inwards record created successfully"}),b.data},o=async(a,b)=>{if(!k)throw Error("No business selected");let c=await (0,h.updateCarriageInwardAction)(a,k.id,b);if(!c.success)throw Error(c.error);return await m(),l({title:"Success",description:"Carriage inwards record updated successfully"}),!0},p=async a=>{if(!k)throw Error("No business selected");let b=await (0,h.deleteCarriageInwardAction)(a,k.id);if(!b.success)throw Error(b.error);return await m(),l({title:"Success",description:"Carriage inwards record deleted successfully"}),!0};return(0,d.useEffect)(()=>{m()},[m]),{carriageInwards:a,isLoading:c,createCarriageInward:n,updateCarriageInward:o,deleteCarriageInward:p,refreshCarriageInwards:m}}]),c()}catch(a){c(a)}},!1),924049,a=>{"use strict";let b=(0,a.i(564375).default)("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);a.s(["ArrowUpRight",()=>b],924049)},96144,a=>{"use strict";let b=(0,a.i(564375).default)("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);a.s(["ArrowDownRight",()=>b],96144)},297082,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(86352),g=a.i(109254),h=a.i(396465),i=a.i(112779),j=a.i(397625),k=a.i(330281),l=a.i(459502),m=a.i(224993),n=b([f,g,h,i,j,k,l,m]);[f,g,h,i,j,k,l,m]=n.then?(await n)():n,a.s(["default",0,({open:a,onOpenChange:b,onSubmit:c,title:n,initialData:o,isSubmitting:p=!1})=>{let{settings:q}=(0,m.useBusinessSettings)(),{register:r,handleSubmit:s,formState:{errors:t},reset:u,watch:v,setValue:w}=(0,f.useForm)({defaultValues:{name:"",description:"",isDefault:!1,...o}});e.default.useEffect(()=>{a&&o?u({name:o.name||"",description:o.description||"",openingBalance:o.openingBalance||0,isDefault:o.isDefault||!1}):a&&u({name:"",description:"",openingBalance:void 0,isDefault:!1})},[a,o,u]);let x=v("isDefault"),y=q.currency||"UGX";return(0,d.jsx)(g.Dialog,{open:a,onOpenChange:b,children:(0,d.jsxs)(g.DialogContent,{className:"sm:max-w-[425px]",children:[(0,d.jsx)(g.DialogHeader,{children:(0,d.jsx)(g.DialogTitle,{children:n})}),(0,d.jsxs)("form",{onSubmit:s(a=>{c(a)}),className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(j.Label,{htmlFor:"name",children:"Account Name"}),(0,d.jsx)(i.Input,{id:"name",...r("name",{required:"Account name is required"}),placeholder:"e.g., Main Cash, Petty Cash",disabled:p}),t.name&&(0,d.jsx)("p",{className:"text-sm text-red-600",children:t.name.message})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(j.Label,{htmlFor:"description",children:"Description (Optional)"}),(0,d.jsx)(k.Textarea,{id:"description",...r("description"),placeholder:"Brief description of this account",rows:3,disabled:p})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)(j.Label,{htmlFor:"openingBalance",children:["Opening Balance (",y,")"]}),(0,d.jsx)(i.Input,{id:"openingBalance",type:"number",step:"0.01",...r("openingBalance",{required:"Opening balance is required",min:{value:0,message:"Opening balance cannot be negative"}}),placeholder:"0.00",disabled:p}),t.openingBalance&&(0,d.jsx)("p",{className:"text-sm text-red-600",children:t.openingBalance.message})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)(l.Checkbox,{id:"isDefault",checked:x,onCheckedChange:a=>w("isDefault",a),disabled:p}),(0,d.jsx)(j.Label,{htmlFor:"isDefault",className:"text-sm",children:"Set as default account"})]}),(0,d.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,d.jsx)(h.Button,{type:"button",variant:"outline",onClick:()=>b(!1),disabled:p,children:"Cancel"}),(0,d.jsx)(h.Button,{type:"submit",disabled:p,children:p?o?"Updating...":"Creating...":o?"Update Account":"Create Account"})]})]})]})})}]),c()}catch(a){c(a)}},!1),180852,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(688272),f=a.i(396465),g=a.i(914619),h=a.i(158799),i=a.i(393551),j=a.i(792071),k=b([e,f,h,i]);[e,f,h,i]=k.then?(await k)():k,a.s(["default",0,({dateFilter:a,dateRange:b,specificDate:c,isCustomRange:k,isSpecificDate:l=!1,onDateFilterChange:m,onDateRangeChange:n,onSpecificDateChange:o})=>(0,d.jsxs)("div",{className:"flex gap-4 items-center flex-wrap mb-4",onClick:a=>{a.stopPropagation()},children:[(0,d.jsx)("div",{className:"w-[240px] relative",children:(0,d.jsxs)(e.Select,{value:a,onValueChange:m,children:[(0,d.jsx)(e.SelectTrigger,{className:"bg-white shadow-sm",children:(0,d.jsx)(e.SelectValue,{placeholder:"Select date range"})}),(0,d.jsxs)(e.SelectContent,{className:"z-[9999] bg-white shadow-lg border border-border/50",children:[(0,d.jsx)(e.SelectItem,{value:"today",children:"Today"}),(0,d.jsx)(e.SelectItem,{value:"yesterday",children:"Yesterday"}),(0,d.jsx)(e.SelectItem,{value:"this-week",children:"This Week"}),(0,d.jsx)(e.SelectItem,{value:"last-week",children:"Last Week"}),(0,d.jsx)(e.SelectItem,{value:"this-month",children:"This Month"}),(0,d.jsx)(e.SelectItem,{value:"last-month",children:"Last Month"}),(0,d.jsx)(e.SelectItem,{value:"this-year",children:"This Year"}),(0,d.jsx)(e.SelectItem,{value:"all",children:"All Time"}),(0,d.jsx)(e.SelectItem,{value:"specific",children:"Specific Date"}),(0,d.jsx)(e.SelectItem,{value:"custom",children:"Custom Range"})]})]})}),l&&o&&(0,d.jsx)("div",{className:"flex items-center",children:(0,d.jsxs)(h.Popover,{children:[(0,d.jsx)(h.PopoverTrigger,{asChild:!0,children:(0,d.jsxs)(f.Button,{variant:"outline",className:"bg-white flex items-center gap-2 h-10 pl-3 text-left font-normal",children:[(0,d.jsx)(g.Calendar,{className:"h-4 w-4"}),(0,d.jsx)("span",{children:c?(0,j.format)(c,"MMM d, yyyy"):"Select Date"})]})}),(0,d.jsx)(h.PopoverContent,{className:"w-auto p-0 z-[9999] bg-white shadow-lg",align:"start",children:(0,d.jsx)(i.Calendar,{initialFocus:!0,mode:"single",defaultMonth:c,selected:c,onSelect:o,className:"p-3 pointer-events-auto",showOutsideDays:!0})})]})}),k&&(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsxs)(h.Popover,{children:[(0,d.jsx)(h.PopoverTrigger,{asChild:!0,children:(0,d.jsxs)(f.Button,{variant:"outline",className:"bg-white flex items-center gap-2 h-10 pl-3 text-left font-normal",children:[(0,d.jsx)(g.Calendar,{className:"h-4 w-4"}),(0,d.jsx)("span",{children:b.from?(0,j.format)(b.from,"MMM d, yyyy"):"Start Date"})]})}),(0,d.jsx)(h.PopoverContent,{className:"w-auto p-0 z-[9999] bg-white shadow-lg",align:"start",children:(0,d.jsx)(i.Calendar,{initialFocus:!0,mode:"single",defaultMonth:b?.from,selected:b?.from,onSelect:a=>n({...b,from:a}),className:"p-3 pointer-events-auto",showOutsideDays:!0})})]}),(0,d.jsx)("span",{className:"text-muted-foreground",children:"to"}),(0,d.jsxs)(h.Popover,{children:[(0,d.jsx)(h.PopoverTrigger,{asChild:!0,children:(0,d.jsxs)(f.Button,{variant:"outline",className:"bg-white flex items-center gap-2 h-10 pl-3 text-left font-normal",children:[(0,d.jsx)(g.Calendar,{className:"h-4 w-4"}),(0,d.jsx)("span",{children:b.to?(0,j.format)(b.to,"MMM d, yyyy"):"End Date"})]})}),(0,d.jsx)(h.PopoverContent,{className:"w-auto p-0 z-[9999] bg-white shadow-lg",align:"start",children:(0,d.jsx)(i.Calendar,{initialFocus:!0,mode:"single",defaultMonth:b?.to,selected:b?.to,onSelect:a=>n({...b,to:a}),className:"p-3 pointer-events-auto",showOutsideDays:!0})})]})]})]})]),c()}catch(a){c(a)}},!1),529845,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(108191),f=a.i(964889),g=a.i(500885),h=a.i(120343),i=a.i(531811),j=b([f,g,h,i]);[f,g,h,i]=j.then?(await j)():j,a.s(["useExpenses",0,()=>{let[a,b]=(0,d.useState)([]),{toast:c}=(0,e.useToast)(),{currentBusiness:j}=(0,f.useBusiness)(),{user:k}=(0,i.useAuth)(),l=(0,g.useQueryClient)(),m=(0,d.useCallback)(async()=>{if(!j)return[];try{let a=await (0,h.getExpensesAction)(j.id);if(!a.success||!a.data)throw Error(a.error||"Failed to fetch expenses");return a.data.map(a=>({id:a.id,amount:Number(a.amount),description:a.description,category:a.category,date:new Date(a.date),paymentMethod:a.paymentMethod,personInCharge:a.personInCharge,receiptImage:a.receiptImage,cashAccountId:a.cashAccountId,cashTransactionId:a.cashTransactionId,createdAt:new Date(a.createdAt),updatedAt:new Date(a.updatedAt)}))}catch(a){return console.error("Error loading expenses:",a),c({title:"Error",description:"Failed to load expenses. Please try again.",variant:"destructive"}),[]}},[j?.id,c]),n=["expenses",j?.id],{data:o,isLoading:p,isFetching:q}=(0,g.useQuery)({queryKey:n,queryFn:m,enabled:!!j?.id,staleTime:3e5,gcTime:18e5,refetchOnWindowFocus:!1,refetchOnReconnect:!1});(0,d.useEffect)(()=>{o&&b(o)},[o]);let r=p&&!o,s=async a=>{if(!j||!k)return void c({title:"Error",description:j?"User not authenticated":"No business selected",variant:"destructive"});try{let d={amount:a.amount,description:a.description,category:a.category,date:a.date,paymentMethod:a.paymentMethod,personInCharge:a.personInCharge,receiptImage:a.receiptImage,cashAccountId:a.cashAccountId,userId:k.id,locationId:j.id},e=await (0,h.createExpenseAction)(d,!!a.linkToCash);if(!e.success||!e.data)throw Error(e.error);let f=e.data,g={id:f.id,amount:Number(f.amount),description:f.description,category:f.category,date:new Date(f.date),paymentMethod:f.paymentMethod,personInCharge:f.personInCharge,receiptImage:f.receiptImage,cashAccountId:f.cashAccountId,cashTransactionId:f.cashTransactionId,createdAt:new Date(f.createdAt),updatedAt:new Date(f.updatedAt)};return b(a=>[g,...a]),l.setQueryData(n,a=>a?[g,...a]:[g]),l.invalidateQueries({queryKey:n}),c({title:"Success",description:"Expense created successfully"}),g}catch(a){console.error("Error creating expense:",a),c({title:"Error",description:"Failed to create expense. Please try again.",variant:"destructive"})}},t=async(b,d)=>{try{let e=a.find(a=>a.id===b);if(!e)throw Error("Expense not found");let f={amount:void 0!==d.amount?d.amount:e.amount,description:void 0!==d.description?d.description:e.description,category:void 0!==d.category?d.category:e.category,date:void 0!==d.date?d.date:e.date,paymentMethod:void 0!==d.paymentMethod?d.paymentMethod:e.paymentMethod,personInCharge:void 0!==d.personInCharge?d.personInCharge:e.personInCharge,receiptImage:void 0!==d.receiptImage?d.receiptImage:e.receiptImage,cashAccountId:d.linkToCash?d.cashAccountId:!1===d.linkToCash?null:e.cashAccountId},g=await (0,h.updateExpenseAction)(b,f,e);if(!g.success)throw Error(g.error);l.invalidateQueries({queryKey:n}),c({title:"Success",description:"Expense updated successfully"})}catch(a){console.error("Error updating expense:",a),c({title:"Error",description:"Failed to update expense. Please try again.",variant:"destructive"})}},u=async a=>{try{let d=await (0,h.deleteExpenseAction)(a);if(!d.success)throw Error(d.error);return b(b=>b.filter(b=>b.id!==a)),l.setQueryData(n,b=>b?b.filter(b=>b.id!==a):b),l.invalidateQueries({queryKey:n}),c({title:"Success",description:"Expense deleted successfully"}),!0}catch(a){return console.error("Error deleting expense:",a),c({title:"Error",description:"Failed to delete expense. Please try again.",variant:"destructive"}),!1}},v=async()=>{l.invalidateQueries({queryKey:n})},w=async a=>{if(!j||!k)return void c({title:"Error",description:j?"User not authenticated":"No business selected",variant:"destructive"});try{let b=[];for(let c of a){let a={amount:c.amount,description:c.description,category:c.category,date:c.date,paymentMethod:c.paymentMethod,personInCharge:c.personInCharge,receiptImage:c.receiptImage,cashAccountId:c.cashAccountId,userId:k.id,locationId:j.id},d=await (0,h.createExpenseAction)(a,!!c.linkToCash);if(d.success&&d.data){let a=d.data;b.push({id:a.id,amount:Number(a.amount),description:a.description,category:a.category,date:new Date(a.date),paymentMethod:a.paymentMethod,personInCharge:a.personInCharge,receiptImage:a.receiptImage,cashAccountId:a.cashAccountId,cashTransactionId:a.cashTransactionId,createdAt:new Date(a.createdAt),updatedAt:new Date(a.updatedAt)})}}return l.invalidateQueries({queryKey:n}),c({title:"Success",description:`Successfully created ${b.length} expenses`}),b}catch(a){throw console.error("Error creating bulk expenses:",a),c({title:"Error",description:"Failed to create bulk expenses. Please try again.",variant:"destructive"}),a}};return{expenses:a,isLoading:r,createExpense:s,createBulkExpenses:w,updateExpense:t,deleteExpense:u,refreshExpenses:v}}]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__cd747ce1._.js.map