module.exports=[47349,(a,b,c)=>{"use strict";var d=a.r(572131);d.useState,d.useEffect,d.useLayoutEffect,d.useDebugValue,c.useSyncExternalStore=void 0!==d.useSyncExternalStore?d.useSyncExternalStore:function(a,b){return b()}},487610,(a,b,c)=>{"use strict";b.exports=a.r(47349)},931852,a=>{"use strict";var b=a.i(187924),c=a.i(454289),d=a.i(937927),e=a.i(357999),f=a.i(665967),g=a.i(391956),h=a.i(169819),i=a.i(890914),j=a.i(572131),k=a.i(770094),l=a.i(811011),m=a.i(400187),n=a.i(170106);let o=(0,n.default)("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);var p=a.i(368114),q=a.i(699570),r=a.i(866718),s=a.i(505084),t=a.i(757061),u=a.i(333140),v=a.i(785259);let w=j.createContext(null);function x(){let a=j.useContext(w);if(!a)throw Error("useSidebar must be used within a SidebarProvider.");return a}let y=j.forwardRef(({defaultOpen:a=!0,open:c,onOpenChange:d,className:e,style:f,children:g,...h},i)=>{let l=(0,k.useIsMobile)(),[m,n]=j.useState(!1),[o,q]=j.useState(a),r=c??o,s=j.useCallback(a=>{let b="function"==typeof a?a(r):a;d?d(b):q(b),document.cookie=`sidebar:state=${b}; path=/; max-age=604800`},[d,r]),t=j.useCallback(()=>l?n(a=>!a):s(a=>!a),[l,s,n]);j.useEffect(()=>{let a=a=>{"b"===a.key&&(a.metaKey||a.ctrlKey)&&(a.preventDefault(),t())};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[t]);let u=r?"expanded":"collapsed",x=j.useMemo(()=>({state:u,open:r,setOpen:s,isMobile:l,openMobile:m,setOpenMobile:n,toggleSidebar:t}),[u,r,s,l,m,n,t]);return(0,b.jsx)(w.Provider,{value:x,children:(0,b.jsx)(v.TooltipProvider,{delayDuration:0,children:(0,b.jsx)("div",{style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...f},className:(0,p.cn)("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",e),ref:i,...h,children:g})})})});y.displayName="SidebarProvider";let z=j.forwardRef(({side:a="left",variant:c="sidebar",collapsible:d="offcanvas",className:e,children:f,...g},h)=>{let{isMobile:i,state:j,openMobile:k,setOpenMobile:l}=x();return"none"===d?(0,b.jsx)("div",{className:(0,p.cn)("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",e),ref:h,...g,children:f}):i?(0,b.jsx)(t.Sheet,{open:k,onOpenChange:l,...g,children:(0,b.jsx)(t.SheetContent,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:a,children:(0,b.jsx)("div",{className:"flex h-full w-full flex-col",children:f})})}):(0,b.jsxs)("div",{ref:h,className:"group peer hidden md:block text-sidebar-foreground","data-state":j,"data-collapsible":"collapsed"===j?d:"","data-variant":c,"data-side":a,children:[(0,b.jsx)("div",{className:(0,p.cn)("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===c||"inset"===c?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),(0,b.jsx)("div",{className:(0,p.cn)("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex","left"===a?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===c||"inset"===c?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",e),...g,children:(0,b.jsx)("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:f})})]})});z.displayName="Sidebar";let A=j.forwardRef(({className:a,onClick:c,...d},e)=>{let{toggleSidebar:f}=x();return(0,b.jsxs)(q.Button,{ref:e,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:(0,p.cn)("h-7 w-7",a),onClick:a=>{c?.(a),f()},...d,children:[(0,b.jsx)(o,{}),(0,b.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]})});A.displayName="SidebarTrigger",j.forwardRef(({className:a,...c},d)=>{let{toggleSidebar:e}=x();return(0,b.jsx)("button",{ref:d,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:e,title:"Toggle Sidebar",className:(0,p.cn)("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",a),...c})}).displayName="SidebarRail",j.forwardRef(({className:a,...c},d)=>(0,b.jsx)("main",{ref:d,className:(0,p.cn)("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",a),...c})).displayName="SidebarInset",j.forwardRef(({className:a,...c},d)=>(0,b.jsx)(r.Input,{ref:d,"data-sidebar":"input",className:(0,p.cn)("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",a),...c})).displayName="SidebarInput",j.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{ref:d,"data-sidebar":"header",className:(0,p.cn)("flex flex-col gap-2 p-2",a),...c})).displayName="SidebarHeader";let B=j.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{ref:d,"data-sidebar":"footer",className:(0,p.cn)("flex flex-col gap-2 p-2",a),...c}));B.displayName="SidebarFooter",j.forwardRef(({className:a,...c},d)=>(0,b.jsx)(s.Separator,{ref:d,"data-sidebar":"separator",className:(0,p.cn)("mx-2 w-auto bg-sidebar-border",a),...c})).displayName="SidebarSeparator";let C=j.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{ref:d,"data-sidebar":"content",className:(0,p.cn)("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",a),...c}));C.displayName="SidebarContent",j.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{ref:d,"data-sidebar":"group",className:(0,p.cn)("relative flex w-full min-w-0 flex-col p-2",a),...c})).displayName="SidebarGroup",j.forwardRef(({className:a,asChild:c=!1,...d},e)=>{let f=c?l.Slot:"div";return(0,b.jsx)(f,{ref:e,"data-sidebar":"group-label",className:(0,p.cn)("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",a),...d})}).displayName="SidebarGroupLabel",j.forwardRef(({className:a,asChild:c=!1,...d},e)=>{let f=c?l.Slot:"button";return(0,b.jsx)(f,{ref:e,"data-sidebar":"group-action",className:(0,p.cn)("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",a),...d})}).displayName="SidebarGroupAction",j.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{ref:d,"data-sidebar":"group-content",className:(0,p.cn)("w-full text-sm",a),...c})).displayName="SidebarGroupContent";let D=j.forwardRef(({className:a,...c},d)=>(0,b.jsx)("ul",{ref:d,"data-sidebar":"menu",className:(0,p.cn)("flex w-full min-w-0 flex-col gap-1",a),...c}));D.displayName="SidebarMenu";let E=j.forwardRef(({className:a,...c},d)=>(0,b.jsx)("li",{ref:d,"data-sidebar":"menu-item",className:(0,p.cn)("group/menu-item relative",a),...c}));E.displayName="SidebarMenuItem";let F=(0,m.cva)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),G=j.forwardRef(({asChild:a=!1,isActive:c=!1,variant:d="default",size:e="default",tooltip:f,className:g,...h},i)=>{let j=a?l.Slot:"button",{isMobile:k,state:m}=x(),n=(0,b.jsx)(j,{ref:i,"data-sidebar":"menu-button","data-size":e,"data-active":c,className:(0,p.cn)(F({variant:d,size:e}),g),...h});return f?("string"==typeof f&&(f={children:f}),(0,b.jsxs)(v.Tooltip,{children:[(0,b.jsx)(v.TooltipTrigger,{asChild:!0,children:n}),(0,b.jsx)(v.TooltipContent,{side:"right",align:"center",hidden:"collapsed"!==m||k,...f})]})):n});G.displayName="SidebarMenuButton",j.forwardRef(({className:a,asChild:c=!1,showOnHover:d=!1,...e},f)=>{let g=c?l.Slot:"button";return(0,b.jsx)(g,{ref:f,"data-sidebar":"menu-action",className:(0,p.cn)("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",d&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",a),...e})}).displayName="SidebarMenuAction",j.forwardRef(({className:a,...c},d)=>(0,b.jsx)("div",{ref:d,"data-sidebar":"menu-badge",className:(0,p.cn)("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",a),...c})).displayName="SidebarMenuBadge",j.forwardRef(({className:a,showIcon:c=!1,...d},e)=>{let f=j.useMemo(()=>`${Math.floor(40*Math.random())+50}%`,[]);return(0,b.jsxs)("div",{ref:e,"data-sidebar":"menu-skeleton",className:(0,p.cn)("rounded-md h-8 flex gap-2 px-2 items-center",a),...d,children:[c&&(0,b.jsx)(u.Skeleton,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),(0,b.jsx)(u.Skeleton,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":f}})]})}).displayName="SidebarMenuSkeleton";let H=j.forwardRef(({className:a,...c},d)=>(0,b.jsx)("ul",{ref:d,"data-sidebar":"menu-sub",className:(0,p.cn)("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",a),...c}));H.displayName="SidebarMenuSub";let I=j.forwardRef(({...a},c)=>(0,b.jsx)("li",{ref:c,...a}));I.displayName="SidebarMenuSubItem";let J=j.forwardRef(({asChild:a=!1,size:c="md",isActive:d,className:e,...f},g)=>{let h=a?l.Slot:"a";return(0,b.jsx)(h,{ref:g,"data-sidebar":"menu-sub-button","data-size":c,"data-active":d,className:(0,p.cn)("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground","sm"===c&&"text-xs","md"===c&&"text-sm","group-data-[collapsible=icon]:hidden",e),...f})});J.displayName="SidebarMenuSubButton";let K=()=>(0,b.jsx)(e.Link,{to:"/",className:"flex items-center",children:(0,b.jsx)("img",{src:"/lovable-uploads/798d07d7-1db7-498c-92f3-6f6346827d59.png",alt:"Gonzo Systems Logo",className:"h-8 md:h-10"})});var L=a.i(220005),M=a.i(321161),N=a.i(267900),O=a.i(669520),P=a.i(335732),Q=a.i(746872),R=a.i(872752);a.i(935112);var S=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,c)=>{let d=(0,l.createSlot)(`Primitive.${c}`),e=j.forwardRef((a,e)=>{let{asChild:f,...g}=a;return(0,b.jsx)(f?d:c,{...g,ref:e})});return e.displayName=`Primitive.${c}`,{...a,[c]:e}},{}),T=a.i(487610);function U(){return()=>{}}var V="Avatar",[W,X]=function(a,c=[]){let d=[],e=()=>{let b=d.map(a=>j.createContext(a));return function(c){let d=c?.[a]||b;return j.useMemo(()=>({[`__scope${a}`]:{...c,[a]:d}}),[c,d])}};return e.scopeName=a,[function(c,e){let f=j.createContext(e);f.displayName=c+"Context";let g=d.length;d=[...d,e];let h=c=>{let{scope:d,children:e,...h}=c,i=d?.[a]?.[g]||f,k=j.useMemo(()=>h,Object.values(h));return(0,b.jsx)(i.Provider,{value:k,children:e})};return h.displayName=c+"Provider",[h,function(b,d){let h=d?.[a]?.[g]||f,i=j.useContext(h);if(i)return i;if(void 0!==e)return e;throw Error(`\`${b}\` must be used within \`${c}\``)}]},function(...a){let b=a[0];if(1===a.length)return b;let c=()=>{let c=a.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){let d=c.reduce((b,{useScope:c,scopeName:d})=>{let e=c(a)[`__scope${d}`];return{...b,...e}},{});return j.useMemo(()=>({[`__scope${b.scopeName}`]:d}),[d])}};return c.scopeName=b.scopeName,c}(e,...c)]}(V),[Y,Z]=W(V),$=j.forwardRef((a,c)=>{let{__scopeAvatar:d,...e}=a,[f,g]=j.useState("idle");return(0,b.jsx)(Y,{scope:d,imageLoadingStatus:f,onImageLoadingStatusChange:g,children:(0,b.jsx)(S.span,{...e,ref:c})})});$.displayName=V;var _="AvatarImage",aa=j.forwardRef((a,c)=>{let{__scopeAvatar:d,src:e,onLoadingStatusChange:f=()=>{},...g}=a,h=Z(_,d),i=function(a,{referrerPolicy:b,crossOrigin:c}){let d=(0,T.useSyncExternalStore)(U,()=>!0,()=>!1),e=j.useRef(null),f=d?(e.current||(e.current=new window.Image),e.current):null,[g,h]=j.useState(()=>ad(f,a));return(0,R.useLayoutEffect)(()=>{h(ad(f,a))},[f,a]),(0,R.useLayoutEffect)(()=>{let a=a=>()=>{h(a)};if(!f)return;let d=a("loaded"),e=a("error");return f.addEventListener("load",d),f.addEventListener("error",e),b&&(f.referrerPolicy=b),"string"==typeof c&&(f.crossOrigin=c),()=>{f.removeEventListener("load",d),f.removeEventListener("error",e)}},[f,c,b]),g}(e,g),k=(0,Q.useCallbackRef)(a=>{f(a),h.onImageLoadingStatusChange(a)});return(0,R.useLayoutEffect)(()=>{"idle"!==i&&k(i)},[i,k]),"loaded"===i?(0,b.jsx)(S.img,{...g,ref:c,src:e}):null});aa.displayName=_;var ab="AvatarFallback",ac=j.forwardRef((a,c)=>{let{__scopeAvatar:d,delayMs:e,...f}=a,g=Z(ab,d),[h,i]=j.useState(void 0===e);return j.useEffect(()=>{if(void 0!==e){let a=window.setTimeout(()=>i(!0),e);return()=>window.clearTimeout(a)}},[e]),h&&"loaded"!==g.imageLoadingStatus?(0,b.jsx)(S.span,{...f,ref:c}):null});function ad(a,b){return a?b?(a.src!==b&&(a.src=b),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}ac.displayName=ab;let ae=j.forwardRef(({className:a,...c},d)=>(0,b.jsx)($,{ref:d,className:(0,p.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...c}));ae.displayName=$.displayName,j.forwardRef(({className:a,...c},d)=>(0,b.jsx)(aa,{ref:d,className:(0,p.cn)("aspect-square h-full w-full",a),...c})).displayName=aa.displayName;let af=j.forwardRef(({className:a,...c},d)=>(0,b.jsx)(ac,{ref:d,className:(0,p.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...c}));af.displayName=ac.displayName;var ag=a.i(533441),ah=a.i(405784),ai=a.i(421234),aj=a.i(175467),ak=a.i(474507);let al=({variant:a="desktop",onItemClick:c})=>{let{currentBusiness:d,businessLocations:e,switchBusiness:f}=(0,h.useBusiness)(),{verifyBusinessPassword:g}=(0,ak.useBusinessPassword)(),[i,k]=(0,j.useState)(!0),[l,m]=(0,j.useState)(!1),[n,o]=(0,j.useState)(null),p=a=>{f(a,(a,b,c)=>{o({businessId:a,businessName:b,onVerified:c}),m(!0)}),n||c?.()},r=()=>{n&&(n.onVerified(),m(!1),o(null),setTimeout(()=>{c?.()},100))},s=async a=>!!n&&await g(n.businessId,a);return"sidebar"===a?e.length<=1?(0,b.jsxs)(G,{className:"w-full text-primary-foreground",disabled:!0,children:[(0,b.jsx)(N.Building2,{className:"size-4"}),(0,b.jsx)("span",{className:"flex-1 text-left truncate group-data-[collapsible=icon]:hidden",children:d?.name||"Business"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(ai.Collapsible,{open:i,onOpenChange:k,children:[(0,b.jsx)(ai.CollapsibleTrigger,{asChild:!0,children:(0,b.jsxs)(G,{className:"w-full text-primary-foreground hover:bg-white/10",children:[(0,b.jsx)(N.Building2,{className:"size-4"}),(0,b.jsx)("span",{className:"flex-1 text-left truncate group-data-[collapsible=icon]:hidden",children:d?.name||"Select Business"}),(0,b.jsx)(ah.ChevronDown,{className:"h-4 w-4 transition-transform data-[state=open]:rotate-180 group-data-[collapsible=icon]:hidden"})]})}),(0,b.jsx)(ai.CollapsibleContent,{children:(0,b.jsx)(H,{className:"bg-primary",children:e.map(a=>(0,b.jsx)(I,{children:(0,b.jsxs)(J,{onClick:()=>p(a.id),isActive:d?.id===a.id,className:"w-full justify-between text-primary-foreground/80 hover:bg-white/10 hover:text-primary-foreground data-[active=true]:bg-secondary data-[active=true]:text-secondary-foreground",children:[(0,b.jsx)("span",{className:"truncate",children:a.name}),d?.id===a.id&&(0,b.jsx)(ag.Check,{className:"h-4 w-4"})]})},a.id))})})]}),n&&(0,b.jsx)(aj.BusinessPasswordDialog,{open:l,onOpenChange:m,businessName:n.businessName,onPasswordVerified:r,onVerifyPassword:s})]}):"mobile"===a?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"px-6 py-4 border-b",children:[(0,b.jsx)("div",{className:"text-sm text-gray-500 mb-2",children:"Current Business"}),(0,b.jsx)("div",{className:"font-medium break-words",children:d?.name||"Loading..."}),(0,b.jsx)("div",{className:"mt-3 space-y-1",children:e.map(a=>(0,b.jsxs)("button",{onClick:()=>p(a.id),className:`w-full text-left px-3 py-2 rounded-md text-sm flex items-center justify-between transition-colors touch-manipulation ${d?.id===a.id?"bg-blue-50 text-blue-600":"hover:bg-gray-50 active:bg-gray-100"}`,type:"button",children:[(0,b.jsxs)("span",{className:"flex items-center gap-2 min-w-0 flex-1",children:[(0,b.jsx)(N.Building2,{className:"h-4 w-4 flex-shrink-0"}),(0,b.jsx)("span",{className:"truncate",children:a.name}),a.is_default&&(0,b.jsx)("span",{className:"text-xs bg-gray-100 px-1 rounded flex-shrink-0",children:"Default"})]}),d?.id===a.id&&(0,b.jsx)(ag.Check,{className:"h-4 w-4 flex-shrink-0"})]},a.id))})]}),n&&(0,b.jsx)(aj.BusinessPasswordDialog,{open:l,onOpenChange:a=>{console.log("Mobile dialog open change:",a),m(a)},businessName:n.businessName,onPasswordVerified:r,onVerifyPassword:s})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(P.DropdownMenu,{children:[(0,b.jsx)(P.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(q.Button,{variant:"ghost",className:"justify-start gap-2 h-auto py-2",children:[(0,b.jsx)(N.Building2,{className:"h-4 w-4"}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"Business"}),(0,b.jsx)("div",{className:"text-sm font-medium",children:d?.name||"Loading..."})]})]})}),(0,b.jsx)(P.DropdownMenuContent,{align:"start",className:"w-64",children:e.map(a=>(0,b.jsxs)(P.DropdownMenuItem,{onClick:()=>p(a.id),className:"flex items-center justify-between",children:[(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(N.Building2,{className:"h-4 w-4"}),a.name,a.is_default&&(0,b.jsx)("span",{className:"text-xs bg-gray-100 px-1 rounded",children:"Default"})]}),d?.id===a.id&&(0,b.jsx)(ag.Check,{className:"h-4 w-4"})]},a.id))})]}),n&&(0,b.jsx)(aj.BusinessPasswordDialog,{open:l,onOpenChange:m,businessName:n.businessName,onPasswordVerified:r,onVerifyPassword:s})]})};var am=a.i(565258);let an=()=>{let{user:a,signOut:c}=(0,g.useAuth)(),{currentBusiness:d,businessLocations:f,switchBusiness:i}=(0,h.useBusiness)(),{updateAvailable:j,isUpdating:k,triggerUpdate:l}=(0,am.useAppUpdate)();return(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)(P.DropdownMenu,{children:[(0,b.jsx)(P.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(q.Button,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:(0,b.jsx)(ae,{className:"h-8 w-8",children:(0,b.jsx)(af,{children:a?.email?a.email.charAt(0).toUpperCase():"U"})})})}),(0,b.jsxs)(P.DropdownMenuContent,{className:"w-80",align:"end",forceMount:!0,children:[(0,b.jsx)("div",{className:"flex items-center justify-start gap-2 p-2",children:(0,b.jsx)("div",{className:"flex flex-col space-y-1 leading-none",children:a?.email&&(0,b.jsx)("p",{className:"font-medium",children:a.email})})}),(0,b.jsx)(P.DropdownMenuSeparator,{}),(0,b.jsx)("div",{className:"p-2",children:(0,b.jsx)(al,{variant:"desktop"})}),(0,b.jsx)(P.DropdownMenuSeparator,{}),(0,b.jsx)(P.DropdownMenuItem,{asChild:!0,children:(0,b.jsxs)(e.Link,{to:"/business-management",className:"flex items-center bg-blue-50 text-blue-700 font-medium",children:[(0,b.jsx)(N.Building2,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{children:"Manage Businesses"})]})}),(0,b.jsx)(P.DropdownMenuSeparator,{}),(0,b.jsxs)(P.DropdownMenuGroup,{children:[(0,b.jsx)(P.DropdownMenuItem,{asChild:!0,children:(0,b.jsxs)(e.Link,{to:"/settings",className:"flex items-center",children:[(0,b.jsx)(M.Settings,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{children:"Settings"})]})}),(0,b.jsxs)(P.DropdownMenuItem,{onClick:l,disabled:k,className:"flex items-center bg-orange-50 text-orange-700 font-medium hover:bg-orange-100",children:[(0,b.jsx)(O.RefreshCw,{className:`mr-2 h-4 w-4 ${k?"animate-spin":""}`}),(0,b.jsx)("span",{children:k?"UPDATING...":"UPDATE APP"})]})]}),(0,b.jsx)(P.DropdownMenuSeparator,{}),(0,b.jsxs)(P.DropdownMenuItem,{onClick:c,children:[(0,b.jsx)(L.LogOut,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{children:"Log out"})]})]})]})})},ao=(0,n.default)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),ap=(0,n.default)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);var aq=a.i(501199),ar=a.i(883497),as=a.i(790166),at=a.i(942211),au=a.i(563588),av=a.i(660246),aw=a.i(856738),ax=a.i(287534),ay=a.i(591965);let az=(0,n.default)("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);var aA=a.i(911156);let aB=({className:a="",onClick:c,isSidebar:d=!1})=>{let g=(0,f.useLocation)(),{hasPermission:h}=(0,i.useProfiles)(),j=[{name:"Dashboard",path:"/",icon:(0,b.jsx)(ap,{className:"w-4 h-4"})},{name:"Sales",path:"/sales",icon:(0,b.jsx)(aq.Receipt,{className:"w-4 h-4"}),module:"sales"},{name:"Inventory",path:"/inventory",icon:(0,b.jsx)(ar.Package,{className:"w-4 h-4"}),module:"inventory"},{name:"Finance",path:"/cash",icon:(0,b.jsx)(aw.Wallet,{className:"w-4 h-4"}),module:"finance"},{name:"Expenses",path:"/expenses",icon:(0,b.jsx)(as.DollarSign,{className:"w-4 h-4"}),module:"expenses"},{name:"Customers",path:"/customers",icon:(0,b.jsx)(av.Users,{className:"w-4 h-4"}),module:"customers"},{name:"Messages",path:"/messages",icon:(0,b.jsx)(au.MessageSquare,{className:"w-4 h-4"}),module:"messages"},{name:"Profiles",path:"/profiles",icon:(0,b.jsx)(az,{className:"w-4 h-4"}),module:"profiles"},{name:"Tasks",path:"/tasks",icon:(0,b.jsx)(ax.CheckSquare,{className:"w-4 h-4"}),module:"tasks"},{name:"History",path:"/history",icon:(0,b.jsx)(ay.History,{className:"w-4 h-4"})}].filter(a=>!a.module||h(a.module,"view")),k=[{name:"Billing History",path:"/billing",icon:(0,b.jsx)(aA.CreditCard,{className:"w-4 h-4"})},{name:"Settings",path:"/settings",icon:(0,b.jsx)(M.Settings,{className:"w-4 h-4"}),module:"settings"},{name:"Help",path:"/help",icon:(0,b.jsx)(at.HelpCircle,{className:"w-4 h-4"})},{name:"Privacy Policy",path:"/privacy-policy",icon:(0,b.jsx)(at.HelpCircle,{className:"w-4 h-4"})}].filter(a=>!a.module||h(a.module,"view")),l=a=>!!("/"===a&&"/"===g.pathname||"/"!==a&&g.pathname.startsWith(a));if(d)return(0,b.jsxs)("div",{className:"flex flex-col justify-between h-full",children:[(0,b.jsx)(D,{className:"w-full",children:j.map(a=>(0,b.jsx)(E,{children:(0,b.jsx)(G,{asChild:!0,isActive:l(a.path),tooltip:a.name,className:"text-primary-foreground/80 hover:bg-white/10 hover:text-primary-foreground data-[active=true]:bg-secondary data-[active=true]:text-secondary-foreground",children:(0,b.jsxs)(e.Link,{to:a.path,onClick:c,children:[a.icon,(0,b.jsx)("span",{className:"group-data-[collapsible=icon]:hidden",children:a.name})]})})},a.name))}),(0,b.jsx)(D,{className:"w-full",children:k.map(a=>(0,b.jsx)(E,{children:(0,b.jsx)(G,{asChild:!0,isActive:l(a.path),tooltip:a.name,className:"text-primary-foreground/80 hover:bg-white/10 hover:text-primary-foreground data-[active=true]:bg-secondary data-[active=true]:text-secondary-foreground",children:(0,b.jsxs)(e.Link,{to:a.path,onClick:c,children:[a.icon,(0,b.jsx)("span",{className:"group-data-[collapsible=icon]:hidden",children:a.name})]})})},a.name))})]});let m=[...j,...k];return(0,b.jsx)("nav",{className:(0,p.cn)("flex flex-col space-y-1",a),children:m.map(a=>(0,b.jsxs)(e.Link,{to:a.path,className:`px-3 py-2 rounded-md text-sm font-medium flex items-center gap-2 ${l(a.path)?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,onClick:c,children:[a.icon,(0,b.jsx)("span",{children:a.name})]},a.name))})},aC=()=>{let{signOut:c}=(0,g.useAuth)(),[d,e]=(0,j.useState)(!1),f=async()=>{try{e(!0),await c()}catch(c){console.error("Error during logout:",c);let{toast:b}=await a.A(568141);b.error("Failed to logout. Please try again.")}finally{e(!1)}};return(0,b.jsx)("div",{className:"absolute bottom-4 left-4 right-4 bg-white",children:(0,b.jsx)(q.Button,{variant:"ghost",size:"sm",onClick:f,disabled:d,className:"w-full justify-start px-4 py-3 text-sm font-medium text-gray-600 hover:text-red-600 flex items-center gap-2 bg-white hover:bg-gray-50",children:d?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"animate-spin mr-1",children:(0,b.jsxs)("svg",{className:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),"Logging out..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(L.LogOut,{className:"w-4 h-4"}),"Logout"]})})})};var aD=a.i(580701),aE=a.i(546842);let aF=()=>{let{profiles:a,currentProfile:c,setCurrentProfile:d}=(0,i.useProfiles)();return 0===a.length?null:(0,b.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,b.jsx)(aE.User,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,b.jsxs)(aD.Select,{value:c?.id||"",onValueChange:b=>{d(a.find(a=>a.id===b)||null)},children:[(0,b.jsx)(aD.SelectTrigger,{className:"h-8 min-w-[120px] max-w-[200px]",children:(0,b.jsx)(aD.SelectValue,{placeholder:"Select profile"})}),(0,b.jsx)(aD.SelectContent,{children:a.map(a=>(0,b.jsx)(aD.SelectItem,{value:a.id,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.profile_name}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",a.role,")"]})]})},a.id))})]})]})};var aG=a.i(269876);let aH=()=>{let[a,c]=(0,j.useState)(!1),{updateAvailable:d,isUpdating:f,triggerUpdate:g}=(0,am.useAppUpdate)();return(0,b.jsxs)(t.Sheet,{open:a,onOpenChange:c,modal:!0,children:[(0,b.jsx)(t.SheetTrigger,{asChild:!0,children:(0,b.jsxs)(q.Button,{variant:"ghost",size:"icon",className:"md:hidden",children:[(0,b.jsx)(ao,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"Open menu"})]})}),(0,b.jsxs)(t.SheetContent,{side:"left",className:"w-full sm:w-72 pt-10 flex flex-col z-[60]",children:[(0,b.jsx)(t.SheetHeader,{className:"mb-4",children:(0,b.jsx)(t.SheetTitle,{className:"text-left",children:"Menu"})}),(0,b.jsx)(aG.ScrollArea,{className:"flex-1",children:(0,b.jsxs)("div",{className:"pb-16",children:[(0,b.jsx)("div",{className:"px-6 pb-4 border-b",children:(0,b.jsxs)(q.Button,{onClick:g,disabled:f,className:"w-full flex items-center gap-2 px-3 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-md text-sm font-medium transition-colors",children:[(0,b.jsx)(O.RefreshCw,{className:`h-4 w-4 ${f?"animate-spin":""}`}),f?"UPDATING...":"UPDATE APP"]})}),(0,b.jsx)(al,{variant:"mobile",onItemClick:()=>{console.log("Business selector item clicked")}}),(0,b.jsx)("div",{className:"px-6 pb-4",children:(0,b.jsx)(aF,{})}),(0,b.jsx)("div",{className:"px-6 pb-4 border-b",children:(0,b.jsxs)(e.Link,{to:"/business-management",onClick:()=>c(!1),className:"w-full flex items-center gap-2 px-3 py-2 bg-blue-50 text-blue-700 rounded-md text-sm font-medium hover:bg-blue-100 transition-colors",children:[(0,b.jsx)(N.Building2,{className:"h-4 w-4"}),"Manage Businesses"]})}),(0,b.jsx)(aB,{className:"p-4",onClick:()=>c(!1)})]})}),(0,b.jsx)(aC,{})]})]})};var aI=a.i(284505);let aJ=()=>{let{isInstallable:a,isInstalled:c,promptToInstall:d}=function(){let[a,b]=(0,j.useState)(null),[c,d]=(0,j.useState)(!1),[e,f]=(0,j.useState)(!1);return(0,j.useEffect)(()=>{window.matchMedia("(display-mode: standalone)").matches&&f(!0);let a=a=>{a.preventDefault(),b(a),d(!0)},c=()=>{f(!0),d(!1),b(null),console.log("App was installed")};return window.addEventListener("beforeinstallprompt",a),window.addEventListener("appinstalled",c),()=>{window.removeEventListener("beforeinstallprompt",a),window.removeEventListener("appinstalled",c)}},[]),{isInstallable:c,isInstalled:e,promptToInstall:async()=>{if(!a)return void console.log("Cannot install: No install prompt available");a.prompt();let c=await a.userChoice;b(null),"accepted"===c.outcome?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt")}}}();return c||!a?null:(0,b.jsxs)(v.Tooltip,{children:[(0,b.jsx)(v.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(q.Button,{variant:"outline",size:"icon",onClick:d,className:"text-gray-600 hover:text-gray-900",children:[(0,b.jsx)(aI.Download,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Install app"})]})}),(0,b.jsx)(v.TooltipContent,{children:(0,b.jsx)("p",{children:"Install this app on your computer"})})]})},aK=()=>(0,k.useIsMobile)()?(0,b.jsx)("header",{className:"bg-white/80 backdrop-blur-md border-b border-border/50 shadow-sm py-4 fixed top-0 left-0 right-0 z-50",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 flex justify-between items-center",children:[(0,b.jsx)("div",{className:"flex items-center gap-6",children:(0,b.jsx)(K,{})}),(0,b.jsx)(aH,{})]})}):(0,b.jsxs)("header",{className:"flex h-14 shrink-0 items-center justify-between border-b border-border/50 bg-white/80 backdrop-blur-md px-6 sticky top-0 z-50",children:[(0,b.jsx)("div",{className:"flex items-center",children:(0,b.jsx)(A,{})}),(0,b.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2",children:(0,b.jsx)(K,{})}),(0,b.jsxs)("nav",{className:"flex items-center gap-2",children:[(0,b.jsx)(aJ,{}),(0,b.jsx)(an,{})]})]}),aL=()=>{let a=(0,f.useLocation)(),c=b=>!!("/"===b&&"/"===a.pathname||"/"!==b&&a.pathname.startsWith(b));return(0,b.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg z-50 md:hidden safe-area-inset-bottom",children:(0,b.jsxs)("div",{className:"flex justify-between items-center px-1 py-2 min-h-[60px]",children:[(0,b.jsxs)(e.Link,{to:"/",className:`flex flex-1 flex-col items-center py-2 px-1 rounded-md transition-colors min-h-[48px] ${c("/")?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[(0,b.jsx)(ap,{className:"h-5 w-5 mb-1"}),(0,b.jsx)("span",{className:"text-xs font-medium text-center",children:"Dashboard"})]}),(0,b.jsxs)(e.Link,{to:"/sales",className:`flex flex-1 flex-col items-center py-2 px-1 rounded-md transition-colors min-h-[48px] ${c("/sales")?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[(0,b.jsx)(aq.Receipt,{className:"h-5 w-5 mb-1"}),(0,b.jsx)("span",{className:"text-xs font-medium text-center",children:"Sales"})]}),(0,b.jsxs)(e.Link,{to:"/inventory",className:`flex flex-1 flex-col items-center py-2 px-1 rounded-md transition-colors min-h-[48px] ${c("/inventory")?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[(0,b.jsx)(ar.Package,{className:"h-5 w-5 mb-1"}),(0,b.jsx)("span",{className:"text-xs font-medium text-center",children:"Inventory"})]}),(0,b.jsxs)(e.Link,{to:"/cash",className:`flex flex-1 flex-col items-center py-2 px-1 rounded-md transition-colors min-h-[48px] ${c("/cash")?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[(0,b.jsx)(aw.Wallet,{className:"h-5 w-5 mb-1"}),(0,b.jsx)("span",{className:"text-xs font-medium text-center",children:"Finance"})]}),(0,b.jsxs)(e.Link,{to:"/expenses",className:`flex flex-1 flex-col items-center py-2 px-1 rounded-md transition-colors min-h-[48px] ${c("/expenses")?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[(0,b.jsx)(as.DollarSign,{className:"h-5 w-5 mb-1"}),(0,b.jsx)("span",{className:"text-xs font-medium text-center",children:"Expenses"})]}),(0,b.jsxs)(e.Link,{to:"/customers",className:`flex flex-1 flex-col items-center py-2 px-1 rounded-md transition-colors min-h-[48px] ${c("/customers")?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[(0,b.jsx)(av.Users,{className:"h-5 w-5 mb-1"}),(0,b.jsx)("span",{className:"text-xs font-medium text-center",children:"Customers"})]})]})})};var aM=a.i(915618),aN=a.i(538784);let aO=()=>{let[a,c]=(0,j.useState)(!1),d=(0,f.useNavigate)(),e=(0,k.useIsMobile)(),g=(a,b)=>{d(a,{state:b}),c(!1)};return(0,b.jsx)("div",{className:`fixed ${e?"bottom-28":"bottom-6"} right-6 z-50`,children:(0,b.jsxs)(P.DropdownMenu,{open:a,onOpenChange:c,children:[(0,b.jsx)(P.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(q.Button,{size:"lg",className:"h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-shadow",children:(0,b.jsx)(aM.Plus,{className:"h-6 w-6"})})}),(0,b.jsxs)(P.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,b.jsxs)(P.DropdownMenuItem,{onClick:()=>g("/new-sale"),children:[(0,b.jsx)(aN.ShoppingCart,{className:"mr-2 h-4 w-4"}),"Create Sale"]}),(0,b.jsxs)(P.DropdownMenuItem,{onClick:()=>g("/new-sale",{defaultPaymentStatus:"Installment Sale"}),children:[(0,b.jsx)(aA.CreditCard,{className:"mr-2 h-4 w-4"}),"Create Installment Sale"]}),(0,b.jsxs)(P.DropdownMenuItem,{onClick:()=>g("/inventory/new"),children:[(0,b.jsx)(ar.Package,{className:"mr-2 h-4 w-4"}),"Add Product"]}),(0,b.jsxs)(P.DropdownMenuItem,{onClick:()=>g("/customers"),children:[(0,b.jsx)(av.Users,{className:"mr-2 h-4 w-4"}),"Add Customer"]}),(0,b.jsxs)(P.DropdownMenuItem,{onClick:()=>g("/expenses"),children:[(0,b.jsx)(as.DollarSign,{className:"mr-2 h-4 w-4"}),"Add Expense"]})]})]})})};var aP=a.i(823292);let aQ=()=>{let{businessLocations:a}=(0,h.useBusiness)(),{signOut:c}=(0,g.useAuth)(),{hasPermission:d}=(0,i.useProfiles)(),[f,k]=(0,j.useState)(!1),l=d("settings","manage"),m=async()=>{k(!0);try{await c(),aP.toast.success("Logged out successfully")}catch(a){console.error("Error during logout:",a),aP.toast.error("Failed to logout. Please try again.")}finally{k(!1)}};return(0,b.jsxs)(z,{collapsible:"icon",className:"hidden border-r border-primary-foreground/20 bg-primary text-primary-foreground md:flex",children:[(0,b.jsxs)(C,{className:"p-2 pt-6 flex flex-col",children:[a.length>0&&(0,b.jsxs)("div",{className:"p-2 space-y-2",children:[(0,b.jsx)(al,{variant:"sidebar"}),(0,b.jsx)(aF,{})]}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)(aB,{isSidebar:!0})})]}),(0,b.jsx)(B,{className:"p-2 border-t border-primary-foreground/20",children:(0,b.jsxs)(D,{children:[(0,b.jsx)(E,{children:(0,b.jsxs)(G,{onClick:m,disabled:f,className:"w-full justify-start hover:bg-white/10 text-primary-foreground",tooltip:f?"Logging out...":"Logout",children:[(0,b.jsx)(L.LogOut,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{className:"group-data-[collapsible=icon]:hidden truncate",children:f?"Logging out...":"Logout"})]})}),l&&(0,b.jsx)(E,{children:(0,b.jsx)(G,{className:"w-full justify-start hover:bg-white/10 text-primary-foreground",asChild:!0,tooltip:"Manage Businesses",children:(0,b.jsxs)(e.Link,{to:"/business-management",children:[(0,b.jsx)(N.Building2,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{className:"group-data-[collapsible=icon]:hidden truncate",children:"Manage Businesses"})]})})})]})})]})};var aR=a.i(371844),aS=a.i(124348);let aT=(0,n.default)("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),aU=()=>{let{isOnline:a}=(()=>{let[a,b]=(0,j.useState)("u"<typeof navigator||navigator.onLine);return(0,j.useEffect)(()=>{let a=()=>b(navigator.onLine);return window.addEventListener("online",a),window.addEventListener("offline",a),a(),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",a)}},[]),{isOnline:a,isSlowConnection:!1}})();return a?null:(0,b.jsx)("div",{className:"fixed top-16 left-1/2 transform -translate-x-1/2 z-50 w-full max-w-md px-4",children:(0,b.jsxs)(aS.Alert,{className:"bg-red-50 border-red-200 animate-fade-in",children:[(0,b.jsx)(aT,{className:"h-4 w-4 text-red-600"}),(0,b.jsx)(aS.AlertDescription,{className:"text-red-800 font-medium",children:"No internet connection. Please check your network."})]})})};var aV=a.i(591119);let aW=()=>{let{profiles:a,currentProfile:c,setCurrentProfile:d,logoutProfile:e,isLoading:f}=(0,i.useProfiles)();return c||f||0===a.length?null:(0,b.jsx)("div",{className:"fixed inset-0 z-[100] bg-background/95 backdrop-blur-md flex flex-col items-center justify-center overflow-y-auto p-4 sm:p-8",children:(0,b.jsxs)("div",{className:"w-full max-w-2xl space-y-12 animate-in fade-in zoom-in duration-500 py-12",children:[(0,b.jsxs)("div",{className:"text-center space-y-8",children:[(0,b.jsx)("div",{className:"flex justify-center mb-4",children:(0,b.jsx)("img",{src:"/lovable-uploads/798d07d7-1db7-498c-92f3-6f6346827d59.png",alt:"Gonza Logo",className:"h-24 md:h-32 animate-in fade-in slide-in-from-bottom-8 duration-1000"})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h1",{className:"text-4xl font-extrabold tracking-tight text-primary",children:"Welcome Back"}),(0,b.jsx)("p",{className:"text-muted-foreground text-xl",children:"Please select your profile to continue"})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(a=>(0,b.jsx)(aV.Card,{className:"cursor-pointer hover:border-primary hover:shadow-lg transition-all transform hover:-translate-y-1 group",onClick:()=>d(a),children:(0,b.jsxs)(aV.CardHeader,{className:"flex flex-row items-center gap-4 pb-2",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center group-hover:bg-primary/20 transition-colors",children:(0,b.jsx)(aE.User,{className:"h-6 w-6 text-primary"})}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)(aV.CardTitle,{className:"text-lg truncate",children:a.profile_name}),(0,b.jsx)(aV.CardDescription,{className:"capitalize",children:a.role})]})]})},a.id))}),(0,b.jsx)("div",{className:"flex justify-center pt-8",children:(0,b.jsxs)(q.Button,{variant:"ghost",className:"text-muted-foreground hover:text-primary gap-2",onClick:e,children:[(0,b.jsx)(L.LogOut,{className:"h-4 w-4"}),"Sign out of business"]})})]})})};var aX=a.i(943108);let aY=()=>{let{currentProfile:a,isProfileVerified:c,verifyPin:d,setCurrentProfile:e,logoutProfile:f}=(0,i.useProfiles)(),[g,h]=(0,j.useState)(""),[k,l]=(0,j.useState)(!1),[m,n]=(0,j.useState)(!1),o=(0,j.useRef)(null);if((0,j.useEffect)(()=>{h(""),n(!1)},[a?.id]),(0,j.useEffect)(()=>{a&&!c&&o.current&&o.current.focus()},[a,c]),!a||c)return null;let s=async a=>{let b=a||g;if(4===b.length){l(!0),n(!1);try{await d(b)||(h(""),n(!0),setTimeout(()=>{n(!1),o.current?.focus()},500))}finally{l(!1)}}};return(0,b.jsx)("div",{className:"fixed inset-0 z-[100] bg-background/95 backdrop-blur-sm flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:(0,p.cn)("w-full max-w-sm flex flex-col items-center justify-center space-y-6 text-center",m?"animate-shake":""),children:[(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)("img",{src:"/lovable-uploads/798d07d7-1db7-498c-92f3-6f6346827d59.png",alt:"Gonza Logo",className:"h-12 animate-in fade-in slide-in-from-bottom-4 duration-700"})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:(0,b.jsx)(aX.Lock,{className:"h-6 w-6 text-primary"})}),(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Enter PIN"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.profile_name})]}),(0,b.jsxs)("div",{className:"w-full space-y-4",children:[(0,b.jsx)(r.Input,{ref:o,id:"security-pin-code",name:"security-pin-code",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:g,onChange:a=>{let b=a.target.value.replace(/\D/g,"").slice(0,4);h(b),4===b.length&&s(b)},onKeyDown:a=>{"Enter"===a.key&&4===g.length&&s()},disabled:k,placeholder:"Enter 4-digit PIN",autoComplete:"one-time-code",style:{WebkitTextSecurity:"disc"},className:(0,p.cn)("text-center text-2xl font-bold tracking-widest h-14",m&&"border-destructive")}),m&&(0,b.jsx)("p",{className:"text-sm text-destructive animate-in fade-in",children:"Incorrect PIN. Please try again."}),(0,b.jsx)(q.Button,{variant:"outline",size:"lg",onClick:()=>e(null),disabled:k,className:"w-full",children:"Switch Profile"})]}),(0,b.jsxs)("div",{className:"pt-2 space-y-2 w-full",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,b.jsx)(q.Button,{variant:"link",size:"sm",onClick:()=>e(null),disabled:k,className:"h-auto p-0 text-sm",children:"Back to Profiles"}),(0,b.jsx)(q.Button,{variant:"link",size:"sm",className:"text-destructive h-auto p-0 text-xs font-normal hover:no-underline",onClick:f,disabled:k,children:"Logout of System"})]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["First time? Default PIN is ",(0,b.jsx)("span",{className:"font-mono font-semibold",children:"0000"})]})]})]})})};var aZ=a.i(814574),a$=a.i(870430),a_=a.i(104416);let a0=()=>{let{currentProfile:a,changePin:c,isFirstTimeSetupNeeded:d,dismissFirstTimeSetup:e}=(0,i.useProfiles)(),[f,g]=(0,j.useState)(""),[h,k]=(0,j.useState)(""),[l,m]=(0,j.useState)(!1),n=(0,j.useRef)(null),o=(0,j.useRef)(null);if(!d||!a)return null;let p=async()=>{if(f!==h)return void aP.toast.error("PINs do not match");if(4!==f.length||!/^\d+$/.test(f))return void aP.toast.error("PIN must be exactly 4 digits");if("0000"===f)return void aP.toast.error("Please choose a PIN other than the default 0000");m(!0);try{await c("0000",f)&&e()}finally{m(!1)}};return(0,b.jsx)(aZ.Dialog,{open:!0,onOpenChange:()=>{},children:(0,b.jsxs)(aZ.DialogContent,{className:"sm:max-w-md",onInteractOutside:a=>a.preventDefault(),children:[(0,b.jsxs)(aZ.DialogHeader,{children:[(0,b.jsx)("div",{className:"flex justify-center mb-6",children:(0,b.jsx)("img",{src:"/lovable-uploads/798d07d7-1db7-498c-92f3-6f6346827d59.png",alt:"Gonza Logo",className:"h-12 animate-in fade-in slide-in-from-bottom-2 duration-700"})}),(0,b.jsx)("div",{className:"mx-auto w-12 h-12 bg-amber-50 rounded-2xl flex items-center justify-center mb-4 border border-amber-100",children:(0,b.jsx)(aX.Lock,{className:"h-6 w-6 text-amber-600"})}),(0,b.jsx)(aZ.DialogTitle,{className:"text-center text-2xl",children:"Secure Your Account"}),(0,b.jsxs)(aZ.DialogDescription,{className:"text-center",children:["You're currently using the default PIN ",(0,b.jsx)("span",{className:"font-mono font-bold",children:"0000"}),". For security, we recommend setting a custom PIN now."]})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a$.Label,{htmlFor:"new_pin_setup",children:"New 4-Digit PIN"}),(0,b.jsx)(r.Input,{ref:n,id:"new_pin_setup",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:f,onChange:a=>{let b=a.target.value.replace(/\D/g,"").slice(0,4);g(b),4===b.length&&setTimeout(()=>o.current?.focus(),100)},placeholder:"Enter new PIN",autoComplete:"one-time-code",style:{WebkitTextSecurity:"disc"}})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a$.Label,{htmlFor:"confirm_pin_setup",children:"Confirm PIN"}),(0,b.jsx)(r.Input,{ref:o,id:"confirm_pin_setup",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:h,onChange:a=>{let b=a.target.value.replace(/\D/g,"").slice(0,4);k(b),4===b.length&&4===f.length&&setTimeout(()=>p(),100)},placeholder:"Confirm new PIN",autoComplete:"one-time-code",style:{WebkitTextSecurity:"disc"}})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsxs)(q.Button,{className:"w-full gap-2 bg-primary hover:bg-primary/90",onClick:p,disabled:l||4!==f.length||4!==h.length,children:[(0,b.jsx)(a_.ShieldCheck,{className:"h-4 w-4"}),l?"Setting PIN...":"Set Custom PIN"]}),(0,b.jsx)(q.Button,{variant:"ghost",className:"w-full text-muted-foreground",onClick:()=>{e(),aP.toast.warning("Remember to change your PIN from Settings → Profiles → Security")},disabled:l,children:"Skip for now"})]}),(0,b.jsx)("p",{className:"text-[10px] text-muted-foreground/60 text-center",children:"You can change your PIN anytime from Settings → Profiles → Security"})]})})},a1=()=>{try{let a=(0,k.useIsMobile)();return(0,b.jsx)(y,{children:(0,b.jsxs)(v.TooltipProvider,{children:[a?(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50 w-full",children:[(0,b.jsx)(aK,{}),(0,b.jsx)(aU,{}),(0,b.jsx)("main",{className:"pt-20 pb-20 min-h-screen",children:(0,b.jsx)("div",{className:"px-2 py-2 max-w-full overflow-x-hidden",children:(0,b.jsx)(j.default.Suspense,{fallback:(0,b.jsx)(aR.default,{message:"Loading page..."}),children:(0,b.jsx)(f.Outlet,{})})})}),(0,b.jsxs)("footer",{className:"fixed bottom-0 left-0 right-0 bg-background border-t text-center text-xs text-muted-foreground py-2 mb-16 z-40",children:["© ",new Date().getFullYear()," Gonza Systems. All rights reserved."]}),(0,b.jsx)(aL,{})]}):(0,b.jsxs)("div",{className:"flex min-h-screen w-full",children:[(0,b.jsx)(aQ,{}),(0,b.jsxs)("div",{className:"flex flex-1 flex-col min-h-screen min-w-0",children:[(0,b.jsx)(aK,{}),(0,b.jsx)(aU,{}),(0,b.jsx)("main",{className:"flex-1 bg-gray-50 p-6 overflow-auto",children:(0,b.jsx)("div",{className:"w-full",children:(0,b.jsx)(j.default.Suspense,{fallback:(0,b.jsx)(aR.default,{message:"Loading page..."}),children:(0,b.jsx)(f.Outlet,{})})})}),(0,b.jsxs)("footer",{className:"bg-background border-t text-center text-xs text-muted-foreground py-3",children:["© ",new Date().getFullYear()," Gonza Systems. All rights reserved."]})]}),(0,b.jsx)(aO,{})]}),(0,b.jsx)(aW,{}),(0,b.jsx)(aY,{}),(0,b.jsx)(a0,{})]})})}catch(a){return console.error("Layout rendering error:",a),(0,b.jsx)(y,{children:(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Loading..."}),(0,b.jsx)(aR.default,{message:"Initializing app..."})]})})})}};var a2=a.i(284415);let a3=({children:a})=>{let{businessLocations:c,isLoading:d,createBusiness:e}=(0,h.useBusiness)(),{profiles:k,isLoading:l}=(0,i.useProfiles)(),{isCompleted:m,isFrozen:n,daysRemaining:o,isLoading:p}=(0,a2.useOnboarding)(),{user:q,loading:r,signOut:s}=(0,g.useAuth)(),t=(0,f.useNavigate)(),u=(0,f.useLocation)(),[v,w]=(0,j.useState)(!1);console.log("[Gate Render Check]:",{path:u.pathname,user:q?.id,authLoading:r,businessLoading:d,profilesLoading:l,onboardingLoading:p,onboardingCompleted:m,isAutomating:v,locations:c.length,profiles:k.length});let x=!d&&!l&&(0===c.length||0===k.length);return((0,j.useEffect)(()=>{(async()=>{if(!d&&!l&&q&&0===c.length&&!v){console.log("[Gate Action]: Auto-creating business for user:",q.id),w(!0);try{let a=q.user_metadata?.business_name||"My Business";await e(a),aP.toast.success("Your business system is ready!")}catch(a){console.error("[Gate Error]: Auto-setup failed:",a),aP.toast.error("Failed to complete account setup. Please try again.")}finally{w(!1)}}})()},[d,l,c.length,q,v,e]),(0,j.useEffect)(()=>{r||d||p||!1!==m||"/onboarding"===u.pathname||(console.log("[Gate Action]: MANDATORY REDIRECT to /onboarding"),t("/onboarding",{replace:!0}))},[r,d,p,m,u.pathname,t]),r||d||l||p||v)?(0,b.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background text-foreground",children:(0,b.jsx)(aR.default,{message:v?"Finalizing account setup...":p?"Checking profile status...":"Checking account setup..."})}):x?(0,b.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background",children:(0,b.jsx)(aR.default,{message:"Finalizing setup..."})}):!1===m&&"/onboarding"!==u.pathname?(console.log("[Gate Status]: Blocking render, awaiting redirect to onboarding"),null):m&&n?(0,b.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background p-6",children:(0,b.jsxs)("div",{className:"w-full max-w-md bg-white border border-border/40 shadow-xl rounded-lg p-10 text-center animate-in zoom-in-95 duration-300",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-amber-50 text-amber-600 border-amber-100 rounded-full flex items-center justify-center mx-auto mb-6 border",children:(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,b.jsx)("h2",{className:"text-xl font-bold text-foreground mb-3 uppercase tracking-widest",children:"Account Paused"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed mb-8",children:"Your account has been temporarily paused due to unusual activity detected on your profile. Please contact the administrator immediately to resolve this issue and restore your access."}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"bg-muted/30 p-3 rounded-lg border border-border/40 mb-2",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-wider mb-1",children:"Admin Support"}),(0,b.jsx)("a",{href:"tel:+256758519696",className:"text-lg font-bold text-primary hover:underline block",children:"+256 758519696"})]}),(0,b.jsx)("button",{onClick:()=>s(),className:"block w-full py-2.5 text-muted-foreground text-[10px] font-bold uppercase tracking-widest border border-border/40 rounded hover:bg-muted transition-all",children:"Sign Out"})]})]})}):!0===m||"/onboarding"===u.pathname?(console.log("[Gate Status]: ALLOWING PASSAGE to",u.pathname),(0,b.jsx)(b.Fragment,{children:a})):m&&n?(0,b.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background p-6",children:(0,b.jsxs)("div",{className:"w-full max-w-md bg-white border border-border/40 shadow-xl rounded-lg p-10 text-center animate-in zoom-in-95 duration-300",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-amber-50 text-amber-600 border-amber-100 rounded-full flex items-center justify-center mx-auto mb-6 border",children:(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,b.jsx)("h2",{className:"text-xl font-bold text-foreground mb-3 uppercase tracking-widest",children:"Account Paused"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed mb-8",children:"Your account has been temporarily paused due to unusual activity detected on your profile. Please contact the administrator immediately to resolve this issue and restore your access."}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"bg-muted/30 p-3 rounded-lg border border-border/40 mb-2",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-wider mb-1",children:"Admin Support"}),(0,b.jsx)("a",{href:"tel:+256758519696",className:"text-lg font-bold text-primary hover:underline block",children:"+256 758519696"})]}),(0,b.jsx)("button",{onClick:()=>s(),className:"block w-full py-2.5 text-muted-foreground text-[10px] font-bold uppercase tracking-widest border border-border/40 rounded hover:bg-muted transition-all",children:"Sign Out"})]})]})}):(console.log("[Gate Status]: Fallback block"),(0,b.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background",children:(0,b.jsx)(aR.default,{message:"Verifying access..."})}))};var a4=a.i(478793),a5=a.i(682478);let a6=({children:c})=>{let{daysRemaining:d,billingAmount:e,billingDuration:f,isLoading:i,isFrozen:k,refetch:l}=(0,a2.useOnboarding)(),{signOut:m,user:n}=(0,g.useAuth)(),{currentBusiness:o}=(0,h.useBusiness)(),[p,q]=(0,j.useState)(!1),[r,s]=(0,j.useState)(null),[t,u]=(0,j.useState)(null);j.default.useEffect(()=>{(async()=>{if(n)try{let a=await fetch(`/api/subscription/latest?userId=${n.id}`);if(a.ok){let b=await a.json();b?.id&&u({...b,business_name:o?.name||"Gonzo System User"})}}catch(a){console.error("Failed to fetch payment data:",a)}})()},[n,o]);let v=async()=>{if(!t)return;let{generateSubscriptionInvoice:b}=await a.A(235185);await b(t,"invoice")},w=async()=>{if(n){if(!e||e<=0)return void(0,a4.toast)({title:"Plan Not Configured",description:"Your subscription plan hasn't been set by an admin yet. Please contact support.",variant:"destructive"});q(!0);try{let a=crypto.randomUUID(),b=o?.id||"00000000-0000-0000-0000-000000000000",c=await fetch("/api/initiate-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({purchaseId:a,userId:n.id,locationId:b,amount:e,billingDuration:f,phoneNumber:n.phone||"0700000000",description:`Subscription Renewal - ${f} Plan`})}),d=await c.json();if(!c.ok||!d.redirect_url)throw Error(d.error||"Failed to initiate payment");s(d.redirect_url)}catch(a){console.error("Subscription Renewal Error:",a),(0,a4.toast)({title:"Payment Error",description:`${a.message||"Unknown error"}. Please try again later.`,variant:"destructive"})}finally{q(!1)}}};if(i)return(0,b.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background",children:(0,b.jsx)(aR.default,{message:"Verifying subscription..."})});console.log("--- [SubscriptionGate] Access Check ---"),console.log("Days Remaining:",d),console.log("Is Frozen:",k),console.log("Is Loading:",i);let x=void 0!==d&&d<=0,y="/payment-callback"===window.location.pathname||"/onboarding"===window.location.pathname||"/login"===window.location.pathname||"/signup"===window.location.pathname;return(console.log("Is Locked:",x),console.log("Is Public Path:",y),x&&!y)?r?(0,b.jsxs)("div",{className:"fixed inset-0 z-[100] bg-background flex flex-col items-center justify-center p-4",children:[(0,b.jsxs)("div",{className:"w-full max-w-4xl h-[85vh] bg-white rounded-2xl shadow-2xl border border-border/40 overflow-hidden relative flex flex-col",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-border/40 flex items-center justify-between bg-white",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center",children:(0,b.jsx)(aA.CreditCard,{className:"w-4 h-4 text-blue-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-bold uppercase tracking-wider",children:"Secure Payment"}),(0,b.jsx)("p",{className:"text-[10px] text-muted-foreground font-mono",children:"Pesapal Integrated Gateway"})]})]}),(0,b.jsx)("button",{onClick:()=>s(null),className:"text-[10px] font-bold uppercase tracking-widest text-muted-foreground hover:text-foreground transition-colors",children:"Cancel"})]}),(0,b.jsx)("iframe",{src:r,className:"w-full flex-1 border-none",title:"Pesapal Payment"})]}),(0,b.jsx)("p",{className:"mt-4 text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-medium opacity-60",children:"Do not close this window until the payment is complete"})]}):(0,b.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background p-6",children:(0,b.jsxs)("div",{className:"w-full max-w-md bg-white border border-border/40 shadow-xl rounded-lg p-10 text-center animate-in zoom-in-95 duration-300",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-amber-50 text-amber-600 border-amber-100 rounded-full flex items-center justify-center mx-auto mb-6 border",children:(0,b.jsx)(aA.CreditCard,{className:"w-8 h-8"})}),(0,b.jsx)("h2",{className:"text-xl font-bold text-foreground mb-3 uppercase tracking-widest",children:"Subscription Expired"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed mb-6",children:"Your subscription has expired. Don't worry, all your data is safe. Please renew your subscription to restore full access to your business dashboard."}),(0,b.jsxs)("div",{className:"bg-muted/30 p-4 rounded-lg border border-border/40 mb-6 text-left",children:[(0,b.jsx)("p",{className:"text-[10px] font-bold uppercase tracking-widest text-muted-foreground mb-1",children:"Renewal Amount"}),(0,b.jsxs)("div",{className:"flex items-end justify-between",children:[(0,b.jsxs)("p",{className:"text-2xl font-bold text-foreground",children:["UGX ",e?.toLocaleString()??"50,000"]}),(0,b.jsx)("span",{className:"text-xs font-medium px-2 py-1 bg-white border border-border/60 rounded text-muted-foreground shadow-sm",children:f})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("button",{onClick:w,disabled:p,className:"block w-full py-2.5 bg-primary text-primary-foreground text-[11px] font-bold uppercase tracking-widest rounded transition-all hover:bg-primary/90 disabled:opacity-50",children:p?"Processing...":"Renew Subscription Now"}),(0,b.jsxs)("div",{className:"bg-muted/30 p-3 rounded-lg border border-border/40 mb-2",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-wider mb-1",children:"Admin Support"}),(0,b.jsx)("a",{href:"tel:+256758519696",className:"text-lg font-bold text-primary hover:underline block",children:"+256 758519696"})]}),t&&(0,b.jsxs)("button",{onClick:v,className:"flex items-center justify-center gap-2 w-full py-2 text-[10px] font-bold uppercase tracking-widest text-primary hover:bg-primary/5 rounded transition-all border border-primary/20",children:[(0,b.jsx)(a5.Rocket,{className:"w-3.5 h-3.5 rotate-45"}),"Download ",t.id.split("-")[0].toUpperCase()," Invoice"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>{(0,a4.toast)({title:"Syncing status...",description:"Checking for your recent payment."}),l()},className:"block w-full py-2.5 text-muted-foreground text-[10px] font-bold uppercase tracking-widest border border-border/40 rounded hover:bg-muted transition-all",children:"Check Status"}),(0,b.jsx)("button",{onClick:()=>m(),className:"block w-full py-2.5 text-muted-foreground text-[10px] font-bold uppercase tracking-widest border border-border/40 rounded hover:bg-muted transition-all",children:"Sign Out"})]})]})]})}):(0,b.jsx)(b.Fragment,{children:c})},a7=(0,j.lazy)(()=>a.A(382288)),a8=(0,j.lazy)(()=>a.A(933567)),a9=(0,j.lazy)(()=>a.A(110739)),ba=(0,j.lazy)(()=>a.A(980196)),bb=(0,j.lazy)(()=>a.A(921851)),bc=(0,j.lazy)(()=>a.A(302311)),bd=(0,j.lazy)(()=>a.A(871399)),be=(0,j.lazy)(()=>a.A(578955)),bf=(0,j.lazy)(()=>a.A(857824)),bg=(0,j.lazy)(()=>a.A(642246)),bh=(0,j.lazy)(()=>a.A(117487)),bi=(0,j.lazy)(()=>a.A(816087)),bj=(0,j.lazy)(()=>a.A(368890)),bk=(0,j.lazy)(()=>a.A(554331)),bl=(0,j.lazy)(()=>a.A(274619)),bm=(0,j.lazy)(()=>a.A(27710)),bn=(0,j.lazy)(()=>a.A(635869)),bo=(0,j.lazy)(()=>a.A(547833)),bp=(0,j.lazy)(()=>a.A(961761)),bq=(0,j.lazy)(()=>a.A(114617)),br=(0,j.lazy)(()=>a.A(847125)),bs=(0,j.lazy)(()=>a.A(730804)),bt=(0,j.lazy)(()=>a.A(355130)),bu=(0,j.lazy)(()=>a.A(565754)),bv=(0,j.lazy)(()=>a.A(27340)),bw=(0,j.lazy)(()=>a.A(108473)),bx=new c.QueryClient({defaultOptions:{queries:{retry:1,staleTime:3e5,gcTime:18e5,refetchOnWindowFocus:!1}}}),by=()=>{let{user:a,loading:c}=(0,g.useAuth)(),[d,e]=(0,j.useState)(!1),[k,l]=(0,j.useState)(!1);return((0,j.useEffect)(()=>{l(!navigator.onLine);let a=()=>l(!1),b=()=>l(!0);return window.addEventListener("online",a),window.addEventListener("offline",b),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",b)}},[]),(0,j.useEffect)(()=>{},[]),k)?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 px-4",children:(0,b.jsxs)("div",{className:"text-center max-w-md",children:[(0,b.jsx)("img",{src:"/lovable-uploads/798d07d7-1db7-498c-92f3-6f6346827d59.png",alt:"Gonzo Systems Logo",className:"h-16 mx-auto mb-6"}),(0,b.jsx)(aT,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),(0,b.jsx)("h2",{className:"text-xl font-semibold mb-2 text-gray-800",children:"No Internet Connection"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"Please check your internet connection and try again. Make sure you're connected to WiFi or mobile data."}),(0,b.jsxs)(q.Button,{onClick:()=>{e(!0),window.location.reload()},className:"gap-2",size:"lg",disabled:d,children:[(0,b.jsx)(O.RefreshCw,{className:`h-4 w-4 ${d?"animate-spin":""}`}),d?"Refreshing...":"Refresh App"]})]})}):c?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)(aR.default,{message:"Loading authentication..."})}):a?(0,b.jsx)(h.BusinessProvider,{children:(0,b.jsx)(i.ProfileProvider,{children:(0,b.jsx)(j.Suspense,{fallback:(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)(aR.default,{message:"Loading page..."})}),children:(0,b.jsxs)(f.Routes,{children:[(0,b.jsx)(f.Route,{path:"/login",element:(0,b.jsx)(f.Navigate,{to:"/",replace:!0})}),(0,b.jsx)(f.Route,{path:"/signup",element:(0,b.jsx)(f.Navigate,{to:"/",replace:!0})}),(0,b.jsx)(f.Route,{path:"/delete-personal-data",element:(0,b.jsx)(bt,{})}),(0,b.jsx)(f.Route,{path:"/onboarding",element:(0,b.jsx)(bw,{})}),(0,b.jsxs)(f.Route,{element:(0,b.jsx)(a6,{children:(0,b.jsx)(a3,{children:(0,b.jsx)(a1,{})})}),children:[(0,b.jsx)(f.Route,{path:"/",element:(0,b.jsx)(a7,{})}),(0,b.jsx)(f.Route,{path:"/sales",element:(0,b.jsx)(bb,{})}),(0,b.jsx)(f.Route,{path:"/new-sale",element:(0,b.jsx)(bc,{})}),(0,b.jsx)(f.Route,{path:"/expenses",element:(0,b.jsx)(bd,{})}),(0,b.jsx)(f.Route,{path:"/settings",element:(0,b.jsx)(bq,{})}),(0,b.jsx)(f.Route,{path:"/privacy-policy",element:(0,b.jsx)(bs,{})}),(0,b.jsx)(f.Route,{path:"/inventory",element:(0,b.jsx)(be,{})}),(0,b.jsx)(f.Route,{path:"/inventory/carriage-inwards",element:(0,b.jsx)(bk,{})}),(0,b.jsx)(f.Route,{path:"/inventory/reconcile",element:(0,b.jsx)(bl,{})}),(0,b.jsx)(f.Route,{path:"/inventory/new",element:(0,b.jsx)(bi,{})}),(0,b.jsx)(f.Route,{path:"/inventory/edit/:id",element:(0,b.jsx)(bi,{})}),(0,b.jsx)(f.Route,{path:"/inventory/:id",element:(0,b.jsx)(bj,{})}),(0,b.jsx)(f.Route,{path:"/products",element:(0,b.jsx)(bg,{})}),(0,b.jsx)(f.Route,{path:"/categories",element:(0,b.jsx)(bh,{})}),(0,b.jsx)(f.Route,{path:"/cash",element:(0,b.jsx)(bf,{})}),(0,b.jsx)(f.Route,{path:"/cash/:accountId",element:(0,b.jsx)(bm,{})}),(0,b.jsx)(f.Route,{path:"/messages",element:(0,b.jsx)(bn,{})}),(0,b.jsx)(f.Route,{path:"/payment-callback",element:(0,b.jsx)(br,{})}),(0,b.jsx)(f.Route,{path:"/tasks",element:(0,b.jsx)(bo,{})}),(0,b.jsx)(f.Route,{path:"/history",element:(0,b.jsx)(bp,{})}),(0,b.jsx)(f.Route,{path:"/help",element:(0,b.jsx)(bu,{})}),(0,b.jsx)(f.Route,{path:"*",element:(0,b.jsx)(bv,{})})]})]})})})}):(0,b.jsx)(j.Suspense,{fallback:(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)(aR.default,{message:"Loading..."})}),children:(0,b.jsxs)(f.Routes,{children:[(0,b.jsx)(f.Route,{path:"/",element:(0,b.jsx)(ba,{})}),(0,b.jsx)(f.Route,{path:"/login",element:(0,b.jsx)(a8,{})}),(0,b.jsx)(f.Route,{path:"/signup",element:(0,b.jsx)(a9,{})}),(0,b.jsx)(f.Route,{path:"/privacy-policy",element:(0,b.jsx)(bs,{})}),(0,b.jsx)(f.Route,{path:"/delete-personal-data",element:(0,b.jsx)(bt,{})}),(0,b.jsx)(f.Route,{path:"/payment-callback",element:(0,b.jsx)(br,{})}),(0,b.jsx)(f.Route,{path:"*",element:(0,b.jsx)(f.Navigate,{to:"/",replace:!0})})]})})};a.s(["default",0,function(){let[a,c]=(0,j.useState)(!1);return((0,j.useEffect)(()=>{c(!0)},[]),a)?(0,b.jsx)(d.QueryClientProvider,{client:bx,children:(0,b.jsx)(e.BrowserRouter,{children:(0,b.jsx)(g.AuthProvider,{children:(0,b.jsx)(by,{})})})}):null}],931852)}];

//# sourceMappingURL=_b6d1521e._.js.map