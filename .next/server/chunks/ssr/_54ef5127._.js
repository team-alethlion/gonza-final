module.exports=[915589,(a,b,c)=>{var d=a.r(950240),e=a.r(345591),f=a.r(814253);b.exports=function(a,b){return a&&a.length?d(a,f(b,2),e):void 0}},32965,(a,b,c)=>{var d=a.r(950240),e=a.r(814253),f=a.r(519390);b.exports=function(a,b){return a&&a.length?d(a,e(b,2),f):void 0}},996253,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(391956),e=a.i(871111),f=a.i(866102),g=a.i(368114),h=a.i(750054),i=a.i(915618),j=a.i(328790),k=a.i(284505),l=a.i(104720),m=a.i(773320),n=a.i(699570),o=a.i(478793),p=a.i(169819),q=a.i(405050);let r=(0,q.createServerReference)("40a697434fd28c67d2c607c1f57f3439edf220a529",q.callServer,void 0,q.findSourceMapURL,"getExpenseCategoriesAction"),s=(0,q.createServerReference)("40127fd3ae724f72ea4406ee7bf136a2e88120db7f",q.callServer,void 0,q.findSourceMapURL,"createExpenseCategoryAction"),t=(0,q.createServerReference)("408d7d1e536999dcf29cd979cf16838168c69252f0",q.callServer,void 0,q.findSourceMapURL,"deleteExpenseCategoryAction"),u=(0,q.createServerReference)("7062b9fc92a24c208cfe0ff340b8c459971725aba8",q.callServer,void 0,q.findSourceMapURL,"createDefaultExpenseCategoriesAction"),v=["Rent & Utilities","Salaries & Wages","Marketing & Advertising","Office Supplies & Equipment","Professional Services","Cost of bringing Goods","Delivery To Customer","Insurance","Licenses, Permits & Fees","Software & Subscriptions","Depreciation & Amortization","Training & Development","Communication","Bank & Transaction Fees","Miscellaneous"],w=()=>{let[a,b]=(0,c.useState)([]),[e,f]=(0,c.useState)(!0),{toast:g}=(0,o.useToast)(),{currentBusiness:h}=(0,p.useBusiness)(),{user:i}=(0,d.useAuth)(),j=(0,c.useCallback)(async()=>{if(!h?.id){b([]),f(!1);return}try{f(!0);let a=await r(h.id);if(!a.success||!a.data)throw Error(a.error||"Failed to fetch categories");let c=a.data.map(a=>({...a,createdAt:new Date(a.createdAt)}));if(0===c.length)return void await k();b(c)}catch(a){console.error("Error loading expense categories:",a),g({title:"Error",description:"Failed to load expense categories",variant:"destructive"})}finally{f(!1)}},[h?.id,g]),k=async()=>{if(h?.id&&i?.id)try{(await u(i.id,h.id,v)).success&&await j()}catch(a){console.error("Error creating default categories:",a)}},l=async c=>{if(!h?.id||!i?.id)return null;try{let d=a.find(a=>a.name.toLowerCase()===c.toLowerCase());if(d)return g({title:"Category exists",description:"This category already exists."}),d;let e=await s({userId:i.id,locationId:h.id,name:c,isDefault:!1});if(!e.success||!e.data)throw Error(e.error);let f={...e.data,createdAt:new Date(e.data.createdAt)};return b(a=>[...a,f]),f}catch(a){return console.error("Error creating category:",a),g({title:"Error",description:"Failed to create category",variant:"destructive"}),null}},m=async a=>{try{let c=await t(a);if(!c.success)throw Error(c.error);return b(b=>b.filter(b=>b.id!==a)),g({title:"Success",description:"Category deleted successfully"}),!0}catch(a){return console.error("Error deleting category:",a),g({title:"Error",description:"Failed to delete category",variant:"destructive"}),!1}};return(0,c.useEffect)(()=>{j()},[j]),{categories:a,isLoading:e,createCategory:l,deleteCategory:m,refreshCategories:j}};var x=a.i(866718),y=a.i(870430),z=a.i(781560),A=a.i(533350),B=a.i(814574),C=a.i(486192),D=a.i(269876),E=a.i(786304);let F=()=>{let{categories:a,createCategory:d,deleteCategory:e}=w(),[f,g]=(0,c.useState)(""),[h,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(!1),m=async()=>{if(f.trim()){j(!0);try{await d(f.trim())&&g("")}finally{j(!1)}}},o=async a=>{j(!0);try{await e(a)}finally{j(!1)}};return(0,b.jsxs)(B.Dialog,{open:k,onOpenChange:l,children:[(0,b.jsx)(B.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(n.Button,{variant:"outline",className:"gap-2",children:[(0,b.jsx)(A.Tag,{className:"h-4 w-4"}),"Expense Categories"]})}),(0,b.jsxs)(B.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(B.DialogHeader,{children:[(0,b.jsx)(B.DialogTitle,{children:"Expense Categories"}),(0,b.jsx)(B.DialogDescription,{children:"Manage your expense categories."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"newCategory",children:"Add New Category"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(x.Input,{id:"newCategory",placeholder:"Enter category name",value:f,onChange:a=>g(a.target.value),onKeyPress:a=>"Enter"===a.key&&m()}),(0,b.jsx)(n.Button,{onClick:m,disabled:!f.trim()||h,size:"sm",children:(0,b.jsx)(i.Plus,{className:"h-4 w-4"})})]})]}),(0,b.jsx)("div",{className:"space-y-3",children:a.length>0?(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Categories"}),(0,b.jsx)(D.ScrollArea,{className:"h-64 rounded-md border p-2",children:(0,b.jsx)("div",{className:"space-y-1",children:a.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-md hover:bg-gray-50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(A.Tag,{className:"h-3 w-3 text-gray-500"}),(0,b.jsx)("span",{className:"text-sm",children:a.name}),a.isDefault&&(0,b.jsx)(E.Badge,{variant:"secondary",className:"text-xs",children:"Default"})]}),(0,b.jsxs)(C.AlertDialog,{children:[(0,b.jsx)(C.AlertDialogTrigger,{asChild:!0,children:(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:(0,b.jsx)(z.Trash2,{className:"h-3 w-3 text-red-500"})})}),(0,b.jsxs)(C.AlertDialogContent,{children:[(0,b.jsxs)(C.AlertDialogHeader,{children:[(0,b.jsx)(C.AlertDialogTitle,{children:"Delete Category"}),(0,b.jsxs)(C.AlertDialogDescription,{children:['Are you sure you want to delete "',a.name,'"? This action cannot be undone.']})]}),(0,b.jsxs)(C.AlertDialogFooter,{children:[(0,b.jsx)(C.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(C.AlertDialogAction,{onClick:()=>o(a.id),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]})]},a.id))})})]}):(0,b.jsx)("div",{className:"text-center py-4 text-sm text-gray-500",children:"No categories yet. Add one above to get started."})})]}),(0,b.jsx)(B.DialogFooter,{children:(0,b.jsx)(B.DialogClose,{asChild:!0,children:(0,b.jsx)(n.Button,{variant:"outline",children:"Close"})})})]})]})};var G=a.i(770094);let H=({onAddExpense:a,onAddBulkExpense:c,onImportExpenses:d,onRefresh:e,isRefreshing:f,onExportCSV:g,onExportPDF:h,onDownloadTemplate:o,canCreate:p=!0})=>{let q=(0,G.useIsMobile)();return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-bold",children:"Expenses"}),(0,b.jsx)("p",{className:"text-sm md:text-base text-muted-foreground",children:"Track and manage your business expenses"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 sm:gap-3",children:[p&&(0,b.jsxs)(n.Button,{onClick:a,className:"gap-2 text-sm bg-red-600 hover:bg-red-700 shadow-sm",size:q?"sm":"default",children:[(0,b.jsx)(i.Plus,{className:"h-4 w-4"}),"Add Expense"]}),(0,b.jsxs)(n.Button,{variant:"outline",onClick:e,disabled:f,className:"gap-2 text-sm",size:q?"sm":"default",children:[(0,b.jsx)(j.RefreshCcw,{className:`h-4 w-4 ${f?"animate-spin":""}`}),"Refresh"]}),(0,b.jsxs)(n.Button,{variant:"outline",onClick:o,className:"gap-2 text-sm border-green-200 dark:border-green-900/30 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/10",size:q?"sm":"default",children:[(0,b.jsx)(k.Download,{className:"h-4 w-4"}),"Template"]}),(0,b.jsx)("div",{className:"hidden sm:block",children:(0,b.jsx)(F,{})})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 pt-1 border-t border-slate-100 dark:border-slate-800/50 mt-2",children:[p&&(0,b.jsxs)(n.Button,{variant:"ghost",onClick:c,className:"gap-2 text-xs h-8 px-3 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/10",children:[(0,b.jsx)(i.Plus,{className:"h-3.5 w-3.5"}),"Bulk Entry"]}),p&&(0,b.jsxs)(n.Button,{variant:"ghost",onClick:d,className:"gap-2 text-xs h-8 px-3 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/10",children:[(0,b.jsx)(m.Upload,{className:"h-3.5 w-3.5"}),"Import"]}),(0,b.jsx)("div",{className:"h-4 w-[1px] bg-slate-200 dark:bg-slate-700 mx-1"}),g&&(0,b.jsxs)(n.Button,{variant:"ghost",onClick:g,className:"gap-2 text-xs h-8 px-3 text-slate-600 dark:text-slate-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/10",children:[(0,b.jsx)(l.FileText,{className:"h-3.5 w-3.5"}),"CSV Export"]}),h&&(0,b.jsxs)(n.Button,{variant:"ghost",onClick:h,className:"gap-2 text-xs h-8 px-3 text-slate-600 dark:text-slate-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/10",children:[(0,b.jsx)(l.FileText,{className:"h-3.5 w-3.5"}),"PDF Export"]}),(0,b.jsx)("div",{className:"sm:hidden block ml-auto",children:(0,b.jsx)(F,{})})]})]})};var I=a.i(591119),J=a.i(400291);let K=({totalExpenses:a,thisMonthExpenses:c,transactionCount:d,formatCurrency:e,dateFilter:f})=>{let{canViewTotalExpenses:g}=(0,J.useFinancialVisibility)();return(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)(I.Card,{children:[(0,b.jsx)(I.CardHeader,{className:"pb-3",children:(0,b.jsxs)(I.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:["Total Expenses (","all"===f?"All Time":f.replace("-"," ").replace(/\b\w/g,a=>a.toUpperCase()),")"]})}),(0,b.jsx)(I.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-red-600",children:g?e(a):"•••"})})]}),(0,b.jsxs)(I.Card,{children:[(0,b.jsx)(I.CardHeader,{className:"pb-3",children:(0,b.jsx)(I.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"This Month"})}),(0,b.jsx)(I.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:g?e(c):"•••"})})]}),(0,b.jsxs)(I.Card,{children:[(0,b.jsx)(I.CardHeader,{className:"pb-3",children:(0,b.jsx)(I.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total Transactions"})}),(0,b.jsx)(I.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:d})})]})]})},L=({filteredExpenses:a,formatCurrency:c})=>(0,b.jsxs)(I.Card,{children:[(0,b.jsx)(I.CardHeader,{className:"pb-3 md:pb-6",children:(0,b.jsx)(I.CardTitle,{className:"text-lg md:text-xl",children:"Recent Expenses"})}),(0,b.jsx)(I.CardContent,{className:"px-3 md:px-6",children:0===a.length?(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"No expenses found for the selected period."})}):(0,b.jsx)("div",{className:"space-y-4",children:a.slice(0,10).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"font-medium",children:a.description}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.date.toLocaleDateString()," • ",a.category||"Uncategorized"]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"font-semibold text-red-600",children:c(a.amount)}),a.cashAccountId&&(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Linked to Cash"})]})]},a.id))})})]});var M=a.i(875083),N=a.i(424231),O=a.i(511486),P=a.i(298621),Q=a.i(488949),R=a.i(825428),S=a.i(137082),T=["points","className","baseLinePoints","connectNulls"];function U(){return(U=Object.assign.bind()).apply(this,arguments)}function V(a){return function(a){if(Array.isArray(a))return W(a)}(a)||function(a){if("u">typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||function(a,b){if(a){if("string"==typeof a)return W(a,void 0);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c)return Array.from(a);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return W(a,void 0)}}(a)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}var X=function(a){return a&&a.x===+a.x&&a.y===+a.y},Y=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],b=[[]];return a.forEach(function(a){X(a)?b[b.length-1].push(a):b[b.length-1].length>0&&b.push([])}),X(a[0])&&b[b.length-1].push(a[0]),b[b.length-1].length<=0&&(b=b.slice(0,-1)),b},Z=function(a,b){var c=Y(a);b&&(c=[c.reduce(function(a,b){return[].concat(V(a),V(b))},[])]);var d=c.map(function(a){return a.reduce(function(a,b,c){return"".concat(a).concat(0===c?"M":"L").concat(b.x,",").concat(b.y)},"")}).join("");return 1===c.length?"".concat(d,"Z"):d},$=function(a,b,c){var d=Z(a,c);return"".concat("Z"===d.slice(-1)?d.slice(0,-1):d,"L").concat(Z(b.reverse(),c).slice(1))},_=function(a){var b=a.points,d=a.className,e=a.baseLinePoints,f=a.connectNulls,g=function(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c={};for(var d in a)if(Object.prototype.hasOwnProperty.call(a,d)){if(b.indexOf(d)>=0)continue;c[d]=a[d]}return c}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(b.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}(a,T);if(!b||!b.length)return null;var h=(0,P.default)("recharts-polygon",d);if(e&&e.length){var i=g.stroke&&"none"!==g.stroke,j=$(b,e,f);return c.default.createElement("g",{className:h},c.default.createElement("path",U({},(0,S.filterProps)(g,!0),{fill:"Z"===j.slice(-1)?g.fill:"none",stroke:"none",d:j})),i?c.default.createElement("path",U({},(0,S.filterProps)(g,!0),{fill:"none",d:Z(b,f)})):null,i?c.default.createElement("path",U({},(0,S.filterProps)(g,!0),{fill:"none",d:Z(e,f)})):null)}var k=Z(b,f);return c.default.createElement("path",U({},(0,S.filterProps)(g,!0),{fill:"Z"===k.slice(-1)?g.fill:"none",className:h,d:k}))},aa=a.i(420299),ab=a.i(952517),ac=a.i(530261);function ad(a){return(ad="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function ae(){return(ae=Object.assign.bind()).apply(this,arguments)}function af(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function ag(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?af(Object(c),!0).forEach(function(b){al(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):af(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function ah(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,am(d.key),d)}}function ai(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(ai=function(){return!!a})()}function aj(a){return(aj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function ak(a,b){return(ak=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a})(a,b)}function al(a,b,c){return(b=am(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function am(a){var b=function(a,b){if("object"!=ad(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=ad(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==ad(b)?b:b+""}var an=Math.PI/180,ao=function(a){var b,d;function e(){var a,b;if(!(this instanceof e))throw TypeError("Cannot call a class as a function");return a=e,b=arguments,a=aj(a),function(a,b){if(b&&("object"===ad(b)||"function"==typeof b))return b;if(void 0!==b)throw TypeError("Derived constructors may only return object or undefined");var c=a;if(void 0===c)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(this,ai()?Reflect.construct(a,b||[],aj(this).constructor):a.apply(this,b))}if("function"!=typeof a&&null!==a)throw TypeError("Super expression must either be null or a function");return e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),a&&ak(e,a),b=[{key:"getTickLineCoord",value:function(a){var b=this.props,c=b.cx,d=b.cy,e=b.radius,f=b.orientation,g=b.tickSize,h=(0,ac.polarToCartesian)(c,d,e,a.coordinate),i=(0,ac.polarToCartesian)(c,d,e+("inner"===f?-1:1)*(g||8),a.coordinate);return{x1:h.x,y1:h.y,x2:i.x,y2:i.y}}},{key:"getTickTextAnchor",value:function(a){var b=this.props.orientation,c=Math.cos(-a.coordinate*an);return c>1e-5?"outer"===b?"start":"end":c<-1e-5?"outer"===b?"end":"start":"middle"}},{key:"renderAxisLine",value:function(){var a=this.props,b=a.cx,d=a.cy,e=a.radius,f=a.axisLine,g=a.axisLineType,h=ag(ag({},(0,S.filterProps)(this.props,!1)),{},{fill:"none"},(0,S.filterProps)(f,!1));if("circle"===g)return c.default.createElement(R.Dot,ae({className:"recharts-polar-angle-axis-line"},h,{cx:b,cy:d,r:e}));var i=this.props.ticks.map(function(a){return(0,ac.polarToCartesian)(b,d,e,a.coordinate)});return c.default.createElement(_,ae({className:"recharts-polar-angle-axis-line"},h,{points:i}))}},{key:"renderTicks",value:function(){var a=this,b=this.props,d=b.ticks,f=b.tick,g=b.tickLine,h=b.tickFormatter,i=b.stroke,j=(0,S.filterProps)(this.props,!1),k=(0,S.filterProps)(f,!1),l=ag(ag({},j),{},{fill:"none"},(0,S.filterProps)(g,!1)),m=d.map(function(b,d){var m=a.getTickLineCoord(b),n=ag(ag(ag({textAnchor:a.getTickTextAnchor(b)},j),{},{stroke:"none",fill:i},k),{},{index:d,payload:b,x:m.x2,y:m.y2});return c.default.createElement(Q.Layer,ae({className:(0,P.default)("recharts-polar-angle-axis-tick",(0,ac.getTickClassName)(f)),key:"tick-".concat(b.coordinate)},(0,ab.adaptEventsOfChild)(a.props,b,d)),g&&c.default.createElement("line",ae({className:"recharts-polar-angle-axis-tick-line"},l,m)),f&&e.renderTickItem(f,n,h?h(b.value,d):b.value))});return c.default.createElement(Q.Layer,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var a=this.props,b=a.ticks,d=a.radius,e=a.axisLine;return!(d<=0)&&b&&b.length?c.default.createElement(Q.Layer,{className:(0,P.default)("recharts-polar-angle-axis",this.props.className)},e&&this.renderAxisLine(),this.renderTicks()):null}}],d=[{key:"renderTickItem",value:function(a,b,d){return c.default.isValidElement(a)?c.default.cloneElement(a,b):(0,O.default)(a)?a(b):c.default.createElement(aa.Text,ae({},b,{className:"recharts-polar-angle-axis-tick-value"}),d)}}],b&&ah(e.prototype,b),d&&ah(e,d),Object.defineProperty(e,"prototype",{writable:!1}),e}(c.PureComponent);al(ao,"displayName","PolarAngleAxis"),al(ao,"axisType","angleAxis"),al(ao,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var ap=a.i(915589),aq=a.i(32965),ar=a.i(874668),as=["cx","cy","angle","ticks","axisLine"],at=["ticks","tick","angle","tickFormatter","stroke"];function au(a){return(au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function av(){return(av=Object.assign.bind()).apply(this,arguments)}function aw(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function ax(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?aw(Object(c),!0).forEach(function(b){aD(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):aw(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function ay(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c={};for(var d in a)if(Object.prototype.hasOwnProperty.call(a,d)){if(b.indexOf(d)>=0)continue;c[d]=a[d]}return c}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(b.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}function az(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,aE(d.key),d)}}function aA(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(aA=function(){return!!a})()}function aB(a){return(aB=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function aC(a,b){return(aC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a})(a,b)}function aD(a,b,c){return(b=aE(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function aE(a){var b=function(a,b){if("object"!=au(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=au(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==au(b)?b:b+""}var aF=function(a){var b,d;function e(){var a,b;if(!(this instanceof e))throw TypeError("Cannot call a class as a function");return a=e,b=arguments,a=aB(a),function(a,b){if(b&&("object"===au(b)||"function"==typeof b))return b;if(void 0!==b)throw TypeError("Derived constructors may only return object or undefined");var c=a;if(void 0===c)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(this,aA()?Reflect.construct(a,b||[],aB(this).constructor):a.apply(this,b))}if("function"!=typeof a&&null!==a)throw TypeError("Super expression must either be null or a function");return e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),a&&aC(e,a),b=[{key:"getTickValueCoord",value:function(a){var b=a.coordinate,c=this.props,d=c.angle,e=c.cx,f=c.cy;return(0,ac.polarToCartesian)(e,f,b,d)}},{key:"getTickTextAnchor",value:function(){var a;switch(this.props.orientation){case"left":a="end";break;case"right":a="start";break;default:a="middle"}return a}},{key:"getViewBox",value:function(){var a=this.props,b=a.cx,c=a.cy,d=a.angle,e=a.ticks,f=(0,ap.default)(e,function(a){return a.coordinate||0});return{cx:b,cy:c,startAngle:d,endAngle:d,innerRadius:(0,aq.default)(e,function(a){return a.coordinate||0}).coordinate||0,outerRadius:f.coordinate||0}}},{key:"renderAxisLine",value:function(){var a=this.props,b=a.cx,d=a.cy,e=a.angle,f=a.ticks,g=a.axisLine,h=ay(a,as),i=f.reduce(function(a,b){return[Math.min(a[0],b.coordinate),Math.max(a[1],b.coordinate)]},[1/0,-1/0]),j=(0,ac.polarToCartesian)(b,d,i[0],e),k=(0,ac.polarToCartesian)(b,d,i[1],e),l=ax(ax(ax({},(0,S.filterProps)(h,!1)),{},{fill:"none"},(0,S.filterProps)(g,!1)),{},{x1:j.x,y1:j.y,x2:k.x,y2:k.y});return c.default.createElement("line",av({className:"recharts-polar-radius-axis-line"},l))}},{key:"renderTicks",value:function(){var a=this,b=this.props,d=b.ticks,f=b.tick,g=b.angle,h=b.tickFormatter,i=b.stroke,j=ay(b,at),k=this.getTickTextAnchor(),l=(0,S.filterProps)(j,!1),m=(0,S.filterProps)(f,!1),n=d.map(function(b,d){var j=a.getTickValueCoord(b),n=ax(ax(ax(ax({textAnchor:k,transform:"rotate(".concat(90-g,", ").concat(j.x,", ").concat(j.y,")")},l),{},{stroke:"none",fill:i},m),{},{index:d},j),{},{payload:b});return c.default.createElement(Q.Layer,av({className:(0,P.default)("recharts-polar-radius-axis-tick",(0,ac.getTickClassName)(f)),key:"tick-".concat(b.coordinate)},(0,ab.adaptEventsOfChild)(a.props,b,d)),e.renderTickItem(f,n,h?h(b.value,d):b.value))});return c.default.createElement(Q.Layer,{className:"recharts-polar-radius-axis-ticks"},n)}},{key:"render",value:function(){var a=this.props,b=a.ticks,d=a.axisLine,e=a.tick;return b&&b.length?c.default.createElement(Q.Layer,{className:(0,P.default)("recharts-polar-radius-axis",this.props.className)},d&&this.renderAxisLine(),e&&this.renderTicks(),ar.Label.renderCallByParent(this.props,this.getViewBox())):null}}],d=[{key:"renderTickItem",value:function(a,b,d){return c.default.isValidElement(a)?c.default.cloneElement(a,b):(0,O.default)(a)?a(b):c.default.createElement(aa.Text,av({},b,{className:"recharts-polar-radius-axis-tick-value"}),d)}}],b&&az(e.prototype,b),d&&az(e,d),Object.defineProperty(e,"prototype",{writable:!1}),e}(c.PureComponent);aD(aF,"displayName","PolarRadiusAxis"),aD(aF,"axisType","radiusAxis"),aD(aF,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});var aG=a.i(517615),aH=a.i(81219),aI=a.i(159368),aJ=a.i(398612),aK=a.i(813667),aL=a.i(736319),aM=a.i(467149),aN=a.i(902321),aO=a.i(768932),aP=a.i(747838),aQ=a.i(780407),aR=a.i(156998);function aS(a){return(aS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function aT(){return(aT=Object.assign.bind()).apply(this,arguments)}function aU(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function aV(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?aU(Object(c),!0).forEach(function(b){a$(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):aU(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function aW(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,a_(d.key),d)}}function aX(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(aX=function(){return!!a})()}function aY(a){return(aY=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function aZ(a,b){return(aZ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a})(a,b)}function a$(a,b,c){return(b=a_(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function a_(a){var b=function(a,b){if("object"!=aS(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=aS(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==aS(b)?b:b+""}var a0=function(a){var b,d;function e(a){var b,c,d;if(!(this instanceof e))throw TypeError("Cannot call a class as a function");return c=e,d=[a],c=aY(c),a$(b=function(a,b){if(b&&("object"===aS(b)||"function"==typeof b))return b;if(void 0!==b)throw TypeError("Derived constructors may only return object or undefined");var c=a;if(void 0===c)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(this,aX()?Reflect.construct(c,d||[],aY(this).constructor):c.apply(this,d)),"pieRef",null),a$(b,"sectorRefs",[]),a$(b,"id",(0,aO.uniqueId)("recharts-pie-")),a$(b,"handleAnimationEnd",function(){var a=b.props.onAnimationEnd;b.setState({isAnimationFinished:!0}),(0,O.default)(a)&&a()}),a$(b,"handleAnimationStart",function(){var a=b.props.onAnimationStart;b.setState({isAnimationFinished:!1}),(0,O.default)(a)&&a()}),b.state={isAnimationFinished:!a.isAnimationActive,prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,sectorToFocus:0},b}if("function"!=typeof a&&null!==a)throw TypeError("Super expression must either be null or a function");return e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),a&&aZ(e,a),b=[{key:"isActiveIndex",value:function(a){var b=this.props.activeIndex;return Array.isArray(b)?-1!==b.indexOf(a):a===b}},{key:"hasActiveIndex",value:function(){var a=this.props.activeIndex;return Array.isArray(a)?0!==a.length:a||0===a}},{key:"renderLabels",value:function(a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var b=this.props,d=b.label,f=b.labelLine,g=b.dataKey,h=b.valueKey,i=(0,S.filterProps)(this.props,!1),j=(0,S.filterProps)(d,!1),k=(0,S.filterProps)(f,!1),l=d&&d.offsetRadius||20,m=a.map(function(a,b){var m=(a.startAngle+a.endAngle)/2,n=(0,ac.polarToCartesian)(a.cx,a.cy,a.outerRadius+l,m),o=aV(aV(aV(aV({},i),a),{},{stroke:"none"},j),{},{index:b,textAnchor:e.getTextAnchor(n.x,a.cx)},n),p=aV(aV(aV(aV({},i),a),{},{fill:"none",stroke:a.fill},k),{},{index:b,points:[(0,ac.polarToCartesian)(a.cx,a.cy,a.outerRadius,m),n]}),q=g;return(0,aJ.default)(g)&&(0,aJ.default)(h)?q="value":(0,aJ.default)(g)&&(q=h),c.default.createElement(Q.Layer,{key:"label-".concat(a.startAngle,"-").concat(a.endAngle,"-").concat(a.midAngle,"-").concat(b)},f&&e.renderLabelLineItem(f,p,"line"),e.renderLabelItem(d,o,(0,aP.getValueByDataKey)(a,q)))});return c.default.createElement(Q.Layer,{className:"recharts-pie-labels"},m)}},{key:"renderSectorsStatically",value:function(a){var b=this,d=this.props,e=d.activeShape,f=d.blendStroke,g=d.inactiveShape;return a.map(function(d,h){if((null==d?void 0:d.startAngle)===0&&(null==d?void 0:d.endAngle)===0&&1!==a.length)return null;var i=b.isActiveIndex(h),j=g&&b.hasActiveIndex()?g:null,k=aV(aV({},d),{},{stroke:f?d.fill:d.stroke,tabIndex:-1});return c.default.createElement(Q.Layer,aT({ref:function(a){a&&!b.sectorRefs.includes(a)&&b.sectorRefs.push(a)},tabIndex:-1,className:"recharts-pie-sector"},(0,ab.adaptEventsOfChild)(b.props,d,h),{key:"sector-".concat(null==d?void 0:d.startAngle,"-").concat(null==d?void 0:d.endAngle,"-").concat(d.midAngle,"-").concat(h)}),c.default.createElement(aR.Shape,aT({option:i?e:j,isActive:i,shapeType:"sector"},k)))})}},{key:"renderSectorsWithAnimation",value:function(){var a=this,b=this.props,d=b.sectors,e=b.isAnimationActive,f=b.animationBegin,g=b.animationDuration,h=b.animationEasing,i=b.animationId,j=this.state,k=j.prevSectors,l=j.prevIsAnimationActive;return c.default.createElement(aG.default,{begin:f,duration:g,isActive:e,easing:h,from:{t:0},to:{t:1},key:"pie-".concat(i,"-").concat(l),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(b){var e=b.t,f=[],g=(d&&d[0]).startAngle;return d.forEach(function(a,b){var c=k&&k[b],d=b>0?(0,aH.default)(a,"paddingAngle",0):0;if(c){var h=(0,aO.interpolateNumber)(c.endAngle-c.startAngle,a.endAngle-a.startAngle),i=aV(aV({},a),{},{startAngle:g+d,endAngle:g+h(e)+d});f.push(i),g=i.endAngle}else{var j=a.endAngle,l=a.startAngle,m=(0,aO.interpolateNumber)(0,j-l)(e),n=aV(aV({},a),{},{startAngle:g+d,endAngle:g+m+d});f.push(n),g=n.endAngle}}),c.default.createElement(Q.Layer,null,a.renderSectorsStatically(f))})}},{key:"attachKeyboardHandlers",value:function(a){var b=this;a.onkeydown=function(a){if(!a.altKey)switch(a.key){case"ArrowLeft":var c=++b.state.sectorToFocus%b.sectorRefs.length;b.sectorRefs[c].focus(),b.setState({sectorToFocus:c});break;case"ArrowRight":var d=--b.state.sectorToFocus<0?b.sectorRefs.length-1:b.state.sectorToFocus%b.sectorRefs.length;b.sectorRefs[d].focus(),b.setState({sectorToFocus:d});break;case"Escape":b.sectorRefs[b.state.sectorToFocus].blur(),b.setState({sectorToFocus:0})}}}},{key:"renderSectors",value:function(){var a=this.props,b=a.sectors,c=a.isAnimationActive,d=this.state.prevSectors;return c&&b&&b.length&&(!d||!(0,aI.default)(d,b))?this.renderSectorsWithAnimation():this.renderSectorsStatically(b)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var a=this,b=this.props,d=b.hide,e=b.sectors,f=b.className,g=b.label,h=b.cx,i=b.cy,j=b.innerRadius,k=b.outerRadius,l=b.isAnimationActive,m=this.state.isAnimationFinished;if(d||!e||!e.length||!(0,aO.isNumber)(h)||!(0,aO.isNumber)(i)||!(0,aO.isNumber)(j)||!(0,aO.isNumber)(k))return null;var n=(0,P.default)("recharts-pie",f);return c.default.createElement(Q.Layer,{tabIndex:this.props.rootTabIndex,className:n,ref:function(b){a.pieRef=b}},this.renderSectors(),g&&this.renderLabels(e),ar.Label.renderCallByParent(this.props,null,!1),(!l||m)&&aL.LabelList.renderCallByParent(this.props,e,!1))}}],d=[{key:"getDerivedStateFromProps",value:function(a,b){return b.prevIsAnimationActive!==a.isAnimationActive?{prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:[],isAnimationFinished:!0}:a.isAnimationActive&&a.animationId!==b.prevAnimationId?{prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:b.curSectors,isAnimationFinished:!0}:a.sectors!==b.curSectors?{curSectors:a.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(a,b){return a>b?"start":a<b?"end":"middle"}},{key:"renderLabelLineItem",value:function(a,b,d){if(c.default.isValidElement(a))return c.default.cloneElement(a,b);if((0,O.default)(a))return a(b);var e=(0,P.default)("recharts-pie-label-line","boolean"!=typeof a?a.className:"");return c.default.createElement(aK.Curve,aT({},b,{key:d,type:"linear",className:e}))}},{key:"renderLabelItem",value:function(a,b,d){if(c.default.isValidElement(a))return c.default.cloneElement(a,b);var e=d;if((0,O.default)(a)&&(e=a(b),c.default.isValidElement(e)))return e;var f=(0,P.default)("recharts-pie-label-text","boolean"==typeof a||(0,O.default)(a)?"":a.className);return c.default.createElement(aa.Text,aT({},b,{alignmentBaseline:"middle",className:f}),e)}}],b&&aW(e.prototype,b),d&&aW(e,d),Object.defineProperty(e,"prototype",{writable:!1}),e}(c.PureComponent);a$(a0,"displayName","Pie"),a$(a0,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!aN.Global.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0}),a$(a0,"parseDeltaAngle",function(a,b){return(0,aO.mathSign)(b-a)*Math.min(Math.abs(b-a),360)}),a$(a0,"getRealPieData",function(a){var b=a.data,c=a.children,d=(0,S.filterProps)(a,!1),e=(0,S.findAllByType)(c,aM.Cell);return b&&b.length?b.map(function(a,b){return aV(aV(aV({payload:a},d),a),e&&e[b]&&e[b].props)}):e&&e.length?e.map(function(a){return aV(aV({},d),a.props)}):[]}),a$(a0,"parseCoordinateOfPie",function(a,b){var c=b.top,d=b.left,e=b.width,f=b.height,g=(0,ac.getMaxRadius)(e,f);return{cx:d+(0,aO.getPercentValue)(a.cx,e,e/2),cy:c+(0,aO.getPercentValue)(a.cy,f,f/2),innerRadius:(0,aO.getPercentValue)(a.innerRadius,g,0),outerRadius:(0,aO.getPercentValue)(a.outerRadius,g,.8*g),maxRadius:a.maxRadius||Math.sqrt(e*e+f*f)/2}}),a$(a0,"getComposedData",function(a){var b,c,d=a.item,e=a.offset,f=void 0!==d.type.defaultProps?aV(aV({},d.type.defaultProps),d.props):d.props,g=a0.getRealPieData(f);if(!g||!g.length)return null;var h=f.cornerRadius,i=f.startAngle,j=f.endAngle,k=f.paddingAngle,l=f.dataKey,m=f.nameKey,n=f.valueKey,o=f.tooltipType,p=Math.abs(f.minAngle),q=a0.parseCoordinateOfPie(f,e),r=a0.parseDeltaAngle(i,j),s=Math.abs(r),t=l;(0,aJ.default)(l)&&(0,aJ.default)(n)?((0,aQ.warn)(!1,'Use "dataKey" to specify the value of pie,\n      the props "valueKey" will be deprecated in 1.1.0'),t="value"):(0,aJ.default)(l)&&((0,aQ.warn)(!1,'Use "dataKey" to specify the value of pie,\n      the props "valueKey" will be deprecated in 1.1.0'),t=n);var u=g.filter(function(a){return 0!==(0,aP.getValueByDataKey)(a,t,0)}).length,v=s-u*p-(s>=360?u:u-1)*k,w=g.reduce(function(a,b){var c=(0,aP.getValueByDataKey)(b,t,0);return a+((0,aO.isNumber)(c)?c:0)},0);return w>0&&(b=g.map(function(a,b){var d,e=(0,aP.getValueByDataKey)(a,t,0),f=(0,aP.getValueByDataKey)(a,m,b),g=((0,aO.isNumber)(e)?e:0)/w,j=(d=b?c.endAngle+(0,aO.mathSign)(r)*k*(0!==e):i)+(0,aO.mathSign)(r)*((0!==e?p:0)+g*v),l=(d+j)/2,n=(q.innerRadius+q.outerRadius)/2,s=[{name:f,value:e,payload:a,dataKey:t,type:o}],u=(0,ac.polarToCartesian)(q.cx,q.cy,n,l);return c=aV(aV(aV({percent:g,cornerRadius:h,name:f,tooltipPayload:s,midAngle:l,middleRadius:n,tooltipPosition:u},a),q),{},{value:(0,aP.getValueByDataKey)(a,t),startAngle:d,endAngle:j,payload:a,paddingAngle:(0,aO.mathSign)(r)*k})})),aV(aV({},q),{},{sectors:b,data:g})});var a1=(0,N.generateCategoricalChart)({chartName:"PieChart",GraphicalChild:a0,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:ao},{axisType:"radiusAxis",AxisComp:aF}],formatAxisMap:ac.formatAxisMap,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),a2=a.i(48662),a3=a.i(659854);let a4=["#9b87f5","#7E69AB","#6E59A5","#D6BCFA","#E5DEFF","#0EA5E9","#F97316","#D946EF","#F2FCE2","#FEF7CD","#FEC6A1","#FFDEE2","#FDE1D3","#D3E4FD","#F1F0FB"],a5=({expenses:a,formatCurrency:d})=>{let{canViewTotalExpenses:e}=(0,J.useFinancialVisibility)(),[f,g]=(0,c.useState)("category"),h=(0,c.useMemo)(()=>{let b=a.reduce((a,b)=>a+b.amount,0);if("category"===f){let c=new Map;return a.forEach(a=>{let b=(a.category||"Uncategorized").toLowerCase().trim(),d=c.get(b);d?(d.total+=a.amount,d.count+=1):c.set(b,{total:a.amount,count:1})}),Array.from(c.entries()).map(([a,{total:c,count:d}])=>({name:a.charAt(0).toUpperCase()+a.slice(1),value:c,percentage:c/b*100,count:d})).sort((a,b)=>b.value-a.value)}{let c=new Map;return a.forEach(a=>{let b=(a.personInCharge||"Unassigned").toLowerCase().trim(),d=c.get(b);d?(d.total+=a.amount,d.count+=1):c.set(b,{total:a.amount,count:1})}),Array.from(c.entries()).map(([a,{total:c,count:d}])=>({name:a.charAt(0).toUpperCase()+a.slice(1),value:c,percentage:c/b*100,count:d})).sort((a,b)=>b.value-a.value)}},[a,f]);return(0,b.jsxs)(I.Card,{className:"mt-6",children:[(0,b.jsx)(I.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsx)(I.CardTitle,{className:"text-lg sm:text-xl",children:"Expense Distribution"}),(0,b.jsx)(M.Tabs,{value:f,onValueChange:a=>g(a),className:"w-full sm:w-auto",children:(0,b.jsxs)(M.TabsList,{className:"grid w-full grid-cols-2",children:[(0,b.jsx)(M.TabsTrigger,{value:"category",children:"By Category"}),(0,b.jsx)(M.TabsTrigger,{value:"person",children:"By Person"})]})})]})}),(0,b.jsx)(I.CardContent,{className:"pt-2",children:h.length>0?(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row space-y-6 lg:space-y-0 lg:space-x-4",children:[(0,b.jsxs)("div",{className:"w-full lg:w-1/2 flex flex-col items-center",children:[(0,b.jsx)("div",{className:"h-[220px] sm:h-[260px] w-full max-w-[280px] mx-auto",children:(0,b.jsx)(a2.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(a1,{margin:{top:5,right:5,bottom:5,left:5},children:[(0,b.jsx)(a0,{data:h,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,innerRadius:36,paddingAngle:1.5,dataKey:"value",stroke:"#ffffff",strokeWidth:1.5,children:h.map((a,c)=>(0,b.jsx)(aM.Cell,{fill:a4[c%a4.length],className:"hover:opacity-80 transition-opacity"},`cell-${c}`))}),(0,b.jsx)(a3.Tooltip,{content:(0,b.jsx)(({active:a,payload:c})=>{if(a&&c&&c.length){let a=c[0].payload;return(0,b.jsxs)("div",{className:"bg-card p-3 shadow rounded border border-border text-sm",children:[(0,b.jsx)("p",{className:"font-medium text-foreground",children:a.name}),(0,b.jsx)("p",{className:"text-primary",children:e?d(a.value):"•••"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:[a.percentage.toFixed(1),"% of total"]}),(0,b.jsxs)("p",{className:"text-xs",children:[a.count," expense",1!==a.count?"s":""]})]})}return null},{})})]})})}),(0,b.jsx)("div",{className:"mt-2 text-xs text-center text-muted-foreground",children:(0,b.jsx)("p",{children:"Tap segments for details"})})]}),(0,b.jsx)("div",{className:"w-full lg:w-1/2",children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("h3",{className:"text-sm font-medium mb-1.5 px-1",children:["category"===f?"Categories":"People"," Breakdown"]}),(0,b.jsx)("div",{className:"space-y-0 max-h-[220px] sm:max-h-[260px] overflow-y-auto pr-1 rounded-md",children:h.map((a,c)=>(0,b.jsxs)("div",{className:"flex justify-between items-center border-b border-border/40 py-2 px-1 hover:bg-muted/50 rounded-sm transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-1.5",children:[(0,b.jsx)("div",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{backgroundColor:a4[c%a4.length]}}),(0,b.jsx)("span",{className:"truncate max-w-[120px] sm:max-w-[160px] text-xs sm:text-sm",children:a.name})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"font-medium text-xs sm:text-sm",children:e?d(a.value):"•••"}),(0,b.jsxs)("div",{className:"text-[10px] sm:text-xs text-muted-foreground",children:[a.percentage.toFixed(1),"%"]})]})]},c))})]})})]}):(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center h-[160px] sm:h-[200px] text-center text-muted-foreground",children:[(0,b.jsx)("p",{className:"text-sm",children:"No expense data available."}),(0,b.jsx)("p",{className:"text-xs mt-2",children:"Try a different date range or add some expenses."})]})})]})};var a6=a.i(177156),a7=a.i(824569),a8=a.i(587532),a9=a.i(206015),ba=a.i(291914),bb=a.i(625361),bc=a.i(633508),bd=a.i(847449);let be=({expense:a,open:d,onOpenChange:e,formatCurrency:f,accounts:g})=>{let h=(0,G.useIsMobile)(),[i,j]=(0,c.useState)(!1);if(!a)return null;let k=(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Date"}),(0,b.jsx)("p",{className:"text-sm",children:a.date.toLocaleDateString()})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Amount"}),(0,b.jsx)("p",{className:"text-lg font-semibold text-red-600",children:f(a.amount)})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Description"}),(0,b.jsx)("p",{className:"text-sm",children:a.description})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Category"}),a.category?(0,b.jsx)(E.Badge,{variant:"secondary",children:a.category}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Not specified"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Payment Method"}),(0,b.jsx)("p",{className:"text-sm",children:a.paymentMethod||"Not specified"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Person in Charge"}),(0,b.jsx)("p",{className:"text-sm",children:a.personInCharge||"Not specified"})]}),a.cashAccountId&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Cash Account"}),(0,b.jsx)(E.Badge,{variant:"outline",children:(a=>{if(!a)return null;let b=g.find(b=>b.id===a);return b?.name||"Unknown Account"})(a.cashAccountId)})]}),a.receiptImage&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Receipt"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:a.receiptImage,alt:"Receipt",className:"max-w-full h-32 object-contain border rounded cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>j(!0)}),(0,b.jsx)(n.Button,{variant:"secondary",size:"sm",className:"absolute top-2 right-2 opacity-80 hover:opacity-100",onClick:()=>j(!0),children:(0,b.jsx)(a6.Eye,{className:"h-4 w-4"})})]})]})]});return h?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(bb.Drawer,{open:d,onOpenChange:e,children:(0,b.jsx)(bb.DrawerContent,{className:"max-h-[85vh]",children:(0,b.jsxs)("div",{className:"relative px-4 py-6 pb-8",children:[(0,b.jsxs)(bb.DrawerClose,{className:"absolute right-4 top-4 rounded-sm opacity-70 hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring",children:[(0,b.jsx)(bc.X,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,b.jsx)(bb.DrawerHeader,{className:"px-0 pb-4",children:(0,b.jsx)(bb.DrawerTitle,{className:"text-lg",children:"Expense Details"})}),(0,b.jsx)(D.ScrollArea,{className:"h-[calc(85vh-120px)] pr-4",children:k})]})})}),a.receiptImage&&(0,b.jsx)(bd.default,{isOpen:i,onOpenChange:j,imageUrl:a.receiptImage,imageAlt:"Receipt image"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(B.Dialog,{open:d,onOpenChange:e,children:(0,b.jsxs)(B.DialogContent,{className:"sm:max-w-[600px] max-h-[90vh]",children:[(0,b.jsx)(B.DialogHeader,{children:(0,b.jsx)(B.DialogTitle,{children:"Expense Details"})}),(0,b.jsx)(D.ScrollArea,{className:"max-h-[70vh] pr-4",children:k})]})}),a.receiptImage&&(0,b.jsx)(bd.default,{isOpen:i,onOpenChange:j,imageUrl:a.receiptImage,imageAlt:"Receipt image"})]})};var bf=a.i(429246),bg=a.i(563658),bh=a.i(320146),bi=a.i(599209),bj=a.i(580701),bk=a.i(730769),bl=a.i(256711);let bm=({open:a,onOpenChange:e,onSubmit:f,initialData:h,title:j="Add New Expense"})=>{let[k,m]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,z]=(0,c.useState)(new Date),[C,E]=(0,c.useState)(""),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(!1),[S,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)(null),{accounts:W}=(0,ba.useCashAccounts)(),{categories:X,createCategory:Y}=w(),{toast:Z}=(0,o.useToast)(),{user:$}=(0,d.useAuth)();$?.id,(0,c.useEffect)(()=>{a&&h?(m(h.amount?.toString()||""),q(h.description||""),s(h.category||""),z(h.date||new Date),E(h.paymentMethod||""),H(h.personInCharge||""),J(h.receiptImage||""),L(h.linkToCash||!1),N(h.cashAccountId||""),V(null)):a&&!h&&(m(""),q(""),s(""),z(new Date),E(""),H(""),J(""),L(!1),N(""),V(null))},[a,h]);let _=async a=>{if(a.preventDefault(),!k||!p)return void Z({title:"Error",description:"Amount and description are required",variant:"destructive"});if(K&&!M)return void Z({title:"Error",description:"Please select a cash account when linking to cash",variant:"destructive"});P(!0);try{console.log("ExpenseForm: Submitting expense with linkToCash:",K,"cashAccountId:",M),U&&console.warn("Receipt file upload skipped – no storage backend configured.");let a={amount:parseFloat(k),description:p,category:r||void 0,date:v,paymentMethod:C||void 0,personInCharge:G||void 0,receiptImage:I||void 0,linkToCash:K,cashAccountId:K?M:void 0};console.log("ExpenseForm: Final expense data:",a),await f(a),e(!1)}catch(a){console.error("Error submitting expense:",a)}finally{P(!1)}},aa=()=>{J("")},ab=async()=>{if(!t.trim())return void Z({title:"Error",description:"Please enter a category name",variant:"destructive"});T(!0);try{let a=await Y(t.trim());a&&(s(a.name),u(""),Z({title:"Success",description:"Category created successfully"}))}catch(a){console.error("Error creating category:",a)}finally{T(!1)}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(B.Dialog,{open:a,onOpenChange:e,children:(0,b.jsxs)(B.DialogContent,{className:"sm:max-w-md max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)(B.DialogHeader,{children:(0,b.jsx)(B.DialogTitle,{children:j})}),(0,b.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(y.Label,{htmlFor:"amount",children:"Amount *"}),(0,b.jsx)(x.Input,{id:"amount",type:"number",step:"0.01",value:k,onChange:a=>m(a.target.value),onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),document.getElementById("description")?.focus())},placeholder:"0.00",disabled:O})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(y.Label,{htmlFor:"description",children:"Description *"}),(0,b.jsx)(bf.Textarea,{id:"description",value:p,onChange:a=>q(a.target.value),onKeyDown:a=>{if("Enter"===a.key&&!a.shiftKey){a.preventDefault();let b=document.querySelector('button[data-category-select="true"]');b?b.focus():document.getElementById("newCategory")?.focus()}},placeholder:"Enter expense description",disabled:O})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(y.Label,{children:"Category"}),(0,b.jsxs)(n.Button,{type:"button",variant:"outline",className:"w-full justify-start text-left font-normal",onClick:()=>R(!0),"data-category-select":"true",onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),document.getElementById("newCategory")?.focus())},disabled:O,children:[(0,b.jsx)(A.Tag,{className:"mr-2 h-4 w-4"}),r||"Select Category"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(y.Label,{htmlFor:"newCategory",children:"Create New Category"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(x.Input,{id:"newCategory",value:t,onChange:a=>u(a.target.value),onKeyDown:a=>{if("Enter"===a.key){a.preventDefault();let b=document.querySelector('button[data-date-picker="true"]');b?.focus()}},placeholder:"Enter new category name",disabled:O||S}),(0,b.jsx)(n.Button,{type:"button",onClick:ab,disabled:!t.trim()||O||S,size:"sm",children:(0,b.jsx)(i.Plus,{className:"h-4 w-4"})})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(y.Label,{children:"Date"}),(0,b.jsxs)(bi.Popover,{children:[(0,b.jsx)(bi.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(n.Button,{variant:"outline",className:(0,g.cn)("w-full justify-start text-left font-normal",!v&&"text-muted-foreground"),"data-date-picker":"true",onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),document.getElementById("paymentMethod")?.focus())},disabled:O,children:[(0,b.jsx)(bk.CalendarIcon,{className:"mr-2 h-4 w-4"}),v?(0,bl.format)(v,"PPP"):(0,b.jsx)("span",{children:"Pick a date"})]})}),(0,b.jsx)(bi.PopoverContent,{className:"w-auto p-0",children:(0,b.jsx)(bh.Calendar,{mode:"single",selected:v,onSelect:a=>a&&z(a),initialFocus:!0})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(y.Label,{htmlFor:"paymentMethod",children:"Payment Method"}),(0,b.jsx)(x.Input,{id:"paymentMethod",value:C,onChange:a=>E(a.target.value),onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),document.getElementById("personInCharge")?.focus())},placeholder:"Enter payment method (e.g., Cash, Credit Card, etc.)",disabled:O})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(y.Label,{htmlFor:"personInCharge",children:"Person in Charge"}),(0,b.jsx)(x.Input,{id:"personInCharge",value:G,onChange:a=>H(a.target.value),onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),document.getElementById("receipt")?.focus())},placeholder:"Enter person responsible",disabled:O})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(y.Label,{htmlFor:"receipt",children:"Receipt (Image or PDF)"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(x.Input,{id:"receipt",type:"file",accept:"image/*,.pdf",onChange:a=>{let b=a.target.files?.[0];if(b){let a=b.type.startsWith("image/"),c="application/pdf"===b.type;if(!a&&!c)return void Z({title:"Error",description:"Please select an image or PDF file",variant:"destructive"});V(b),J(URL.createObjectURL(b))}},disabled:O}),I&&(0,b.jsx)("div",{className:"relative inline-block",children:I&&I.includes("pdf")?(0,b.jsxs)("div",{className:"flex items-center gap-2 p-2 border rounded",children:[(0,b.jsx)(l.FileText,{className:"h-8 w-8 text-red-600"}),(0,b.jsx)("span",{className:"text-sm",children:"PDF Receipt"}),(0,b.jsx)(n.Button,{type:"button",variant:"destructive",size:"sm",className:"ml-auto h-6 w-6 rounded-full p-0",onClick:aa,disabled:O,children:(0,b.jsx)(bc.X,{className:"h-3 w-3"})})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("img",{src:I,alt:"Receipt",className:"w-20 h-20 object-cover rounded border"}),(0,b.jsx)(n.Button,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0",onClick:aa,disabled:O,children:(0,b.jsx)(bc.X,{className:"h-3 w-3"})})]})})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(bg.Switch,{id:"linkToCash",checked:K,onCheckedChange:L,disabled:O}),(0,b.jsx)(y.Label,{htmlFor:"linkToCash",children:"Link to Cash Account"})]}),K&&(0,b.jsxs)("div",{children:[(0,b.jsx)(y.Label,{htmlFor:"cashAccount",children:"Cash Account"}),(0,b.jsxs)(bj.Select,{value:M,onValueChange:a=>{N(a),setTimeout(()=>{let a=document.querySelector('button[type="submit"]');a?.focus()},100)},disabled:O,children:[(0,b.jsx)(bj.SelectTrigger,{onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),setTimeout(()=>{let a=document.querySelector('button[type="submit"]');a?.focus()},100))},children:(0,b.jsx)(bj.SelectValue,{placeholder:"Select cash account"})}),(0,b.jsx)(bj.SelectContent,{children:W.map(a=>(0,b.jsx)(bj.SelectItem,{value:a.id,children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>e(!1),disabled:O,children:"Cancel"}),(0,b.jsx)(n.Button,{type:"submit",disabled:O,children:O?"Saving...":"Save Expense"})]})]})]})}),(0,b.jsx)(B.Dialog,{open:Q,onOpenChange:R,children:(0,b.jsxs)(B.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsx)(B.DialogHeader,{children:(0,b.jsx)(B.DialogTitle,{children:"Select Category"})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(D.ScrollArea,{className:"h-64 rounded-md border p-4",children:(0,b.jsx)("div",{className:"space-y-2",children:X.map(a=>(0,b.jsxs)(n.Button,{variant:"ghost",className:"w-full justify-start",onClick:()=>{s(a.name),R(!1)},children:[(0,b.jsx)(A.Tag,{className:"mr-2 h-4 w-4"}),a.name]},a.id))})}),(0,b.jsx)(F,{}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)(n.Button,{variant:"outline",onClick:()=>R(!1),children:"Cancel"})})]})]})})]})},bn=({expense:a,open:c,onOpenChange:d,onSubmit:e})=>{if(!a)return null;let f={amount:a.amount,description:a.description,category:a.category||"",date:a.date,paymentMethod:a.paymentMethod||"",personInCharge:a.personInCharge||"",receiptImage:a.receiptImage||"",linkToCash:!!a.cashAccountId,cashAccountId:a.cashAccountId||""},g=async a=>{console.log("EditExpenseDialog handleSubmit data:",a),await e(a)};return(0,b.jsx)(bm,{open:c,onOpenChange:d,onSubmit:g,initialData:f,title:"Edit Expense"})},bo=({expense:a,open:c,onOpenChange:d,onConfirm:e,formatCurrency:f})=>a?(0,b.jsx)(C.AlertDialog,{open:c,onOpenChange:d,children:(0,b.jsxs)(C.AlertDialogContent,{children:[(0,b.jsxs)(C.AlertDialogHeader,{children:[(0,b.jsx)(C.AlertDialogTitle,{children:"Delete Expense"}),(0,b.jsxs)(C.AlertDialogDescription,{className:"space-y-2",children:[(0,b.jsx)("div",{children:"Are you sure you want to delete this expense?"}),(0,b.jsxs)("div",{className:"p-3 bg-muted rounded-md",children:[(0,b.jsx)("div",{className:"font-medium",children:a.description}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[f(a.amount)," • ",a.date.toLocaleDateString()]})]}),(0,b.jsx)("div",{className:"text-sm text-destructive",children:"This action cannot be undone."})]})]}),(0,b.jsxs)(C.AlertDialogFooter,{children:[(0,b.jsx)(C.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(C.AlertDialogAction,{onClick:e,className:"bg-destructive hover:bg-destructive/90",children:"Delete Expense"})]})]})}):null;var bp=a.i(890914);let bq=({expenses:a,onUpdateExpense:d,onDeleteExpense:e,formatCurrency:h})=>{let i=(0,G.useIsMobile)(),{accounts:j}=(0,ba.useCashAccounts)(),{settings:k}=(0,f.useBusinessSettings)(),{canViewTotalExpenses:l}=(0,J.useFinancialVisibility)(),{hasPermission:m}=(0,bp.useProfiles)(),o=k.currency||"USD",[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),[y,A]=(0,c.useState)(!1),B=a.filter(a=>a.description.toLowerCase().includes(p.toLowerCase())||a.category&&a.category.toLowerCase().includes(p.toLowerCase())||a.paymentMethod&&a.paymentMethod.toLowerCase().includes(p.toLowerCase())||a.personInCharge&&a.personInCharge.toLowerCase().includes(p.toLowerCase())),C=a=>{if(!a)return null;let b=j.find(b=>b.id===a);return b?.name||"Unknown Account"},D=a=>{s(a),u(!0)},F=a=>{s(a),w(!0)},H=a=>{s(a),A(!0)},K=async a=>{r&&(await d(r.id,a),w(!1),s(null))},L=async()=>{r&&await e(r.id)&&(A(!1),s(null))};return i?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(I.Card,{children:[(0,b.jsx)(I.CardHeader,{className:"pb-4",children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsx)(I.CardTitle,{className:"text-lg",children:"Expenses List"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(a8.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,b.jsx)(x.Input,{placeholder:"Search expenses...",value:p,onChange:a=>q(a.target.value),className:"pl-10"})]})]})}),(0,b.jsx)(I.CardContent,{className:"px-3",children:0===B.length?(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:p?"No expenses found matching your search.":"No expenses found."})}):(0,b.jsx)("div",{className:"space-y-3",children:B.map(a=>(0,b.jsxs)(I.Card,{className:"p-4 space-y-3 cursor-pointer hover:shadow-md transition-shadow border-l-4 border-l-red-500",onClick:()=>D(a),children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"space-y-1 flex-1",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:a.date.toLocaleDateString()}),(0,b.jsx)("div",{className:"text-base font-semibold line-clamp-2",children:a.description})]}),(0,b.jsxs)("div",{className:"text-right space-y-1",children:[(0,b.jsx)("div",{className:"text-lg font-bold text-red-600",children:l?(0,g.formatCashCurrency)(a.amount,o):"•••"}),(0,b.jsxs)("div",{className:"flex gap-1",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>D(a),className:"h-6 w-6 p-0 text-gray-600 hover:text-gray-700",children:(0,b.jsx)(a6.Eye,{className:"h-3 w-3"})}),m("expenses","edit")&&(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>F(a),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700",children:(0,b.jsx)(a7.Edit,{className:"h-3 w-3"})}),m("expenses","delete")&&(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>H(a),className:"h-6 w-6 p-0 text-red-600 hover:text-red-700",children:(0,b.jsx)(z.Trash2,{className:"h-3 w-3"})})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium text-muted-foreground",children:"Category:"}),a.category?(0,b.jsx)(E.Badge,{variant:"secondary",className:"text-xs",children:a.category}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"-"})]}),a.paymentMethod&&(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium text-muted-foreground",children:"Payment:"}),(0,b.jsx)("span",{className:"text-xs",children:a.paymentMethod})]}),a.personInCharge&&(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium text-muted-foreground",children:"Person in Charge:"}),(0,b.jsx)("span",{className:"text-xs",children:a.personInCharge})]}),a.receiptImage&&(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium text-muted-foreground",children:"Receipt:"}),(0,b.jsx)(E.Badge,{variant:"outline",className:"text-xs",children:"Available"})]}),a.cashAccountId&&(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium text-muted-foreground",children:"Cash Account:"}),(0,b.jsx)(E.Badge,{variant:"outline",className:"text-xs",children:C(a.cashAccountId)})]})]})]},a.id))})})]}),(0,b.jsx)(be,{expense:r,open:t,onOpenChange:u,formatCurrency:h,accounts:j}),(0,b.jsx)(bn,{expense:r,open:v,onOpenChange:w,onSubmit:K}),(0,b.jsx)(bo,{expense:r,open:y,onOpenChange:A,onConfirm:L,formatCurrency:h})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(I.Card,{children:[(0,b.jsx)(I.CardHeader,{className:"pb-4",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsx)(I.CardTitle,{className:"text-lg md:text-xl",children:"Expenses List"}),(0,b.jsxs)("div",{className:"relative w-full sm:w-80",children:[(0,b.jsx)(a8.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,b.jsx)(x.Input,{placeholder:"Search expenses by description, category, payment method...",value:p,onChange:a=>q(a.target.value),className:"pl-10"})]})]})}),(0,b.jsx)(I.CardContent,{children:0===B.length?(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:p?"No expenses found matching your search.":"No expenses found."})}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(a9.Table,{children:[(0,b.jsx)(a9.TableHeader,{children:(0,b.jsxs)(a9.TableRow,{children:[(0,b.jsx)(a9.TableHead,{children:"Date"}),(0,b.jsx)(a9.TableHead,{children:"Description"}),(0,b.jsx)(a9.TableHead,{children:"Category"}),(0,b.jsx)(a9.TableHead,{children:"Amount"}),(0,b.jsx)(a9.TableHead,{children:"Payment Method"}),(0,b.jsx)(a9.TableHead,{children:"Person In Charge"}),(0,b.jsx)(a9.TableHead,{children:"Cash Account"}),(0,b.jsx)(a9.TableHead,{children:"Receipt"}),(0,b.jsx)(a9.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(a9.TableBody,{children:B.map(a=>(0,b.jsxs)(a9.TableRow,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>D(a),children:[(0,b.jsx)(a9.TableCell,{className:"whitespace-nowrap",children:a.date.toLocaleDateString()}),(0,b.jsx)(a9.TableCell,{className:"font-medium",children:a.description}),(0,b.jsx)(a9.TableCell,{children:a.category?(0,b.jsx)(E.Badge,{variant:"secondary",children:a.category}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,b.jsx)(a9.TableCell,{className:"font-semibold text-red-600",children:l?(0,g.formatCashCurrency)(a.amount,o):"•••"}),(0,b.jsx)(a9.TableCell,{children:a.paymentMethod||(0,b.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,b.jsx)(a9.TableCell,{children:a.personInCharge||(0,b.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,b.jsx)(a9.TableCell,{children:a.cashAccountId?(0,b.jsx)(E.Badge,{variant:"outline",children:C(a.cashAccountId)}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,b.jsx)(a9.TableCell,{children:a.receiptImage?(0,b.jsx)(E.Badge,{variant:"outline",children:"Receipt"}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,b.jsx)(a9.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-1",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>D(a),className:"h-8 w-8 p-0",children:(0,b.jsx)(a6.Eye,{className:"h-4 w-4"})}),m("expenses","edit")&&(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>F(a),className:"h-8 w-8 p-0",children:(0,b.jsx)(a7.Edit,{className:"h-4 w-4"})}),m("expenses","delete")&&(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>H(a),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:(0,b.jsx)(z.Trash2,{className:"h-4 w-4"})})]})})]},a.id))})]})})})]}),(0,b.jsx)(be,{expense:r,open:t,onOpenChange:u,formatCurrency:h,accounts:j}),(0,b.jsx)(bn,{expense:r,open:v,onOpenChange:w,onSubmit:K}),(0,b.jsx)(bo,{expense:r,open:y,onOpenChange:A,onConfirm:L,formatCurrency:h})]})},br=({filteredExpenses:a,expenseStats:c,formatCurrency:d,dateFilter:e,onUpdateExpense:f,onDeleteExpense:g,showOnlyOverview:h=!1,showOnlyList:i=!1})=>h?(0,b.jsxs)("div",{className:"space-y-4 md:space-y-6",children:[(0,b.jsx)(K,{totalExpenses:c.totalExpenses,thisMonthExpenses:c.thisMonthExpenses,transactionCount:c.transactionCount,formatCurrency:d,dateFilter:e}),(0,b.jsx)(a5,{expenses:a,formatCurrency:d}),(0,b.jsx)(L,{filteredExpenses:a,formatCurrency:d})]}):i?(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsx)(bq,{expenses:a,onUpdateExpense:f,onDeleteExpense:g,formatCurrency:d})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(K,{totalExpenses:c.totalExpenses,thisMonthExpenses:c.thisMonthExpenses,transactionCount:c.transactionCount,formatCurrency:d,dateFilter:e}),(0,b.jsx)(bq,{expenses:a,onUpdateExpense:f,onDeleteExpense:g,formatCurrency:d})]});var bs=a.i(941675);let bt=({dateFilter:a,dateRange:c,onDateFilterChange:d,onDateRangeChange:e})=>(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center mb-4",onClick:a=>{a.stopPropagation()},children:[(0,b.jsx)("div",{className:"w-full sm:w-[200px]",children:(0,b.jsxs)(bj.Select,{value:a,onValueChange:d,children:[(0,b.jsx)(bj.SelectTrigger,{className:"bg-white shadow-sm",children:(0,b.jsx)(bj.SelectValue,{placeholder:"Select period"})}),(0,b.jsxs)(bj.SelectContent,{className:"z-50 bg-white shadow-lg",children:[(0,b.jsx)(bj.SelectItem,{value:"all",children:"All Time"}),(0,b.jsx)(bj.SelectItem,{value:"today",children:"Today"}),(0,b.jsx)(bj.SelectItem,{value:"yesterday",children:"Yesterday"}),(0,b.jsx)(bj.SelectItem,{value:"this-week",children:"This Week"}),(0,b.jsx)(bj.SelectItem,{value:"last-week",children:"Last Week"}),(0,b.jsx)(bj.SelectItem,{value:"this-month",children:"This Month"}),(0,b.jsx)(bj.SelectItem,{value:"last-month",children:"Last Month"}),(0,b.jsx)(bj.SelectItem,{value:"this-year",children:"This Year"}),(0,b.jsx)(bj.SelectItem,{value:"custom",children:"Custom Range"})]})]})}),"custom"===a&&(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsxs)(bi.Popover,{children:[(0,b.jsx)(bi.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(n.Button,{variant:"outline",className:"bg-white flex items-center gap-2 h-10 pl-3 text-left font-normal",children:[(0,b.jsx)(bs.Calendar,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:c.from?(0,bl.format)(c.from,"MMM d, yyyy"):"Start Date"})]})}),(0,b.jsx)(bi.PopoverContent,{className:"w-auto p-0 z-[100] bg-white shadow-lg",align:"start",children:(0,b.jsx)(bh.Calendar,{initialFocus:!0,mode:"single",defaultMonth:c?.from,selected:c?.from,onSelect:a=>e({...c,from:a}),className:"p-3 pointer-events-auto",showOutsideDays:!0})})]}),(0,b.jsx)("span",{className:"text-muted-foreground",children:"to"}),(0,b.jsxs)(bi.Popover,{children:[(0,b.jsx)(bi.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(n.Button,{variant:"outline",className:"bg-white flex items-center gap-2 h-10 pl-3 text-left font-normal",children:[(0,b.jsx)(bs.Calendar,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:c.to?(0,bl.format)(c.to,"MMM d, yyyy"):"End Date"})]})}),(0,b.jsx)(bi.PopoverContent,{className:"w-auto p-0 z-[100] bg-white shadow-lg",align:"start",children:(0,b.jsx)(bh.Calendar,{initialFocus:!0,mode:"single",defaultMonth:c?.to,selected:c?.to,onSelect:a=>e({...c,to:a}),className:"p-3 pointer-events-auto",showOutsideDays:!0})})]})]})]});var bu=a.i(795490),bv=a.i(585668),bw=a.i(114548),bx=a.i(797063),by=a.i(501199),bz=a.i(124348),bA=a.i(315055);let bB="bulk_expenses_draft",bC=({open:a,onOpenChange:f,onSuccess:h})=>{let j=(0,G.useIsMobile)(),{user:k}=(0,d.useAuth)(),{accounts:l}=(0,ba.useCashAccounts)(),{createBulkExpenses:m}=(0,e.useExpenses)(),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(new Date),[s,t]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(!a)return;let b=localStorage.getItem(bB);if(b)try{let a=JSON.parse(b);p(a.map(a=>({...a,date:new Date(a.date)})))}catch(a){console.error("Failed to parse draft",a),u()}else p([]),u()},[a]),(0,c.useEffect)(()=>{o.length>0?localStorage.setItem(bB,JSON.stringify(o)):localStorage.removeItem(bB)},[o]);let u=()=>{let a={id:Math.random().toString(36).substr(2,9),amount:0,description:"",category:"Other",date:q,paymentMethod:"Cash",personInCharge:"",linkToCash:!1,cashAccountId:l.length>0?l[0].id:void 0};p(b=>[...b,a])},v=a=>{p(b=>b.filter(b=>b.id!==a)),1===o.length&&u()},w=(a,b)=>{p(c=>c.map(c=>c.id===a?{...c,...b}:c))},A=(a,b)=>{let c=o.findIndex(b=>b.id===a);if(c<0||"up"===b&&0===c||"down"===b&&c===o.length-1)return;let d=[...o],e="up"===b?c-1:c+1;[d[c],d[e]]=[d[e],d[c]],p(d)},C=async()=>{let a=o.filter(a=>a.amount>0&&""!==a.description.trim());if(0===a.length)return void alert("Please enter at least one valid expense with amount and description");if(a.filter(a=>a.linkToCash&&!a.cashAccountId).length>0)return void alert("Please select a finance account for all linked expenses");t(!0);try{await m(a.map(({id:a,...b})=>({...b}))),localStorage.removeItem(bB),h()}catch(a){console.error("Bulk save failed",a),alert("Failed to save expenses. Please check your network connection.")}finally{t(!1)}};return(0,b.jsx)(B.Dialog,{open:a,onOpenChange:f,children:(0,b.jsx)(B.DialogContent,{className:"max-w-[95vw] md:max-w-6xl p-0 overflow-hidden border-none bg-transparent shadow-none",children:(0,b.jsx)("div",{className:"space-y-4 md:space-y-6",children:(0,b.jsxs)(I.Card,{className:"shadow-2xl overflow-hidden border-none bg-gradient-to-br from-white to-slate-50 dark:from-slate-900 dark:to-slate-950",children:[(0,b.jsx)(I.CardHeader,{className:"pb-3 bg-white dark:bg-slate-900 border-b",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 p-2 rounded-lg",children:(0,b.jsx)(by.Receipt,{className:"h-5 w-5 text-red-600"})}),(0,b.jsx)(I.CardTitle,{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"Bulk Expense Entry"})]}),(0,b.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Log multiple expenses efficiently. Link them to finance accounts to update cash ledgers automatically."})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(n.Button,{variant:"ghost",onClick:()=>f(!1),disabled:s,children:[(0,b.jsx)(bc.X,{className:"h-4 w-4 mr-2"}),"Cancel"]}),(0,b.jsxs)(n.Button,{onClick:C,disabled:s,className:"bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 shadow-lg font-bold",children:[s?(0,b.jsx)(bw.Save,{className:"h-4 w-4 mr-2 animate-spin"}):(0,b.jsx)(bw.Save,{className:"h-4 w-4 mr-2"}),"Save ",o.filter(a=>a.amount>0).length," Expenses"]})]})]})}),(0,b.jsx)(I.CardContent,{className:"p-4 sm:p-6 space-y-6 max-h-[80vh] overflow-y-auto custom-scrollbar",children:(0,b.jsxs)("div",{className:"bg-white dark:bg-slate-900/50 rounded-xl p-4 border border-slate-100 dark:border-slate-800 space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[(0,b.jsxs)("div",{className:"flex-1 md:flex-initial",children:[(0,b.jsx)("p",{className:"text-[10px] font-semibold text-muted-foreground uppercase mb-1 ml-1",children:"Default Date"}),(0,b.jsxs)(bi.Popover,{children:[(0,b.jsx)(bi.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(n.Button,{variant:"outline",className:(0,g.cn)("justify-start text-left font-normal w-full md:w-[220px] h-10 shadow-sm rounded-lg",!q&&"text-muted-foreground"),children:[(0,b.jsx)(bs.Calendar,{className:"mr-2 h-4 w-4 text-red-500"}),q?(0,bl.format)(q,"PPP"):(0,b.jsx)("span",{children:"Pick a date"})]})}),(0,b.jsx)(bi.PopoverContent,{className:"w-auto p-0 z-[100]",align:"start",children:(0,b.jsx)(bh.Calendar,{mode:"single",selected:q,onSelect:a=>a&&r(a),initialFocus:!0})})]})]}),(0,b.jsx)("div",{className:"flex items-end h-full",children:(0,b.jsxs)(n.Button,{onClick:u,variant:"outline",className:"gap-2 h-10 font-semibold border-red-200 dark:border-red-900/30 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/10 rounded-lg",children:[(0,b.jsx)(i.Plus,{className:"h-4 w-4"}),"Add Row"]})})]}),(0,b.jsxs)(bz.Alert,{className:"bg-orange-50/50 dark:bg-orange-900/10 border-orange-100 dark:border-orange-900 py-2 w-full md:max-w-xs",children:[(0,b.jsx)(bx.Info,{className:"h-4 w-4 text-orange-500"}),(0,b.jsxs)(bz.AlertDescription,{className:"text-[10px] sm:text-xs",children:["Rows with ",(0,b.jsx)("strong",{children:"Link Transaction"})," checked will automatically create cash deductions."]})]})]}),(0,b.jsx)("div",{className:"min-h-[300px]",children:j?(0,b.jsx)("div",{className:"space-y-4 px-1",children:o.map((a,c)=>(0,b.jsxs)(I.Card,{className:"overflow-hidden border-l-4 border-l-red-500/30 shadow-sm",children:[(0,b.jsxs)(I.CardHeader,{className:"flex flex-row items-center justify-between p-3 pb-2 bg-muted/20",children:[(0,b.jsxs)(I.CardTitle,{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:["Expense ",c+1]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(n.Button,{size:"icon",variant:"ghost",className:"h-8 w-8 text-muted-foreground",onClick:()=>A(a.id,"up"),children:(0,b.jsx)(bu.ArrowUp,{className:"h-4 w-4"})}),(0,b.jsx)(n.Button,{size:"icon",variant:"ghost",className:"h-8 w-8 text-destructive/70",onClick:()=>v(a.id),children:(0,b.jsx)(z.Trash2,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)(I.CardContent,{className:"p-3 space-y-3",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)(bi.Popover,{children:[(0,b.jsx)(bi.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(n.Button,{variant:"outline",size:"sm",className:(0,g.cn)("w-full justify-start text-left font-normal h-9 rounded-lg",!a.date&&"text-muted-foreground"),children:[(0,b.jsx)(bs.Calendar,{className:"mr-2 h-3 w-3"}),(0,b.jsx)("span",{className:"truncate text-xs",children:a.date?(0,bl.format)(a.date,"MMM dd, yyyy"):"Date"})]})}),(0,b.jsx)(bi.PopoverContent,{className:"w-auto p-0 z-[70]",align:"start",children:(0,b.jsx)(bh.Calendar,{mode:"single",selected:a.date,onSelect:b=>b&&w(a.id,{date:b}),initialFocus:!0})})]}),(0,b.jsx)(x.Input,{type:"number",placeholder:"Amount",value:a.amount||"",onChange:b=>w(a.id,{amount:Number(b.target.value)}),className:"h-9 font-medium rounded-lg"})]}),(0,b.jsx)(x.Input,{placeholder:"Description",value:a.description,onChange:b=>w(a.id,{description:b.target.value}),className:"h-9 rounded-lg"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)(bj.Select,{value:a.category,onValueChange:b=>w(a.id,{category:b}),children:[(0,b.jsx)(bj.SelectTrigger,{className:"h-9 text-xs rounded-lg",children:(0,b.jsx)(bj.SelectValue,{placeholder:"Category"})}),(0,b.jsxs)(bj.SelectContent,{children:[(0,b.jsx)(bj.SelectItem,{value:"Sales",children:"Sales"}),(0,b.jsx)(bj.SelectItem,{value:"Expenses",children:"Expenses"}),(0,b.jsx)(bj.SelectItem,{value:"Payroll",children:"Payroll"}),(0,b.jsx)(bj.SelectItem,{value:"Other",children:"Other"})]})]}),(0,b.jsxs)(bj.Select,{value:a.paymentMethod,onValueChange:b=>w(a.id,{paymentMethod:b}),children:[(0,b.jsx)(bj.SelectTrigger,{className:"h-9 text-xs rounded-lg",children:(0,b.jsx)(bj.SelectValue,{placeholder:"Method"})}),(0,b.jsxs)(bj.SelectContent,{children:[(0,b.jsx)(bj.SelectItem,{value:"Cash",children:"Cash"}),(0,b.jsx)(bj.SelectItem,{value:"M-Pesa",children:"M-Pesa"}),(0,b.jsx)(bj.SelectItem,{value:"Bank",children:"Bank"}),(0,b.jsx)(bj.SelectItem,{value:"Card",children:"Card"})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2 p-2 bg-slate-50 dark:bg-slate-900 rounded-lg border border-slate-100 dark:border-slate-800",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(bA.Checkbox,{id:`link-mobile-${a.id}`,checked:a.linkToCash,onCheckedChange:b=>w(a.id,{linkToCash:!!b})}),(0,b.jsx)(y.Label,{htmlFor:`link-mobile-${a.id}`,className:"text-xs font-medium",children:"Link to Finance Account"})]}),a.linkToCash&&(0,b.jsxs)(bj.Select,{value:a.cashAccountId,onValueChange:b=>w(a.id,{cashAccountId:b}),children:[(0,b.jsx)(bj.SelectTrigger,{className:"h-9 text-xs rounded-md",children:(0,b.jsx)(bj.SelectValue,{placeholder:"Select Account"})}),(0,b.jsx)(bj.SelectContent,{children:l.map(a=>(0,b.jsx)(bj.SelectItem,{value:a.id,children:a.name},a.id))})]})]})]})]},a.id))}):(0,b.jsx)("div",{className:"overflow-x-auto rounded-xl border-none shadow-sm bg-white dark:bg-slate-900",children:(0,b.jsxs)(a9.Table,{children:[(0,b.jsx)(a9.TableHeader,{className:"bg-slate-50 dark:bg-slate-800/50",children:(0,b.jsxs)(a9.TableRow,{children:[(0,b.jsx)(a9.TableHead,{className:"w-[140px]",children:"Date"}),(0,b.jsx)(a9.TableHead,{className:"w-[130px]",children:"Amount"}),(0,b.jsx)(a9.TableHead,{children:"Description"}),(0,b.jsx)(a9.TableHead,{className:"w-[140px]",children:"Category"}),(0,b.jsx)(a9.TableHead,{className:"w-[180px]",children:"Link to Cash"}),(0,b.jsx)(a9.TableHead,{className:"w-[120px] text-right",children:"Actions"})]})}),(0,b.jsx)(a9.TableBody,{children:o.map(a=>(0,b.jsxs)(a9.TableRow,{className:"hover:bg-muted/30 transition-colors border-slate-100 dark:border-slate-800",children:[(0,b.jsx)(a9.TableCell,{children:(0,b.jsxs)(bi.Popover,{children:[(0,b.jsx)(bi.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(n.Button,{variant:"outline",size:"sm",className:(0,g.cn)("w-full justify-start text-left font-normal h-9 rounded-lg",!a.date&&"text-muted-foreground"),children:[(0,b.jsx)(bs.Calendar,{className:"mr-2 h-3 w-3 shrink-0"}),(0,b.jsx)("span",{className:"truncate",children:a.date?(0,bl.format)(a.date,"MMM dd, yyyy"):"Date"})]})}),(0,b.jsx)(bi.PopoverContent,{className:"w-auto p-0 z-[70]",align:"start",children:(0,b.jsx)(bh.Calendar,{mode:"single",selected:a.date,onSelect:b=>b&&w(a.id,{date:b}),initialFocus:!0})})]})}),(0,b.jsx)(a9.TableCell,{children:(0,b.jsx)(x.Input,{type:"number",value:a.amount||"",onChange:b=>w(a.id,{amount:Number(b.target.value)}),className:"h-9 font-medium rounded-lg",placeholder:"0.00"})}),(0,b.jsx)(a9.TableCell,{children:(0,b.jsx)(x.Input,{value:a.description,onChange:b=>w(a.id,{description:b.target.value}),placeholder:"Description...",className:"h-9 rounded-lg"})}),(0,b.jsx)(a9.TableCell,{children:(0,b.jsxs)(bj.Select,{value:a.category,onValueChange:b=>w(a.id,{category:b}),children:[(0,b.jsx)(bj.SelectTrigger,{className:"h-9 rounded-lg",children:(0,b.jsx)(bj.SelectValue,{})}),(0,b.jsxs)(bj.SelectContent,{children:[(0,b.jsx)(bj.SelectItem,{value:"Sales",children:"Sales"}),(0,b.jsx)(bj.SelectItem,{value:"Expenses",children:"Expenses"}),(0,b.jsx)(bj.SelectItem,{value:"Payroll",children:"Payroll"}),(0,b.jsx)(bj.SelectItem,{value:"Supplies",children:"Supplies"}),(0,b.jsx)(bj.SelectItem,{value:"Utilities",children:"Utilities"}),(0,b.jsx)(bj.SelectItem,{value:"Rent",children:"Rent"}),(0,b.jsx)(bj.SelectItem,{value:"Other",children:"Other"})]})]})}),(0,b.jsx)(a9.TableCell,{children:(0,b.jsxs)("div",{className:"flex flex-col gap-1.5 p-1 bg-slate-50/50 dark:bg-slate-800/50 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(bA.Checkbox,{id:`link-${a.id}`,checked:a.linkToCash,onCheckedChange:b=>w(a.id,{linkToCash:!!b})}),(0,b.jsx)(y.Label,{htmlFor:`link-${a.id}`,className:"text-[10px] font-medium text-slate-600",children:"Link Transaction"})]}),a.linkToCash&&(0,b.jsxs)(bj.Select,{value:a.cashAccountId,onValueChange:b=>w(a.id,{cashAccountId:b}),children:[(0,b.jsx)(bj.SelectTrigger,{className:"text-[10px] h-7 px-2 rounded-md",children:(0,b.jsx)(bj.SelectValue,{placeholder:"Select Account"})}),(0,b.jsx)(bj.SelectContent,{children:l.map(a=>(0,b.jsx)(bj.SelectItem,{value:a.id,children:a.name},a.id))})]})]})}),(0,b.jsx)(a9.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-0.5",children:[(0,b.jsx)(n.Button,{size:"icon",variant:"ghost",className:"h-7 w-7 text-muted-foreground",onClick:()=>A(a.id,"up"),children:(0,b.jsx)(bu.ArrowUp,{className:"h-3.5 w-3.5"})}),(0,b.jsx)(n.Button,{size:"icon",variant:"ghost",className:"h-7 w-7 text-muted-foreground",onClick:()=>A(a.id,"down"),children:(0,b.jsx)(bv.ArrowDown,{className:"h-3.5 w-3.5"})}),(0,b.jsx)(n.Button,{size:"icon",variant:"ghost",className:"h-7 w-7 text-destructive/70 hover:text-destructive hover:bg-destructive/10",onClick:()=>v(a.id),children:(0,b.jsx)(z.Trash2,{className:"h-3.5 w-3.5"})})]})})]},a.id))})]})})}),o.length>5&&(0,b.jsx)("div",{className:"flex justify-center pt-2",children:(0,b.jsxs)(n.Button,{onClick:u,variant:"ghost",className:"gap-2 text-muted-foreground hover:text-red-500",children:[(0,b.jsx)(i.Plus,{className:"h-4 w-4"}),"Add Another Row"]})})]})})]})})})})};var bD=a.i(173390),bE=a.i(292e3),bF=a.i(816201),bG=a.i(175750),bH=a.i(899078);let bI=({open:a,onOpenChange:d,onUploadComplete:f})=>{let{createBulkExpenses:h}=(0,e.useExpenses)(),{accounts:i}=(0,ba.useCashAccounts)(),[j,o]=(0,c.useState)({step:"select",file:null,validRows:[],errors:[],totalRows:0,uploadProgress:0,successCount:0,failureCount:0}),p=(0,c.useRef)(null),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(!1),u=a=>{let b=new Date,c=a.Date,d=c?.toString();if(d)if(c instanceof Date)b=c;else{let a=d.match(/^(\d{1,2})[/-](\d{1,2})[/-](\d{4})$/);if(a){let[,c,d,e]=a;b=new Date(parseInt(e),parseInt(d)-1,parseInt(c))}else{let a=new Date(d);isNaN(a.getTime())||(b=a)}}let e="",f=a["Link to Finance"]?.toString().toLowerCase()==="true";if(f&&a["Finance Account"]){let b=i?.find(b=>b.name.toLowerCase()===a["Finance Account"]?.toString().toLowerCase());b&&(e=b.id)}return{amount:parseFloat(a.Amount?.toString().replace(/[^0-9.-]/g,"")||"0"),description:a.Description||"",category:a.Category||"Other",date:b,paymentMethod:a["Payment Method"]||"Cash",personInCharge:a["Person In Charge"]||"",linkToCash:f,cashAccountId:e||void 0}},v=async a=>{let b,c=a.name.endsWith(".xlsx")||a.name.endsWith(".xls"),d=a.name.endsWith(".csv");if(!c&&!d)return void alert("Please select a CSV or Excel file");if(c){let c=await a.arrayBuffer(),d=bG.read(c,{cellDates:!0}),e=d.SheetNames[0],f=d.Sheets[e],g=bG.utils.sheet_to_json(f).map(a=>({Date:a.Date||"",Amount:a.Amount||"",Description:a.Description||"",Category:a.Category||"","Payment Method":a["Payment Method"]||"","Person In Charge":a["Person In Charge"]||"","Link to Finance":a["Link to Finance"]||"","Finance Account":a["Finance Account"]||""})),h=[],j=[];g.forEach((a,b)=>{let c=(0,bH.validateExpenseCSVRow)(a,b+2);a["Link to Finance"]?.toString().toLowerCase()==="true"&&a["Finance Account"]&&(i?.find(b=>b.name.toLowerCase()===a["Finance Account"]?.toString().toLowerCase())||c.push({row:b+2,field:"Finance Account",message:`Account "${a["Finance Account"]}" not found.`})),0===c.length?h.push(a):j.push(...c)}),b={validRows:h,errors:j,totalRows:g.length}}else{let c=await a.text();b=(0,bH.parseExpenseCSV)(c);let d=[],e=[];b.validRows.forEach((a,b)=>{a["Link to Finance"]?.toString().toLowerCase()==="true"&&a["Finance Account"]?i?.find(b=>b.name.toLowerCase()===a["Finance Account"]?.toString().toLowerCase())?e.push(a):d.push({row:b+2,field:"Finance Account",message:`Account "${a["Finance Account"]}" not found.`}):e.push(a)}),b.errors.push(...d),b.validRows=e}o({...j,step:"preview",file:a,validRows:b.validRows,errors:b.errors,totalRows:b.totalRows})},w=async()=>{o(a=>({...a,step:"uploading",uploadProgress:0})),t(!0);let a=j.validRows.map(u);try{await h(a),o(b=>({...b,step:"complete",uploadProgress:100,successCount:a.length,failureCount:0})),setTimeout(()=>f(),1500)}catch(b){console.error("Bulk upload failed:",b),o(b=>({...b,step:"complete",uploadProgress:100,successCount:0,failureCount:a.length}))}finally{t(!1)}};return(0,b.jsx)(B.Dialog,{open:a,onOpenChange:d,children:(0,b.jsx)(B.DialogContent,{className:"max-w-[95vw] md:max-w-4xl p-0 overflow-hidden border-none bg-transparent shadow-none",children:(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)(I.Card,{className:"shadow-2xl border-none bg-transparent",children:[(0,b.jsx)(I.CardHeader,{className:"px-6 py-4 bg-white dark:bg-slate-900 border-b rounded-t-[2rem]",children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"bg-red-600 p-2.5 rounded-2xl text-white shadow-lg",children:(0,b.jsx)(m.Upload,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(I.CardTitle,{className:"text-2xl font-black tracking-tight",children:"CSV/Excel Importer"}),(0,b.jsx)("p",{className:"text-sm font-bold text-slate-500 dark:text-slate-400 uppercase tracking-tight",children:"Bulk process historical expense logs"})]})]}),(0,b.jsxs)(n.Button,{variant:"ghost",onClick:()=>d(!1),className:"bg-white dark:bg-slate-900 shadow-sm border rounded-xl h-10 px-4",children:[(0,b.jsx)(bc.X,{className:"h-4 w-4 mr-2"})," Cancel"]})]})}),(0,b.jsx)(I.CardContent,{className:"p-0",children:(0,b.jsxs)("div",{className:"bg-white/95 dark:bg-slate-900/95 backdrop-blur-sm rounded-b-[2rem] p-8 md:p-12 border shadow-sm min-h-[450px] max-h-[85vh] overflow-y-auto custom-scrollbar flex flex-col justify-center",children:["select"===j.step&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:(0,g.cn)("border-4 border-dashed rounded-3xl p-12 text-center cursor-pointer transition-all duration-300",q?"border-red-500 bg-red-50/50 scale-[1.01] shadow-xl":"border-slate-200 dark:border-slate-800 hover:border-red-400 hover:bg-slate-50/50 dark:hover:bg-slate-900/50"),onDrop:a=>{a.preventDefault(),r(!1),v(a.dataTransfer.files[0])},onDragOver:a=>{a.preventDefault(),r(!0)},onDragLeave:()=>r(!1),onClick:()=>p.current?.click(),children:[(0,b.jsx)("div",{className:"bg-red-100 dark:bg-red-900/40 w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-sm",children:(0,b.jsx)(m.Upload,{className:"h-10 w-10 text-red-600 dark:text-red-400"})}),(0,b.jsx)("h3",{className:"text-2xl font-black text-slate-900 dark:text-slate-100 mb-2",children:"Select CSV or Excel"}),(0,b.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 max-w-sm mx-auto mb-8",children:"Import multiple expenses quickly. Drag and drop your file here or click to browse."}),(0,b.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-100 dark:bg-slate-800 rounded-full text-[11px] font-bold text-slate-600 dark:text-slate-400",children:[(0,b.jsx)(l.FileText,{className:"h-3 w-3"})," .CSV"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-100 dark:bg-green-900/30 rounded-full text-[11px] font-bold text-green-700 dark:text-green-400",children:[(0,b.jsx)(l.FileText,{className:"h-3 w-3"})," .XLSX"]})]})]}),(0,b.jsxs)("div",{className:"border rounded-2xl overflow-hidden bg-white dark:bg-slate-900 shadow-sm",children:[(0,b.jsx)("div",{className:"bg-slate-50 dark:bg-slate-800/50 px-6 py-3 border-b flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(bx.Info,{className:"h-4 w-4 text-red-500"}),(0,b.jsx)("span",{className:"text-xs font-black text-slate-700 dark:text-slate-300 uppercase tracking-widest",children:"Expected Format"})]})}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(a9.Table,{children:[(0,b.jsx)(a9.TableHeader,{children:(0,b.jsxs)(a9.TableRow,{className:"bg-slate-100/30 dark:bg-slate-900/30",children:[(0,b.jsx)(a9.TableHead,{className:"text-[10px] h-9",children:"Date"}),(0,b.jsx)(a9.TableHead,{className:"text-[10px] h-9",children:"Amount"}),(0,b.jsx)(a9.TableHead,{className:"text-[10px] h-9",children:"Description"}),(0,b.jsx)(a9.TableHead,{className:"text-[10px] h-9",children:"Link to Finance"}),(0,b.jsx)(a9.TableHead,{className:"text-[10px] h-9",children:"Finance Account"})]})}),(0,b.jsxs)(a9.TableBody,{children:[(0,b.jsxs)(a9.TableRow,{className:"h-9 border-slate-100 dark:border-slate-800",children:[(0,b.jsx)(a9.TableCell,{className:"text-[11px] py-1.5 font-mono",children:"22/12/2025"}),(0,b.jsx)(a9.TableCell,{className:"text-[11px] py-1.5 font-bold",children:"450.00"}),(0,b.jsx)(a9.TableCell,{className:"text-[11px] py-1.5 truncate max-w-[120px]",children:"Office Rent"}),(0,b.jsx)(a9.TableCell,{className:"text-[11px] py-1.5 text-red-600 font-bold italic",children:"true"}),(0,b.jsx)(a9.TableCell,{className:"text-[11px] py-1.5 truncate max-w-[120px]",children:"Company Wallet"})]}),(0,b.jsxs)(a9.TableRow,{className:"h-9 border-none",children:[(0,b.jsx)(a9.TableCell,{className:"text-[11px] py-1.5 font-mono",children:"23/12/2025"}),(0,b.jsx)(a9.TableCell,{className:"text-[11px] py-1.5 font-bold",children:"120.00"}),(0,b.jsx)(a9.TableCell,{className:"text-[11px] py-1.5 truncate max-w-[120px]",children:"Stationery"}),(0,b.jsx)(a9.TableCell,{className:"text-[11px] py-1.5 text-slate-400 font-bold italic",children:"false"}),(0,b.jsx)(a9.TableCell,{className:"text-[11px] py-1.5 text-slate-400 italic",children:"Leave Empty"})]})]})]})})]}),(0,b.jsx)("input",{ref:p,type:"file",accept:".csv, .xlsx, .xls",onChange:a=>a.target.files?.[0]&&v(a.target.files[0]),className:"hidden"})]}),"preview"===j.step&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-2xl border border-slate-100 dark:border-slate-800 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"bg-red-50 dark:bg-red-900/30 p-2 rounded-xl",children:(0,b.jsx)(l.FileText,{className:"h-6 w-6 text-red-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-lg font-black text-slate-900 dark:text-slate-100",children:j.file?.name}),(0,b.jsx)("p",{className:"text-xs text-slate-500 uppercase font-bold tracking-tight",children:"Analyzed Successfully"})]})]}),(0,b.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:()=>o(a=>({...a,step:"select"})),className:"text-red-600 font-bold",children:"Change File"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(I.Card,{className:"shadow-none bg-emerald-50/50 dark:bg-emerald-900/10 border-emerald-100 dark:border-emerald-800/50",children:(0,b.jsxs)(I.CardContent,{className:"p-6",children:[(0,b.jsx)("div",{className:"text-3xl font-black text-emerald-600 dark:text-emerald-400",children:j.validRows.length}),(0,b.jsx)("p",{className:"text-[10px] font-black text-emerald-700 dark:text-emerald-500 uppercase tracking-widest mt-1",children:"Ready to Import"})]})}),(0,b.jsx)(I.Card,{className:"shadow-none bg-rose-50/50 dark:bg-rose-900/10 border-rose-100 dark:border-rose-800/50",children:(0,b.jsxs)(I.CardContent,{className:"p-6",children:[(0,b.jsx)("div",{className:"text-3xl font-black text-rose-600 dark:text-rose-400",children:j.errors.length}),(0,b.jsx)("p",{className:"text-[10px] font-black text-rose-700 dark:text-rose-500 uppercase tracking-widest mt-1",children:"Invalid Records"})]})})]})]}),j.errors.length>0&&(0,b.jsxs)(bz.Alert,{variant:"destructive",className:"bg-rose-50/50 dark:bg-rose-900/10 border-rose-200 dark:border-rose-900/50 rounded-2xl p-4",children:[(0,b.jsx)(bE.AlertCircle,{className:"h-5 w-5 text-rose-600"}),(0,b.jsxs)(bz.AlertDescription,{className:"text-sm text-rose-700 dark:text-rose-400 leading-relaxed font-bold ml-2",children:["Heads up! ",j.errors.length," rows have errors and will be skipped.",(0,b.jsxs)(n.Button,{variant:"link",className:"p-0 h-auto ml-2 text-rose-800 dark:text-rose-300 underline font-black uppercase text-xs",onClick:()=>(0,bH.generateErrorLogCSV)(j.errors,"expense_errors.csv"),children:[(0,b.jsx)(k.Download,{className:"h-3 w-3 mr-1 inline"})," Export Error Log"]})]})]}),(0,b.jsxs)(n.Button,{className:"w-full h-14 bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 shadow-xl font-black text-lg rounded-2xl",onClick:w,disabled:0===j.validRows.length,children:["Confirm Import of ",j.validRows.length," Expenses"]})]}),"uploading"===j.step&&(0,b.jsxs)("div",{className:"space-y-10 py-12 text-center",children:[(0,b.jsxs)("div",{className:"relative w-24 h-24 mx-auto",children:[(0,b.jsx)("div",{className:"absolute inset-0 rounded-3xl border-4 border-slate-100 dark:border-slate-800"}),(0,b.jsx)("div",{className:"absolute inset-0 rounded-3xl border-4 border-t-red-600 animate-spin"}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,b.jsx)(by.Receipt,{className:"h-10 w-10 text-red-500/30"})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-2xl font-black",children:"Processing Your Data"}),(0,b.jsxs)("div",{className:"max-w-xs mx-auto space-y-2",children:[(0,b.jsx)(bD.Progress,{value:j.uploadProgress,className:"h-3 rounded-full bg-slate-100 dark:bg-slate-800"}),(0,b.jsxs)("span",{className:"text-xs font-black text-slate-400 uppercase tracking-[0.2em]",children:[Math.round(j.uploadProgress),"% Complete"]})]})]})]}),"complete"===j.step&&(0,b.jsxs)("div",{className:"space-y-8 py-8 text-center animate-in fade-in zoom-in duration-500",children:[(0,b.jsx)("div",{className:"bg-emerald-100 dark:bg-emerald-900/30 w-24 h-24 rounded-[2rem] flex items-center justify-center mx-auto shadow-inner",children:(0,b.jsx)(bF.CheckCircle,{className:"h-12 w-12 text-emerald-600 dark:text-emerald-400"})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h3",{className:"text-3xl font-black tracking-tight",children:"Import Complete!"}),(0,b.jsxs)("p",{className:"text-slate-500 dark:text-slate-400 font-bold uppercase text-xs tracking-widest",children:["Successfully Added ",(0,b.jsxs)("span",{className:"text-emerald-600 dark:text-emerald-400 font-black",children:[j.successCount," Records"]})]})]}),(0,b.jsx)(n.Button,{onClick:f,className:"h-14 px-12 rounded-2xl text-lg font-black bg-slate-900 hover:bg-black dark:bg-white dark:text-black shadow-xl",children:"Return to Dashboard"})]})]})})]})})})})};var bJ=a.i(957064);let bK=({onNewEntry:a,onBulkEntry:c,onImportCSV:d,canCreate:e=!0})=>(0,b.jsx)(I.Card,{className:"border-none shadow-md overflow-hidden bg-gradient-to-br from-white to-slate-50 dark:from-slate-900 dark:to-slate-950 mb-6",children:(0,b.jsxs)("div",{className:"p-4 sm:p-6 space-y-4",children:[(0,b.jsx)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h3",{className:"text-lg font-bold tracking-tight",children:"Expense Center"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Manage your business expenditures efficiently"})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[(0,b.jsxs)(n.Button,{type:"button",onClick:a,disabled:!e,className:(0,g.cn)("h-auto py-4 flex flex-col items-center justify-center gap-2 text-white shadow-lg border-none active:scale-[0.98] transition-all",e?"bg-red-600 hover:bg-red-700":"bg-slate-400 cursor-not-allowed opacity-60"),children:[(0,b.jsx)("div",{className:"bg-white/20 p-2 rounded-lg",children:(0,b.jsx)(i.Plus,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("span",{className:"block font-bold",children:"New Entry"}),(0,b.jsx)("span",{className:"block text-[10px] opacity-80 font-medium",children:"Single Expense"})]})]}),(0,b.jsxs)(n.Button,{type:"button",onClick:c,variant:"outline",disabled:!e,className:(0,g.cn)("h-auto py-4 flex flex-col items-center justify-center gap-2 border-slate-200 dark:border-slate-800 shadow-sm active:scale-[0.98] transition-all",e?"hover:bg-orange-50/50 dark:hover:bg-orange-900/10 hover:border-orange-200":"opacity-60 cursor-not-allowed"),children:[(0,b.jsx)("div",{className:"bg-orange-100 dark:bg-orange-900/30 p-2 rounded-lg text-orange-600 dark:text-orange-400",children:(0,b.jsx)(bJ.LayoutGrid,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("span",{className:"block font-bold",children:"Bulk Entry"}),(0,b.jsx)("span",{className:"block text-[10px] text-muted-foreground font-medium",children:"Manual Batch"})]})]}),(0,b.jsxs)(n.Button,{type:"button",onClick:d,variant:"outline",disabled:!e,className:(0,g.cn)("h-auto py-4 flex flex-col items-center justify-center gap-2 border-slate-200 dark:border-slate-800 shadow-sm active:scale-[0.98] transition-all",e?"hover:bg-emerald-50/50 dark:hover:bg-emerald-900/10 hover:border-emerald-200":"opacity-60 cursor-not-allowed"),children:[(0,b.jsx)("div",{className:"bg-emerald-100 dark:bg-emerald-900/30 p-2 rounded-lg text-emerald-600 dark:text-emerald-400",children:(0,b.jsx)(m.Upload,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("span",{className:"block font-bold",children:"Import CSV"}),(0,b.jsx)("span",{className:"block text-[10px] text-muted-foreground font-medium",children:"Process Legacy Logs"})]})]})]})]})});var bL=a.i(367329);let bM=(0,a.i(170106).default)("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);var bN=a.i(665967),bO=a.i(932596);a.s(["default",0,()=>{let{user:a}=(0,d.useAuth)(),i=(0,bN.useNavigate)(),j=(0,G.useIsMobile)(),{hasPermission:k,isLoading:l}=(0,bp.useProfiles)(),{settings:m}=(0,f.useBusinessSettings)(),{expenses:o,isLoading:p,createExpense:q,updateExpense:r,deleteExpense:s,refreshExpenses:t}=(0,e.useExpenses)(),[u,v]=(0,c.useState)("overview"),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)("all"),[E,F]=(0,c.useState)({from:void 0,to:void 0}),{filteredExpenses:I,expenseStats:J,formatCurrency:K}=((a,b,d)=>{let{settings:e}=(0,f.useBusinessSettings)(),i=(0,c.useMemo)(()=>{let a=e.currency||"USD";return b=>(0,g.formatCashCurrency)(b,a)},[e.currency]),j=(0,c.useMemo)(()=>{let c,e;if("all"===b)return a;if("custom"===b)c=d.from,e=d.to;else{let a=(0,h.getDateRangeFromFilter)(b);c=a.from,e=a.to}return a.filter(a=>(0,h.isDateInRange)(a.date,c,e))},[a,b,d]),k=(0,c.useMemo)(()=>({totalExpenses:j.reduce((a,b)=>a+b.amount,0),thisMonthExpenses:j.filter(a=>{let b=a.date.getMonth(),c=new Date().getMonth(),d=a.date.getFullYear(),e=new Date().getFullYear();return b===c&&d===e}).reduce((a,b)=>a+b.amount,0),transactionCount:j.length}),[j]);return{filteredExpenses:j,expenseStats:k,formatCurrency:i}})(o||[],C,E),L=async a=>{try{await q(a),x(!1)}catch(a){console.error("Error creating expense:",a)}},N=(0,c.useCallback)(()=>{((a,b,c="USD")=>{if(0===a.length)return alert("No expenses to export");let d=new Blob([[["Date","Description","Category","Amount","Payment Method","Person in Charge","Cash Account","Receipt Available"],...a.map(a=>[(0,bl.format)(a.date,"yyyy-MM-dd"),`"${a.description.replace(/"/g,'""')}"`,a.category||"",a.amount.toString(),a.paymentMethod||"",a.personInCharge||"",a.cashAccountId?"Yes":"No",a.receiptImage?"Yes":"No"])].map(a=>a.join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),e=document.createElement("a");if(void 0!==e.download){let a=URL.createObjectURL(d);e.setAttribute("href",a),e.setAttribute("download",`expenses-${c}-${(0,bl.format)(new Date,"yyyy-MM-dd")}.csv`),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e)}})(I,0,m?.currency||"USD")},[I,K,m?.currency]),O=(0,c.useCallback)(()=>{((a,b,c="USD",d,e,f,g)=>{if(0===a.length)return alert("No expenses to export");let h=new bO.default({orientation:"landscape",unit:"mm",format:"a4"}),i=h.internal.pageSize.getWidth(),j=h.internal.pageSize.getHeight(),k=8;h.setFontSize(20),h.setFont("helvetica","bold"),h.text(d||"Business",8,k),k+=12,h.setFontSize(16),h.text("Expenses Report",8,k),k+=10,h.setFontSize(12),h.setFont("helvetica","normal");let l="";if(f&&"all"!==f)switch(f){case"today":l=`Period: Today (${(0,bl.format)(new Date,"MMM dd, yyyy")})`;break;case"yesterday":let m=new Date;m.setDate(m.getDate()-1),l=`Period: Yesterday (${(0,bl.format)(m,"MMM dd, yyyy")})`;break;case"this-week":l="Period: This Week";break;case"last-week":l="Period: Last Week";break;case"this-month":l=`Period: This Month (${(0,bl.format)(new Date,"MMMM yyyy")})`;break;case"last-month":let n=new Date;n.setMonth(n.getMonth()-1),l=`Period: Last Month (${(0,bl.format)(n,"MMMM yyyy")})`;break;case"this-year":l=`Period: This Year (${(0,bl.format)(new Date,"yyyy")})`;break;case"custom":l=g?.from&&g?.to?`Period: ${(0,bl.format)(g.from,"MMM dd, yyyy")} - ${(0,bl.format)(g.to,"MMM dd, yyyy")}`:g?.from?`Period: From ${(0,bl.format)(g.from,"MMM dd, yyyy")}`:g?.to?`Period: Until ${(0,bl.format)(g.to,"MMM dd, yyyy")}`:"Period: Custom Range";break;default:l="Period: All Time"}else l="Period: All Time";h.text(l,8,k),k+=6,h.setFontSize(10),h.text(`Generated on: ${(0,bl.format)(new Date,"MMM dd, yyyy HH:mm")}`,8,k),k+=10;let o=a.reduce((a,b)=>a+b.amount,0),p=k,q=[{header:"Date",width:25,x:8},{header:"Description",width:65,x:33},{header:"Category",width:30,x:98},{header:`Amount (${c})`,width:30,x:128},{header:"Payment",width:30,x:158},{header:"Person",width:35,x:188},{header:"Cash",width:20,x:223},{header:"Receipt",width:20,x:243}];h.setFillColor(240,240,240),h.rect(8,p,i-16,8,"F"),h.setFontSize(9),h.setFont("helvetica","bold"),h.setTextColor(0,0,0),q.forEach(a=>{h.text(a.header,a.x+2,p+6)}),h.setLineWidth(.5),h.setDrawColor(0,0,0),h.rect(8,p,i-16,8),h.setFont("helvetica","normal"),h.setFontSize(8);let r=p+8,s=Math.floor((j-r-20)/6);a.forEach((a,c)=>{c>0&&c%s==0&&(h.addPage(),r=8,h.setFillColor(240,240,240),h.rect(8,r,i-16,8,"F"),h.setFont("helvetica","bold"),h.setFontSize(9),q.forEach(a=>{h.text(a.header,a.x+2,r+6)}),h.rect(8,r,i-16,8),r+=8,h.setFont("helvetica","normal"),h.setFontSize(8)),c%2==1&&(h.setFillColor(248,248,248),h.rect(8,r,i-16,6,"F"));let d=[(0,bl.format)(a.date,"MM/dd/yyyy"),a.description.length>30?a.description.substring(0,27)+"...":a.description,a.category||"-",b(a.amount),a.paymentMethod?.substring(0,12)||"-",a.personInCharge?.substring(0,15)||"-",a.cashAccountId?"Yes":"No",a.receiptImage?"Yes":"No"];q.forEach((a,b)=>{let c=d[b],e=a.x+2;if(3===b){let b=h.getTextWidth(c);h.text(c,a.x+a.width-b-2,r+4.5)}else h.text(c,e,r+4.5)}),h.setLineWidth(.1),h.rect(8,r,i-16,6),r+=6}),(r+=8)+25>j-8&&(h.addPage(),r=20),h.setFontSize(14),h.setFont("helvetica","bold"),h.text("Summary",8,r),r+=12,h.setFontSize(11),h.setFont("helvetica","normal"),[["Total Expenses:",a.length.toString()],["Total Amount:",b(o)],["With Receipts:",a.filter(a=>a.receiptImage).length.toString()],["Cash Linked:",a.filter(a=>a.cashAccountId).length.toString()]].forEach((a,b)=>{let c=r+5*b;h.setFont("helvetica","bold"),h.text(a[0],8,c),h.setFont("helvetica","normal"),h.text(a[1],58,c)});let t=h.getNumberOfPages();for(let a=1;a<=t;a++)h.setPage(a),h.setFontSize(8),h.setFont("helvetica","normal"),h.text(`Page ${a} of ${t}`,i-8-20,j-10),h.setFontSize(10),h.setFont("helvetica","italic"),h.setTextColor(150,150,150),h.text("Created By Gonza Systems",8,j-5),h.setTextColor(0,0,0);let u=`expenses_report_${(0,bl.format)(new Date,"yyyy-MM-dd")}.pdf`;h.save(u)})(I,K,m?.currency||"USD",m?.businessName,m?.businessLogo,C,E)},[I,K,m,C,E]);if(l||p)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(!k("expenses","view"))return(0,b.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,b.jsxs)(bz.Alert,{variant:"destructive",children:[(0,b.jsx)(bE.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(bz.AlertTitle,{children:"Access Denied"}),(0,b.jsx)(bz.AlertDescription,{children:"You do not have permission to view expenses. Please contact your administrator if you believe this is an error."})]}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(n.Button,{onClick:()=>i("/"),variant:"outline",children:"Back to Dashboard"})})]});let P=k("expenses","create");return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(H,{onAddExpense:()=>x(!0),isRefreshing:p,onRefresh:t,onAddBulkExpense:()=>z(!0),onImportExpenses:()=>B(!0),onExportCSV:N,onExportPDF:O,onDownloadTemplate:()=>{let a,b;return a=bG.utils.json_to_sheet([{Date:"22/12/2025",Amount:"450.00",Description:"Office Rent",Category:"Rent","Payment Method":"Bank","Person In Charge":"Admin","Link to Finance":"true","Finance Account":"Company Wallet"},{Date:"23/12/2025",Amount:"120.00",Description:"Stationery",Category:"Supplies","Payment Method":"Cash","Person In Charge":"Manager","Link to Finance":"false","Finance Account":""}],{header:["Date","Amount","Description","Category","Payment Method","Person In Charge","Link to Finance","Finance Account"]}),b=bG.utils.book_new(),void(bG.utils.book_append_sheet(b,a,"Expenses Template"),bG.writeFile(b,"expense_import_template.xlsx"))},canCreate:P}),(0,b.jsx)(bm,{open:w,onOpenChange:x,onSubmit:L}),(0,b.jsx)(bC,{open:y,onOpenChange:z,onSuccess:()=>{z(!1),t()}}),(0,b.jsx)(bI,{open:A,onOpenChange:B,onUploadComplete:()=>{B(!1),t()}}),(0,b.jsx)("div",{className:"px-4 md:px-0",children:(0,b.jsxs)(M.Tabs,{value:u,onValueChange:v,className:"w-full space-y-6",children:[(0,b.jsxs)(M.TabsList,{className:`grid w-full ${j?"grid-cols-2 gap-1 h-auto py-1":"grid-cols-2"} bg-slate-100/50 dark:bg-slate-800/50 p-1 rounded-xl`,children:[(0,b.jsxs)(M.TabsTrigger,{value:"overview",className:"flex items-center gap-2 py-2.5 rounded-lg data-[state=active]:bg-white dark:data-[state=active]:bg-slate-900 data-[state=active]:shadow-sm",children:[(0,b.jsx)(bM,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Overview"})]}),(0,b.jsxs)(M.TabsTrigger,{value:"expenses-list",className:"flex items-center gap-2 py-2.5 rounded-lg data-[state=active]:bg-white dark:data-[state=active]:bg-slate-900 data-[state=active]:shadow-sm",children:[(0,b.jsx)(bL.List,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"List"})]})]}),(0,b.jsxs)(M.TabsContent,{value:"overview",className:"space-y-6 animate-in fade-in-50 duration-300",children:[(0,b.jsx)(bK,{onNewEntry:()=>x(!0),onBulkEntry:()=>z(!0),onImportCSV:()=>B(!0),canCreate:P}),(0,b.jsx)(bt,{dateFilter:C,dateRange:E,onDateFilterChange:D,onDateRangeChange:F}),(0,b.jsx)(br,{filteredExpenses:I,expenseStats:J,formatCurrency:K,dateFilter:C,onUpdateExpense:r,onDeleteExpense:s,showOnlyOverview:!0})]}),(0,b.jsxs)(M.TabsContent,{value:"expenses-list",className:"space-y-6 animate-in fade-in-50 duration-300",children:[(0,b.jsx)(bt,{dateFilter:C,dateRange:E,onDateFilterChange:D,onDateRangeChange:F}),(0,b.jsx)(br,{filteredExpenses:I,expenseStats:J,formatCurrency:K,dateFilter:C,onUpdateExpense:r,onDeleteExpense:s,showOnlyList:!0})]})]})})]})}],996253)}];

//# sourceMappingURL=_54ef5127._.js.map