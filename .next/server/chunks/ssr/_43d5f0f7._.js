module.exports=[229618,a=>{"use strict";var b=a.i(873492);function c(a,c,d){let e=+(0,b.toDate)(a,d?.in),[f,g]=[+(0,b.toDate)(c.start,d?.in),+(0,b.toDate)(c.end,d?.in)].sort((a,b)=>a-b);return e>=f&&e<=g}a.s(["isWithinInterval",()=>c])},451627,a=>a.a(async(b,c)=>{try{var d=a.i(150848),e=b([d]);async function f(a,b,c){try{let e={branchId:a};(b||c)&&(e.date={},b&&(e.date.gte=new Date(b)),c&&(e.date.lte=new Date(c)));let f=(await d.db.expense.findMany({where:e,select:{amount:!0}})).reduce((a,b)=>a+Number(b.amount),0);return{success:!0,data:f}}catch(a){return console.error("Error fetching total expenses:",a),{success:!1,error:a.message}}}[d]=e.then?(await e)():e,a.s(["getTotalExpensesAction",()=>f]),c()}catch(a){c(a)}},!1),60040,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(229618),f=a.i(665376),g=a.i(128069),h=a.i(122460),i=a.i(126554),j=a.i(759447),k=a.i(178465),l=a.i(385674),m=a.i(304050),n=a.i(284177),o=a.i(671693),p=a.i(460716),q=a.i(837692),r=a.i(964889),s=a.i(451627),t=b([r,s]);function u({sales:a,dateFilter:b,dateRange:c,specificDate:t,isCustomRange:u,isSpecificDate:v}){let[w,x]=(0,d.useState)(0),[y,z]=(0,d.useState)(!0),{currentBusiness:A}=(0,r.useBusiness)(),B=(0,d.useCallback)(a=>{let b=a.items&&Array.isArray(a.items)?a.items.reduce((a,b)=>{let c=b.price*b.quantity,d="amount"===b.discountType?b.discountAmount||0:c*(b.discountPercentage||0)/100;return a+(c-d)},0):0,c=a.items&&Array.isArray(a.items)?a.items.reduce((a,b)=>a+b.cost*b.quantity,0):0;return{totalSalePrice:b,totalCost:c}},[]),C=(0,d.useCallback)(a=>{if(isNaN(a.getTime()))return!1;if("all"===b)return!0;if("custom"===b&&u)return!c.from||!c.to||(0,e.isWithinInterval)(a,{start:(0,f.startOfDay)(c.from),end:(0,g.endOfDay)(c.to)});if("specific"===b&&v)return!t||(0,q.isSameDay)(a,t);let d=new Date;switch(b){case"today":return(0,e.isWithinInterval)(a,{start:(0,f.startOfDay)(d),end:(0,g.endOfDay)(d)});case"yesterday":let r=(0,n.subDays)(d,1);return(0,e.isWithinInterval)(a,{start:(0,f.startOfDay)(r),end:(0,g.endOfDay)(r)});case"this-week":return(0,e.isWithinInterval)(a,{start:(0,h.startOfWeek)(d,{weekStartsOn:1}),end:(0,i.endOfWeek)(d,{weekStartsOn:1})});case"last-week":let s=(0,o.subWeeks)((0,h.startOfWeek)(d,{weekStartsOn:1}),1),w=(0,i.endOfWeek)(s,{weekStartsOn:1});return(0,e.isWithinInterval)(a,{start:s,end:w});case"this-month":return(0,e.isWithinInterval)(a,{start:(0,j.startOfMonth)(d),end:(0,k.endOfMonth)(d)});case"last-month":let x=(0,p.subMonths)(d,1);return(0,e.isWithinInterval)(a,{start:(0,j.startOfMonth)(x),end:(0,k.endOfMonth)(x)});case"this-year":return(0,e.isWithinInterval)(a,{start:(0,l.startOfYear)(d),end:(0,m.endOfYear)(d)});default:return!0}},[b,u,v,c,t]),D=(0,d.useMemo)(()=>{let b=a.filter(a=>{let b=new Date(a.date);return C(b)});return{all:b,nonQuotes:b.filter(a=>"Quote"!==a.paymentStatus)}},[a,C]),E=(0,d.useMemo)(()=>D.nonQuotes.reduce((a,b)=>{let{totalSalePrice:c,totalCost:d}=B(b);return{totalSales:a.totalSales+c,totalProfit:a.totalProfit+(c-d),totalCost:a.totalCost+d,paidSalesCount:a.paidSalesCount+ +("Paid"===b.paymentStatus),pendingSalesCount:a.pendingSalesCount+ +("NOT PAID"===b.paymentStatus)}},{totalSales:0,totalProfit:0,totalCost:0,paidSalesCount:0,pendingSalesCount:0}),[D.nonQuotes,B]),F=(0,d.useMemo)(()=>[{name:"Total Sales",amount:E.totalSales},{name:"Total Cost",amount:E.totalCost},{name:"Total Expenses",amount:w},{name:"Total Profit",amount:E.totalProfit}],[E,w]),G=(0,d.useMemo)(()=>[...D.all].sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime()).slice(0,20),[D.all]),H=(0,d.useMemo)(()=>D.nonQuotes.length,[D.nonQuotes]);return(0,d.useEffect)(()=>{(async()=>{if(!A){x(0),z(!1);return}z(!0);try{let a,d;if(u&&c.from&&c.to)a=c.from.toISOString(),d=c.to.toISOString();else if(v&&t)a=(0,f.startOfDay)(t).toISOString(),d=(0,g.endOfDay)(t).toISOString();else if("all"!==b){let c=new Date;switch(b){case"today":a=(0,f.startOfDay)(c).toISOString(),d=(0,g.endOfDay)(c).toISOString();break;case"yesterday":let e=(0,n.subDays)(c,1);a=(0,f.startOfDay)(e).toISOString(),d=(0,g.endOfDay)(e).toISOString();break;case"this-week":a=(0,h.startOfWeek)(c,{weekStartsOn:1}).toISOString(),d=(0,i.endOfWeek)(c,{weekStartsOn:1}).toISOString();break;case"last-week":let q=(0,o.subWeeks)((0,h.startOfWeek)(c,{weekStartsOn:1}),1);a=q.toISOString(),d=(0,i.endOfWeek)(q,{weekStartsOn:1}).toISOString();break;case"this-month":a=(0,j.startOfMonth)(c).toISOString(),d=(0,k.endOfMonth)(c).toISOString();break;case"last-month":let r=(0,p.subMonths)(c,1);a=(0,j.startOfMonth)(r).toISOString(),d=(0,k.endOfMonth)(r).toISOString();break;case"this-year":a=(0,l.startOfYear)(c).toISOString(),d=(0,m.endOfYear)(c).toISOString()}}let e=await (0,s.getTotalExpensesAction)(A.id,a,d);if(!e.success)return void console.error("Error fetching expenses:",e.error);x(e.data||0)}catch(a){console.error("Failed to fetch expenses:",a)}finally{z(!1)}})()},[b,u,v,c.from,c.to,t,A]),{filteredSales:D.all,nonQuoteSales:D.nonQuotes,analyticsData:E,barChartData:F,recentSales:G,nonQuoteSalesCount:H,expenses:w,isLoadingExpenses:y}}[r,s]=t.then?(await t)():t,a.s(["useAnalyticsData",()=>u]),c()}catch(a){c(a)}},!1),918081,a=>{"use strict";let b=(0,a.i(564375).default)("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);a.s(["Percent",()=>b],918081)},370178,a=>{"use strict";let b=(0,a.i(564375).default)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);a.s(["UserCheck",()=>b],370178)},860167,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(811705),g=a.i(799856),h=a.i(558277),i=a.i(515016),j=a.i(352519),k=a.i(918081),l=a.i(370178),m=a.i(691098),n=a.i(499239),o=b([f,g]);[f,g]=o.then?(await o)():o;let p=(0,e.memo)(({analyticsData:a,nonQuoteSalesCount:b,currency:c,expenses:e,inventoryValue:o,canViewProfit:p=!0,canViewTotalSales:q=!0,canViewTotalExpenses:r=!0,canViewInventoryValue:s=!0,canViewSalesTypes:t=!0})=>{let u=(0,h.useIsMobile)(),v=[{title:"Total Sales",value:q?`${c} ${(0,g.formatNumber)(a.totalSales)}`:"â€¢â€¢â€¢",description:q?`From ${b} transactions (excluding quotes)`:"Requires permission",color:"text-sales-primary",bgColor:"bg-blue-50",icon:(0,d.jsx)(j.DollarSign,{className:"h-5 w-5 text-sales-primary"}),visible:!0},{title:"Total Gross Profit",value:p?`${c} ${(0,g.formatNumber)(a.totalProfit)}`:"â€¢â€¢â€¢",description:p?a.totalProfit>0?`${(a.totalProfit/a.totalSales*100).toFixed(1)}% profit margin`:"No profit yet":"Requires permission",color:"text-green-600",bgColor:"bg-green-50",icon:(0,d.jsx)(i.TrendingUp,{className:"h-5 w-5 text-green-600"}),visible:!0},{title:"Total Expenses",value:r?`${c} ${(0,g.formatNumber)(e)}`:"â€¢â€¢â€¢",description:r?e>0&&a.totalSales>0?`${(e/a.totalSales*100).toFixed(1)}% of sales`:"No expenses recorded":"Requires permission",color:"text-[#f05a29]",bgColor:"bg-orange-50",icon:(0,d.jsx)(k.Percent,{className:"h-5 w-5 text-[#f05a29]"}),visible:!0},{title:"Inventory Value",value:s?`${c} ${(0,g.formatNumber)(o)}`:"â€¢â€¢â€¢",description:s?"Total value of current inventory":"Requires permission",color:"text-green-600",bgColor:"bg-green-50",icon:(0,d.jsx)(n.Package,{className:"h-5 w-5 text-green-600"}),visible:!0},{title:"Cash Sales",value:t?a.paidSalesCount.toString():"â€¢â€¢â€¢",description:t?a.paidSalesCount+a.pendingSalesCount>0?`${(a.paidSalesCount/(a.paidSalesCount+a.pendingSalesCount)*100).toFixed(1)}% of total`:"No sales yet":"Requires permission",color:"text-green-600",bgColor:"bg-green-50",icon:(0,d.jsx)(l.UserCheck,{className:"h-5 w-5 text-green-600"}),visible:!0},{title:"Credit Sales",value:t?a.pendingSalesCount.toString():"â€¢â€¢â€¢",description:t?a.pendingSalesCount>0?`${(a.pendingSalesCount/(a.paidSalesCount+a.pendingSalesCount)*100).toFixed(1)}% of total`:"No credit sales":"Requires permission",color:"text-amber-500",bgColor:"bg-amber-50",icon:(0,d.jsx)(m.CreditCard,{className:"h-5 w-5 text-amber-500"}),visible:!0}];return v.filter(a=>a.visible),(0,d.jsx)("div",{className:`grid gap-4 w-full ${u?"grid-cols-2":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6"}`,children:v.map((a,b)=>(0,d.jsx)(f.Card,{className:`w-full transition-all duration-200 hover:shadow-md ${u?"border-l-4 border-l-blue-500":""}`,children:(0,d.jsx)(f.CardContent,{className:`${u?"p-3":"p-6"}`,children:(0,d.jsx)("div",{className:"flex items-start justify-between",children:(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,d.jsx)("div",{className:`p-1.5 rounded-lg ${a.bgColor} ${u?"p-1":"p-2"}`,children:(0,d.jsx)("div",{className:u?"scale-75":"",children:a.icon})}),(0,d.jsx)("p",{className:`text-sm font-medium text-gray-600 ${u?"text-xs leading-tight":""}`,children:a.title})]}),(0,d.jsx)("div",{className:`${a.color} font-bold mb-1 ${u?"text-lg":"text-2xl"}`,children:a.value}),(0,d.jsx)("p",{className:`text-muted-foreground ${u?"text-xs leading-tight":"text-xs"}`,children:a.description})]})})})},b))})});a.s(["default",0,p]),c()}catch(a){c(a)}},!1),345545,a=>{"use strict";let b=(0,a.i(564375).default)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);a.s(["Lock",()=>b],345545)},671727,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(811705),f=a.i(379035),g=a.i(612485),h=a.i(742093),i=a.i(739362),j=a.i(855423),k=a.i(563641),l=a.i(698887),m=a.i(792371),n=a.i(504073),o=a.i(345545),p=a.i(558277),q=b([e]);[e]=q.then?(await q)():q;let r=({active:a,payload:b,label:c,formatCurrency:e})=>a&&b&&b.length?(0,d.jsxs)("div",{className:"bg-white p-3 border border-gray-200 shadow-lg rounded-lg",children:[(0,d.jsx)("p",{className:"font-medium text-sm text-gray-900",children:`${c}`}),(0,d.jsxs)("p",{className:"text-sm text-blue-600",children:[(0,d.jsx)("span",{className:"font-medium",children:"Amount: "}),(0,d.jsx)("span",{className:"font-bold",children:e(b[0].value)})]})]}):null;a.s(["default",0,({data:a,formatCurrency:b})=>{let c=(0,p.useIsMobile)(),q=a.map((a,b)=>{let c;return{...a,fill:(c=a.name.toLowerCase()).includes("sales")?"#3B82F6":c.includes("cost")?"#EF4444":c.includes("expenses")?"#8B5CF6":c.includes("profit")?"#10B981":"#6B7280"}});return(0,d.jsxs)(e.Card,{className:"w-full shadow-sm",children:[(0,d.jsxs)(e.CardHeader,{className:c?"pb-3":"pb-4",children:[(0,d.jsx)(e.CardTitle,{className:c?"text-lg":"text-xl",children:"Financial Overview"}),(0,d.jsx)(e.CardDescription,{className:c?"text-sm":"",children:"Sales, costs, expenses, and profits (excluding quotes)"})]}),(0,d.jsxs)(e.CardContent,{className:c?"p-4 pt-0":"p-6 pt-0",children:[(0,d.jsx)("div",{className:`w-full ${c?"h-64":"h-80"}`,children:a.length>0?(0,d.jsx)(l.ResponsiveContainer,{width:"100%",height:"100%",children:(0,d.jsxs)(f.BarChart,{data:q,margin:{top:5,right:c?10:30,left:c?10:20,bottom:5},children:[(0,d.jsx)(j.CartesianGrid,{strokeDasharray:"3 3",stroke:"#f0f0f0",opacity:.5}),(0,d.jsx)(h.XAxis,{dataKey:"name",tick:{fontSize:c?10:12,fill:"#6B7280"},tickLine:!1,axisLine:{stroke:"#e0e0e0"},angle:c?-45:0,textAnchor:c?"end":"middle",height:c?50:30}),(0,d.jsx)(i.YAxis,{tickFormatter:a=>b(a),tick:{fontSize:c?10:12,fill:"#6B7280"},tickLine:!1,axisLine:{stroke:"#e0e0e0"},width:c?60:80}),(0,d.jsx)(k.Tooltip,{content:(0,d.jsx)(r,{formatCurrency:b}),cursor:{fill:"rgba(59, 130, 246, 0.1)"}}),!c&&(0,d.jsx)(m.Legend,{wrapperStyle:{paddingTop:15,fontSize:12,color:"#6B7280"}}),(0,d.jsx)(g.Bar,{dataKey:"amount",name:"Amount",barSize:c?30:40,radius:[4,4,0,0],fillOpacity:.9,children:q.map((a,b)=>(0,d.jsx)(n.Cell,{fill:a.fill},`cell-${b}`))})]})}):(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground space-y-2",children:[(0,d.jsx)(o.Lock,{className:"h-8 w-8 opacity-20"}),(0,d.jsx)("p",{children:"Private data restricted"})]})}),c&&(0,d.jsx)("div",{className:"flex flex-wrap justify-center gap-3 mt-4 pt-3 border-t",children:q.map((a,b)=>(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:a.fill}}),(0,d.jsx)("span",{className:"text-xs text-gray-600 font-medium",children:a.name})]},b))})]})]})}]),c()}catch(a){c(a)}},!1),1216,a=>{"use strict";let b=["ðŸ’¡ Tip: Break your monthly goal into daily targets. Small consistent actions lead to big results!","ðŸŽ¯ Focus: Review your progress weekly and adjust your strategies based on what's working.","ðŸš€ Motivation: Every successful business started with a single sale. Keep pushing forward!","ðŸ“Š Strategy: Track your conversion rates to identify which sales approaches work best.","ðŸ’ª Mindset: Treat every 'no' as one step closer to your next 'yes'. Persistence pays off!","ðŸŒŸ Excellence: Quality over quantity - focus on building lasting customer relationships.","â° Efficiency: Time-block your sales activities to maximize productivity and focus.","ðŸŽ‰ Celebration: Acknowledge small wins along the way - they fuel motivation for bigger goals!","ðŸ“ˆ Growth: Analyze your best-performing days and replicate those successful patterns.","ðŸ¤ Networking: Strong relationships with customers often lead to referrals and repeat business.","ðŸ’¼ Professionalism: Your reputation is your most valuable asset - protect and nurture it.","ðŸ” Analysis: Use data to guide your decisions, not just gut feelings.","ðŸŽ¨ Creativity: Try new approaches to reach customers and stand out from competitors.","âš¡ Action: Don't wait for perfect conditions - take imperfect action and adjust as you go.","ðŸ§  Learning: Invest time in learning about your industry, customers, and sales techniques.","ðŸ”„ Consistency: Show up daily - consistent effort compounds over time.","ðŸ‘‚ Listening: Your customers' feedback is gold. Listen carefully and adapt accordingly.","ðŸ“± Reach: Leverage all available channels to maximize your market visibility.","ðŸ§© Solutions: Focus on solving problems for customers rather than just selling products.","âš–ï¸ Balance: Maintain a healthy work-life balance to prevent burnout and stay motivated.","ðŸ“ Planning: End each day by preparing your top priorities for tomorrow.","ðŸŒ± Growth: Invest in your skills - the best investment is in yourself.","ðŸ¤” Reflection: Take time to reflect on what worked and what didn't each week.","ðŸ† Excellence: Set standards higher than your competition to truly stand out.","ðŸ“£ Voice: Develop a unique brand voice that resonates with your target audience.","ðŸ“š Knowledge: Know your products inside and out - expertise builds customer trust.","ðŸŽ­ Adaptability: Stay flexible and ready to pivot when market conditions change.","ðŸ”— Connection: Build genuine connections with customers beyond just transactions.","ðŸŒ Expansion: Consider new markets or segments that might benefit from your offerings.","ðŸ™ Gratitude: Express appreciation to your customers regularly - loyalty is earned."];a.s(["getTodaysTip",0,()=>{let a=(new Date().getDate()-1)%b.length;return b[a]}])},124052,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(1216),f=a.i(677581),g=a.i(767810),h=b([g]);[g]=h.then?(await h)():h,a.s(["default",0,()=>{let a=(0,e.getTodaysTip)();return(0,d.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,d.jsxs)("div",{className:"flex items-start gap-2",children:[(0,d.jsx)(f.Lightbulb,{className:"h-4 w-4 text-amber-500 mt-0.5 flex-shrink-0"}),(0,d.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,d.jsx)("span",{className:"font-medium text-amber-600",children:"Business Goals Tip:"})," ",(0,d.jsx)("span",{children:a}),(0,d.jsx)(g.TooltipProvider,{children:(0,d.jsxs)(g.Tooltip,{children:[(0,d.jsx)(g.TooltipTrigger,{asChild:!0,children:(0,d.jsx)("span",{className:"ml-1 cursor-help text-gray-400 hover:text-gray-600 text-xs",children:"(New tip daily)"})}),(0,d.jsx)(g.TooltipContent,{side:"bottom",className:"max-w-xs",children:(0,d.jsx)("p",{className:"text-xs",children:"Tips refresh each day to help you stay motivated and reach your sales goals."})})]})})]})]})})}]),c()}catch(a){c(a)}},!1),199628,a=>a.a(async(b,c)=>{try{a.i(508171),a.i(127669),a.i(811705),a.i(112779),a.i(396465),a.i(482626),a.i(148608),a.i(500885);let b=Error("Cannot find module '@/integrations/supabase/client'");throw b.code="MODULE_NOT_FOUND",b}catch(a){c(a)}},!1),767180,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(811705),f=a.i(799856),g=a.i(558277),h=a.i(747899),i=a.i(767810),j=a.i(625250),k=b([e,f,i,j]);[e,f,i,j]=k.then?(await k)():k,a.s(["default",0,({recentSales:a,currency:b})=>{let c=(0,g.useIsMobile)(),k=(0,h.useNavigate)(),{canViewCostPrice:l,canViewProfit:m,canViewAvgPrice:n,canViewTotalAmount:o}=(0,j.useFinancialVisibility)(),p=a=>{k("/new-sale",{state:{editSale:a}})};return 0===a.length?(0,d.jsxs)(e.Card,{children:[(0,d.jsxs)(e.CardHeader,{className:c?"p-4":"",children:[(0,d.jsx)(e.CardTitle,{className:c?"text-lg":"",children:"Recent Sales"}),(0,d.jsx)(e.CardDescription,{className:c?"text-xs":"",children:"Your latest transactions"})]}),(0,d.jsx)(e.CardContent,{children:(0,d.jsx)("div",{className:"py-12 text-center",children:(0,d.jsx)("p",{className:"text-muted-foreground",children:"No recent sales"})})})]}):c?(0,d.jsxs)(e.Card,{children:[(0,d.jsxs)(e.CardHeader,{className:"p-4",children:[(0,d.jsx)(e.CardTitle,{className:"text-lg",children:"Recent Sales"}),(0,d.jsx)(e.CardDescription,{className:"text-xs",children:"Your latest transactions"})]}),(0,d.jsx)(e.CardContent,{className:"p-4 pt-0",children:(0,d.jsx)("div",{className:"space-y-3",children:a.map(a=>{let c=a.items.reduce((a,b)=>{let c=b.price*b.quantity,d=c*(b.discountPercentage||0)/100;return a+(c-d)},0),e=a.items.reduce((a,b)=>{let c=b.price*b.quantity*(b.discountPercentage||0)/100;return a+c},0),g=a.taxRate||0,h=c+g/100*c,j=a.items&&Array.isArray(a.items)?a.items.reduce((a,b)=>a+b.cost*b.quantity,0):0,k="No items";return a.items&&Array.isArray(a.items)&&a.items.length>0&&(k=a.items[0].description,a.items.length>1&&(k+=` (+${a.items.length-1} more)`)),(0,d.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm cursor-pointer hover:shadow-md transition-shadow",onClick:()=>p(a),children:[(0,d.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("p",{className:"font-semibold text-gray-900 text-base truncate",children:a.customerName}),(0,d.jsxs)(i.Tooltip,{children:[(0,d.jsx)(i.TooltipTrigger,{asChild:!0,children:(0,d.jsx)("p",{className:"text-sm text-gray-600 mt-1 line-clamp-1 cursor-help",children:k})}),(0,d.jsx)(i.TooltipContent,{side:"top",className:"max-w-xs",children:(0,d.jsx)("div",{className:"space-y-1",children:(0,d.jsx)("p",{className:"font-bold break-words whitespace-normal",children:k})})})]})]}),(0,d.jsx)("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap ml-2 ${"Paid"===a.paymentStatus?"bg-green-100 text-green-800":"Quote"===a.paymentStatus?"bg-purple-100 text-purple-800":"Installment Sale"===a.paymentStatus?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:"NOT PAID"===a.paymentStatus?"Credit":"Installment Sale"===a.paymentStatus?"Installment":a.paymentStatus})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4 py-3 bg-gray-50 rounded-lg mb-3",children:[(0,d.jsxs)("div",{className:"text-center border-r border-gray-200",children:[(0,d.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Cost"}),(0,d.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:l?`${b} ${(0,f.formatNumber)(j)}`:"â€¢â€¢â€¢"})]}),(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Discount"}),(0,d.jsx)("p",{className:`text-sm font-semibold ${e>0?"text-orange-600":"text-gray-400"}`,children:e>0?`-${b} ${(0,f.formatNumber)(e)}`:"-"})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4 py-3 bg-gray-50 rounded-lg",children:[(0,d.jsxs)("div",{className:"text-center border-r border-gray-200",children:[(0,d.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Avg Price"}),(0,d.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:n?`${b} ${(0,f.formatNumber)(h/a.items.reduce((a,b)=>a+b.quantity,0))}`:"â€¢â€¢â€¢"})]}),(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Total Amount"}),(0,d.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:o?`${b} ${(0,f.formatNumber)(h)}`:"â€¢â€¢â€¢"})]})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center mt-3 pt-2 border-t border-gray-100",children:[(0,d.jsxs)("div",{className:"text-left",children:[(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Profit"}),(0,d.jsx)("p",{className:"text-sm font-semibold text-green-600",children:m?`${b} ${(0,f.formatNumber)(h-j)}`:"â€¢â€¢â€¢"})]}),(0,d.jsx)("div",{className:"text-right",children:(0,d.jsx)("p",{className:"text-xs text-gray-500",children:new Date(a.date).toLocaleDateString("en-GB")})})]})]},a.id)})})})]}):(0,d.jsx)(i.TooltipProvider,{children:(0,d.jsxs)(e.Card,{children:[(0,d.jsxs)(e.CardHeader,{children:[(0,d.jsx)(e.CardTitle,{children:"Recent Sales"}),(0,d.jsx)(e.CardDescription,{children:"Your latest 20 transactions"})]}),(0,d.jsx)(e.CardContent,{children:(0,d.jsx)("div",{className:"overflow-x-auto",children:(0,d.jsxs)("table",{className:"w-full text-sm",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{className:"border-b",children:[(0,d.jsx)("th",{className:"py-3 text-left",children:"Date"}),(0,d.jsx)("th",{className:"py-3 text-left",children:"Receipt #"}),(0,d.jsx)("th",{className:"py-3 text-left",children:"Customer"}),(0,d.jsx)("th",{className:"py-3 text-left",children:"Item"}),(0,d.jsx)("th",{className:"py-3 text-right",children:"Total Qty"}),(0,d.jsx)("th",{className:"py-3 text-right",children:"Avg Price"}),(0,d.jsx)("th",{className:"py-3 text-right",children:"Discount"}),l&&(0,d.jsx)("th",{className:"py-3 text-right",children:"Cost"}),m&&(0,d.jsx)("th",{className:"py-3 text-right",children:"Profit"}),(0,d.jsx)("th",{className:"py-3 text-right",children:"Total (incl. Tax)"}),(0,d.jsx)("th",{className:"py-3 text-left",children:"Status"})]})}),(0,d.jsx)("tbody",{children:a.map(a=>{let c=a.items.reduce((a,b)=>a+b.quantity,0),e=a.items.reduce((a,b)=>{let c=b.price*b.quantity,d=c*(b.discountPercentage||0)/100;return a+(c-d)},0),g=a.items.reduce((a,b)=>{let c=b.price*b.quantity*(b.discountPercentage||0)/100;return a+c},0),h=a.taxRate||0,j=e+h/100*e,k=a.items.reduce((a,b)=>a+b.cost*b.quantity,0),q="No items";return a.items&&Array.isArray(a.items)&&a.items.length>0&&(q=a.items[0].description,a.items.length>1&&(q+=` (+${a.items.length-1} more)`)),(0,d.jsxs)("tr",{className:"border-b cursor-pointer hover:bg-gray-50",onClick:()=>p(a),children:[(0,d.jsx)("td",{className:"py-3",children:new Date(a.date).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})}),(0,d.jsx)("td",{className:"py-3",children:a.receiptNumber}),(0,d.jsx)("td",{className:"py-3",children:a.customerName}),(0,d.jsx)("td",{className:"py-3 max-w-xs truncate",children:(0,d.jsxs)(i.Tooltip,{children:[(0,d.jsx)(i.TooltipTrigger,{asChild:!0,children:(0,d.jsx)("span",{className:"cursor-help",children:q})}),(0,d.jsx)(i.TooltipContent,{side:"top",className:"max-w-xs",children:(0,d.jsx)("div",{className:"space-y-1",children:(0,d.jsx)("p",{className:"font-bold break-words whitespace-normal",children:q})})})]})}),(0,d.jsx)("td",{className:"py-3 text-right",children:c}),(0,d.jsx)("td",{className:"py-3 text-right",children:n?`${b} ${(0,f.formatNumber)(c>0?e/c:0)}`:"â€¢â€¢â€¢"}),(0,d.jsx)("td",{className:"py-3 text-right",children:g>0?(0,d.jsxs)("span",{className:"text-orange-600",children:["-",b," ",(0,f.formatNumber)(g)]}):(0,d.jsx)("span",{className:"text-gray-400",children:"-"})}),l&&(0,d.jsxs)("td",{className:"py-3 text-right",children:[b," ",(0,f.formatNumber)(k)]}),m&&(0,d.jsx)("td",{className:"py-3 text-right",children:(0,d.jsxs)("span",{className:"text-green-600 font-medium",children:[b," ",(0,f.formatNumber)(j-k)]})}),(0,d.jsx)("td",{className:"py-3 text-right",children:o?(0,d.jsxs)(d.Fragment,{children:[b," ",(0,f.formatNumber)(j),"Installment Sale"===a.paymentStatus&&a.amountPaid&&(0,d.jsxs)("div",{className:"text-xs text-green-600",children:["Paid: ",b," ",(0,f.formatNumber)(a.amountPaid)]})]}):"â€¢â€¢â€¢"}),(0,d.jsx)("td",{className:"py-3",children:(0,d.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${"Paid"===a.paymentStatus?"bg-green-100 text-green-800":"Quote"===a.paymentStatus?"bg-purple-100 text-purple-800":"Installment Sale"===a.paymentStatus?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:"NOT PAID"===a.paymentStatus?"Credit":"Installment Sale"===a.paymentStatus?"Installment":a.paymentStatus})})]},a.id)})})]})})})]})})}]),c()}catch(a){c(a)}},!1),887358,a=>{"use strict";var b=a.i(127669),c=a.i(346350),d=a.i(933029),e=a.i(687620),f=a.i(442558),g=a.i(195558),h=a.i(149795),i=a.i(673486),j=a.i(440794),k=a.i(546488),l=a.i(124501),m=a.i(323122),n=a.i(440063),o=a.i(234035),p=a.i(597918),q=["type","layout","connectNulls","ref"],r=["key"];function s(a){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function t(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c={};for(var d in a)if(Object.prototype.hasOwnProperty.call(a,d)){if(b.indexOf(d)>=0)continue;c[d]=a[d]}return c}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(b.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}function u(){return(u=Object.assign.bind()).apply(this,arguments)}function v(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function w(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?v(Object(c),!0).forEach(function(b){D(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):v(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function x(a){return function(a){if(Array.isArray(a))return y(a)}(a)||function(a){if("u">typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||function(a,b){if(a){if("string"==typeof a)return y(a,void 0);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c)return Array.from(a);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return y(a,void 0)}}(a)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function z(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,E(d.key),d)}}function A(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(A=function(){return!!a})()}function B(a){return(B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function C(a,b){return(C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a})(a,b)}function D(a,b,c){return(b=E(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function E(a){var b=function(a,b){if("object"!=s(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=s(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==s(b)?b:b+""}var F=function(a){var o,v;function y(){var a,b,c;if(!(this instanceof y))throw TypeError("Cannot call a class as a function");for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return b=y,c=[].concat(e),b=B(b),D(a=function(a,b){if(b&&("object"===s(b)||"function"==typeof b))return b;if(void 0!==b)throw TypeError("Derived constructors may only return object or undefined");var c=a;if(void 0===c)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(this,A()?Reflect.construct(b,c||[],B(this).constructor):b.apply(this,c)),"state",{isAnimationFinished:!0,totalLength:0}),D(a,"generateSimpleStrokeDasharray",function(a,b){return"".concat(b,"px ").concat(a-b,"px")}),D(a,"getStrokeDasharray",function(b,c,d){var e=d.reduce(function(a,b){return a+b});if(!e)return a.generateSimpleStrokeDasharray(c,b);for(var f=Math.floor(b/e),g=b%e,h=c-b,i=[],j=0,k=0;j<d.length;k+=d[j],++j)if(k+d[j]>g){i=[].concat(x(d.slice(0,j)),[g-k]);break}var l=i.length%2==0?[0,h]:[h];return[].concat(x(y.repeat(d,f)),x(i),l).map(function(a){return"".concat(a,"px")}).join(", ")}),D(a,"id",(0,m.uniqueId)("recharts-line-")),D(a,"pathRef",function(b){a.mainCurve=b}),D(a,"handleAnimationEnd",function(){a.setState({isAnimationFinished:!0}),a.props.onAnimationEnd&&a.props.onAnimationEnd()}),D(a,"handleAnimationStart",function(){a.setState({isAnimationFinished:!1}),a.props.onAnimationStart&&a.props.onAnimationStart()}),a}if("function"!=typeof a&&null!==a)throw TypeError("Super expression must either be null or a function");return y.prototype=Object.create(a&&a.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),Object.defineProperty(y,"prototype",{writable:!1}),a&&C(y,a),o=[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var a=this.getTotalLength();this.setState({totalLength:a})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var a=this.getTotalLength();a!==this.state.totalLength&&this.setState({totalLength:a})}}},{key:"getTotalLength",value:function(){var a=this.mainCurve;try{return a&&a.getTotalLength&&a.getTotalLength()||0}catch(a){return 0}}},{key:"renderErrorBar",value:function(a,c){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var d=this.props,e=d.points,f=d.xAxis,g=d.yAxis,h=d.layout,i=d.children,k=(0,n.findAllByType)(i,l.ErrorBar);if(!k)return null;var m=function(a,b){return{x:a.x,y:a.y,value:a.value,errorVal:(0,p.getValueByDataKey)(a.payload,b)}};return b.default.createElement(j.Layer,{clipPath:a?"url(#clipPath-".concat(c,")"):null},k.map(function(a){return b.default.cloneElement(a,{key:"bar-".concat(a.props.dataKey),data:e,xAxis:f,yAxis:g,layout:h,dataPointFormatter:m})}))}},{key:"renderDots",value:function(a,c,d){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var e=this.props,f=e.dot,g=e.points,h=e.dataKey,i=(0,n.filterProps)(this.props,!1),k=(0,n.filterProps)(f,!0),l=g.map(function(a,b){var c=w(w(w({key:"dot-".concat(b),r:3},i),k),{},{index:b,cx:a.x,cy:a.y,value:a.value,dataKey:h,payload:a.payload,points:g});return y.renderDotItem(f,c)}),m={clipPath:a?"url(#clipPath-".concat(c?"":"dots-").concat(d,")"):null};return b.default.createElement(j.Layer,u({className:"recharts-line-dots",key:"dots"},m),l)}},{key:"renderCurveStatically",value:function(a,c,d,e){var f=this.props,g=f.type,i=f.layout,j=f.connectNulls,k=(f.ref,t(f,q)),l=w(w(w({},(0,n.filterProps)(k,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:c?"url(#clipPath-".concat(d,")"):null,points:a},e),{},{type:g,layout:i,connectNulls:j});return b.default.createElement(h.Curve,u({},l,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(a,d){var e=this,f=this.props,g=f.points,h=f.strokeDasharray,i=f.isAnimationActive,j=f.animationBegin,k=f.animationDuration,l=f.animationEasing,n=f.animationId,o=f.animateNewValues,p=f.width,q=f.height,r=this.state,s=r.prevPoints,t=r.totalLength;return b.default.createElement(c.default,{begin:j,duration:k,isActive:i,easing:l,from:{t:0},to:{t:1},key:"line-".concat(n),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(b){var c,f=b.t;if(s){var i=s.length/g.length,j=g.map(function(a,b){var c=Math.floor(b*i);if(s[c]){var d=s[c],e=(0,m.interpolateNumber)(d.x,a.x),g=(0,m.interpolateNumber)(d.y,a.y);return w(w({},a),{},{x:e(f),y:g(f)})}if(o){var h=(0,m.interpolateNumber)(2*p,a.x),j=(0,m.interpolateNumber)(q/2,a.y);return w(w({},a),{},{x:h(f),y:j(f)})}return w(w({},a),{},{x:a.x,y:a.y})});return e.renderCurveStatically(j,a,d)}var k=(0,m.interpolateNumber)(0,t)(f);if(h){var l="".concat(h).split(/[,\s]+/gim).map(function(a){return parseFloat(a)});c=e.getStrokeDasharray(k,t,l)}else c=e.generateSimpleStrokeDasharray(t,k);return e.renderCurveStatically(g,a,d,{strokeDasharray:c})})}},{key:"renderCurve",value:function(a,b){var c=this.props,d=c.points,e=c.isAnimationActive,g=this.state,h=g.prevPoints,i=g.totalLength;return e&&d&&d.length&&(!h&&i>0||!(0,f.default)(h,d))?this.renderCurveWithAnimation(a,b):this.renderCurveStatically(d,a,b)}},{key:"render",value:function(){var a,c=this.props,d=c.hide,f=c.dot,h=c.points,i=c.className,l=c.xAxis,m=c.yAxis,o=c.top,p=c.left,q=c.width,r=c.height,s=c.isAnimationActive,t=c.id;if(d||!h||!h.length)return null;var u=this.state.isAnimationFinished,v=1===h.length,w=(0,g.default)("recharts-line",i),x=l&&l.allowDataOverflow,y=m&&m.allowDataOverflow,z=x||y,A=(0,e.default)(t)?this.id:t,B=null!=(a=(0,n.filterProps)(f,!1))?a:{r:3,strokeWidth:2},C=B.r,D=B.strokeWidth,E=((0,n.hasClipDot)(f)?f:{}).clipDot,F=void 0===E||E,G=2*(void 0===C?3:C)+(void 0===D?2:D);return b.default.createElement(j.Layer,{className:w},x||y?b.default.createElement("defs",null,b.default.createElement("clipPath",{id:"clipPath-".concat(A)},b.default.createElement("rect",{x:x?p:p-q/2,y:y?o:o-r/2,width:x?q:2*q,height:y?r:2*r})),!F&&b.default.createElement("clipPath",{id:"clipPath-dots-".concat(A)},b.default.createElement("rect",{x:p-G/2,y:o-G/2,width:q+G,height:r+G}))):null,!v&&this.renderCurve(z,A),this.renderErrorBar(z,A),(v||f)&&this.renderDots(z,F,A),(!s||u)&&k.LabelList.renderCallByParent(this.props,h))}}],v=[{key:"getDerivedStateFromProps",value:function(a,b){return a.animationId!==b.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,prevPoints:b.curPoints}:a.points!==b.curPoints?{curPoints:a.points}:null}},{key:"repeat",value:function(a,b){for(var c=a.length%2!=0?[].concat(x(a),[0]):a,d=[],e=0;e<b;++e)d=[].concat(x(d),x(c));return d}},{key:"renderDotItem",value:function(a,c){var e;if(b.default.isValidElement(a))e=b.default.cloneElement(a,c);else if((0,d.default)(a))e=a(c);else{var f=c.key,h=t(c,r),j=(0,g.default)("recharts-line-dot","boolean"!=typeof a?a.className:"");e=b.default.createElement(i.Dot,u({key:f},h,{className:j}))}return e}}],o&&z(y.prototype,o),v&&z(y,v),Object.defineProperty(y,"prototype",{writable:!1}),y}(b.PureComponent);D(F,"displayName","Line"),D(F,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!o.Global.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1}),D(F,"getComposedData",function(a){var b=a.props,c=a.xAxis,d=a.yAxis,f=a.xAxisTicks,g=a.yAxisTicks,h=a.dataKey,i=a.bandSize,j=a.displayedData,k=a.offset,l=b.layout;return w({points:j.map(function(a,b){var j=(0,p.getValueByDataKey)(a,h);return"horizontal"===l?{x:(0,p.getCateCoordinateOfLine)({axis:c,ticks:f,bandSize:i,entry:a,index:b}),y:(0,e.default)(j)?null:d.scale(j),value:j,payload:a}:{x:(0,e.default)(j)?null:c.scale(j),y:(0,p.getCateCoordinateOfLine)({axis:d,ticks:g,bandSize:i,entry:a,index:b}),value:j,payload:a}}),layout:l},k)}),a.s(["Line",()=>F])},530548,a=>{"use strict";var b=a.i(703737),c=a.i(887358),d=a.i(742093),e=a.i(739362),f=a.i(672588),g=(0,b.generateCategoricalChart)({chartName:"LineChart",GraphicalChild:c.Line,axisComponents:[{axisType:"xAxis",AxisComp:d.XAxis},{axisType:"yAxis",AxisComp:e.YAxis}],formatAxisMap:f.formatAxisMap});a.s(["LineChart",()=>g])},345899,a=>{"use strict";let b=(0,a.i(564375).default)("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);a.s(["ChartLine",()=>b],345899)},766005,a=>a.a(async(b,c)=>{try{var d=a.i(150848),e=b([d]);async function f(a,b,c){try{let e={branchId:a};return(b||c)&&(e.date={},b&&(e.date.gte=new Date(b)),c&&(e.date.lte=new Date(c))),(await d.db.expense.findMany({where:e,select:{date:!0,amount:!0}})).map(a=>({date:a.date.toISOString(),amount:Number(a.amount)}))}catch(a){return console.error("[getExpensesForChartAction]",a),[]}}[d]=e.then?(await e)():e,a.s(["getExpensesForChartAction",()=>f]),c()}catch(a){c(a)}},!1),924645,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(811705),g=a.i(148608),h=a.i(688272),i=a.i(530548),j=a.i(887358),k=a.i(742093),l=a.i(739362),m=a.i(855423),n=a.i(563641),o=a.i(792371),p=a.i(698887),q=a.i(345545),r=a.i(345899),s=a.i(792071),t=a.i(122460),u=a.i(126554),v=a.i(759447),w=a.i(178465),x=a.i(385674),y=a.i(304050),z=a.i(284177),A=a.i(671693),B=a.i(460716),C=a.i(665376),D=a.i(128069),E=a.i(964889),F=a.i(625250),G=a.i(766005),H=b([f,g,h,E,F,G]);[f,g,h,E,F,G]=H.then?(await H)():H,a.s(["default",0,({sales:a,formatCurrency:b,dateFilter:c="this-month",dateRange:H={from:void 0,to:void 0},isCustomRange:I=!1})=>{let{currentBusiness:J}=(0,E.useBusiness)(),{canViewTotalSales:K,canViewTotalExpenses:L}=(0,F.useFinancialVisibility)(),[M,N]=(0,e.useState)("monthly"),[O,P]=(0,e.useState)(new Date().getFullYear().toString()),[Q,R]=(0,e.useState)([]),S=new Date().getFullYear(),T=[...new Set(a.map(a=>new Date(a.date).getFullYear()))].sort((a,b)=>b-a);0===T.length&&T.push(S),(0,e.useEffect)(()=>{(async()=>{let a,b;if(!J?.id)return R([]);if(I&&H.from&&H.to)a=H.from.toISOString(),b=H.to.toISOString();else if(c&&"all"!==c&&"this-month"!==c){let d=new Date;switch(c){case"today":a=(0,C.startOfDay)(d).toISOString(),b=(0,D.endOfDay)(d).toISOString();break;case"yesterday":{let c=(0,z.subDays)(d,1);a=(0,C.startOfDay)(c).toISOString(),b=(0,D.endOfDay)(c).toISOString();break}case"this-week":a=(0,t.startOfWeek)(d,{weekStartsOn:1}).toISOString(),b=(0,u.endOfWeek)(d,{weekStartsOn:1}).toISOString();break;case"last-week":{let c=(0,A.subWeeks)((0,t.startOfWeek)(d,{weekStartsOn:1}),1);a=c.toISOString(),b=(0,u.endOfWeek)(c,{weekStartsOn:1}).toISOString();break}case"last-month":{let c=(0,B.subMonths)(d,1);a=(0,v.startOfMonth)(c).toISOString(),b=(0,w.endOfMonth)(c).toISOString();break}case"this-year":a=(0,x.startOfYear)(d).toISOString(),b=(0,y.endOfYear)(d).toISOString();break;default:{let c=parseInt(O);a=new Date(c,0,1).toISOString(),b=new Date(c,11,31).toISOString()}}}else{let c=parseInt(O);a=new Date(c,0,1).toISOString(),b=new Date(c,11,31).toISOString()}try{let c=await (0,G.getExpensesForChartAction)(J.id,a,b);R(c||[])}catch(a){console.error("Error fetching expenses data:",a)}})()},[M,O,c,H,I,J?.id]);let U=a=>a.reduce((a,b)=>a+(Array.isArray(b.items)?b.items.reduce((a,b)=>a+b.price*b.quantity,0):0),0),V=a=>a.reduce((a,b)=>a+Number(b.amount),0),W=(()=>{let b=(()=>{let b=a.filter(a=>"Quote"!==a.paymentStatus);if(I&&H.from&&H.to)return b.filter(a=>{let b=new Date(a.date);return b>=(0,C.startOfDay)(H.from)&&b<=(0,D.endOfDay)(H.to)});if(c&&"all"!==c&&"this-month"!==c){let a=new Date;return b.filter(b=>{let d=new Date(b.date);switch(c){case"today":return d>=(0,C.startOfDay)(a)&&d<=(0,D.endOfDay)(a);case"yesterday":{let b=(0,z.subDays)(a,1);return d>=(0,C.startOfDay)(b)&&d<=(0,D.endOfDay)(b)}case"this-week":return d>=(0,t.startOfWeek)(a,{weekStartsOn:1})&&d<=(0,u.endOfWeek)(a,{weekStartsOn:1});case"last-week":{let b=(0,A.subWeeks)((0,t.startOfWeek)(a,{weekStartsOn:1}),1);return d>=b&&d<=(0,u.endOfWeek)(b,{weekStartsOn:1})}case"last-month":{let b=(0,B.subMonths)(a,1);return d>=(0,v.startOfMonth)(b)&&d<=(0,w.endOfMonth)(b)}case"this-year":return d>=(0,x.startOfYear)(a)&&d<=(0,y.endOfYear)(a);default:return!0}})}return b.filter(a=>new Date(a.date).getFullYear()===parseInt(O))})();if("weekly"===M){let a=(0,t.startOfWeek)(new Date,{weekStartsOn:1});return Array.from({length:7},(c,d)=>{let e=new Date(a);e.setDate(a.getDate()+d);let f=e.toDateString();return{date:(0,s.format)(e,"yyyy-MM-dd"),displayDate:(0,s.format)(e,"EEE"),amount:U(b.filter(a=>new Date(a.date).toDateString()===f)),expenses:V(Q.filter(a=>new Date(a.date).toDateString()===f)),rawDate:e}})}if("monthly"===M){let a=parseInt(O);return Array.from({length:12},(c,d)=>{let e=new Date(a,d,1),f=(0,v.startOfMonth)(e),g=(0,w.endOfMonth)(e);return{date:(0,s.format)(e,"yyyy-MM"),displayDate:(0,s.format)(e,"MMM"),amount:U(b.filter(a=>{let b=new Date(a.date);return b>=f&&b<=g})),expenses:V(Q.filter(a=>{let b=new Date(a.date);return b>=f&&b<=g})),rawDate:e}})}return"yearly"===M?T.map(a=>{let c=(0,x.startOfYear)(new Date(a,0,1)),d=(0,y.endOfYear)(new Date(a,0,1));return{date:a.toString(),displayDate:a.toString(),amount:U(b.filter(a=>{let b=new Date(a.date);return b>=c&&b<=d})),expenses:V(Q.filter(a=>{let b=new Date(a.date);return b>=c&&b<=d})),rawDate:new Date(a,0,1)}}):[]})();return(0,d.jsxs)(f.Card,{className:"mb-6",children:[(0,d.jsx)(f.CardHeader,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,d.jsx)(r.ChartLine,{className:"h-5 w-5"})," Performance Analysis"]}),(0,d.jsx)(f.CardDescription,{children:"Visualize your sales and expenses over time"})]}),(0,d.jsxs)(h.Select,{value:O,onValueChange:P,children:[(0,d.jsx)(h.SelectTrigger,{className:"w-[100px]",children:(0,d.jsx)(h.SelectValue,{placeholder:"Year"})}),(0,d.jsx)(h.SelectContent,{children:T.map(a=>(0,d.jsx)(h.SelectItem,{value:a.toString(),children:a},a))})]})]})}),(0,d.jsx)(f.CardContent,{children:(0,d.jsxs)(g.Tabs,{defaultValue:"monthly",value:M,onValueChange:N,className:"w-full",children:[(0,d.jsxs)(g.TabsList,{className:"mb-4",children:[(0,d.jsx)(g.TabsTrigger,{value:"weekly",children:"Weekly"}),(0,d.jsx)(g.TabsTrigger,{value:"monthly",children:"Monthly"}),(0,d.jsx)(g.TabsTrigger,{value:"yearly",children:"Yearly"})]}),(0,d.jsx)("div",{className:"h-[300px] w-full",children:K||L?W.length>0?(0,d.jsx)(p.ResponsiveContainer,{width:"100%",height:"100%",children:(0,d.jsxs)(i.LineChart,{data:W,margin:{top:20,right:20,left:30,bottom:20},children:[(0,d.jsx)(m.CartesianGrid,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),(0,d.jsx)(k.XAxis,{dataKey:"displayDate",tick:{fontSize:12},tickLine:!1,axisLine:{stroke:"#e0e0e0"}}),(0,d.jsx)(l.YAxis,{tickFormatter:b,tick:{fontSize:12},tickLine:!1,axisLine:{stroke:"#e0e0e0"},width:80}),(0,d.jsx)(n.Tooltip,{content:(0,d.jsx)(({active:a,payload:c})=>{if(!a||!c?.length)return null;let e=c[0].payload;return(0,d.jsxs)("div",{className:"bg-white p-3 border border-gray-200 shadow-sm rounded-md",children:[(0,d.jsx)("p",{className:"font-medium text-sm",children:e.displayDate}),c.map((a,c)=>(0,d.jsxs)("p",{className:"text-sm",children:[(0,d.jsxs)("span",{className:"font-medium",children:[a.name,": "]}),b(a.value)]},c))]})},{})}),(0,d.jsx)(o.Legend,{}),K&&(0,d.jsx)(j.Line,{type:"monotone",dataKey:"amount",name:"Sales",stroke:"#9b87f5",activeDot:{r:8},strokeWidth:2}),L&&(0,d.jsx)(j.Line,{type:"monotone",dataKey:"expenses",name:"Expenses",stroke:"#E76F51",activeDot:{r:6},strokeWidth:2})]})}):(0,d.jsx)("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No data available for this time period"}):(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground space-y-2",children:[(0,d.jsx)(q.Lock,{className:"h-8 w-8 opacity-20"}),(0,d.jsx)("p",{children:"Private data restricted"})]})})]})})]})}]),c()}catch(a){c(a)}},!1),506870,a=>a.a(async(b,c)=>{try{var d=a.i(127669),e=a.i(108191),f=a.i(964889),g=a.i(852741),h=b([f]);[f]=h.then?(await h)():h,a.s(["useProductsBase",0,a=>{let[b,c]=(0,d.useState)([]),[h,i]=(0,d.useState)(!0),{toast:j}=(0,e.useToast)(),{currentBusiness:k}=(0,f.useBusiness)(),l=async()=>{try{if(!a||!k)return;i(!0);let b=await (0,g.getProductsAction)({userId:a,businessId:k.id,page:1,pageSize:1e3});return c(b.products),b.products}catch(a){return console.error("Error loading products:",a),j({title:"Error",description:"Failed to load products. Please try again.",variant:"destructive"}),[]}finally{i(!1)}};return(0,d.useEffect)(()=>{l()},[a,k?.id]),{products:b,isLoading:h,setProducts:c,loadProducts:l}}]),c()}catch(a){c(a)}},!1),475215,a=>a.a(async(b,c)=>{try{var d=a.i(508171),e=a.i(127669),f=a.i(60040),g=a.i(799856),h=a.i(558277),i=a.i(180852),j=a.i(860167),k=a.i(671727),l=a.i(199628),m=a.i(767180),n=a.i(924645),o=a.i(506870),p=a.i(531811),q=a.i(625250),r=b([f,g,i,j,k,l,m,n,o,p,q]);[f,g,i,j,k,l,m,n,o,p,q]=r.then?(await r)():r;let s={businessName:"Your Business Name",businessAddress:"Your Business Address",businessPhone:"(123) 456-7890",businessEmail:"support@yourbusiness.com",businessLogo:"",currency:"UGX"},t=(0,e.memo)(({sales:a,currency:b="UGX"})=>{(0,h.useIsMobile)();let{user:c}=(0,p.useAuth)(),[r,t]=(0,e.useState)({...s,currency:b}),[u,v]=(0,e.useState)("this-month"),[w,x]=(0,e.useState)({from:void 0,to:void 0}),[y,z]=(0,e.useState)(void 0),[A,B]=(0,e.useState)(!1),[C,D]=(0,e.useState)(!1),{products:E,isLoading:F}=(0,o.useProductsBase)(c?.id),{canViewCostPrice:G,canViewTotalSales:H,canViewTotalGrossProfit:I,canViewTotalExpenses:J,canViewInventoryValue:K,canViewSalesTypes:L}=(0,q.useFinancialVisibility)(),M=(0,e.useMemo)(()=>E&&0!==E.length&&G?E.reduce((a,b)=>a+b.costPrice*b.quantity,0):0,[E,G]),N=(0,e.useMemo)(()=>{let a={...s,currency:b},c=localStorage.getItem("businessSettings");if(c)try{let a=JSON.parse(c);return{...a,currency:b||a.currency}}catch{}return a},[b]);(0,e.useEffect)(()=>{t(N)},[N]);let O=(0,e.useMemo)(()=>a=>{v(a),"custom"===a?(B(!0),D(!1),z(void 0)):"specific"===a?(D(!0),B(!1),x({from:void 0,to:void 0})):(B(!1),D(!1),x({from:void 0,to:void 0}),z(void 0))},[]),P=(0,e.useMemo)(()=>a=>{x(a),a.from&&a.to&&(B(!0),v("custom"))},[]),Q=(0,e.useMemo)(()=>a=>{z(a),a&&(D(!0),v("specific"))},[]),{analyticsData:R,barChartData:S,recentSales:T,nonQuoteSalesCount:U,expenses:V,isLoadingExpenses:W}=(0,f.useAnalyticsData)({sales:a,dateFilter:u,dateRange:w,specificDate:y,isCustomRange:A,isSpecificDate:C}),X=a=>`${r.currency} ${(0,g.formatNumber)(a)}`;return(0,d.jsxs)("div",{className:"space-y-6 w-full",children:[(0,d.jsx)(i.default,{dateFilter:u,dateRange:w,specificDate:y,isCustomRange:A,isSpecificDate:C,onDateFilterChange:O,onDateRangeChange:P,onSpecificDateChange:Q}),(0,d.jsx)(j.default,{analyticsData:R,nonQuoteSalesCount:U,currency:r.currency,expenses:V,inventoryValue:M,canViewProfit:I,canViewTotalSales:H,canViewTotalExpenses:J,canViewInventoryValue:K,canViewSalesTypes:L}),(0,d.jsx)(n.default,{sales:a,formatCurrency:X,dateFilter:u,dateRange:w,isCustomRange:A}),(0,d.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[(0,d.jsx)("div",{className:"xl:col-span-2",children:(0,d.jsx)(k.default,{data:S.filter(a=>{let b=a.name.toLowerCase();return b.includes("sales")?H:b.includes("cost")||b.includes("expenses")?J:!b.includes("profit")||I}),formatCurrency:X})}),(0,d.jsx)("div",{className:"xl:col-span-1",children:(0,d.jsx)(l.default,{})})]}),(0,d.jsx)(m.default,{recentSales:T,currency:r.currency})]})});t.displayName="AnalyticsDashboard",a.s(["default",0,t]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=_43d5f0f7._.js.map