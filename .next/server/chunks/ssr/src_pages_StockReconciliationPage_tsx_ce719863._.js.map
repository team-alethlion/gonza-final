{"version":3,"sources":["../../../../src/pages/StockReconciliationPage.tsx","../../../../node_modules/lucide-react/src/icons/wrench.ts","../../../../node_modules/lucide-react/src/icons/package-plus.ts","../../../../node_modules/lucide-react/src/icons/package-minus.ts","../../../../src/components/inventory/StockReconciliation.tsx"],"sourcesContent":["\r\nimport React, { useState, useMemo } from 'react';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport StockReconciliation from '@/components/inventory/StockReconciliation';\r\nimport InventoryPageSkeleton from '@/components/inventory/InventoryPageSkeleton';\r\nimport { Product } from '@/types';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { toast } from 'sonner';\r\nimport { AlertCircle, TrendingDown, TrendingUp, PackagePlus, PackageMinus, Wrench } from 'lucide-react';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\nimport { Alert, AlertTitle, AlertDescription } from '@/components/ui/alert';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  getAllProductsAction\r\n} from '@/app/actions/products';\r\nimport {\r\n  getProductReconciliationAction,\r\n  getStockRepairsPreviewAction,\r\n  repairStockChainsAction,\r\n  createStockHistoryAction\r\n} from '@/app/actions/inventory';\r\nimport { format } from 'date-fns';\r\n\r\ninterface ReconciliationPreview {\r\n  product: Product;\r\n  currentStock: number;\r\n  calculatedStock: number;\r\n  discrepancy: number;\r\n  openingStock: number;\r\n  itemsSold: number;\r\n  stockAdded: number;\r\n  transferOut: number;\r\n  returnIn: number;\r\n  returnOut: number;\r\n  adjustments: number;\r\n  excludedSalesQty: number;\r\n  openingDate: string | null;\r\n  dailyBreakdown: Array<{\r\n    date: string;\r\n    startingStock: number;\r\n    itemsSold: number;\r\n    stockAdded: number;\r\n    transferOut: number;\r\n    returnIn: number;\r\n    returnOut: number;\r\n    adjustments: number;\r\n    endingStock: number;\r\n  }>;\r\n}\r\n\r\nconst StockReconciliationPage: React.FC = () => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const { currentBusiness, isLoading: businessLoading } = useBusiness();\r\n  const { hasPermission, isLoading: profilesLoading } = useProfiles();\r\n\r\n  const [search, setSearch] = useState('');\r\n  const [dialogProduct, setDialogProduct] = React.useState<Product | null>(null);\r\n  const [isBulkReconciling, setIsBulkReconciling] = useState(false);\r\n  const [isCalculatingPreview, setIsCalculatingPreview] = useState(false);\r\n  const [showBulkPreview, setShowBulkPreview] = useState(false);\r\n  const [reconciliationPreviews, setReconciliationPreviews] = useState<ReconciliationPreview[]>([]);\r\n  const [selectedPreview, setSelectedPreview] = useState<ReconciliationPreview | null>(null);\r\n  const [isRepairingChains, setIsRepairingChains] = useState(false);\r\n  const [repairPreviews, setRepairPreviews] = useState<any[]>([]);\r\n  const [showRepairPreview, setShowRepairPreview] = useState(false);\r\n  const [isCalculatingRepairPreview, setIsCalculatingRepairPreview] = useState(false);\r\n\r\n  // Load ALL products\r\n  const { data: allProducts = [], isLoading } = useQuery({\r\n    queryKey: ['all-products-reconciliation', user?.id, currentBusiness?.id],\r\n    queryFn: async () => {\r\n      if (!user?.id || !currentBusiness?.id) return [];\r\n      return await getAllProductsAction(user.id, currentBusiness.id);\r\n    },\r\n    enabled: !!user?.id && !!currentBusiness?.id,\r\n    staleTime: 2 * 60_000,\r\n  });\r\n\r\n  // Client-side filtering\r\n  const filteredProducts = useMemo(() => {\r\n    if (!search.trim()) return [];\r\n    const searchLower = search.toLowerCase();\r\n    return allProducts.filter((p) =>\r\n      p.name.toLowerCase().includes(searchLower) ||\r\n      p.itemNumber?.toLowerCase().includes(searchLower) ||\r\n      p.category?.toLowerCase().includes(searchLower) ||\r\n      p.supplier?.toLowerCase().includes(searchLower) ||\r\n      p.description?.toLowerCase().includes(searchLower)\r\n    );\r\n  }, [allProducts, search]);\r\n\r\n  const handleRepairAllChains = async () => {\r\n    if (!currentBusiness?.id) return;\r\n    setIsRepairingChains(true);\r\n    try {\r\n      const result = await repairStockChainsAction(currentBusiness.id);\r\n      if (result.success && result.data) {\r\n        const { repaired, failed } = result.data;\r\n        if (failed === 0) {\r\n          toast.success(`Stock chains repaired successfully for ${repaired} product(s).`);\r\n        } else {\r\n          toast.warning(`Repaired ${repaired} product(s). ${failed} failed.`);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error repairing stock chains:', error);\r\n      toast.error('Failed to repair stock chains.');\r\n    } finally {\r\n      setIsRepairingChains(false);\r\n      setShowRepairPreview(false);\r\n    }\r\n  };\r\n\r\n  const handleRepairPreview = async () => {\r\n    if (!currentBusiness?.id) return;\r\n    setIsCalculatingRepairPreview(true);\r\n    try {\r\n      const result = await getStockRepairsPreviewAction(currentBusiness.id);\r\n      if (result.success && result.data) {\r\n        setRepairPreviews(result.data);\r\n        if (result.data.length === 0) {\r\n          toast.success(\"No broken stock chains found!\");\r\n        } else {\r\n          setShowRepairPreview(true);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error previewing stock repairs:', error);\r\n      toast.error('Failed to preview stock repairs.');\r\n    } finally {\r\n      setIsCalculatingRepairPreview(false);\r\n    }\r\n  };\r\n\r\n  const calculateBulkPreview = async () => {\r\n    if (!currentBusiness?.id) return;\r\n\r\n    setIsCalculatingPreview(true);\r\n    const previews: ReconciliationPreview[] = [];\r\n\r\n    try {\r\n      for (const product of allProducts) {\r\n        const result = await getProductReconciliationAction(currentBusiness.id, product.id);\r\n        if (result.success && result.data && Math.abs(result.data.discrepancy) > 0.01) {\r\n          previews.push(result.data as ReconciliationPreview);\r\n        }\r\n      }\r\n\r\n      setReconciliationPreviews(previews);\r\n      setShowBulkPreview(true);\r\n    } catch (error) {\r\n      console.error('Error calculating preview:', error);\r\n      toast.error('Failed to calculate reconciliation preview.');\r\n    } finally {\r\n      setIsCalculatingPreview(false);\r\n    }\r\n  };\r\n\r\n  const handleBulkReconciliation = async () => {\r\n    if (!user?.id || !currentBusiness?.id || reconciliationPreviews.length === 0) return;\r\n\r\n    setIsBulkReconciling(true);\r\n\r\n    try {\r\n      let successCount = 0;\r\n      let errorCount = 0;\r\n\r\n      for (const preview of reconciliationPreviews) {\r\n        try {\r\n          const result = await createStockHistoryAction({\r\n            userId: user.id,\r\n            locationId: currentBusiness.id,\r\n            productId: preview.product.id,\r\n            previousQuantity: preview.currentStock,\r\n            newQuantity: preview.calculatedStock,\r\n            changeReason: 'Bulk Stock Reconciliation',\r\n            createdAt: new Date().toISOString()\r\n          });\r\n\r\n          if (result.success) {\r\n            successCount++;\r\n          } else {\r\n            throw new Error(result.error);\r\n          }\r\n        } catch (error) {\r\n          errorCount++;\r\n          console.error(`Failed to reconcile ${preview.product.name}:`, error);\r\n        }\r\n      }\r\n\r\n      toast.success(`Bulk reconciliation complete! Updated ${successCount} product(s).`);\r\n      if (errorCount > 0) {\r\n        toast.error(`${errorCount} product(s) failed.`);\r\n      }\r\n\r\n      setShowBulkPreview(false);\r\n      setReconciliationPreviews([]);\r\n    } catch (error) {\r\n      console.error('Bulk reconciliation error:', error);\r\n      toast.error('Failed to complete bulk reconciliation.');\r\n    } finally {\r\n      setIsBulkReconciling(false);\r\n    }\r\n  };\r\n\r\n  if (businessLoading || profilesLoading || !currentBusiness) {\r\n    return <InventoryPageSkeleton />;\r\n  }\r\n\r\n  if (!hasPermission('inventory', 'stock_adjustment')) {\r\n    return (\r\n      <div className=\"max-w-4xl mx-auto p-6\">\r\n        <Alert variant=\"destructive\">\r\n          <AlertCircle className=\"h-4 w-4\" />\r\n          <AlertTitle>Access Denied</AlertTitle>\r\n          <AlertDescription>\r\n            You do not have permission to access stock reconciliation.\r\n          </AlertDescription>\r\n        </Alert>\r\n        <div className=\"mt-4\">\r\n          <Button onClick={() => navigate('/inventory')} variant=\"outline\">\r\n            Back to Inventory\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-2 md:p-6 space-y-4 md:space-y-6 max-w-full\">\r\n      <div className=\"flex items-center justify-between gap-4\">\r\n        <div className=\"space-y-1\">\r\n          <h1 className=\"text-xl md:text-2xl lg:text-3xl font-bold text-sales-dark\">Stock Reconciliation</h1>\r\n          <p className=\"text-sm md:text-base text-muted-foreground\">Select a product, preview the correction, then apply.</p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button\r\n            onClick={handleRepairPreview}\r\n            disabled={isRepairingChains || isCalculatingRepairPreview || isLoading || allProducts.length === 0}\r\n            variant=\"outline\"\r\n            size=\"lg\"\r\n          >\r\n            <AlertCircle className=\"h-4 w-4 mr-2\" />\r\n            {isCalculatingRepairPreview ? 'Scanning...' : 'Preview Repairs'}\r\n          </Button>\r\n          <Button\r\n            onClick={handleRepairAllChains}\r\n            disabled={isRepairingChains || isCalculatingRepairPreview || isLoading || allProducts.length === 0}\r\n            variant=\"secondary\"\r\n            size=\"lg\"\r\n          >\r\n            <Wrench className=\"h-4 w-4 mr-2\" />\r\n            {isRepairingChains ? 'Repairing...' : 'Quick Repair All'}\r\n          </Button>\r\n          <Button\r\n            onClick={calculateBulkPreview}\r\n            disabled={isCalculatingPreview || isLoading || allProducts.length === 0}\r\n            size=\"lg\"\r\n          >\r\n            {isCalculatingPreview ? 'Calculating...' : 'Reconcile All Products'}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base\">Search Product</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-3\">\r\n          <Input\r\n            placeholder=\"Search by name, item number, category, or supplier\"\r\n            value={search}\r\n            onChange={(e) => setSearch(e.target.value)}\r\n          />\r\n          {search && (\r\n            <div className=\"border rounded-md\">\r\n              <ScrollArea className=\"max-h-96\">\r\n                <ul className=\"divide-y\">\r\n                  {isLoading && (\r\n                    <li className=\"p-3 text-sm text-muted-foreground\">Loading products...</li>\r\n                  )}\r\n                  {(!isLoading && filteredProducts.length === 0) && (\r\n                    <li className=\"p-3 text-sm text-muted-foreground\">No matching products found</li>\r\n                  )}\r\n                  {(!isLoading && filteredProducts).map((p) => (\r\n                    <li key={p.id} className=\"p-3 hover:bg-muted/40 cursor-pointer\" onClick={() => setDialogProduct(p)}>\r\n                      <div className=\"font-medium\">{p.name}</div>\r\n                      <div className=\"text-xs text-muted-foreground\">\r\n                        {p.itemNumber ? `Item: ${p.itemNumber}` : '—'} • Qty: {p.quantity} • Cat: {p.category || '—'}\r\n                      </div>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              </ScrollArea>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {dialogProduct && (\r\n        <StockReconciliation\r\n          product={dialogProduct}\r\n          onClose={() => setDialogProduct(null)}\r\n          onReconciled={() => setDialogProduct(null)}\r\n        />\r\n      )}\r\n\r\n      {/* Bulk Reconciliation Preview Dialog */}\r\n      <Dialog open={showBulkPreview} onOpenChange={setShowBulkPreview}>\r\n        <DialogContent className=\"max-w-6xl max-h-[90vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              <AlertCircle className=\"h-5 w-5 text-orange-500\" />\r\n              Bulk Reconciliation Preview\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              {reconciliationPreviews.length} product(s) with discrepancies found.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4\">\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <Card>\r\n                <CardHeader className=\"pb-3\">\r\n                  <CardTitle className=\"text-sm\">Products to Update</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-2xl font-bold\">{reconciliationPreviews.length}</div>\r\n                </CardContent>\r\n              </Card>\r\n              <Card>\r\n                <CardHeader className=\"pb-3\">\r\n                  <CardTitle className=\"text-sm\">Total Adjustment</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-2xl font-bold\">\r\n                    {reconciliationPreviews.reduce((sum, p) => sum + Math.abs(p.discrepancy), 0).toFixed(2)} units\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"text-base\">Products with Discrepancies</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <ScrollArea className=\"h-[400px]\">\r\n                  <div className=\"space-y-2\">\r\n                    {reconciliationPreviews.map((preview) => (\r\n                      <Card\r\n                        key={preview.product.id}\r\n                        className=\"p-3 cursor-pointer hover:bg-muted/50\"\r\n                        onClick={() => setSelectedPreview(preview)}\r\n                      >\r\n                        <div className=\"flex justify-between items-start\">\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"font-semibold\">{preview.product.name}</div>\r\n                            <div className=\"text-xs text-muted-foreground\">\r\n                              {preview.product.itemNumber && `Item: ${preview.product.itemNumber}`}\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"text-right\">\r\n                            <div className=\"text-sm\">\r\n                              <span className=\"text-muted-foreground\">Current:</span> {Number(preview.currentStock).toFixed(2)}\r\n                            </div>\r\n                            <div className=\"text-sm\">\r\n                              <span className=\"text-muted-foreground\">Calculated:</span> {Number(preview.calculatedStock).toFixed(2)}\r\n                            </div>\r\n                            <Badge variant={preview.discrepancy > 0 ? 'default' : 'destructive'} className=\"mt-1\">\r\n                              {preview.discrepancy > 0 ? '+' : ''}{preview.discrepancy.toFixed(2)}\r\n                            </Badge>\r\n                          </div>\r\n                        </div>\r\n                      </Card>\r\n                    ))}\r\n                  </div>\r\n                </ScrollArea>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={() => setShowBulkPreview(false)} disabled={isBulkReconciling}>\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleBulkReconciliation} disabled={isBulkReconciling}>\r\n              {isBulkReconciling ? 'Applying...' : `Apply Reconciliation (${reconciliationPreviews.length} products)`}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Individual Product Detail Dialog */}\r\n      {selectedPreview && (\r\n        <Dialog open={!!selectedPreview} onOpenChange={() => setSelectedPreview(null)}>\r\n          <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\r\n            <DialogHeader>\r\n              <DialogTitle>{selectedPreview.product.name}</DialogTitle>\r\n              <DialogDescription>Detailed reconciliation breakdown</DialogDescription>\r\n            </DialogHeader>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <Card>\r\n                  <CardHeader className=\"pb-3\">\r\n                    <CardTitle className=\"text-sm\">Current Stock</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"text-2xl font-bold\">{Number(selectedPreview.currentStock).toFixed(2)}</div>\r\n                  </CardContent>\r\n                </Card>\r\n                <Card>\r\n                  <CardHeader className=\"pb-3\">\r\n                    <CardTitle className=\"text-sm\">Calculated Stock</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"text-2xl font-bold\">{Number(selectedPreview.calculatedStock).toFixed(2)}</div>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-base\">Stock Calculation</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-3\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-sm text-muted-foreground\">Opening Stock</span>\r\n                    <span className=\"font-medium\">{Number(selectedPreview.openingStock).toFixed(2)}</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between text-red-600\">\r\n                    <span className=\"text-sm flex items-center gap-1\">\r\n                      <TrendingDown className=\"h-4 w-4\" /> Items Sold\r\n                    </span>\r\n                    <span className=\"font-medium\">-{Number(selectedPreview.itemsSold).toFixed(2)}</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between text-emerald-600\">\r\n                    <span className=\"text-sm flex items-center gap-1\">\r\n                      <PackagePlus className=\"h-4 w-4\" /> Stock Added\r\n                    </span>\r\n                    <span className=\"font-medium\">+{Number(selectedPreview.stockAdded).toFixed(2)}</span>\r\n                  </div>\r\n                  <div className=\"border-t pt-3 flex justify-between font-semibold\">\r\n                    <span>Calculated Closing Stock</span>\r\n                    <span>{Number(selectedPreview.calculatedStock).toFixed(2)}</span>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            <DialogFooter>\r\n              <Button onClick={() => setSelectedPreview(null)}>Close</Button>\r\n            </DialogFooter>\r\n          </DialogContent>\r\n        </Dialog>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StockReconciliationPage;","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Wrench\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTQuNyA2LjNhMSAxIDAgMCAwIDAgMS40bDEuNiAxLjZhMSAxIDAgMCAwIDEuNCAwbDMuNzctMy43N2E2IDYgMCAwIDEtNy45NCA3Ljk0bC02LjkxIDYuOTFhMi4xMiAyLjEyIDAgMCAxLTMtM2w2LjkxLTYuOTFhNiA2IDAgMCAxIDcuOTQtNy45NGwtMy43NiAzLjc2eiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/wrench\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Wrench = createLucideIcon('Wrench', [\n  [\n    'path',\n    {\n      d: 'M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z',\n      key: 'cbrjhi',\n    },\n  ],\n]);\n\nexport default Wrench;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name PackagePlus\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgMTZoNiIgLz4KICA8cGF0aCBkPSJNMTkgMTN2NiIgLz4KICA8cGF0aCBkPSJNMjEgMTBWOGEyIDIgMCAwIDAtMS0xLjczbC03LTRhMiAyIDAgMCAwLTIgMGwtNyA0QTIgMiAwIDAgMCAzIDh2OGEyIDIgMCAwIDAgMSAxLjczbDcgNGEyIDIgMCAwIDAgMiAwbDItMS4xNCIgLz4KICA8cGF0aCBkPSJtNy41IDQuMjcgOSA1LjE1IiAvPgogIDxwb2x5bGluZSBwb2ludHM9IjMuMjkgNyAxMiAxMiAyMC43MSA3IiAvPgogIDxsaW5lIHgxPSIxMiIgeDI9IjEyIiB5MT0iMjIiIHkyPSIxMiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/package-plus\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst PackagePlus = createLucideIcon('PackagePlus', [\n  ['path', { d: 'M16 16h6', key: '100bgy' }],\n  ['path', { d: 'M19 13v6', key: '85cyf1' }],\n  [\n    'path',\n    {\n      d: 'M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14',\n      key: 'e7tb2h',\n    },\n  ],\n  ['path', { d: 'm7.5 4.27 9 5.15', key: '1c824w' }],\n  ['polyline', { points: '3.29 7 12 12 20.71 7', key: 'ousv84' }],\n  ['line', { x1: '12', x2: '12', y1: '22', y2: '12', key: 'a4e8g8' }],\n]);\n\nexport default PackagePlus;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name PackageMinus\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgMTZoNiIgLz4KICA8cGF0aCBkPSJNMjEgMTBWOGEyIDIgMCAwIDAtMS0xLjczbC03LTRhMiAyIDAgMCAwLTIgMGwtNyA0QTIgMiAwIDAgMCAzIDh2OGEyIDIgMCAwIDAgMSAxLjczbDcgNGEyIDIgMCAwIDAgMiAwbDItMS4xNCIgLz4KICA8cGF0aCBkPSJtNy41IDQuMjcgOSA1LjE1IiAvPgogIDxwb2x5bGluZSBwb2ludHM9IjMuMjkgNyAxMiAxMiAyMC43MSA3IiAvPgogIDxsaW5lIHgxPSIxMiIgeDI9IjEyIiB5MT0iMjIiIHkyPSIxMiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/package-minus\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst PackageMinus = createLucideIcon('PackageMinus', [\n  ['path', { d: 'M16 16h6', key: '100bgy' }],\n  [\n    'path',\n    {\n      d: 'M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14',\n      key: 'e7tb2h',\n    },\n  ],\n  ['path', { d: 'm7.5 4.27 9 5.15', key: '1c824w' }],\n  ['polyline', { points: '3.29 7 12 12 20.71 7', key: 'ousv84' }],\n  ['line', { x1: '12', x2: '12', y1: '22', y2: '12', key: 'a4e8g8' }],\n]);\n\nexport default PackageMinus;\n","import React, { useState, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { AlertCircle, CheckCircle, TrendingDown, TrendingUp, PackagePlus, PackageMinus } from 'lucide-react';\r\nimport { Product } from '@/types';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { toast } from 'sonner';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\nimport { getProductReconciliationAction } from '@/app/actions/inventory';\r\nimport { updateProductAction } from '@/app/actions/products';\r\n\r\ninterface StockReconciliationProps {\r\n  product: Product;\r\n  onClose: () => void;\r\n  onReconciled: () => void;\r\n}\r\n\r\ninterface ReconciliationData {\r\n  currentStock: number;\r\n  openingStock: number;\r\n  itemsSold: number;\r\n  stockAdded: number;\r\n  transferOut: number;\r\n  returnIn: number;\r\n  returnOut: number;\r\n  adjustments: number;\r\n  calculatedClosingStock: number;\r\n  discrepancy: number;\r\n  openingDate: string | null;\r\n  excludedSalesQty: number;\r\n  dailyBreakdown: DailyBreakdown[];\r\n}\r\n\r\ninterface DailyBreakdown {\r\n  date: string;\r\n  startingStock: number;\r\n  itemsSold: number;\r\n  stockAdded: number;\r\n  transferOut: number;\r\n  returnIn: number;\r\n  returnOut: number;\r\n  adjustments: number;\r\n  endingStock: number;\r\n}\r\n\r\nconst StockReconciliation: React.FC<StockReconciliationProps> = ({\r\n  product,\r\n  onClose,\r\n  onReconciled,\r\n}) => {\r\n  const { user } = useAuth();\r\n  const { currentBusiness } = useBusiness();\r\n  const { settings } = useBusinessSettings();\r\n  const { canViewCostPrice, canViewSellingPrice, formatFinancial } = useFinancialVisibility();\r\n  const [isApplying, setIsApplying] = useState(false);\r\n  const [showPreview, setShowPreview] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [reconciliationData, setReconciliationData] = useState<ReconciliationData>({\r\n    currentStock: 0,\r\n    openingStock: 0,\r\n    itemsSold: 0,\r\n    stockAdded: 0,\r\n    transferOut: 0,\r\n    returnIn: 0,\r\n    returnOut: 0,\r\n    adjustments: 0,\r\n    calculatedClosingStock: 0,\r\n    discrepancy: 0,\r\n    openingDate: null,\r\n    excludedSalesQty: 0,\r\n    dailyBreakdown: [],\r\n  });\r\n\r\n  // Updated state for price adjustments\r\n  const [adjustedCostPrice, setAdjustedCostPrice] = useState<number>(product.costPrice || 0);\r\n  const [adjustedSellingPrice, setAdjustedSellingPrice] = useState<number>(product.sellingPrice || 0);\r\n\r\n  // Initialize prices when product changes\r\n  useEffect(() => {\r\n    setAdjustedCostPrice(product.costPrice || 0);\r\n    setAdjustedSellingPrice(product.sellingPrice || 0);\r\n  }, [product.id, product.costPrice, product.sellingPrice]);\r\n\r\n  useEffect(() => {\r\n    const calculateReconciliation = async () => {\r\n      if (!currentBusiness?.id) return;\r\n\r\n      setIsLoading(true);\r\n      try {\r\n        const result = await getProductReconciliationAction(currentBusiness.id, product.id);\r\n        if (result.success && result.data) {\r\n          setReconciliationData(result.data as ReconciliationData);\r\n        } else {\r\n          toast.error(result.error || 'Failed to calculate reconciliation data');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error calculating reconciliation:', error);\r\n        toast.error('An unexpected error occurred during reconciliation calculation');\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    calculateReconciliation();\r\n  }, [currentBusiness?.id, product.id]);\r\n\r\n  // Valuation calculations\r\n  const currentCostValue = reconciliationData.currentStock * (product.costPrice || 0);\r\n  const currentStockValue = reconciliationData.currentStock * (product.sellingPrice || 0);\r\n\r\n  const reconciledCostValue = reconciliationData.calculatedClosingStock * adjustedCostPrice;\r\n  const reconciledStockValue = reconciliationData.calculatedClosingStock * adjustedSellingPrice;\r\n\r\n  const costValueDiff = reconciledCostValue - currentCostValue;\r\n  const stockValueDiff = reconciledStockValue - currentStockValue;\r\n\r\n  const hasDiscrepancy = Math.abs(reconciliationData.discrepancy) > 0.01;\r\n\r\n  const handleApplyCorrection = async () => {\r\n    if (!user?.id || !currentBusiness?.id) return;\r\n\r\n    setIsApplying(true);\r\n    try {\r\n      // Use the updated updateProductAction which handles history internally\r\n      const result = await updateProductAction(product.id, {\r\n        userId: user.id,\r\n        quantity: reconciliationData.calculatedClosingStock,\r\n        costPrice: adjustedCostPrice,\r\n        sellingPrice: adjustedSellingPrice,\r\n        customChangeReason: 'Stock Reconciliation'\r\n      });\r\n\r\n      if (result) {\r\n        toast.success(\r\n          `Stock reconciled successfully! Corrected ${Math.abs(\r\n            reconciliationData.discrepancy\r\n          ).toFixed(2)} units.`\r\n        );\r\n        onReconciled();\r\n        onClose();\r\n      } else {\r\n        throw new Error('Update failed');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error reconciling stock:', error);\r\n      toast.error('Failed to reconcile stock. Please try again.');\r\n    } finally {\r\n      setIsApplying(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open onOpenChange={onClose}>\r\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            {hasDiscrepancy ? (\r\n              <AlertCircle className=\"h-5 w-5 text-orange-500\" />\r\n            ) : (\r\n              <CheckCircle className=\"h-5 w-5 text-green-500\" />\r\n            )}\r\n            Stock Reconciliation - {product.name}\r\n          </DialogTitle>\r\n          <DialogDescription>\r\n            Review stock calculations and apply corrections if needed\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        {isLoading ? (\r\n          <div className=\"flex items-center justify-center py-8\">\r\n            <div className=\"text-muted-foreground\">Loading reconciliation data...</div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            {/* Summary Cards */}\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <Card>\r\n                <CardHeader className=\"pb-3\">\r\n                  <CardTitle className=\"text-sm font-medium\">Current Stock</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-2xl font-bold\">\r\n                    {reconciliationData.currentStock.toFixed(2)}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader className=\"pb-3\">\r\n                  <CardTitle className=\"text-sm font-medium\">\r\n                    Calculated Stock\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-2xl font-bold\">\r\n                    {reconciliationData.calculatedClosingStock.toFixed(2)}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Pricing Adjustments */}\r\n            <Card className=\"border-sales-primary/20 bg-sales-primary/5\">\r\n              <CardHeader className=\"pb-3\">\r\n                <CardTitle className=\"text-base flex items-center gap-2\">\r\n                  <TrendingUp className=\"h-4 w-4 text-sales-primary\" />\r\n                  Valuation & Price Adjustment\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"grid grid-cols-2 gap-6\">\r\n                  {canViewCostPrice && (\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-xs font-semibold text-muted-foreground uppercase tracking-wider\">Adjustment Cost Price</label>\r\n                      <div className=\"relative\">\r\n                        <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm\">{settings.currency}</span>\r\n                        <input\r\n                          type=\"number\"\r\n                          value={adjustedCostPrice}\r\n                          onChange={(e) => setAdjustedCostPrice(Number(e.target.value))}\r\n                          className=\"w-full pl-12 pr-4 py-2 bg-white border rounded-md text-sm focus:ring-2 focus:ring-sales-primary/20 outline-none transition-all\"\r\n                        />\r\n                      </div>\r\n                      <p className=\"text-[10px] text-muted-foreground\">Affects Cost Value</p>\r\n                    </div>\r\n                  )}\r\n                  {canViewSellingPrice && (\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-xs font-semibold text-muted-foreground uppercase tracking-wider\">Adjustment Selling Price</label>\r\n                      <div className=\"relative\">\r\n                        <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm\">{settings.currency}</span>\r\n                        <input\r\n                          type=\"number\"\r\n                          value={adjustedSellingPrice}\r\n                          onChange={(e) => setAdjustedSellingPrice(Number(e.target.value))}\r\n                          className=\"w-full pl-12 pr-4 py-2 bg-white border rounded-md text-sm focus:ring-2 focus:ring-sales-primary/20 outline-none transition-all\"\r\n                        />\r\n                      </div>\r\n                      <p className=\"text-[10px] text-muted-foreground\">Affects Stock Value</p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"mt-4 pt-4 border-t border-sales-primary/10 grid grid-cols-2 gap-4\">\r\n                  {canViewCostPrice && (\r\n                    <div className=\"p-3 rounded-lg bg-white border shadow-sm\">\r\n                      <p className=\"text-[10px] font-bold text-muted-foreground uppercase mb-1\">Cost Valuation Impact</p>\r\n                      <div className=\"flex items-end justify-between\">\r\n                        <span className={`text-base font-bold ${costValueDiff >= 0 ? 'text-emerald-600' : 'text-rose-600'}`}>\r\n                          {costValueDiff >= 0 ? '+' : ''}{formatFinancial(costValueDiff, 'cost')}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {canViewSellingPrice && (\r\n                    <div className=\"p-3 rounded-lg bg-white border shadow-sm\">\r\n                      <p className=\"text-[10px] font-bold text-muted-foreground uppercase mb-1\">Stock Valuation Impact</p>\r\n                      <div className=\"flex items-end justify-between\">\r\n                        <span className={`text-base font-bold ${stockValueDiff >= 0 ? 'text-violet-600' : 'text-rose-600'}`}>\r\n                          {stockValueDiff >= 0 ? '+' : ''}{formatFinancial(stockValueDiff, 'selling')}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Calculation Breakdown */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"text-base\">Stock Calculation Summary</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-3\">\r\n                <div className=\"flex justify-between items-center\">\r\n                  <span className=\"text-sm text-muted-foreground\">Opening Stock</span>\r\n                  <span className=\"font-medium\">\r\n                    {reconciliationData.openingStock.toFixed(2)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center text-red-600\">\r\n                  <span className=\"text-sm flex items-center gap-1\">\r\n                    <TrendingDown className=\"h-4 w-4\" />\r\n                    Items Sold\r\n                  </span>\r\n                  <span className=\"font-medium\">\r\n                    - {reconciliationData.itemsSold.toFixed(2)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center text-emerald-600\">\r\n                  <span className=\"text-sm flex items-center gap-1\">\r\n                    <PackagePlus className=\"h-4 w-4\" />\r\n                    Stock Added\r\n                  </span>\r\n                  <span className=\"font-medium\">\r\n                    + {reconciliationData.stockAdded.toFixed(2)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center text-orange-600\">\r\n                  <span className=\"text-sm flex items-center gap-1\">\r\n                    <PackageMinus className=\"h-4 w-4\" />\r\n                    Transfer Out\r\n                  </span>\r\n                  <span className=\"font-medium\">\r\n                    - {reconciliationData.transferOut.toFixed(2)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center text-blue-600\">\r\n                  <span className=\"text-sm flex items-center gap-1\">\r\n                    <PackagePlus className=\"h-4 w-4\" />\r\n                    Return In\r\n                  </span>\r\n                  <span className=\"font-medium\">\r\n                    + {reconciliationData.returnIn.toFixed(2)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center text-purple-600\">\r\n                  <span className=\"text-sm flex items-center gap-1\">\r\n                    <PackageMinus className=\"h-4 w-4\" />\r\n                    Return Out\r\n                  </span>\r\n                  <span className=\"font-medium\">\r\n                    - {reconciliationData.returnOut.toFixed(2)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center text-amber-600\">\r\n                  <span className=\"text-sm flex items-center gap-1\">\r\n                    <AlertCircle className=\"h-4 w-4\" />\r\n                    Manual Adjustments\r\n                  </span>\r\n                  <span className=\"font-medium\">\r\n                    {reconciliationData.adjustments > 0 ? '+' : ''}{reconciliationData.adjustments.toFixed(2)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"border-t pt-3 flex justify-between items-center font-semibold text-lg\">\r\n                  <span>Calculated Closing Stock</span>\r\n                  <span>{reconciliationData.calculatedClosingStock.toFixed(2)}</span>\r\n                </div>\r\n\r\n                {/* Discrepancy */}\r\n                {hasDiscrepancy && (\r\n                  <div\r\n                    className={`border-t pt-3 flex justify-between items-center ${reconciliationData.discrepancy > 0\r\n                      ? 'text-green-600'\r\n                      : 'text-red-600'\r\n                      }`}\r\n                  >\r\n                    <span className=\"font-semibold\">Actual vs Calculated Discrepancy</span>\r\n                    <Badge\r\n                      variant={\r\n                        reconciliationData.discrepancy > 0 ? 'default' : 'destructive'\r\n                      }\r\n                    >\r\n                      {reconciliationData.discrepancy > 0 ? '+' : ''}\r\n                      {reconciliationData.discrepancy.toFixed(2)} units\r\n                    </Badge>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Daily Breakdown */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"text-base\">Daily Breakdown</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <ScrollArea className=\"h-[300px] pr-4\">\r\n                  <div className=\"space-y-3\">\r\n                    {reconciliationData.dailyBreakdown.length === 0 ? (\r\n                      <div className=\"text-center text-muted-foreground py-8\">\r\n                        No transactions found for this product\r\n                      </div>\r\n                    ) : (\r\n                      reconciliationData.dailyBreakdown.map((day, index) => (\r\n                        <Card key={index} className=\"p-3 bg-slate-50\">\r\n                          <div className=\"font-semibold text-sm mb-2 text-slate-700\">\r\n                            {new Date(day.date).toLocaleDateString('en-US', {\r\n                              weekday: 'short',\r\n                              year: 'numeric',\r\n                              month: 'short',\r\n                              day: 'numeric'\r\n                            })}\r\n                          </div>\r\n                          <div className=\"space-y-1.5 text-xs\">\r\n                            <div className=\"flex justify-between\">\r\n                              <span className=\"text-muted-foreground\">Starting Stock:</span>\r\n                              <span className=\"font-medium\">{day.startingStock.toFixed(2)}</span>\r\n                            </div>\r\n                            {day.itemsSold > 0 && (\r\n                              <div className=\"flex justify-between text-red-600\">\r\n                                <span>Items Sold:</span>\r\n                                <span className=\"font-medium\">-{day.itemsSold.toFixed(2)}</span>\r\n                              </div>\r\n                            )}\r\n                            {day.stockAdded > 0 && (\r\n                              <div className=\"flex justify-between text-emerald-600\">\r\n                                <span>Stock Added:</span>\r\n                                <span className=\"font-medium\">+{day.stockAdded.toFixed(2)}</span>\r\n                              </div>\r\n                            )}\r\n                            {day.transferOut > 0 && (\r\n                              <div className=\"flex justify-between text-orange-600\">\r\n                                <span>Transfer Out:</span>\r\n                                <span className=\"font-medium\">-{day.transferOut.toFixed(2)}</span>\r\n                              </div>\r\n                            )}\r\n                            {day.returnIn > 0 && (\r\n                              <div className=\"flex justify-between text-blue-600\">\r\n                                <span>Return In:</span>\r\n                                <span className=\"font-medium\">+{day.returnIn.toFixed(2)}</span>\r\n                              </div>\r\n                            )}\r\n                            {day.returnOut > 0 && (\r\n                              <div className=\"flex justify-between text-purple-600\">\r\n                                <span>Return Out:</span>\r\n                                <span className=\"font-medium\">-{day.returnOut.toFixed(2)}</span>\r\n                              </div>\r\n                            )}\r\n                            {day.adjustments !== 0 && (\r\n                              <div className=\"flex justify-between text-amber-600\">\r\n                                <span>Adjustments:</span>\r\n                                <span className=\"font-medium\">{day.adjustments > 0 ? '+' : ''}{day.adjustments.toFixed(2)}</span>\r\n                              </div>\r\n                            )}\r\n                            <div className=\"flex justify-between pt-1.5 border-t border-slate-200\">\r\n                              <span className=\"font-semibold text-slate-700\">Ending Stock:</span>\r\n                              <span className=\"font-bold text-slate-900\">{day.endingStock.toFixed(2)}</span>\r\n                            </div>\r\n                          </div>\r\n                        </Card>\r\n                      ))\r\n                    )}\r\n                  </div>\r\n                </ScrollArea>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Preview Changes */}\r\n            {hasDiscrepancy && showPreview && (\r\n              <Card className=\"bg-blue-50 border-blue-200\">\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-base text-blue-900\">\r\n                    Preview Correction\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-2\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-sm text-blue-800\">Current (Recorded):</span>\r\n                    <span className=\"font-medium text-blue-900\">\r\n                      {reconciliationData.currentStock.toFixed(2)} units\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-sm text-blue-800\">Calculated (History):</span>\r\n                    <span className=\"font-medium text-blue-900\">\r\n                      {reconciliationData.calculatedClosingStock.toFixed(2)} units\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex justify-between pt-2 border-t border-blue-200\">\r\n                    <span className=\"text-sm font-semibold text-blue-800\">\r\n                      Correction Amount:\r\n                    </span>\r\n                    <span className=\"font-semibold text-blue-900\">\r\n                      {reconciliationData.discrepancy > 0 ? '+' : ''}\r\n                      {Math.abs(reconciliationData.discrepancy).toFixed(2)} units\r\n                    </span>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n\r\n            {/* Status Message */}\r\n            {!hasDiscrepancy && (\r\n              <div className=\"flex items-center gap-2 p-4 bg-green-50 border border-green-200 rounded-lg\">\r\n                <CheckCircle className=\"h-5 w-5 text-green-600\" />\r\n                <p className=\"text-sm text-green-800\">\r\n                  Stock levels are accurate based on transaction history.\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={onClose}>\r\n            Cancel\r\n          </Button>\r\n          {hasDiscrepancy && (\r\n            <>\r\n              {!showPreview ? (\r\n                <Button onClick={() => setShowPreview(true)}>\r\n                  Preview Correction\r\n                </Button>\r\n              ) : (\r\n                <Button\r\n                  onClick={handleApplyCorrection}\r\n                  disabled={isApplying}\r\n                  className=\"bg-blue-600 hover:bg-blue-700\"\r\n                >\r\n                  {isApplying ? 'Applying...' : 'Apply Correction'}\r\n                </Button>\r\n              )}\r\n            </>\r\n          )}\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default StockReconciliation;\r\n"],"names":[],"mappings":"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","ignoreList":[1,2,3]}