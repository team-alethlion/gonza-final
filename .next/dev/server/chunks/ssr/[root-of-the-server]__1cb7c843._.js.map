{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/generateVectorPDF.ts"],"sourcesContent":["\r\nimport jsPDF from 'jspdf';\r\nimport html2canvas from 'html2canvas';\r\n\r\ninterface VectorPDFOptions {\r\n  filename: string;\r\n  orientation?: 'portrait' | 'landscape';\r\n  format?: 'a4' | 'letter';\r\n  margins?: {\r\n    top: number;\r\n    right: number;\r\n    bottom: number;\r\n    left: number;\r\n  };\r\n}\r\n\r\nexport const generateVectorPDF = async (\r\n  element: HTMLElement,\r\n  options: VectorPDFOptions\r\n): Promise<void> => {\r\n  const {\r\n    filename,\r\n    orientation = 'portrait',\r\n    format = 'a4',\r\n    margins = { top: 10, right: 10, bottom: 10, left: 10 }\r\n  } = options;\r\n\r\n  // Create new PDF document\r\n  const pdf = new jsPDF({\r\n    orientation,\r\n    unit: 'mm',\r\n    format,\r\n    compress: true\r\n  });\r\n\r\n  const pageWidth = pdf.internal.pageSize.getWidth();\r\n  const pageHeight = pdf.internal.pageSize.getHeight();\r\n  const contentWidth = pageWidth - margins.left - margins.right;\r\n\r\n  try {\r\n    // Convert the element to canvas for measurement and image extraction\r\n    const canvas = await html2canvas(element, {\r\n      scale: 2,\r\n      useCORS: true,\r\n      backgroundColor: '#ffffff',\r\n      logging: false,\r\n      allowTaint: true\r\n    });\r\n\r\n    const imgData = canvas.toDataURL('image/jpeg', 0.95);\r\n    const imgWidth = contentWidth;\r\n    const imgHeight = (canvas.height * imgWidth) / canvas.width;\r\n\r\n    // Check if content fits on one page\r\n    if (imgHeight <= pageHeight - margins.top - margins.bottom) {\r\n      // Single page - add image\r\n      pdf.addImage(imgData, 'JPEG', margins.left, margins.top, imgWidth, imgHeight);\r\n    } else {\r\n      // Multiple pages needed\r\n      let yPosition = 0;\r\n      const pageContentHeight = pageHeight - margins.top - margins.bottom;\r\n\r\n      while (yPosition < imgHeight) {\r\n        // Add image section for current page\r\n        pdf.addImage(\r\n          imgData,\r\n          'JPEG',\r\n          margins.left,\r\n          margins.top - yPosition,\r\n          imgWidth,\r\n          imgHeight\r\n        );\r\n\r\n        yPosition += pageContentHeight;\r\n\r\n        // Add new page if more content exists\r\n        if (yPosition < imgHeight) {\r\n          pdf.addPage();\r\n        }\r\n      }\r\n    }\r\n\r\n    // Save the PDF\r\n    pdf.save(filename);\r\n  } catch (error) {\r\n    console.error('Error generating PDF:', error);\r\n    throw new Error('Failed to generate PDF');\r\n  }\r\n};\r\n\r\n// Enhanced version specifically for receipts with better text handling\r\nexport const generateReceiptVectorPDF = async (\r\n  element: HTMLElement,\r\n  options: VectorPDFOptions\r\n): Promise<void> => {\r\n  const {\r\n    filename,\r\n    orientation = 'portrait',\r\n    format = 'a4',\r\n    margins = { top: 10, right: 10, bottom: 10, left: 10 }\r\n  } = options;\r\n\r\n  const pdf = new jsPDF({\r\n    orientation,\r\n    unit: 'mm',\r\n    format,\r\n    compress: true\r\n  });\r\n\r\n  const pageWidth = pdf.internal.pageSize.getWidth();\r\n  const contentWidth = pageWidth - margins.left - margins.right;\r\n\r\n  try {\r\n    // For receipts, we'll use a higher quality approach\r\n    const canvas = await html2canvas(element, {\r\n      scale: 3, // Higher scale for better quality\r\n      useCORS: true,\r\n      backgroundColor: '#ffffff',\r\n      logging: false,\r\n      allowTaint: true,\r\n      height: element.scrollHeight,\r\n      width: element.scrollWidth\r\n    });\r\n\r\n    const imgData = canvas.toDataURL('image/png', 1.0); // Use PNG for better quality\r\n    const imgWidth = contentWidth;\r\n    const imgHeight = (canvas.height * imgWidth) / canvas.width;\r\n\r\n    const pageHeight = pdf.internal.pageSize.getHeight();\r\n    const pageContentHeight = pageHeight - margins.top - margins.bottom;\r\n\r\n    let yPosition = 0;\r\n\r\n    while (yPosition < imgHeight) {\r\n      const sourceY = (yPosition / imgHeight) * canvas.height;\r\n      const sourceHeight = Math.min(\r\n        (pageContentHeight / imgHeight) * canvas.height,\r\n        canvas.height - sourceY\r\n      );\r\n\r\n      // Create a temporary canvas for this page section\r\n      const pageCanvas = document.createElement('canvas');\r\n      pageCanvas.width = canvas.width;\r\n      pageCanvas.height = sourceHeight;\r\n      \r\n      const pageCtx = pageCanvas.getContext('2d');\r\n      if (pageCtx) {\r\n        pageCtx.drawImage(\r\n          canvas,\r\n          0, sourceY,\r\n          canvas.width, sourceHeight,\r\n          0, 0,\r\n          canvas.width, sourceHeight\r\n        );\r\n\r\n        const pageImgData = pageCanvas.toDataURL('image/png', 1.0);\r\n        const pageImgHeight = (sourceHeight * imgWidth) / canvas.width;\r\n\r\n        pdf.addImage(\r\n          pageImgData,\r\n          'PNG',\r\n          margins.left,\r\n          margins.top,\r\n          imgWidth,\r\n          pageImgHeight\r\n        );\r\n      }\r\n\r\n      yPosition += pageContentHeight;\r\n\r\n      if (yPosition < imgHeight) {\r\n        pdf.addPage();\r\n      }\r\n    }\r\n\r\n    pdf.save(filename);\r\n  } catch (error) {\r\n    console.error('Error generating receipt PDF:', error);\r\n    throw new Error('Failed to generate receipt PDF');\r\n  }\r\n};\r\n"],"names":[],"mappings":"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"}}]
}