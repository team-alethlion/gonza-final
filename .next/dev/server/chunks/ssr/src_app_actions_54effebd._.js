module.exports = [
"[project]/src/app/actions/data:b8cf71 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getBusinessSettingsAction",
    ()=>$$RSC_SERVER_ACTION_0
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"40e10c069514f306d97842d59c289da46a20add653":"getBusinessSettingsAction"},"src/app/actions/business-settings.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_0 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("40e10c069514f306d97842d59c289da46a20add653", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getBusinessSettingsAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vYnVzaW5lc3Mtc2V0dGluZ3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzZXJ2ZXInO1xyXG5cclxuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi8uLi8uLi9wcmlzbWEvZGInO1xyXG5pbXBvcnQgeyByZXZhbGlkYXRlUGF0aCB9IGZyb20gJ25leHQvY2FjaGUnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEJ1c2luZXNzU2V0dGluZ3NBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IGF3YWl0IGRiLmJyYW5jaFNldHRpbmdzLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZCB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghc2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpZDogc2V0dGluZ3MuaWQsXHJcbiAgICAgICAgICAgIGJ1c2luZXNzX25hbWU6IHNldHRpbmdzLmJ1c2luZXNzTmFtZSxcclxuICAgICAgICAgICAgYnVzaW5lc3NfYWRkcmVzczogc2V0dGluZ3MuYWRkcmVzcyxcclxuICAgICAgICAgICAgYnVzaW5lc3NfcGhvbmU6IHNldHRpbmdzLnBob25lLFxyXG4gICAgICAgICAgICBidXNpbmVzc19lbWFpbDogc2V0dGluZ3MuZW1haWwsXHJcbiAgICAgICAgICAgIGJ1c2luZXNzX2xvZ286IHNldHRpbmdzLmxvZ28sXHJcbiAgICAgICAgICAgIGN1cnJlbmN5OiBzZXR0aW5ncy5jdXJyZW5jeSxcclxuICAgICAgICAgICAgc2lnbmF0dXJlOiBzZXR0aW5ncy5zaWduYXR1cmVJbWFnZSxcclxuICAgICAgICAgICAgbWV0YWRhdGE6IHNldHRpbmdzLm1ldGFkYXRhIHx8IHt9XHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYnVzaW5lc3Mgc2V0dGluZ3M6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBzZXJ0QnVzaW5lc3NTZXR0aW5nc0FjdGlvbihicmFuY2hJZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgdXBkYXRlRGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIC8vIFZhbGlkYXRlIHVzZXIgYWNjZXNzIHRvIGJyYW5jaFxyXG4gICAgICAgIGNvbnN0IGJyYW5jaCA9IGF3YWl0IGRiLmJyYW5jaC5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgaWQ6IGJyYW5jaElkLFxyXG4gICAgICAgICAgICAgICAgT1I6IFtcclxuICAgICAgICAgICAgICAgICAgICB7IGFkbWluSWQ6IHVzZXJJZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHsgdXNlcnM6IHsgc29tZTogeyBpZDogdXNlcklkIH0gfSB9XHJcbiAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCFicmFuY2gpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVW5hdXRob3JpemVkIHRvIHVwZGF0ZSBicmFuY2ggc2V0dGluZ3MnIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkYXRhID0ge1xyXG4gICAgICAgICAgICBidXNpbmVzc05hbWU6IHVwZGF0ZURhdGEuYnVzaW5lc3NfbmFtZSxcclxuICAgICAgICAgICAgYWRkcmVzczogdXBkYXRlRGF0YS5idXNpbmVzc19hZGRyZXNzLFxyXG4gICAgICAgICAgICBwaG9uZTogdXBkYXRlRGF0YS5idXNpbmVzc19waG9uZSxcclxuICAgICAgICAgICAgZW1haWw6IHVwZGF0ZURhdGEuYnVzaW5lc3NfZW1haWwsXHJcbiAgICAgICAgICAgIGxvZ286IHVwZGF0ZURhdGEuYnVzaW5lc3NfbG9nbyxcclxuICAgICAgICAgICAgY3VycmVuY3k6IHVwZGF0ZURhdGEuY3VycmVuY3ksXHJcbiAgICAgICAgICAgIHNpZ25hdHVyZUltYWdlOiB1cGRhdGVEYXRhLnNpZ25hdHVyZSxcclxuICAgICAgICAgICAgbWV0YWRhdGE6IHVwZGF0ZURhdGEubWV0YWRhdGFcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCB1cHNlcnRlZCA9IGF3YWl0IGRiLmJyYW5jaFNldHRpbmdzLnVwc2VydCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBicmFuY2hJZCB9LFxyXG4gICAgICAgICAgICB1cGRhdGU6IGRhdGEsXHJcbiAgICAgICAgICAgIGNyZWF0ZToge1xyXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGJyYW5jaElkLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF0YVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiB1cHNlcnRlZC5pZCxcclxuICAgICAgICAgICAgICAgIGJ1c2luZXNzX25hbWU6IHVwc2VydGVkLmJ1c2luZXNzTmFtZSxcclxuICAgICAgICAgICAgICAgIGJ1c2luZXNzX2FkZHJlc3M6IHVwc2VydGVkLmFkZHJlc3MsXHJcbiAgICAgICAgICAgICAgICBidXNpbmVzc19waG9uZTogdXBzZXJ0ZWQucGhvbmUsXHJcbiAgICAgICAgICAgICAgICBidXNpbmVzc19lbWFpbDogdXBzZXJ0ZWQuZW1haWwsXHJcbiAgICAgICAgICAgICAgICBidXNpbmVzc19sb2dvOiB1cHNlcnRlZC5sb2dvLFxyXG4gICAgICAgICAgICAgICAgY3VycmVuY3k6IHVwc2VydGVkLmN1cnJlbmN5LFxyXG4gICAgICAgICAgICAgICAgc2lnbmF0dXJlOiB1cHNlcnRlZC5zaWduYXR1cmVJbWFnZSxcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB1cHNlcnRlZC5tZXRhZGF0YVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cHNlcnRpbmcgYnVzaW5lc3Mgc2V0dGluZ3M6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIHVwZGF0ZSBzZXR0aW5ncycgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjY291bnRTdGF0dXNBY3Rpb24odXNlcklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGRiLnVzZXIuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiB1c2VySWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7XHJcbiAgICAgICAgICAgICAgICBpc0Zyb3plbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBzdGF0dXM6ICdhY3RpdmUnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJCeTogeyBlbmREYXRlOiAnZGVzYycgfSxcclxuICAgICAgICAgICAgICAgICAgICB0YWtlOiAxXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYnJhbmNoZXM6IHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgaWQ6IHRydWUgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghdXNlcikgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgIGNvbnN0IGFjdGl2ZVN1YiA9IHVzZXIuc3Vic2NyaXB0aW9uc1swXTtcclxuICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIGNvbnN0IGRheXNSZW1haW5pbmcgPSBhY3RpdmVTdWIgPyBNYXRoLmNlaWwoKGFjdGl2ZVN1Yi5lbmREYXRlLmdldFRpbWUoKSAtIG5vdy5nZXRUaW1lKCkpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKSA6IDA7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGlzX2Zyb3plbjogdXNlci5pc0Zyb3plbixcclxuICAgICAgICAgICAgbG9jYXRpb25fbGltaXQ6IDEsIC8vIFRyYWRpdGlvbmFsIGxpbWl0IG9yIGZyb20gc3Vic2NyaXB0aW9uXHJcbiAgICAgICAgICAgIGJpbGxpbmdfYW1vdW50OiBhY3RpdmVTdWIgPyBOdW1iZXIoYWN0aXZlU3ViLmFtb3VudCkgOiA1MDAwMCxcclxuICAgICAgICAgICAgYmlsbGluZ19kdXJhdGlvbjogJ01vbnRobHknLFxyXG4gICAgICAgICAgICBkYXlzX3JlbWFpbmluZzogTWF0aC5tYXgoMCwgZGF5c1JlbWFpbmluZyksXHJcbiAgICAgICAgICAgIG5leHRfYmlsbGluZ19kYXRlOiBhY3RpdmVTdWI/LmVuZERhdGUudG9JU09TdHJpbmcoKSB8fCAnJ1xyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGFjY291bnQgc3RhdHVzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBpc19mcm96ZW46IGZhbHNlLCBsb2NhdGlvbl9saW1pdDogMSwgYmlsbGluZ19hbW91bnQ6IDUwMDAwLCBiaWxsaW5nX2R1cmF0aW9uOiAnTW9udGhseScsIGRheXNfcmVtYWluaW5nOiAzMCwgbmV4dF9iaWxsaW5nX2RhdGU6ICcnIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPbmJvYXJkaW5nU3RhdHVzQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IGF3YWl0IGRiLmJyYW5jaFNldHRpbmdzLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghc2V0dGluZ3MpIHJldHVybiBudWxsO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpZDogc2V0dGluZ3MuaWQsXHJcbiAgICAgICAgICAgIGxvY2F0aW9uX2lkOiBzZXR0aW5ncy5icmFuY2hJZCxcclxuICAgICAgICAgICAgYnVzaW5lc3NfbmFtZTogc2V0dGluZ3MuYnVzaW5lc3NOYW1lLFxyXG4gICAgICAgICAgICBidXNpbmVzc19hZGRyZXNzOiBzZXR0aW5ncy5hZGRyZXNzLFxyXG4gICAgICAgICAgICBidXNpbmVzc19waG9uZTogc2V0dGluZ3MucGhvbmUsXHJcbiAgICAgICAgICAgIGJ1c2luZXNzX2VtYWlsOiBzZXR0aW5ncy5lbWFpbCxcclxuICAgICAgICAgICAgYnVzaW5lc3NfbG9nbzogc2V0dGluZ3MubG9nbyxcclxuICAgICAgICAgICAgY29tcGxldGVkOiAhIXNldHRpbmdzLmJ1c2luZXNzTmFtZSAmJiAhIXNldHRpbmdzLnBob25lLCAvLyBTaW1wbGlmaWVkIGNvbXBsZXRpb24gY2hlY2tcclxuICAgICAgICAgICAgaXNfZnJvemVuOiBmYWxzZSAvLyBTaG91bGQgY29tZSBmcm9tIGJyYW5jaCBvciB1c2VyIHN0YXR1c1xyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG9uYm9hcmRpbmcgc3RhdHVzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6ImtUQUtzQixzTUFBQSJ9
}),
"[project]/src/app/actions/data:93bcad [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getProductsAction",
    ()=>$$RSC_SERVER_ACTION_0
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"4067b4df65a668010fc5081a80928c8b7ed310e2f4":"getProductsAction"},"src/app/actions/products.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_0 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("4067b4df65a668010fc5081a80928c8b7ed310e2f4", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getProductsAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vcHJvZHVjdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XHJcblxyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RGb3JtRGF0YSwgbWFwRGJQcm9kdWN0VG9Qcm9kdWN0LCBtYXBQcm9kdWN0VG9EYlByb2R1Y3QgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIFdlIGltcGxlbWVudCBzZXJ2ZXIgYWN0aW9ucyBmb3IgdGhlIHByb2R1Y3RzIGhlcmVcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0FjdGlvbih7XHJcbiAgdXNlcklkLFxyXG4gIGJ1c2luZXNzSWQsXHJcbiAgcGFnZSxcclxuICBwYWdlU2l6ZSxcclxuICBzZWFyY2gsXHJcbiAgY2F0ZWdvcnksXHJcbiAgc3RvY2tTdGF0dXMsXHJcbn06IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBidXNpbmVzc0lkOiBzdHJpbmc7XHJcbiAgcGFnZTogbnVtYmVyO1xyXG4gIHBhZ2VTaXplOiBudW1iZXI7XHJcbiAgc2VhcmNoPzogc3RyaW5nO1xyXG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gIHN0b2NrU3RhdHVzPzogJ2luU3RvY2snIHwgJ291dE9mU3RvY2snIHwgJ2xvd1N0b2NrJyB8ICdhbGwnO1xyXG59KSB7XHJcbiAgaWYgKCF1c2VySWQgfHwgIWJ1c2luZXNzSWQpIHJldHVybiB7IHByb2R1Y3RzOiBbXSwgY291bnQ6IDAgfTtcclxuXHJcbiAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuICBjb25zdCB0YWtlID0gcGFnZVNpemU7XHJcblxyXG4gIGxldCB3aGVyZUNsYXVzZTogYW55ID0ge1xyXG4gICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICB9O1xyXG5cclxuICBpZiAoc2VhcmNoKSB7XHJcbiAgICB3aGVyZUNsYXVzZS5PUiA9IFtcclxuICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IGRlc2NyaXB0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IHNrdTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIGlmIChjYXRlZ29yeSkge1xyXG4gICAgd2hlcmVDbGF1c2UuY2F0ZWdvcnkgPSB7IG5hbWU6IGNhdGVnb3J5IH07XHJcbiAgfVxyXG5cclxuICBpZiAoc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSAwO1xyXG4gIH0gZWxzZSBpZiAoc3RvY2tTdGF0dXMgPT09ICdpblN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgfSBlbHNlIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgLy8gSGFuZGxpbmcgbG93U3RvY2sgaXMgY29tcGxleCBiZWNhdXNlIG1pblN0b2NrIGlzIGNvbXBhcmVkIGxvY2FsbHkgb3IgdXNpbmcgZGlyZWN0IFNRTCBpbiBQcmlzbWFcclxuICAgIC8vIEZvciBub3csIHdlIHdpbGwgaGFuZGxlIGl0IHdpdGggUHJpc21hJ3MgcmF3IHF1ZXJ5IG9yIGJ5IGZpbHRlcmluZyBpbiBtZW1vcnkgaWYgbmVjZXNzYXJ5XHJcbiAgICAvLyBGb3J0dW5hdGVseSwgc2luY2UgUFJJU01BIDUuMCwgY29sdW1uIGNvbXBhcmlzb24gc3RpbGwgbmVlZHMgcmF3IHF1ZXJpZXMgb3Igd2UgY2FuIGZldGNoIGFuZCBmaWx0ZXIgaWYgc21hbGxcclxuICAgIC8vIEhlcmUgd2UnbGwgZmV0Y2ggdGhlbSBhbGwgaWYgbG93U3RvY2sgaXMgZW5hYmxlZCwgb3IgYWRkIGEgZ2VuZXJhdGVkIGNvbHVtbi4gXHJcbiAgICAvLyBXZSB3aWxsIGRvIGEgYmFzaWMgZmV0Y2ggYW5kIGZpbHRlciBsYXRlciBpZiBuZWVkZWQuXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Byb2R1Y3RzRGF0YSwgdG90YWxDb3VudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcclxuICAgICAgICBza2lwLFxyXG4gICAgICAgIHRha2UsXHJcbiAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnZGVzYycgfSwgeyBpZDogJ2Rlc2MnIH1dLFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgICAgc3VwcGxpZXI6IHRydWUsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgZGIucHJvZHVjdC5jb3VudCh7IHdoZXJlOiB3aGVyZUNsYXVzZSB9KVxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8gTWFwIHRoZSBQcmlzbWEgcHJvZHVjdCBtb2RlbCBiYWNrIHRvIHRoZSBhcHBsaWNhdGlvbidzIFByb2R1Y3QgdHlwZVxyXG4gICAgbGV0IGZvcm1hdHRlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiB7XHJcbiAgICAgIC8vIEFzc3VtaW5nIG1hcHBpbmcgZXhpc3RzLCB3ZSB3aWxsIG1hcCBpdFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgIG5hbWU6IHAubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICBjYXRlZ29yeTogcC5jYXRlZ29yeT8ubmFtZSB8fCAnVW5jYXRlZ29yaXplZCcsXHJcbiAgICAgICAgcXVhbnRpdHk6IHAuc3RvY2ssXHJcbiAgICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHAuc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgIHN1cHBsaWVyOiBwLnN1cHBsaWVyPy5uYW1lLFxyXG4gICAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICAgIGJhcmNvZGU6IHAuYmFyY29kZSxcclxuICAgICAgICBpdGVtTnVtYmVyOiBwLnNrdSB8fCAnJyxcclxuICAgICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgICBmb3JtYXR0ZWRQcm9kdWN0cyA9IGZvcm1hdHRlZFByb2R1Y3RzLmZpbHRlcigocDogYW55KSA9PiBwLnF1YW50aXR5ID4gMCAmJiBwLnF1YW50aXR5IDw9IHAubWluaW11bVN0b2NrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBwcm9kdWN0czogZm9ybWF0dGVkUHJvZHVjdHMgYXMgYW55W10sIGNvdW50OiB0b3RhbENvdW50IH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgcHJvZHVjdHM6IFtdLCBjb3VudDogMCB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIXVzZXJJZCB8fCAhYnVzaW5lc3NJZCkgcmV0dXJuIFtdO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvZHVjdHNEYXRhID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sIHsgaWQ6ICdkZXNjJyB9XSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgIHN1cHBsaWVyOiB0cnVlLFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogTnVtYmVyKHAuc3RvY2spLFxyXG4gICAgICBjb3N0UHJpY2U6IE51bWJlcihwLmNvc3RQcmljZSksXHJcbiAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHAuc2VsbGluZ1ByaWNlKSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IE51bWJlcihwLm1pblN0b2NrKSxcclxuICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgIH0pKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RzQnlJZHNBY3Rpb24oaWRzOiBzdHJpbmdbXSwgYnVzaW5lc3NJZD86IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0ge1xyXG4gICAgICBpZDogeyBpbjogaWRzIH1cclxuICAgIH07XHJcbiAgICBpZiAoYnVzaW5lc3NJZCkge1xyXG4gICAgICB3aGVyZS5icmFuY2hJZCA9IGJ1c2luZXNzSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcclxuICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHByb2R1Y3RzLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogcC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgc2VsbGluZ1ByaWNlOiBwLnNlbGxpbmdQcmljZSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQsXHJcbiAgICB9KSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGJ5IGlkczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgIC8vIDEuIEdlbmVyYXRlIG5leHQgU0tVL2l0ZW1OdW1iZXIgZm9yIHRoaXMgYnJhbmNoXHJcbiAgICAgIGNvbnN0IGxhc3RQcm9kdWN0ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kRmlyc3Qoe1xyXG4gICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBkYXRhLmJ1c2luZXNzSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiB7IHNrdTogJ2Rlc2MnIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7IHNrdTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbGV0IG5leHRTa3UgPSBcIlBST0QtMDAwMVwiO1xyXG4gICAgICBpZiAobGFzdFByb2R1Y3QgJiYgbGFzdFByb2R1Y3Quc2t1KSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudE51bWJlciA9IHBhcnNlSW50KGxhc3RQcm9kdWN0LnNrdS5yZXBsYWNlKFwiUFJPRC1cIiwgXCJcIikpIHx8IDA7XHJcbiAgICAgICAgbmV4dFNrdSA9IGBQUk9ELSR7KGN1cnJlbnROdW1iZXIgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJyl9YDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMi4gQ3JlYXRlIHRoZSBwcm9kdWN0XHJcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCB0eC5wcm9kdWN0LmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBicmFuY2hJZDogZGF0YS5idXNpbmVzc0lkLFxyXG4gICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IGRhdGEuY2F0ZWdvcnlJZCB8fCBudWxsLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogZGF0YS5zdXBwbGllcklkIHx8IG51bGwsXHJcbiAgICAgICAgICBza3U6IG5leHRTa3UsXHJcbiAgICAgICAgICBiYXJjb2RlOiBkYXRhLmJhcmNvZGUsXHJcbiAgICAgICAgICBpbWFnZTogZGF0YS5pbWFnZVVybCxcclxuICAgICAgICAgIGNvc3RQcmljZTogZGF0YS5jb3N0UHJpY2UgfHwgMCxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogZGF0YS5zZWxsaW5nUHJpY2UgfHwgMCxcclxuICAgICAgICAgIHN0b2NrOiBkYXRhLnF1YW50aXR5IHx8IDAsXHJcbiAgICAgICAgICBtaW5TdG9jazogZGF0YS5taW5pbXVtU3RvY2sgfHwgMCxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXHJcbiAgICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGluaXRpYWwgc3RvY2sgaGlzdG9yeSBpZiBxdWFudGl0eSA+IDBcclxuICAgICAgaWYgKGRhdGEucXVhbnRpdHkgPiAwKSB7XHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICB0eXBlOiAnQ1JFQVRFRCcsXHJcbiAgICAgICAgICAgIG9sZFN0b2NrOiAwLFxyXG4gICAgICAgICAgICBuZXdTdG9jazogZGF0YS5xdWFudGl0eSxcclxuICAgICAgICAgICAgcXVhbnRpdHlDaGFuZ2U6IGRhdGEucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHJlYXNvbjogYFske3Byb2R1Y3QubmFtZX1dIHwgSW5pdGlhbCBzdG9ja2AsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcHJvZHVjdDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcmVzdWx0LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICBjYXRlZ29yeTogcmVzdWx0LmNhdGVnb3J5Py5uYW1lIHx8ICdVbmNhdGVnb3JpemVkJyxcclxuICAgICAgcXVhbnRpdHk6IHJlc3VsdC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiByZXN1bHQuY29zdFByaWNlLFxyXG4gICAgICBzZWxsaW5nUHJpY2U6IHJlc3VsdC5zZWxsaW5nUHJpY2UsXHJcbiAgICAgIHN1cHBsaWVyOiByZXN1bHQuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiByZXN1bHQuaW1hZ2UsXHJcbiAgICAgIGJhcmNvZGU6IHJlc3VsdC5iYXJjb2RlLFxyXG4gICAgICBpdGVtTnVtYmVyOiByZXN1bHQuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHJlc3VsdC5taW5TdG9jayxcclxuICAgICAgY3JlYXRlZEF0OiByZXN1bHQuY3JlYXRlZEF0LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgLy8gMS4gR2V0IGN1cnJlbnQgcHJvZHVjdCBzdGF0ZVxyXG4gICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kVW5pcXVlKHtcclxuICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgIHNlbGVjdDogeyBzdG9jazogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgIC8vIDIuIFBlcmZvcm0gdXBkYXRlXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5wcm9kdWN0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IHVwZGF0ZXMuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkID8gdXBkYXRlcy5jYXRlZ29yeUlkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogdXBkYXRlcy5zdXBwbGllcklkICE9PSB1bmRlZmluZWQgPyB1cGRhdGVzLnN1cHBsaWVySWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBza3U6IHVwZGF0ZXMuaXRlbU51bWJlciB8fCB1cGRhdGVzLnNrdSxcclxuICAgICAgICAgIGJhcmNvZGU6IHVwZGF0ZXMuYmFyY29kZSxcclxuICAgICAgICAgIGltYWdlOiB1cGRhdGVzLmltYWdlVXJsLFxyXG4gICAgICAgICAgY29zdFByaWNlOiB1cGRhdGVzLmNvc3RQcmljZSxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogdXBkYXRlcy5zZWxsaW5nUHJpY2UsXHJcbiAgICAgICAgICBzdG9jazogdXBkYXRlcy5xdWFudGl0eSxcclxuICAgICAgICAgIG1pblN0b2NrOiB1cGRhdGVzLm1pbmltdW1TdG9jayxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGhpc3RvcnkgaWYgcXVhbnRpdHkgY2hhbmdlZFxyXG4gICAgICBpZiAodXBkYXRlcy5xdWFudGl0eSAhPT0gdW5kZWZpbmVkICYmIHVwZGF0ZXMucXVhbnRpdHkgIT09IGN1cnJlbnQuc3RvY2sgJiYgdXBkYXRlcy5jdXN0b21DaGFuZ2VSZWFzb24gIT09ICdza2lwLWhpc3RvcnknKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZVJlYXNvbiA9IHVwZGF0ZXMuY3VzdG9tQ2hhbmdlUmVhc29uO1xyXG4gICAgICAgIGlmICghY2hhbmdlUmVhc29uKSB7XHJcbiAgICAgICAgICBpZiAodXBkYXRlcy5pc0Zyb21TYWxlKSBjaGFuZ2VSZWFzb24gPSBcIlNhbGVcIjtcclxuICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZXMucXVhbnRpdHkgPiBjdXJyZW50LnN0b2NrKSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayBhZGRpdGlvblwiO1xyXG4gICAgICAgICAgZWxzZSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayByZWR1Y3Rpb25cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNuYXBzaG90dGVkUmVhc29uID0gYFske3VwZGF0ZWQubmFtZX1dIHwgJHtjaGFuZ2VSZWFzb259YDtcclxuXHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiB1cGRhdGVzLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiB1cGRhdGVkLmlkLFxyXG4gICAgICAgICAgICB0eXBlOiB1cGRhdGVzLmlzRnJvbVNhbGUgPyAnU0FMRScgOiAodXBkYXRlcy5xdWFudGl0eSA+IGN1cnJlbnQuc3RvY2sgPyAnUkVTVE9DSycgOiAnQURKVVNUTUVOVCcpLFxyXG4gICAgICAgICAgICBvbGRTdG9jazogY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgbmV3U3RvY2s6IHVwZGF0ZXMucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHF1YW50aXR5Q2hhbmdlOiB1cGRhdGVzLnF1YW50aXR5IC0gY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgcmVhc29uOiBzbmFwc2hvdHRlZFJlYXNvbixcclxuICAgICAgICAgICAgcmVmZXJlbmNlSWQ6IHVwZGF0ZXMucmVmZXJlbmNlSWQgfHwgbnVsbCxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3RBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5wcm9kdWN0LmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgIH0pO1xyXG4gICAgLy8gcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnkvcHJvZHVjdHMnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0c0J1bGtBY3Rpb24oXHJcbiAgdXBkYXRlczogQXJyYXk8eyBpZDogc3RyaW5nOyB1cGRhdGVkOiBQYXJ0aWFsPGFueT4gfT4sXHJcbiAgYnVzaW5lc3NJZDogc3RyaW5nXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBQcmlzbWEgdHJhbnNhY3Rpb24gZm9yIGJ1bGsgdXBkYXRlc1xyXG4gICAgY29uc3QgdXBkYXRlUHJvbWlzZXMgPSB1cGRhdGVzLm1hcCh1ID0+XHJcbiAgICAgIGRiLnByb2R1Y3QudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogdS5pZCB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQubmFtZSAmJiB7IG5hbWU6IHUudXBkYXRlZC5uYW1lIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmIHsgZGVzY3JpcHRpb246IHUudXBkYXRlZC5kZXNjcmlwdGlvbiB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkICYmIHsgY2F0ZWdvcnlJZDogdS51cGRhdGVkLmNhdGVnb3J5SWQgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLnN1cHBsaWVySWQgIT09IHVuZGVmaW5lZCAmJiB7IHN1cHBsaWVySWQ6IHUudXBkYXRlZC5zdXBwbGllcklkIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5za3UgIT09IHVuZGVmaW5lZCAmJiB7IHNrdTogdS51cGRhdGVkLnNrdSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuYmFyY29kZSAhPT0gdW5kZWZpbmVkICYmIHsgYmFyY29kZTogdS51cGRhdGVkLmJhcmNvZGUgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLmNvc3RQcmljZSAhPT0gdW5kZWZpbmVkICYmIHsgY29zdFByaWNlOiB1LnVwZGF0ZWQuY29zdFByaWNlIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5zZWxsaW5nUHJpY2UgIT09IHVuZGVmaW5lZCAmJiB7IHNlbGxpbmdQcmljZTogdS51cGRhdGVkLnNlbGxpbmdQcmljZSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQucXVhbnRpdHkgIT09IHVuZGVmaW5lZCAmJiB7IHN0b2NrOiB1LnVwZGF0ZWQucXVhbnRpdHkgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLm1pbmltdW1TdG9jayAhPT0gdW5kZWZpbmVkICYmIHsgbWluU3RvY2s6IHUudXBkYXRlZC5taW5pbXVtU3RvY2sgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBkYi4kdHJhbnNhY3Rpb24odXBkYXRlUHJvbWlzZXMpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBlcmZvcm1pbmcgYnVsayB1cGRhdGU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFBST0RVQ1QgQ0FURUdPUklFUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0Q2F0ZWdvcmllc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLmNhdGVnb3J5LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiBjYXRlZ29yaWVzLm1hcCgoYzogYW55KSA9PiAoe1xyXG4gICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICBjcmVhdGVkX2F0OiBjLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KSlcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9kdWN0Q2F0ZWdvcnlBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgZGIuY2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgIHVzZXJJZCxcclxuICAgICAgICBuYW1lXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yeSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhdGVnb3J5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3RDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5jYXRlZ29yeS51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBkYXRhOiB7IG5hbWUgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHJvZHVjdENhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gQ2hlY2sgaWYgYW55IHByb2R1Y3RzIGFyZSB1c2luZyB0aGlzIGNhdGVnb3J5XHJcbiAgICBjb25zdCB1c2FnZUNvdW50ID0gYXdhaXQgZGIucHJvZHVjdC5jb3VudCh7XHJcbiAgICAgIHdoZXJlOiB7IGNhdGVnb3J5SWQ6IGlkIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh1c2FnZUNvdW50ID4gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBjYXRlZ29yeTogaXQgaXMgYmVpbmcgdXNlZCBieSBvbmUgb3IgbW9yZSBwcm9kdWN0cy4nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZGIuY2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIC0tLSBQUk9EVUNUIFNUQVRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RTdGF0c0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIWJ1c2luZXNzSWQpIHJldHVybiB7IGNvc3RWYWx1ZTogMCwgbG93U3RvY2s6IDAsIG91dE9mU3RvY2s6IDAsIHN0b2NrVmFsdWU6IDAgfTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgIHN0b2NrOiB0cnVlLFxyXG4gICAgICAgIGNvc3RQcmljZTogdHJ1ZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb3N0VmFsdWUgPSAwO1xyXG4gICAgbGV0IGxvd1N0b2NrID0gMDtcclxuICAgIGxldCBvdXRPZlN0b2NrID0gMDtcclxuICAgIGxldCBzdG9ja1ZhbHVlID0gMDtcclxuXHJcbiAgICBwcm9kdWN0cy5mb3JFYWNoKChwOiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgcXR5ID0gTnVtYmVyKHAuc3RvY2spIHx8IDA7XHJcbiAgICAgIGNvbnN0IGNvc3QgPSBOdW1iZXIocC5jb3N0UHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IHNlbGxpbmcgPSBOdW1iZXIocC5zZWxsaW5nUHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IG1pblN0b2NrID0gTnVtYmVyKHAubWluU3RvY2spIHx8IDA7XHJcblxyXG4gICAgICBjb3N0VmFsdWUgKz0gY29zdCAqIHF0eTtcclxuICAgICAgc3RvY2tWYWx1ZSArPSBzZWxsaW5nICogcXR5O1xyXG5cclxuICAgICAgaWYgKHF0eSA9PT0gMCkge1xyXG4gICAgICAgIG91dE9mU3RvY2srKztcclxuICAgICAgfSBlbHNlIGlmIChxdHkgPiAwICYmIHF0eSA8PSBtaW5TdG9jaykge1xyXG4gICAgICAgIGxvd1N0b2NrKys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IGNvc3RWYWx1ZSwgbG93U3RvY2ssIG91dE9mU3RvY2ssIHN0b2NrVmFsdWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdCBzdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBjb3N0VmFsdWU6IDAsIGxvd1N0b2NrOiAwLCBvdXRPZlN0b2NrOiAwLCBzdG9ja1ZhbHVlOiAwIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBMT09LVVAgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbihjb2RlOiBzdHJpbmcsIGJyYW5jaElkOiBzdHJpbmcpIHtcclxuICBpZiAoIWNvZGUgfHwgIWJyYW5jaElkKSByZXR1cm4gbnVsbDtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbG93ZXJDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICBPUjogW1xyXG4gICAgICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBsb3dlckNvZGUsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgICAgeyBza3U6IHsgY29udGFpbnM6IGxvd2VyQ29kZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcm9kdWN0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBTQ0FOTkVSIChhbGwgcHJvZHVjdHMgZm9yIHNjYW5uZXIgcHJlbG9hZCkgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbihicmFuY2hJZDogc3RyaW5nKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBicmFuY2hJZCB9LFxyXG4gICAgICBzZWxlY3Q6IHtcclxuICAgICAgICBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYmFyY29kZTogdHJ1ZSwgc2t1OiB0cnVlLFxyXG4gICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSwgY29zdFByaWNlOiB0cnVlLCBzdG9jazogdHJ1ZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdHJ1ZSwgY2F0ZWdvcnlJZDogdHJ1ZSwgYnJhbmNoSWQ6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsIGltYWdlVXJsOiB0cnVlLCBjcmVhdGVkQXQ6IHRydWUsIHVwZGF0ZWRBdDogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb2R1Y3RzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFNBTEUgQ0FTSCBUUkFOU0FDVElPTiBJRCBVUERBVEUgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihzYWxlSWQ6IHN0cmluZywgY2FzaFRyYW5zYWN0aW9uSWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5zYWxlLnVwZGF0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkOiBzYWxlSWQgfSxcclxuICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignW3VwZGF0ZVNhbGVDYXNoVHJhbnNhY3Rpb25BY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIEZJTFRFUkVEIFBST0RVQ1RTIEZPUiBFWFBPUlQgKGFsbCBwYWdlcykgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyZWRQcm9kdWN0c0ZvckV4cG9ydEFjdGlvbihcclxuICBicmFuY2hJZDogc3RyaW5nLFxyXG4gIGZpbHRlcnM/OiB7IHNlYXJjaD86IHN0cmluZzsgY2F0ZWdvcnk/OiBzdHJpbmc7IHN0b2NrU3RhdHVzPzogc3RyaW5nIH1cclxuKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZCB9O1xyXG5cclxuICAgIGlmIChmaWx0ZXJzPy5zZWFyY2gpIHtcclxuICAgICAgY29uc3QgcyA9IGZpbHRlcnMuc2VhcmNoO1xyXG4gICAgICB3aGVyZS5PUiA9IFtcclxuICAgICAgICB7IG5hbWU6IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgc2t1OiB7IGNvbnRhaW5zOiBzLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycz8uc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgICB3aGVyZS5zdG9jayA9IDA7XHJcbiAgICB9IGVsc2UgaWYgKGZpbHRlcnM/LnN0b2NrU3RhdHVzID09PSAnaW5TdG9jaycpIHtcclxuICAgICAgd2hlcmUuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW2dldEZpbHRlcmVkUHJvZHVjdHNGb3JFeHBvcnRBY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJpU0FRc0IsOExBQUEifQ==
}),
"[project]/src/app/actions/data:377d5e [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createProductAction",
    ()=>$$RSC_SERVER_ACTION_3
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"40de351351ef1c777658488fc7d0ea14a31652fa0f":"createProductAction"},"src/app/actions/products.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_3 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("40de351351ef1c777658488fc7d0ea14a31652fa0f", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "createProductAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vcHJvZHVjdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XHJcblxyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RGb3JtRGF0YSwgbWFwRGJQcm9kdWN0VG9Qcm9kdWN0LCBtYXBQcm9kdWN0VG9EYlByb2R1Y3QgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIFdlIGltcGxlbWVudCBzZXJ2ZXIgYWN0aW9ucyBmb3IgdGhlIHByb2R1Y3RzIGhlcmVcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0FjdGlvbih7XHJcbiAgdXNlcklkLFxyXG4gIGJ1c2luZXNzSWQsXHJcbiAgcGFnZSxcclxuICBwYWdlU2l6ZSxcclxuICBzZWFyY2gsXHJcbiAgY2F0ZWdvcnksXHJcbiAgc3RvY2tTdGF0dXMsXHJcbn06IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBidXNpbmVzc0lkOiBzdHJpbmc7XHJcbiAgcGFnZTogbnVtYmVyO1xyXG4gIHBhZ2VTaXplOiBudW1iZXI7XHJcbiAgc2VhcmNoPzogc3RyaW5nO1xyXG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gIHN0b2NrU3RhdHVzPzogJ2luU3RvY2snIHwgJ291dE9mU3RvY2snIHwgJ2xvd1N0b2NrJyB8ICdhbGwnO1xyXG59KSB7XHJcbiAgaWYgKCF1c2VySWQgfHwgIWJ1c2luZXNzSWQpIHJldHVybiB7IHByb2R1Y3RzOiBbXSwgY291bnQ6IDAgfTtcclxuXHJcbiAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuICBjb25zdCB0YWtlID0gcGFnZVNpemU7XHJcblxyXG4gIGxldCB3aGVyZUNsYXVzZTogYW55ID0ge1xyXG4gICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICB9O1xyXG5cclxuICBpZiAoc2VhcmNoKSB7XHJcbiAgICB3aGVyZUNsYXVzZS5PUiA9IFtcclxuICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IGRlc2NyaXB0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IHNrdTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIGlmIChjYXRlZ29yeSkge1xyXG4gICAgd2hlcmVDbGF1c2UuY2F0ZWdvcnkgPSB7IG5hbWU6IGNhdGVnb3J5IH07XHJcbiAgfVxyXG5cclxuICBpZiAoc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSAwO1xyXG4gIH0gZWxzZSBpZiAoc3RvY2tTdGF0dXMgPT09ICdpblN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgfSBlbHNlIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgLy8gSGFuZGxpbmcgbG93U3RvY2sgaXMgY29tcGxleCBiZWNhdXNlIG1pblN0b2NrIGlzIGNvbXBhcmVkIGxvY2FsbHkgb3IgdXNpbmcgZGlyZWN0IFNRTCBpbiBQcmlzbWFcclxuICAgIC8vIEZvciBub3csIHdlIHdpbGwgaGFuZGxlIGl0IHdpdGggUHJpc21hJ3MgcmF3IHF1ZXJ5IG9yIGJ5IGZpbHRlcmluZyBpbiBtZW1vcnkgaWYgbmVjZXNzYXJ5XHJcbiAgICAvLyBGb3J0dW5hdGVseSwgc2luY2UgUFJJU01BIDUuMCwgY29sdW1uIGNvbXBhcmlzb24gc3RpbGwgbmVlZHMgcmF3IHF1ZXJpZXMgb3Igd2UgY2FuIGZldGNoIGFuZCBmaWx0ZXIgaWYgc21hbGxcclxuICAgIC8vIEhlcmUgd2UnbGwgZmV0Y2ggdGhlbSBhbGwgaWYgbG93U3RvY2sgaXMgZW5hYmxlZCwgb3IgYWRkIGEgZ2VuZXJhdGVkIGNvbHVtbi4gXHJcbiAgICAvLyBXZSB3aWxsIGRvIGEgYmFzaWMgZmV0Y2ggYW5kIGZpbHRlciBsYXRlciBpZiBuZWVkZWQuXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Byb2R1Y3RzRGF0YSwgdG90YWxDb3VudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcclxuICAgICAgICBza2lwLFxyXG4gICAgICAgIHRha2UsXHJcbiAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnZGVzYycgfSwgeyBpZDogJ2Rlc2MnIH1dLFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgICAgc3VwcGxpZXI6IHRydWUsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgZGIucHJvZHVjdC5jb3VudCh7IHdoZXJlOiB3aGVyZUNsYXVzZSB9KVxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8gTWFwIHRoZSBQcmlzbWEgcHJvZHVjdCBtb2RlbCBiYWNrIHRvIHRoZSBhcHBsaWNhdGlvbidzIFByb2R1Y3QgdHlwZVxyXG4gICAgbGV0IGZvcm1hdHRlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiB7XHJcbiAgICAgIC8vIEFzc3VtaW5nIG1hcHBpbmcgZXhpc3RzLCB3ZSB3aWxsIG1hcCBpdFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgIG5hbWU6IHAubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICBjYXRlZ29yeTogcC5jYXRlZ29yeT8ubmFtZSB8fCAnVW5jYXRlZ29yaXplZCcsXHJcbiAgICAgICAgcXVhbnRpdHk6IHAuc3RvY2ssXHJcbiAgICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHAuc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgIHN1cHBsaWVyOiBwLnN1cHBsaWVyPy5uYW1lLFxyXG4gICAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICAgIGJhcmNvZGU6IHAuYmFyY29kZSxcclxuICAgICAgICBpdGVtTnVtYmVyOiBwLnNrdSB8fCAnJyxcclxuICAgICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgICBmb3JtYXR0ZWRQcm9kdWN0cyA9IGZvcm1hdHRlZFByb2R1Y3RzLmZpbHRlcigocDogYW55KSA9PiBwLnF1YW50aXR5ID4gMCAmJiBwLnF1YW50aXR5IDw9IHAubWluaW11bVN0b2NrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBwcm9kdWN0czogZm9ybWF0dGVkUHJvZHVjdHMgYXMgYW55W10sIGNvdW50OiB0b3RhbENvdW50IH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgcHJvZHVjdHM6IFtdLCBjb3VudDogMCB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIXVzZXJJZCB8fCAhYnVzaW5lc3NJZCkgcmV0dXJuIFtdO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvZHVjdHNEYXRhID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sIHsgaWQ6ICdkZXNjJyB9XSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgIHN1cHBsaWVyOiB0cnVlLFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogTnVtYmVyKHAuc3RvY2spLFxyXG4gICAgICBjb3N0UHJpY2U6IE51bWJlcihwLmNvc3RQcmljZSksXHJcbiAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHAuc2VsbGluZ1ByaWNlKSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IE51bWJlcihwLm1pblN0b2NrKSxcclxuICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgIH0pKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RzQnlJZHNBY3Rpb24oaWRzOiBzdHJpbmdbXSwgYnVzaW5lc3NJZD86IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0ge1xyXG4gICAgICBpZDogeyBpbjogaWRzIH1cclxuICAgIH07XHJcbiAgICBpZiAoYnVzaW5lc3NJZCkge1xyXG4gICAgICB3aGVyZS5icmFuY2hJZCA9IGJ1c2luZXNzSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcclxuICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHByb2R1Y3RzLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogcC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgc2VsbGluZ1ByaWNlOiBwLnNlbGxpbmdQcmljZSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQsXHJcbiAgICB9KSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGJ5IGlkczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgIC8vIDEuIEdlbmVyYXRlIG5leHQgU0tVL2l0ZW1OdW1iZXIgZm9yIHRoaXMgYnJhbmNoXHJcbiAgICAgIGNvbnN0IGxhc3RQcm9kdWN0ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kRmlyc3Qoe1xyXG4gICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBkYXRhLmJ1c2luZXNzSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiB7IHNrdTogJ2Rlc2MnIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7IHNrdTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbGV0IG5leHRTa3UgPSBcIlBST0QtMDAwMVwiO1xyXG4gICAgICBpZiAobGFzdFByb2R1Y3QgJiYgbGFzdFByb2R1Y3Quc2t1KSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudE51bWJlciA9IHBhcnNlSW50KGxhc3RQcm9kdWN0LnNrdS5yZXBsYWNlKFwiUFJPRC1cIiwgXCJcIikpIHx8IDA7XHJcbiAgICAgICAgbmV4dFNrdSA9IGBQUk9ELSR7KGN1cnJlbnROdW1iZXIgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJyl9YDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMi4gQ3JlYXRlIHRoZSBwcm9kdWN0XHJcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCB0eC5wcm9kdWN0LmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBicmFuY2hJZDogZGF0YS5idXNpbmVzc0lkLFxyXG4gICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IGRhdGEuY2F0ZWdvcnlJZCB8fCBudWxsLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogZGF0YS5zdXBwbGllcklkIHx8IG51bGwsXHJcbiAgICAgICAgICBza3U6IG5leHRTa3UsXHJcbiAgICAgICAgICBiYXJjb2RlOiBkYXRhLmJhcmNvZGUsXHJcbiAgICAgICAgICBpbWFnZTogZGF0YS5pbWFnZVVybCxcclxuICAgICAgICAgIGNvc3RQcmljZTogZGF0YS5jb3N0UHJpY2UgfHwgMCxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogZGF0YS5zZWxsaW5nUHJpY2UgfHwgMCxcclxuICAgICAgICAgIHN0b2NrOiBkYXRhLnF1YW50aXR5IHx8IDAsXHJcbiAgICAgICAgICBtaW5TdG9jazogZGF0YS5taW5pbXVtU3RvY2sgfHwgMCxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXHJcbiAgICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGluaXRpYWwgc3RvY2sgaGlzdG9yeSBpZiBxdWFudGl0eSA+IDBcclxuICAgICAgaWYgKGRhdGEucXVhbnRpdHkgPiAwKSB7XHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICB0eXBlOiAnQ1JFQVRFRCcsXHJcbiAgICAgICAgICAgIG9sZFN0b2NrOiAwLFxyXG4gICAgICAgICAgICBuZXdTdG9jazogZGF0YS5xdWFudGl0eSxcclxuICAgICAgICAgICAgcXVhbnRpdHlDaGFuZ2U6IGRhdGEucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHJlYXNvbjogYFske3Byb2R1Y3QubmFtZX1dIHwgSW5pdGlhbCBzdG9ja2AsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcHJvZHVjdDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcmVzdWx0LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICBjYXRlZ29yeTogcmVzdWx0LmNhdGVnb3J5Py5uYW1lIHx8ICdVbmNhdGVnb3JpemVkJyxcclxuICAgICAgcXVhbnRpdHk6IHJlc3VsdC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiByZXN1bHQuY29zdFByaWNlLFxyXG4gICAgICBzZWxsaW5nUHJpY2U6IHJlc3VsdC5zZWxsaW5nUHJpY2UsXHJcbiAgICAgIHN1cHBsaWVyOiByZXN1bHQuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiByZXN1bHQuaW1hZ2UsXHJcbiAgICAgIGJhcmNvZGU6IHJlc3VsdC5iYXJjb2RlLFxyXG4gICAgICBpdGVtTnVtYmVyOiByZXN1bHQuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHJlc3VsdC5taW5TdG9jayxcclxuICAgICAgY3JlYXRlZEF0OiByZXN1bHQuY3JlYXRlZEF0LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgLy8gMS4gR2V0IGN1cnJlbnQgcHJvZHVjdCBzdGF0ZVxyXG4gICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kVW5pcXVlKHtcclxuICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgIHNlbGVjdDogeyBzdG9jazogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgIC8vIDIuIFBlcmZvcm0gdXBkYXRlXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5wcm9kdWN0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IHVwZGF0ZXMuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkID8gdXBkYXRlcy5jYXRlZ29yeUlkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogdXBkYXRlcy5zdXBwbGllcklkICE9PSB1bmRlZmluZWQgPyB1cGRhdGVzLnN1cHBsaWVySWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBza3U6IHVwZGF0ZXMuaXRlbU51bWJlciB8fCB1cGRhdGVzLnNrdSxcclxuICAgICAgICAgIGJhcmNvZGU6IHVwZGF0ZXMuYmFyY29kZSxcclxuICAgICAgICAgIGltYWdlOiB1cGRhdGVzLmltYWdlVXJsLFxyXG4gICAgICAgICAgY29zdFByaWNlOiB1cGRhdGVzLmNvc3RQcmljZSxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogdXBkYXRlcy5zZWxsaW5nUHJpY2UsXHJcbiAgICAgICAgICBzdG9jazogdXBkYXRlcy5xdWFudGl0eSxcclxuICAgICAgICAgIG1pblN0b2NrOiB1cGRhdGVzLm1pbmltdW1TdG9jayxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGhpc3RvcnkgaWYgcXVhbnRpdHkgY2hhbmdlZFxyXG4gICAgICBpZiAodXBkYXRlcy5xdWFudGl0eSAhPT0gdW5kZWZpbmVkICYmIHVwZGF0ZXMucXVhbnRpdHkgIT09IGN1cnJlbnQuc3RvY2sgJiYgdXBkYXRlcy5jdXN0b21DaGFuZ2VSZWFzb24gIT09ICdza2lwLWhpc3RvcnknKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZVJlYXNvbiA9IHVwZGF0ZXMuY3VzdG9tQ2hhbmdlUmVhc29uO1xyXG4gICAgICAgIGlmICghY2hhbmdlUmVhc29uKSB7XHJcbiAgICAgICAgICBpZiAodXBkYXRlcy5pc0Zyb21TYWxlKSBjaGFuZ2VSZWFzb24gPSBcIlNhbGVcIjtcclxuICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZXMucXVhbnRpdHkgPiBjdXJyZW50LnN0b2NrKSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayBhZGRpdGlvblwiO1xyXG4gICAgICAgICAgZWxzZSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayByZWR1Y3Rpb25cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNuYXBzaG90dGVkUmVhc29uID0gYFske3VwZGF0ZWQubmFtZX1dIHwgJHtjaGFuZ2VSZWFzb259YDtcclxuXHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiB1cGRhdGVzLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiB1cGRhdGVkLmlkLFxyXG4gICAgICAgICAgICB0eXBlOiB1cGRhdGVzLmlzRnJvbVNhbGUgPyAnU0FMRScgOiAodXBkYXRlcy5xdWFudGl0eSA+IGN1cnJlbnQuc3RvY2sgPyAnUkVTVE9DSycgOiAnQURKVVNUTUVOVCcpLFxyXG4gICAgICAgICAgICBvbGRTdG9jazogY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgbmV3U3RvY2s6IHVwZGF0ZXMucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHF1YW50aXR5Q2hhbmdlOiB1cGRhdGVzLnF1YW50aXR5IC0gY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgcmVhc29uOiBzbmFwc2hvdHRlZFJlYXNvbixcclxuICAgICAgICAgICAgcmVmZXJlbmNlSWQ6IHVwZGF0ZXMucmVmZXJlbmNlSWQgfHwgbnVsbCxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3RBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5wcm9kdWN0LmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgIH0pO1xyXG4gICAgLy8gcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnkvcHJvZHVjdHMnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0c0J1bGtBY3Rpb24oXHJcbiAgdXBkYXRlczogQXJyYXk8eyBpZDogc3RyaW5nOyB1cGRhdGVkOiBQYXJ0aWFsPGFueT4gfT4sXHJcbiAgYnVzaW5lc3NJZDogc3RyaW5nXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBQcmlzbWEgdHJhbnNhY3Rpb24gZm9yIGJ1bGsgdXBkYXRlc1xyXG4gICAgY29uc3QgdXBkYXRlUHJvbWlzZXMgPSB1cGRhdGVzLm1hcCh1ID0+XHJcbiAgICAgIGRiLnByb2R1Y3QudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogdS5pZCB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQubmFtZSAmJiB7IG5hbWU6IHUudXBkYXRlZC5uYW1lIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmIHsgZGVzY3JpcHRpb246IHUudXBkYXRlZC5kZXNjcmlwdGlvbiB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkICYmIHsgY2F0ZWdvcnlJZDogdS51cGRhdGVkLmNhdGVnb3J5SWQgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLnN1cHBsaWVySWQgIT09IHVuZGVmaW5lZCAmJiB7IHN1cHBsaWVySWQ6IHUudXBkYXRlZC5zdXBwbGllcklkIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5za3UgIT09IHVuZGVmaW5lZCAmJiB7IHNrdTogdS51cGRhdGVkLnNrdSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuYmFyY29kZSAhPT0gdW5kZWZpbmVkICYmIHsgYmFyY29kZTogdS51cGRhdGVkLmJhcmNvZGUgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLmNvc3RQcmljZSAhPT0gdW5kZWZpbmVkICYmIHsgY29zdFByaWNlOiB1LnVwZGF0ZWQuY29zdFByaWNlIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5zZWxsaW5nUHJpY2UgIT09IHVuZGVmaW5lZCAmJiB7IHNlbGxpbmdQcmljZTogdS51cGRhdGVkLnNlbGxpbmdQcmljZSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQucXVhbnRpdHkgIT09IHVuZGVmaW5lZCAmJiB7IHN0b2NrOiB1LnVwZGF0ZWQucXVhbnRpdHkgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLm1pbmltdW1TdG9jayAhPT0gdW5kZWZpbmVkICYmIHsgbWluU3RvY2s6IHUudXBkYXRlZC5taW5pbXVtU3RvY2sgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBkYi4kdHJhbnNhY3Rpb24odXBkYXRlUHJvbWlzZXMpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBlcmZvcm1pbmcgYnVsayB1cGRhdGU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFBST0RVQ1QgQ0FURUdPUklFUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0Q2F0ZWdvcmllc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLmNhdGVnb3J5LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiBjYXRlZ29yaWVzLm1hcCgoYzogYW55KSA9PiAoe1xyXG4gICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICBjcmVhdGVkX2F0OiBjLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KSlcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9kdWN0Q2F0ZWdvcnlBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgZGIuY2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgIHVzZXJJZCxcclxuICAgICAgICBuYW1lXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yeSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhdGVnb3J5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3RDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5jYXRlZ29yeS51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBkYXRhOiB7IG5hbWUgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHJvZHVjdENhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gQ2hlY2sgaWYgYW55IHByb2R1Y3RzIGFyZSB1c2luZyB0aGlzIGNhdGVnb3J5XHJcbiAgICBjb25zdCB1c2FnZUNvdW50ID0gYXdhaXQgZGIucHJvZHVjdC5jb3VudCh7XHJcbiAgICAgIHdoZXJlOiB7IGNhdGVnb3J5SWQ6IGlkIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh1c2FnZUNvdW50ID4gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBjYXRlZ29yeTogaXQgaXMgYmVpbmcgdXNlZCBieSBvbmUgb3IgbW9yZSBwcm9kdWN0cy4nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZGIuY2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIC0tLSBQUk9EVUNUIFNUQVRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RTdGF0c0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIWJ1c2luZXNzSWQpIHJldHVybiB7IGNvc3RWYWx1ZTogMCwgbG93U3RvY2s6IDAsIG91dE9mU3RvY2s6IDAsIHN0b2NrVmFsdWU6IDAgfTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgIHN0b2NrOiB0cnVlLFxyXG4gICAgICAgIGNvc3RQcmljZTogdHJ1ZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb3N0VmFsdWUgPSAwO1xyXG4gICAgbGV0IGxvd1N0b2NrID0gMDtcclxuICAgIGxldCBvdXRPZlN0b2NrID0gMDtcclxuICAgIGxldCBzdG9ja1ZhbHVlID0gMDtcclxuXHJcbiAgICBwcm9kdWN0cy5mb3JFYWNoKChwOiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgcXR5ID0gTnVtYmVyKHAuc3RvY2spIHx8IDA7XHJcbiAgICAgIGNvbnN0IGNvc3QgPSBOdW1iZXIocC5jb3N0UHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IHNlbGxpbmcgPSBOdW1iZXIocC5zZWxsaW5nUHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IG1pblN0b2NrID0gTnVtYmVyKHAubWluU3RvY2spIHx8IDA7XHJcblxyXG4gICAgICBjb3N0VmFsdWUgKz0gY29zdCAqIHF0eTtcclxuICAgICAgc3RvY2tWYWx1ZSArPSBzZWxsaW5nICogcXR5O1xyXG5cclxuICAgICAgaWYgKHF0eSA9PT0gMCkge1xyXG4gICAgICAgIG91dE9mU3RvY2srKztcclxuICAgICAgfSBlbHNlIGlmIChxdHkgPiAwICYmIHF0eSA8PSBtaW5TdG9jaykge1xyXG4gICAgICAgIGxvd1N0b2NrKys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IGNvc3RWYWx1ZSwgbG93U3RvY2ssIG91dE9mU3RvY2ssIHN0b2NrVmFsdWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdCBzdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBjb3N0VmFsdWU6IDAsIGxvd1N0b2NrOiAwLCBvdXRPZlN0b2NrOiAwLCBzdG9ja1ZhbHVlOiAwIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBMT09LVVAgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbihjb2RlOiBzdHJpbmcsIGJyYW5jaElkOiBzdHJpbmcpIHtcclxuICBpZiAoIWNvZGUgfHwgIWJyYW5jaElkKSByZXR1cm4gbnVsbDtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbG93ZXJDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICBPUjogW1xyXG4gICAgICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBsb3dlckNvZGUsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgICAgeyBza3U6IHsgY29udGFpbnM6IGxvd2VyQ29kZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcm9kdWN0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBTQ0FOTkVSIChhbGwgcHJvZHVjdHMgZm9yIHNjYW5uZXIgcHJlbG9hZCkgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbihicmFuY2hJZDogc3RyaW5nKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBicmFuY2hJZCB9LFxyXG4gICAgICBzZWxlY3Q6IHtcclxuICAgICAgICBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYmFyY29kZTogdHJ1ZSwgc2t1OiB0cnVlLFxyXG4gICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSwgY29zdFByaWNlOiB0cnVlLCBzdG9jazogdHJ1ZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdHJ1ZSwgY2F0ZWdvcnlJZDogdHJ1ZSwgYnJhbmNoSWQ6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsIGltYWdlVXJsOiB0cnVlLCBjcmVhdGVkQXQ6IHRydWUsIHVwZGF0ZWRBdDogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb2R1Y3RzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFNBTEUgQ0FTSCBUUkFOU0FDVElPTiBJRCBVUERBVEUgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihzYWxlSWQ6IHN0cmluZywgY2FzaFRyYW5zYWN0aW9uSWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5zYWxlLnVwZGF0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkOiBzYWxlSWQgfSxcclxuICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignW3VwZGF0ZVNhbGVDYXNoVHJhbnNhY3Rpb25BY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIEZJTFRFUkVEIFBST0RVQ1RTIEZPUiBFWFBPUlQgKGFsbCBwYWdlcykgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyZWRQcm9kdWN0c0ZvckV4cG9ydEFjdGlvbihcclxuICBicmFuY2hJZDogc3RyaW5nLFxyXG4gIGZpbHRlcnM/OiB7IHNlYXJjaD86IHN0cmluZzsgY2F0ZWdvcnk/OiBzdHJpbmc7IHN0b2NrU3RhdHVzPzogc3RyaW5nIH1cclxuKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZCB9O1xyXG5cclxuICAgIGlmIChmaWx0ZXJzPy5zZWFyY2gpIHtcclxuICAgICAgY29uc3QgcyA9IGZpbHRlcnMuc2VhcmNoO1xyXG4gICAgICB3aGVyZS5PUiA9IFtcclxuICAgICAgICB7IG5hbWU6IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgc2t1OiB7IGNvbnRhaW5zOiBzLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycz8uc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgICB3aGVyZS5zdG9jayA9IDA7XHJcbiAgICB9IGVsc2UgaWYgKGZpbHRlcnM/LnN0b2NrU3RhdHVzID09PSAnaW5TdG9jaycpIHtcclxuICAgICAgd2hlcmUuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW2dldEZpbHRlcmVkUHJvZHVjdHNGb3JFeHBvcnRBY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJtU0FxTHNCLGdNQUFBIn0=
}),
"[project]/src/app/actions/data:169405 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "updateProductAction",
    ()=>$$RSC_SERVER_ACTION_4
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"60d199ed6ebdb264ab3569d97f92202a15a4ea5a1e":"updateProductAction"},"src/app/actions/products.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_4 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("60d199ed6ebdb264ab3569d97f92202a15a4ea5a1e", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "updateProductAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vcHJvZHVjdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XHJcblxyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RGb3JtRGF0YSwgbWFwRGJQcm9kdWN0VG9Qcm9kdWN0LCBtYXBQcm9kdWN0VG9EYlByb2R1Y3QgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIFdlIGltcGxlbWVudCBzZXJ2ZXIgYWN0aW9ucyBmb3IgdGhlIHByb2R1Y3RzIGhlcmVcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0FjdGlvbih7XHJcbiAgdXNlcklkLFxyXG4gIGJ1c2luZXNzSWQsXHJcbiAgcGFnZSxcclxuICBwYWdlU2l6ZSxcclxuICBzZWFyY2gsXHJcbiAgY2F0ZWdvcnksXHJcbiAgc3RvY2tTdGF0dXMsXHJcbn06IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBidXNpbmVzc0lkOiBzdHJpbmc7XHJcbiAgcGFnZTogbnVtYmVyO1xyXG4gIHBhZ2VTaXplOiBudW1iZXI7XHJcbiAgc2VhcmNoPzogc3RyaW5nO1xyXG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gIHN0b2NrU3RhdHVzPzogJ2luU3RvY2snIHwgJ291dE9mU3RvY2snIHwgJ2xvd1N0b2NrJyB8ICdhbGwnO1xyXG59KSB7XHJcbiAgaWYgKCF1c2VySWQgfHwgIWJ1c2luZXNzSWQpIHJldHVybiB7IHByb2R1Y3RzOiBbXSwgY291bnQ6IDAgfTtcclxuXHJcbiAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuICBjb25zdCB0YWtlID0gcGFnZVNpemU7XHJcblxyXG4gIGxldCB3aGVyZUNsYXVzZTogYW55ID0ge1xyXG4gICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICB9O1xyXG5cclxuICBpZiAoc2VhcmNoKSB7XHJcbiAgICB3aGVyZUNsYXVzZS5PUiA9IFtcclxuICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IGRlc2NyaXB0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IHNrdTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIGlmIChjYXRlZ29yeSkge1xyXG4gICAgd2hlcmVDbGF1c2UuY2F0ZWdvcnkgPSB7IG5hbWU6IGNhdGVnb3J5IH07XHJcbiAgfVxyXG5cclxuICBpZiAoc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSAwO1xyXG4gIH0gZWxzZSBpZiAoc3RvY2tTdGF0dXMgPT09ICdpblN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgfSBlbHNlIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgLy8gSGFuZGxpbmcgbG93U3RvY2sgaXMgY29tcGxleCBiZWNhdXNlIG1pblN0b2NrIGlzIGNvbXBhcmVkIGxvY2FsbHkgb3IgdXNpbmcgZGlyZWN0IFNRTCBpbiBQcmlzbWFcclxuICAgIC8vIEZvciBub3csIHdlIHdpbGwgaGFuZGxlIGl0IHdpdGggUHJpc21hJ3MgcmF3IHF1ZXJ5IG9yIGJ5IGZpbHRlcmluZyBpbiBtZW1vcnkgaWYgbmVjZXNzYXJ5XHJcbiAgICAvLyBGb3J0dW5hdGVseSwgc2luY2UgUFJJU01BIDUuMCwgY29sdW1uIGNvbXBhcmlzb24gc3RpbGwgbmVlZHMgcmF3IHF1ZXJpZXMgb3Igd2UgY2FuIGZldGNoIGFuZCBmaWx0ZXIgaWYgc21hbGxcclxuICAgIC8vIEhlcmUgd2UnbGwgZmV0Y2ggdGhlbSBhbGwgaWYgbG93U3RvY2sgaXMgZW5hYmxlZCwgb3IgYWRkIGEgZ2VuZXJhdGVkIGNvbHVtbi4gXHJcbiAgICAvLyBXZSB3aWxsIGRvIGEgYmFzaWMgZmV0Y2ggYW5kIGZpbHRlciBsYXRlciBpZiBuZWVkZWQuXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Byb2R1Y3RzRGF0YSwgdG90YWxDb3VudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcclxuICAgICAgICBza2lwLFxyXG4gICAgICAgIHRha2UsXHJcbiAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnZGVzYycgfSwgeyBpZDogJ2Rlc2MnIH1dLFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgICAgc3VwcGxpZXI6IHRydWUsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgZGIucHJvZHVjdC5jb3VudCh7IHdoZXJlOiB3aGVyZUNsYXVzZSB9KVxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8gTWFwIHRoZSBQcmlzbWEgcHJvZHVjdCBtb2RlbCBiYWNrIHRvIHRoZSBhcHBsaWNhdGlvbidzIFByb2R1Y3QgdHlwZVxyXG4gICAgbGV0IGZvcm1hdHRlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiB7XHJcbiAgICAgIC8vIEFzc3VtaW5nIG1hcHBpbmcgZXhpc3RzLCB3ZSB3aWxsIG1hcCBpdFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgIG5hbWU6IHAubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICBjYXRlZ29yeTogcC5jYXRlZ29yeT8ubmFtZSB8fCAnVW5jYXRlZ29yaXplZCcsXHJcbiAgICAgICAgcXVhbnRpdHk6IHAuc3RvY2ssXHJcbiAgICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHAuc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgIHN1cHBsaWVyOiBwLnN1cHBsaWVyPy5uYW1lLFxyXG4gICAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICAgIGJhcmNvZGU6IHAuYmFyY29kZSxcclxuICAgICAgICBpdGVtTnVtYmVyOiBwLnNrdSB8fCAnJyxcclxuICAgICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgICBmb3JtYXR0ZWRQcm9kdWN0cyA9IGZvcm1hdHRlZFByb2R1Y3RzLmZpbHRlcigocDogYW55KSA9PiBwLnF1YW50aXR5ID4gMCAmJiBwLnF1YW50aXR5IDw9IHAubWluaW11bVN0b2NrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBwcm9kdWN0czogZm9ybWF0dGVkUHJvZHVjdHMgYXMgYW55W10sIGNvdW50OiB0b3RhbENvdW50IH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgcHJvZHVjdHM6IFtdLCBjb3VudDogMCB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIXVzZXJJZCB8fCAhYnVzaW5lc3NJZCkgcmV0dXJuIFtdO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvZHVjdHNEYXRhID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sIHsgaWQ6ICdkZXNjJyB9XSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgIHN1cHBsaWVyOiB0cnVlLFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogTnVtYmVyKHAuc3RvY2spLFxyXG4gICAgICBjb3N0UHJpY2U6IE51bWJlcihwLmNvc3RQcmljZSksXHJcbiAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHAuc2VsbGluZ1ByaWNlKSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IE51bWJlcihwLm1pblN0b2NrKSxcclxuICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgIH0pKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RzQnlJZHNBY3Rpb24oaWRzOiBzdHJpbmdbXSwgYnVzaW5lc3NJZD86IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0ge1xyXG4gICAgICBpZDogeyBpbjogaWRzIH1cclxuICAgIH07XHJcbiAgICBpZiAoYnVzaW5lc3NJZCkge1xyXG4gICAgICB3aGVyZS5icmFuY2hJZCA9IGJ1c2luZXNzSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcclxuICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHByb2R1Y3RzLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogcC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgc2VsbGluZ1ByaWNlOiBwLnNlbGxpbmdQcmljZSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQsXHJcbiAgICB9KSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGJ5IGlkczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgIC8vIDEuIEdlbmVyYXRlIG5leHQgU0tVL2l0ZW1OdW1iZXIgZm9yIHRoaXMgYnJhbmNoXHJcbiAgICAgIGNvbnN0IGxhc3RQcm9kdWN0ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kRmlyc3Qoe1xyXG4gICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBkYXRhLmJ1c2luZXNzSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiB7IHNrdTogJ2Rlc2MnIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7IHNrdTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbGV0IG5leHRTa3UgPSBcIlBST0QtMDAwMVwiO1xyXG4gICAgICBpZiAobGFzdFByb2R1Y3QgJiYgbGFzdFByb2R1Y3Quc2t1KSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudE51bWJlciA9IHBhcnNlSW50KGxhc3RQcm9kdWN0LnNrdS5yZXBsYWNlKFwiUFJPRC1cIiwgXCJcIikpIHx8IDA7XHJcbiAgICAgICAgbmV4dFNrdSA9IGBQUk9ELSR7KGN1cnJlbnROdW1iZXIgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJyl9YDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMi4gQ3JlYXRlIHRoZSBwcm9kdWN0XHJcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCB0eC5wcm9kdWN0LmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBicmFuY2hJZDogZGF0YS5idXNpbmVzc0lkLFxyXG4gICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IGRhdGEuY2F0ZWdvcnlJZCB8fCBudWxsLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogZGF0YS5zdXBwbGllcklkIHx8IG51bGwsXHJcbiAgICAgICAgICBza3U6IG5leHRTa3UsXHJcbiAgICAgICAgICBiYXJjb2RlOiBkYXRhLmJhcmNvZGUsXHJcbiAgICAgICAgICBpbWFnZTogZGF0YS5pbWFnZVVybCxcclxuICAgICAgICAgIGNvc3RQcmljZTogZGF0YS5jb3N0UHJpY2UgfHwgMCxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogZGF0YS5zZWxsaW5nUHJpY2UgfHwgMCxcclxuICAgICAgICAgIHN0b2NrOiBkYXRhLnF1YW50aXR5IHx8IDAsXHJcbiAgICAgICAgICBtaW5TdG9jazogZGF0YS5taW5pbXVtU3RvY2sgfHwgMCxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXHJcbiAgICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGluaXRpYWwgc3RvY2sgaGlzdG9yeSBpZiBxdWFudGl0eSA+IDBcclxuICAgICAgaWYgKGRhdGEucXVhbnRpdHkgPiAwKSB7XHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICB0eXBlOiAnQ1JFQVRFRCcsXHJcbiAgICAgICAgICAgIG9sZFN0b2NrOiAwLFxyXG4gICAgICAgICAgICBuZXdTdG9jazogZGF0YS5xdWFudGl0eSxcclxuICAgICAgICAgICAgcXVhbnRpdHlDaGFuZ2U6IGRhdGEucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHJlYXNvbjogYFske3Byb2R1Y3QubmFtZX1dIHwgSW5pdGlhbCBzdG9ja2AsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcHJvZHVjdDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcmVzdWx0LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICBjYXRlZ29yeTogcmVzdWx0LmNhdGVnb3J5Py5uYW1lIHx8ICdVbmNhdGVnb3JpemVkJyxcclxuICAgICAgcXVhbnRpdHk6IHJlc3VsdC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiByZXN1bHQuY29zdFByaWNlLFxyXG4gICAgICBzZWxsaW5nUHJpY2U6IHJlc3VsdC5zZWxsaW5nUHJpY2UsXHJcbiAgICAgIHN1cHBsaWVyOiByZXN1bHQuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiByZXN1bHQuaW1hZ2UsXHJcbiAgICAgIGJhcmNvZGU6IHJlc3VsdC5iYXJjb2RlLFxyXG4gICAgICBpdGVtTnVtYmVyOiByZXN1bHQuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHJlc3VsdC5taW5TdG9jayxcclxuICAgICAgY3JlYXRlZEF0OiByZXN1bHQuY3JlYXRlZEF0LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgLy8gMS4gR2V0IGN1cnJlbnQgcHJvZHVjdCBzdGF0ZVxyXG4gICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kVW5pcXVlKHtcclxuICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgIHNlbGVjdDogeyBzdG9jazogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgIC8vIDIuIFBlcmZvcm0gdXBkYXRlXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5wcm9kdWN0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IHVwZGF0ZXMuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkID8gdXBkYXRlcy5jYXRlZ29yeUlkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogdXBkYXRlcy5zdXBwbGllcklkICE9PSB1bmRlZmluZWQgPyB1cGRhdGVzLnN1cHBsaWVySWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBza3U6IHVwZGF0ZXMuaXRlbU51bWJlciB8fCB1cGRhdGVzLnNrdSxcclxuICAgICAgICAgIGJhcmNvZGU6IHVwZGF0ZXMuYmFyY29kZSxcclxuICAgICAgICAgIGltYWdlOiB1cGRhdGVzLmltYWdlVXJsLFxyXG4gICAgICAgICAgY29zdFByaWNlOiB1cGRhdGVzLmNvc3RQcmljZSxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogdXBkYXRlcy5zZWxsaW5nUHJpY2UsXHJcbiAgICAgICAgICBzdG9jazogdXBkYXRlcy5xdWFudGl0eSxcclxuICAgICAgICAgIG1pblN0b2NrOiB1cGRhdGVzLm1pbmltdW1TdG9jayxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGhpc3RvcnkgaWYgcXVhbnRpdHkgY2hhbmdlZFxyXG4gICAgICBpZiAodXBkYXRlcy5xdWFudGl0eSAhPT0gdW5kZWZpbmVkICYmIHVwZGF0ZXMucXVhbnRpdHkgIT09IGN1cnJlbnQuc3RvY2sgJiYgdXBkYXRlcy5jdXN0b21DaGFuZ2VSZWFzb24gIT09ICdza2lwLWhpc3RvcnknKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZVJlYXNvbiA9IHVwZGF0ZXMuY3VzdG9tQ2hhbmdlUmVhc29uO1xyXG4gICAgICAgIGlmICghY2hhbmdlUmVhc29uKSB7XHJcbiAgICAgICAgICBpZiAodXBkYXRlcy5pc0Zyb21TYWxlKSBjaGFuZ2VSZWFzb24gPSBcIlNhbGVcIjtcclxuICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZXMucXVhbnRpdHkgPiBjdXJyZW50LnN0b2NrKSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayBhZGRpdGlvblwiO1xyXG4gICAgICAgICAgZWxzZSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayByZWR1Y3Rpb25cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNuYXBzaG90dGVkUmVhc29uID0gYFske3VwZGF0ZWQubmFtZX1dIHwgJHtjaGFuZ2VSZWFzb259YDtcclxuXHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiB1cGRhdGVzLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiB1cGRhdGVkLmlkLFxyXG4gICAgICAgICAgICB0eXBlOiB1cGRhdGVzLmlzRnJvbVNhbGUgPyAnU0FMRScgOiAodXBkYXRlcy5xdWFudGl0eSA+IGN1cnJlbnQuc3RvY2sgPyAnUkVTVE9DSycgOiAnQURKVVNUTUVOVCcpLFxyXG4gICAgICAgICAgICBvbGRTdG9jazogY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgbmV3U3RvY2s6IHVwZGF0ZXMucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHF1YW50aXR5Q2hhbmdlOiB1cGRhdGVzLnF1YW50aXR5IC0gY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgcmVhc29uOiBzbmFwc2hvdHRlZFJlYXNvbixcclxuICAgICAgICAgICAgcmVmZXJlbmNlSWQ6IHVwZGF0ZXMucmVmZXJlbmNlSWQgfHwgbnVsbCxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3RBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5wcm9kdWN0LmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgIH0pO1xyXG4gICAgLy8gcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnkvcHJvZHVjdHMnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0c0J1bGtBY3Rpb24oXHJcbiAgdXBkYXRlczogQXJyYXk8eyBpZDogc3RyaW5nOyB1cGRhdGVkOiBQYXJ0aWFsPGFueT4gfT4sXHJcbiAgYnVzaW5lc3NJZDogc3RyaW5nXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBQcmlzbWEgdHJhbnNhY3Rpb24gZm9yIGJ1bGsgdXBkYXRlc1xyXG4gICAgY29uc3QgdXBkYXRlUHJvbWlzZXMgPSB1cGRhdGVzLm1hcCh1ID0+XHJcbiAgICAgIGRiLnByb2R1Y3QudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogdS5pZCB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQubmFtZSAmJiB7IG5hbWU6IHUudXBkYXRlZC5uYW1lIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmIHsgZGVzY3JpcHRpb246IHUudXBkYXRlZC5kZXNjcmlwdGlvbiB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkICYmIHsgY2F0ZWdvcnlJZDogdS51cGRhdGVkLmNhdGVnb3J5SWQgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLnN1cHBsaWVySWQgIT09IHVuZGVmaW5lZCAmJiB7IHN1cHBsaWVySWQ6IHUudXBkYXRlZC5zdXBwbGllcklkIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5za3UgIT09IHVuZGVmaW5lZCAmJiB7IHNrdTogdS51cGRhdGVkLnNrdSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuYmFyY29kZSAhPT0gdW5kZWZpbmVkICYmIHsgYmFyY29kZTogdS51cGRhdGVkLmJhcmNvZGUgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLmNvc3RQcmljZSAhPT0gdW5kZWZpbmVkICYmIHsgY29zdFByaWNlOiB1LnVwZGF0ZWQuY29zdFByaWNlIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5zZWxsaW5nUHJpY2UgIT09IHVuZGVmaW5lZCAmJiB7IHNlbGxpbmdQcmljZTogdS51cGRhdGVkLnNlbGxpbmdQcmljZSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQucXVhbnRpdHkgIT09IHVuZGVmaW5lZCAmJiB7IHN0b2NrOiB1LnVwZGF0ZWQucXVhbnRpdHkgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLm1pbmltdW1TdG9jayAhPT0gdW5kZWZpbmVkICYmIHsgbWluU3RvY2s6IHUudXBkYXRlZC5taW5pbXVtU3RvY2sgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBkYi4kdHJhbnNhY3Rpb24odXBkYXRlUHJvbWlzZXMpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBlcmZvcm1pbmcgYnVsayB1cGRhdGU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFBST0RVQ1QgQ0FURUdPUklFUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0Q2F0ZWdvcmllc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLmNhdGVnb3J5LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiBjYXRlZ29yaWVzLm1hcCgoYzogYW55KSA9PiAoe1xyXG4gICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICBjcmVhdGVkX2F0OiBjLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KSlcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9kdWN0Q2F0ZWdvcnlBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgZGIuY2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgIHVzZXJJZCxcclxuICAgICAgICBuYW1lXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yeSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhdGVnb3J5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3RDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5jYXRlZ29yeS51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBkYXRhOiB7IG5hbWUgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHJvZHVjdENhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gQ2hlY2sgaWYgYW55IHByb2R1Y3RzIGFyZSB1c2luZyB0aGlzIGNhdGVnb3J5XHJcbiAgICBjb25zdCB1c2FnZUNvdW50ID0gYXdhaXQgZGIucHJvZHVjdC5jb3VudCh7XHJcbiAgICAgIHdoZXJlOiB7IGNhdGVnb3J5SWQ6IGlkIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh1c2FnZUNvdW50ID4gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBjYXRlZ29yeTogaXQgaXMgYmVpbmcgdXNlZCBieSBvbmUgb3IgbW9yZSBwcm9kdWN0cy4nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZGIuY2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIC0tLSBQUk9EVUNUIFNUQVRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RTdGF0c0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIWJ1c2luZXNzSWQpIHJldHVybiB7IGNvc3RWYWx1ZTogMCwgbG93U3RvY2s6IDAsIG91dE9mU3RvY2s6IDAsIHN0b2NrVmFsdWU6IDAgfTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgIHN0b2NrOiB0cnVlLFxyXG4gICAgICAgIGNvc3RQcmljZTogdHJ1ZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb3N0VmFsdWUgPSAwO1xyXG4gICAgbGV0IGxvd1N0b2NrID0gMDtcclxuICAgIGxldCBvdXRPZlN0b2NrID0gMDtcclxuICAgIGxldCBzdG9ja1ZhbHVlID0gMDtcclxuXHJcbiAgICBwcm9kdWN0cy5mb3JFYWNoKChwOiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgcXR5ID0gTnVtYmVyKHAuc3RvY2spIHx8IDA7XHJcbiAgICAgIGNvbnN0IGNvc3QgPSBOdW1iZXIocC5jb3N0UHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IHNlbGxpbmcgPSBOdW1iZXIocC5zZWxsaW5nUHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IG1pblN0b2NrID0gTnVtYmVyKHAubWluU3RvY2spIHx8IDA7XHJcblxyXG4gICAgICBjb3N0VmFsdWUgKz0gY29zdCAqIHF0eTtcclxuICAgICAgc3RvY2tWYWx1ZSArPSBzZWxsaW5nICogcXR5O1xyXG5cclxuICAgICAgaWYgKHF0eSA9PT0gMCkge1xyXG4gICAgICAgIG91dE9mU3RvY2srKztcclxuICAgICAgfSBlbHNlIGlmIChxdHkgPiAwICYmIHF0eSA8PSBtaW5TdG9jaykge1xyXG4gICAgICAgIGxvd1N0b2NrKys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IGNvc3RWYWx1ZSwgbG93U3RvY2ssIG91dE9mU3RvY2ssIHN0b2NrVmFsdWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdCBzdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBjb3N0VmFsdWU6IDAsIGxvd1N0b2NrOiAwLCBvdXRPZlN0b2NrOiAwLCBzdG9ja1ZhbHVlOiAwIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBMT09LVVAgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbihjb2RlOiBzdHJpbmcsIGJyYW5jaElkOiBzdHJpbmcpIHtcclxuICBpZiAoIWNvZGUgfHwgIWJyYW5jaElkKSByZXR1cm4gbnVsbDtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbG93ZXJDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICBPUjogW1xyXG4gICAgICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBsb3dlckNvZGUsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgICAgeyBza3U6IHsgY29udGFpbnM6IGxvd2VyQ29kZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcm9kdWN0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBTQ0FOTkVSIChhbGwgcHJvZHVjdHMgZm9yIHNjYW5uZXIgcHJlbG9hZCkgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbihicmFuY2hJZDogc3RyaW5nKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBicmFuY2hJZCB9LFxyXG4gICAgICBzZWxlY3Q6IHtcclxuICAgICAgICBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYmFyY29kZTogdHJ1ZSwgc2t1OiB0cnVlLFxyXG4gICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSwgY29zdFByaWNlOiB0cnVlLCBzdG9jazogdHJ1ZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdHJ1ZSwgY2F0ZWdvcnlJZDogdHJ1ZSwgYnJhbmNoSWQ6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsIGltYWdlVXJsOiB0cnVlLCBjcmVhdGVkQXQ6IHRydWUsIHVwZGF0ZWRBdDogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb2R1Y3RzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFNBTEUgQ0FTSCBUUkFOU0FDVElPTiBJRCBVUERBVEUgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihzYWxlSWQ6IHN0cmluZywgY2FzaFRyYW5zYWN0aW9uSWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5zYWxlLnVwZGF0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkOiBzYWxlSWQgfSxcclxuICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignW3VwZGF0ZVNhbGVDYXNoVHJhbnNhY3Rpb25BY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIEZJTFRFUkVEIFBST0RVQ1RTIEZPUiBFWFBPUlQgKGFsbCBwYWdlcykgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyZWRQcm9kdWN0c0ZvckV4cG9ydEFjdGlvbihcclxuICBicmFuY2hJZDogc3RyaW5nLFxyXG4gIGZpbHRlcnM/OiB7IHNlYXJjaD86IHN0cmluZzsgY2F0ZWdvcnk/OiBzdHJpbmc7IHN0b2NrU3RhdHVzPzogc3RyaW5nIH1cclxuKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZCB9O1xyXG5cclxuICAgIGlmIChmaWx0ZXJzPy5zZWFyY2gpIHtcclxuICAgICAgY29uc3QgcyA9IGZpbHRlcnMuc2VhcmNoO1xyXG4gICAgICB3aGVyZS5PUiA9IFtcclxuICAgICAgICB7IG5hbWU6IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgc2t1OiB7IGNvbnRhaW5zOiBzLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycz8uc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgICB3aGVyZS5zdG9jayA9IDA7XHJcbiAgICB9IGVsc2UgaWYgKGZpbHRlcnM/LnN0b2NrU3RhdHVzID09PSAnaW5TdG9jaycpIHtcclxuICAgICAgd2hlcmUuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW2dldEZpbHRlcmVkUHJvZHVjdHNGb3JFeHBvcnRBY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJtU0FxUXNCLGdNQUFBIn0=
}),
"[project]/src/app/actions/data:feeb96 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "deleteProductAction",
    ()=>$$RSC_SERVER_ACTION_5
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"40d77c7a950f7558001cd1309943b62b2f2b6ba221":"deleteProductAction"},"src/app/actions/products.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_5 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("40d77c7a950f7558001cd1309943b62b2f2b6ba221", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "deleteProductAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vcHJvZHVjdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XHJcblxyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RGb3JtRGF0YSwgbWFwRGJQcm9kdWN0VG9Qcm9kdWN0LCBtYXBQcm9kdWN0VG9EYlByb2R1Y3QgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIFdlIGltcGxlbWVudCBzZXJ2ZXIgYWN0aW9ucyBmb3IgdGhlIHByb2R1Y3RzIGhlcmVcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0FjdGlvbih7XHJcbiAgdXNlcklkLFxyXG4gIGJ1c2luZXNzSWQsXHJcbiAgcGFnZSxcclxuICBwYWdlU2l6ZSxcclxuICBzZWFyY2gsXHJcbiAgY2F0ZWdvcnksXHJcbiAgc3RvY2tTdGF0dXMsXHJcbn06IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBidXNpbmVzc0lkOiBzdHJpbmc7XHJcbiAgcGFnZTogbnVtYmVyO1xyXG4gIHBhZ2VTaXplOiBudW1iZXI7XHJcbiAgc2VhcmNoPzogc3RyaW5nO1xyXG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gIHN0b2NrU3RhdHVzPzogJ2luU3RvY2snIHwgJ291dE9mU3RvY2snIHwgJ2xvd1N0b2NrJyB8ICdhbGwnO1xyXG59KSB7XHJcbiAgaWYgKCF1c2VySWQgfHwgIWJ1c2luZXNzSWQpIHJldHVybiB7IHByb2R1Y3RzOiBbXSwgY291bnQ6IDAgfTtcclxuXHJcbiAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuICBjb25zdCB0YWtlID0gcGFnZVNpemU7XHJcblxyXG4gIGxldCB3aGVyZUNsYXVzZTogYW55ID0ge1xyXG4gICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICB9O1xyXG5cclxuICBpZiAoc2VhcmNoKSB7XHJcbiAgICB3aGVyZUNsYXVzZS5PUiA9IFtcclxuICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IGRlc2NyaXB0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IHNrdTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIGlmIChjYXRlZ29yeSkge1xyXG4gICAgd2hlcmVDbGF1c2UuY2F0ZWdvcnkgPSB7IG5hbWU6IGNhdGVnb3J5IH07XHJcbiAgfVxyXG5cclxuICBpZiAoc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSAwO1xyXG4gIH0gZWxzZSBpZiAoc3RvY2tTdGF0dXMgPT09ICdpblN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgfSBlbHNlIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgLy8gSGFuZGxpbmcgbG93U3RvY2sgaXMgY29tcGxleCBiZWNhdXNlIG1pblN0b2NrIGlzIGNvbXBhcmVkIGxvY2FsbHkgb3IgdXNpbmcgZGlyZWN0IFNRTCBpbiBQcmlzbWFcclxuICAgIC8vIEZvciBub3csIHdlIHdpbGwgaGFuZGxlIGl0IHdpdGggUHJpc21hJ3MgcmF3IHF1ZXJ5IG9yIGJ5IGZpbHRlcmluZyBpbiBtZW1vcnkgaWYgbmVjZXNzYXJ5XHJcbiAgICAvLyBGb3J0dW5hdGVseSwgc2luY2UgUFJJU01BIDUuMCwgY29sdW1uIGNvbXBhcmlzb24gc3RpbGwgbmVlZHMgcmF3IHF1ZXJpZXMgb3Igd2UgY2FuIGZldGNoIGFuZCBmaWx0ZXIgaWYgc21hbGxcclxuICAgIC8vIEhlcmUgd2UnbGwgZmV0Y2ggdGhlbSBhbGwgaWYgbG93U3RvY2sgaXMgZW5hYmxlZCwgb3IgYWRkIGEgZ2VuZXJhdGVkIGNvbHVtbi4gXHJcbiAgICAvLyBXZSB3aWxsIGRvIGEgYmFzaWMgZmV0Y2ggYW5kIGZpbHRlciBsYXRlciBpZiBuZWVkZWQuXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Byb2R1Y3RzRGF0YSwgdG90YWxDb3VudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcclxuICAgICAgICBza2lwLFxyXG4gICAgICAgIHRha2UsXHJcbiAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnZGVzYycgfSwgeyBpZDogJ2Rlc2MnIH1dLFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgICAgc3VwcGxpZXI6IHRydWUsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgZGIucHJvZHVjdC5jb3VudCh7IHdoZXJlOiB3aGVyZUNsYXVzZSB9KVxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8gTWFwIHRoZSBQcmlzbWEgcHJvZHVjdCBtb2RlbCBiYWNrIHRvIHRoZSBhcHBsaWNhdGlvbidzIFByb2R1Y3QgdHlwZVxyXG4gICAgbGV0IGZvcm1hdHRlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiB7XHJcbiAgICAgIC8vIEFzc3VtaW5nIG1hcHBpbmcgZXhpc3RzLCB3ZSB3aWxsIG1hcCBpdFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgIG5hbWU6IHAubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICBjYXRlZ29yeTogcC5jYXRlZ29yeT8ubmFtZSB8fCAnVW5jYXRlZ29yaXplZCcsXHJcbiAgICAgICAgcXVhbnRpdHk6IHAuc3RvY2ssXHJcbiAgICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHAuc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgIHN1cHBsaWVyOiBwLnN1cHBsaWVyPy5uYW1lLFxyXG4gICAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICAgIGJhcmNvZGU6IHAuYmFyY29kZSxcclxuICAgICAgICBpdGVtTnVtYmVyOiBwLnNrdSB8fCAnJyxcclxuICAgICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgICBmb3JtYXR0ZWRQcm9kdWN0cyA9IGZvcm1hdHRlZFByb2R1Y3RzLmZpbHRlcigocDogYW55KSA9PiBwLnF1YW50aXR5ID4gMCAmJiBwLnF1YW50aXR5IDw9IHAubWluaW11bVN0b2NrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBwcm9kdWN0czogZm9ybWF0dGVkUHJvZHVjdHMgYXMgYW55W10sIGNvdW50OiB0b3RhbENvdW50IH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgcHJvZHVjdHM6IFtdLCBjb3VudDogMCB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIXVzZXJJZCB8fCAhYnVzaW5lc3NJZCkgcmV0dXJuIFtdO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvZHVjdHNEYXRhID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sIHsgaWQ6ICdkZXNjJyB9XSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgIHN1cHBsaWVyOiB0cnVlLFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogTnVtYmVyKHAuc3RvY2spLFxyXG4gICAgICBjb3N0UHJpY2U6IE51bWJlcihwLmNvc3RQcmljZSksXHJcbiAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHAuc2VsbGluZ1ByaWNlKSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IE51bWJlcihwLm1pblN0b2NrKSxcclxuICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgIH0pKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RzQnlJZHNBY3Rpb24oaWRzOiBzdHJpbmdbXSwgYnVzaW5lc3NJZD86IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0ge1xyXG4gICAgICBpZDogeyBpbjogaWRzIH1cclxuICAgIH07XHJcbiAgICBpZiAoYnVzaW5lc3NJZCkge1xyXG4gICAgICB3aGVyZS5icmFuY2hJZCA9IGJ1c2luZXNzSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcclxuICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHByb2R1Y3RzLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogcC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgc2VsbGluZ1ByaWNlOiBwLnNlbGxpbmdQcmljZSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQsXHJcbiAgICB9KSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGJ5IGlkczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgIC8vIDEuIEdlbmVyYXRlIG5leHQgU0tVL2l0ZW1OdW1iZXIgZm9yIHRoaXMgYnJhbmNoXHJcbiAgICAgIGNvbnN0IGxhc3RQcm9kdWN0ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kRmlyc3Qoe1xyXG4gICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBkYXRhLmJ1c2luZXNzSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiB7IHNrdTogJ2Rlc2MnIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7IHNrdTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbGV0IG5leHRTa3UgPSBcIlBST0QtMDAwMVwiO1xyXG4gICAgICBpZiAobGFzdFByb2R1Y3QgJiYgbGFzdFByb2R1Y3Quc2t1KSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudE51bWJlciA9IHBhcnNlSW50KGxhc3RQcm9kdWN0LnNrdS5yZXBsYWNlKFwiUFJPRC1cIiwgXCJcIikpIHx8IDA7XHJcbiAgICAgICAgbmV4dFNrdSA9IGBQUk9ELSR7KGN1cnJlbnROdW1iZXIgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJyl9YDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMi4gQ3JlYXRlIHRoZSBwcm9kdWN0XHJcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCB0eC5wcm9kdWN0LmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBicmFuY2hJZDogZGF0YS5idXNpbmVzc0lkLFxyXG4gICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IGRhdGEuY2F0ZWdvcnlJZCB8fCBudWxsLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogZGF0YS5zdXBwbGllcklkIHx8IG51bGwsXHJcbiAgICAgICAgICBza3U6IG5leHRTa3UsXHJcbiAgICAgICAgICBiYXJjb2RlOiBkYXRhLmJhcmNvZGUsXHJcbiAgICAgICAgICBpbWFnZTogZGF0YS5pbWFnZVVybCxcclxuICAgICAgICAgIGNvc3RQcmljZTogZGF0YS5jb3N0UHJpY2UgfHwgMCxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogZGF0YS5zZWxsaW5nUHJpY2UgfHwgMCxcclxuICAgICAgICAgIHN0b2NrOiBkYXRhLnF1YW50aXR5IHx8IDAsXHJcbiAgICAgICAgICBtaW5TdG9jazogZGF0YS5taW5pbXVtU3RvY2sgfHwgMCxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXHJcbiAgICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGluaXRpYWwgc3RvY2sgaGlzdG9yeSBpZiBxdWFudGl0eSA+IDBcclxuICAgICAgaWYgKGRhdGEucXVhbnRpdHkgPiAwKSB7XHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICB0eXBlOiAnQ1JFQVRFRCcsXHJcbiAgICAgICAgICAgIG9sZFN0b2NrOiAwLFxyXG4gICAgICAgICAgICBuZXdTdG9jazogZGF0YS5xdWFudGl0eSxcclxuICAgICAgICAgICAgcXVhbnRpdHlDaGFuZ2U6IGRhdGEucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHJlYXNvbjogYFske3Byb2R1Y3QubmFtZX1dIHwgSW5pdGlhbCBzdG9ja2AsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcHJvZHVjdDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcmVzdWx0LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICBjYXRlZ29yeTogcmVzdWx0LmNhdGVnb3J5Py5uYW1lIHx8ICdVbmNhdGVnb3JpemVkJyxcclxuICAgICAgcXVhbnRpdHk6IHJlc3VsdC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiByZXN1bHQuY29zdFByaWNlLFxyXG4gICAgICBzZWxsaW5nUHJpY2U6IHJlc3VsdC5zZWxsaW5nUHJpY2UsXHJcbiAgICAgIHN1cHBsaWVyOiByZXN1bHQuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiByZXN1bHQuaW1hZ2UsXHJcbiAgICAgIGJhcmNvZGU6IHJlc3VsdC5iYXJjb2RlLFxyXG4gICAgICBpdGVtTnVtYmVyOiByZXN1bHQuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHJlc3VsdC5taW5TdG9jayxcclxuICAgICAgY3JlYXRlZEF0OiByZXN1bHQuY3JlYXRlZEF0LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgLy8gMS4gR2V0IGN1cnJlbnQgcHJvZHVjdCBzdGF0ZVxyXG4gICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kVW5pcXVlKHtcclxuICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgIHNlbGVjdDogeyBzdG9jazogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgIC8vIDIuIFBlcmZvcm0gdXBkYXRlXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5wcm9kdWN0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IHVwZGF0ZXMuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkID8gdXBkYXRlcy5jYXRlZ29yeUlkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogdXBkYXRlcy5zdXBwbGllcklkICE9PSB1bmRlZmluZWQgPyB1cGRhdGVzLnN1cHBsaWVySWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBza3U6IHVwZGF0ZXMuaXRlbU51bWJlciB8fCB1cGRhdGVzLnNrdSxcclxuICAgICAgICAgIGJhcmNvZGU6IHVwZGF0ZXMuYmFyY29kZSxcclxuICAgICAgICAgIGltYWdlOiB1cGRhdGVzLmltYWdlVXJsLFxyXG4gICAgICAgICAgY29zdFByaWNlOiB1cGRhdGVzLmNvc3RQcmljZSxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogdXBkYXRlcy5zZWxsaW5nUHJpY2UsXHJcbiAgICAgICAgICBzdG9jazogdXBkYXRlcy5xdWFudGl0eSxcclxuICAgICAgICAgIG1pblN0b2NrOiB1cGRhdGVzLm1pbmltdW1TdG9jayxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGhpc3RvcnkgaWYgcXVhbnRpdHkgY2hhbmdlZFxyXG4gICAgICBpZiAodXBkYXRlcy5xdWFudGl0eSAhPT0gdW5kZWZpbmVkICYmIHVwZGF0ZXMucXVhbnRpdHkgIT09IGN1cnJlbnQuc3RvY2sgJiYgdXBkYXRlcy5jdXN0b21DaGFuZ2VSZWFzb24gIT09ICdza2lwLWhpc3RvcnknKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZVJlYXNvbiA9IHVwZGF0ZXMuY3VzdG9tQ2hhbmdlUmVhc29uO1xyXG4gICAgICAgIGlmICghY2hhbmdlUmVhc29uKSB7XHJcbiAgICAgICAgICBpZiAodXBkYXRlcy5pc0Zyb21TYWxlKSBjaGFuZ2VSZWFzb24gPSBcIlNhbGVcIjtcclxuICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZXMucXVhbnRpdHkgPiBjdXJyZW50LnN0b2NrKSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayBhZGRpdGlvblwiO1xyXG4gICAgICAgICAgZWxzZSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayByZWR1Y3Rpb25cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNuYXBzaG90dGVkUmVhc29uID0gYFske3VwZGF0ZWQubmFtZX1dIHwgJHtjaGFuZ2VSZWFzb259YDtcclxuXHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiB1cGRhdGVzLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiB1cGRhdGVkLmlkLFxyXG4gICAgICAgICAgICB0eXBlOiB1cGRhdGVzLmlzRnJvbVNhbGUgPyAnU0FMRScgOiAodXBkYXRlcy5xdWFudGl0eSA+IGN1cnJlbnQuc3RvY2sgPyAnUkVTVE9DSycgOiAnQURKVVNUTUVOVCcpLFxyXG4gICAgICAgICAgICBvbGRTdG9jazogY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgbmV3U3RvY2s6IHVwZGF0ZXMucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHF1YW50aXR5Q2hhbmdlOiB1cGRhdGVzLnF1YW50aXR5IC0gY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgcmVhc29uOiBzbmFwc2hvdHRlZFJlYXNvbixcclxuICAgICAgICAgICAgcmVmZXJlbmNlSWQ6IHVwZGF0ZXMucmVmZXJlbmNlSWQgfHwgbnVsbCxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3RBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5wcm9kdWN0LmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgIH0pO1xyXG4gICAgLy8gcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnkvcHJvZHVjdHMnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0c0J1bGtBY3Rpb24oXHJcbiAgdXBkYXRlczogQXJyYXk8eyBpZDogc3RyaW5nOyB1cGRhdGVkOiBQYXJ0aWFsPGFueT4gfT4sXHJcbiAgYnVzaW5lc3NJZDogc3RyaW5nXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBQcmlzbWEgdHJhbnNhY3Rpb24gZm9yIGJ1bGsgdXBkYXRlc1xyXG4gICAgY29uc3QgdXBkYXRlUHJvbWlzZXMgPSB1cGRhdGVzLm1hcCh1ID0+XHJcbiAgICAgIGRiLnByb2R1Y3QudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogdS5pZCB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQubmFtZSAmJiB7IG5hbWU6IHUudXBkYXRlZC5uYW1lIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmIHsgZGVzY3JpcHRpb246IHUudXBkYXRlZC5kZXNjcmlwdGlvbiB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkICYmIHsgY2F0ZWdvcnlJZDogdS51cGRhdGVkLmNhdGVnb3J5SWQgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLnN1cHBsaWVySWQgIT09IHVuZGVmaW5lZCAmJiB7IHN1cHBsaWVySWQ6IHUudXBkYXRlZC5zdXBwbGllcklkIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5za3UgIT09IHVuZGVmaW5lZCAmJiB7IHNrdTogdS51cGRhdGVkLnNrdSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuYmFyY29kZSAhPT0gdW5kZWZpbmVkICYmIHsgYmFyY29kZTogdS51cGRhdGVkLmJhcmNvZGUgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLmNvc3RQcmljZSAhPT0gdW5kZWZpbmVkICYmIHsgY29zdFByaWNlOiB1LnVwZGF0ZWQuY29zdFByaWNlIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5zZWxsaW5nUHJpY2UgIT09IHVuZGVmaW5lZCAmJiB7IHNlbGxpbmdQcmljZTogdS51cGRhdGVkLnNlbGxpbmdQcmljZSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQucXVhbnRpdHkgIT09IHVuZGVmaW5lZCAmJiB7IHN0b2NrOiB1LnVwZGF0ZWQucXVhbnRpdHkgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLm1pbmltdW1TdG9jayAhPT0gdW5kZWZpbmVkICYmIHsgbWluU3RvY2s6IHUudXBkYXRlZC5taW5pbXVtU3RvY2sgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBkYi4kdHJhbnNhY3Rpb24odXBkYXRlUHJvbWlzZXMpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBlcmZvcm1pbmcgYnVsayB1cGRhdGU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFBST0RVQ1QgQ0FURUdPUklFUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0Q2F0ZWdvcmllc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLmNhdGVnb3J5LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiBjYXRlZ29yaWVzLm1hcCgoYzogYW55KSA9PiAoe1xyXG4gICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICBjcmVhdGVkX2F0OiBjLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KSlcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9kdWN0Q2F0ZWdvcnlBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgZGIuY2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgIHVzZXJJZCxcclxuICAgICAgICBuYW1lXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yeSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhdGVnb3J5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3RDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5jYXRlZ29yeS51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBkYXRhOiB7IG5hbWUgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHJvZHVjdENhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gQ2hlY2sgaWYgYW55IHByb2R1Y3RzIGFyZSB1c2luZyB0aGlzIGNhdGVnb3J5XHJcbiAgICBjb25zdCB1c2FnZUNvdW50ID0gYXdhaXQgZGIucHJvZHVjdC5jb3VudCh7XHJcbiAgICAgIHdoZXJlOiB7IGNhdGVnb3J5SWQ6IGlkIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh1c2FnZUNvdW50ID4gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBjYXRlZ29yeTogaXQgaXMgYmVpbmcgdXNlZCBieSBvbmUgb3IgbW9yZSBwcm9kdWN0cy4nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZGIuY2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIC0tLSBQUk9EVUNUIFNUQVRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RTdGF0c0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIWJ1c2luZXNzSWQpIHJldHVybiB7IGNvc3RWYWx1ZTogMCwgbG93U3RvY2s6IDAsIG91dE9mU3RvY2s6IDAsIHN0b2NrVmFsdWU6IDAgfTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgIHN0b2NrOiB0cnVlLFxyXG4gICAgICAgIGNvc3RQcmljZTogdHJ1ZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb3N0VmFsdWUgPSAwO1xyXG4gICAgbGV0IGxvd1N0b2NrID0gMDtcclxuICAgIGxldCBvdXRPZlN0b2NrID0gMDtcclxuICAgIGxldCBzdG9ja1ZhbHVlID0gMDtcclxuXHJcbiAgICBwcm9kdWN0cy5mb3JFYWNoKChwOiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgcXR5ID0gTnVtYmVyKHAuc3RvY2spIHx8IDA7XHJcbiAgICAgIGNvbnN0IGNvc3QgPSBOdW1iZXIocC5jb3N0UHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IHNlbGxpbmcgPSBOdW1iZXIocC5zZWxsaW5nUHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IG1pblN0b2NrID0gTnVtYmVyKHAubWluU3RvY2spIHx8IDA7XHJcblxyXG4gICAgICBjb3N0VmFsdWUgKz0gY29zdCAqIHF0eTtcclxuICAgICAgc3RvY2tWYWx1ZSArPSBzZWxsaW5nICogcXR5O1xyXG5cclxuICAgICAgaWYgKHF0eSA9PT0gMCkge1xyXG4gICAgICAgIG91dE9mU3RvY2srKztcclxuICAgICAgfSBlbHNlIGlmIChxdHkgPiAwICYmIHF0eSA8PSBtaW5TdG9jaykge1xyXG4gICAgICAgIGxvd1N0b2NrKys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IGNvc3RWYWx1ZSwgbG93U3RvY2ssIG91dE9mU3RvY2ssIHN0b2NrVmFsdWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdCBzdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBjb3N0VmFsdWU6IDAsIGxvd1N0b2NrOiAwLCBvdXRPZlN0b2NrOiAwLCBzdG9ja1ZhbHVlOiAwIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBMT09LVVAgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbihjb2RlOiBzdHJpbmcsIGJyYW5jaElkOiBzdHJpbmcpIHtcclxuICBpZiAoIWNvZGUgfHwgIWJyYW5jaElkKSByZXR1cm4gbnVsbDtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbG93ZXJDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICBPUjogW1xyXG4gICAgICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBsb3dlckNvZGUsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgICAgeyBza3U6IHsgY29udGFpbnM6IGxvd2VyQ29kZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcm9kdWN0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBTQ0FOTkVSIChhbGwgcHJvZHVjdHMgZm9yIHNjYW5uZXIgcHJlbG9hZCkgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbihicmFuY2hJZDogc3RyaW5nKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBicmFuY2hJZCB9LFxyXG4gICAgICBzZWxlY3Q6IHtcclxuICAgICAgICBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYmFyY29kZTogdHJ1ZSwgc2t1OiB0cnVlLFxyXG4gICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSwgY29zdFByaWNlOiB0cnVlLCBzdG9jazogdHJ1ZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdHJ1ZSwgY2F0ZWdvcnlJZDogdHJ1ZSwgYnJhbmNoSWQ6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsIGltYWdlVXJsOiB0cnVlLCBjcmVhdGVkQXQ6IHRydWUsIHVwZGF0ZWRBdDogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb2R1Y3RzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFNBTEUgQ0FTSCBUUkFOU0FDVElPTiBJRCBVUERBVEUgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihzYWxlSWQ6IHN0cmluZywgY2FzaFRyYW5zYWN0aW9uSWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5zYWxlLnVwZGF0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkOiBzYWxlSWQgfSxcclxuICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignW3VwZGF0ZVNhbGVDYXNoVHJhbnNhY3Rpb25BY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIEZJTFRFUkVEIFBST0RVQ1RTIEZPUiBFWFBPUlQgKGFsbCBwYWdlcykgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyZWRQcm9kdWN0c0ZvckV4cG9ydEFjdGlvbihcclxuICBicmFuY2hJZDogc3RyaW5nLFxyXG4gIGZpbHRlcnM/OiB7IHNlYXJjaD86IHN0cmluZzsgY2F0ZWdvcnk/OiBzdHJpbmc7IHN0b2NrU3RhdHVzPzogc3RyaW5nIH1cclxuKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZCB9O1xyXG5cclxuICAgIGlmIChmaWx0ZXJzPy5zZWFyY2gpIHtcclxuICAgICAgY29uc3QgcyA9IGZpbHRlcnMuc2VhcmNoO1xyXG4gICAgICB3aGVyZS5PUiA9IFtcclxuICAgICAgICB7IG5hbWU6IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgc2t1OiB7IGNvbnRhaW5zOiBzLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycz8uc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgICB3aGVyZS5zdG9jayA9IDA7XHJcbiAgICB9IGVsc2UgaWYgKGZpbHRlcnM/LnN0b2NrU3RhdHVzID09PSAnaW5TdG9jaycpIHtcclxuICAgICAgd2hlcmUuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW2dldEZpbHRlcmVkUHJvZHVjdHNGb3JFeHBvcnRBY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJtU0FxVXNCLGdNQUFBIn0=
}),
"[project]/src/app/actions/data:d22ceb [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "updateProductsBulkAction",
    ()=>$$RSC_SERVER_ACTION_6
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"609b8c32a570899b81791858dba0aee579337a2235":"updateProductsBulkAction"},"src/app/actions/products.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_6 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("609b8c32a570899b81791858dba0aee579337a2235", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "updateProductsBulkAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vcHJvZHVjdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XHJcblxyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RGb3JtRGF0YSwgbWFwRGJQcm9kdWN0VG9Qcm9kdWN0LCBtYXBQcm9kdWN0VG9EYlByb2R1Y3QgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIFdlIGltcGxlbWVudCBzZXJ2ZXIgYWN0aW9ucyBmb3IgdGhlIHByb2R1Y3RzIGhlcmVcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0FjdGlvbih7XHJcbiAgdXNlcklkLFxyXG4gIGJ1c2luZXNzSWQsXHJcbiAgcGFnZSxcclxuICBwYWdlU2l6ZSxcclxuICBzZWFyY2gsXHJcbiAgY2F0ZWdvcnksXHJcbiAgc3RvY2tTdGF0dXMsXHJcbn06IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBidXNpbmVzc0lkOiBzdHJpbmc7XHJcbiAgcGFnZTogbnVtYmVyO1xyXG4gIHBhZ2VTaXplOiBudW1iZXI7XHJcbiAgc2VhcmNoPzogc3RyaW5nO1xyXG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gIHN0b2NrU3RhdHVzPzogJ2luU3RvY2snIHwgJ291dE9mU3RvY2snIHwgJ2xvd1N0b2NrJyB8ICdhbGwnO1xyXG59KSB7XHJcbiAgaWYgKCF1c2VySWQgfHwgIWJ1c2luZXNzSWQpIHJldHVybiB7IHByb2R1Y3RzOiBbXSwgY291bnQ6IDAgfTtcclxuXHJcbiAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuICBjb25zdCB0YWtlID0gcGFnZVNpemU7XHJcblxyXG4gIGxldCB3aGVyZUNsYXVzZTogYW55ID0ge1xyXG4gICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICB9O1xyXG5cclxuICBpZiAoc2VhcmNoKSB7XHJcbiAgICB3aGVyZUNsYXVzZS5PUiA9IFtcclxuICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IGRlc2NyaXB0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IHNrdTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIGlmIChjYXRlZ29yeSkge1xyXG4gICAgd2hlcmVDbGF1c2UuY2F0ZWdvcnkgPSB7IG5hbWU6IGNhdGVnb3J5IH07XHJcbiAgfVxyXG5cclxuICBpZiAoc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSAwO1xyXG4gIH0gZWxzZSBpZiAoc3RvY2tTdGF0dXMgPT09ICdpblN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgfSBlbHNlIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgLy8gSGFuZGxpbmcgbG93U3RvY2sgaXMgY29tcGxleCBiZWNhdXNlIG1pblN0b2NrIGlzIGNvbXBhcmVkIGxvY2FsbHkgb3IgdXNpbmcgZGlyZWN0IFNRTCBpbiBQcmlzbWFcclxuICAgIC8vIEZvciBub3csIHdlIHdpbGwgaGFuZGxlIGl0IHdpdGggUHJpc21hJ3MgcmF3IHF1ZXJ5IG9yIGJ5IGZpbHRlcmluZyBpbiBtZW1vcnkgaWYgbmVjZXNzYXJ5XHJcbiAgICAvLyBGb3J0dW5hdGVseSwgc2luY2UgUFJJU01BIDUuMCwgY29sdW1uIGNvbXBhcmlzb24gc3RpbGwgbmVlZHMgcmF3IHF1ZXJpZXMgb3Igd2UgY2FuIGZldGNoIGFuZCBmaWx0ZXIgaWYgc21hbGxcclxuICAgIC8vIEhlcmUgd2UnbGwgZmV0Y2ggdGhlbSBhbGwgaWYgbG93U3RvY2sgaXMgZW5hYmxlZCwgb3IgYWRkIGEgZ2VuZXJhdGVkIGNvbHVtbi4gXHJcbiAgICAvLyBXZSB3aWxsIGRvIGEgYmFzaWMgZmV0Y2ggYW5kIGZpbHRlciBsYXRlciBpZiBuZWVkZWQuXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Byb2R1Y3RzRGF0YSwgdG90YWxDb3VudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcclxuICAgICAgICBza2lwLFxyXG4gICAgICAgIHRha2UsXHJcbiAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnZGVzYycgfSwgeyBpZDogJ2Rlc2MnIH1dLFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgICAgc3VwcGxpZXI6IHRydWUsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgZGIucHJvZHVjdC5jb3VudCh7IHdoZXJlOiB3aGVyZUNsYXVzZSB9KVxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8gTWFwIHRoZSBQcmlzbWEgcHJvZHVjdCBtb2RlbCBiYWNrIHRvIHRoZSBhcHBsaWNhdGlvbidzIFByb2R1Y3QgdHlwZVxyXG4gICAgbGV0IGZvcm1hdHRlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiB7XHJcbiAgICAgIC8vIEFzc3VtaW5nIG1hcHBpbmcgZXhpc3RzLCB3ZSB3aWxsIG1hcCBpdFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgIG5hbWU6IHAubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICBjYXRlZ29yeTogcC5jYXRlZ29yeT8ubmFtZSB8fCAnVW5jYXRlZ29yaXplZCcsXHJcbiAgICAgICAgcXVhbnRpdHk6IHAuc3RvY2ssXHJcbiAgICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHAuc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgIHN1cHBsaWVyOiBwLnN1cHBsaWVyPy5uYW1lLFxyXG4gICAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICAgIGJhcmNvZGU6IHAuYmFyY29kZSxcclxuICAgICAgICBpdGVtTnVtYmVyOiBwLnNrdSB8fCAnJyxcclxuICAgICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgICBmb3JtYXR0ZWRQcm9kdWN0cyA9IGZvcm1hdHRlZFByb2R1Y3RzLmZpbHRlcigocDogYW55KSA9PiBwLnF1YW50aXR5ID4gMCAmJiBwLnF1YW50aXR5IDw9IHAubWluaW11bVN0b2NrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBwcm9kdWN0czogZm9ybWF0dGVkUHJvZHVjdHMgYXMgYW55W10sIGNvdW50OiB0b3RhbENvdW50IH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgcHJvZHVjdHM6IFtdLCBjb3VudDogMCB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIXVzZXJJZCB8fCAhYnVzaW5lc3NJZCkgcmV0dXJuIFtdO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvZHVjdHNEYXRhID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sIHsgaWQ6ICdkZXNjJyB9XSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgIHN1cHBsaWVyOiB0cnVlLFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogTnVtYmVyKHAuc3RvY2spLFxyXG4gICAgICBjb3N0UHJpY2U6IE51bWJlcihwLmNvc3RQcmljZSksXHJcbiAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHAuc2VsbGluZ1ByaWNlKSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IE51bWJlcihwLm1pblN0b2NrKSxcclxuICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgIH0pKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RzQnlJZHNBY3Rpb24oaWRzOiBzdHJpbmdbXSwgYnVzaW5lc3NJZD86IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0ge1xyXG4gICAgICBpZDogeyBpbjogaWRzIH1cclxuICAgIH07XHJcbiAgICBpZiAoYnVzaW5lc3NJZCkge1xyXG4gICAgICB3aGVyZS5icmFuY2hJZCA9IGJ1c2luZXNzSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcclxuICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHByb2R1Y3RzLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogcC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgc2VsbGluZ1ByaWNlOiBwLnNlbGxpbmdQcmljZSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQsXHJcbiAgICB9KSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGJ5IGlkczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgIC8vIDEuIEdlbmVyYXRlIG5leHQgU0tVL2l0ZW1OdW1iZXIgZm9yIHRoaXMgYnJhbmNoXHJcbiAgICAgIGNvbnN0IGxhc3RQcm9kdWN0ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kRmlyc3Qoe1xyXG4gICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBkYXRhLmJ1c2luZXNzSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiB7IHNrdTogJ2Rlc2MnIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7IHNrdTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbGV0IG5leHRTa3UgPSBcIlBST0QtMDAwMVwiO1xyXG4gICAgICBpZiAobGFzdFByb2R1Y3QgJiYgbGFzdFByb2R1Y3Quc2t1KSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudE51bWJlciA9IHBhcnNlSW50KGxhc3RQcm9kdWN0LnNrdS5yZXBsYWNlKFwiUFJPRC1cIiwgXCJcIikpIHx8IDA7XHJcbiAgICAgICAgbmV4dFNrdSA9IGBQUk9ELSR7KGN1cnJlbnROdW1iZXIgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJyl9YDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMi4gQ3JlYXRlIHRoZSBwcm9kdWN0XHJcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCB0eC5wcm9kdWN0LmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBicmFuY2hJZDogZGF0YS5idXNpbmVzc0lkLFxyXG4gICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IGRhdGEuY2F0ZWdvcnlJZCB8fCBudWxsLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogZGF0YS5zdXBwbGllcklkIHx8IG51bGwsXHJcbiAgICAgICAgICBza3U6IG5leHRTa3UsXHJcbiAgICAgICAgICBiYXJjb2RlOiBkYXRhLmJhcmNvZGUsXHJcbiAgICAgICAgICBpbWFnZTogZGF0YS5pbWFnZVVybCxcclxuICAgICAgICAgIGNvc3RQcmljZTogZGF0YS5jb3N0UHJpY2UgfHwgMCxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogZGF0YS5zZWxsaW5nUHJpY2UgfHwgMCxcclxuICAgICAgICAgIHN0b2NrOiBkYXRhLnF1YW50aXR5IHx8IDAsXHJcbiAgICAgICAgICBtaW5TdG9jazogZGF0YS5taW5pbXVtU3RvY2sgfHwgMCxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXHJcbiAgICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGluaXRpYWwgc3RvY2sgaGlzdG9yeSBpZiBxdWFudGl0eSA+IDBcclxuICAgICAgaWYgKGRhdGEucXVhbnRpdHkgPiAwKSB7XHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICB0eXBlOiAnQ1JFQVRFRCcsXHJcbiAgICAgICAgICAgIG9sZFN0b2NrOiAwLFxyXG4gICAgICAgICAgICBuZXdTdG9jazogZGF0YS5xdWFudGl0eSxcclxuICAgICAgICAgICAgcXVhbnRpdHlDaGFuZ2U6IGRhdGEucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHJlYXNvbjogYFske3Byb2R1Y3QubmFtZX1dIHwgSW5pdGlhbCBzdG9ja2AsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcHJvZHVjdDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcmVzdWx0LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICBjYXRlZ29yeTogcmVzdWx0LmNhdGVnb3J5Py5uYW1lIHx8ICdVbmNhdGVnb3JpemVkJyxcclxuICAgICAgcXVhbnRpdHk6IHJlc3VsdC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiByZXN1bHQuY29zdFByaWNlLFxyXG4gICAgICBzZWxsaW5nUHJpY2U6IHJlc3VsdC5zZWxsaW5nUHJpY2UsXHJcbiAgICAgIHN1cHBsaWVyOiByZXN1bHQuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiByZXN1bHQuaW1hZ2UsXHJcbiAgICAgIGJhcmNvZGU6IHJlc3VsdC5iYXJjb2RlLFxyXG4gICAgICBpdGVtTnVtYmVyOiByZXN1bHQuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHJlc3VsdC5taW5TdG9jayxcclxuICAgICAgY3JlYXRlZEF0OiByZXN1bHQuY3JlYXRlZEF0LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgLy8gMS4gR2V0IGN1cnJlbnQgcHJvZHVjdCBzdGF0ZVxyXG4gICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kVW5pcXVlKHtcclxuICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgIHNlbGVjdDogeyBzdG9jazogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgIC8vIDIuIFBlcmZvcm0gdXBkYXRlXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5wcm9kdWN0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IHVwZGF0ZXMuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkID8gdXBkYXRlcy5jYXRlZ29yeUlkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogdXBkYXRlcy5zdXBwbGllcklkICE9PSB1bmRlZmluZWQgPyB1cGRhdGVzLnN1cHBsaWVySWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBza3U6IHVwZGF0ZXMuaXRlbU51bWJlciB8fCB1cGRhdGVzLnNrdSxcclxuICAgICAgICAgIGJhcmNvZGU6IHVwZGF0ZXMuYmFyY29kZSxcclxuICAgICAgICAgIGltYWdlOiB1cGRhdGVzLmltYWdlVXJsLFxyXG4gICAgICAgICAgY29zdFByaWNlOiB1cGRhdGVzLmNvc3RQcmljZSxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogdXBkYXRlcy5zZWxsaW5nUHJpY2UsXHJcbiAgICAgICAgICBzdG9jazogdXBkYXRlcy5xdWFudGl0eSxcclxuICAgICAgICAgIG1pblN0b2NrOiB1cGRhdGVzLm1pbmltdW1TdG9jayxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGhpc3RvcnkgaWYgcXVhbnRpdHkgY2hhbmdlZFxyXG4gICAgICBpZiAodXBkYXRlcy5xdWFudGl0eSAhPT0gdW5kZWZpbmVkICYmIHVwZGF0ZXMucXVhbnRpdHkgIT09IGN1cnJlbnQuc3RvY2sgJiYgdXBkYXRlcy5jdXN0b21DaGFuZ2VSZWFzb24gIT09ICdza2lwLWhpc3RvcnknKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZVJlYXNvbiA9IHVwZGF0ZXMuY3VzdG9tQ2hhbmdlUmVhc29uO1xyXG4gICAgICAgIGlmICghY2hhbmdlUmVhc29uKSB7XHJcbiAgICAgICAgICBpZiAodXBkYXRlcy5pc0Zyb21TYWxlKSBjaGFuZ2VSZWFzb24gPSBcIlNhbGVcIjtcclxuICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZXMucXVhbnRpdHkgPiBjdXJyZW50LnN0b2NrKSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayBhZGRpdGlvblwiO1xyXG4gICAgICAgICAgZWxzZSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayByZWR1Y3Rpb25cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNuYXBzaG90dGVkUmVhc29uID0gYFske3VwZGF0ZWQubmFtZX1dIHwgJHtjaGFuZ2VSZWFzb259YDtcclxuXHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiB1cGRhdGVzLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiB1cGRhdGVkLmlkLFxyXG4gICAgICAgICAgICB0eXBlOiB1cGRhdGVzLmlzRnJvbVNhbGUgPyAnU0FMRScgOiAodXBkYXRlcy5xdWFudGl0eSA+IGN1cnJlbnQuc3RvY2sgPyAnUkVTVE9DSycgOiAnQURKVVNUTUVOVCcpLFxyXG4gICAgICAgICAgICBvbGRTdG9jazogY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgbmV3U3RvY2s6IHVwZGF0ZXMucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHF1YW50aXR5Q2hhbmdlOiB1cGRhdGVzLnF1YW50aXR5IC0gY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgcmVhc29uOiBzbmFwc2hvdHRlZFJlYXNvbixcclxuICAgICAgICAgICAgcmVmZXJlbmNlSWQ6IHVwZGF0ZXMucmVmZXJlbmNlSWQgfHwgbnVsbCxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3RBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5wcm9kdWN0LmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgIH0pO1xyXG4gICAgLy8gcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnkvcHJvZHVjdHMnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0c0J1bGtBY3Rpb24oXHJcbiAgdXBkYXRlczogQXJyYXk8eyBpZDogc3RyaW5nOyB1cGRhdGVkOiBQYXJ0aWFsPGFueT4gfT4sXHJcbiAgYnVzaW5lc3NJZDogc3RyaW5nXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBQcmlzbWEgdHJhbnNhY3Rpb24gZm9yIGJ1bGsgdXBkYXRlc1xyXG4gICAgY29uc3QgdXBkYXRlUHJvbWlzZXMgPSB1cGRhdGVzLm1hcCh1ID0+XHJcbiAgICAgIGRiLnByb2R1Y3QudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogdS5pZCB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQubmFtZSAmJiB7IG5hbWU6IHUudXBkYXRlZC5uYW1lIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmIHsgZGVzY3JpcHRpb246IHUudXBkYXRlZC5kZXNjcmlwdGlvbiB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkICYmIHsgY2F0ZWdvcnlJZDogdS51cGRhdGVkLmNhdGVnb3J5SWQgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLnN1cHBsaWVySWQgIT09IHVuZGVmaW5lZCAmJiB7IHN1cHBsaWVySWQ6IHUudXBkYXRlZC5zdXBwbGllcklkIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5za3UgIT09IHVuZGVmaW5lZCAmJiB7IHNrdTogdS51cGRhdGVkLnNrdSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuYmFyY29kZSAhPT0gdW5kZWZpbmVkICYmIHsgYmFyY29kZTogdS51cGRhdGVkLmJhcmNvZGUgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLmNvc3RQcmljZSAhPT0gdW5kZWZpbmVkICYmIHsgY29zdFByaWNlOiB1LnVwZGF0ZWQuY29zdFByaWNlIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5zZWxsaW5nUHJpY2UgIT09IHVuZGVmaW5lZCAmJiB7IHNlbGxpbmdQcmljZTogdS51cGRhdGVkLnNlbGxpbmdQcmljZSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQucXVhbnRpdHkgIT09IHVuZGVmaW5lZCAmJiB7IHN0b2NrOiB1LnVwZGF0ZWQucXVhbnRpdHkgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLm1pbmltdW1TdG9jayAhPT0gdW5kZWZpbmVkICYmIHsgbWluU3RvY2s6IHUudXBkYXRlZC5taW5pbXVtU3RvY2sgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBkYi4kdHJhbnNhY3Rpb24odXBkYXRlUHJvbWlzZXMpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBlcmZvcm1pbmcgYnVsayB1cGRhdGU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFBST0RVQ1QgQ0FURUdPUklFUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0Q2F0ZWdvcmllc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLmNhdGVnb3J5LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiBjYXRlZ29yaWVzLm1hcCgoYzogYW55KSA9PiAoe1xyXG4gICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICBjcmVhdGVkX2F0OiBjLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KSlcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9kdWN0Q2F0ZWdvcnlBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgZGIuY2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgIHVzZXJJZCxcclxuICAgICAgICBuYW1lXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yeSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhdGVnb3J5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3RDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5jYXRlZ29yeS51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBkYXRhOiB7IG5hbWUgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHJvZHVjdENhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gQ2hlY2sgaWYgYW55IHByb2R1Y3RzIGFyZSB1c2luZyB0aGlzIGNhdGVnb3J5XHJcbiAgICBjb25zdCB1c2FnZUNvdW50ID0gYXdhaXQgZGIucHJvZHVjdC5jb3VudCh7XHJcbiAgICAgIHdoZXJlOiB7IGNhdGVnb3J5SWQ6IGlkIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh1c2FnZUNvdW50ID4gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBjYXRlZ29yeTogaXQgaXMgYmVpbmcgdXNlZCBieSBvbmUgb3IgbW9yZSBwcm9kdWN0cy4nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZGIuY2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIC0tLSBQUk9EVUNUIFNUQVRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RTdGF0c0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIWJ1c2luZXNzSWQpIHJldHVybiB7IGNvc3RWYWx1ZTogMCwgbG93U3RvY2s6IDAsIG91dE9mU3RvY2s6IDAsIHN0b2NrVmFsdWU6IDAgfTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgIHN0b2NrOiB0cnVlLFxyXG4gICAgICAgIGNvc3RQcmljZTogdHJ1ZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb3N0VmFsdWUgPSAwO1xyXG4gICAgbGV0IGxvd1N0b2NrID0gMDtcclxuICAgIGxldCBvdXRPZlN0b2NrID0gMDtcclxuICAgIGxldCBzdG9ja1ZhbHVlID0gMDtcclxuXHJcbiAgICBwcm9kdWN0cy5mb3JFYWNoKChwOiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgcXR5ID0gTnVtYmVyKHAuc3RvY2spIHx8IDA7XHJcbiAgICAgIGNvbnN0IGNvc3QgPSBOdW1iZXIocC5jb3N0UHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IHNlbGxpbmcgPSBOdW1iZXIocC5zZWxsaW5nUHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IG1pblN0b2NrID0gTnVtYmVyKHAubWluU3RvY2spIHx8IDA7XHJcblxyXG4gICAgICBjb3N0VmFsdWUgKz0gY29zdCAqIHF0eTtcclxuICAgICAgc3RvY2tWYWx1ZSArPSBzZWxsaW5nICogcXR5O1xyXG5cclxuICAgICAgaWYgKHF0eSA9PT0gMCkge1xyXG4gICAgICAgIG91dE9mU3RvY2srKztcclxuICAgICAgfSBlbHNlIGlmIChxdHkgPiAwICYmIHF0eSA8PSBtaW5TdG9jaykge1xyXG4gICAgICAgIGxvd1N0b2NrKys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IGNvc3RWYWx1ZSwgbG93U3RvY2ssIG91dE9mU3RvY2ssIHN0b2NrVmFsdWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdCBzdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBjb3N0VmFsdWU6IDAsIGxvd1N0b2NrOiAwLCBvdXRPZlN0b2NrOiAwLCBzdG9ja1ZhbHVlOiAwIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBMT09LVVAgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbihjb2RlOiBzdHJpbmcsIGJyYW5jaElkOiBzdHJpbmcpIHtcclxuICBpZiAoIWNvZGUgfHwgIWJyYW5jaElkKSByZXR1cm4gbnVsbDtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbG93ZXJDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICBPUjogW1xyXG4gICAgICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBsb3dlckNvZGUsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgICAgeyBza3U6IHsgY29udGFpbnM6IGxvd2VyQ29kZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcm9kdWN0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBTQ0FOTkVSIChhbGwgcHJvZHVjdHMgZm9yIHNjYW5uZXIgcHJlbG9hZCkgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbihicmFuY2hJZDogc3RyaW5nKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBicmFuY2hJZCB9LFxyXG4gICAgICBzZWxlY3Q6IHtcclxuICAgICAgICBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYmFyY29kZTogdHJ1ZSwgc2t1OiB0cnVlLFxyXG4gICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSwgY29zdFByaWNlOiB0cnVlLCBzdG9jazogdHJ1ZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdHJ1ZSwgY2F0ZWdvcnlJZDogdHJ1ZSwgYnJhbmNoSWQ6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsIGltYWdlVXJsOiB0cnVlLCBjcmVhdGVkQXQ6IHRydWUsIHVwZGF0ZWRBdDogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb2R1Y3RzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFNBTEUgQ0FTSCBUUkFOU0FDVElPTiBJRCBVUERBVEUgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihzYWxlSWQ6IHN0cmluZywgY2FzaFRyYW5zYWN0aW9uSWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5zYWxlLnVwZGF0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkOiBzYWxlSWQgfSxcclxuICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignW3VwZGF0ZVNhbGVDYXNoVHJhbnNhY3Rpb25BY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIEZJTFRFUkVEIFBST0RVQ1RTIEZPUiBFWFBPUlQgKGFsbCBwYWdlcykgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyZWRQcm9kdWN0c0ZvckV4cG9ydEFjdGlvbihcclxuICBicmFuY2hJZDogc3RyaW5nLFxyXG4gIGZpbHRlcnM/OiB7IHNlYXJjaD86IHN0cmluZzsgY2F0ZWdvcnk/OiBzdHJpbmc7IHN0b2NrU3RhdHVzPzogc3RyaW5nIH1cclxuKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZCB9O1xyXG5cclxuICAgIGlmIChmaWx0ZXJzPy5zZWFyY2gpIHtcclxuICAgICAgY29uc3QgcyA9IGZpbHRlcnMuc2VhcmNoO1xyXG4gICAgICB3aGVyZS5PUiA9IFtcclxuICAgICAgICB7IG5hbWU6IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgc2t1OiB7IGNvbnRhaW5zOiBzLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycz8uc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgICB3aGVyZS5zdG9jayA9IDA7XHJcbiAgICB9IGVsc2UgaWYgKGZpbHRlcnM/LnN0b2NrU3RhdHVzID09PSAnaW5TdG9jaycpIHtcclxuICAgICAgd2hlcmUuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW2dldEZpbHRlcmVkUHJvZHVjdHNGb3JFeHBvcnRBY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJ3U0FrVnNCLHFNQUFBIn0=
}),
"[project]/src/app/actions/data:9a4f8d [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "logActivityAction",
    ()=>$$RSC_SERVER_ACTION_0
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"40b04c541d9ff35205d318046476e78cb072b4d271":"logActivityAction"},"src/app/actions/activity.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_0 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("40b04c541d9ff35205d318046476e78cb072b4d271", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "logActivityAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vYWN0aXZpdHkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzZXJ2ZXInO1xyXG5cclxuaW1wb3J0IHsgZGIsIEFjdGl2aXR5VHlwZSwgQWN0aXZpdHlNb2R1bGUgfSBmcm9tICcuLi8uLi8uLi9wcmlzbWEvZGInO1xyXG5pbXBvcnQgeyByZXZhbGlkYXRlUGF0aCB9IGZyb20gJ25leHQvY2FjaGUnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBY3Rpdml0eUxvZ0lucHV0IHtcclxuICAgIHVzZXJJZDogc3RyaW5nO1xyXG4gICAgbG9jYXRpb25JZDogc3RyaW5nO1xyXG4gICAgYWN0aXZpdHlUeXBlOiBBY3Rpdml0eVR5cGU7XHJcbiAgICBtb2R1bGU6IEFjdGl2aXR5TW9kdWxlO1xyXG4gICAgZW50aXR5VHlwZTogc3RyaW5nO1xyXG4gICAgZW50aXR5SWQ/OiBzdHJpbmc7XHJcbiAgICBlbnRpdHlOYW1lOiBzdHJpbmc7XHJcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gICAgbWV0YWRhdGE/OiBhbnk7XHJcbiAgICBwcm9maWxlSWQ/OiBzdHJpbmc7XHJcbiAgICBwcm9maWxlTmFtZT86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ0FjdGl2aXR5QWN0aW9uKGRhdGE6IEFjdGl2aXR5TG9nSW5wdXQpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBhY3Rpdml0eVR5cGU6IGRhdGEuYWN0aXZpdHlUeXBlLFxyXG4gICAgICAgICAgICAgICAgbW9kdWxlOiBkYXRhLm1vZHVsZSxcclxuICAgICAgICAgICAgICAgIGVudGl0eVR5cGU6IGRhdGEuZW50aXR5VHlwZSxcclxuICAgICAgICAgICAgICAgIGVudGl0eUlkOiBkYXRhLmVudGl0eUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICBlbnRpdHlOYW1lOiBkYXRhLmVudGl0eU5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBkYXRhLm1ldGFkYXRhIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICBwcm9maWxlSWQ6IGRhdGEucHJvZmlsZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICBwcm9maWxlTmFtZTogZGF0YS5wcm9maWxlTmFtZSB8fCBudWxsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gcmV2YWxpZGF0ZVBhdGgoJy9oaXN0b3J5Jyk7IC8vIFR5cGljYWxseSBoaXN0b3J5IHBhZ2UgbWlnaHQgbmVlZCByZWZyZXNoXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvZ2dpbmcgYWN0aXZpdHk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEFjdGl2aXR5RmlsdGVycyB7XHJcbiAgICBhY3Rpdml0eVR5cGU/OiBzdHJpbmc7XHJcbiAgICBtb2R1bGU/OiBzdHJpbmc7XHJcbiAgICBzZWFyY2g/OiBzdHJpbmc7XHJcbiAgICBkYXRlRnJvbT86IHN0cmluZztcclxuICAgIGRhdGVUbz86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5SGlzdG9yeUFjdGlvbihcclxuICAgIGxvY2F0aW9uSWQ6IHN0cmluZyxcclxuICAgIHVzZXJJZDogc3RyaW5nLFxyXG4gICAgcGFnZTogbnVtYmVyID0gMSxcclxuICAgIHBhZ2VTaXplOiBudW1iZXIgPSAyMCxcclxuICAgIGZpbHRlcnM/OiBBY3Rpdml0eUZpbHRlcnNcclxuKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHNraXAgPSAocGFnZSAtIDEpICogcGFnZVNpemU7XHJcblxyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgIHVzZXJJZFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmIChmaWx0ZXJzKSB7XHJcbiAgICAgICAgICAgIGlmIChmaWx0ZXJzLmFjdGl2aXR5VHlwZSAmJiBmaWx0ZXJzLmFjdGl2aXR5VHlwZSAhPT0gJ0FMTCcpIHtcclxuICAgICAgICAgICAgICAgIHdoZXJlLmFjdGl2aXR5VHlwZSA9IGZpbHRlcnMuYWN0aXZpdHlUeXBlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChmaWx0ZXJzLm1vZHVsZSAmJiBmaWx0ZXJzLm1vZHVsZSAhPT0gJ0FMTCcpIHtcclxuICAgICAgICAgICAgICAgIHdoZXJlLm1vZHVsZSA9IGZpbHRlcnMubW9kdWxlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChmaWx0ZXJzLnNlYXJjaCkge1xyXG4gICAgICAgICAgICAgICAgd2hlcmUuT1IgPSBbXHJcbiAgICAgICAgICAgICAgICAgICAgeyBlbnRpdHlOYW1lOiB7IGNvbnRhaW5zOiBmaWx0ZXJzLnNlYXJjaCwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgeyBkZXNjcmlwdGlvbjogeyBjb250YWluczogZmlsdGVycy5zZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9XHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChmaWx0ZXJzLmRhdGVGcm9tIHx8IGZpbHRlcnMuZGF0ZVRvKSB7XHJcbiAgICAgICAgICAgICAgICB3aGVyZS5jcmVhdGVkQXQgPSB7fTtcclxuICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJzLmRhdGVGcm9tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmUuY3JlYXRlZEF0Lmd0ZSA9IG5ldyBEYXRlKGZpbHRlcnMuZGF0ZUZyb20pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGZpbHRlcnMuZGF0ZVRvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9EYXRlID0gbmV3IERhdGUoZmlsdGVycy5kYXRlVG8pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRvRGF0ZS5zZXRIb3VycygyMywgNTksIDU5LCA5OTkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlLmNyZWF0ZWRBdC5sdGUgPSB0b0RhdGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IFthY3Rpdml0aWVzLCBjb3VudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgICAgIGRiLmFjdGl2aXR5SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgICAgIHNraXAsXHJcbiAgICAgICAgICAgICAgICB0YWtlOiBwYWdlU2l6ZSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgZGIuYWN0aXZpdHlIaXN0b3J5LmNvdW50KHsgd2hlcmUgfSlcclxuICAgICAgICBdKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgYWN0aXZpdGllczogYWN0aXZpdGllcy5tYXAoKGE6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgICAgICAuLi5hLFxyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksIC8vIE1hcCBiYWNrIHRvIHNoYXBlIGV4cGVjdGVkIGJ5IGhvb2tcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eV90eXBlOiBhLmFjdGl2aXR5VHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbl9pZDogYS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJfaWQ6IGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGVudGl0eV90eXBlOiBhLmVudGl0eVR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgZW50aXR5X2lkOiBhLmVudGl0eUlkLFxyXG4gICAgICAgICAgICAgICAgICAgIGVudGl0eV9uYW1lOiBhLmVudGl0eU5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZmlsZV9pZDogYS5wcm9maWxlSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZmlsZV9uYW1lOiBhLnByb2ZpbGVOYW1lXHJcbiAgICAgICAgICAgICAgICB9KSksXHJcbiAgICAgICAgICAgICAgICBjb3VudFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBhY3Rpdml0eSBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5SGlzdG9yeUJ5VHlwZUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIG1vZHVsZTogc3RyaW5nLCBhY3Rpdml0eVR5cGU6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCwgbW9kdWxlOiBtb2R1bGUgYXMgYW55LCBhY3Rpdml0eVR5cGU6IGFjdGl2aXR5VHlwZSBhcyBhbnkgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogcmVjb3Jkcy5tYXAoKGE6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIC4uLmEsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBwcm9maWxlTmFtZTogYS5wcm9maWxlTmFtZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGFjdGl2aXR5IGhpc3RvcnkgYnkgdHlwZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlLCBkYXRhOiBbXSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiaVNBbUJzQiw4TEFBQSJ9
}),
"[project]/src/app/actions/data:7dc706 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getProductsByIdsAction",
    ()=>$$RSC_SERVER_ACTION_2
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"60d2e6658abc20e397c389a36fe10b6b5461fb97b4":"getProductsByIdsAction"},"src/app/actions/products.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_2 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("60d2e6658abc20e397c389a36fe10b6b5461fb97b4", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getProductsByIdsAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vcHJvZHVjdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XHJcblxyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RGb3JtRGF0YSwgbWFwRGJQcm9kdWN0VG9Qcm9kdWN0LCBtYXBQcm9kdWN0VG9EYlByb2R1Y3QgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIFdlIGltcGxlbWVudCBzZXJ2ZXIgYWN0aW9ucyBmb3IgdGhlIHByb2R1Y3RzIGhlcmVcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0FjdGlvbih7XHJcbiAgdXNlcklkLFxyXG4gIGJ1c2luZXNzSWQsXHJcbiAgcGFnZSxcclxuICBwYWdlU2l6ZSxcclxuICBzZWFyY2gsXHJcbiAgY2F0ZWdvcnksXHJcbiAgc3RvY2tTdGF0dXMsXHJcbn06IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBidXNpbmVzc0lkOiBzdHJpbmc7XHJcbiAgcGFnZTogbnVtYmVyO1xyXG4gIHBhZ2VTaXplOiBudW1iZXI7XHJcbiAgc2VhcmNoPzogc3RyaW5nO1xyXG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gIHN0b2NrU3RhdHVzPzogJ2luU3RvY2snIHwgJ291dE9mU3RvY2snIHwgJ2xvd1N0b2NrJyB8ICdhbGwnO1xyXG59KSB7XHJcbiAgaWYgKCF1c2VySWQgfHwgIWJ1c2luZXNzSWQpIHJldHVybiB7IHByb2R1Y3RzOiBbXSwgY291bnQ6IDAgfTtcclxuXHJcbiAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuICBjb25zdCB0YWtlID0gcGFnZVNpemU7XHJcblxyXG4gIGxldCB3aGVyZUNsYXVzZTogYW55ID0ge1xyXG4gICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICB9O1xyXG5cclxuICBpZiAoc2VhcmNoKSB7XHJcbiAgICB3aGVyZUNsYXVzZS5PUiA9IFtcclxuICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IGRlc2NyaXB0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IHNrdTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIGlmIChjYXRlZ29yeSkge1xyXG4gICAgd2hlcmVDbGF1c2UuY2F0ZWdvcnkgPSB7IG5hbWU6IGNhdGVnb3J5IH07XHJcbiAgfVxyXG5cclxuICBpZiAoc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSAwO1xyXG4gIH0gZWxzZSBpZiAoc3RvY2tTdGF0dXMgPT09ICdpblN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgfSBlbHNlIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgLy8gSGFuZGxpbmcgbG93U3RvY2sgaXMgY29tcGxleCBiZWNhdXNlIG1pblN0b2NrIGlzIGNvbXBhcmVkIGxvY2FsbHkgb3IgdXNpbmcgZGlyZWN0IFNRTCBpbiBQcmlzbWFcclxuICAgIC8vIEZvciBub3csIHdlIHdpbGwgaGFuZGxlIGl0IHdpdGggUHJpc21hJ3MgcmF3IHF1ZXJ5IG9yIGJ5IGZpbHRlcmluZyBpbiBtZW1vcnkgaWYgbmVjZXNzYXJ5XHJcbiAgICAvLyBGb3J0dW5hdGVseSwgc2luY2UgUFJJU01BIDUuMCwgY29sdW1uIGNvbXBhcmlzb24gc3RpbGwgbmVlZHMgcmF3IHF1ZXJpZXMgb3Igd2UgY2FuIGZldGNoIGFuZCBmaWx0ZXIgaWYgc21hbGxcclxuICAgIC8vIEhlcmUgd2UnbGwgZmV0Y2ggdGhlbSBhbGwgaWYgbG93U3RvY2sgaXMgZW5hYmxlZCwgb3IgYWRkIGEgZ2VuZXJhdGVkIGNvbHVtbi4gXHJcbiAgICAvLyBXZSB3aWxsIGRvIGEgYmFzaWMgZmV0Y2ggYW5kIGZpbHRlciBsYXRlciBpZiBuZWVkZWQuXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Byb2R1Y3RzRGF0YSwgdG90YWxDb3VudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcclxuICAgICAgICBza2lwLFxyXG4gICAgICAgIHRha2UsXHJcbiAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnZGVzYycgfSwgeyBpZDogJ2Rlc2MnIH1dLFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgICAgc3VwcGxpZXI6IHRydWUsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgZGIucHJvZHVjdC5jb3VudCh7IHdoZXJlOiB3aGVyZUNsYXVzZSB9KVxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8gTWFwIHRoZSBQcmlzbWEgcHJvZHVjdCBtb2RlbCBiYWNrIHRvIHRoZSBhcHBsaWNhdGlvbidzIFByb2R1Y3QgdHlwZVxyXG4gICAgbGV0IGZvcm1hdHRlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiB7XHJcbiAgICAgIC8vIEFzc3VtaW5nIG1hcHBpbmcgZXhpc3RzLCB3ZSB3aWxsIG1hcCBpdFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgIG5hbWU6IHAubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICBjYXRlZ29yeTogcC5jYXRlZ29yeT8ubmFtZSB8fCAnVW5jYXRlZ29yaXplZCcsXHJcbiAgICAgICAgcXVhbnRpdHk6IHAuc3RvY2ssXHJcbiAgICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHAuc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgIHN1cHBsaWVyOiBwLnN1cHBsaWVyPy5uYW1lLFxyXG4gICAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICAgIGJhcmNvZGU6IHAuYmFyY29kZSxcclxuICAgICAgICBpdGVtTnVtYmVyOiBwLnNrdSB8fCAnJyxcclxuICAgICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgICBmb3JtYXR0ZWRQcm9kdWN0cyA9IGZvcm1hdHRlZFByb2R1Y3RzLmZpbHRlcigocDogYW55KSA9PiBwLnF1YW50aXR5ID4gMCAmJiBwLnF1YW50aXR5IDw9IHAubWluaW11bVN0b2NrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBwcm9kdWN0czogZm9ybWF0dGVkUHJvZHVjdHMgYXMgYW55W10sIGNvdW50OiB0b3RhbENvdW50IH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgcHJvZHVjdHM6IFtdLCBjb3VudDogMCB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIXVzZXJJZCB8fCAhYnVzaW5lc3NJZCkgcmV0dXJuIFtdO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvZHVjdHNEYXRhID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sIHsgaWQ6ICdkZXNjJyB9XSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgIHN1cHBsaWVyOiB0cnVlLFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogTnVtYmVyKHAuc3RvY2spLFxyXG4gICAgICBjb3N0UHJpY2U6IE51bWJlcihwLmNvc3RQcmljZSksXHJcbiAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHAuc2VsbGluZ1ByaWNlKSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IE51bWJlcihwLm1pblN0b2NrKSxcclxuICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgIH0pKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RzQnlJZHNBY3Rpb24oaWRzOiBzdHJpbmdbXSwgYnVzaW5lc3NJZD86IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0ge1xyXG4gICAgICBpZDogeyBpbjogaWRzIH1cclxuICAgIH07XHJcbiAgICBpZiAoYnVzaW5lc3NJZCkge1xyXG4gICAgICB3aGVyZS5icmFuY2hJZCA9IGJ1c2luZXNzSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcclxuICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHByb2R1Y3RzLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogcC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgc2VsbGluZ1ByaWNlOiBwLnNlbGxpbmdQcmljZSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQsXHJcbiAgICB9KSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGJ5IGlkczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgIC8vIDEuIEdlbmVyYXRlIG5leHQgU0tVL2l0ZW1OdW1iZXIgZm9yIHRoaXMgYnJhbmNoXHJcbiAgICAgIGNvbnN0IGxhc3RQcm9kdWN0ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kRmlyc3Qoe1xyXG4gICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBkYXRhLmJ1c2luZXNzSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiB7IHNrdTogJ2Rlc2MnIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7IHNrdTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbGV0IG5leHRTa3UgPSBcIlBST0QtMDAwMVwiO1xyXG4gICAgICBpZiAobGFzdFByb2R1Y3QgJiYgbGFzdFByb2R1Y3Quc2t1KSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudE51bWJlciA9IHBhcnNlSW50KGxhc3RQcm9kdWN0LnNrdS5yZXBsYWNlKFwiUFJPRC1cIiwgXCJcIikpIHx8IDA7XHJcbiAgICAgICAgbmV4dFNrdSA9IGBQUk9ELSR7KGN1cnJlbnROdW1iZXIgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJyl9YDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMi4gQ3JlYXRlIHRoZSBwcm9kdWN0XHJcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCB0eC5wcm9kdWN0LmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBicmFuY2hJZDogZGF0YS5idXNpbmVzc0lkLFxyXG4gICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IGRhdGEuY2F0ZWdvcnlJZCB8fCBudWxsLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogZGF0YS5zdXBwbGllcklkIHx8IG51bGwsXHJcbiAgICAgICAgICBza3U6IG5leHRTa3UsXHJcbiAgICAgICAgICBiYXJjb2RlOiBkYXRhLmJhcmNvZGUsXHJcbiAgICAgICAgICBpbWFnZTogZGF0YS5pbWFnZVVybCxcclxuICAgICAgICAgIGNvc3RQcmljZTogZGF0YS5jb3N0UHJpY2UgfHwgMCxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogZGF0YS5zZWxsaW5nUHJpY2UgfHwgMCxcclxuICAgICAgICAgIHN0b2NrOiBkYXRhLnF1YW50aXR5IHx8IDAsXHJcbiAgICAgICAgICBtaW5TdG9jazogZGF0YS5taW5pbXVtU3RvY2sgfHwgMCxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXHJcbiAgICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGluaXRpYWwgc3RvY2sgaGlzdG9yeSBpZiBxdWFudGl0eSA+IDBcclxuICAgICAgaWYgKGRhdGEucXVhbnRpdHkgPiAwKSB7XHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICB0eXBlOiAnQ1JFQVRFRCcsXHJcbiAgICAgICAgICAgIG9sZFN0b2NrOiAwLFxyXG4gICAgICAgICAgICBuZXdTdG9jazogZGF0YS5xdWFudGl0eSxcclxuICAgICAgICAgICAgcXVhbnRpdHlDaGFuZ2U6IGRhdGEucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHJlYXNvbjogYFske3Byb2R1Y3QubmFtZX1dIHwgSW5pdGlhbCBzdG9ja2AsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcHJvZHVjdDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcmVzdWx0LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICBjYXRlZ29yeTogcmVzdWx0LmNhdGVnb3J5Py5uYW1lIHx8ICdVbmNhdGVnb3JpemVkJyxcclxuICAgICAgcXVhbnRpdHk6IHJlc3VsdC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiByZXN1bHQuY29zdFByaWNlLFxyXG4gICAgICBzZWxsaW5nUHJpY2U6IHJlc3VsdC5zZWxsaW5nUHJpY2UsXHJcbiAgICAgIHN1cHBsaWVyOiByZXN1bHQuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiByZXN1bHQuaW1hZ2UsXHJcbiAgICAgIGJhcmNvZGU6IHJlc3VsdC5iYXJjb2RlLFxyXG4gICAgICBpdGVtTnVtYmVyOiByZXN1bHQuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHJlc3VsdC5taW5TdG9jayxcclxuICAgICAgY3JlYXRlZEF0OiByZXN1bHQuY3JlYXRlZEF0LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgLy8gMS4gR2V0IGN1cnJlbnQgcHJvZHVjdCBzdGF0ZVxyXG4gICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kVW5pcXVlKHtcclxuICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgIHNlbGVjdDogeyBzdG9jazogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgIC8vIDIuIFBlcmZvcm0gdXBkYXRlXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5wcm9kdWN0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IHVwZGF0ZXMuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkID8gdXBkYXRlcy5jYXRlZ29yeUlkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogdXBkYXRlcy5zdXBwbGllcklkICE9PSB1bmRlZmluZWQgPyB1cGRhdGVzLnN1cHBsaWVySWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBza3U6IHVwZGF0ZXMuaXRlbU51bWJlciB8fCB1cGRhdGVzLnNrdSxcclxuICAgICAgICAgIGJhcmNvZGU6IHVwZGF0ZXMuYmFyY29kZSxcclxuICAgICAgICAgIGltYWdlOiB1cGRhdGVzLmltYWdlVXJsLFxyXG4gICAgICAgICAgY29zdFByaWNlOiB1cGRhdGVzLmNvc3RQcmljZSxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogdXBkYXRlcy5zZWxsaW5nUHJpY2UsXHJcbiAgICAgICAgICBzdG9jazogdXBkYXRlcy5xdWFudGl0eSxcclxuICAgICAgICAgIG1pblN0b2NrOiB1cGRhdGVzLm1pbmltdW1TdG9jayxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGhpc3RvcnkgaWYgcXVhbnRpdHkgY2hhbmdlZFxyXG4gICAgICBpZiAodXBkYXRlcy5xdWFudGl0eSAhPT0gdW5kZWZpbmVkICYmIHVwZGF0ZXMucXVhbnRpdHkgIT09IGN1cnJlbnQuc3RvY2sgJiYgdXBkYXRlcy5jdXN0b21DaGFuZ2VSZWFzb24gIT09ICdza2lwLWhpc3RvcnknKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZVJlYXNvbiA9IHVwZGF0ZXMuY3VzdG9tQ2hhbmdlUmVhc29uO1xyXG4gICAgICAgIGlmICghY2hhbmdlUmVhc29uKSB7XHJcbiAgICAgICAgICBpZiAodXBkYXRlcy5pc0Zyb21TYWxlKSBjaGFuZ2VSZWFzb24gPSBcIlNhbGVcIjtcclxuICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZXMucXVhbnRpdHkgPiBjdXJyZW50LnN0b2NrKSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayBhZGRpdGlvblwiO1xyXG4gICAgICAgICAgZWxzZSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayByZWR1Y3Rpb25cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNuYXBzaG90dGVkUmVhc29uID0gYFske3VwZGF0ZWQubmFtZX1dIHwgJHtjaGFuZ2VSZWFzb259YDtcclxuXHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiB1cGRhdGVzLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiB1cGRhdGVkLmlkLFxyXG4gICAgICAgICAgICB0eXBlOiB1cGRhdGVzLmlzRnJvbVNhbGUgPyAnU0FMRScgOiAodXBkYXRlcy5xdWFudGl0eSA+IGN1cnJlbnQuc3RvY2sgPyAnUkVTVE9DSycgOiAnQURKVVNUTUVOVCcpLFxyXG4gICAgICAgICAgICBvbGRTdG9jazogY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgbmV3U3RvY2s6IHVwZGF0ZXMucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHF1YW50aXR5Q2hhbmdlOiB1cGRhdGVzLnF1YW50aXR5IC0gY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgcmVhc29uOiBzbmFwc2hvdHRlZFJlYXNvbixcclxuICAgICAgICAgICAgcmVmZXJlbmNlSWQ6IHVwZGF0ZXMucmVmZXJlbmNlSWQgfHwgbnVsbCxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3RBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5wcm9kdWN0LmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgIH0pO1xyXG4gICAgLy8gcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnkvcHJvZHVjdHMnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0c0J1bGtBY3Rpb24oXHJcbiAgdXBkYXRlczogQXJyYXk8eyBpZDogc3RyaW5nOyB1cGRhdGVkOiBQYXJ0aWFsPGFueT4gfT4sXHJcbiAgYnVzaW5lc3NJZDogc3RyaW5nXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBQcmlzbWEgdHJhbnNhY3Rpb24gZm9yIGJ1bGsgdXBkYXRlc1xyXG4gICAgY29uc3QgdXBkYXRlUHJvbWlzZXMgPSB1cGRhdGVzLm1hcCh1ID0+XHJcbiAgICAgIGRiLnByb2R1Y3QudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogdS5pZCB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQubmFtZSAmJiB7IG5hbWU6IHUudXBkYXRlZC5uYW1lIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmIHsgZGVzY3JpcHRpb246IHUudXBkYXRlZC5kZXNjcmlwdGlvbiB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkICYmIHsgY2F0ZWdvcnlJZDogdS51cGRhdGVkLmNhdGVnb3J5SWQgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLnN1cHBsaWVySWQgIT09IHVuZGVmaW5lZCAmJiB7IHN1cHBsaWVySWQ6IHUudXBkYXRlZC5zdXBwbGllcklkIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5za3UgIT09IHVuZGVmaW5lZCAmJiB7IHNrdTogdS51cGRhdGVkLnNrdSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuYmFyY29kZSAhPT0gdW5kZWZpbmVkICYmIHsgYmFyY29kZTogdS51cGRhdGVkLmJhcmNvZGUgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLmNvc3RQcmljZSAhPT0gdW5kZWZpbmVkICYmIHsgY29zdFByaWNlOiB1LnVwZGF0ZWQuY29zdFByaWNlIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5zZWxsaW5nUHJpY2UgIT09IHVuZGVmaW5lZCAmJiB7IHNlbGxpbmdQcmljZTogdS51cGRhdGVkLnNlbGxpbmdQcmljZSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQucXVhbnRpdHkgIT09IHVuZGVmaW5lZCAmJiB7IHN0b2NrOiB1LnVwZGF0ZWQucXVhbnRpdHkgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLm1pbmltdW1TdG9jayAhPT0gdW5kZWZpbmVkICYmIHsgbWluU3RvY2s6IHUudXBkYXRlZC5taW5pbXVtU3RvY2sgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBkYi4kdHJhbnNhY3Rpb24odXBkYXRlUHJvbWlzZXMpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBlcmZvcm1pbmcgYnVsayB1cGRhdGU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFBST0RVQ1QgQ0FURUdPUklFUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0Q2F0ZWdvcmllc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLmNhdGVnb3J5LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiBjYXRlZ29yaWVzLm1hcCgoYzogYW55KSA9PiAoe1xyXG4gICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICBjcmVhdGVkX2F0OiBjLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KSlcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9kdWN0Q2F0ZWdvcnlBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgZGIuY2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgIHVzZXJJZCxcclxuICAgICAgICBuYW1lXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yeSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhdGVnb3J5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3RDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5jYXRlZ29yeS51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBkYXRhOiB7IG5hbWUgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHJvZHVjdENhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gQ2hlY2sgaWYgYW55IHByb2R1Y3RzIGFyZSB1c2luZyB0aGlzIGNhdGVnb3J5XHJcbiAgICBjb25zdCB1c2FnZUNvdW50ID0gYXdhaXQgZGIucHJvZHVjdC5jb3VudCh7XHJcbiAgICAgIHdoZXJlOiB7IGNhdGVnb3J5SWQ6IGlkIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh1c2FnZUNvdW50ID4gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBjYXRlZ29yeTogaXQgaXMgYmVpbmcgdXNlZCBieSBvbmUgb3IgbW9yZSBwcm9kdWN0cy4nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZGIuY2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIC0tLSBQUk9EVUNUIFNUQVRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RTdGF0c0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIWJ1c2luZXNzSWQpIHJldHVybiB7IGNvc3RWYWx1ZTogMCwgbG93U3RvY2s6IDAsIG91dE9mU3RvY2s6IDAsIHN0b2NrVmFsdWU6IDAgfTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgIHN0b2NrOiB0cnVlLFxyXG4gICAgICAgIGNvc3RQcmljZTogdHJ1ZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb3N0VmFsdWUgPSAwO1xyXG4gICAgbGV0IGxvd1N0b2NrID0gMDtcclxuICAgIGxldCBvdXRPZlN0b2NrID0gMDtcclxuICAgIGxldCBzdG9ja1ZhbHVlID0gMDtcclxuXHJcbiAgICBwcm9kdWN0cy5mb3JFYWNoKChwOiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgcXR5ID0gTnVtYmVyKHAuc3RvY2spIHx8IDA7XHJcbiAgICAgIGNvbnN0IGNvc3QgPSBOdW1iZXIocC5jb3N0UHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IHNlbGxpbmcgPSBOdW1iZXIocC5zZWxsaW5nUHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IG1pblN0b2NrID0gTnVtYmVyKHAubWluU3RvY2spIHx8IDA7XHJcblxyXG4gICAgICBjb3N0VmFsdWUgKz0gY29zdCAqIHF0eTtcclxuICAgICAgc3RvY2tWYWx1ZSArPSBzZWxsaW5nICogcXR5O1xyXG5cclxuICAgICAgaWYgKHF0eSA9PT0gMCkge1xyXG4gICAgICAgIG91dE9mU3RvY2srKztcclxuICAgICAgfSBlbHNlIGlmIChxdHkgPiAwICYmIHF0eSA8PSBtaW5TdG9jaykge1xyXG4gICAgICAgIGxvd1N0b2NrKys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IGNvc3RWYWx1ZSwgbG93U3RvY2ssIG91dE9mU3RvY2ssIHN0b2NrVmFsdWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdCBzdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBjb3N0VmFsdWU6IDAsIGxvd1N0b2NrOiAwLCBvdXRPZlN0b2NrOiAwLCBzdG9ja1ZhbHVlOiAwIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBMT09LVVAgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbihjb2RlOiBzdHJpbmcsIGJyYW5jaElkOiBzdHJpbmcpIHtcclxuICBpZiAoIWNvZGUgfHwgIWJyYW5jaElkKSByZXR1cm4gbnVsbDtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbG93ZXJDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICBPUjogW1xyXG4gICAgICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBsb3dlckNvZGUsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgICAgeyBza3U6IHsgY29udGFpbnM6IGxvd2VyQ29kZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcm9kdWN0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBTQ0FOTkVSIChhbGwgcHJvZHVjdHMgZm9yIHNjYW5uZXIgcHJlbG9hZCkgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbihicmFuY2hJZDogc3RyaW5nKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBicmFuY2hJZCB9LFxyXG4gICAgICBzZWxlY3Q6IHtcclxuICAgICAgICBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYmFyY29kZTogdHJ1ZSwgc2t1OiB0cnVlLFxyXG4gICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSwgY29zdFByaWNlOiB0cnVlLCBzdG9jazogdHJ1ZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdHJ1ZSwgY2F0ZWdvcnlJZDogdHJ1ZSwgYnJhbmNoSWQ6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsIGltYWdlVXJsOiB0cnVlLCBjcmVhdGVkQXQ6IHRydWUsIHVwZGF0ZWRBdDogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb2R1Y3RzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFNBTEUgQ0FTSCBUUkFOU0FDVElPTiBJRCBVUERBVEUgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihzYWxlSWQ6IHN0cmluZywgY2FzaFRyYW5zYWN0aW9uSWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5zYWxlLnVwZGF0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkOiBzYWxlSWQgfSxcclxuICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignW3VwZGF0ZVNhbGVDYXNoVHJhbnNhY3Rpb25BY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIEZJTFRFUkVEIFBST0RVQ1RTIEZPUiBFWFBPUlQgKGFsbCBwYWdlcykgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyZWRQcm9kdWN0c0ZvckV4cG9ydEFjdGlvbihcclxuICBicmFuY2hJZDogc3RyaW5nLFxyXG4gIGZpbHRlcnM/OiB7IHNlYXJjaD86IHN0cmluZzsgY2F0ZWdvcnk/OiBzdHJpbmc7IHN0b2NrU3RhdHVzPzogc3RyaW5nIH1cclxuKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZCB9O1xyXG5cclxuICAgIGlmIChmaWx0ZXJzPy5zZWFyY2gpIHtcclxuICAgICAgY29uc3QgcyA9IGZpbHRlcnMuc2VhcmNoO1xyXG4gICAgICB3aGVyZS5PUiA9IFtcclxuICAgICAgICB7IG5hbWU6IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgc2t1OiB7IGNvbnRhaW5zOiBzLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycz8uc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgICB3aGVyZS5zdG9jayA9IDA7XHJcbiAgICB9IGVsc2UgaWYgKGZpbHRlcnM/LnN0b2NrU3RhdHVzID09PSAnaW5TdG9jaycpIHtcclxuICAgICAgd2hlcmUuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW2dldEZpbHRlcmVkUHJvZHVjdHNGb3JFeHBvcnRBY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJzU0ErSXNCLG1NQUFBIn0=
}),
"[project]/src/app/actions/data:f9bffa [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getSalesAction",
    ()=>$$RSC_SERVER_ACTION_0
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"7075bde107094bcee88803531f90399cdcae549f4b":"getSalesAction"},"src/app/actions/sales.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_0 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("7075bde107094bcee88803531f90399cdcae549f4b", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getSalesAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vc2FsZXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzZXJ2ZXInO1xyXG5cclxuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi8uLi8uLi9wcmlzbWEvZGInO1xyXG5pbXBvcnQgeyByZXZhbGlkYXRlUGF0aCB9IGZyb20gJ25leHQvY2FjaGUnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNhbGVzQWN0aW9uKGJ1c2luZXNzSWQ6IHN0cmluZywgc29ydE9yZGVyOiAnYXNjJyB8ICdkZXNjJyA9ICdkZXNjJywgcGFnZVNpemU/OiBudW1iZXIpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcXVlcnlPcHRpb25zOiBhbnkgPSB7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgb3JkZXJCeToge1xyXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBzb3J0T3JkZXIsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgICAgICAgIGNhc2hUcmFuc2FjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmIChwYWdlU2l6ZSAmJiBwYWdlU2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgcXVlcnlPcHRpb25zLnRha2UgPSBwYWdlU2l6ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNhbGVzID0gYXdhaXQgZGIuc2FsZS5maW5kTWFueShxdWVyeU9wdGlvbnMpO1xyXG5cclxuICAgICAgICAvLyBQcm92aWRlIGRlZmF1bHQgbWFwcGluZ3MgdG8gZXhpc3RpbmcgUmVhY3QgY29tcG9uZW50c1xyXG4gICAgICAgIHJldHVybiBzYWxlcy5tYXAoKGl0ZW06IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsXHJcbiAgICAgICAgICAgIHVzZXJfaWQ6IGl0ZW0udXNlcklkLFxyXG4gICAgICAgICAgICBsb2NhdGlvbl9pZDogaXRlbS5icmFuY2hJZCxcclxuICAgICAgICAgICAgcmVjZWlwdF9udW1iZXI6IGl0ZW0uc2FsZU51bWJlcixcclxuICAgICAgICAgICAgY3VzdG9tZXJfbmFtZTogaXRlbS5jdXN0b21lck5hbWUsXHJcbiAgICAgICAgICAgIGN1c3RvbWVyX2FkZHJlc3M6IGl0ZW0uY3VzdG9tZXJBZGRyZXNzLFxyXG4gICAgICAgICAgICBjdXN0b21lcl9jb250YWN0OiBpdGVtLmN1c3RvbWVyUGhvbmUsXHJcbiAgICAgICAgICAgIGN1c3RvbWVyX2lkOiBpdGVtLmN1c3RvbWVySWQsXHJcbiAgICAgICAgICAgIGl0ZW1zOiBpdGVtLml0ZW1zIGFzIGFueSwgLy8ganNvbmIgdHlwZVxyXG4gICAgICAgICAgICBwYXltZW50X3N0YXR1czogaXRlbS5wYXltZW50U3RhdHVzLFxyXG4gICAgICAgICAgICBwcm9maXQ6IDAsIC8vIFByb2ZpdCBub3Qgc3RvcmVkIGRpcmVjdGx5XHJcbiAgICAgICAgICAgIGRhdGU6IGl0ZW0uZGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICB0YXhfcmF0ZTogaXRlbS50YXhSYXRlID8gTnVtYmVyKGl0ZW0udGF4UmF0ZSkgOiAwLFxyXG4gICAgICAgICAgICBjcmVhdGVkX2F0OiBpdGVtLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiBpdGVtLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICBjYXNoX3RyYW5zYWN0aW9uX2lkOiBpdGVtLmNhc2hUcmFuc2FjdGlvbklkLFxyXG4gICAgICAgICAgICBhbW91bnRfcGFpZDogTnVtYmVyKGl0ZW0uYW1vdW50UGFpZCksXHJcbiAgICAgICAgICAgIGFtb3VudF9kdWU6IE51bWJlcihpdGVtLmJhbGFuY2UpLFxyXG4gICAgICAgICAgICBjYXRlZ29yeV9pZDogaXRlbS5jYXRlZ29yeUlkLFxyXG4gICAgICAgICAgICBub3RlczogaXRlbS5ub3Rlc1xyXG4gICAgICAgIH0pKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgc2FsZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVNhbGVBY3Rpb24oaWQ6IHN0cmluZywgYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHNhbGUgPSBhd2FpdCBkYi5zYWxlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBpbmNsdWRlOiB7IGNhc2hUcmFuc2FjdGlvbjogdHJ1ZSwgaW5zdGFsbG1lbnRQYXltZW50czogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghc2FsZSB8fCBzYWxlLmJyYW5jaElkICE9PSBidXNpbmVzc0lkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1NhbGUgbm90IGZvdW5kIG9yIHVuYXV0aG9yaXplZCcgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHgpID0+IHtcclxuICAgICAgICAgICAgLy8gRGVsZXRlIGluc3RhbGxtZW50c1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZGVsZXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBzYWxlSWQ6IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBEZWxldGUgYXNzb2NpYXRlZCBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgIGlmIChzYWxlLmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogc2FsZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gRGVsZXRlIHRoZSBzYWxlIGl0c2VsZlxyXG4gICAgICAgICAgICBhd2FpdCB0eC5zYWxlLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBzYWxlOiB7XHJcbiAgICAgICAgICAgICAgICByZWNlaXB0TnVtYmVyOiBzYWxlLnNhbGVOdW1iZXIsXHJcbiAgICAgICAgICAgICAgICBjdXN0b21lck5hbWU6IHNhbGUuY3VzdG9tZXJOYW1lLFxyXG4gICAgICAgICAgICAgICAgY3VzdG9tZXJBZGRyZXNzOiBzYWxlLmN1c3RvbWVyQWRkcmVzcyxcclxuICAgICAgICAgICAgICAgIGN1c3RvbWVyQ29udGFjdDogc2FsZS5jdXN0b21lclBob25lLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudFN0YXR1czogc2FsZS5wYXltZW50U3RhdHVzLFxyXG4gICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IHNhbGUuY2FzaFRyYW5zYWN0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogc2FsZS5pdGVtcyBhcyBhbnksXHJcbiAgICAgICAgICAgICAgICBhbW91bnRQYWlkOiBOdW1iZXIoc2FsZS5hbW91bnRQYWlkKSxcclxuICAgICAgICAgICAgICAgIGFtb3VudER1ZTogTnVtYmVyKHNhbGUuYmFsYW5jZSksXHJcbiAgICAgICAgICAgICAgICBwcm9maXQ6IDAsXHJcbiAgICAgICAgICAgICAgICB0YXhSYXRlOiBOdW1iZXIoc2FsZS50YXhSYXRlKSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiBzYWxlLm5vdGVzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHNhbGU6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIGRlbGV0ZSBzYWxlJyB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBzZXJ0U2FsZUFjdGlvbihzYWxlRGJEYXRhOiBhbnksIGlzVXBkYXRlOiBib29sZWFuLCB1cGRhdGVJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICAvLyBNYXAgUGF5bWVudFN0YXR1cyBpZiBuZWVkZWRcclxuICAgICAgICBsZXQgc3RhdHVzID0gc2FsZURiRGF0YS5wYXltZW50X3N0YXR1cztcclxuICAgICAgICBpZiAoc3RhdHVzID09PSAnTk9UIFBBSUQnKSBzdGF0dXMgPSAnVU5QQUlEJztcclxuICAgICAgICBlbHNlIGlmIChzdGF0dXMgPT09ICdJbnN0YWxsbWVudCBTYWxlJykgc3RhdHVzID0gJ0lOU1RBTExNRU5UJztcclxuICAgICAgICBlbHNlIGlmIChzdGF0dXMgPT09ICdQYWlkJykgc3RhdHVzID0gJ1BBSUQnO1xyXG4gICAgICAgIGVsc2UgaWYgKHN0YXR1cyA9PT0gJ1F1b3RlJykgc3RhdHVzID0gJ1FVT1RFJztcclxuXHJcbiAgICAgICAgY29uc3QgcHJpc21hRGF0YTogYW55ID0ge1xyXG4gICAgICAgICAgICB1c2VySWQ6IHNhbGVEYkRhdGEudXNlcl9pZCxcclxuICAgICAgICAgICAgYnJhbmNoSWQ6IHNhbGVEYkRhdGEubG9jYXRpb25faWQsXHJcbiAgICAgICAgICAgIHNhbGVOdW1iZXI6IHNhbGVEYkRhdGEucmVjZWlwdF9udW1iZXIsXHJcbiAgICAgICAgICAgIGN1c3RvbWVyTmFtZTogc2FsZURiRGF0YS5jdXN0b21lcl9uYW1lLFxyXG4gICAgICAgICAgICBjdXN0b21lckFkZHJlc3M6IHNhbGVEYkRhdGEuY3VzdG9tZXJfYWRkcmVzcyxcclxuICAgICAgICAgICAgY3VzdG9tZXJQaG9uZTogc2FsZURiRGF0YS5jdXN0b21lcl9jb250YWN0LFxyXG4gICAgICAgICAgICBjdXN0b21lcklkOiBzYWxlRGJEYXRhLmN1c3RvbWVyX2lkLFxyXG4gICAgICAgICAgICBpdGVtczogc2FsZURiRGF0YS5pdGVtcyxcclxuICAgICAgICAgICAgcGF5bWVudFN0YXR1czogc3RhdHVzLFxyXG4gICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZShzYWxlRGJEYXRhLmRhdGUpLFxyXG4gICAgICAgICAgICB0YXhSYXRlOiBzYWxlRGJEYXRhLnRheF9yYXRlLFxyXG4gICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogc2FsZURiRGF0YS5jYXNoX3RyYW5zYWN0aW9uX2lkLFxyXG4gICAgICAgICAgICBhbW91bnRQYWlkOiBzYWxlRGJEYXRhLmFtb3VudF9wYWlkLFxyXG4gICAgICAgICAgICBiYWxhbmNlOiBzYWxlRGJEYXRhLmFtb3VudF9kdWUsXHJcbiAgICAgICAgICAgIGNhdGVnb3J5SWQ6IHNhbGVEYkRhdGEuY2F0ZWdvcnlfaWQsXHJcbiAgICAgICAgICAgIG5vdGVzOiBzYWxlRGJEYXRhLm5vdGVzLFxyXG4gICAgICAgICAgICBzdWJ0b3RhbDogMCwgLy8gUGxhY2Vob2xkZXJcclxuICAgICAgICAgICAgdG90YWw6IDAsICAgICAvLyBQbGFjZWhvbGRlclxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmIChpc1VwZGF0ZSAmJiB1cGRhdGVJZCkge1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgZGIuc2FsZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHVwZGF0ZUlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiBwcmlzbWFEYXRhXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB1cGRhdGVkIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgY3JlYXRlZCA9IGF3YWl0IGRiLnNhbGUuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHByaXNtYURhdGFcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNyZWF0ZWQgfTtcclxuICAgICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBzZXJ0aW5nIHNhbGU6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIHByZXNlcnZlIHNhbGUnIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVSZWNlaXB0QWN0aW9uKHNhbGVEYXRhOiBhbnksIGJ1c2luZXNzSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgbGV0IHN0YXR1cyA9IHNhbGVEYXRhLnBheW1lbnRTdGF0dXM7XHJcbiAgICAgICAgaWYgKHN0YXR1cyA9PT0gJ05PVCBQQUlEJykgc3RhdHVzID0gJ1VOUEFJRCc7XHJcbiAgICAgICAgZWxzZSBpZiAoc3RhdHVzID09PSAnSW5zdGFsbG1lbnQgU2FsZScpIHN0YXR1cyA9ICdJTlNUQUxMTUVOVCc7XHJcbiAgICAgICAgZWxzZSBpZiAoc3RhdHVzID09PSAnUGFpZCcpIHN0YXR1cyA9ICdQQUlEJztcclxuICAgICAgICBlbHNlIGlmIChzdGF0dXMgPT09ICdRdW90ZScpIHN0YXR1cyA9ICdRVU9URSc7XHJcblxyXG4gICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBhd2FpdCBkYi5zYWxlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgICAgICAgICAgICBzYWxlTnVtYmVyOiBzYWxlRGF0YS5yZWNlaXB0TnVtYmVyLFxyXG4gICAgICAgICAgICAgICAgY3VzdG9tZXJOYW1lOiBzYWxlRGF0YS5jdXN0b21lck5hbWUsXHJcbiAgICAgICAgICAgICAgICBjdXN0b21lcklkOiBzYWxlRGF0YS5jdXN0b21lcklkLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogbmV3IERhdGUoc2FsZURhdGEuZGF0ZSksXHJcbiAgICAgICAgICAgICAgICBpdGVtczogc2FsZURhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50U3RhdHVzOiBzdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBhbW91bnRQYWlkOiBzYWxlRGF0YS5hbW91bnRQYWlkIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlOiBzYWxlRGF0YS5hbW91bnREdWUgfHwgMCxcclxuICAgICAgICAgICAgICAgIGNhc2hBY2NvdW50SWQ6IHNhbGVEYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICBub3Rlczogc2FsZURhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdWJ0b3RhbDogMCxcclxuICAgICAgICAgICAgICAgIHRvdGFsOiAwLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvc2FsZXMnKTtcclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2N1c3RvbWVycycpO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjcmVhdGVkIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcmVjZWlwdDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIHx8ICdGYWlsZWQgdG8gY3JlYXRlIHJlY2VpcHQnIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBTQUxFUyBDQVRFR09SSUVTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNhbGVzQ2F0ZWdvcmllc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLnNhbGVDYXRlZ29yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IHsgbmFtZTogJ2FzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yaWVzIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgc2FsZXMgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVTYWxlc0NhdGVnb3J5QWN0aW9uKGJ1c2luZXNzSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgaXNEZWZhdWx0OiBib29sZWFuID0gZmFsc2UpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5zYWxlQ2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgICAgICAgICAgICB1c2VySWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNfZGVmYXVsdDogaXNEZWZhdWx0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9zYWxlcycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc2FsZXMgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZXNDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5zYWxlQ2F0ZWdvcnkudXBkYXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgZGF0YTogeyBuYW1lIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9zYWxlcycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc2FsZXMgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlU2FsZXNDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnNhbGVDYXRlZ29yeS5kZWxldGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvc2FsZXMnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgc2FsZXMgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ1VTVE9NRVIgTE9PS1VQIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1c3RvbWVyQnlOYW1lQWN0aW9uKGJyYW5jaElkOiBzdHJpbmcsIG5hbWU6IHN0cmluZykge1xyXG4gICAgaWYgKCFicmFuY2hJZCB8fCAhbmFtZSkgcmV0dXJuIG51bGw7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGN1c3RvbWVyID0gYXdhaXQgZGIuY3VzdG9tZXIuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogeyBjb250YWluczogbmFtZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGN1c3RvbWVyO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb29raW5nIHVwIGN1c3RvbWVyIGJ5IG5hbWU6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUN1c3RvbWVyQWN0aW9uKHNhbGVJZDogc3RyaW5nLCBjdXN0b21lcklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuc2FsZS51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogc2FsZUlkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3VzdG9tZXJJZCB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHNhbGUgY3VzdG9tZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU0FMRVMgR09BTFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2FsZXNHb2FsQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBicmFuY2hJZDogc3RyaW5nLCBtb250aDogbnVtYmVyLCB5ZWFyOiBudW1iZXIpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZ29hbCA9IGF3YWl0IGRiLnNhbGVzR29hbC5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyB1c2VySWQsIGJyYW5jaElkLCBwZXJpb2Q6IGAke3llYXJ9LSR7U3RyaW5nKG1vbnRoKS5wYWRTdGFydCgyLCAnMCcpfWAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGdvYWwgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzYWxlcyBnb2FsOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFNhbGVzR29hbEFjdGlvbihcclxuICAgIHVzZXJJZDogc3RyaW5nLFxyXG4gICAgYnJhbmNoSWQ6IHN0cmluZyxcclxuICAgIG1vbnRoOiBudW1iZXIsXHJcbiAgICB5ZWFyOiBudW1iZXIsXHJcbiAgICBhbW91bnQ6IG51bWJlcixcclxuICAgIGV4aXN0aW5nR29hbElkPzogc3RyaW5nIHwgbnVsbFxyXG4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcGVyaW9kID0gYCR7eWVhcn0tJHtTdHJpbmcobW9udGgpLnBhZFN0YXJ0KDIsICcwJyl9YDtcclxuXHJcbiAgICAgICAgaWYgKGV4aXN0aW5nR29hbElkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCBkYi5zYWxlc0dvYWwudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleGlzdGluZ0dvYWxJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyB0YXJnZXQ6IGFtb3VudCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXZhbGlkYXRlUGF0aCgnLycpO1xyXG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB1cGRhdGVkIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgY3JlYXRlZCA9IGF3YWl0IGRiLnNhbGVzR29hbC5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcmlvZCxcclxuICAgICAgICAgICAgICAgICAgICBzdGFydERhdGU6IG5ldyBEYXRlKHllYXIsIG1vbnRoIC0gMSwgMSksXHJcbiAgICAgICAgICAgICAgICAgICAgZW5kRGF0ZTogbmV3IERhdGUoeWVhciwgbW9udGgsIDApLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogJ2FjdGl2ZSdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldmFsaWRhdGVQYXRoKCcvJyk7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNyZWF0ZWQgfTtcclxuICAgICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBzZXJ0aW5nIHNhbGVzIGdvYWw6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGVyaW9kU2FsZXNBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZywgc3RhcnREYXRlOiBEYXRlLCBlbmREYXRlOiBEYXRlKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHNhbGVzID0gYXdhaXQgZGIuc2FsZS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHsgZ3RlOiBzdGFydERhdGUsIGx0ZTogZW5kRGF0ZSB9LFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudFN0YXR1czogeyBub3Q6ICdRVU9URScgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgYW1vdW50UGFpZDogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHRvdGFsID0gc2FsZXMucmVkdWNlKChzdW0sIHNhbGUpID0+IHN1bSArIE51bWJlcihzYWxlLmFtb3VudFBhaWQgfHwgMCksIDApO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRvdGFsIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcGVyaW9kIHNhbGVzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjJSQUtzQiwyTEFBQSJ9
}),
"[project]/src/app/actions/data:4ed61d [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "deleteSaleAction",
    ()=>$$RSC_SERVER_ACTION_1
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"6024f56e078e458896c223d462d138a5f485546baf":"deleteSaleAction"},"src/app/actions/sales.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_1 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("6024f56e078e458896c223d462d138a5f485546baf", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "deleteSaleAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vc2FsZXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzZXJ2ZXInO1xyXG5cclxuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi8uLi8uLi9wcmlzbWEvZGInO1xyXG5pbXBvcnQgeyByZXZhbGlkYXRlUGF0aCB9IGZyb20gJ25leHQvY2FjaGUnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNhbGVzQWN0aW9uKGJ1c2luZXNzSWQ6IHN0cmluZywgc29ydE9yZGVyOiAnYXNjJyB8ICdkZXNjJyA9ICdkZXNjJywgcGFnZVNpemU/OiBudW1iZXIpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcXVlcnlPcHRpb25zOiBhbnkgPSB7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgb3JkZXJCeToge1xyXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBzb3J0T3JkZXIsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgICAgICAgIGNhc2hUcmFuc2FjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmIChwYWdlU2l6ZSAmJiBwYWdlU2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgcXVlcnlPcHRpb25zLnRha2UgPSBwYWdlU2l6ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNhbGVzID0gYXdhaXQgZGIuc2FsZS5maW5kTWFueShxdWVyeU9wdGlvbnMpO1xyXG5cclxuICAgICAgICAvLyBQcm92aWRlIGRlZmF1bHQgbWFwcGluZ3MgdG8gZXhpc3RpbmcgUmVhY3QgY29tcG9uZW50c1xyXG4gICAgICAgIHJldHVybiBzYWxlcy5tYXAoKGl0ZW06IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsXHJcbiAgICAgICAgICAgIHVzZXJfaWQ6IGl0ZW0udXNlcklkLFxyXG4gICAgICAgICAgICBsb2NhdGlvbl9pZDogaXRlbS5icmFuY2hJZCxcclxuICAgICAgICAgICAgcmVjZWlwdF9udW1iZXI6IGl0ZW0uc2FsZU51bWJlcixcclxuICAgICAgICAgICAgY3VzdG9tZXJfbmFtZTogaXRlbS5jdXN0b21lck5hbWUsXHJcbiAgICAgICAgICAgIGN1c3RvbWVyX2FkZHJlc3M6IGl0ZW0uY3VzdG9tZXJBZGRyZXNzLFxyXG4gICAgICAgICAgICBjdXN0b21lcl9jb250YWN0OiBpdGVtLmN1c3RvbWVyUGhvbmUsXHJcbiAgICAgICAgICAgIGN1c3RvbWVyX2lkOiBpdGVtLmN1c3RvbWVySWQsXHJcbiAgICAgICAgICAgIGl0ZW1zOiBpdGVtLml0ZW1zIGFzIGFueSwgLy8ganNvbmIgdHlwZVxyXG4gICAgICAgICAgICBwYXltZW50X3N0YXR1czogaXRlbS5wYXltZW50U3RhdHVzLFxyXG4gICAgICAgICAgICBwcm9maXQ6IDAsIC8vIFByb2ZpdCBub3Qgc3RvcmVkIGRpcmVjdGx5XHJcbiAgICAgICAgICAgIGRhdGU6IGl0ZW0uZGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICB0YXhfcmF0ZTogaXRlbS50YXhSYXRlID8gTnVtYmVyKGl0ZW0udGF4UmF0ZSkgOiAwLFxyXG4gICAgICAgICAgICBjcmVhdGVkX2F0OiBpdGVtLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiBpdGVtLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICBjYXNoX3RyYW5zYWN0aW9uX2lkOiBpdGVtLmNhc2hUcmFuc2FjdGlvbklkLFxyXG4gICAgICAgICAgICBhbW91bnRfcGFpZDogTnVtYmVyKGl0ZW0uYW1vdW50UGFpZCksXHJcbiAgICAgICAgICAgIGFtb3VudF9kdWU6IE51bWJlcihpdGVtLmJhbGFuY2UpLFxyXG4gICAgICAgICAgICBjYXRlZ29yeV9pZDogaXRlbS5jYXRlZ29yeUlkLFxyXG4gICAgICAgICAgICBub3RlczogaXRlbS5ub3Rlc1xyXG4gICAgICAgIH0pKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgc2FsZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVNhbGVBY3Rpb24oaWQ6IHN0cmluZywgYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHNhbGUgPSBhd2FpdCBkYi5zYWxlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBpbmNsdWRlOiB7IGNhc2hUcmFuc2FjdGlvbjogdHJ1ZSwgaW5zdGFsbG1lbnRQYXltZW50czogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghc2FsZSB8fCBzYWxlLmJyYW5jaElkICE9PSBidXNpbmVzc0lkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1NhbGUgbm90IGZvdW5kIG9yIHVuYXV0aG9yaXplZCcgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHgpID0+IHtcclxuICAgICAgICAgICAgLy8gRGVsZXRlIGluc3RhbGxtZW50c1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZGVsZXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBzYWxlSWQ6IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBEZWxldGUgYXNzb2NpYXRlZCBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgIGlmIChzYWxlLmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogc2FsZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gRGVsZXRlIHRoZSBzYWxlIGl0c2VsZlxyXG4gICAgICAgICAgICBhd2FpdCB0eC5zYWxlLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBzYWxlOiB7XHJcbiAgICAgICAgICAgICAgICByZWNlaXB0TnVtYmVyOiBzYWxlLnNhbGVOdW1iZXIsXHJcbiAgICAgICAgICAgICAgICBjdXN0b21lck5hbWU6IHNhbGUuY3VzdG9tZXJOYW1lLFxyXG4gICAgICAgICAgICAgICAgY3VzdG9tZXJBZGRyZXNzOiBzYWxlLmN1c3RvbWVyQWRkcmVzcyxcclxuICAgICAgICAgICAgICAgIGN1c3RvbWVyQ29udGFjdDogc2FsZS5jdXN0b21lclBob25lLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudFN0YXR1czogc2FsZS5wYXltZW50U3RhdHVzLFxyXG4gICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IHNhbGUuY2FzaFRyYW5zYWN0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogc2FsZS5pdGVtcyBhcyBhbnksXHJcbiAgICAgICAgICAgICAgICBhbW91bnRQYWlkOiBOdW1iZXIoc2FsZS5hbW91bnRQYWlkKSxcclxuICAgICAgICAgICAgICAgIGFtb3VudER1ZTogTnVtYmVyKHNhbGUuYmFsYW5jZSksXHJcbiAgICAgICAgICAgICAgICBwcm9maXQ6IDAsXHJcbiAgICAgICAgICAgICAgICB0YXhSYXRlOiBOdW1iZXIoc2FsZS50YXhSYXRlKSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiBzYWxlLm5vdGVzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHNhbGU6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIGRlbGV0ZSBzYWxlJyB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBzZXJ0U2FsZUFjdGlvbihzYWxlRGJEYXRhOiBhbnksIGlzVXBkYXRlOiBib29sZWFuLCB1cGRhdGVJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICAvLyBNYXAgUGF5bWVudFN0YXR1cyBpZiBuZWVkZWRcclxuICAgICAgICBsZXQgc3RhdHVzID0gc2FsZURiRGF0YS5wYXltZW50X3N0YXR1cztcclxuICAgICAgICBpZiAoc3RhdHVzID09PSAnTk9UIFBBSUQnKSBzdGF0dXMgPSAnVU5QQUlEJztcclxuICAgICAgICBlbHNlIGlmIChzdGF0dXMgPT09ICdJbnN0YWxsbWVudCBTYWxlJykgc3RhdHVzID0gJ0lOU1RBTExNRU5UJztcclxuICAgICAgICBlbHNlIGlmIChzdGF0dXMgPT09ICdQYWlkJykgc3RhdHVzID0gJ1BBSUQnO1xyXG4gICAgICAgIGVsc2UgaWYgKHN0YXR1cyA9PT0gJ1F1b3RlJykgc3RhdHVzID0gJ1FVT1RFJztcclxuXHJcbiAgICAgICAgY29uc3QgcHJpc21hRGF0YTogYW55ID0ge1xyXG4gICAgICAgICAgICB1c2VySWQ6IHNhbGVEYkRhdGEudXNlcl9pZCxcclxuICAgICAgICAgICAgYnJhbmNoSWQ6IHNhbGVEYkRhdGEubG9jYXRpb25faWQsXHJcbiAgICAgICAgICAgIHNhbGVOdW1iZXI6IHNhbGVEYkRhdGEucmVjZWlwdF9udW1iZXIsXHJcbiAgICAgICAgICAgIGN1c3RvbWVyTmFtZTogc2FsZURiRGF0YS5jdXN0b21lcl9uYW1lLFxyXG4gICAgICAgICAgICBjdXN0b21lckFkZHJlc3M6IHNhbGVEYkRhdGEuY3VzdG9tZXJfYWRkcmVzcyxcclxuICAgICAgICAgICAgY3VzdG9tZXJQaG9uZTogc2FsZURiRGF0YS5jdXN0b21lcl9jb250YWN0LFxyXG4gICAgICAgICAgICBjdXN0b21lcklkOiBzYWxlRGJEYXRhLmN1c3RvbWVyX2lkLFxyXG4gICAgICAgICAgICBpdGVtczogc2FsZURiRGF0YS5pdGVtcyxcclxuICAgICAgICAgICAgcGF5bWVudFN0YXR1czogc3RhdHVzLFxyXG4gICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZShzYWxlRGJEYXRhLmRhdGUpLFxyXG4gICAgICAgICAgICB0YXhSYXRlOiBzYWxlRGJEYXRhLnRheF9yYXRlLFxyXG4gICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogc2FsZURiRGF0YS5jYXNoX3RyYW5zYWN0aW9uX2lkLFxyXG4gICAgICAgICAgICBhbW91bnRQYWlkOiBzYWxlRGJEYXRhLmFtb3VudF9wYWlkLFxyXG4gICAgICAgICAgICBiYWxhbmNlOiBzYWxlRGJEYXRhLmFtb3VudF9kdWUsXHJcbiAgICAgICAgICAgIGNhdGVnb3J5SWQ6IHNhbGVEYkRhdGEuY2F0ZWdvcnlfaWQsXHJcbiAgICAgICAgICAgIG5vdGVzOiBzYWxlRGJEYXRhLm5vdGVzLFxyXG4gICAgICAgICAgICBzdWJ0b3RhbDogMCwgLy8gUGxhY2Vob2xkZXJcclxuICAgICAgICAgICAgdG90YWw6IDAsICAgICAvLyBQbGFjZWhvbGRlclxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmIChpc1VwZGF0ZSAmJiB1cGRhdGVJZCkge1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgZGIuc2FsZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHVwZGF0ZUlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiBwcmlzbWFEYXRhXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB1cGRhdGVkIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgY3JlYXRlZCA9IGF3YWl0IGRiLnNhbGUuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHByaXNtYURhdGFcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNyZWF0ZWQgfTtcclxuICAgICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBzZXJ0aW5nIHNhbGU6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIHByZXNlcnZlIHNhbGUnIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVSZWNlaXB0QWN0aW9uKHNhbGVEYXRhOiBhbnksIGJ1c2luZXNzSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgbGV0IHN0YXR1cyA9IHNhbGVEYXRhLnBheW1lbnRTdGF0dXM7XHJcbiAgICAgICAgaWYgKHN0YXR1cyA9PT0gJ05PVCBQQUlEJykgc3RhdHVzID0gJ1VOUEFJRCc7XHJcbiAgICAgICAgZWxzZSBpZiAoc3RhdHVzID09PSAnSW5zdGFsbG1lbnQgU2FsZScpIHN0YXR1cyA9ICdJTlNUQUxMTUVOVCc7XHJcbiAgICAgICAgZWxzZSBpZiAoc3RhdHVzID09PSAnUGFpZCcpIHN0YXR1cyA9ICdQQUlEJztcclxuICAgICAgICBlbHNlIGlmIChzdGF0dXMgPT09ICdRdW90ZScpIHN0YXR1cyA9ICdRVU9URSc7XHJcblxyXG4gICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBhd2FpdCBkYi5zYWxlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgICAgICAgICAgICBzYWxlTnVtYmVyOiBzYWxlRGF0YS5yZWNlaXB0TnVtYmVyLFxyXG4gICAgICAgICAgICAgICAgY3VzdG9tZXJOYW1lOiBzYWxlRGF0YS5jdXN0b21lck5hbWUsXHJcbiAgICAgICAgICAgICAgICBjdXN0b21lcklkOiBzYWxlRGF0YS5jdXN0b21lcklkLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogbmV3IERhdGUoc2FsZURhdGEuZGF0ZSksXHJcbiAgICAgICAgICAgICAgICBpdGVtczogc2FsZURhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50U3RhdHVzOiBzdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBhbW91bnRQYWlkOiBzYWxlRGF0YS5hbW91bnRQYWlkIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlOiBzYWxlRGF0YS5hbW91bnREdWUgfHwgMCxcclxuICAgICAgICAgICAgICAgIGNhc2hBY2NvdW50SWQ6IHNhbGVEYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICBub3Rlczogc2FsZURhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdWJ0b3RhbDogMCxcclxuICAgICAgICAgICAgICAgIHRvdGFsOiAwLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvc2FsZXMnKTtcclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2N1c3RvbWVycycpO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjcmVhdGVkIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcmVjZWlwdDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIHx8ICdGYWlsZWQgdG8gY3JlYXRlIHJlY2VpcHQnIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBTQUxFUyBDQVRFR09SSUVTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNhbGVzQ2F0ZWdvcmllc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLnNhbGVDYXRlZ29yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IHsgbmFtZTogJ2FzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yaWVzIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgc2FsZXMgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVTYWxlc0NhdGVnb3J5QWN0aW9uKGJ1c2luZXNzSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgaXNEZWZhdWx0OiBib29sZWFuID0gZmFsc2UpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5zYWxlQ2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgICAgICAgICAgICB1c2VySWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNfZGVmYXVsdDogaXNEZWZhdWx0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9zYWxlcycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc2FsZXMgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZXNDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5zYWxlQ2F0ZWdvcnkudXBkYXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgZGF0YTogeyBuYW1lIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9zYWxlcycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc2FsZXMgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlU2FsZXNDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnNhbGVDYXRlZ29yeS5kZWxldGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvc2FsZXMnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgc2FsZXMgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ1VTVE9NRVIgTE9PS1VQIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1c3RvbWVyQnlOYW1lQWN0aW9uKGJyYW5jaElkOiBzdHJpbmcsIG5hbWU6IHN0cmluZykge1xyXG4gICAgaWYgKCFicmFuY2hJZCB8fCAhbmFtZSkgcmV0dXJuIG51bGw7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGN1c3RvbWVyID0gYXdhaXQgZGIuY3VzdG9tZXIuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogeyBjb250YWluczogbmFtZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGN1c3RvbWVyO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb29raW5nIHVwIGN1c3RvbWVyIGJ5IG5hbWU6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUN1c3RvbWVyQWN0aW9uKHNhbGVJZDogc3RyaW5nLCBjdXN0b21lcklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuc2FsZS51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogc2FsZUlkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3VzdG9tZXJJZCB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHNhbGUgY3VzdG9tZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU0FMRVMgR09BTFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2FsZXNHb2FsQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBicmFuY2hJZDogc3RyaW5nLCBtb250aDogbnVtYmVyLCB5ZWFyOiBudW1iZXIpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZ29hbCA9IGF3YWl0IGRiLnNhbGVzR29hbC5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyB1c2VySWQsIGJyYW5jaElkLCBwZXJpb2Q6IGAke3llYXJ9LSR7U3RyaW5nKG1vbnRoKS5wYWRTdGFydCgyLCAnMCcpfWAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGdvYWwgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzYWxlcyBnb2FsOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFNhbGVzR29hbEFjdGlvbihcclxuICAgIHVzZXJJZDogc3RyaW5nLFxyXG4gICAgYnJhbmNoSWQ6IHN0cmluZyxcclxuICAgIG1vbnRoOiBudW1iZXIsXHJcbiAgICB5ZWFyOiBudW1iZXIsXHJcbiAgICBhbW91bnQ6IG51bWJlcixcclxuICAgIGV4aXN0aW5nR29hbElkPzogc3RyaW5nIHwgbnVsbFxyXG4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcGVyaW9kID0gYCR7eWVhcn0tJHtTdHJpbmcobW9udGgpLnBhZFN0YXJ0KDIsICcwJyl9YDtcclxuXHJcbiAgICAgICAgaWYgKGV4aXN0aW5nR29hbElkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCBkYi5zYWxlc0dvYWwudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleGlzdGluZ0dvYWxJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyB0YXJnZXQ6IGFtb3VudCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXZhbGlkYXRlUGF0aCgnLycpO1xyXG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB1cGRhdGVkIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgY3JlYXRlZCA9IGF3YWl0IGRiLnNhbGVzR29hbC5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcmlvZCxcclxuICAgICAgICAgICAgICAgICAgICBzdGFydERhdGU6IG5ldyBEYXRlKHllYXIsIG1vbnRoIC0gMSwgMSksXHJcbiAgICAgICAgICAgICAgICAgICAgZW5kRGF0ZTogbmV3IERhdGUoeWVhciwgbW9udGgsIDApLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogJ2FjdGl2ZSdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldmFsaWRhdGVQYXRoKCcvJyk7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNyZWF0ZWQgfTtcclxuICAgICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBzZXJ0aW5nIHNhbGVzIGdvYWw6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGVyaW9kU2FsZXNBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZywgc3RhcnREYXRlOiBEYXRlLCBlbmREYXRlOiBEYXRlKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHNhbGVzID0gYXdhaXQgZGIuc2FsZS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHsgZ3RlOiBzdGFydERhdGUsIGx0ZTogZW5kRGF0ZSB9LFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudFN0YXR1czogeyBub3Q6ICdRVU9URScgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgYW1vdW50UGFpZDogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHRvdGFsID0gc2FsZXMucmVkdWNlKChzdW0sIHNhbGUpID0+IHN1bSArIE51bWJlcihzYWxlLmFtb3VudFBhaWQgfHwgMCksIDApO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRvdGFsIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcGVyaW9kIHNhbGVzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjZSQXNEc0IsNkxBQUEifQ==
}),
"[project]/src/app/actions/data:47c6c6 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getInstallmentPaymentsAction",
    ()=>$$RSC_SERVER_ACTION_4
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"409fc128a9613fdf42306f06ed612bc6570ab58cd3":"getInstallmentPaymentsAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_4 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("409fc128a9613fdf42306f06ed612bc6570ab58cd3", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getInstallmentPaymentsAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IGRhdGEucGVyc29uSW5DaGFyZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogbGlua1RvQ2FzaCAmJiBkYXRhLmNhc2hBY2NvdW50SWQgPyBkYXRhLmNhc2hBY2NvdW50SWQgOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gMi4gSWYgbGlua2luZyB0byBjYXNoLCBjcmVhdGUgYSBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgIGlmIChsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHtkYXRhLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiBkYXRhLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleHBlbnNlIHdpdGggdHJhbnNhY3Rpb24gcmVmZXJlbmNlXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4cGVuc2UuaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBleHBlbnNlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBleHBlbnNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEV4cGVuc2VzQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBleHBlbnNlcyA9IGF3YWl0IGRiLmV4cGVuc2UuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBjdXJyZW50RXhwZW5zZS5icmFuY2hJZCB8fCBjdXJyZW50RXhwZW5zZS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCB8fCBjdXJyZW50RXhwZW5zZS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNob3VsZExpbmtUb0Nhc2ggJiYgd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgY2FzaCB0cmFuc2FjdGlvblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGN1cnJlbnRFeHBlbnNlLmNhc2hUcmFuc2FjdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCB8fCBjdXJyZW50RXhwZW5zZS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiB1cGRhdGVzLmNhdGVnb3J5IHx8IGN1cnJlbnRFeHBlbnNlLmNhdGVnb3J5IHx8ICdFeHBlbnNlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGBFeHBlbnNlOiAke3VwZGF0ZXMuZGVzY3JpcHRpb24gfHwgY3VycmVudEV4cGVuc2UuZGVzY3JpcHRpb259YCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IHVwZGF0ZXMucGVyc29uSW5DaGFyZ2UgfHwgY3VycmVudEV4cGVuc2UucGVyc29uSW5DaGFyZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5kYXRlIHx8IGN1cnJlbnRFeHBlbnNlLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IHVwZGF0ZXMucGF5bWVudE1ldGhvZCB8fCBjdXJyZW50RXhwZW5zZS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UgfHwgY3VycmVudEV4cGVuc2UucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICghc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlZEV4cGVuc2U7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBleHBlbnNlID0gYXdhaXQgdHguZXhwZW5zZS5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChleHBlbnNlPy5jYXNoVHJhbnNhY3Rpb25JZCkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBleHBlbnNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIElOU1RBTExNRU5UIFBBWU1FTlRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEluc3RhbGxtZW50UGF5bWVudHNBY3Rpb24oc2FsZUlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcGF5bWVudHMgPSBhd2FpdCBkYi5pbnN0YWxsbWVudFBheW1lbnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBzYWxlSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBwYXltZW50RGF0ZTogJ2Rlc2MnIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogcGF5bWVudHMubWFwKChwOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogcC5pZCxcclxuICAgICAgICAgICAgICAgIHNhbGVJZDogcC5zYWxlSWQsXHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHAudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiBOdW1iZXIocC5hbW91bnQpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHAucGF5bWVudERhdGUudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiBwLm5vdGVzLFxyXG4gICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IHAuY2FzaFRyYW5zYWN0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHAuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHAudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBpbnN0YWxsbWVudCBwYXltZW50czonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVJbnN0YWxsbWVudFBheW1lbnRBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgY2FzaFR4SWQgPSBkYXRhLmNhc2hUcmFuc2FjdGlvbklkO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRhdGEuYWNjb3VudElkICYmIGRhdGEubG9jYXRpb25JZCAmJiAhY2FzaFR4SWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNhbGUgPSBhd2FpdCB0eC5zYWxlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBkYXRhLnNhbGVJZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjdXN0b21lck5hbWU6IHRydWUsIHJlY2VpcHROdW1iZXI6IHRydWUgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBzYWxlXHJcbiAgICAgICAgICAgICAgICAgICAgPyBgSW5zdGFsbG1lbnQgcGF5bWVudCBmb3IgJHtzYWxlLmN1c3RvbWVyTmFtZX0gLSBSZWNlaXB0ICMke3NhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICAgICAgOiBgSW5zdGFsbG1lbnQgcGF5bWVudCBmb3Igc2FsZWA7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICdjYXNoX2luJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICdJbnN0YWxsbWVudCBwYXltZW50JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY2FzaFR4SWQgPSBjYXNoVHguaWQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBzYWxlSWQ6IGRhdGEuc2FsZUlkLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IGRhdGEucGF5bWVudERhdGUgPyBuZXcgRGF0ZShkYXRhLnBheW1lbnREYXRlKSA6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcGF5bWVudDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVJbnN0YWxsbWVudFBheW1lbnRBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQYXltZW50IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBub3RlczogdXBkYXRlcy5ub3RlcyxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQuY2FzaFRyYW5zYWN0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLnBheW1lbnREYXRlID8gbmV3IERhdGUodXBkYXRlcy5wYXltZW50RGF0ZSkgOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IGNhc2hUcmFuc2FjdGlvbklkOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAocGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50LmNhc2hUcmFuc2FjdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpbmtJbnN0YWxsbWVudFRvQ2FzaEFjdGlvbihwYXltZW50SWQ6IHN0cmluZywgYWNjb3VudElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBpbmNsdWRlOiB7IHNhbGU6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcbiAgICAgICAgICAgIGlmIChwYXltZW50LmNhc2hUcmFuc2FjdGlvbklkKSB0aHJvdyBuZXcgRXJyb3IoXCJQYXltZW50IGFscmVhZHkgbGlua2VkXCIpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBwYXltZW50LnNhbGVcclxuICAgICAgICAgICAgICAgID8gYEluc3RhbGxtZW50IHBheW1lbnQgZm9yICR7cGF5bWVudC5zYWxlLmN1c3RvbWVyTmFtZX0gLSBSZWNlaXB0ICMke3BheW1lbnQuc2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgIDogYEluc3RhbGxtZW50IHBheW1lbnQgIyR7cGF5bWVudElkLnN1YnN0cmluZygwLCA4KX1gO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IG5hbWU6ICdhc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGNhdGVnb3JpZXMubWFwKChjOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYy5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYy5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGMuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBleHBlbnNlIGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZSBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgZXhwZW5zZSBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVEZWZhdWx0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24odXNlcklkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgY2F0ZWdvcnlOYW1lczogc3RyaW5nW10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IGNhdGVnb3J5TmFtZXMubWFwKG5hbWUgPT4gKHtcclxuICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICBicmFuY2hJZDogbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IG5hbWU6ICdhc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGFjY291bnRzLm1hcCgoYTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IGEuaWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBOdW1iZXIoYS5pbml0aWFsQmFsYW5jZSksXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGEuaXNEZWZhdWx0LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBhLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBhLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzaCBhY2NvdW50czonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVDYXNoQWNjb3VudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuY2FzaEFjY291bnQuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbiB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbEJhbGFuY2U6IGRhdGEub3BlbmluZ0JhbGFuY2UgfHwgMCxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogZGF0YS5pc0RlZmF1bHQgfHwgZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBjYXNoIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FzaEFjY291bnRBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IHVwZGF0ZXMubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbEJhbGFuY2U6IHVwZGF0ZXMub3BlbmluZ0JhbGFuY2UsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IHVwZGF0ZXMuaXNEZWZhdWx0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdHhDb3VudCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jb3VudCh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHR4Q291bnQgPiAwIHx8IGV4cENvdW50ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBoYXNUcmFuc2FjdGlvbnM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGV0YWlsczogYEFjY291bnQgaGFzICR7dHhDb3VudH0gdHJhbnNhY3Rpb25zIGFuZCAke2V4cENvdW50fSBleHBlbnNlcy5gXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5jYXNoQWNjb3VudC5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGhhc1RyYW5zYWN0aW9uczogZmFsc2UgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXNoIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlQ2FzaEFjY291bnRXaXRoVHJhbnNhY3Rpb25zQWN0aW9uKGlkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgZGVsZXRlVHJhbnNhY3Rpb25zOiBib29sZWFuKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZGVsZXRlVHJhbnNhY3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGFjY291bnRJZDogbnVsbCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgY2FzaEFjY291bnRJZDogaWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoQWNjb3VudElkOiBudWxsLCBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguY2FzaEFjY291bnQuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgaW5pdGlhbEJhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhbW91bnQ6IHRydWUsIHRyYW5zYWN0aW9uVHlwZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBiYWxhbmNlID0gTnVtYmVyKGFjY291bnQuaW5pdGlhbEJhbGFuY2UpO1xyXG4gICAgICAgIGZvciAoY29uc3QgdHggb2YgdHJhbnNhY3Rpb25zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFtb3VudCA9IE51bWJlcih0eC5hbW91bnQpO1xyXG4gICAgICAgICAgICBpZiAodHgudHJhbnNhY3Rpb25UeXBlID09PSAnY2FzaF9pbicgfHwgdHgudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXJfaW4nKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlICs9IGFtb3VudDtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX291dCcgfHwgdHgudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXJfb3V0Jykge1xyXG4gICAgICAgICAgICAgICAgYmFsYW5jZSAtPSBhbW91bnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGJhbGFuY2UgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjYWxjdWxhdGluZyBhY2NvdW50IGJhbGFuY2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBUUkFOU0FDVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2FzaFRyYW5zYWN0aW9uc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIGFjY291bnRJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZDogbG9jYXRpb25JZCB9O1xyXG4gICAgICAgIGlmIChhY2NvdW50SWQpIHdoZXJlLmFjY291bnRJZCA9IGFjY291bnRJZDtcclxuXHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXdhaXQgZGIuY2FzaFRyYW5zYWN0aW9uLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmUsXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGRhdGU6ICdkZXNjJyB9LCB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHRyYW5zYWN0aW9ucy5tYXAoKHQ6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIC4uLnQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkX2F0OiB0LmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogdC51cGRhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVzZXJfaWQ6IHQudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYWNjb3VudF9pZDogdC5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbl9pZDogdC5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25fdHlwZTogdC50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBwZXJzb25faW5fY2hhcmdlOiB0LnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IHQucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHRfaW1hZ2U6IHQucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzaCB0cmFuc2FjdGlvbnM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4T3V0ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4SW4gPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLnRvQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBbdHhPdXQsIHR4SW5dO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IGRhdGEucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgYWNjb3VudElkOiB1cGRhdGVzLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6IHVwZGF0ZXMudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgdGFnczogdXBkYXRlcy50YWdzLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5kYXRlID8gbmV3IERhdGUodXBkYXRlcy5kYXRlKSA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IHVwZGF0ZXMucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBjYXNoIHRyYW5zYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmRDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFjY291bnRJZDogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRyYW5zYWN0aW9uIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmluZGluZyBjYXNoIHRyYW5zYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpbml0aWFsQmFsYW5jZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IE51bWJlcihhY2NvdW50Py5pbml0aWFsQmFsYW5jZSB8fCAwKSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG9wZW5pbmcgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVCdWxrQ2FzaFRyYW5zYWN0aW9uc0FjdGlvbih0cmFuc2FjdGlvbnM6IGFueVtdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjcmVhdGVkID0gW107XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZGF0YSBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZC5wdXNoKGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCAnVHJhbnNmZXInXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZC5wdXNoKGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6IGRhdGEudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiBkYXRhLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGJ1bGsgdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjJTQWlOc0IseU1BQUEifQ==
}),
"[project]/src/app/actions/data:036460 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createInstallmentPaymentAction",
    ()=>$$RSC_SERVER_ACTION_5
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"404980a34b93d7900c1999c99de5e9c34a721b6cb1":"createInstallmentPaymentAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_5 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("404980a34b93d7900c1999c99de5e9c34a721b6cb1", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "createInstallmentPaymentAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IGRhdGEucGVyc29uSW5DaGFyZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogbGlua1RvQ2FzaCAmJiBkYXRhLmNhc2hBY2NvdW50SWQgPyBkYXRhLmNhc2hBY2NvdW50SWQgOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gMi4gSWYgbGlua2luZyB0byBjYXNoLCBjcmVhdGUgYSBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgIGlmIChsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHtkYXRhLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiBkYXRhLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleHBlbnNlIHdpdGggdHJhbnNhY3Rpb24gcmVmZXJlbmNlXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4cGVuc2UuaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBleHBlbnNlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBleHBlbnNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEV4cGVuc2VzQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBleHBlbnNlcyA9IGF3YWl0IGRiLmV4cGVuc2UuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBjdXJyZW50RXhwZW5zZS5icmFuY2hJZCB8fCBjdXJyZW50RXhwZW5zZS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCB8fCBjdXJyZW50RXhwZW5zZS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNob3VsZExpbmtUb0Nhc2ggJiYgd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgY2FzaCB0cmFuc2FjdGlvblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGN1cnJlbnRFeHBlbnNlLmNhc2hUcmFuc2FjdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCB8fCBjdXJyZW50RXhwZW5zZS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiB1cGRhdGVzLmNhdGVnb3J5IHx8IGN1cnJlbnRFeHBlbnNlLmNhdGVnb3J5IHx8ICdFeHBlbnNlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGBFeHBlbnNlOiAke3VwZGF0ZXMuZGVzY3JpcHRpb24gfHwgY3VycmVudEV4cGVuc2UuZGVzY3JpcHRpb259YCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IHVwZGF0ZXMucGVyc29uSW5DaGFyZ2UgfHwgY3VycmVudEV4cGVuc2UucGVyc29uSW5DaGFyZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5kYXRlIHx8IGN1cnJlbnRFeHBlbnNlLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IHVwZGF0ZXMucGF5bWVudE1ldGhvZCB8fCBjdXJyZW50RXhwZW5zZS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UgfHwgY3VycmVudEV4cGVuc2UucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICghc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlZEV4cGVuc2U7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBleHBlbnNlID0gYXdhaXQgdHguZXhwZW5zZS5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChleHBlbnNlPy5jYXNoVHJhbnNhY3Rpb25JZCkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBleHBlbnNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIElOU1RBTExNRU5UIFBBWU1FTlRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEluc3RhbGxtZW50UGF5bWVudHNBY3Rpb24oc2FsZUlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcGF5bWVudHMgPSBhd2FpdCBkYi5pbnN0YWxsbWVudFBheW1lbnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBzYWxlSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBwYXltZW50RGF0ZTogJ2Rlc2MnIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogcGF5bWVudHMubWFwKChwOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogcC5pZCxcclxuICAgICAgICAgICAgICAgIHNhbGVJZDogcC5zYWxlSWQsXHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHAudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiBOdW1iZXIocC5hbW91bnQpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHAucGF5bWVudERhdGUudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiBwLm5vdGVzLFxyXG4gICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IHAuY2FzaFRyYW5zYWN0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHAuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHAudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBpbnN0YWxsbWVudCBwYXltZW50czonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVJbnN0YWxsbWVudFBheW1lbnRBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgY2FzaFR4SWQgPSBkYXRhLmNhc2hUcmFuc2FjdGlvbklkO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRhdGEuYWNjb3VudElkICYmIGRhdGEubG9jYXRpb25JZCAmJiAhY2FzaFR4SWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNhbGUgPSBhd2FpdCB0eC5zYWxlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBkYXRhLnNhbGVJZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjdXN0b21lck5hbWU6IHRydWUsIHJlY2VpcHROdW1iZXI6IHRydWUgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBzYWxlXHJcbiAgICAgICAgICAgICAgICAgICAgPyBgSW5zdGFsbG1lbnQgcGF5bWVudCBmb3IgJHtzYWxlLmN1c3RvbWVyTmFtZX0gLSBSZWNlaXB0ICMke3NhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICAgICAgOiBgSW5zdGFsbG1lbnQgcGF5bWVudCBmb3Igc2FsZWA7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICdjYXNoX2luJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICdJbnN0YWxsbWVudCBwYXltZW50JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY2FzaFR4SWQgPSBjYXNoVHguaWQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBzYWxlSWQ6IGRhdGEuc2FsZUlkLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IGRhdGEucGF5bWVudERhdGUgPyBuZXcgRGF0ZShkYXRhLnBheW1lbnREYXRlKSA6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcGF5bWVudDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVJbnN0YWxsbWVudFBheW1lbnRBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQYXltZW50IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBub3RlczogdXBkYXRlcy5ub3RlcyxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQuY2FzaFRyYW5zYWN0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLnBheW1lbnREYXRlID8gbmV3IERhdGUodXBkYXRlcy5wYXltZW50RGF0ZSkgOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IGNhc2hUcmFuc2FjdGlvbklkOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAocGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50LmNhc2hUcmFuc2FjdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpbmtJbnN0YWxsbWVudFRvQ2FzaEFjdGlvbihwYXltZW50SWQ6IHN0cmluZywgYWNjb3VudElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBpbmNsdWRlOiB7IHNhbGU6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcbiAgICAgICAgICAgIGlmIChwYXltZW50LmNhc2hUcmFuc2FjdGlvbklkKSB0aHJvdyBuZXcgRXJyb3IoXCJQYXltZW50IGFscmVhZHkgbGlua2VkXCIpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBwYXltZW50LnNhbGVcclxuICAgICAgICAgICAgICAgID8gYEluc3RhbGxtZW50IHBheW1lbnQgZm9yICR7cGF5bWVudC5zYWxlLmN1c3RvbWVyTmFtZX0gLSBSZWNlaXB0ICMke3BheW1lbnQuc2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgIDogYEluc3RhbGxtZW50IHBheW1lbnQgIyR7cGF5bWVudElkLnN1YnN0cmluZygwLCA4KX1gO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IG5hbWU6ICdhc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGNhdGVnb3JpZXMubWFwKChjOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYy5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYy5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGMuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBleHBlbnNlIGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZSBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgZXhwZW5zZSBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVEZWZhdWx0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24odXNlcklkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgY2F0ZWdvcnlOYW1lczogc3RyaW5nW10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IGNhdGVnb3J5TmFtZXMubWFwKG5hbWUgPT4gKHtcclxuICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICBicmFuY2hJZDogbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IG5hbWU6ICdhc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGFjY291bnRzLm1hcCgoYTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IGEuaWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBOdW1iZXIoYS5pbml0aWFsQmFsYW5jZSksXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGEuaXNEZWZhdWx0LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBhLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBhLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzaCBhY2NvdW50czonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVDYXNoQWNjb3VudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuY2FzaEFjY291bnQuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbiB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbEJhbGFuY2U6IGRhdGEub3BlbmluZ0JhbGFuY2UgfHwgMCxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogZGF0YS5pc0RlZmF1bHQgfHwgZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBjYXNoIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FzaEFjY291bnRBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IHVwZGF0ZXMubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbEJhbGFuY2U6IHVwZGF0ZXMub3BlbmluZ0JhbGFuY2UsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IHVwZGF0ZXMuaXNEZWZhdWx0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdHhDb3VudCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jb3VudCh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHR4Q291bnQgPiAwIHx8IGV4cENvdW50ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBoYXNUcmFuc2FjdGlvbnM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGV0YWlsczogYEFjY291bnQgaGFzICR7dHhDb3VudH0gdHJhbnNhY3Rpb25zIGFuZCAke2V4cENvdW50fSBleHBlbnNlcy5gXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5jYXNoQWNjb3VudC5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGhhc1RyYW5zYWN0aW9uczogZmFsc2UgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXNoIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlQ2FzaEFjY291bnRXaXRoVHJhbnNhY3Rpb25zQWN0aW9uKGlkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgZGVsZXRlVHJhbnNhY3Rpb25zOiBib29sZWFuKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZGVsZXRlVHJhbnNhY3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGFjY291bnRJZDogbnVsbCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgY2FzaEFjY291bnRJZDogaWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoQWNjb3VudElkOiBudWxsLCBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguY2FzaEFjY291bnQuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgaW5pdGlhbEJhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhbW91bnQ6IHRydWUsIHRyYW5zYWN0aW9uVHlwZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBiYWxhbmNlID0gTnVtYmVyKGFjY291bnQuaW5pdGlhbEJhbGFuY2UpO1xyXG4gICAgICAgIGZvciAoY29uc3QgdHggb2YgdHJhbnNhY3Rpb25zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFtb3VudCA9IE51bWJlcih0eC5hbW91bnQpO1xyXG4gICAgICAgICAgICBpZiAodHgudHJhbnNhY3Rpb25UeXBlID09PSAnY2FzaF9pbicgfHwgdHgudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXJfaW4nKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlICs9IGFtb3VudDtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX291dCcgfHwgdHgudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXJfb3V0Jykge1xyXG4gICAgICAgICAgICAgICAgYmFsYW5jZSAtPSBhbW91bnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGJhbGFuY2UgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjYWxjdWxhdGluZyBhY2NvdW50IGJhbGFuY2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBUUkFOU0FDVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2FzaFRyYW5zYWN0aW9uc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIGFjY291bnRJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZDogbG9jYXRpb25JZCB9O1xyXG4gICAgICAgIGlmIChhY2NvdW50SWQpIHdoZXJlLmFjY291bnRJZCA9IGFjY291bnRJZDtcclxuXHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXdhaXQgZGIuY2FzaFRyYW5zYWN0aW9uLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmUsXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGRhdGU6ICdkZXNjJyB9LCB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHRyYW5zYWN0aW9ucy5tYXAoKHQ6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIC4uLnQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkX2F0OiB0LmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogdC51cGRhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVzZXJfaWQ6IHQudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYWNjb3VudF9pZDogdC5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbl9pZDogdC5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25fdHlwZTogdC50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBwZXJzb25faW5fY2hhcmdlOiB0LnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IHQucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHRfaW1hZ2U6IHQucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzaCB0cmFuc2FjdGlvbnM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4T3V0ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4SW4gPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLnRvQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBbdHhPdXQsIHR4SW5dO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IGRhdGEucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgYWNjb3VudElkOiB1cGRhdGVzLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6IHVwZGF0ZXMudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgdGFnczogdXBkYXRlcy50YWdzLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5kYXRlID8gbmV3IERhdGUodXBkYXRlcy5kYXRlKSA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IHVwZGF0ZXMucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBjYXNoIHRyYW5zYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmRDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFjY291bnRJZDogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRyYW5zYWN0aW9uIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmluZGluZyBjYXNoIHRyYW5zYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpbml0aWFsQmFsYW5jZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IE51bWJlcihhY2NvdW50Py5pbml0aWFsQmFsYW5jZSB8fCAwKSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG9wZW5pbmcgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVCdWxrQ2FzaFRyYW5zYWN0aW9uc0FjdGlvbih0cmFuc2FjdGlvbnM6IGFueVtdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjcmVhdGVkID0gW107XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZGF0YSBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZC5wdXNoKGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCAnVHJhbnNmZXInXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZC5wdXNoKGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6IGRhdGEudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiBkYXRhLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGJ1bGsgdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjZTQTRPc0IsMk1BQUEifQ==
}),
"[project]/src/app/actions/data:02d05b [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "updateInstallmentPaymentAction",
    ()=>$$RSC_SERVER_ACTION_6
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"601898048ee5b7a83933d537bd12b51141bff3c075":"updateInstallmentPaymentAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_6 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("601898048ee5b7a83933d537bd12b51141bff3c075", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "updateInstallmentPaymentAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IGRhdGEucGVyc29uSW5DaGFyZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogbGlua1RvQ2FzaCAmJiBkYXRhLmNhc2hBY2NvdW50SWQgPyBkYXRhLmNhc2hBY2NvdW50SWQgOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gMi4gSWYgbGlua2luZyB0byBjYXNoLCBjcmVhdGUgYSBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgIGlmIChsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHtkYXRhLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiBkYXRhLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleHBlbnNlIHdpdGggdHJhbnNhY3Rpb24gcmVmZXJlbmNlXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4cGVuc2UuaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBleHBlbnNlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBleHBlbnNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEV4cGVuc2VzQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBleHBlbnNlcyA9IGF3YWl0IGRiLmV4cGVuc2UuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBjdXJyZW50RXhwZW5zZS5icmFuY2hJZCB8fCBjdXJyZW50RXhwZW5zZS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCB8fCBjdXJyZW50RXhwZW5zZS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNob3VsZExpbmtUb0Nhc2ggJiYgd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgY2FzaCB0cmFuc2FjdGlvblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGN1cnJlbnRFeHBlbnNlLmNhc2hUcmFuc2FjdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCB8fCBjdXJyZW50RXhwZW5zZS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiB1cGRhdGVzLmNhdGVnb3J5IHx8IGN1cnJlbnRFeHBlbnNlLmNhdGVnb3J5IHx8ICdFeHBlbnNlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGBFeHBlbnNlOiAke3VwZGF0ZXMuZGVzY3JpcHRpb24gfHwgY3VycmVudEV4cGVuc2UuZGVzY3JpcHRpb259YCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IHVwZGF0ZXMucGVyc29uSW5DaGFyZ2UgfHwgY3VycmVudEV4cGVuc2UucGVyc29uSW5DaGFyZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5kYXRlIHx8IGN1cnJlbnRFeHBlbnNlLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IHVwZGF0ZXMucGF5bWVudE1ldGhvZCB8fCBjdXJyZW50RXhwZW5zZS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UgfHwgY3VycmVudEV4cGVuc2UucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICghc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlZEV4cGVuc2U7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBleHBlbnNlID0gYXdhaXQgdHguZXhwZW5zZS5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChleHBlbnNlPy5jYXNoVHJhbnNhY3Rpb25JZCkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBleHBlbnNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIElOU1RBTExNRU5UIFBBWU1FTlRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEluc3RhbGxtZW50UGF5bWVudHNBY3Rpb24oc2FsZUlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcGF5bWVudHMgPSBhd2FpdCBkYi5pbnN0YWxsbWVudFBheW1lbnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBzYWxlSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBwYXltZW50RGF0ZTogJ2Rlc2MnIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogcGF5bWVudHMubWFwKChwOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogcC5pZCxcclxuICAgICAgICAgICAgICAgIHNhbGVJZDogcC5zYWxlSWQsXHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHAudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiBOdW1iZXIocC5hbW91bnQpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHAucGF5bWVudERhdGUudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiBwLm5vdGVzLFxyXG4gICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IHAuY2FzaFRyYW5zYWN0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHAuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHAudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBpbnN0YWxsbWVudCBwYXltZW50czonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVJbnN0YWxsbWVudFBheW1lbnRBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgY2FzaFR4SWQgPSBkYXRhLmNhc2hUcmFuc2FjdGlvbklkO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRhdGEuYWNjb3VudElkICYmIGRhdGEubG9jYXRpb25JZCAmJiAhY2FzaFR4SWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNhbGUgPSBhd2FpdCB0eC5zYWxlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBkYXRhLnNhbGVJZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjdXN0b21lck5hbWU6IHRydWUsIHJlY2VpcHROdW1iZXI6IHRydWUgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBzYWxlXHJcbiAgICAgICAgICAgICAgICAgICAgPyBgSW5zdGFsbG1lbnQgcGF5bWVudCBmb3IgJHtzYWxlLmN1c3RvbWVyTmFtZX0gLSBSZWNlaXB0ICMke3NhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICAgICAgOiBgSW5zdGFsbG1lbnQgcGF5bWVudCBmb3Igc2FsZWA7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICdjYXNoX2luJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICdJbnN0YWxsbWVudCBwYXltZW50JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY2FzaFR4SWQgPSBjYXNoVHguaWQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBzYWxlSWQ6IGRhdGEuc2FsZUlkLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IGRhdGEucGF5bWVudERhdGUgPyBuZXcgRGF0ZShkYXRhLnBheW1lbnREYXRlKSA6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcGF5bWVudDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVJbnN0YWxsbWVudFBheW1lbnRBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQYXltZW50IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBub3RlczogdXBkYXRlcy5ub3RlcyxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQuY2FzaFRyYW5zYWN0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLnBheW1lbnREYXRlID8gbmV3IERhdGUodXBkYXRlcy5wYXltZW50RGF0ZSkgOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IGNhc2hUcmFuc2FjdGlvbklkOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAocGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50LmNhc2hUcmFuc2FjdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpbmtJbnN0YWxsbWVudFRvQ2FzaEFjdGlvbihwYXltZW50SWQ6IHN0cmluZywgYWNjb3VudElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBpbmNsdWRlOiB7IHNhbGU6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcbiAgICAgICAgICAgIGlmIChwYXltZW50LmNhc2hUcmFuc2FjdGlvbklkKSB0aHJvdyBuZXcgRXJyb3IoXCJQYXltZW50IGFscmVhZHkgbGlua2VkXCIpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBwYXltZW50LnNhbGVcclxuICAgICAgICAgICAgICAgID8gYEluc3RhbGxtZW50IHBheW1lbnQgZm9yICR7cGF5bWVudC5zYWxlLmN1c3RvbWVyTmFtZX0gLSBSZWNlaXB0ICMke3BheW1lbnQuc2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgIDogYEluc3RhbGxtZW50IHBheW1lbnQgIyR7cGF5bWVudElkLnN1YnN0cmluZygwLCA4KX1gO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IG5hbWU6ICdhc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGNhdGVnb3JpZXMubWFwKChjOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYy5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYy5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGMuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBleHBlbnNlIGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZSBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgZXhwZW5zZSBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVEZWZhdWx0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24odXNlcklkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgY2F0ZWdvcnlOYW1lczogc3RyaW5nW10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IGNhdGVnb3J5TmFtZXMubWFwKG5hbWUgPT4gKHtcclxuICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICBicmFuY2hJZDogbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IG5hbWU6ICdhc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGFjY291bnRzLm1hcCgoYTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IGEuaWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBOdW1iZXIoYS5pbml0aWFsQmFsYW5jZSksXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGEuaXNEZWZhdWx0LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBhLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBhLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzaCBhY2NvdW50czonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVDYXNoQWNjb3VudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuY2FzaEFjY291bnQuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbiB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbEJhbGFuY2U6IGRhdGEub3BlbmluZ0JhbGFuY2UgfHwgMCxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogZGF0YS5pc0RlZmF1bHQgfHwgZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBjYXNoIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FzaEFjY291bnRBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IHVwZGF0ZXMubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbEJhbGFuY2U6IHVwZGF0ZXMub3BlbmluZ0JhbGFuY2UsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IHVwZGF0ZXMuaXNEZWZhdWx0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdHhDb3VudCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jb3VudCh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHR4Q291bnQgPiAwIHx8IGV4cENvdW50ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBoYXNUcmFuc2FjdGlvbnM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGV0YWlsczogYEFjY291bnQgaGFzICR7dHhDb3VudH0gdHJhbnNhY3Rpb25zIGFuZCAke2V4cENvdW50fSBleHBlbnNlcy5gXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5jYXNoQWNjb3VudC5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGhhc1RyYW5zYWN0aW9uczogZmFsc2UgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXNoIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlQ2FzaEFjY291bnRXaXRoVHJhbnNhY3Rpb25zQWN0aW9uKGlkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgZGVsZXRlVHJhbnNhY3Rpb25zOiBib29sZWFuKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZGVsZXRlVHJhbnNhY3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGFjY291bnRJZDogbnVsbCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgY2FzaEFjY291bnRJZDogaWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoQWNjb3VudElkOiBudWxsLCBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguY2FzaEFjY291bnQuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgaW5pdGlhbEJhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhbW91bnQ6IHRydWUsIHRyYW5zYWN0aW9uVHlwZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBiYWxhbmNlID0gTnVtYmVyKGFjY291bnQuaW5pdGlhbEJhbGFuY2UpO1xyXG4gICAgICAgIGZvciAoY29uc3QgdHggb2YgdHJhbnNhY3Rpb25zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFtb3VudCA9IE51bWJlcih0eC5hbW91bnQpO1xyXG4gICAgICAgICAgICBpZiAodHgudHJhbnNhY3Rpb25UeXBlID09PSAnY2FzaF9pbicgfHwgdHgudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXJfaW4nKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlICs9IGFtb3VudDtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX291dCcgfHwgdHgudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXJfb3V0Jykge1xyXG4gICAgICAgICAgICAgICAgYmFsYW5jZSAtPSBhbW91bnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGJhbGFuY2UgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjYWxjdWxhdGluZyBhY2NvdW50IGJhbGFuY2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBUUkFOU0FDVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2FzaFRyYW5zYWN0aW9uc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIGFjY291bnRJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZDogbG9jYXRpb25JZCB9O1xyXG4gICAgICAgIGlmIChhY2NvdW50SWQpIHdoZXJlLmFjY291bnRJZCA9IGFjY291bnRJZDtcclxuXHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXdhaXQgZGIuY2FzaFRyYW5zYWN0aW9uLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmUsXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGRhdGU6ICdkZXNjJyB9LCB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHRyYW5zYWN0aW9ucy5tYXAoKHQ6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIC4uLnQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkX2F0OiB0LmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogdC51cGRhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVzZXJfaWQ6IHQudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYWNjb3VudF9pZDogdC5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbl9pZDogdC5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25fdHlwZTogdC50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBwZXJzb25faW5fY2hhcmdlOiB0LnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IHQucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHRfaW1hZ2U6IHQucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzaCB0cmFuc2FjdGlvbnM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4T3V0ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4SW4gPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLnRvQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBbdHhPdXQsIHR4SW5dO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IGRhdGEucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgYWNjb3VudElkOiB1cGRhdGVzLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6IHVwZGF0ZXMudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgdGFnczogdXBkYXRlcy50YWdzLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5kYXRlID8gbmV3IERhdGUodXBkYXRlcy5kYXRlKSA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IHVwZGF0ZXMucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBjYXNoIHRyYW5zYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmRDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFjY291bnRJZDogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRyYW5zYWN0aW9uIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmluZGluZyBjYXNoIHRyYW5zYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpbml0aWFsQmFsYW5jZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IE51bWJlcihhY2NvdW50Py5pbml0aWFsQmFsYW5jZSB8fCAwKSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG9wZW5pbmcgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVCdWxrQ2FzaFRyYW5zYWN0aW9uc0FjdGlvbih0cmFuc2FjdGlvbnM6IGFueVtdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjcmVhdGVkID0gW107XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZGF0YSBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZC5wdXNoKGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCAnVHJhbnNmZXInXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZC5wdXNoKGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6IGRhdGEudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiBkYXRhLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGJ1bGsgdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjZTQWdTc0IsMk1BQUEifQ==
}),
"[project]/src/app/actions/data:9e7cbf [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "deleteInstallmentPaymentAction",
    ()=>$$RSC_SERVER_ACTION_7
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"40312ab6f2fef038b5dfa6085e408edb82463f6967":"deleteInstallmentPaymentAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_7 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("40312ab6f2fef038b5dfa6085e408edb82463f6967", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "deleteInstallmentPaymentAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IGRhdGEucGVyc29uSW5DaGFyZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogbGlua1RvQ2FzaCAmJiBkYXRhLmNhc2hBY2NvdW50SWQgPyBkYXRhLmNhc2hBY2NvdW50SWQgOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gMi4gSWYgbGlua2luZyB0byBjYXNoLCBjcmVhdGUgYSBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgIGlmIChsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHtkYXRhLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiBkYXRhLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleHBlbnNlIHdpdGggdHJhbnNhY3Rpb24gcmVmZXJlbmNlXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4cGVuc2UuaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBleHBlbnNlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBleHBlbnNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEV4cGVuc2VzQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBleHBlbnNlcyA9IGF3YWl0IGRiLmV4cGVuc2UuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBjdXJyZW50RXhwZW5zZS5icmFuY2hJZCB8fCBjdXJyZW50RXhwZW5zZS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCB8fCBjdXJyZW50RXhwZW5zZS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNob3VsZExpbmtUb0Nhc2ggJiYgd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgY2FzaCB0cmFuc2FjdGlvblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGN1cnJlbnRFeHBlbnNlLmNhc2hUcmFuc2FjdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCB8fCBjdXJyZW50RXhwZW5zZS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiB1cGRhdGVzLmNhdGVnb3J5IHx8IGN1cnJlbnRFeHBlbnNlLmNhdGVnb3J5IHx8ICdFeHBlbnNlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGBFeHBlbnNlOiAke3VwZGF0ZXMuZGVzY3JpcHRpb24gfHwgY3VycmVudEV4cGVuc2UuZGVzY3JpcHRpb259YCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IHVwZGF0ZXMucGVyc29uSW5DaGFyZ2UgfHwgY3VycmVudEV4cGVuc2UucGVyc29uSW5DaGFyZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5kYXRlIHx8IGN1cnJlbnRFeHBlbnNlLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IHVwZGF0ZXMucGF5bWVudE1ldGhvZCB8fCBjdXJyZW50RXhwZW5zZS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UgfHwgY3VycmVudEV4cGVuc2UucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICghc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlZEV4cGVuc2U7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBleHBlbnNlID0gYXdhaXQgdHguZXhwZW5zZS5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChleHBlbnNlPy5jYXNoVHJhbnNhY3Rpb25JZCkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBleHBlbnNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIElOU1RBTExNRU5UIFBBWU1FTlRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEluc3RhbGxtZW50UGF5bWVudHNBY3Rpb24oc2FsZUlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcGF5bWVudHMgPSBhd2FpdCBkYi5pbnN0YWxsbWVudFBheW1lbnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBzYWxlSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBwYXltZW50RGF0ZTogJ2Rlc2MnIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogcGF5bWVudHMubWFwKChwOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogcC5pZCxcclxuICAgICAgICAgICAgICAgIHNhbGVJZDogcC5zYWxlSWQsXHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHAudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiBOdW1iZXIocC5hbW91bnQpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHAucGF5bWVudERhdGUudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiBwLm5vdGVzLFxyXG4gICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IHAuY2FzaFRyYW5zYWN0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHAuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHAudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBpbnN0YWxsbWVudCBwYXltZW50czonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVJbnN0YWxsbWVudFBheW1lbnRBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgY2FzaFR4SWQgPSBkYXRhLmNhc2hUcmFuc2FjdGlvbklkO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRhdGEuYWNjb3VudElkICYmIGRhdGEubG9jYXRpb25JZCAmJiAhY2FzaFR4SWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNhbGUgPSBhd2FpdCB0eC5zYWxlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBkYXRhLnNhbGVJZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjdXN0b21lck5hbWU6IHRydWUsIHJlY2VpcHROdW1iZXI6IHRydWUgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBzYWxlXHJcbiAgICAgICAgICAgICAgICAgICAgPyBgSW5zdGFsbG1lbnQgcGF5bWVudCBmb3IgJHtzYWxlLmN1c3RvbWVyTmFtZX0gLSBSZWNlaXB0ICMke3NhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICAgICAgOiBgSW5zdGFsbG1lbnQgcGF5bWVudCBmb3Igc2FsZWA7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICdjYXNoX2luJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICdJbnN0YWxsbWVudCBwYXltZW50JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY2FzaFR4SWQgPSBjYXNoVHguaWQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBzYWxlSWQ6IGRhdGEuc2FsZUlkLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IGRhdGEucGF5bWVudERhdGUgPyBuZXcgRGF0ZShkYXRhLnBheW1lbnREYXRlKSA6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcGF5bWVudDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVJbnN0YWxsbWVudFBheW1lbnRBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQYXltZW50IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBub3RlczogdXBkYXRlcy5ub3RlcyxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQuY2FzaFRyYW5zYWN0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLnBheW1lbnREYXRlID8gbmV3IERhdGUodXBkYXRlcy5wYXltZW50RGF0ZSkgOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IGNhc2hUcmFuc2FjdGlvbklkOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAocGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50LmNhc2hUcmFuc2FjdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpbmtJbnN0YWxsbWVudFRvQ2FzaEFjdGlvbihwYXltZW50SWQ6IHN0cmluZywgYWNjb3VudElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBpbmNsdWRlOiB7IHNhbGU6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcbiAgICAgICAgICAgIGlmIChwYXltZW50LmNhc2hUcmFuc2FjdGlvbklkKSB0aHJvdyBuZXcgRXJyb3IoXCJQYXltZW50IGFscmVhZHkgbGlua2VkXCIpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBwYXltZW50LnNhbGVcclxuICAgICAgICAgICAgICAgID8gYEluc3RhbGxtZW50IHBheW1lbnQgZm9yICR7cGF5bWVudC5zYWxlLmN1c3RvbWVyTmFtZX0gLSBSZWNlaXB0ICMke3BheW1lbnQuc2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgIDogYEluc3RhbGxtZW50IHBheW1lbnQgIyR7cGF5bWVudElkLnN1YnN0cmluZygwLCA4KX1gO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IG5hbWU6ICdhc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGNhdGVnb3JpZXMubWFwKChjOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYy5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYy5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGMuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBleHBlbnNlIGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZSBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgZXhwZW5zZSBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVEZWZhdWx0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24odXNlcklkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgY2F0ZWdvcnlOYW1lczogc3RyaW5nW10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IGNhdGVnb3J5TmFtZXMubWFwKG5hbWUgPT4gKHtcclxuICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICBicmFuY2hJZDogbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IG5hbWU6ICdhc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGFjY291bnRzLm1hcCgoYTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IGEuaWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBOdW1iZXIoYS5pbml0aWFsQmFsYW5jZSksXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGEuaXNEZWZhdWx0LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBhLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBhLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzaCBhY2NvdW50czonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVDYXNoQWNjb3VudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuY2FzaEFjY291bnQuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbiB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbEJhbGFuY2U6IGRhdGEub3BlbmluZ0JhbGFuY2UgfHwgMCxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogZGF0YS5pc0RlZmF1bHQgfHwgZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBjYXNoIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FzaEFjY291bnRBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IHVwZGF0ZXMubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbEJhbGFuY2U6IHVwZGF0ZXMub3BlbmluZ0JhbGFuY2UsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IHVwZGF0ZXMuaXNEZWZhdWx0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdHhDb3VudCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jb3VudCh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHR4Q291bnQgPiAwIHx8IGV4cENvdW50ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBoYXNUcmFuc2FjdGlvbnM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGV0YWlsczogYEFjY291bnQgaGFzICR7dHhDb3VudH0gdHJhbnNhY3Rpb25zIGFuZCAke2V4cENvdW50fSBleHBlbnNlcy5gXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5jYXNoQWNjb3VudC5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGhhc1RyYW5zYWN0aW9uczogZmFsc2UgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXNoIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlQ2FzaEFjY291bnRXaXRoVHJhbnNhY3Rpb25zQWN0aW9uKGlkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgZGVsZXRlVHJhbnNhY3Rpb25zOiBib29sZWFuKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZGVsZXRlVHJhbnNhY3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGFjY291bnRJZDogbnVsbCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgY2FzaEFjY291bnRJZDogaWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoQWNjb3VudElkOiBudWxsLCBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguY2FzaEFjY291bnQuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgaW5pdGlhbEJhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhbW91bnQ6IHRydWUsIHRyYW5zYWN0aW9uVHlwZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBiYWxhbmNlID0gTnVtYmVyKGFjY291bnQuaW5pdGlhbEJhbGFuY2UpO1xyXG4gICAgICAgIGZvciAoY29uc3QgdHggb2YgdHJhbnNhY3Rpb25zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFtb3VudCA9IE51bWJlcih0eC5hbW91bnQpO1xyXG4gICAgICAgICAgICBpZiAodHgudHJhbnNhY3Rpb25UeXBlID09PSAnY2FzaF9pbicgfHwgdHgudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXJfaW4nKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlICs9IGFtb3VudDtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX291dCcgfHwgdHgudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXJfb3V0Jykge1xyXG4gICAgICAgICAgICAgICAgYmFsYW5jZSAtPSBhbW91bnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGJhbGFuY2UgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjYWxjdWxhdGluZyBhY2NvdW50IGJhbGFuY2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBUUkFOU0FDVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2FzaFRyYW5zYWN0aW9uc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIGFjY291bnRJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZDogbG9jYXRpb25JZCB9O1xyXG4gICAgICAgIGlmIChhY2NvdW50SWQpIHdoZXJlLmFjY291bnRJZCA9IGFjY291bnRJZDtcclxuXHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXdhaXQgZGIuY2FzaFRyYW5zYWN0aW9uLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmUsXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGRhdGU6ICdkZXNjJyB9LCB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHRyYW5zYWN0aW9ucy5tYXAoKHQ6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIC4uLnQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkX2F0OiB0LmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogdC51cGRhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVzZXJfaWQ6IHQudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYWNjb3VudF9pZDogdC5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbl9pZDogdC5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25fdHlwZTogdC50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBwZXJzb25faW5fY2hhcmdlOiB0LnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IHQucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHRfaW1hZ2U6IHQucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzaCB0cmFuc2FjdGlvbnM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4T3V0ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4SW4gPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLnRvQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBbdHhPdXQsIHR4SW5dO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IGRhdGEucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgYWNjb3VudElkOiB1cGRhdGVzLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6IHVwZGF0ZXMudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgdGFnczogdXBkYXRlcy50YWdzLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5kYXRlID8gbmV3IERhdGUodXBkYXRlcy5kYXRlKSA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IHVwZGF0ZXMucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBjYXNoIHRyYW5zYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmRDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFjY291bnRJZDogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRyYW5zYWN0aW9uIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmluZGluZyBjYXNoIHRyYW5zYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpbml0aWFsQmFsYW5jZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IE51bWJlcihhY2NvdW50Py5pbml0aWFsQmFsYW5jZSB8fCAwKSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG9wZW5pbmcgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVCdWxrQ2FzaFRyYW5zYWN0aW9uc0FjdGlvbih0cmFuc2FjdGlvbnM6IGFueVtdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjcmVhdGVkID0gW107XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZGF0YSBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZC5wdXNoKGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCAnVHJhbnNmZXInXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZC5wdXNoKGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6IGRhdGEudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiBkYXRhLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGJ1bGsgdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjZTQXdVc0IsMk1BQUEifQ==
}),
"[project]/src/app/actions/data:9f0c68 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "linkInstallmentToCashAction",
    ()=>$$RSC_SERVER_ACTION_8
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"787558103b6686223e72b23ffe2cac99e0e46da6bc":"linkInstallmentToCashAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_8 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("787558103b6686223e72b23ffe2cac99e0e46da6bc", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "linkInstallmentToCashAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IGRhdGEucGVyc29uSW5DaGFyZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogbGlua1RvQ2FzaCAmJiBkYXRhLmNhc2hBY2NvdW50SWQgPyBkYXRhLmNhc2hBY2NvdW50SWQgOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gMi4gSWYgbGlua2luZyB0byBjYXNoLCBjcmVhdGUgYSBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgIGlmIChsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHtkYXRhLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiBkYXRhLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleHBlbnNlIHdpdGggdHJhbnNhY3Rpb24gcmVmZXJlbmNlXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4cGVuc2UuaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBleHBlbnNlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBleHBlbnNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEV4cGVuc2VzQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBleHBlbnNlcyA9IGF3YWl0IGRiLmV4cGVuc2UuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBjdXJyZW50RXhwZW5zZS5icmFuY2hJZCB8fCBjdXJyZW50RXhwZW5zZS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCB8fCBjdXJyZW50RXhwZW5zZS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNob3VsZExpbmtUb0Nhc2ggJiYgd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgY2FzaCB0cmFuc2FjdGlvblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGN1cnJlbnRFeHBlbnNlLmNhc2hUcmFuc2FjdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCB8fCBjdXJyZW50RXhwZW5zZS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiB1cGRhdGVzLmNhdGVnb3J5IHx8IGN1cnJlbnRFeHBlbnNlLmNhdGVnb3J5IHx8ICdFeHBlbnNlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGBFeHBlbnNlOiAke3VwZGF0ZXMuZGVzY3JpcHRpb24gfHwgY3VycmVudEV4cGVuc2UuZGVzY3JpcHRpb259YCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IHVwZGF0ZXMucGVyc29uSW5DaGFyZ2UgfHwgY3VycmVudEV4cGVuc2UucGVyc29uSW5DaGFyZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5kYXRlIHx8IGN1cnJlbnRFeHBlbnNlLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IHVwZGF0ZXMucGF5bWVudE1ldGhvZCB8fCBjdXJyZW50RXhwZW5zZS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UgfHwgY3VycmVudEV4cGVuc2UucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICghc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlZEV4cGVuc2U7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBleHBlbnNlID0gYXdhaXQgdHguZXhwZW5zZS5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChleHBlbnNlPy5jYXNoVHJhbnNhY3Rpb25JZCkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBleHBlbnNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIElOU1RBTExNRU5UIFBBWU1FTlRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEluc3RhbGxtZW50UGF5bWVudHNBY3Rpb24oc2FsZUlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcGF5bWVudHMgPSBhd2FpdCBkYi5pbnN0YWxsbWVudFBheW1lbnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBzYWxlSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBwYXltZW50RGF0ZTogJ2Rlc2MnIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogcGF5bWVudHMubWFwKChwOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogcC5pZCxcclxuICAgICAgICAgICAgICAgIHNhbGVJZDogcC5zYWxlSWQsXHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHAudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiBOdW1iZXIocC5hbW91bnQpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHAucGF5bWVudERhdGUudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiBwLm5vdGVzLFxyXG4gICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IHAuY2FzaFRyYW5zYWN0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHAuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHAudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBpbnN0YWxsbWVudCBwYXltZW50czonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVJbnN0YWxsbWVudFBheW1lbnRBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgY2FzaFR4SWQgPSBkYXRhLmNhc2hUcmFuc2FjdGlvbklkO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRhdGEuYWNjb3VudElkICYmIGRhdGEubG9jYXRpb25JZCAmJiAhY2FzaFR4SWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNhbGUgPSBhd2FpdCB0eC5zYWxlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBkYXRhLnNhbGVJZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjdXN0b21lck5hbWU6IHRydWUsIHJlY2VpcHROdW1iZXI6IHRydWUgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBzYWxlXHJcbiAgICAgICAgICAgICAgICAgICAgPyBgSW5zdGFsbG1lbnQgcGF5bWVudCBmb3IgJHtzYWxlLmN1c3RvbWVyTmFtZX0gLSBSZWNlaXB0ICMke3NhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICAgICAgOiBgSW5zdGFsbG1lbnQgcGF5bWVudCBmb3Igc2FsZWA7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICdjYXNoX2luJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICdJbnN0YWxsbWVudCBwYXltZW50JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY2FzaFR4SWQgPSBjYXNoVHguaWQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBzYWxlSWQ6IGRhdGEuc2FsZUlkLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IGRhdGEucGF5bWVudERhdGUgPyBuZXcgRGF0ZShkYXRhLnBheW1lbnREYXRlKSA6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcGF5bWVudDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVJbnN0YWxsbWVudFBheW1lbnRBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQYXltZW50IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBub3RlczogdXBkYXRlcy5ub3RlcyxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQuY2FzaFRyYW5zYWN0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLnBheW1lbnREYXRlID8gbmV3IERhdGUodXBkYXRlcy5wYXltZW50RGF0ZSkgOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IGNhc2hUcmFuc2FjdGlvbklkOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAocGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50LmNhc2hUcmFuc2FjdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpbmtJbnN0YWxsbWVudFRvQ2FzaEFjdGlvbihwYXltZW50SWQ6IHN0cmluZywgYWNjb3VudElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBpbmNsdWRlOiB7IHNhbGU6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcbiAgICAgICAgICAgIGlmIChwYXltZW50LmNhc2hUcmFuc2FjdGlvbklkKSB0aHJvdyBuZXcgRXJyb3IoXCJQYXltZW50IGFscmVhZHkgbGlua2VkXCIpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBwYXltZW50LnNhbGVcclxuICAgICAgICAgICAgICAgID8gYEluc3RhbGxtZW50IHBheW1lbnQgZm9yICR7cGF5bWVudC5zYWxlLmN1c3RvbWVyTmFtZX0gLSBSZWNlaXB0ICMke3BheW1lbnQuc2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgIDogYEluc3RhbGxtZW50IHBheW1lbnQgIyR7cGF5bWVudElkLnN1YnN0cmluZygwLCA4KX1gO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IG5hbWU6ICdhc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGNhdGVnb3JpZXMubWFwKChjOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYy5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYy5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGMuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBleHBlbnNlIGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZSBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgZXhwZW5zZSBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVEZWZhdWx0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24odXNlcklkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgY2F0ZWdvcnlOYW1lczogc3RyaW5nW10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IGNhdGVnb3J5TmFtZXMubWFwKG5hbWUgPT4gKHtcclxuICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICBicmFuY2hJZDogbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IG5hbWU6ICdhc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGFjY291bnRzLm1hcCgoYTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IGEuaWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBOdW1iZXIoYS5pbml0aWFsQmFsYW5jZSksXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGEuaXNEZWZhdWx0LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBhLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBhLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzaCBhY2NvdW50czonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVDYXNoQWNjb3VudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuY2FzaEFjY291bnQuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbiB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbEJhbGFuY2U6IGRhdGEub3BlbmluZ0JhbGFuY2UgfHwgMCxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogZGF0YS5pc0RlZmF1bHQgfHwgZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBjYXNoIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FzaEFjY291bnRBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IHVwZGF0ZXMubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbEJhbGFuY2U6IHVwZGF0ZXMub3BlbmluZ0JhbGFuY2UsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IHVwZGF0ZXMuaXNEZWZhdWx0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdHhDb3VudCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jb3VudCh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHR4Q291bnQgPiAwIHx8IGV4cENvdW50ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBoYXNUcmFuc2FjdGlvbnM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGV0YWlsczogYEFjY291bnQgaGFzICR7dHhDb3VudH0gdHJhbnNhY3Rpb25zIGFuZCAke2V4cENvdW50fSBleHBlbnNlcy5gXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5jYXNoQWNjb3VudC5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGhhc1RyYW5zYWN0aW9uczogZmFsc2UgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXNoIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlQ2FzaEFjY291bnRXaXRoVHJhbnNhY3Rpb25zQWN0aW9uKGlkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgZGVsZXRlVHJhbnNhY3Rpb25zOiBib29sZWFuKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZGVsZXRlVHJhbnNhY3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGFjY291bnRJZDogbnVsbCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgY2FzaEFjY291bnRJZDogaWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoQWNjb3VudElkOiBudWxsLCBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguY2FzaEFjY291bnQuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgaW5pdGlhbEJhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhbW91bnQ6IHRydWUsIHRyYW5zYWN0aW9uVHlwZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBiYWxhbmNlID0gTnVtYmVyKGFjY291bnQuaW5pdGlhbEJhbGFuY2UpO1xyXG4gICAgICAgIGZvciAoY29uc3QgdHggb2YgdHJhbnNhY3Rpb25zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFtb3VudCA9IE51bWJlcih0eC5hbW91bnQpO1xyXG4gICAgICAgICAgICBpZiAodHgudHJhbnNhY3Rpb25UeXBlID09PSAnY2FzaF9pbicgfHwgdHgudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXJfaW4nKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlICs9IGFtb3VudDtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX291dCcgfHwgdHgudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXJfb3V0Jykge1xyXG4gICAgICAgICAgICAgICAgYmFsYW5jZSAtPSBhbW91bnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGJhbGFuY2UgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjYWxjdWxhdGluZyBhY2NvdW50IGJhbGFuY2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBUUkFOU0FDVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2FzaFRyYW5zYWN0aW9uc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIGFjY291bnRJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZDogbG9jYXRpb25JZCB9O1xyXG4gICAgICAgIGlmIChhY2NvdW50SWQpIHdoZXJlLmFjY291bnRJZCA9IGFjY291bnRJZDtcclxuXHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXdhaXQgZGIuY2FzaFRyYW5zYWN0aW9uLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmUsXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGRhdGU6ICdkZXNjJyB9LCB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHRyYW5zYWN0aW9ucy5tYXAoKHQ6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIC4uLnQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkX2F0OiB0LmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogdC51cGRhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVzZXJfaWQ6IHQudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYWNjb3VudF9pZDogdC5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbl9pZDogdC5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25fdHlwZTogdC50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBwZXJzb25faW5fY2hhcmdlOiB0LnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IHQucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHRfaW1hZ2U6IHQucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzaCB0cmFuc2FjdGlvbnM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4T3V0ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4SW4gPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLnRvQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBbdHhPdXQsIHR4SW5dO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IGRhdGEucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgYWNjb3VudElkOiB1cGRhdGVzLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6IHVwZGF0ZXMudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgdGFnczogdXBkYXRlcy50YWdzLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5kYXRlID8gbmV3IERhdGUodXBkYXRlcy5kYXRlKSA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IHVwZGF0ZXMucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBjYXNoIHRyYW5zYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmRDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFjY291bnRJZDogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRyYW5zYWN0aW9uIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmluZGluZyBjYXNoIHRyYW5zYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpbml0aWFsQmFsYW5jZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IE51bWJlcihhY2NvdW50Py5pbml0aWFsQmFsYW5jZSB8fCAwKSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG9wZW5pbmcgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVCdWxrQ2FzaFRyYW5zYWN0aW9uc0FjdGlvbih0cmFuc2FjdGlvbnM6IGFueVtdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjcmVhdGVkID0gW107XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZGF0YSBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZC5wdXNoKGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCAnVHJhbnNmZXInXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZC5wdXNoKGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6IGRhdGEudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiBkYXRhLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGJ1bGsgdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjBTQW1Xc0Isd01BQUEifQ==
}),
"[project]/src/app/actions/data:16b8a3 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "unlinkInstallmentFromCashAction",
    ()=>$$RSC_SERVER_ACTION_9
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"40e27ea01694c068cec3727a5ec76f4f8a00869aeb":"unlinkInstallmentFromCashAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_9 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("40e27ea01694c068cec3727a5ec76f4f8a00869aeb", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "unlinkInstallmentFromCashAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IGRhdGEucGVyc29uSW5DaGFyZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogbGlua1RvQ2FzaCAmJiBkYXRhLmNhc2hBY2NvdW50SWQgPyBkYXRhLmNhc2hBY2NvdW50SWQgOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gMi4gSWYgbGlua2luZyB0byBjYXNoLCBjcmVhdGUgYSBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgIGlmIChsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHtkYXRhLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiBkYXRhLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleHBlbnNlIHdpdGggdHJhbnNhY3Rpb24gcmVmZXJlbmNlXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4cGVuc2UuaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBleHBlbnNlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBleHBlbnNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEV4cGVuc2VzQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBleHBlbnNlcyA9IGF3YWl0IGRiLmV4cGVuc2UuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBjdXJyZW50RXhwZW5zZS5icmFuY2hJZCB8fCBjdXJyZW50RXhwZW5zZS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCB8fCBjdXJyZW50RXhwZW5zZS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNob3VsZExpbmtUb0Nhc2ggJiYgd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgY2FzaCB0cmFuc2FjdGlvblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGN1cnJlbnRFeHBlbnNlLmNhc2hUcmFuc2FjdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuY2FzaEFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCB8fCBjdXJyZW50RXhwZW5zZS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiB1cGRhdGVzLmNhdGVnb3J5IHx8IGN1cnJlbnRFeHBlbnNlLmNhdGVnb3J5IHx8ICdFeHBlbnNlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGBFeHBlbnNlOiAke3VwZGF0ZXMuZGVzY3JpcHRpb24gfHwgY3VycmVudEV4cGVuc2UuZGVzY3JpcHRpb259YCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IHVwZGF0ZXMucGVyc29uSW5DaGFyZ2UgfHwgY3VycmVudEV4cGVuc2UucGVyc29uSW5DaGFyZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5kYXRlIHx8IGN1cnJlbnRFeHBlbnNlLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IHVwZGF0ZXMucGF5bWVudE1ldGhvZCB8fCBjdXJyZW50RXhwZW5zZS5wYXltZW50TWV0aG9kIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UgfHwgY3VycmVudEV4cGVuc2UucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICghc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlZEV4cGVuc2U7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBleHBlbnNlID0gYXdhaXQgdHguZXhwZW5zZS5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChleHBlbnNlPy5jYXNoVHJhbnNhY3Rpb25JZCkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBleHBlbnNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIElOU1RBTExNRU5UIFBBWU1FTlRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEluc3RhbGxtZW50UGF5bWVudHNBY3Rpb24oc2FsZUlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcGF5bWVudHMgPSBhd2FpdCBkYi5pbnN0YWxsbWVudFBheW1lbnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBzYWxlSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBwYXltZW50RGF0ZTogJ2Rlc2MnIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogcGF5bWVudHMubWFwKChwOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogcC5pZCxcclxuICAgICAgICAgICAgICAgIHNhbGVJZDogcC5zYWxlSWQsXHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHAudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiBOdW1iZXIocC5hbW91bnQpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHAucGF5bWVudERhdGUudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiBwLm5vdGVzLFxyXG4gICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IHAuY2FzaFRyYW5zYWN0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHAuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHAudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBpbnN0YWxsbWVudCBwYXltZW50czonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVJbnN0YWxsbWVudFBheW1lbnRBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgY2FzaFR4SWQgPSBkYXRhLmNhc2hUcmFuc2FjdGlvbklkO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRhdGEuYWNjb3VudElkICYmIGRhdGEubG9jYXRpb25JZCAmJiAhY2FzaFR4SWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNhbGUgPSBhd2FpdCB0eC5zYWxlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBkYXRhLnNhbGVJZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjdXN0b21lck5hbWU6IHRydWUsIHJlY2VpcHROdW1iZXI6IHRydWUgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBzYWxlXHJcbiAgICAgICAgICAgICAgICAgICAgPyBgSW5zdGFsbG1lbnQgcGF5bWVudCBmb3IgJHtzYWxlLmN1c3RvbWVyTmFtZX0gLSBSZWNlaXB0ICMke3NhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICAgICAgOiBgSW5zdGFsbG1lbnQgcGF5bWVudCBmb3Igc2FsZWA7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICdjYXNoX2luJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICdJbnN0YWxsbWVudCBwYXltZW50JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY2FzaFR4SWQgPSBjYXNoVHguaWQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBzYWxlSWQ6IGRhdGEuc2FsZUlkLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IGRhdGEucGF5bWVudERhdGUgPyBuZXcgRGF0ZShkYXRhLnBheW1lbnREYXRlKSA6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcGF5bWVudDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVJbnN0YWxsbWVudFBheW1lbnRBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQYXltZW50IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBub3RlczogdXBkYXRlcy5ub3RlcyxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQuY2FzaFRyYW5zYWN0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLnBheW1lbnREYXRlID8gbmV3IERhdGUodXBkYXRlcy5wYXltZW50RGF0ZSkgOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IGNhc2hUcmFuc2FjdGlvbklkOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAocGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50LmNhc2hUcmFuc2FjdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpbmtJbnN0YWxsbWVudFRvQ2FzaEFjdGlvbihwYXltZW50SWQ6IHN0cmluZywgYWNjb3VudElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBpbmNsdWRlOiB7IHNhbGU6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcbiAgICAgICAgICAgIGlmIChwYXltZW50LmNhc2hUcmFuc2FjdGlvbklkKSB0aHJvdyBuZXcgRXJyb3IoXCJQYXltZW50IGFscmVhZHkgbGlua2VkXCIpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBwYXltZW50LnNhbGVcclxuICAgICAgICAgICAgICAgID8gYEluc3RhbGxtZW50IHBheW1lbnQgZm9yICR7cGF5bWVudC5zYWxlLmN1c3RvbWVyTmFtZX0gLSBSZWNlaXB0ICMke3BheW1lbnQuc2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgIDogYEluc3RhbGxtZW50IHBheW1lbnQgIyR7cGF5bWVudElkLnN1YnN0cmluZygwLCA4KX1gO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY2FzaFR4ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IG5hbWU6ICdhc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGNhdGVnb3JpZXMubWFwKChjOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYy5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYy5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGMuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBleHBlbnNlIGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZSBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgZXhwZW5zZSBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVEZWZhdWx0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24odXNlcklkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgY2F0ZWdvcnlOYW1lczogc3RyaW5nW10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IGNhdGVnb3J5TmFtZXMubWFwKG5hbWUgPT4gKHtcclxuICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICBicmFuY2hJZDogbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBpc0RlZmF1bHQ6ICdkZXNjJyB9LCB7IG5hbWU6ICdhc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGFjY291bnRzLm1hcCgoYTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IGEuaWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBOdW1iZXIoYS5pbml0aWFsQmFsYW5jZSksXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGEuaXNEZWZhdWx0LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBhLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBhLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzaCBhY2NvdW50czonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVDYXNoQWNjb3VudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuY2FzaEFjY291bnQuY3JlYXRlKHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbiB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbEJhbGFuY2U6IGRhdGEub3BlbmluZ0JhbGFuY2UgfHwgMCxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogZGF0YS5pc0RlZmF1bHQgfHwgZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBjYXNoIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FzaEFjY291bnRBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IHVwZGF0ZXMubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgaW5pdGlhbEJhbGFuY2U6IHVwZGF0ZXMub3BlbmluZ0JhbGFuY2UsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IHVwZGF0ZXMuaXNEZWZhdWx0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdHhDb3VudCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jb3VudCh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHR4Q291bnQgPiAwIHx8IGV4cENvdW50ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBoYXNUcmFuc2FjdGlvbnM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGV0YWlsczogYEFjY291bnQgaGFzICR7dHhDb3VudH0gdHJhbnNhY3Rpb25zIGFuZCAke2V4cENvdW50fSBleHBlbnNlcy5gXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5jYXNoQWNjb3VudC5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGhhc1RyYW5zYWN0aW9uczogZmFsc2UgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXNoIGFjY291bnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlQ2FzaEFjY291bnRXaXRoVHJhbnNhY3Rpb25zQWN0aW9uKGlkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZywgZGVsZXRlVHJhbnNhY3Rpb25zOiBib29sZWFuKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZGVsZXRlVHJhbnNhY3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGFjY291bnRJZDogbnVsbCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgY2FzaEFjY291bnRJZDogaWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoQWNjb3VudElkOiBudWxsLCBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguY2FzaEFjY291bnQuZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkLCBicmFuY2hJZDogbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgaW5pdGlhbEJhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhbW91bnQ6IHRydWUsIHRyYW5zYWN0aW9uVHlwZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBiYWxhbmNlID0gTnVtYmVyKGFjY291bnQuaW5pdGlhbEJhbGFuY2UpO1xyXG4gICAgICAgIGZvciAoY29uc3QgdHggb2YgdHJhbnNhY3Rpb25zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFtb3VudCA9IE51bWJlcih0eC5hbW91bnQpO1xyXG4gICAgICAgICAgICBpZiAodHgudHJhbnNhY3Rpb25UeXBlID09PSAnY2FzaF9pbicgfHwgdHgudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXJfaW4nKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlICs9IGFtb3VudDtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX291dCcgfHwgdHgudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXJfb3V0Jykge1xyXG4gICAgICAgICAgICAgICAgYmFsYW5jZSAtPSBhbW91bnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGJhbGFuY2UgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjYWxjdWxhdGluZyBhY2NvdW50IGJhbGFuY2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBUUkFOU0FDVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2FzaFRyYW5zYWN0aW9uc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIGFjY291bnRJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZDogbG9jYXRpb25JZCB9O1xyXG4gICAgICAgIGlmIChhY2NvdW50SWQpIHdoZXJlLmFjY291bnRJZCA9IGFjY291bnRJZDtcclxuXHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXdhaXQgZGIuY2FzaFRyYW5zYWN0aW9uLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmUsXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGRhdGU6ICdkZXNjJyB9LCB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH1dXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHRyYW5zYWN0aW9ucy5tYXAoKHQ6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIC4uLnQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkX2F0OiB0LmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogdC51cGRhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVzZXJfaWQ6IHQudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgYWNjb3VudF9pZDogdC5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbl9pZDogdC5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25fdHlwZTogdC50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBwZXJzb25faW5fY2hhcmdlOiB0LnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IHQucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHRfaW1hZ2U6IHQucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FzaCB0cmFuc2FjdGlvbnM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4T3V0ID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHR4SW4gPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLnRvQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBbdHhPdXQsIHR4SW5dO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaElkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uSW5DaGFyZ2U6IGRhdGEucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgYWNjb3VudElkOiB1cGRhdGVzLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6IHVwZGF0ZXMudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgdGFnczogdXBkYXRlcy50YWdzLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5kYXRlID8gbmV3IERhdGUodXBkYXRlcy5kYXRlKSA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IHVwZGF0ZXMucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBjYXNoIHRyYW5zYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmRDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFjY291bnRJZDogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRyYW5zYWN0aW9uIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmluZGluZyBjYXNoIHRyYW5zYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpbml0aWFsQmFsYW5jZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IE51bWJlcihhY2NvdW50Py5pbml0aWFsQmFsYW5jZSB8fCAwKSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG9wZW5pbmcgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVCdWxrQ2FzaFRyYW5zYWN0aW9uc0FjdGlvbih0cmFuc2FjdGlvbnM6IGFueVtdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjcmVhdGVkID0gW107XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZGF0YSBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZC5wdXNoKGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCAnVHJhbnNmZXInXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZC5wdXNoKGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6IGRhdGEudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiBkYXRhLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZWQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGJ1bGsgdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjhTQStZc0IsNE1BQUEifQ==
}),
"[project]/src/app/actions/data:5828d9 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getStockSummaryReportAction",
    ()=>$$RSC_SERVER_ACTION_9
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"7025d373c4892871d9a0aa001c21511f9ccf0a431e":"getStockSummaryReportAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_9 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("7025d373c4892871d9a0aa001c21511f9ccf0a431e", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getStockSummaryReportAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiNFNBeVVzQix3TUFBQSJ9
}),
"[project]/src/app/actions/data:d8500d [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getProductCategoriesAction",
    ()=>$$RSC_SERVER_ACTION_7
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"404dd4aaa90e099e06b884512b16abb99178afa8f9":"getProductCategoriesAction"},"src/app/actions/products.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_7 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("404dd4aaa90e099e06b884512b16abb99178afa8f9", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getProductCategoriesAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vcHJvZHVjdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XHJcblxyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RGb3JtRGF0YSwgbWFwRGJQcm9kdWN0VG9Qcm9kdWN0LCBtYXBQcm9kdWN0VG9EYlByb2R1Y3QgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIFdlIGltcGxlbWVudCBzZXJ2ZXIgYWN0aW9ucyBmb3IgdGhlIHByb2R1Y3RzIGhlcmVcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0FjdGlvbih7XHJcbiAgdXNlcklkLFxyXG4gIGJ1c2luZXNzSWQsXHJcbiAgcGFnZSxcclxuICBwYWdlU2l6ZSxcclxuICBzZWFyY2gsXHJcbiAgY2F0ZWdvcnksXHJcbiAgc3RvY2tTdGF0dXMsXHJcbn06IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBidXNpbmVzc0lkOiBzdHJpbmc7XHJcbiAgcGFnZTogbnVtYmVyO1xyXG4gIHBhZ2VTaXplOiBudW1iZXI7XHJcbiAgc2VhcmNoPzogc3RyaW5nO1xyXG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gIHN0b2NrU3RhdHVzPzogJ2luU3RvY2snIHwgJ291dE9mU3RvY2snIHwgJ2xvd1N0b2NrJyB8ICdhbGwnO1xyXG59KSB7XHJcbiAgaWYgKCF1c2VySWQgfHwgIWJ1c2luZXNzSWQpIHJldHVybiB7IHByb2R1Y3RzOiBbXSwgY291bnQ6IDAgfTtcclxuXHJcbiAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuICBjb25zdCB0YWtlID0gcGFnZVNpemU7XHJcblxyXG4gIGxldCB3aGVyZUNsYXVzZTogYW55ID0ge1xyXG4gICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICB9O1xyXG5cclxuICBpZiAoc2VhcmNoKSB7XHJcbiAgICB3aGVyZUNsYXVzZS5PUiA9IFtcclxuICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IGRlc2NyaXB0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IHNrdTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIGlmIChjYXRlZ29yeSkge1xyXG4gICAgd2hlcmVDbGF1c2UuY2F0ZWdvcnkgPSB7IG5hbWU6IGNhdGVnb3J5IH07XHJcbiAgfVxyXG5cclxuICBpZiAoc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSAwO1xyXG4gIH0gZWxzZSBpZiAoc3RvY2tTdGF0dXMgPT09ICdpblN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgfSBlbHNlIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgLy8gSGFuZGxpbmcgbG93U3RvY2sgaXMgY29tcGxleCBiZWNhdXNlIG1pblN0b2NrIGlzIGNvbXBhcmVkIGxvY2FsbHkgb3IgdXNpbmcgZGlyZWN0IFNRTCBpbiBQcmlzbWFcclxuICAgIC8vIEZvciBub3csIHdlIHdpbGwgaGFuZGxlIGl0IHdpdGggUHJpc21hJ3MgcmF3IHF1ZXJ5IG9yIGJ5IGZpbHRlcmluZyBpbiBtZW1vcnkgaWYgbmVjZXNzYXJ5XHJcbiAgICAvLyBGb3J0dW5hdGVseSwgc2luY2UgUFJJU01BIDUuMCwgY29sdW1uIGNvbXBhcmlzb24gc3RpbGwgbmVlZHMgcmF3IHF1ZXJpZXMgb3Igd2UgY2FuIGZldGNoIGFuZCBmaWx0ZXIgaWYgc21hbGxcclxuICAgIC8vIEhlcmUgd2UnbGwgZmV0Y2ggdGhlbSBhbGwgaWYgbG93U3RvY2sgaXMgZW5hYmxlZCwgb3IgYWRkIGEgZ2VuZXJhdGVkIGNvbHVtbi4gXHJcbiAgICAvLyBXZSB3aWxsIGRvIGEgYmFzaWMgZmV0Y2ggYW5kIGZpbHRlciBsYXRlciBpZiBuZWVkZWQuXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Byb2R1Y3RzRGF0YSwgdG90YWxDb3VudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcclxuICAgICAgICBza2lwLFxyXG4gICAgICAgIHRha2UsXHJcbiAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnZGVzYycgfSwgeyBpZDogJ2Rlc2MnIH1dLFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgICAgc3VwcGxpZXI6IHRydWUsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgZGIucHJvZHVjdC5jb3VudCh7IHdoZXJlOiB3aGVyZUNsYXVzZSB9KVxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8gTWFwIHRoZSBQcmlzbWEgcHJvZHVjdCBtb2RlbCBiYWNrIHRvIHRoZSBhcHBsaWNhdGlvbidzIFByb2R1Y3QgdHlwZVxyXG4gICAgbGV0IGZvcm1hdHRlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiB7XHJcbiAgICAgIC8vIEFzc3VtaW5nIG1hcHBpbmcgZXhpc3RzLCB3ZSB3aWxsIG1hcCBpdFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgIG5hbWU6IHAubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICBjYXRlZ29yeTogcC5jYXRlZ29yeT8ubmFtZSB8fCAnVW5jYXRlZ29yaXplZCcsXHJcbiAgICAgICAgcXVhbnRpdHk6IHAuc3RvY2ssXHJcbiAgICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHAuc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgIHN1cHBsaWVyOiBwLnN1cHBsaWVyPy5uYW1lLFxyXG4gICAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICAgIGJhcmNvZGU6IHAuYmFyY29kZSxcclxuICAgICAgICBpdGVtTnVtYmVyOiBwLnNrdSB8fCAnJyxcclxuICAgICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgICBmb3JtYXR0ZWRQcm9kdWN0cyA9IGZvcm1hdHRlZFByb2R1Y3RzLmZpbHRlcigocDogYW55KSA9PiBwLnF1YW50aXR5ID4gMCAmJiBwLnF1YW50aXR5IDw9IHAubWluaW11bVN0b2NrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBwcm9kdWN0czogZm9ybWF0dGVkUHJvZHVjdHMgYXMgYW55W10sIGNvdW50OiB0b3RhbENvdW50IH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgcHJvZHVjdHM6IFtdLCBjb3VudDogMCB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIXVzZXJJZCB8fCAhYnVzaW5lc3NJZCkgcmV0dXJuIFtdO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvZHVjdHNEYXRhID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sIHsgaWQ6ICdkZXNjJyB9XSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgIHN1cHBsaWVyOiB0cnVlLFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogTnVtYmVyKHAuc3RvY2spLFxyXG4gICAgICBjb3N0UHJpY2U6IE51bWJlcihwLmNvc3RQcmljZSksXHJcbiAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHAuc2VsbGluZ1ByaWNlKSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IE51bWJlcihwLm1pblN0b2NrKSxcclxuICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgIH0pKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RzQnlJZHNBY3Rpb24oaWRzOiBzdHJpbmdbXSwgYnVzaW5lc3NJZD86IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0ge1xyXG4gICAgICBpZDogeyBpbjogaWRzIH1cclxuICAgIH07XHJcbiAgICBpZiAoYnVzaW5lc3NJZCkge1xyXG4gICAgICB3aGVyZS5icmFuY2hJZCA9IGJ1c2luZXNzSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcclxuICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHByb2R1Y3RzLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogcC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgc2VsbGluZ1ByaWNlOiBwLnNlbGxpbmdQcmljZSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQsXHJcbiAgICB9KSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGJ5IGlkczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgIC8vIDEuIEdlbmVyYXRlIG5leHQgU0tVL2l0ZW1OdW1iZXIgZm9yIHRoaXMgYnJhbmNoXHJcbiAgICAgIGNvbnN0IGxhc3RQcm9kdWN0ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kRmlyc3Qoe1xyXG4gICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBkYXRhLmJ1c2luZXNzSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiB7IHNrdTogJ2Rlc2MnIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7IHNrdTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbGV0IG5leHRTa3UgPSBcIlBST0QtMDAwMVwiO1xyXG4gICAgICBpZiAobGFzdFByb2R1Y3QgJiYgbGFzdFByb2R1Y3Quc2t1KSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudE51bWJlciA9IHBhcnNlSW50KGxhc3RQcm9kdWN0LnNrdS5yZXBsYWNlKFwiUFJPRC1cIiwgXCJcIikpIHx8IDA7XHJcbiAgICAgICAgbmV4dFNrdSA9IGBQUk9ELSR7KGN1cnJlbnROdW1iZXIgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJyl9YDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMi4gQ3JlYXRlIHRoZSBwcm9kdWN0XHJcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCB0eC5wcm9kdWN0LmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBicmFuY2hJZDogZGF0YS5idXNpbmVzc0lkLFxyXG4gICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IGRhdGEuY2F0ZWdvcnlJZCB8fCBudWxsLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogZGF0YS5zdXBwbGllcklkIHx8IG51bGwsXHJcbiAgICAgICAgICBza3U6IG5leHRTa3UsXHJcbiAgICAgICAgICBiYXJjb2RlOiBkYXRhLmJhcmNvZGUsXHJcbiAgICAgICAgICBpbWFnZTogZGF0YS5pbWFnZVVybCxcclxuICAgICAgICAgIGNvc3RQcmljZTogZGF0YS5jb3N0UHJpY2UgfHwgMCxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogZGF0YS5zZWxsaW5nUHJpY2UgfHwgMCxcclxuICAgICAgICAgIHN0b2NrOiBkYXRhLnF1YW50aXR5IHx8IDAsXHJcbiAgICAgICAgICBtaW5TdG9jazogZGF0YS5taW5pbXVtU3RvY2sgfHwgMCxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXHJcbiAgICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGluaXRpYWwgc3RvY2sgaGlzdG9yeSBpZiBxdWFudGl0eSA+IDBcclxuICAgICAgaWYgKGRhdGEucXVhbnRpdHkgPiAwKSB7XHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICB0eXBlOiAnQ1JFQVRFRCcsXHJcbiAgICAgICAgICAgIG9sZFN0b2NrOiAwLFxyXG4gICAgICAgICAgICBuZXdTdG9jazogZGF0YS5xdWFudGl0eSxcclxuICAgICAgICAgICAgcXVhbnRpdHlDaGFuZ2U6IGRhdGEucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHJlYXNvbjogYFske3Byb2R1Y3QubmFtZX1dIHwgSW5pdGlhbCBzdG9ja2AsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcHJvZHVjdDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcmVzdWx0LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICBjYXRlZ29yeTogcmVzdWx0LmNhdGVnb3J5Py5uYW1lIHx8ICdVbmNhdGVnb3JpemVkJyxcclxuICAgICAgcXVhbnRpdHk6IHJlc3VsdC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiByZXN1bHQuY29zdFByaWNlLFxyXG4gICAgICBzZWxsaW5nUHJpY2U6IHJlc3VsdC5zZWxsaW5nUHJpY2UsXHJcbiAgICAgIHN1cHBsaWVyOiByZXN1bHQuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiByZXN1bHQuaW1hZ2UsXHJcbiAgICAgIGJhcmNvZGU6IHJlc3VsdC5iYXJjb2RlLFxyXG4gICAgICBpdGVtTnVtYmVyOiByZXN1bHQuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHJlc3VsdC5taW5TdG9jayxcclxuICAgICAgY3JlYXRlZEF0OiByZXN1bHQuY3JlYXRlZEF0LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgLy8gMS4gR2V0IGN1cnJlbnQgcHJvZHVjdCBzdGF0ZVxyXG4gICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kVW5pcXVlKHtcclxuICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgIHNlbGVjdDogeyBzdG9jazogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgIC8vIDIuIFBlcmZvcm0gdXBkYXRlXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5wcm9kdWN0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IHVwZGF0ZXMuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkID8gdXBkYXRlcy5jYXRlZ29yeUlkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogdXBkYXRlcy5zdXBwbGllcklkICE9PSB1bmRlZmluZWQgPyB1cGRhdGVzLnN1cHBsaWVySWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBza3U6IHVwZGF0ZXMuaXRlbU51bWJlciB8fCB1cGRhdGVzLnNrdSxcclxuICAgICAgICAgIGJhcmNvZGU6IHVwZGF0ZXMuYmFyY29kZSxcclxuICAgICAgICAgIGltYWdlOiB1cGRhdGVzLmltYWdlVXJsLFxyXG4gICAgICAgICAgY29zdFByaWNlOiB1cGRhdGVzLmNvc3RQcmljZSxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogdXBkYXRlcy5zZWxsaW5nUHJpY2UsXHJcbiAgICAgICAgICBzdG9jazogdXBkYXRlcy5xdWFudGl0eSxcclxuICAgICAgICAgIG1pblN0b2NrOiB1cGRhdGVzLm1pbmltdW1TdG9jayxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGhpc3RvcnkgaWYgcXVhbnRpdHkgY2hhbmdlZFxyXG4gICAgICBpZiAodXBkYXRlcy5xdWFudGl0eSAhPT0gdW5kZWZpbmVkICYmIHVwZGF0ZXMucXVhbnRpdHkgIT09IGN1cnJlbnQuc3RvY2sgJiYgdXBkYXRlcy5jdXN0b21DaGFuZ2VSZWFzb24gIT09ICdza2lwLWhpc3RvcnknKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZVJlYXNvbiA9IHVwZGF0ZXMuY3VzdG9tQ2hhbmdlUmVhc29uO1xyXG4gICAgICAgIGlmICghY2hhbmdlUmVhc29uKSB7XHJcbiAgICAgICAgICBpZiAodXBkYXRlcy5pc0Zyb21TYWxlKSBjaGFuZ2VSZWFzb24gPSBcIlNhbGVcIjtcclxuICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZXMucXVhbnRpdHkgPiBjdXJyZW50LnN0b2NrKSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayBhZGRpdGlvblwiO1xyXG4gICAgICAgICAgZWxzZSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayByZWR1Y3Rpb25cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNuYXBzaG90dGVkUmVhc29uID0gYFske3VwZGF0ZWQubmFtZX1dIHwgJHtjaGFuZ2VSZWFzb259YDtcclxuXHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiB1cGRhdGVzLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiB1cGRhdGVkLmlkLFxyXG4gICAgICAgICAgICB0eXBlOiB1cGRhdGVzLmlzRnJvbVNhbGUgPyAnU0FMRScgOiAodXBkYXRlcy5xdWFudGl0eSA+IGN1cnJlbnQuc3RvY2sgPyAnUkVTVE9DSycgOiAnQURKVVNUTUVOVCcpLFxyXG4gICAgICAgICAgICBvbGRTdG9jazogY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgbmV3U3RvY2s6IHVwZGF0ZXMucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHF1YW50aXR5Q2hhbmdlOiB1cGRhdGVzLnF1YW50aXR5IC0gY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgcmVhc29uOiBzbmFwc2hvdHRlZFJlYXNvbixcclxuICAgICAgICAgICAgcmVmZXJlbmNlSWQ6IHVwZGF0ZXMucmVmZXJlbmNlSWQgfHwgbnVsbCxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3RBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5wcm9kdWN0LmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgIH0pO1xyXG4gICAgLy8gcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnkvcHJvZHVjdHMnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0c0J1bGtBY3Rpb24oXHJcbiAgdXBkYXRlczogQXJyYXk8eyBpZDogc3RyaW5nOyB1cGRhdGVkOiBQYXJ0aWFsPGFueT4gfT4sXHJcbiAgYnVzaW5lc3NJZDogc3RyaW5nXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBQcmlzbWEgdHJhbnNhY3Rpb24gZm9yIGJ1bGsgdXBkYXRlc1xyXG4gICAgY29uc3QgdXBkYXRlUHJvbWlzZXMgPSB1cGRhdGVzLm1hcCh1ID0+XHJcbiAgICAgIGRiLnByb2R1Y3QudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogdS5pZCB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQubmFtZSAmJiB7IG5hbWU6IHUudXBkYXRlZC5uYW1lIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmIHsgZGVzY3JpcHRpb246IHUudXBkYXRlZC5kZXNjcmlwdGlvbiB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkICYmIHsgY2F0ZWdvcnlJZDogdS51cGRhdGVkLmNhdGVnb3J5SWQgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLnN1cHBsaWVySWQgIT09IHVuZGVmaW5lZCAmJiB7IHN1cHBsaWVySWQ6IHUudXBkYXRlZC5zdXBwbGllcklkIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5za3UgIT09IHVuZGVmaW5lZCAmJiB7IHNrdTogdS51cGRhdGVkLnNrdSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuYmFyY29kZSAhPT0gdW5kZWZpbmVkICYmIHsgYmFyY29kZTogdS51cGRhdGVkLmJhcmNvZGUgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLmNvc3RQcmljZSAhPT0gdW5kZWZpbmVkICYmIHsgY29zdFByaWNlOiB1LnVwZGF0ZWQuY29zdFByaWNlIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5zZWxsaW5nUHJpY2UgIT09IHVuZGVmaW5lZCAmJiB7IHNlbGxpbmdQcmljZTogdS51cGRhdGVkLnNlbGxpbmdQcmljZSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQucXVhbnRpdHkgIT09IHVuZGVmaW5lZCAmJiB7IHN0b2NrOiB1LnVwZGF0ZWQucXVhbnRpdHkgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLm1pbmltdW1TdG9jayAhPT0gdW5kZWZpbmVkICYmIHsgbWluU3RvY2s6IHUudXBkYXRlZC5taW5pbXVtU3RvY2sgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBkYi4kdHJhbnNhY3Rpb24odXBkYXRlUHJvbWlzZXMpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBlcmZvcm1pbmcgYnVsayB1cGRhdGU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFBST0RVQ1QgQ0FURUdPUklFUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0Q2F0ZWdvcmllc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLmNhdGVnb3J5LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiBjYXRlZ29yaWVzLm1hcCgoYzogYW55KSA9PiAoe1xyXG4gICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICBjcmVhdGVkX2F0OiBjLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KSlcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9kdWN0Q2F0ZWdvcnlBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgZGIuY2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgIHVzZXJJZCxcclxuICAgICAgICBuYW1lXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yeSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhdGVnb3J5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3RDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5jYXRlZ29yeS51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBkYXRhOiB7IG5hbWUgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHJvZHVjdENhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gQ2hlY2sgaWYgYW55IHByb2R1Y3RzIGFyZSB1c2luZyB0aGlzIGNhdGVnb3J5XHJcbiAgICBjb25zdCB1c2FnZUNvdW50ID0gYXdhaXQgZGIucHJvZHVjdC5jb3VudCh7XHJcbiAgICAgIHdoZXJlOiB7IGNhdGVnb3J5SWQ6IGlkIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh1c2FnZUNvdW50ID4gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBjYXRlZ29yeTogaXQgaXMgYmVpbmcgdXNlZCBieSBvbmUgb3IgbW9yZSBwcm9kdWN0cy4nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZGIuY2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIC0tLSBQUk9EVUNUIFNUQVRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RTdGF0c0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIWJ1c2luZXNzSWQpIHJldHVybiB7IGNvc3RWYWx1ZTogMCwgbG93U3RvY2s6IDAsIG91dE9mU3RvY2s6IDAsIHN0b2NrVmFsdWU6IDAgfTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgIHN0b2NrOiB0cnVlLFxyXG4gICAgICAgIGNvc3RQcmljZTogdHJ1ZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb3N0VmFsdWUgPSAwO1xyXG4gICAgbGV0IGxvd1N0b2NrID0gMDtcclxuICAgIGxldCBvdXRPZlN0b2NrID0gMDtcclxuICAgIGxldCBzdG9ja1ZhbHVlID0gMDtcclxuXHJcbiAgICBwcm9kdWN0cy5mb3JFYWNoKChwOiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgcXR5ID0gTnVtYmVyKHAuc3RvY2spIHx8IDA7XHJcbiAgICAgIGNvbnN0IGNvc3QgPSBOdW1iZXIocC5jb3N0UHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IHNlbGxpbmcgPSBOdW1iZXIocC5zZWxsaW5nUHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IG1pblN0b2NrID0gTnVtYmVyKHAubWluU3RvY2spIHx8IDA7XHJcblxyXG4gICAgICBjb3N0VmFsdWUgKz0gY29zdCAqIHF0eTtcclxuICAgICAgc3RvY2tWYWx1ZSArPSBzZWxsaW5nICogcXR5O1xyXG5cclxuICAgICAgaWYgKHF0eSA9PT0gMCkge1xyXG4gICAgICAgIG91dE9mU3RvY2srKztcclxuICAgICAgfSBlbHNlIGlmIChxdHkgPiAwICYmIHF0eSA8PSBtaW5TdG9jaykge1xyXG4gICAgICAgIGxvd1N0b2NrKys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IGNvc3RWYWx1ZSwgbG93U3RvY2ssIG91dE9mU3RvY2ssIHN0b2NrVmFsdWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdCBzdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBjb3N0VmFsdWU6IDAsIGxvd1N0b2NrOiAwLCBvdXRPZlN0b2NrOiAwLCBzdG9ja1ZhbHVlOiAwIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBMT09LVVAgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbihjb2RlOiBzdHJpbmcsIGJyYW5jaElkOiBzdHJpbmcpIHtcclxuICBpZiAoIWNvZGUgfHwgIWJyYW5jaElkKSByZXR1cm4gbnVsbDtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbG93ZXJDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICBPUjogW1xyXG4gICAgICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBsb3dlckNvZGUsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgICAgeyBza3U6IHsgY29udGFpbnM6IGxvd2VyQ29kZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcm9kdWN0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBTQ0FOTkVSIChhbGwgcHJvZHVjdHMgZm9yIHNjYW5uZXIgcHJlbG9hZCkgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbihicmFuY2hJZDogc3RyaW5nKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBicmFuY2hJZCB9LFxyXG4gICAgICBzZWxlY3Q6IHtcclxuICAgICAgICBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYmFyY29kZTogdHJ1ZSwgc2t1OiB0cnVlLFxyXG4gICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSwgY29zdFByaWNlOiB0cnVlLCBzdG9jazogdHJ1ZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdHJ1ZSwgY2F0ZWdvcnlJZDogdHJ1ZSwgYnJhbmNoSWQ6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsIGltYWdlVXJsOiB0cnVlLCBjcmVhdGVkQXQ6IHRydWUsIHVwZGF0ZWRBdDogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb2R1Y3RzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFNBTEUgQ0FTSCBUUkFOU0FDVElPTiBJRCBVUERBVEUgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihzYWxlSWQ6IHN0cmluZywgY2FzaFRyYW5zYWN0aW9uSWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5zYWxlLnVwZGF0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkOiBzYWxlSWQgfSxcclxuICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignW3VwZGF0ZVNhbGVDYXNoVHJhbnNhY3Rpb25BY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIEZJTFRFUkVEIFBST0RVQ1RTIEZPUiBFWFBPUlQgKGFsbCBwYWdlcykgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyZWRQcm9kdWN0c0ZvckV4cG9ydEFjdGlvbihcclxuICBicmFuY2hJZDogc3RyaW5nLFxyXG4gIGZpbHRlcnM/OiB7IHNlYXJjaD86IHN0cmluZzsgY2F0ZWdvcnk/OiBzdHJpbmc7IHN0b2NrU3RhdHVzPzogc3RyaW5nIH1cclxuKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZCB9O1xyXG5cclxuICAgIGlmIChmaWx0ZXJzPy5zZWFyY2gpIHtcclxuICAgICAgY29uc3QgcyA9IGZpbHRlcnMuc2VhcmNoO1xyXG4gICAgICB3aGVyZS5PUiA9IFtcclxuICAgICAgICB7IG5hbWU6IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgc2t1OiB7IGNvbnRhaW5zOiBzLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycz8uc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgICB3aGVyZS5zdG9jayA9IDA7XHJcbiAgICB9IGVsc2UgaWYgKGZpbHRlcnM/LnN0b2NrU3RhdHVzID09PSAnaW5TdG9jaycpIHtcclxuICAgICAgd2hlcmUuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW2dldEZpbHRlcmVkUHJvZHVjdHNGb3JFeHBvcnRBY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIwU0FvWHNCLHVNQUFBIn0=
}),
"[project]/src/app/actions/data:bf1c83 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createProductCategoryAction",
    ()=>$$RSC_SERVER_ACTION_8
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"70fdf92ee6bb656be2d437fb23f40f7daa4c0c88c1":"createProductCategoryAction"},"src/app/actions/products.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_8 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("70fdf92ee6bb656be2d437fb23f40f7daa4c0c88c1", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "createProductCategoryAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vcHJvZHVjdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XHJcblxyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RGb3JtRGF0YSwgbWFwRGJQcm9kdWN0VG9Qcm9kdWN0LCBtYXBQcm9kdWN0VG9EYlByb2R1Y3QgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIFdlIGltcGxlbWVudCBzZXJ2ZXIgYWN0aW9ucyBmb3IgdGhlIHByb2R1Y3RzIGhlcmVcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0FjdGlvbih7XHJcbiAgdXNlcklkLFxyXG4gIGJ1c2luZXNzSWQsXHJcbiAgcGFnZSxcclxuICBwYWdlU2l6ZSxcclxuICBzZWFyY2gsXHJcbiAgY2F0ZWdvcnksXHJcbiAgc3RvY2tTdGF0dXMsXHJcbn06IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBidXNpbmVzc0lkOiBzdHJpbmc7XHJcbiAgcGFnZTogbnVtYmVyO1xyXG4gIHBhZ2VTaXplOiBudW1iZXI7XHJcbiAgc2VhcmNoPzogc3RyaW5nO1xyXG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gIHN0b2NrU3RhdHVzPzogJ2luU3RvY2snIHwgJ291dE9mU3RvY2snIHwgJ2xvd1N0b2NrJyB8ICdhbGwnO1xyXG59KSB7XHJcbiAgaWYgKCF1c2VySWQgfHwgIWJ1c2luZXNzSWQpIHJldHVybiB7IHByb2R1Y3RzOiBbXSwgY291bnQ6IDAgfTtcclxuXHJcbiAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuICBjb25zdCB0YWtlID0gcGFnZVNpemU7XHJcblxyXG4gIGxldCB3aGVyZUNsYXVzZTogYW55ID0ge1xyXG4gICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICB9O1xyXG5cclxuICBpZiAoc2VhcmNoKSB7XHJcbiAgICB3aGVyZUNsYXVzZS5PUiA9IFtcclxuICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IGRlc2NyaXB0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IHNrdTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIGlmIChjYXRlZ29yeSkge1xyXG4gICAgd2hlcmVDbGF1c2UuY2F0ZWdvcnkgPSB7IG5hbWU6IGNhdGVnb3J5IH07XHJcbiAgfVxyXG5cclxuICBpZiAoc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSAwO1xyXG4gIH0gZWxzZSBpZiAoc3RvY2tTdGF0dXMgPT09ICdpblN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgfSBlbHNlIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgLy8gSGFuZGxpbmcgbG93U3RvY2sgaXMgY29tcGxleCBiZWNhdXNlIG1pblN0b2NrIGlzIGNvbXBhcmVkIGxvY2FsbHkgb3IgdXNpbmcgZGlyZWN0IFNRTCBpbiBQcmlzbWFcclxuICAgIC8vIEZvciBub3csIHdlIHdpbGwgaGFuZGxlIGl0IHdpdGggUHJpc21hJ3MgcmF3IHF1ZXJ5IG9yIGJ5IGZpbHRlcmluZyBpbiBtZW1vcnkgaWYgbmVjZXNzYXJ5XHJcbiAgICAvLyBGb3J0dW5hdGVseSwgc2luY2UgUFJJU01BIDUuMCwgY29sdW1uIGNvbXBhcmlzb24gc3RpbGwgbmVlZHMgcmF3IHF1ZXJpZXMgb3Igd2UgY2FuIGZldGNoIGFuZCBmaWx0ZXIgaWYgc21hbGxcclxuICAgIC8vIEhlcmUgd2UnbGwgZmV0Y2ggdGhlbSBhbGwgaWYgbG93U3RvY2sgaXMgZW5hYmxlZCwgb3IgYWRkIGEgZ2VuZXJhdGVkIGNvbHVtbi4gXHJcbiAgICAvLyBXZSB3aWxsIGRvIGEgYmFzaWMgZmV0Y2ggYW5kIGZpbHRlciBsYXRlciBpZiBuZWVkZWQuXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Byb2R1Y3RzRGF0YSwgdG90YWxDb3VudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcclxuICAgICAgICBza2lwLFxyXG4gICAgICAgIHRha2UsXHJcbiAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnZGVzYycgfSwgeyBpZDogJ2Rlc2MnIH1dLFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgICAgc3VwcGxpZXI6IHRydWUsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgZGIucHJvZHVjdC5jb3VudCh7IHdoZXJlOiB3aGVyZUNsYXVzZSB9KVxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8gTWFwIHRoZSBQcmlzbWEgcHJvZHVjdCBtb2RlbCBiYWNrIHRvIHRoZSBhcHBsaWNhdGlvbidzIFByb2R1Y3QgdHlwZVxyXG4gICAgbGV0IGZvcm1hdHRlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiB7XHJcbiAgICAgIC8vIEFzc3VtaW5nIG1hcHBpbmcgZXhpc3RzLCB3ZSB3aWxsIG1hcCBpdFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgIG5hbWU6IHAubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICBjYXRlZ29yeTogcC5jYXRlZ29yeT8ubmFtZSB8fCAnVW5jYXRlZ29yaXplZCcsXHJcbiAgICAgICAgcXVhbnRpdHk6IHAuc3RvY2ssXHJcbiAgICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHAuc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgIHN1cHBsaWVyOiBwLnN1cHBsaWVyPy5uYW1lLFxyXG4gICAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICAgIGJhcmNvZGU6IHAuYmFyY29kZSxcclxuICAgICAgICBpdGVtTnVtYmVyOiBwLnNrdSB8fCAnJyxcclxuICAgICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgICBmb3JtYXR0ZWRQcm9kdWN0cyA9IGZvcm1hdHRlZFByb2R1Y3RzLmZpbHRlcigocDogYW55KSA9PiBwLnF1YW50aXR5ID4gMCAmJiBwLnF1YW50aXR5IDw9IHAubWluaW11bVN0b2NrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBwcm9kdWN0czogZm9ybWF0dGVkUHJvZHVjdHMgYXMgYW55W10sIGNvdW50OiB0b3RhbENvdW50IH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgcHJvZHVjdHM6IFtdLCBjb3VudDogMCB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIXVzZXJJZCB8fCAhYnVzaW5lc3NJZCkgcmV0dXJuIFtdO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvZHVjdHNEYXRhID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sIHsgaWQ6ICdkZXNjJyB9XSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgIHN1cHBsaWVyOiB0cnVlLFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogTnVtYmVyKHAuc3RvY2spLFxyXG4gICAgICBjb3N0UHJpY2U6IE51bWJlcihwLmNvc3RQcmljZSksXHJcbiAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHAuc2VsbGluZ1ByaWNlKSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IE51bWJlcihwLm1pblN0b2NrKSxcclxuICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgIH0pKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RzQnlJZHNBY3Rpb24oaWRzOiBzdHJpbmdbXSwgYnVzaW5lc3NJZD86IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0ge1xyXG4gICAgICBpZDogeyBpbjogaWRzIH1cclxuICAgIH07XHJcbiAgICBpZiAoYnVzaW5lc3NJZCkge1xyXG4gICAgICB3aGVyZS5icmFuY2hJZCA9IGJ1c2luZXNzSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcclxuICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHByb2R1Y3RzLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogcC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgc2VsbGluZ1ByaWNlOiBwLnNlbGxpbmdQcmljZSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQsXHJcbiAgICB9KSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGJ5IGlkczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgIC8vIDEuIEdlbmVyYXRlIG5leHQgU0tVL2l0ZW1OdW1iZXIgZm9yIHRoaXMgYnJhbmNoXHJcbiAgICAgIGNvbnN0IGxhc3RQcm9kdWN0ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kRmlyc3Qoe1xyXG4gICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBkYXRhLmJ1c2luZXNzSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiB7IHNrdTogJ2Rlc2MnIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7IHNrdTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbGV0IG5leHRTa3UgPSBcIlBST0QtMDAwMVwiO1xyXG4gICAgICBpZiAobGFzdFByb2R1Y3QgJiYgbGFzdFByb2R1Y3Quc2t1KSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudE51bWJlciA9IHBhcnNlSW50KGxhc3RQcm9kdWN0LnNrdS5yZXBsYWNlKFwiUFJPRC1cIiwgXCJcIikpIHx8IDA7XHJcbiAgICAgICAgbmV4dFNrdSA9IGBQUk9ELSR7KGN1cnJlbnROdW1iZXIgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJyl9YDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMi4gQ3JlYXRlIHRoZSBwcm9kdWN0XHJcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCB0eC5wcm9kdWN0LmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBicmFuY2hJZDogZGF0YS5idXNpbmVzc0lkLFxyXG4gICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IGRhdGEuY2F0ZWdvcnlJZCB8fCBudWxsLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogZGF0YS5zdXBwbGllcklkIHx8IG51bGwsXHJcbiAgICAgICAgICBza3U6IG5leHRTa3UsXHJcbiAgICAgICAgICBiYXJjb2RlOiBkYXRhLmJhcmNvZGUsXHJcbiAgICAgICAgICBpbWFnZTogZGF0YS5pbWFnZVVybCxcclxuICAgICAgICAgIGNvc3RQcmljZTogZGF0YS5jb3N0UHJpY2UgfHwgMCxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogZGF0YS5zZWxsaW5nUHJpY2UgfHwgMCxcclxuICAgICAgICAgIHN0b2NrOiBkYXRhLnF1YW50aXR5IHx8IDAsXHJcbiAgICAgICAgICBtaW5TdG9jazogZGF0YS5taW5pbXVtU3RvY2sgfHwgMCxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXHJcbiAgICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGluaXRpYWwgc3RvY2sgaGlzdG9yeSBpZiBxdWFudGl0eSA+IDBcclxuICAgICAgaWYgKGRhdGEucXVhbnRpdHkgPiAwKSB7XHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICB0eXBlOiAnQ1JFQVRFRCcsXHJcbiAgICAgICAgICAgIG9sZFN0b2NrOiAwLFxyXG4gICAgICAgICAgICBuZXdTdG9jazogZGF0YS5xdWFudGl0eSxcclxuICAgICAgICAgICAgcXVhbnRpdHlDaGFuZ2U6IGRhdGEucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHJlYXNvbjogYFske3Byb2R1Y3QubmFtZX1dIHwgSW5pdGlhbCBzdG9ja2AsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcHJvZHVjdDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcmVzdWx0LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICBjYXRlZ29yeTogcmVzdWx0LmNhdGVnb3J5Py5uYW1lIHx8ICdVbmNhdGVnb3JpemVkJyxcclxuICAgICAgcXVhbnRpdHk6IHJlc3VsdC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiByZXN1bHQuY29zdFByaWNlLFxyXG4gICAgICBzZWxsaW5nUHJpY2U6IHJlc3VsdC5zZWxsaW5nUHJpY2UsXHJcbiAgICAgIHN1cHBsaWVyOiByZXN1bHQuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiByZXN1bHQuaW1hZ2UsXHJcbiAgICAgIGJhcmNvZGU6IHJlc3VsdC5iYXJjb2RlLFxyXG4gICAgICBpdGVtTnVtYmVyOiByZXN1bHQuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHJlc3VsdC5taW5TdG9jayxcclxuICAgICAgY3JlYXRlZEF0OiByZXN1bHQuY3JlYXRlZEF0LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgLy8gMS4gR2V0IGN1cnJlbnQgcHJvZHVjdCBzdGF0ZVxyXG4gICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kVW5pcXVlKHtcclxuICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgIHNlbGVjdDogeyBzdG9jazogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgIC8vIDIuIFBlcmZvcm0gdXBkYXRlXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5wcm9kdWN0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IHVwZGF0ZXMuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkID8gdXBkYXRlcy5jYXRlZ29yeUlkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogdXBkYXRlcy5zdXBwbGllcklkICE9PSB1bmRlZmluZWQgPyB1cGRhdGVzLnN1cHBsaWVySWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBza3U6IHVwZGF0ZXMuaXRlbU51bWJlciB8fCB1cGRhdGVzLnNrdSxcclxuICAgICAgICAgIGJhcmNvZGU6IHVwZGF0ZXMuYmFyY29kZSxcclxuICAgICAgICAgIGltYWdlOiB1cGRhdGVzLmltYWdlVXJsLFxyXG4gICAgICAgICAgY29zdFByaWNlOiB1cGRhdGVzLmNvc3RQcmljZSxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogdXBkYXRlcy5zZWxsaW5nUHJpY2UsXHJcbiAgICAgICAgICBzdG9jazogdXBkYXRlcy5xdWFudGl0eSxcclxuICAgICAgICAgIG1pblN0b2NrOiB1cGRhdGVzLm1pbmltdW1TdG9jayxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGhpc3RvcnkgaWYgcXVhbnRpdHkgY2hhbmdlZFxyXG4gICAgICBpZiAodXBkYXRlcy5xdWFudGl0eSAhPT0gdW5kZWZpbmVkICYmIHVwZGF0ZXMucXVhbnRpdHkgIT09IGN1cnJlbnQuc3RvY2sgJiYgdXBkYXRlcy5jdXN0b21DaGFuZ2VSZWFzb24gIT09ICdza2lwLWhpc3RvcnknKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZVJlYXNvbiA9IHVwZGF0ZXMuY3VzdG9tQ2hhbmdlUmVhc29uO1xyXG4gICAgICAgIGlmICghY2hhbmdlUmVhc29uKSB7XHJcbiAgICAgICAgICBpZiAodXBkYXRlcy5pc0Zyb21TYWxlKSBjaGFuZ2VSZWFzb24gPSBcIlNhbGVcIjtcclxuICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZXMucXVhbnRpdHkgPiBjdXJyZW50LnN0b2NrKSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayBhZGRpdGlvblwiO1xyXG4gICAgICAgICAgZWxzZSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayByZWR1Y3Rpb25cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNuYXBzaG90dGVkUmVhc29uID0gYFske3VwZGF0ZWQubmFtZX1dIHwgJHtjaGFuZ2VSZWFzb259YDtcclxuXHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiB1cGRhdGVzLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiB1cGRhdGVkLmlkLFxyXG4gICAgICAgICAgICB0eXBlOiB1cGRhdGVzLmlzRnJvbVNhbGUgPyAnU0FMRScgOiAodXBkYXRlcy5xdWFudGl0eSA+IGN1cnJlbnQuc3RvY2sgPyAnUkVTVE9DSycgOiAnQURKVVNUTUVOVCcpLFxyXG4gICAgICAgICAgICBvbGRTdG9jazogY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgbmV3U3RvY2s6IHVwZGF0ZXMucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHF1YW50aXR5Q2hhbmdlOiB1cGRhdGVzLnF1YW50aXR5IC0gY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgcmVhc29uOiBzbmFwc2hvdHRlZFJlYXNvbixcclxuICAgICAgICAgICAgcmVmZXJlbmNlSWQ6IHVwZGF0ZXMucmVmZXJlbmNlSWQgfHwgbnVsbCxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3RBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5wcm9kdWN0LmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgIH0pO1xyXG4gICAgLy8gcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnkvcHJvZHVjdHMnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0c0J1bGtBY3Rpb24oXHJcbiAgdXBkYXRlczogQXJyYXk8eyBpZDogc3RyaW5nOyB1cGRhdGVkOiBQYXJ0aWFsPGFueT4gfT4sXHJcbiAgYnVzaW5lc3NJZDogc3RyaW5nXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBQcmlzbWEgdHJhbnNhY3Rpb24gZm9yIGJ1bGsgdXBkYXRlc1xyXG4gICAgY29uc3QgdXBkYXRlUHJvbWlzZXMgPSB1cGRhdGVzLm1hcCh1ID0+XHJcbiAgICAgIGRiLnByb2R1Y3QudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogdS5pZCB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQubmFtZSAmJiB7IG5hbWU6IHUudXBkYXRlZC5uYW1lIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmIHsgZGVzY3JpcHRpb246IHUudXBkYXRlZC5kZXNjcmlwdGlvbiB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkICYmIHsgY2F0ZWdvcnlJZDogdS51cGRhdGVkLmNhdGVnb3J5SWQgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLnN1cHBsaWVySWQgIT09IHVuZGVmaW5lZCAmJiB7IHN1cHBsaWVySWQ6IHUudXBkYXRlZC5zdXBwbGllcklkIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5za3UgIT09IHVuZGVmaW5lZCAmJiB7IHNrdTogdS51cGRhdGVkLnNrdSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuYmFyY29kZSAhPT0gdW5kZWZpbmVkICYmIHsgYmFyY29kZTogdS51cGRhdGVkLmJhcmNvZGUgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLmNvc3RQcmljZSAhPT0gdW5kZWZpbmVkICYmIHsgY29zdFByaWNlOiB1LnVwZGF0ZWQuY29zdFByaWNlIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5zZWxsaW5nUHJpY2UgIT09IHVuZGVmaW5lZCAmJiB7IHNlbGxpbmdQcmljZTogdS51cGRhdGVkLnNlbGxpbmdQcmljZSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQucXVhbnRpdHkgIT09IHVuZGVmaW5lZCAmJiB7IHN0b2NrOiB1LnVwZGF0ZWQucXVhbnRpdHkgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLm1pbmltdW1TdG9jayAhPT0gdW5kZWZpbmVkICYmIHsgbWluU3RvY2s6IHUudXBkYXRlZC5taW5pbXVtU3RvY2sgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBkYi4kdHJhbnNhY3Rpb24odXBkYXRlUHJvbWlzZXMpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBlcmZvcm1pbmcgYnVsayB1cGRhdGU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFBST0RVQ1QgQ0FURUdPUklFUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0Q2F0ZWdvcmllc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLmNhdGVnb3J5LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiBjYXRlZ29yaWVzLm1hcCgoYzogYW55KSA9PiAoe1xyXG4gICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICBjcmVhdGVkX2F0OiBjLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KSlcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9kdWN0Q2F0ZWdvcnlBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgZGIuY2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgIHVzZXJJZCxcclxuICAgICAgICBuYW1lXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yeSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhdGVnb3J5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3RDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5jYXRlZ29yeS51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBkYXRhOiB7IG5hbWUgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHJvZHVjdENhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gQ2hlY2sgaWYgYW55IHByb2R1Y3RzIGFyZSB1c2luZyB0aGlzIGNhdGVnb3J5XHJcbiAgICBjb25zdCB1c2FnZUNvdW50ID0gYXdhaXQgZGIucHJvZHVjdC5jb3VudCh7XHJcbiAgICAgIHdoZXJlOiB7IGNhdGVnb3J5SWQ6IGlkIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh1c2FnZUNvdW50ID4gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBjYXRlZ29yeTogaXQgaXMgYmVpbmcgdXNlZCBieSBvbmUgb3IgbW9yZSBwcm9kdWN0cy4nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZGIuY2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIC0tLSBQUk9EVUNUIFNUQVRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RTdGF0c0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIWJ1c2luZXNzSWQpIHJldHVybiB7IGNvc3RWYWx1ZTogMCwgbG93U3RvY2s6IDAsIG91dE9mU3RvY2s6IDAsIHN0b2NrVmFsdWU6IDAgfTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgIHN0b2NrOiB0cnVlLFxyXG4gICAgICAgIGNvc3RQcmljZTogdHJ1ZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb3N0VmFsdWUgPSAwO1xyXG4gICAgbGV0IGxvd1N0b2NrID0gMDtcclxuICAgIGxldCBvdXRPZlN0b2NrID0gMDtcclxuICAgIGxldCBzdG9ja1ZhbHVlID0gMDtcclxuXHJcbiAgICBwcm9kdWN0cy5mb3JFYWNoKChwOiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgcXR5ID0gTnVtYmVyKHAuc3RvY2spIHx8IDA7XHJcbiAgICAgIGNvbnN0IGNvc3QgPSBOdW1iZXIocC5jb3N0UHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IHNlbGxpbmcgPSBOdW1iZXIocC5zZWxsaW5nUHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IG1pblN0b2NrID0gTnVtYmVyKHAubWluU3RvY2spIHx8IDA7XHJcblxyXG4gICAgICBjb3N0VmFsdWUgKz0gY29zdCAqIHF0eTtcclxuICAgICAgc3RvY2tWYWx1ZSArPSBzZWxsaW5nICogcXR5O1xyXG5cclxuICAgICAgaWYgKHF0eSA9PT0gMCkge1xyXG4gICAgICAgIG91dE9mU3RvY2srKztcclxuICAgICAgfSBlbHNlIGlmIChxdHkgPiAwICYmIHF0eSA8PSBtaW5TdG9jaykge1xyXG4gICAgICAgIGxvd1N0b2NrKys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IGNvc3RWYWx1ZSwgbG93U3RvY2ssIG91dE9mU3RvY2ssIHN0b2NrVmFsdWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdCBzdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBjb3N0VmFsdWU6IDAsIGxvd1N0b2NrOiAwLCBvdXRPZlN0b2NrOiAwLCBzdG9ja1ZhbHVlOiAwIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBMT09LVVAgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbihjb2RlOiBzdHJpbmcsIGJyYW5jaElkOiBzdHJpbmcpIHtcclxuICBpZiAoIWNvZGUgfHwgIWJyYW5jaElkKSByZXR1cm4gbnVsbDtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbG93ZXJDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICBPUjogW1xyXG4gICAgICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBsb3dlckNvZGUsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgICAgeyBza3U6IHsgY29udGFpbnM6IGxvd2VyQ29kZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcm9kdWN0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBTQ0FOTkVSIChhbGwgcHJvZHVjdHMgZm9yIHNjYW5uZXIgcHJlbG9hZCkgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbihicmFuY2hJZDogc3RyaW5nKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBicmFuY2hJZCB9LFxyXG4gICAgICBzZWxlY3Q6IHtcclxuICAgICAgICBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYmFyY29kZTogdHJ1ZSwgc2t1OiB0cnVlLFxyXG4gICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSwgY29zdFByaWNlOiB0cnVlLCBzdG9jazogdHJ1ZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdHJ1ZSwgY2F0ZWdvcnlJZDogdHJ1ZSwgYnJhbmNoSWQ6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsIGltYWdlVXJsOiB0cnVlLCBjcmVhdGVkQXQ6IHRydWUsIHVwZGF0ZWRBdDogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb2R1Y3RzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFNBTEUgQ0FTSCBUUkFOU0FDVElPTiBJRCBVUERBVEUgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihzYWxlSWQ6IHN0cmluZywgY2FzaFRyYW5zYWN0aW9uSWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5zYWxlLnVwZGF0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkOiBzYWxlSWQgfSxcclxuICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignW3VwZGF0ZVNhbGVDYXNoVHJhbnNhY3Rpb25BY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIEZJTFRFUkVEIFBST0RVQ1RTIEZPUiBFWFBPUlQgKGFsbCBwYWdlcykgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyZWRQcm9kdWN0c0ZvckV4cG9ydEFjdGlvbihcclxuICBicmFuY2hJZDogc3RyaW5nLFxyXG4gIGZpbHRlcnM/OiB7IHNlYXJjaD86IHN0cmluZzsgY2F0ZWdvcnk/OiBzdHJpbmc7IHN0b2NrU3RhdHVzPzogc3RyaW5nIH1cclxuKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZCB9O1xyXG5cclxuICAgIGlmIChmaWx0ZXJzPy5zZWFyY2gpIHtcclxuICAgICAgY29uc3QgcyA9IGZpbHRlcnMuc2VhcmNoO1xyXG4gICAgICB3aGVyZS5PUiA9IFtcclxuICAgICAgICB7IG5hbWU6IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgc2t1OiB7IGNvbnRhaW5zOiBzLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycz8uc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgICB3aGVyZS5zdG9jayA9IDA7XHJcbiAgICB9IGVsc2UgaWYgKGZpbHRlcnM/LnN0b2NrU3RhdHVzID09PSAnaW5TdG9jaycpIHtcclxuICAgICAgd2hlcmUuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW2dldEZpbHRlcmVkUHJvZHVjdHNGb3JFeHBvcnRBY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIyU0F5WXNCLHdNQUFBIn0=
}),
"[project]/src/app/actions/data:572dd5 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "updateProductCategoryAction",
    ()=>$$RSC_SERVER_ACTION_9
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"60c24e83b6be5d002fb79164133677812fae403d94":"updateProductCategoryAction"},"src/app/actions/products.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_9 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("60c24e83b6be5d002fb79164133677812fae403d94", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "updateProductCategoryAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vcHJvZHVjdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XHJcblxyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RGb3JtRGF0YSwgbWFwRGJQcm9kdWN0VG9Qcm9kdWN0LCBtYXBQcm9kdWN0VG9EYlByb2R1Y3QgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIFdlIGltcGxlbWVudCBzZXJ2ZXIgYWN0aW9ucyBmb3IgdGhlIHByb2R1Y3RzIGhlcmVcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0FjdGlvbih7XHJcbiAgdXNlcklkLFxyXG4gIGJ1c2luZXNzSWQsXHJcbiAgcGFnZSxcclxuICBwYWdlU2l6ZSxcclxuICBzZWFyY2gsXHJcbiAgY2F0ZWdvcnksXHJcbiAgc3RvY2tTdGF0dXMsXHJcbn06IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBidXNpbmVzc0lkOiBzdHJpbmc7XHJcbiAgcGFnZTogbnVtYmVyO1xyXG4gIHBhZ2VTaXplOiBudW1iZXI7XHJcbiAgc2VhcmNoPzogc3RyaW5nO1xyXG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gIHN0b2NrU3RhdHVzPzogJ2luU3RvY2snIHwgJ291dE9mU3RvY2snIHwgJ2xvd1N0b2NrJyB8ICdhbGwnO1xyXG59KSB7XHJcbiAgaWYgKCF1c2VySWQgfHwgIWJ1c2luZXNzSWQpIHJldHVybiB7IHByb2R1Y3RzOiBbXSwgY291bnQ6IDAgfTtcclxuXHJcbiAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuICBjb25zdCB0YWtlID0gcGFnZVNpemU7XHJcblxyXG4gIGxldCB3aGVyZUNsYXVzZTogYW55ID0ge1xyXG4gICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICB9O1xyXG5cclxuICBpZiAoc2VhcmNoKSB7XHJcbiAgICB3aGVyZUNsYXVzZS5PUiA9IFtcclxuICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IGRlc2NyaXB0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IHNrdTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIGlmIChjYXRlZ29yeSkge1xyXG4gICAgd2hlcmVDbGF1c2UuY2F0ZWdvcnkgPSB7IG5hbWU6IGNhdGVnb3J5IH07XHJcbiAgfVxyXG5cclxuICBpZiAoc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSAwO1xyXG4gIH0gZWxzZSBpZiAoc3RvY2tTdGF0dXMgPT09ICdpblN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgfSBlbHNlIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgLy8gSGFuZGxpbmcgbG93U3RvY2sgaXMgY29tcGxleCBiZWNhdXNlIG1pblN0b2NrIGlzIGNvbXBhcmVkIGxvY2FsbHkgb3IgdXNpbmcgZGlyZWN0IFNRTCBpbiBQcmlzbWFcclxuICAgIC8vIEZvciBub3csIHdlIHdpbGwgaGFuZGxlIGl0IHdpdGggUHJpc21hJ3MgcmF3IHF1ZXJ5IG9yIGJ5IGZpbHRlcmluZyBpbiBtZW1vcnkgaWYgbmVjZXNzYXJ5XHJcbiAgICAvLyBGb3J0dW5hdGVseSwgc2luY2UgUFJJU01BIDUuMCwgY29sdW1uIGNvbXBhcmlzb24gc3RpbGwgbmVlZHMgcmF3IHF1ZXJpZXMgb3Igd2UgY2FuIGZldGNoIGFuZCBmaWx0ZXIgaWYgc21hbGxcclxuICAgIC8vIEhlcmUgd2UnbGwgZmV0Y2ggdGhlbSBhbGwgaWYgbG93U3RvY2sgaXMgZW5hYmxlZCwgb3IgYWRkIGEgZ2VuZXJhdGVkIGNvbHVtbi4gXHJcbiAgICAvLyBXZSB3aWxsIGRvIGEgYmFzaWMgZmV0Y2ggYW5kIGZpbHRlciBsYXRlciBpZiBuZWVkZWQuXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Byb2R1Y3RzRGF0YSwgdG90YWxDb3VudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcclxuICAgICAgICBza2lwLFxyXG4gICAgICAgIHRha2UsXHJcbiAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnZGVzYycgfSwgeyBpZDogJ2Rlc2MnIH1dLFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgICAgc3VwcGxpZXI6IHRydWUsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgZGIucHJvZHVjdC5jb3VudCh7IHdoZXJlOiB3aGVyZUNsYXVzZSB9KVxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8gTWFwIHRoZSBQcmlzbWEgcHJvZHVjdCBtb2RlbCBiYWNrIHRvIHRoZSBhcHBsaWNhdGlvbidzIFByb2R1Y3QgdHlwZVxyXG4gICAgbGV0IGZvcm1hdHRlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiB7XHJcbiAgICAgIC8vIEFzc3VtaW5nIG1hcHBpbmcgZXhpc3RzLCB3ZSB3aWxsIG1hcCBpdFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgIG5hbWU6IHAubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICBjYXRlZ29yeTogcC5jYXRlZ29yeT8ubmFtZSB8fCAnVW5jYXRlZ29yaXplZCcsXHJcbiAgICAgICAgcXVhbnRpdHk6IHAuc3RvY2ssXHJcbiAgICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHAuc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgIHN1cHBsaWVyOiBwLnN1cHBsaWVyPy5uYW1lLFxyXG4gICAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICAgIGJhcmNvZGU6IHAuYmFyY29kZSxcclxuICAgICAgICBpdGVtTnVtYmVyOiBwLnNrdSB8fCAnJyxcclxuICAgICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgICBmb3JtYXR0ZWRQcm9kdWN0cyA9IGZvcm1hdHRlZFByb2R1Y3RzLmZpbHRlcigocDogYW55KSA9PiBwLnF1YW50aXR5ID4gMCAmJiBwLnF1YW50aXR5IDw9IHAubWluaW11bVN0b2NrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBwcm9kdWN0czogZm9ybWF0dGVkUHJvZHVjdHMgYXMgYW55W10sIGNvdW50OiB0b3RhbENvdW50IH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgcHJvZHVjdHM6IFtdLCBjb3VudDogMCB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIXVzZXJJZCB8fCAhYnVzaW5lc3NJZCkgcmV0dXJuIFtdO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvZHVjdHNEYXRhID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sIHsgaWQ6ICdkZXNjJyB9XSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgIHN1cHBsaWVyOiB0cnVlLFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogTnVtYmVyKHAuc3RvY2spLFxyXG4gICAgICBjb3N0UHJpY2U6IE51bWJlcihwLmNvc3RQcmljZSksXHJcbiAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHAuc2VsbGluZ1ByaWNlKSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IE51bWJlcihwLm1pblN0b2NrKSxcclxuICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgIH0pKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RzQnlJZHNBY3Rpb24oaWRzOiBzdHJpbmdbXSwgYnVzaW5lc3NJZD86IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0ge1xyXG4gICAgICBpZDogeyBpbjogaWRzIH1cclxuICAgIH07XHJcbiAgICBpZiAoYnVzaW5lc3NJZCkge1xyXG4gICAgICB3aGVyZS5icmFuY2hJZCA9IGJ1c2luZXNzSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcclxuICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHByb2R1Y3RzLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogcC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgc2VsbGluZ1ByaWNlOiBwLnNlbGxpbmdQcmljZSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQsXHJcbiAgICB9KSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGJ5IGlkczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgIC8vIDEuIEdlbmVyYXRlIG5leHQgU0tVL2l0ZW1OdW1iZXIgZm9yIHRoaXMgYnJhbmNoXHJcbiAgICAgIGNvbnN0IGxhc3RQcm9kdWN0ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kRmlyc3Qoe1xyXG4gICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBkYXRhLmJ1c2luZXNzSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiB7IHNrdTogJ2Rlc2MnIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7IHNrdTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbGV0IG5leHRTa3UgPSBcIlBST0QtMDAwMVwiO1xyXG4gICAgICBpZiAobGFzdFByb2R1Y3QgJiYgbGFzdFByb2R1Y3Quc2t1KSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudE51bWJlciA9IHBhcnNlSW50KGxhc3RQcm9kdWN0LnNrdS5yZXBsYWNlKFwiUFJPRC1cIiwgXCJcIikpIHx8IDA7XHJcbiAgICAgICAgbmV4dFNrdSA9IGBQUk9ELSR7KGN1cnJlbnROdW1iZXIgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJyl9YDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMi4gQ3JlYXRlIHRoZSBwcm9kdWN0XHJcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCB0eC5wcm9kdWN0LmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBicmFuY2hJZDogZGF0YS5idXNpbmVzc0lkLFxyXG4gICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IGRhdGEuY2F0ZWdvcnlJZCB8fCBudWxsLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogZGF0YS5zdXBwbGllcklkIHx8IG51bGwsXHJcbiAgICAgICAgICBza3U6IG5leHRTa3UsXHJcbiAgICAgICAgICBiYXJjb2RlOiBkYXRhLmJhcmNvZGUsXHJcbiAgICAgICAgICBpbWFnZTogZGF0YS5pbWFnZVVybCxcclxuICAgICAgICAgIGNvc3RQcmljZTogZGF0YS5jb3N0UHJpY2UgfHwgMCxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogZGF0YS5zZWxsaW5nUHJpY2UgfHwgMCxcclxuICAgICAgICAgIHN0b2NrOiBkYXRhLnF1YW50aXR5IHx8IDAsXHJcbiAgICAgICAgICBtaW5TdG9jazogZGF0YS5taW5pbXVtU3RvY2sgfHwgMCxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXHJcbiAgICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGluaXRpYWwgc3RvY2sgaGlzdG9yeSBpZiBxdWFudGl0eSA+IDBcclxuICAgICAgaWYgKGRhdGEucXVhbnRpdHkgPiAwKSB7XHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICB0eXBlOiAnQ1JFQVRFRCcsXHJcbiAgICAgICAgICAgIG9sZFN0b2NrOiAwLFxyXG4gICAgICAgICAgICBuZXdTdG9jazogZGF0YS5xdWFudGl0eSxcclxuICAgICAgICAgICAgcXVhbnRpdHlDaGFuZ2U6IGRhdGEucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHJlYXNvbjogYFske3Byb2R1Y3QubmFtZX1dIHwgSW5pdGlhbCBzdG9ja2AsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcHJvZHVjdDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcmVzdWx0LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICBjYXRlZ29yeTogcmVzdWx0LmNhdGVnb3J5Py5uYW1lIHx8ICdVbmNhdGVnb3JpemVkJyxcclxuICAgICAgcXVhbnRpdHk6IHJlc3VsdC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiByZXN1bHQuY29zdFByaWNlLFxyXG4gICAgICBzZWxsaW5nUHJpY2U6IHJlc3VsdC5zZWxsaW5nUHJpY2UsXHJcbiAgICAgIHN1cHBsaWVyOiByZXN1bHQuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiByZXN1bHQuaW1hZ2UsXHJcbiAgICAgIGJhcmNvZGU6IHJlc3VsdC5iYXJjb2RlLFxyXG4gICAgICBpdGVtTnVtYmVyOiByZXN1bHQuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHJlc3VsdC5taW5TdG9jayxcclxuICAgICAgY3JlYXRlZEF0OiByZXN1bHQuY3JlYXRlZEF0LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgLy8gMS4gR2V0IGN1cnJlbnQgcHJvZHVjdCBzdGF0ZVxyXG4gICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kVW5pcXVlKHtcclxuICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgIHNlbGVjdDogeyBzdG9jazogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgIC8vIDIuIFBlcmZvcm0gdXBkYXRlXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5wcm9kdWN0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IHVwZGF0ZXMuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkID8gdXBkYXRlcy5jYXRlZ29yeUlkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogdXBkYXRlcy5zdXBwbGllcklkICE9PSB1bmRlZmluZWQgPyB1cGRhdGVzLnN1cHBsaWVySWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBza3U6IHVwZGF0ZXMuaXRlbU51bWJlciB8fCB1cGRhdGVzLnNrdSxcclxuICAgICAgICAgIGJhcmNvZGU6IHVwZGF0ZXMuYmFyY29kZSxcclxuICAgICAgICAgIGltYWdlOiB1cGRhdGVzLmltYWdlVXJsLFxyXG4gICAgICAgICAgY29zdFByaWNlOiB1cGRhdGVzLmNvc3RQcmljZSxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogdXBkYXRlcy5zZWxsaW5nUHJpY2UsXHJcbiAgICAgICAgICBzdG9jazogdXBkYXRlcy5xdWFudGl0eSxcclxuICAgICAgICAgIG1pblN0b2NrOiB1cGRhdGVzLm1pbmltdW1TdG9jayxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGhpc3RvcnkgaWYgcXVhbnRpdHkgY2hhbmdlZFxyXG4gICAgICBpZiAodXBkYXRlcy5xdWFudGl0eSAhPT0gdW5kZWZpbmVkICYmIHVwZGF0ZXMucXVhbnRpdHkgIT09IGN1cnJlbnQuc3RvY2sgJiYgdXBkYXRlcy5jdXN0b21DaGFuZ2VSZWFzb24gIT09ICdza2lwLWhpc3RvcnknKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZVJlYXNvbiA9IHVwZGF0ZXMuY3VzdG9tQ2hhbmdlUmVhc29uO1xyXG4gICAgICAgIGlmICghY2hhbmdlUmVhc29uKSB7XHJcbiAgICAgICAgICBpZiAodXBkYXRlcy5pc0Zyb21TYWxlKSBjaGFuZ2VSZWFzb24gPSBcIlNhbGVcIjtcclxuICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZXMucXVhbnRpdHkgPiBjdXJyZW50LnN0b2NrKSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayBhZGRpdGlvblwiO1xyXG4gICAgICAgICAgZWxzZSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayByZWR1Y3Rpb25cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNuYXBzaG90dGVkUmVhc29uID0gYFske3VwZGF0ZWQubmFtZX1dIHwgJHtjaGFuZ2VSZWFzb259YDtcclxuXHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiB1cGRhdGVzLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiB1cGRhdGVkLmlkLFxyXG4gICAgICAgICAgICB0eXBlOiB1cGRhdGVzLmlzRnJvbVNhbGUgPyAnU0FMRScgOiAodXBkYXRlcy5xdWFudGl0eSA+IGN1cnJlbnQuc3RvY2sgPyAnUkVTVE9DSycgOiAnQURKVVNUTUVOVCcpLFxyXG4gICAgICAgICAgICBvbGRTdG9jazogY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgbmV3U3RvY2s6IHVwZGF0ZXMucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHF1YW50aXR5Q2hhbmdlOiB1cGRhdGVzLnF1YW50aXR5IC0gY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgcmVhc29uOiBzbmFwc2hvdHRlZFJlYXNvbixcclxuICAgICAgICAgICAgcmVmZXJlbmNlSWQ6IHVwZGF0ZXMucmVmZXJlbmNlSWQgfHwgbnVsbCxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3RBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5wcm9kdWN0LmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgIH0pO1xyXG4gICAgLy8gcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnkvcHJvZHVjdHMnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0c0J1bGtBY3Rpb24oXHJcbiAgdXBkYXRlczogQXJyYXk8eyBpZDogc3RyaW5nOyB1cGRhdGVkOiBQYXJ0aWFsPGFueT4gfT4sXHJcbiAgYnVzaW5lc3NJZDogc3RyaW5nXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBQcmlzbWEgdHJhbnNhY3Rpb24gZm9yIGJ1bGsgdXBkYXRlc1xyXG4gICAgY29uc3QgdXBkYXRlUHJvbWlzZXMgPSB1cGRhdGVzLm1hcCh1ID0+XHJcbiAgICAgIGRiLnByb2R1Y3QudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogdS5pZCB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQubmFtZSAmJiB7IG5hbWU6IHUudXBkYXRlZC5uYW1lIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmIHsgZGVzY3JpcHRpb246IHUudXBkYXRlZC5kZXNjcmlwdGlvbiB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkICYmIHsgY2F0ZWdvcnlJZDogdS51cGRhdGVkLmNhdGVnb3J5SWQgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLnN1cHBsaWVySWQgIT09IHVuZGVmaW5lZCAmJiB7IHN1cHBsaWVySWQ6IHUudXBkYXRlZC5zdXBwbGllcklkIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5za3UgIT09IHVuZGVmaW5lZCAmJiB7IHNrdTogdS51cGRhdGVkLnNrdSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuYmFyY29kZSAhPT0gdW5kZWZpbmVkICYmIHsgYmFyY29kZTogdS51cGRhdGVkLmJhcmNvZGUgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLmNvc3RQcmljZSAhPT0gdW5kZWZpbmVkICYmIHsgY29zdFByaWNlOiB1LnVwZGF0ZWQuY29zdFByaWNlIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5zZWxsaW5nUHJpY2UgIT09IHVuZGVmaW5lZCAmJiB7IHNlbGxpbmdQcmljZTogdS51cGRhdGVkLnNlbGxpbmdQcmljZSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQucXVhbnRpdHkgIT09IHVuZGVmaW5lZCAmJiB7IHN0b2NrOiB1LnVwZGF0ZWQucXVhbnRpdHkgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLm1pbmltdW1TdG9jayAhPT0gdW5kZWZpbmVkICYmIHsgbWluU3RvY2s6IHUudXBkYXRlZC5taW5pbXVtU3RvY2sgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBkYi4kdHJhbnNhY3Rpb24odXBkYXRlUHJvbWlzZXMpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBlcmZvcm1pbmcgYnVsayB1cGRhdGU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFBST0RVQ1QgQ0FURUdPUklFUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0Q2F0ZWdvcmllc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLmNhdGVnb3J5LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiBjYXRlZ29yaWVzLm1hcCgoYzogYW55KSA9PiAoe1xyXG4gICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICBjcmVhdGVkX2F0OiBjLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KSlcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9kdWN0Q2F0ZWdvcnlBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgZGIuY2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgIHVzZXJJZCxcclxuICAgICAgICBuYW1lXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yeSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhdGVnb3J5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3RDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5jYXRlZ29yeS51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBkYXRhOiB7IG5hbWUgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHJvZHVjdENhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gQ2hlY2sgaWYgYW55IHByb2R1Y3RzIGFyZSB1c2luZyB0aGlzIGNhdGVnb3J5XHJcbiAgICBjb25zdCB1c2FnZUNvdW50ID0gYXdhaXQgZGIucHJvZHVjdC5jb3VudCh7XHJcbiAgICAgIHdoZXJlOiB7IGNhdGVnb3J5SWQ6IGlkIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh1c2FnZUNvdW50ID4gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBjYXRlZ29yeTogaXQgaXMgYmVpbmcgdXNlZCBieSBvbmUgb3IgbW9yZSBwcm9kdWN0cy4nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZGIuY2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIC0tLSBQUk9EVUNUIFNUQVRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RTdGF0c0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIWJ1c2luZXNzSWQpIHJldHVybiB7IGNvc3RWYWx1ZTogMCwgbG93U3RvY2s6IDAsIG91dE9mU3RvY2s6IDAsIHN0b2NrVmFsdWU6IDAgfTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgIHN0b2NrOiB0cnVlLFxyXG4gICAgICAgIGNvc3RQcmljZTogdHJ1ZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb3N0VmFsdWUgPSAwO1xyXG4gICAgbGV0IGxvd1N0b2NrID0gMDtcclxuICAgIGxldCBvdXRPZlN0b2NrID0gMDtcclxuICAgIGxldCBzdG9ja1ZhbHVlID0gMDtcclxuXHJcbiAgICBwcm9kdWN0cy5mb3JFYWNoKChwOiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgcXR5ID0gTnVtYmVyKHAuc3RvY2spIHx8IDA7XHJcbiAgICAgIGNvbnN0IGNvc3QgPSBOdW1iZXIocC5jb3N0UHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IHNlbGxpbmcgPSBOdW1iZXIocC5zZWxsaW5nUHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IG1pblN0b2NrID0gTnVtYmVyKHAubWluU3RvY2spIHx8IDA7XHJcblxyXG4gICAgICBjb3N0VmFsdWUgKz0gY29zdCAqIHF0eTtcclxuICAgICAgc3RvY2tWYWx1ZSArPSBzZWxsaW5nICogcXR5O1xyXG5cclxuICAgICAgaWYgKHF0eSA9PT0gMCkge1xyXG4gICAgICAgIG91dE9mU3RvY2srKztcclxuICAgICAgfSBlbHNlIGlmIChxdHkgPiAwICYmIHF0eSA8PSBtaW5TdG9jaykge1xyXG4gICAgICAgIGxvd1N0b2NrKys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IGNvc3RWYWx1ZSwgbG93U3RvY2ssIG91dE9mU3RvY2ssIHN0b2NrVmFsdWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdCBzdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBjb3N0VmFsdWU6IDAsIGxvd1N0b2NrOiAwLCBvdXRPZlN0b2NrOiAwLCBzdG9ja1ZhbHVlOiAwIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBMT09LVVAgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbihjb2RlOiBzdHJpbmcsIGJyYW5jaElkOiBzdHJpbmcpIHtcclxuICBpZiAoIWNvZGUgfHwgIWJyYW5jaElkKSByZXR1cm4gbnVsbDtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbG93ZXJDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICBPUjogW1xyXG4gICAgICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBsb3dlckNvZGUsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgICAgeyBza3U6IHsgY29udGFpbnM6IGxvd2VyQ29kZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcm9kdWN0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBTQ0FOTkVSIChhbGwgcHJvZHVjdHMgZm9yIHNjYW5uZXIgcHJlbG9hZCkgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbihicmFuY2hJZDogc3RyaW5nKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBicmFuY2hJZCB9LFxyXG4gICAgICBzZWxlY3Q6IHtcclxuICAgICAgICBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYmFyY29kZTogdHJ1ZSwgc2t1OiB0cnVlLFxyXG4gICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSwgY29zdFByaWNlOiB0cnVlLCBzdG9jazogdHJ1ZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdHJ1ZSwgY2F0ZWdvcnlJZDogdHJ1ZSwgYnJhbmNoSWQ6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsIGltYWdlVXJsOiB0cnVlLCBjcmVhdGVkQXQ6IHRydWUsIHVwZGF0ZWRBdDogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb2R1Y3RzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFNBTEUgQ0FTSCBUUkFOU0FDVElPTiBJRCBVUERBVEUgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihzYWxlSWQ6IHN0cmluZywgY2FzaFRyYW5zYWN0aW9uSWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5zYWxlLnVwZGF0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkOiBzYWxlSWQgfSxcclxuICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignW3VwZGF0ZVNhbGVDYXNoVHJhbnNhY3Rpb25BY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIEZJTFRFUkVEIFBST0RVQ1RTIEZPUiBFWFBPUlQgKGFsbCBwYWdlcykgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyZWRQcm9kdWN0c0ZvckV4cG9ydEFjdGlvbihcclxuICBicmFuY2hJZDogc3RyaW5nLFxyXG4gIGZpbHRlcnM/OiB7IHNlYXJjaD86IHN0cmluZzsgY2F0ZWdvcnk/OiBzdHJpbmc7IHN0b2NrU3RhdHVzPzogc3RyaW5nIH1cclxuKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZCB9O1xyXG5cclxuICAgIGlmIChmaWx0ZXJzPy5zZWFyY2gpIHtcclxuICAgICAgY29uc3QgcyA9IGZpbHRlcnMuc2VhcmNoO1xyXG4gICAgICB3aGVyZS5PUiA9IFtcclxuICAgICAgICB7IG5hbWU6IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgc2t1OiB7IGNvbnRhaW5zOiBzLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycz8uc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgICB3aGVyZS5zdG9jayA9IDA7XHJcbiAgICB9IGVsc2UgaWYgKGZpbHRlcnM/LnN0b2NrU3RhdHVzID09PSAnaW5TdG9jaycpIHtcclxuICAgICAgd2hlcmUuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW2dldEZpbHRlcmVkUHJvZHVjdHNGb3JFeHBvcnRBY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIyU0EyWnNCLHdNQUFBIn0=
}),
"[project]/src/app/actions/data:cf2dfc [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "deleteProductCategoryAction",
    ()=>$$RSC_SERVER_ACTION_10
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"4034881b33ece4d2c3bb0e25c4e68c3715e705d9ab":"deleteProductCategoryAction"},"src/app/actions/products.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_10 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("4034881b33ece4d2c3bb0e25c4e68c3715e705d9ab", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "deleteProductCategoryAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vcHJvZHVjdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XHJcblxyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RGb3JtRGF0YSwgbWFwRGJQcm9kdWN0VG9Qcm9kdWN0LCBtYXBQcm9kdWN0VG9EYlByb2R1Y3QgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIFdlIGltcGxlbWVudCBzZXJ2ZXIgYWN0aW9ucyBmb3IgdGhlIHByb2R1Y3RzIGhlcmVcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0FjdGlvbih7XHJcbiAgdXNlcklkLFxyXG4gIGJ1c2luZXNzSWQsXHJcbiAgcGFnZSxcclxuICBwYWdlU2l6ZSxcclxuICBzZWFyY2gsXHJcbiAgY2F0ZWdvcnksXHJcbiAgc3RvY2tTdGF0dXMsXHJcbn06IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBidXNpbmVzc0lkOiBzdHJpbmc7XHJcbiAgcGFnZTogbnVtYmVyO1xyXG4gIHBhZ2VTaXplOiBudW1iZXI7XHJcbiAgc2VhcmNoPzogc3RyaW5nO1xyXG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gIHN0b2NrU3RhdHVzPzogJ2luU3RvY2snIHwgJ291dE9mU3RvY2snIHwgJ2xvd1N0b2NrJyB8ICdhbGwnO1xyXG59KSB7XHJcbiAgaWYgKCF1c2VySWQgfHwgIWJ1c2luZXNzSWQpIHJldHVybiB7IHByb2R1Y3RzOiBbXSwgY291bnQ6IDAgfTtcclxuXHJcbiAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuICBjb25zdCB0YWtlID0gcGFnZVNpemU7XHJcblxyXG4gIGxldCB3aGVyZUNsYXVzZTogYW55ID0ge1xyXG4gICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICB9O1xyXG5cclxuICBpZiAoc2VhcmNoKSB7XHJcbiAgICB3aGVyZUNsYXVzZS5PUiA9IFtcclxuICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IGRlc2NyaXB0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IHNrdTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIGlmIChjYXRlZ29yeSkge1xyXG4gICAgd2hlcmVDbGF1c2UuY2F0ZWdvcnkgPSB7IG5hbWU6IGNhdGVnb3J5IH07XHJcbiAgfVxyXG5cclxuICBpZiAoc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSAwO1xyXG4gIH0gZWxzZSBpZiAoc3RvY2tTdGF0dXMgPT09ICdpblN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgfSBlbHNlIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgLy8gSGFuZGxpbmcgbG93U3RvY2sgaXMgY29tcGxleCBiZWNhdXNlIG1pblN0b2NrIGlzIGNvbXBhcmVkIGxvY2FsbHkgb3IgdXNpbmcgZGlyZWN0IFNRTCBpbiBQcmlzbWFcclxuICAgIC8vIEZvciBub3csIHdlIHdpbGwgaGFuZGxlIGl0IHdpdGggUHJpc21hJ3MgcmF3IHF1ZXJ5IG9yIGJ5IGZpbHRlcmluZyBpbiBtZW1vcnkgaWYgbmVjZXNzYXJ5XHJcbiAgICAvLyBGb3J0dW5hdGVseSwgc2luY2UgUFJJU01BIDUuMCwgY29sdW1uIGNvbXBhcmlzb24gc3RpbGwgbmVlZHMgcmF3IHF1ZXJpZXMgb3Igd2UgY2FuIGZldGNoIGFuZCBmaWx0ZXIgaWYgc21hbGxcclxuICAgIC8vIEhlcmUgd2UnbGwgZmV0Y2ggdGhlbSBhbGwgaWYgbG93U3RvY2sgaXMgZW5hYmxlZCwgb3IgYWRkIGEgZ2VuZXJhdGVkIGNvbHVtbi4gXHJcbiAgICAvLyBXZSB3aWxsIGRvIGEgYmFzaWMgZmV0Y2ggYW5kIGZpbHRlciBsYXRlciBpZiBuZWVkZWQuXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Byb2R1Y3RzRGF0YSwgdG90YWxDb3VudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcclxuICAgICAgICBza2lwLFxyXG4gICAgICAgIHRha2UsXHJcbiAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnZGVzYycgfSwgeyBpZDogJ2Rlc2MnIH1dLFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgICAgc3VwcGxpZXI6IHRydWUsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgZGIucHJvZHVjdC5jb3VudCh7IHdoZXJlOiB3aGVyZUNsYXVzZSB9KVxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8gTWFwIHRoZSBQcmlzbWEgcHJvZHVjdCBtb2RlbCBiYWNrIHRvIHRoZSBhcHBsaWNhdGlvbidzIFByb2R1Y3QgdHlwZVxyXG4gICAgbGV0IGZvcm1hdHRlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiB7XHJcbiAgICAgIC8vIEFzc3VtaW5nIG1hcHBpbmcgZXhpc3RzLCB3ZSB3aWxsIG1hcCBpdFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgIG5hbWU6IHAubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICBjYXRlZ29yeTogcC5jYXRlZ29yeT8ubmFtZSB8fCAnVW5jYXRlZ29yaXplZCcsXHJcbiAgICAgICAgcXVhbnRpdHk6IHAuc3RvY2ssXHJcbiAgICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHAuc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgIHN1cHBsaWVyOiBwLnN1cHBsaWVyPy5uYW1lLFxyXG4gICAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICAgIGJhcmNvZGU6IHAuYmFyY29kZSxcclxuICAgICAgICBpdGVtTnVtYmVyOiBwLnNrdSB8fCAnJyxcclxuICAgICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgICBmb3JtYXR0ZWRQcm9kdWN0cyA9IGZvcm1hdHRlZFByb2R1Y3RzLmZpbHRlcigocDogYW55KSA9PiBwLnF1YW50aXR5ID4gMCAmJiBwLnF1YW50aXR5IDw9IHAubWluaW11bVN0b2NrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBwcm9kdWN0czogZm9ybWF0dGVkUHJvZHVjdHMgYXMgYW55W10sIGNvdW50OiB0b3RhbENvdW50IH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgcHJvZHVjdHM6IFtdLCBjb3VudDogMCB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIXVzZXJJZCB8fCAhYnVzaW5lc3NJZCkgcmV0dXJuIFtdO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvZHVjdHNEYXRhID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sIHsgaWQ6ICdkZXNjJyB9XSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgIHN1cHBsaWVyOiB0cnVlLFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogTnVtYmVyKHAuc3RvY2spLFxyXG4gICAgICBjb3N0UHJpY2U6IE51bWJlcihwLmNvc3RQcmljZSksXHJcbiAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHAuc2VsbGluZ1ByaWNlKSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IE51bWJlcihwLm1pblN0b2NrKSxcclxuICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgIH0pKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RzQnlJZHNBY3Rpb24oaWRzOiBzdHJpbmdbXSwgYnVzaW5lc3NJZD86IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0ge1xyXG4gICAgICBpZDogeyBpbjogaWRzIH1cclxuICAgIH07XHJcbiAgICBpZiAoYnVzaW5lc3NJZCkge1xyXG4gICAgICB3aGVyZS5icmFuY2hJZCA9IGJ1c2luZXNzSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcclxuICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHByb2R1Y3RzLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogcC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgc2VsbGluZ1ByaWNlOiBwLnNlbGxpbmdQcmljZSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQsXHJcbiAgICB9KSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGJ5IGlkczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgIC8vIDEuIEdlbmVyYXRlIG5leHQgU0tVL2l0ZW1OdW1iZXIgZm9yIHRoaXMgYnJhbmNoXHJcbiAgICAgIGNvbnN0IGxhc3RQcm9kdWN0ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kRmlyc3Qoe1xyXG4gICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBkYXRhLmJ1c2luZXNzSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiB7IHNrdTogJ2Rlc2MnIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7IHNrdTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbGV0IG5leHRTa3UgPSBcIlBST0QtMDAwMVwiO1xyXG4gICAgICBpZiAobGFzdFByb2R1Y3QgJiYgbGFzdFByb2R1Y3Quc2t1KSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudE51bWJlciA9IHBhcnNlSW50KGxhc3RQcm9kdWN0LnNrdS5yZXBsYWNlKFwiUFJPRC1cIiwgXCJcIikpIHx8IDA7XHJcbiAgICAgICAgbmV4dFNrdSA9IGBQUk9ELSR7KGN1cnJlbnROdW1iZXIgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJyl9YDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMi4gQ3JlYXRlIHRoZSBwcm9kdWN0XHJcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCB0eC5wcm9kdWN0LmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBicmFuY2hJZDogZGF0YS5idXNpbmVzc0lkLFxyXG4gICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IGRhdGEuY2F0ZWdvcnlJZCB8fCBudWxsLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogZGF0YS5zdXBwbGllcklkIHx8IG51bGwsXHJcbiAgICAgICAgICBza3U6IG5leHRTa3UsXHJcbiAgICAgICAgICBiYXJjb2RlOiBkYXRhLmJhcmNvZGUsXHJcbiAgICAgICAgICBpbWFnZTogZGF0YS5pbWFnZVVybCxcclxuICAgICAgICAgIGNvc3RQcmljZTogZGF0YS5jb3N0UHJpY2UgfHwgMCxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogZGF0YS5zZWxsaW5nUHJpY2UgfHwgMCxcclxuICAgICAgICAgIHN0b2NrOiBkYXRhLnF1YW50aXR5IHx8IDAsXHJcbiAgICAgICAgICBtaW5TdG9jazogZGF0YS5taW5pbXVtU3RvY2sgfHwgMCxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXHJcbiAgICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGluaXRpYWwgc3RvY2sgaGlzdG9yeSBpZiBxdWFudGl0eSA+IDBcclxuICAgICAgaWYgKGRhdGEucXVhbnRpdHkgPiAwKSB7XHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICB0eXBlOiAnQ1JFQVRFRCcsXHJcbiAgICAgICAgICAgIG9sZFN0b2NrOiAwLFxyXG4gICAgICAgICAgICBuZXdTdG9jazogZGF0YS5xdWFudGl0eSxcclxuICAgICAgICAgICAgcXVhbnRpdHlDaGFuZ2U6IGRhdGEucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHJlYXNvbjogYFske3Byb2R1Y3QubmFtZX1dIHwgSW5pdGlhbCBzdG9ja2AsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcHJvZHVjdDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcmVzdWx0LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICBjYXRlZ29yeTogcmVzdWx0LmNhdGVnb3J5Py5uYW1lIHx8ICdVbmNhdGVnb3JpemVkJyxcclxuICAgICAgcXVhbnRpdHk6IHJlc3VsdC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiByZXN1bHQuY29zdFByaWNlLFxyXG4gICAgICBzZWxsaW5nUHJpY2U6IHJlc3VsdC5zZWxsaW5nUHJpY2UsXHJcbiAgICAgIHN1cHBsaWVyOiByZXN1bHQuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiByZXN1bHQuaW1hZ2UsXHJcbiAgICAgIGJhcmNvZGU6IHJlc3VsdC5iYXJjb2RlLFxyXG4gICAgICBpdGVtTnVtYmVyOiByZXN1bHQuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHJlc3VsdC5taW5TdG9jayxcclxuICAgICAgY3JlYXRlZEF0OiByZXN1bHQuY3JlYXRlZEF0LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgLy8gMS4gR2V0IGN1cnJlbnQgcHJvZHVjdCBzdGF0ZVxyXG4gICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kVW5pcXVlKHtcclxuICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgIHNlbGVjdDogeyBzdG9jazogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgIC8vIDIuIFBlcmZvcm0gdXBkYXRlXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5wcm9kdWN0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IHVwZGF0ZXMuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkID8gdXBkYXRlcy5jYXRlZ29yeUlkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogdXBkYXRlcy5zdXBwbGllcklkICE9PSB1bmRlZmluZWQgPyB1cGRhdGVzLnN1cHBsaWVySWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBza3U6IHVwZGF0ZXMuaXRlbU51bWJlciB8fCB1cGRhdGVzLnNrdSxcclxuICAgICAgICAgIGJhcmNvZGU6IHVwZGF0ZXMuYmFyY29kZSxcclxuICAgICAgICAgIGltYWdlOiB1cGRhdGVzLmltYWdlVXJsLFxyXG4gICAgICAgICAgY29zdFByaWNlOiB1cGRhdGVzLmNvc3RQcmljZSxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogdXBkYXRlcy5zZWxsaW5nUHJpY2UsXHJcbiAgICAgICAgICBzdG9jazogdXBkYXRlcy5xdWFudGl0eSxcclxuICAgICAgICAgIG1pblN0b2NrOiB1cGRhdGVzLm1pbmltdW1TdG9jayxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGhpc3RvcnkgaWYgcXVhbnRpdHkgY2hhbmdlZFxyXG4gICAgICBpZiAodXBkYXRlcy5xdWFudGl0eSAhPT0gdW5kZWZpbmVkICYmIHVwZGF0ZXMucXVhbnRpdHkgIT09IGN1cnJlbnQuc3RvY2sgJiYgdXBkYXRlcy5jdXN0b21DaGFuZ2VSZWFzb24gIT09ICdza2lwLWhpc3RvcnknKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZVJlYXNvbiA9IHVwZGF0ZXMuY3VzdG9tQ2hhbmdlUmVhc29uO1xyXG4gICAgICAgIGlmICghY2hhbmdlUmVhc29uKSB7XHJcbiAgICAgICAgICBpZiAodXBkYXRlcy5pc0Zyb21TYWxlKSBjaGFuZ2VSZWFzb24gPSBcIlNhbGVcIjtcclxuICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZXMucXVhbnRpdHkgPiBjdXJyZW50LnN0b2NrKSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayBhZGRpdGlvblwiO1xyXG4gICAgICAgICAgZWxzZSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayByZWR1Y3Rpb25cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNuYXBzaG90dGVkUmVhc29uID0gYFske3VwZGF0ZWQubmFtZX1dIHwgJHtjaGFuZ2VSZWFzb259YDtcclxuXHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiB1cGRhdGVzLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiB1cGRhdGVkLmlkLFxyXG4gICAgICAgICAgICB0eXBlOiB1cGRhdGVzLmlzRnJvbVNhbGUgPyAnU0FMRScgOiAodXBkYXRlcy5xdWFudGl0eSA+IGN1cnJlbnQuc3RvY2sgPyAnUkVTVE9DSycgOiAnQURKVVNUTUVOVCcpLFxyXG4gICAgICAgICAgICBvbGRTdG9jazogY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgbmV3U3RvY2s6IHVwZGF0ZXMucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHF1YW50aXR5Q2hhbmdlOiB1cGRhdGVzLnF1YW50aXR5IC0gY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgcmVhc29uOiBzbmFwc2hvdHRlZFJlYXNvbixcclxuICAgICAgICAgICAgcmVmZXJlbmNlSWQ6IHVwZGF0ZXMucmVmZXJlbmNlSWQgfHwgbnVsbCxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3RBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5wcm9kdWN0LmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgIH0pO1xyXG4gICAgLy8gcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnkvcHJvZHVjdHMnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0c0J1bGtBY3Rpb24oXHJcbiAgdXBkYXRlczogQXJyYXk8eyBpZDogc3RyaW5nOyB1cGRhdGVkOiBQYXJ0aWFsPGFueT4gfT4sXHJcbiAgYnVzaW5lc3NJZDogc3RyaW5nXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBQcmlzbWEgdHJhbnNhY3Rpb24gZm9yIGJ1bGsgdXBkYXRlc1xyXG4gICAgY29uc3QgdXBkYXRlUHJvbWlzZXMgPSB1cGRhdGVzLm1hcCh1ID0+XHJcbiAgICAgIGRiLnByb2R1Y3QudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogdS5pZCB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQubmFtZSAmJiB7IG5hbWU6IHUudXBkYXRlZC5uYW1lIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmIHsgZGVzY3JpcHRpb246IHUudXBkYXRlZC5kZXNjcmlwdGlvbiB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkICYmIHsgY2F0ZWdvcnlJZDogdS51cGRhdGVkLmNhdGVnb3J5SWQgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLnN1cHBsaWVySWQgIT09IHVuZGVmaW5lZCAmJiB7IHN1cHBsaWVySWQ6IHUudXBkYXRlZC5zdXBwbGllcklkIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5za3UgIT09IHVuZGVmaW5lZCAmJiB7IHNrdTogdS51cGRhdGVkLnNrdSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuYmFyY29kZSAhPT0gdW5kZWZpbmVkICYmIHsgYmFyY29kZTogdS51cGRhdGVkLmJhcmNvZGUgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLmNvc3RQcmljZSAhPT0gdW5kZWZpbmVkICYmIHsgY29zdFByaWNlOiB1LnVwZGF0ZWQuY29zdFByaWNlIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5zZWxsaW5nUHJpY2UgIT09IHVuZGVmaW5lZCAmJiB7IHNlbGxpbmdQcmljZTogdS51cGRhdGVkLnNlbGxpbmdQcmljZSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQucXVhbnRpdHkgIT09IHVuZGVmaW5lZCAmJiB7IHN0b2NrOiB1LnVwZGF0ZWQucXVhbnRpdHkgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLm1pbmltdW1TdG9jayAhPT0gdW5kZWZpbmVkICYmIHsgbWluU3RvY2s6IHUudXBkYXRlZC5taW5pbXVtU3RvY2sgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBkYi4kdHJhbnNhY3Rpb24odXBkYXRlUHJvbWlzZXMpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBlcmZvcm1pbmcgYnVsayB1cGRhdGU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFBST0RVQ1QgQ0FURUdPUklFUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0Q2F0ZWdvcmllc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLmNhdGVnb3J5LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiBjYXRlZ29yaWVzLm1hcCgoYzogYW55KSA9PiAoe1xyXG4gICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICBjcmVhdGVkX2F0OiBjLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KSlcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9kdWN0Q2F0ZWdvcnlBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgZGIuY2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgIHVzZXJJZCxcclxuICAgICAgICBuYW1lXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yeSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhdGVnb3J5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3RDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5jYXRlZ29yeS51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBkYXRhOiB7IG5hbWUgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHJvZHVjdENhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gQ2hlY2sgaWYgYW55IHByb2R1Y3RzIGFyZSB1c2luZyB0aGlzIGNhdGVnb3J5XHJcbiAgICBjb25zdCB1c2FnZUNvdW50ID0gYXdhaXQgZGIucHJvZHVjdC5jb3VudCh7XHJcbiAgICAgIHdoZXJlOiB7IGNhdGVnb3J5SWQ6IGlkIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh1c2FnZUNvdW50ID4gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBjYXRlZ29yeTogaXQgaXMgYmVpbmcgdXNlZCBieSBvbmUgb3IgbW9yZSBwcm9kdWN0cy4nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZGIuY2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIC0tLSBQUk9EVUNUIFNUQVRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RTdGF0c0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIWJ1c2luZXNzSWQpIHJldHVybiB7IGNvc3RWYWx1ZTogMCwgbG93U3RvY2s6IDAsIG91dE9mU3RvY2s6IDAsIHN0b2NrVmFsdWU6IDAgfTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgIHN0b2NrOiB0cnVlLFxyXG4gICAgICAgIGNvc3RQcmljZTogdHJ1ZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb3N0VmFsdWUgPSAwO1xyXG4gICAgbGV0IGxvd1N0b2NrID0gMDtcclxuICAgIGxldCBvdXRPZlN0b2NrID0gMDtcclxuICAgIGxldCBzdG9ja1ZhbHVlID0gMDtcclxuXHJcbiAgICBwcm9kdWN0cy5mb3JFYWNoKChwOiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgcXR5ID0gTnVtYmVyKHAuc3RvY2spIHx8IDA7XHJcbiAgICAgIGNvbnN0IGNvc3QgPSBOdW1iZXIocC5jb3N0UHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IHNlbGxpbmcgPSBOdW1iZXIocC5zZWxsaW5nUHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IG1pblN0b2NrID0gTnVtYmVyKHAubWluU3RvY2spIHx8IDA7XHJcblxyXG4gICAgICBjb3N0VmFsdWUgKz0gY29zdCAqIHF0eTtcclxuICAgICAgc3RvY2tWYWx1ZSArPSBzZWxsaW5nICogcXR5O1xyXG5cclxuICAgICAgaWYgKHF0eSA9PT0gMCkge1xyXG4gICAgICAgIG91dE9mU3RvY2srKztcclxuICAgICAgfSBlbHNlIGlmIChxdHkgPiAwICYmIHF0eSA8PSBtaW5TdG9jaykge1xyXG4gICAgICAgIGxvd1N0b2NrKys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IGNvc3RWYWx1ZSwgbG93U3RvY2ssIG91dE9mU3RvY2ssIHN0b2NrVmFsdWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdCBzdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBjb3N0VmFsdWU6IDAsIGxvd1N0b2NrOiAwLCBvdXRPZlN0b2NrOiAwLCBzdG9ja1ZhbHVlOiAwIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBMT09LVVAgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbihjb2RlOiBzdHJpbmcsIGJyYW5jaElkOiBzdHJpbmcpIHtcclxuICBpZiAoIWNvZGUgfHwgIWJyYW5jaElkKSByZXR1cm4gbnVsbDtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbG93ZXJDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICBPUjogW1xyXG4gICAgICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBsb3dlckNvZGUsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgICAgeyBza3U6IHsgY29udGFpbnM6IGxvd2VyQ29kZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcm9kdWN0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBTQ0FOTkVSIChhbGwgcHJvZHVjdHMgZm9yIHNjYW5uZXIgcHJlbG9hZCkgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbihicmFuY2hJZDogc3RyaW5nKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBicmFuY2hJZCB9LFxyXG4gICAgICBzZWxlY3Q6IHtcclxuICAgICAgICBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYmFyY29kZTogdHJ1ZSwgc2t1OiB0cnVlLFxyXG4gICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSwgY29zdFByaWNlOiB0cnVlLCBzdG9jazogdHJ1ZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdHJ1ZSwgY2F0ZWdvcnlJZDogdHJ1ZSwgYnJhbmNoSWQ6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsIGltYWdlVXJsOiB0cnVlLCBjcmVhdGVkQXQ6IHRydWUsIHVwZGF0ZWRBdDogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb2R1Y3RzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFNBTEUgQ0FTSCBUUkFOU0FDVElPTiBJRCBVUERBVEUgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihzYWxlSWQ6IHN0cmluZywgY2FzaFRyYW5zYWN0aW9uSWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5zYWxlLnVwZGF0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkOiBzYWxlSWQgfSxcclxuICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignW3VwZGF0ZVNhbGVDYXNoVHJhbnNhY3Rpb25BY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIEZJTFRFUkVEIFBST0RVQ1RTIEZPUiBFWFBPUlQgKGFsbCBwYWdlcykgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyZWRQcm9kdWN0c0ZvckV4cG9ydEFjdGlvbihcclxuICBicmFuY2hJZDogc3RyaW5nLFxyXG4gIGZpbHRlcnM/OiB7IHNlYXJjaD86IHN0cmluZzsgY2F0ZWdvcnk/OiBzdHJpbmc7IHN0b2NrU3RhdHVzPzogc3RyaW5nIH1cclxuKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZCB9O1xyXG5cclxuICAgIGlmIChmaWx0ZXJzPy5zZWFyY2gpIHtcclxuICAgICAgY29uc3QgcyA9IGZpbHRlcnMuc2VhcmNoO1xyXG4gICAgICB3aGVyZS5PUiA9IFtcclxuICAgICAgICB7IG5hbWU6IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgc2t1OiB7IGNvbnRhaW5zOiBzLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycz8uc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgICB3aGVyZS5zdG9jayA9IDA7XHJcbiAgICB9IGVsc2UgaWYgKGZpbHRlcnM/LnN0b2NrU3RhdHVzID09PSAnaW5TdG9jaycpIHtcclxuICAgICAgd2hlcmUuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW2dldEZpbHRlcmVkUHJvZHVjdHNGb3JFeHBvcnRBY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIyU0EwYXNCLDBNQUFBIn0=
}),
"[project]/src/app/actions/data:98f618 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getStockHistoryAction",
    ()=>$$RSC_SERVER_ACTION_0
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"600857ecf6299f015defc0184c1ff16628fa38538c":"getStockHistoryAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_0 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("600857ecf6299f015defc0184c1ff16628fa38538c", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getStockHistoryAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoic1NBT3NCLGtNQUFBIn0=
}),
"[project]/src/app/actions/data:cd63f5 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createStockHistoryAction",
    ()=>$$RSC_SERVER_ACTION_1
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"4087f77070d72c1160296631642063d84397e184d9":"createStockHistoryAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_1 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("4087f77070d72c1160296631642063d84397e184d9", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "createStockHistoryAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoieVNBb0RzQixxTUFBQSJ9
}),
"[project]/src/app/actions/data:fce372 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "recalculateStockChainAction",
    ()=>$$RSC_SERVER_ACTION_2
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"60f90d7549882485fed7a54035a4162448a711ca11":"recalculateStockChainAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_2 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("60f90d7549882485fed7a54035a4162448a711ca11", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "recalculateStockChainAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiNFNBc0ZzQix3TUFBQSJ9
}),
"[project]/src/app/actions/data:22803a [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "deleteStockHistoryEntriesByReferenceAction",
    ()=>$$RSC_SERVER_ACTION_3
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"607241ec6de7cf4ac80578c30a3a4bc051ec9a9cae":"deleteStockHistoryEntriesByReferenceAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_3 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("607241ec6de7cf4ac80578c30a3a4bc051ec9a9cae", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "deleteStockHistoryEntriesByReferenceAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiMlRBc0lzQix1TkFBQSJ9
}),
"[project]/src/app/actions/data:82ad24 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "updateStockHistoryDatesByReferenceAction",
    ()=>$$RSC_SERVER_ACTION_4
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"7083475c4a77fdc0d468e38b20907db3bcf79e040f":"updateStockHistoryDatesByReferenceAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_4 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("7083475c4a77fdc0d468e38b20907db3bcf79e040f", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "updateStockHistoryDatesByReferenceAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoieVRBb0tzQixxTkFBQSJ9
}),
"[project]/src/app/actions/data:2e5734 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "repairStockChainsAction",
    ()=>$$RSC_SERVER_ACTION_12
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"608cb60a1da7b007825f807be3e16906d959f678c7":"repairStockChainsAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_12 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("608cb60a1da7b007825f807be3e16906d959f678c7", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "repairStockChainsAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoid1NBMGtCc0Isc01BQUEifQ==
}),
"[project]/src/app/actions/data:1ee1ea [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getStockRepairsPreviewAction",
    ()=>$$RSC_SERVER_ACTION_11
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"403d03ebd9e84dcdccfe86665d922ccea6d0a3727f":"getStockRepairsPreviewAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_11 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("403d03ebd9e84dcdccfe86665d922ccea6d0a3727f", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getStockRepairsPreviewAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiNlNBaWhCc0IsMk1BQUEifQ==
}),
"[project]/src/app/actions/data:c59cca [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getActivityByEntityIdsAction",
    ()=>$$RSC_SERVER_ACTION_13
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"40d5b96536ea3c10ea4d2018a712fa2a14c62694d6":"getActivityByEntityIdsAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_13 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("40d5b96536ea3c10ea4d2018a712fa2a14c62694d6", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getActivityByEntityIdsAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiNlNBbW1Cc0IsMk1BQUEifQ==
}),
"[project]/src/app/actions/data:6db1d1 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "updateStockHistoryDatesAction",
    ()=>$$RSC_SERVER_ACTION_14
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"60d319d4137f823c456bc42755496f39a009c6cdb2":"updateStockHistoryDatesAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_14 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("60d319d4137f823c456bc42755496f39a009c6cdb2", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "updateStockHistoryDatesAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOFNBK21Cc0IsNE1BQUEifQ==
}),
"[project]/src/app/actions/data:2a2b0e [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "lookupProductByBarcodeAction",
    ()=>$$RSC_SERVER_ACTION_12
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"60c39f510779a90656f2e7a2d8e6d5d4b163e1175c":"lookupProductByBarcodeAction"},"src/app/actions/products.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_12 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("60c39f510779a90656f2e7a2d8e6d5d4b163e1175c", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "lookupProductByBarcodeAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vcHJvZHVjdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XHJcblxyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IFByb2R1Y3QsIFByb2R1Y3RGb3JtRGF0YSwgbWFwRGJQcm9kdWN0VG9Qcm9kdWN0LCBtYXBQcm9kdWN0VG9EYlByb2R1Y3QgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIFdlIGltcGxlbWVudCBzZXJ2ZXIgYWN0aW9ucyBmb3IgdGhlIHByb2R1Y3RzIGhlcmVcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0FjdGlvbih7XHJcbiAgdXNlcklkLFxyXG4gIGJ1c2luZXNzSWQsXHJcbiAgcGFnZSxcclxuICBwYWdlU2l6ZSxcclxuICBzZWFyY2gsXHJcbiAgY2F0ZWdvcnksXHJcbiAgc3RvY2tTdGF0dXMsXHJcbn06IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBidXNpbmVzc0lkOiBzdHJpbmc7XHJcbiAgcGFnZTogbnVtYmVyO1xyXG4gIHBhZ2VTaXplOiBudW1iZXI7XHJcbiAgc2VhcmNoPzogc3RyaW5nO1xyXG4gIGNhdGVnb3J5Pzogc3RyaW5nO1xyXG4gIHN0b2NrU3RhdHVzPzogJ2luU3RvY2snIHwgJ291dE9mU3RvY2snIHwgJ2xvd1N0b2NrJyB8ICdhbGwnO1xyXG59KSB7XHJcbiAgaWYgKCF1c2VySWQgfHwgIWJ1c2luZXNzSWQpIHJldHVybiB7IHByb2R1Y3RzOiBbXSwgY291bnQ6IDAgfTtcclxuXHJcbiAgY29uc3Qgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuICBjb25zdCB0YWtlID0gcGFnZVNpemU7XHJcblxyXG4gIGxldCB3aGVyZUNsYXVzZTogYW55ID0ge1xyXG4gICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICBicmFuY2hJZDogYnVzaW5lc3NJZCxcclxuICB9O1xyXG5cclxuICBpZiAoc2VhcmNoKSB7XHJcbiAgICB3aGVyZUNsYXVzZS5PUiA9IFtcclxuICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IGRlc2NyaXB0aW9uOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICB7IHNrdTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIGlmIChjYXRlZ29yeSkge1xyXG4gICAgd2hlcmVDbGF1c2UuY2F0ZWdvcnkgPSB7IG5hbWU6IGNhdGVnb3J5IH07XHJcbiAgfVxyXG5cclxuICBpZiAoc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSAwO1xyXG4gIH0gZWxzZSBpZiAoc3RvY2tTdGF0dXMgPT09ICdpblN0b2NrJykge1xyXG4gICAgd2hlcmVDbGF1c2Uuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgfSBlbHNlIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgLy8gSGFuZGxpbmcgbG93U3RvY2sgaXMgY29tcGxleCBiZWNhdXNlIG1pblN0b2NrIGlzIGNvbXBhcmVkIGxvY2FsbHkgb3IgdXNpbmcgZGlyZWN0IFNRTCBpbiBQcmlzbWFcclxuICAgIC8vIEZvciBub3csIHdlIHdpbGwgaGFuZGxlIGl0IHdpdGggUHJpc21hJ3MgcmF3IHF1ZXJ5IG9yIGJ5IGZpbHRlcmluZyBpbiBtZW1vcnkgaWYgbmVjZXNzYXJ5XHJcbiAgICAvLyBGb3J0dW5hdGVseSwgc2luY2UgUFJJU01BIDUuMCwgY29sdW1uIGNvbXBhcmlzb24gc3RpbGwgbmVlZHMgcmF3IHF1ZXJpZXMgb3Igd2UgY2FuIGZldGNoIGFuZCBmaWx0ZXIgaWYgc21hbGxcclxuICAgIC8vIEhlcmUgd2UnbGwgZmV0Y2ggdGhlbSBhbGwgaWYgbG93U3RvY2sgaXMgZW5hYmxlZCwgb3IgYWRkIGEgZ2VuZXJhdGVkIGNvbHVtbi4gXHJcbiAgICAvLyBXZSB3aWxsIGRvIGEgYmFzaWMgZmV0Y2ggYW5kIGZpbHRlciBsYXRlciBpZiBuZWVkZWQuXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Byb2R1Y3RzRGF0YSwgdG90YWxDb3VudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcclxuICAgICAgICBza2lwLFxyXG4gICAgICAgIHRha2UsXHJcbiAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnZGVzYycgfSwgeyBpZDogJ2Rlc2MnIH1dLFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgICAgc3VwcGxpZXI6IHRydWUsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgZGIucHJvZHVjdC5jb3VudCh7IHdoZXJlOiB3aGVyZUNsYXVzZSB9KVxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8gTWFwIHRoZSBQcmlzbWEgcHJvZHVjdCBtb2RlbCBiYWNrIHRvIHRoZSBhcHBsaWNhdGlvbidzIFByb2R1Y3QgdHlwZVxyXG4gICAgbGV0IGZvcm1hdHRlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiB7XHJcbiAgICAgIC8vIEFzc3VtaW5nIG1hcHBpbmcgZXhpc3RzLCB3ZSB3aWxsIG1hcCBpdFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgIG5hbWU6IHAubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICBjYXRlZ29yeTogcC5jYXRlZ29yeT8ubmFtZSB8fCAnVW5jYXRlZ29yaXplZCcsXHJcbiAgICAgICAgcXVhbnRpdHk6IHAuc3RvY2ssXHJcbiAgICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHAuc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgIHN1cHBsaWVyOiBwLnN1cHBsaWVyPy5uYW1lLFxyXG4gICAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICAgIGJhcmNvZGU6IHAuYmFyY29kZSxcclxuICAgICAgICBpdGVtTnVtYmVyOiBwLnNrdSB8fCAnJyxcclxuICAgICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzdG9ja1N0YXR1cyA9PT0gJ2xvd1N0b2NrJykge1xyXG4gICAgICBmb3JtYXR0ZWRQcm9kdWN0cyA9IGZvcm1hdHRlZFByb2R1Y3RzLmZpbHRlcigocDogYW55KSA9PiBwLnF1YW50aXR5ID4gMCAmJiBwLnF1YW50aXR5IDw9IHAubWluaW11bVN0b2NrKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBwcm9kdWN0czogZm9ybWF0dGVkUHJvZHVjdHMgYXMgYW55W10sIGNvdW50OiB0b3RhbENvdW50IH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgcHJvZHVjdHM6IFtdLCBjb3VudDogMCB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIXVzZXJJZCB8fCAhYnVzaW5lc3NJZCkgcmV0dXJuIFtdO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcHJvZHVjdHNEYXRhID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgICAgYnJhbmNoSWQ6IGJ1c2luZXNzSWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sIHsgaWQ6ICdkZXNjJyB9XSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGNhdGVnb3J5OiB0cnVlLFxyXG4gICAgICAgIHN1cHBsaWVyOiB0cnVlLFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcHJvZHVjdHNEYXRhLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogTnVtYmVyKHAuc3RvY2spLFxyXG4gICAgICBjb3N0UHJpY2U6IE51bWJlcihwLmNvc3RQcmljZSksXHJcbiAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHAuc2VsbGluZ1ByaWNlKSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IE51bWJlcihwLm1pblN0b2NrKSxcclxuICAgICAgY3JlYXRlZEF0OiBwLmNyZWF0ZWRBdCxcclxuICAgIH0pKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWxsIHByb2R1Y3RzIGZyb20gREI6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RzQnlJZHNBY3Rpb24oaWRzOiBzdHJpbmdbXSwgYnVzaW5lc3NJZD86IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0ge1xyXG4gICAgICBpZDogeyBpbjogaWRzIH1cclxuICAgIH07XHJcbiAgICBpZiAoYnVzaW5lc3NJZCkge1xyXG4gICAgICB3aGVyZS5icmFuY2hJZCA9IGJ1c2luZXNzSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBjYXRlZ29yeTogdHJ1ZSxcclxuICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHByb2R1Y3RzLm1hcCgocDogYW55KSA9PiAoe1xyXG4gICAgICBpZDogcC5pZCxcclxuICAgICAgbmFtZTogcC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgY2F0ZWdvcnk6IHAuY2F0ZWdvcnk/Lm5hbWUgfHwgJ1VuY2F0ZWdvcml6ZWQnLFxyXG4gICAgICBxdWFudGl0eTogcC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiBwLmNvc3RQcmljZSxcclxuICAgICAgc2VsbGluZ1ByaWNlOiBwLnNlbGxpbmdQcmljZSxcclxuICAgICAgc3VwcGxpZXI6IHAuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiBwLmltYWdlLFxyXG4gICAgICBiYXJjb2RlOiBwLmJhcmNvZGUsXHJcbiAgICAgIGl0ZW1OdW1iZXI6IHAuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHAubWluU3RvY2ssXHJcbiAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQsXHJcbiAgICB9KSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzIGJ5IGlkczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgIC8vIDEuIEdlbmVyYXRlIG5leHQgU0tVL2l0ZW1OdW1iZXIgZm9yIHRoaXMgYnJhbmNoXHJcbiAgICAgIGNvbnN0IGxhc3RQcm9kdWN0ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kRmlyc3Qoe1xyXG4gICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBkYXRhLmJ1c2luZXNzSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiB7IHNrdTogJ2Rlc2MnIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7IHNrdTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbGV0IG5leHRTa3UgPSBcIlBST0QtMDAwMVwiO1xyXG4gICAgICBpZiAobGFzdFByb2R1Y3QgJiYgbGFzdFByb2R1Y3Quc2t1KSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudE51bWJlciA9IHBhcnNlSW50KGxhc3RQcm9kdWN0LnNrdS5yZXBsYWNlKFwiUFJPRC1cIiwgXCJcIikpIHx8IDA7XHJcbiAgICAgICAgbmV4dFNrdSA9IGBQUk9ELSR7KGN1cnJlbnROdW1iZXIgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJyl9YDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMi4gQ3JlYXRlIHRoZSBwcm9kdWN0XHJcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCB0eC5wcm9kdWN0LmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBicmFuY2hJZDogZGF0YS5idXNpbmVzc0lkLFxyXG4gICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IGRhdGEuY2F0ZWdvcnlJZCB8fCBudWxsLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogZGF0YS5zdXBwbGllcklkIHx8IG51bGwsXHJcbiAgICAgICAgICBza3U6IG5leHRTa3UsXHJcbiAgICAgICAgICBiYXJjb2RlOiBkYXRhLmJhcmNvZGUsXHJcbiAgICAgICAgICBpbWFnZTogZGF0YS5pbWFnZVVybCxcclxuICAgICAgICAgIGNvc3RQcmljZTogZGF0YS5jb3N0UHJpY2UgfHwgMCxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogZGF0YS5zZWxsaW5nUHJpY2UgfHwgMCxcclxuICAgICAgICAgIHN0b2NrOiBkYXRhLnF1YW50aXR5IHx8IDAsXHJcbiAgICAgICAgICBtaW5TdG9jazogZGF0YS5taW5pbXVtU3RvY2sgfHwgMCxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgY2F0ZWdvcnk6IHRydWUsXHJcbiAgICAgICAgICBzdXBwbGllcjogdHJ1ZSxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGluaXRpYWwgc3RvY2sgaGlzdG9yeSBpZiBxdWFudGl0eSA+IDBcclxuICAgICAgaWYgKGRhdGEucXVhbnRpdHkgPiAwKSB7XHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICB0eXBlOiAnQ1JFQVRFRCcsXHJcbiAgICAgICAgICAgIG9sZFN0b2NrOiAwLFxyXG4gICAgICAgICAgICBuZXdTdG9jazogZGF0YS5xdWFudGl0eSxcclxuICAgICAgICAgICAgcXVhbnRpdHlDaGFuZ2U6IGRhdGEucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHJlYXNvbjogYFske3Byb2R1Y3QubmFtZX1dIHwgSW5pdGlhbCBzdG9ja2AsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5jcmVhdGVkQXQgPyBuZXcgRGF0ZShkYXRhLmNyZWF0ZWRBdCkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcHJvZHVjdDtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgIG5hbWU6IHJlc3VsdC5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcmVzdWx0LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICBjYXRlZ29yeTogcmVzdWx0LmNhdGVnb3J5Py5uYW1lIHx8ICdVbmNhdGVnb3JpemVkJyxcclxuICAgICAgcXVhbnRpdHk6IHJlc3VsdC5zdG9jayxcclxuICAgICAgY29zdFByaWNlOiByZXN1bHQuY29zdFByaWNlLFxyXG4gICAgICBzZWxsaW5nUHJpY2U6IHJlc3VsdC5zZWxsaW5nUHJpY2UsXHJcbiAgICAgIHN1cHBsaWVyOiByZXN1bHQuc3VwcGxpZXI/Lm5hbWUsXHJcbiAgICAgIGltYWdlVXJsOiByZXN1bHQuaW1hZ2UsXHJcbiAgICAgIGJhcmNvZGU6IHJlc3VsdC5iYXJjb2RlLFxyXG4gICAgICBpdGVtTnVtYmVyOiByZXN1bHQuc2t1IHx8ICcnLFxyXG4gICAgICBtaW5pbXVtU3RvY2s6IHJlc3VsdC5taW5TdG9jayxcclxuICAgICAgY3JlYXRlZEF0OiByZXN1bHQuY3JlYXRlZEF0LFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcHJvZHVjdDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgLy8gMS4gR2V0IGN1cnJlbnQgcHJvZHVjdCBzdGF0ZVxyXG4gICAgICBjb25zdCBjdXJyZW50ID0gYXdhaXQgdHgucHJvZHVjdC5maW5kVW5pcXVlKHtcclxuICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgIHNlbGVjdDogeyBzdG9jazogdHJ1ZSwgbmFtZTogdHJ1ZSB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFjdXJyZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiKTtcclxuXHJcbiAgICAgIC8vIDIuIFBlcmZvcm0gdXBkYXRlXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5wcm9kdWN0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIGNhdGVnb3J5SWQ6IHVwZGF0ZXMuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkID8gdXBkYXRlcy5jYXRlZ29yeUlkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgc3VwcGxpZXJJZDogdXBkYXRlcy5zdXBwbGllcklkICE9PSB1bmRlZmluZWQgPyB1cGRhdGVzLnN1cHBsaWVySWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICBza3U6IHVwZGF0ZXMuaXRlbU51bWJlciB8fCB1cGRhdGVzLnNrdSxcclxuICAgICAgICAgIGJhcmNvZGU6IHVwZGF0ZXMuYmFyY29kZSxcclxuICAgICAgICAgIGltYWdlOiB1cGRhdGVzLmltYWdlVXJsLFxyXG4gICAgICAgICAgY29zdFByaWNlOiB1cGRhdGVzLmNvc3RQcmljZSxcclxuICAgICAgICAgIHNlbGxpbmdQcmljZTogdXBkYXRlcy5zZWxsaW5nUHJpY2UsXHJcbiAgICAgICAgICBzdG9jazogdXBkYXRlcy5xdWFudGl0eSxcclxuICAgICAgICAgIG1pblN0b2NrOiB1cGRhdGVzLm1pbmltdW1TdG9jayxcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gMy4gQ3JlYXRlIGhpc3RvcnkgaWYgcXVhbnRpdHkgY2hhbmdlZFxyXG4gICAgICBpZiAodXBkYXRlcy5xdWFudGl0eSAhPT0gdW5kZWZpbmVkICYmIHVwZGF0ZXMucXVhbnRpdHkgIT09IGN1cnJlbnQuc3RvY2sgJiYgdXBkYXRlcy5jdXN0b21DaGFuZ2VSZWFzb24gIT09ICdza2lwLWhpc3RvcnknKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZVJlYXNvbiA9IHVwZGF0ZXMuY3VzdG9tQ2hhbmdlUmVhc29uO1xyXG4gICAgICAgIGlmICghY2hhbmdlUmVhc29uKSB7XHJcbiAgICAgICAgICBpZiAodXBkYXRlcy5pc0Zyb21TYWxlKSBjaGFuZ2VSZWFzb24gPSBcIlNhbGVcIjtcclxuICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZXMucXVhbnRpdHkgPiBjdXJyZW50LnN0b2NrKSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayBhZGRpdGlvblwiO1xyXG4gICAgICAgICAgZWxzZSBjaGFuZ2VSZWFzb24gPSBcIk1hbnVhbCBzdG9jayByZWR1Y3Rpb25cIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNuYXBzaG90dGVkUmVhc29uID0gYFske3VwZGF0ZWQubmFtZX1dIHwgJHtjaGFuZ2VSZWFzb259YDtcclxuXHJcbiAgICAgICAgYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgdXNlcklkOiB1cGRhdGVzLnVzZXJJZCxcclxuICAgICAgICAgICAgcHJvZHVjdElkOiB1cGRhdGVkLmlkLFxyXG4gICAgICAgICAgICB0eXBlOiB1cGRhdGVzLmlzRnJvbVNhbGUgPyAnU0FMRScgOiAodXBkYXRlcy5xdWFudGl0eSA+IGN1cnJlbnQuc3RvY2sgPyAnUkVTVE9DSycgOiAnQURKVVNUTUVOVCcpLFxyXG4gICAgICAgICAgICBvbGRTdG9jazogY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgbmV3U3RvY2s6IHVwZGF0ZXMucXVhbnRpdHksXHJcbiAgICAgICAgICAgIHF1YW50aXR5Q2hhbmdlOiB1cGRhdGVzLnF1YW50aXR5IC0gY3VycmVudC5zdG9jayxcclxuICAgICAgICAgICAgcmVhc29uOiBzbmFwc2hvdHRlZFJlYXNvbixcclxuICAgICAgICAgICAgcmVmZXJlbmNlSWQ6IHVwZGF0ZXMucmVmZXJlbmNlSWQgfHwgbnVsbCxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHVwZGF0ZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3RBY3Rpb24oaWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5wcm9kdWN0LmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgIH0pO1xyXG4gICAgLy8gcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnkvcHJvZHVjdHMnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0c0J1bGtBY3Rpb24oXHJcbiAgdXBkYXRlczogQXJyYXk8eyBpZDogc3RyaW5nOyB1cGRhdGVkOiBQYXJ0aWFsPGFueT4gfT4sXHJcbiAgYnVzaW5lc3NJZDogc3RyaW5nXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBQcmlzbWEgdHJhbnNhY3Rpb24gZm9yIGJ1bGsgdXBkYXRlc1xyXG4gICAgY29uc3QgdXBkYXRlUHJvbWlzZXMgPSB1cGRhdGVzLm1hcCh1ID0+XHJcbiAgICAgIGRiLnByb2R1Y3QudXBkYXRlKHtcclxuICAgICAgICB3aGVyZTogeyBpZDogdS5pZCB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQubmFtZSAmJiB7IG5hbWU6IHUudXBkYXRlZC5uYW1lIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkICYmIHsgZGVzY3JpcHRpb246IHUudXBkYXRlZC5kZXNjcmlwdGlvbiB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuY2F0ZWdvcnlJZCAhPT0gdW5kZWZpbmVkICYmIHsgY2F0ZWdvcnlJZDogdS51cGRhdGVkLmNhdGVnb3J5SWQgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLnN1cHBsaWVySWQgIT09IHVuZGVmaW5lZCAmJiB7IHN1cHBsaWVySWQ6IHUudXBkYXRlZC5zdXBwbGllcklkIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5za3UgIT09IHVuZGVmaW5lZCAmJiB7IHNrdTogdS51cGRhdGVkLnNrdSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQuYmFyY29kZSAhPT0gdW5kZWZpbmVkICYmIHsgYmFyY29kZTogdS51cGRhdGVkLmJhcmNvZGUgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLmNvc3RQcmljZSAhPT0gdW5kZWZpbmVkICYmIHsgY29zdFByaWNlOiB1LnVwZGF0ZWQuY29zdFByaWNlIH0pLFxyXG4gICAgICAgICAgLi4uKHUudXBkYXRlZC5zZWxsaW5nUHJpY2UgIT09IHVuZGVmaW5lZCAmJiB7IHNlbGxpbmdQcmljZTogdS51cGRhdGVkLnNlbGxpbmdQcmljZSB9KSxcclxuICAgICAgICAgIC4uLih1LnVwZGF0ZWQucXVhbnRpdHkgIT09IHVuZGVmaW5lZCAmJiB7IHN0b2NrOiB1LnVwZGF0ZWQucXVhbnRpdHkgfSksXHJcbiAgICAgICAgICAuLi4odS51cGRhdGVkLm1pbmltdW1TdG9jayAhPT0gdW5kZWZpbmVkICYmIHsgbWluU3RvY2s6IHUudXBkYXRlZC5taW5pbXVtU3RvY2sgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBkYi4kdHJhbnNhY3Rpb24odXBkYXRlUHJvbWlzZXMpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBlcmZvcm1pbmcgYnVsayB1cGRhdGU6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFBST0RVQ1QgQ0FURUdPUklFUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0Q2F0ZWdvcmllc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGRiLmNhdGVnb3J5LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGxvY2F0aW9uSWQgfSxcclxuICAgICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiBjYXRlZ29yaWVzLm1hcCgoYzogYW55KSA9PiAoe1xyXG4gICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgIG5hbWU6IGMubmFtZSxcclxuICAgICAgICBjcmVhdGVkX2F0OiBjLmNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KSlcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9kdWN0Q2F0ZWdvcnlBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgZGIuY2F0ZWdvcnkuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGJyYW5jaElkOiBsb2NhdGlvbklkLFxyXG4gICAgICAgIHVzZXJJZCxcclxuICAgICAgICBuYW1lXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBjYXRlZ29yeSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNhdGVnb3J5OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3RDYXRlZ29yeUFjdGlvbihpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBkYi5jYXRlZ29yeS51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBkYXRhOiB7IG5hbWUgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNhdGVnb3J5IH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHJvZHVjdENhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gQ2hlY2sgaWYgYW55IHByb2R1Y3RzIGFyZSB1c2luZyB0aGlzIGNhdGVnb3J5XHJcbiAgICBjb25zdCB1c2FnZUNvdW50ID0gYXdhaXQgZGIucHJvZHVjdC5jb3VudCh7XHJcbiAgICAgIHdoZXJlOiB7IGNhdGVnb3J5SWQ6IGlkIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh1c2FnZUNvdW50ID4gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiAnQ2Fubm90IGRlbGV0ZSBjYXRlZ29yeTogaXQgaXMgYmVpbmcgdXNlZCBieSBvbmUgb3IgbW9yZSBwcm9kdWN0cy4nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZGIuY2F0ZWdvcnkuZGVsZXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBjYXRlZ29yeTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIC0tLSBQUk9EVUNUIFNUQVRTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RTdGF0c0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcpIHtcclxuICBpZiAoIWJ1c2luZXNzSWQpIHJldHVybiB7IGNvc3RWYWx1ZTogMCwgbG93U3RvY2s6IDAsIG91dE9mU3RvY2s6IDAsIHN0b2NrVmFsdWU6IDAgfTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgIHN0b2NrOiB0cnVlLFxyXG4gICAgICAgIGNvc3RQcmljZTogdHJ1ZSxcclxuICAgICAgICBzZWxsaW5nUHJpY2U6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBjb3N0VmFsdWUgPSAwO1xyXG4gICAgbGV0IGxvd1N0b2NrID0gMDtcclxuICAgIGxldCBvdXRPZlN0b2NrID0gMDtcclxuICAgIGxldCBzdG9ja1ZhbHVlID0gMDtcclxuXHJcbiAgICBwcm9kdWN0cy5mb3JFYWNoKChwOiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgcXR5ID0gTnVtYmVyKHAuc3RvY2spIHx8IDA7XHJcbiAgICAgIGNvbnN0IGNvc3QgPSBOdW1iZXIocC5jb3N0UHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IHNlbGxpbmcgPSBOdW1iZXIocC5zZWxsaW5nUHJpY2UpIHx8IDA7XHJcbiAgICAgIGNvbnN0IG1pblN0b2NrID0gTnVtYmVyKHAubWluU3RvY2spIHx8IDA7XHJcblxyXG4gICAgICBjb3N0VmFsdWUgKz0gY29zdCAqIHF0eTtcclxuICAgICAgc3RvY2tWYWx1ZSArPSBzZWxsaW5nICogcXR5O1xyXG5cclxuICAgICAgaWYgKHF0eSA9PT0gMCkge1xyXG4gICAgICAgIG91dE9mU3RvY2srKztcclxuICAgICAgfSBlbHNlIGlmIChxdHkgPiAwICYmIHF0eSA8PSBtaW5TdG9jaykge1xyXG4gICAgICAgIGxvd1N0b2NrKys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7IGNvc3RWYWx1ZSwgbG93U3RvY2ssIG91dE9mU3RvY2ssIHN0b2NrVmFsdWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdCBzdGF0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBjb3N0VmFsdWU6IDAsIGxvd1N0b2NrOiAwLCBvdXRPZlN0b2NrOiAwLCBzdG9ja1ZhbHVlOiAwIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBMT09LVVAgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbihjb2RlOiBzdHJpbmcsIGJyYW5jaElkOiBzdHJpbmcpIHtcclxuICBpZiAoIWNvZGUgfHwgIWJyYW5jaElkKSByZXR1cm4gbnVsbDtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbG93ZXJDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBicmFuY2hJZCxcclxuICAgICAgICBPUjogW1xyXG4gICAgICAgICAgeyBiYXJjb2RlOiB7IGNvbnRhaW5zOiBsb3dlckNvZGUsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgICAgeyBza3U6IHsgY29udGFpbnM6IGxvd2VyQ29kZSwgbW9kZTogJ2luc2Vuc2l0aXZlJyB9IH0sXHJcbiAgICAgICAgXVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcm9kdWN0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbbG9va3VwUHJvZHVjdEJ5QmFyY29kZUFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0gQkFSQ09ERSBTQ0FOTkVSIChhbGwgcHJvZHVjdHMgZm9yIHNjYW5uZXIgcHJlbG9hZCkgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbihicmFuY2hJZDogc3RyaW5nKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IGRiLnByb2R1Y3QuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBicmFuY2hJZCB9LFxyXG4gICAgICBzZWxlY3Q6IHtcclxuICAgICAgICBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgYmFyY29kZTogdHJ1ZSwgc2t1OiB0cnVlLFxyXG4gICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSwgY29zdFByaWNlOiB0cnVlLCBzdG9jazogdHJ1ZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdHJ1ZSwgY2F0ZWdvcnlJZDogdHJ1ZSwgYnJhbmNoSWQ6IHRydWUsXHJcbiAgICAgICAgbWluU3RvY2s6IHRydWUsIGltYWdlVXJsOiB0cnVlLCBjcmVhdGVkQXQ6IHRydWUsIHVwZGF0ZWRBdDogdHJ1ZSxcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb2R1Y3RzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbZ2V0UHJvZHVjdHNGb3JCYXJjb2RlU2Nhbm5lckFjdGlvbl0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIFNBTEUgQ0FTSCBUUkFOU0FDVElPTiBJRCBVUERBVEUgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2FsZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihzYWxlSWQ6IHN0cmluZywgY2FzaFRyYW5zYWN0aW9uSWQ6IHN0cmluZykge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkYi5zYWxlLnVwZGF0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkOiBzYWxlSWQgfSxcclxuICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignW3VwZGF0ZVNhbGVDYXNoVHJhbnNhY3Rpb25BY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gLS0tIEZJTFRFUkVEIFBST0RVQ1RTIEZPUiBFWFBPUlQgKGFsbCBwYWdlcykgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyZWRQcm9kdWN0c0ZvckV4cG9ydEFjdGlvbihcclxuICBicmFuY2hJZDogc3RyaW5nLFxyXG4gIGZpbHRlcnM/OiB7IHNlYXJjaD86IHN0cmluZzsgY2F0ZWdvcnk/OiBzdHJpbmc7IHN0b2NrU3RhdHVzPzogc3RyaW5nIH1cclxuKSB7XHJcbiAgaWYgKCFicmFuY2hJZCkgcmV0dXJuIFtdO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3aGVyZTogYW55ID0geyBicmFuY2hJZCB9O1xyXG5cclxuICAgIGlmIChmaWx0ZXJzPy5zZWFyY2gpIHtcclxuICAgICAgY29uc3QgcyA9IGZpbHRlcnMuc2VhcmNoO1xyXG4gICAgICB3aGVyZS5PUiA9IFtcclxuICAgICAgICB7IG5hbWU6IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHMsIG1vZGU6ICdpbnNlbnNpdGl2ZScgfSB9LFxyXG4gICAgICAgIHsgc2t1OiB7IGNvbnRhaW5zOiBzLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlsdGVycz8uc3RvY2tTdGF0dXMgPT09ICdvdXRPZlN0b2NrJykge1xyXG4gICAgICB3aGVyZS5zdG9jayA9IDA7XHJcbiAgICB9IGVsc2UgaWYgKGZpbHRlcnM/LnN0b2NrU3RhdHVzID09PSAnaW5TdG9jaycpIHtcclxuICAgICAgd2hlcmUuc3RvY2sgPSB7IGd0OiAwIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgd2hlcmUsXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9kdWN0cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW2dldEZpbHRlcmVkUHJvZHVjdHNGb3JFeHBvcnRBY3Rpb25dIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI0U0FrZnNCLDJNQUFBIn0=
}),
"[project]/src/app/actions/data:515d43 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getRequisitionsAction",
    ()=>$$RSC_SERVER_ACTION_5
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"607c22123dc2728e830f8ac8e642f36c1a0f3d0e07":"getRequisitionsAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_5 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("607c22123dc2728e830f8ac8e642f36c1a0f3d0e07", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getRequisitionsAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoic1NBaU5zQixrTUFBQSJ9
}),
"[project]/src/app/actions/data:044aee [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createRequisitionAction",
    ()=>$$RSC_SERVER_ACTION_6
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"40eba5290c662a74f9b17731241be6565b6ba17367":"createRequisitionAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_6 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("40eba5290c662a74f9b17731241be6565b6ba17367", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "createRequisitionAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoid1NBa1BzQixvTUFBQSJ9
}),
"[project]/src/app/actions/data:bdfbb5 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "updateRequisitionAction",
    ()=>$$RSC_SERVER_ACTION_7
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"709e5344eeca43879345dcb626f1f2ab7ca9393a20":"updateRequisitionAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_7 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("709e5344eeca43879345dcb626f1f2ab7ca9393a20", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "updateRequisitionAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoid1NBc1JzQixvTUFBQSJ9
}),
"[project]/src/app/actions/data:03676d [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "deleteRequisitionAction",
    ()=>$$RSC_SERVER_ACTION_8
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"60c80b6e8d70c1cd11332fb59eec3790b8c4260c46":"deleteRequisitionAction"},"src/app/actions/inventory.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_8 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("60c80b6e8d70c1cd11332fb59eec3790b8c4260c46", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "deleteRequisitionAction");
;
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vaW52ZW50b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc2VydmVyJztcclxuXHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vcHJpc21hL2RiJztcclxuaW1wb3J0IHsgcmV2YWxpZGF0ZVBhdGggfSBmcm9tICduZXh0L2NhY2hlJztcclxuXHJcbi8vIC0tLSBTVE9DSyBISVNUT1JZIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrSGlzdG9yeUFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHByb2R1Y3RJZD86IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB3aGVyZTogYW55ID0geyBsb2NhdGlvbklkIH07XHJcbiAgICAgICAgaWYgKHByb2R1Y3RJZCkgd2hlcmUucHJvZHVjdElkID0gcHJvZHVjdElkO1xyXG5cclxuICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZSxcclxuICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LCB7IGlkOiAnZGVzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogaGlzdG9yeS5tYXAoKGg6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBoLmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBoLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgICAgIG9sZFF1YW50aXR5OiBoLnByZXZpb3VzUXVhbnRpdHksXHJcbiAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogaC5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogaC5jaGFuZ2VSZWFzb24sXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGguY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VJZDogaC5yZWZlcmVuY2VJZCxcclxuICAgICAgICAgICAgICAgIHJlY2VpcHROdW1iZXI6IGgucmVjZWlwdE51bWJlcixcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Q6IGgucHJvZHVjdCA/IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBoLnByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjb3N0UHJpY2U6IGgucHJvZHVjdC5jb3N0UHJpY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsbGluZ1ByaWNlOiBoLnByb2R1Y3Quc2VsbGluZ1ByaWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IGgucHJvZHVjdC5za3VcclxuICAgICAgICAgICAgICAgIH0gOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzdG9jayBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0b2NrSGlzdG9yeUFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYXdhaXQgdHgucHJvZHVjdEhpc3RvcnkuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGRhdGEucHJvZHVjdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzUXVhbnRpdHk6IGRhdGEucHJldmlvdXNRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdRdWFudGl0eTogZGF0YS5uZXdRdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VSZWFzb246IGRhdGEuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUlkOiBkYXRhLnJlZmVyZW5jZUlkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjZWlwdE51bWJlcjogZGF0YS5yZWNlaXB0TnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBkYXRhLmNyZWF0ZWRBdCA/IG5ldyBEYXRlKGRhdGEuY3JlYXRlZEF0KSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBwcm9kdWN0IHN0b2NrIGFzIHdlbGxcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEucHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHN0b2NrOiBkYXRhLm5ld1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3RvY2sgaGlzdG9yeTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24ocHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHByb2R1Y3RJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogW3sgY3JlYXRlZEF0OiAnYXNjJyB9LCB7IGlkOiAnYXNjJyB9XVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoaXN0b3J5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgZmluYWxRdWFudGl0eTogMCB9O1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3UXVhbnRpdHkgLSBlbnRyeS5wcmV2aW91c1F1YW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5wcmV2aW91c1F1YW50aXR5ICE9PSBuZXdQcmV2IHx8IGVudHJ5Lm5ld1F1YW50aXR5ICE9PSBuZXdOZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5wdXNoKHR4LnByb2R1Y3RIaXN0b3J5LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBlbnRyeS5pZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBydW5uaW5nUXVhbnRpdHkgPSBuZXdOZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIHByb2R1Y3RcclxuICAgICAgICAgICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHByb2R1Y3RJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBzdG9jazogcnVubmluZ1F1YW50aXR5IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBmaW5hbFF1YW50aXR5OiBydW5uaW5nUXVhbnRpdHkgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9pbnZlbnRvcnknKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNhbGN1bGF0aW5nIHN0b2NrIGNoYWluOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN0b2NrSGlzdG9yeUVudHJpZXNCeVJlZmVyZW5jZUFjdGlvbihyZWZlcmVuY2VJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyByZWZlcmVuY2VJZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7IHByb2R1Y3RJZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdElkcyA9IFsuLi5uZXcgU2V0KGVudHJpZXMubWFwKChlOiBhbnkpID0+IGUucHJvZHVjdElkIGFzIHN0cmluZykpXTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmRlbGV0ZU1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgcmVmZXJlbmNlSWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGNoYWlucyBmb3IgYWZmZWN0ZWQgcHJvZHVjdHNcclxuICAgICAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgb2YgcHJvZHVjdElkcykge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHgsIHByb2R1Y3RJZCBhcyBzdHJpbmcsIGxvY2F0aW9uSWQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4geyBhZmZlY3RlZFByb2R1Y3RzOiBwcm9kdWN0SWRzLmxlbmd0aCB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ludmVudG9yeScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHN0b2NrIGhpc3RvcnkgYnkgcmVmZXJlbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQnlSZWZlcmVuY2VBY3Rpb24ocmVmZXJlbmNlSWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBuZXdEYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHJlZmVyZW5jZUlkLCBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHsgY3JlYXRlZEF0OiBuZXcgRGF0ZShuZXdEYXRlKSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvaW52ZW50b3J5Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgc3RvY2sgaGlzdG9yeSBkYXRlczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEludGVybmFsIGhlbHBlciBmb3IgdXNlIHdpdGhpbiB0cmFuc2FjdGlvbnNcclxuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVTdG9ja0NoYWluSW50ZXJuYWwodHg6IGFueSwgcHJvZHVjdElkOiBzdHJpbmcsIGxvY2F0aW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IHR4LnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICBvcmRlckJ5OiBbeyBjcmVhdGVkQXQ6ICdhc2MnIH0sIHsgaWQ6ICdhc2MnIH1dXHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcnVubmluZ1F1YW50aXR5ID0gMDtcclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgIGNvbnN0IGNoYW5nZSA9IGVudHJ5Lm5ld1F1YW50aXR5IC0gZW50cnkucHJldmlvdXNRdWFudGl0eTtcclxuICAgICAgICBjb25zdCBuZXdQcmV2ID0gcnVubmluZ1F1YW50aXR5O1xyXG4gICAgICAgIGNvbnN0IG5ld05leHQgPSBuZXdQcmV2ICsgY2hhbmdlO1xyXG5cclxuICAgICAgICBpZiAoZW50cnkucHJldmlvdXNRdWFudGl0eSAhPT0gbmV3UHJldiB8fCBlbnRyeS5uZXdRdWFudGl0eSAhPT0gbmV3TmV4dCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5wcm9kdWN0SGlzdG9yeS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGVudHJ5LmlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7IHByZXZpb3VzUXVhbnRpdHk6IG5ld1ByZXYsIG5ld1F1YW50aXR5OiBuZXdOZXh0IH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJ1bm5pbmdRdWFudGl0eSA9IG5ld05leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdHgucHJvZHVjdC51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkOiBwcm9kdWN0SWQgfSxcclxuICAgICAgICBkYXRhOiB7IHN0b2NrOiBydW5uaW5nUXVhbnRpdHkgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIC0tLSBSRVFVSVNJVElPTlMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVxdWlzaXRpb25zQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb25zID0gYXdhaXQgZGIucmVxdWlzaXRpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6ICdkZXNjJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHJlcXVpc2l0aW9ucy5tYXAoKHJlcTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHJlcS5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IHJlcS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIHJlcXVpc2l0aW9uTnVtYmVyOiByZXEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxLnRpdGxlIHx8ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IChyZXEuaXRlbXMgYXMgYW55KSB8fCBbXSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiByZXEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHJlcS5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcmVxLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH0pKVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmVxdWlzaXRpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVJlcXVpc2l0aW9uQWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXF1aXNpdGlvbiA9IGF3YWl0IGRiLnJlcXVpc2l0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgcmVxdWlzaXRpb25OdW1iZXI6IGRhdGEucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBkYXRhLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzIHx8ICdkcmFmdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWlzaXRpb24gPSBhd2FpdCBkYi5yZXF1aXNpdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCwgdXNlcklkIH0sXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICBub3RlczogZGF0YS5ub3RlcyxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiByZXF1aXNpdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcmVxdWlzaXRpb24udXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogcmVxdWlzaXRpb24uYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICByZXF1aXNpdGlvbk51bWJlcjogcmVxdWlzaXRpb24ucmVxdWlzaXRpb25OdW1iZXIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVxdWlzaXRpb24udGl0bGUgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBpdGVtczogKHJlcXVpc2l0aW9uLml0ZW1zIGFzIGFueSkgfHwgW10sXHJcbiAgICAgICAgICAgICAgICBub3RlczogcmVxdWlzaXRpb24ubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlcXVpc2l0aW9uLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcmVxdWlzaXRpb24uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJlcXVpc2l0aW9uLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcXVpc2l0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVJlcXVpc2l0aW9uQWN0aW9uKGlkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnJlcXVpc2l0aW9uLmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkLCB1c2VySWQgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL3JlcXVpc2l0aW9ucycpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXF1aXNpdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBSRVBPUlRTIC8gQU5BTFlUSUNTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrU3VtbWFyeVJlcG9ydEFjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgcHJvZHVjdHMgZm9yIHRoZSBsb2NhdGlvblxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByZXBvcnREYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvZHVjdHMubWFwKGFzeW5jIChwcm9kdWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgdmVyc2lvbiBvZiB0aGUgbG9naWMgdGhhdCB3YXMgbGlrZWx5IGluIHRoZSBSUENcclxuICAgICAgICAgICAgLy8gSW4gYSByZWFsIHByb2R1Y3Rpb24gYXBwLCB3ZSdkIHVzZSBjb21wbGV4IFNRTCBvciBkZWRpY2F0ZWQgYWdncmVnYXRlIHRhYmxlc1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGhpc3RvcnkgZm9yIHRoaXMgcHJvZHVjdCBpbiB0aGUgZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5ID0gYXdhaXQgZGIucHJvZHVjdEhpc3RvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3RlOiBzdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBlbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdhc2MnIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgbWV0cmljcyBmcm9tIGhpc3RvcnlcclxuICAgICAgICAgICAgbGV0IGl0ZW1zU29sZCA9IDA7XHJcbiAgICAgICAgICAgIGxldCBzdG9ja0luID0gMDtcclxuICAgICAgICAgICAgbGV0IGFkanVzdG1lbnRzSW4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWRqdXN0bWVudHNPdXQgPSAwO1xyXG5cclxuICAgICAgICAgICAgaGlzdG9yeS5mb3JFYWNoKChoOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZSA9IGgubmV3UXVhbnRpdHkgLSBoLnByZXZpb3VzUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5jaGFuZ2VSZWFzb24gPT09ICdTQUxFJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zU29sZCArPSBNYXRoLmFicyhjaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoLmNoYW5nZVJlYXNvbiA9PT0gJ1NUT0NLX0lOJyB8fCBoLmNoYW5nZVJlYXNvbiA9PT0gJ1JFU1RPQ0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RvY2tJbiArPSBjaGFuZ2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luICs9IGNoYW5nZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQgKz0gTWF0aC5hYnMoY2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY2xvc2luZyBzdG9jayBhdCBlbmQgZGF0ZSAob3IgY3VycmVudCBpZiBhZnRlciBlbmQgZGF0ZSlcclxuICAgICAgICAgICAgY29uc3QgY2xvc2luZ1N0b2NrRW50cnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHsgbHRlOiBlbmQgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNsb3NpbmdTdG9jayA9IGNsb3NpbmdTdG9ja0VudHJ5ID8gY2xvc2luZ1N0b2NrRW50cnkubmV3UXVhbnRpdHkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvcGVuaW5nU3RvY2sgPSBjbG9zaW5nU3RvY2sgLSAoc3RvY2tJbiArIGFkanVzdG1lbnRzSW4gLSBpdGVtc1NvbGQgLSBhZGp1c3RtZW50c091dCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1OdW1iZXI6IHByb2R1Y3Quc2t1IHx8IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICBpbWFnZVVybDogcHJvZHVjdC5pbWFnZVVybCxcclxuICAgICAgICAgICAgICAgIGNvc3RQcmljZTogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKSxcclxuICAgICAgICAgICAgICAgIHNlbGxpbmdQcmljZTogTnVtYmVyKHByb2R1Y3Quc2VsbGluZ1ByaWNlKSxcclxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBwcm9kdWN0LmNhdGVnb3J5Py5uYW1lLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgaXRlbXNTb2xkLFxyXG4gICAgICAgICAgICAgICAgc3RvY2tJbixcclxuICAgICAgICAgICAgICAgIHRyYW5zZmVyT3V0OiAwLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuSW46IDAsXHJcbiAgICAgICAgICAgICAgICByZXR1cm5PdXQ6IDAsXHJcbiAgICAgICAgICAgICAgICBhZGp1c3RtZW50c0luLFxyXG4gICAgICAgICAgICAgICAgYWRqdXN0bWVudHNPdXQsXHJcbiAgICAgICAgICAgICAgICBjbG9zaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICByZXZhbHVhdGlvbjogY2xvc2luZ1N0b2NrICogTnVtYmVyKHByb2R1Y3QuY29zdFByaWNlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVwb3J0RGF0YSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgc3RvY2sgc3VtbWFyeSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gU1RPQ0sgUkVDT05DSUxJQVRJT04gJiBSRVBBSVJTIC0tLVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2R1Y3RSZWNvbmNpbGlhdGlvbkFjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBkYi5wcm9kdWN0LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogcHJvZHVjdElkIH0sXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHsgY2F0ZWdvcnk6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXByb2R1Y3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICAvLyBGZXRjaCBhbGwgaGlzdG9yeSBlbnRyaWVzXHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgcHJvZHVjdElkLCBsb2NhdGlvbklkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggYWxsIHNhbGVzIGNvbnRhaW5pbmcgdGhpcyBwcm9kdWN0XHJcbiAgICAgICAgY29uc3Qgc2FsZXMgPSBhd2FpdCBkYi5zYWxlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBkYXRlOiAnYXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdTdG9jayA9IGhpc3RvcnkubGVuZ3RoID4gMCA/IGhpc3RvcnlbMF0ubmV3U3RvY2sgOiAwO1xyXG4gICAgICAgIGNvbnN0IG9wZW5pbmdEYXRlID0gaGlzdG9yeS5sZW5ndGggPiAwID8gaGlzdG9yeVswXS5jcmVhdGVkQXQgOiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCBkYWlseVRyYW5zYWN0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgbGV0IGV4Y2x1ZGVkU2FsZXNRdHkgPSAwO1xyXG5cclxuICAgICAgICBzYWxlcy5mb3JFYWNoKHNhbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IChzYWxlLml0ZW1zIGFzIGFueVtdKSB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3Qgc29sZFF0eSA9IGl0ZW1zXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3RJZClcclxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKE51bWJlcihpdGVtLnF1YW50aXR5KSB8fCAwKSwgMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc29sZFF0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcGVuaW5nRGF0ZSAmJiBzYWxlLmRhdGUgPCBvcGVuaW5nRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkU2FsZXNRdHkgKz0gc29sZFF0eTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IHNhbGUuZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZGFpbHlUcmFuc2FjdGlvbnMuZ2V0KGRhdGVTdHIpIHx8IHsgaXRlbXNTb2xkOiAwLCBzdG9ja0FkZGVkOiAwLCB0cmFuc2Zlck91dDogMCwgcmV0dXJuSW46IDAsIHJldHVybk91dDogMCwgYWRqdXN0bWVudHM6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICBkYXkuaXRlbXNTb2xkICs9IHNvbGRRdHk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTW92ZW1lbnRzIChleGNsdWRpbmcgaW5pdGlhbCBlbnRyeSlcclxuICAgICAgICBjb25zdCBtb3ZlbWVudHMgPSBoaXN0b3J5LnNsaWNlKDEpO1xyXG4gICAgICAgIG1vdmVtZW50cy5mb3JFYWNoKGggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gaC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGgubmV3U3RvY2sgLSBoLm9sZFN0b2NrO1xyXG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSAoaC5jaGFuZ2VSZWFzb24gfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZVN0cikgfHwgeyBpdGVtc1NvbGQ6IDAsIHN0b2NrQWRkZWQ6IDAsIHRyYW5zZmVyT3V0OiAwLCByZXR1cm5JbjogMCwgcmV0dXJuT3V0OiAwLCBhZGp1c3RtZW50czogMCB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGgudHlwZSA9PT0gJ1JFU1RPQ0snIHx8IHJlYXNvbi5pbmNsdWRlcygncHVyY2hhc2UnKSB8fCByZWFzb24uaW5jbHVkZXMoJ2FkZGl0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5zdG9ja0FkZGVkICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygndHJhbnNmZXIgb3V0JykpIHtcclxuICAgICAgICAgICAgICAgIGRheS50cmFuc2Zlck91dCArPSBNYXRoLmFicyhkZWx0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVhc29uLmluY2x1ZGVzKCdjdXN0b21lciByZXR1cm4nKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJldHVybkluICs9IGRlbHRhO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlYXNvbi5pbmNsdWRlcygncmV0dXJuIHRvIHN1cHBsaWVyJykpIHtcclxuICAgICAgICAgICAgICAgIGRheS5yZXR1cm5PdXQgKz0gTWF0aC5hYnMoZGVsdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGgudHlwZSAhPT0gJ1NBTEUnKSB7XHJcbiAgICAgICAgICAgICAgICBkYXkuYWRqdXN0bWVudHMgKz0gZGVsdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGFpbHlUcmFuc2FjdGlvbnMuc2V0KGRhdGVTdHIsIGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShkYWlseVRyYW5zYWN0aW9ucy5rZXlzKCkpLnNvcnQoKTtcclxuICAgICAgICBjb25zdCBkYWlseUJyZWFrZG93biA9IFtdO1xyXG4gICAgICAgIGxldCBydW5uaW5nU3RvY2sgPSBvcGVuaW5nU3RvY2s7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXkgPSBkYWlseVRyYW5zYWN0aW9ucy5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0aW5nU3RvY2sgPSBydW5uaW5nU3RvY2s7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZGluZ1N0b2NrID0gc3RhcnRpbmdTdG9jayAtIGRheS5pdGVtc1NvbGQgKyBkYXkuc3RvY2tBZGRlZCAtIGRheS50cmFuc2Zlck91dCArIGRheS5yZXR1cm5JbiAtIGRheS5yZXR1cm5PdXQgKyBkYXkuYWRqdXN0bWVudHM7XHJcblxyXG4gICAgICAgICAgICBkYWlseUJyZWFrZG93bi5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBzdGFydGluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF5LFxyXG4gICAgICAgICAgICAgICAgZW5kaW5nU3RvY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJ1bm5pbmdTdG9jayA9IGVuZGluZ1N0b2NrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBwcm9kdWN0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgICAgICBpdGVtTnVtYmVyOiBwcm9kdWN0LnNrdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9jazogcHJvZHVjdC5zdG9jayxcclxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRTdG9jazogcnVubmluZ1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgZGlzY3JlcGFuY3k6IHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nU3RvY2ssXHJcbiAgICAgICAgICAgICAgICBvcGVuaW5nRGF0ZTogb3BlbmluZ0RhdGU/LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICBleGNsdWRlZFNhbGVzUXR5LFxyXG4gICAgICAgICAgICAgICAgZGFpbHlCcmVha2Rvd25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gcmVjb25jaWxpYXRpb24gYWN0aW9uOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFN0b2NrUmVwYWlyc1ByZXZpZXdBY3Rpb24oYnVzaW5lc3NJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZGIucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBidXNpbmVzc0lkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgc3RvY2s6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBicm9rZW5DaGFpbnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0IG9mIHByb2R1Y3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBkYi5wcm9kdWN0SGlzdG9yeS5maW5kTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsIGxvY2F0aW9uSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IFt7IGNyZWF0ZWRBdDogJ2FzYycgfSwgeyBpZDogJ2FzYycgfV1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJ1bm5pbmdRdWFudGl0eSA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGJyb2tlbkVudHJpZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgaGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hhbmdlID0gZW50cnkubmV3U3RvY2sgLSBlbnRyeS5vbGRTdG9jaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkUHJldiA9IHJ1bm5pbmdRdWFudGl0eTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkTmV4dCA9IGV4cGVjdGVkUHJldiArIGNoYW5nZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkub2xkU3RvY2sgIT09IGV4cGVjdGVkUHJldiB8fCBlbnRyeS5uZXdTdG9jayAhPT0gZXhwZWN0ZWROZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJva2VuRW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlJZDogZW50cnkuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZW50cnkuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYXNvbjogZW50cnkuY2hhbmdlUmVhc29uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJldlF0eTogZW50cnkub2xkU3RvY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnROZXdRdHk6IGVudHJ5Lm5ld1N0b2NrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFByZXZRdHk6IGV4cGVjdGVkUHJldixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZml4ZWROZXdRdHk6IGV4cGVjdGVkTmV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcnVubmluZ1F1YW50aXR5ID0gZXhwZWN0ZWROZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoYnJva2VuRW50cmllcy5sZW5ndGggPiAwIHx8IE1hdGguYWJzKHByb2R1Y3Quc3RvY2sgLSBydW5uaW5nUXVhbnRpdHkpID4gMC4wMDEpIHtcclxuICAgICAgICAgICAgICAgIGJyb2tlbkNoYWlucy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IHByb2R1Y3QuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHByb2R1Y3QubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbEVudHJpZXM6IGhpc3RvcnkubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGJyb2tlbkVudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZmluYWxGaXhlZFF0eTogcnVubmluZ1F1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9kdWN0UXR5OiBwcm9kdWN0LnN0b2NrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYnJva2VuQ2hhaW5zIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBhaXJTdG9ja0NoYWluc0FjdGlvbihidXNpbmVzc0lkOiBzdHJpbmcsIHByb2R1Y3RJZHM/OiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBpZHMgPSBwcm9kdWN0SWRzIHx8IChhd2FpdCBkYi5wcm9kdWN0LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQ6IGJ1c2luZXNzSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH1cclxuICAgICAgICB9KSkubWFwKHAgPT4gcC5pZCk7XHJcblxyXG4gICAgICAgIGxldCByZXBhaXJlZCA9IDA7XHJcbiAgICAgICAgbGV0IGZhaWxlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCByZWNhbGN1bGF0ZVN0b2NrQ2hhaW5BY3Rpb24oaWQsIGJ1c2luZXNzSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVwYWlyZWQrKztcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsZWQrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogeyByZXBhaXJlZCwgZmFpbGVkIH0gfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5QnlFbnRpdHlJZHNBY3Rpb24oZW50aXR5SWRzOiBzdHJpbmdbXSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWNvcmRzID0gYXdhaXQgZGIuYWN0aXZpdHlIaXN0b3J5LmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgZW50aXR5SWQ6IHsgaW46IGVudGl0eUlkcyB9IH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBlbnRpdHlJZDogdHJ1ZSwgZW50aXR5TmFtZTogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVjb3JkcyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0b2NrSGlzdG9yeURhdGVzQWN0aW9uKGVudHJ5SWRzOiBzdHJpbmdbXSwgbmV3RGF0ZTogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLnByb2R1Y3RIaXN0b3J5LnVwZGF0ZU1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogeyBpbjogZW50cnlJZHMgfSB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7IGNyZWF0ZWRBdDogbmV3IERhdGUobmV3RGF0ZSkgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gLS0tIFJFQ0VJUFQgTlVNQkVSIEdFTkVSQVRJT04gLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFJlY2VpcHROdW1iZXJBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBsYXN0U2FsZSA9IGF3YWl0IGRiLnNhbGUuZmluZEZpcnN0KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgYnJhbmNoSWQgfSxcclxuICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgc2FsZU51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBuZXh0TnVtID0gMTtcclxuICAgICAgICBpZiAobGFzdFNhbGU/LnNhbGVOdW1iZXIpIHtcclxuICAgICAgICAgICAgLy8gc2FsZU51bWJlciBmb3JtYXQgaXMgXCJTQUwtWVlZWS1OTk5OTk5cIiBvciBwbGFpbiBkaWdpdHNcclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsYXN0U2FsZS5zYWxlTnVtYmVyLnNwbGl0KCctJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3REaWdpdHMgPSBwYXJzZUludChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSwgMTApO1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGxhc3REaWdpdHMpKSBuZXh0TnVtID0gbGFzdERpZ2l0cyArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBTdHJpbmcobmV4dE51bSkucGFkU3RhcnQoNiwgJzAnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmb3JtYXR0ZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIG5leHQgcmVjZWlwdCBudW1iZXI6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoid1NBeVRzQixvTUFBQSJ9
}),
];

//# sourceMappingURL=src_app_actions_54effebd._.js.map