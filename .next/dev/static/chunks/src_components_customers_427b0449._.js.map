{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerPageSkeleton.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Skeleton } from '@/components/ui/skeleton';\r\n\r\nconst CustomerPageSkeleton = () => (\r\n  <div className=\"space-y-8\">\r\n    <div className=\"bg-white rounded-lg border p-6\">\r\n      <div className=\"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6\">\r\n        <div className=\"space-y-2\">\r\n          <Skeleton className=\"h-8 w-64\" />\r\n          <Skeleton className=\"h-4 w-96\" />\r\n        </div>\r\n        <Skeleton className=\"h-10 w-40\" />\r\n      </div>\r\n    </div>\r\n\r\n    <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-6\">\r\n      {[...Array(3)].map((_, i) => (\r\n        <Skeleton key={i} className=\"h-24\" />\r\n      ))}\r\n    </div>\r\n\r\n    <div className=\"bg-white rounded-lg border\">\r\n      <div className=\"p-6\">\r\n        <Skeleton className=\"h-40\" />\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default CustomerPageSkeleton;"],"names":[],"mappings":";;;;;AACA;;;AAEA,MAAM,uBAAuB,kBAC3B,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,mJAAQ;oCAAC,WAAU;;;;;;8CACpB,6LAAC,mJAAQ;oCAAC,WAAU;;;;;;;;;;;;sCAEtB,6LAAC,mJAAQ;4BAAC,WAAU;;;;;;;;;;;;;;;;;0BAIxB,6LAAC;gBAAI,WAAU;0BACZ;uBAAI,MAAM;iBAAG,CAAC,GAAG,CAAC,CAAC,GAAG,kBACrB,6LAAC,mJAAQ;wBAAS,WAAU;uBAAb;;;;;;;;;;0BAInB,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,mJAAQ;wBAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;KApBtB;uCA0BS"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerExportActions.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Download, FileText } from 'lucide-react';\r\nimport { Customer } from '@/hooks/useCustomers';\r\nimport { exportCustomersToCSV } from '@/utils/exportCustomersToCSV';\r\nimport { exportCustomersToPDF } from '@/utils/exportCustomersToPDF';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface CustomerExportActionsProps {\r\n  customers: Customer[];\r\n  currency: string;\r\n  businessName: string;\r\n  businessLogo?: string;\r\n  getCategoryName: (categoryId: string | null) => string;\r\n  getCustomerLifetimePurchases?: (customerName: string) => { total: number; count: number };\r\n}\r\n\r\nconst CustomerExportActions: React.FC<CustomerExportActionsProps> = ({\r\n  customers,\r\n  currency,\r\n  businessName,\r\n  businessLogo,\r\n  getCategoryName,\r\n  getCustomerLifetimePurchases\r\n}) => {\r\n  const { toast } = useToast();\r\n\r\n  const handleCSVExport = () => {\r\n    try {\r\n      exportCustomersToCSV(customers, currency, getCategoryName, getCustomerLifetimePurchases);\r\n      toast({\r\n        title: \"Success\",\r\n        description: `Exported ${customers.length} customers to CSV`\r\n      });\r\n    } catch (error) {\r\n      console.error('Error exporting to CSV:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to export customers to CSV\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handlePDFExport = () => {\r\n    try {\r\n      exportCustomersToPDF(customers, getCategoryName, currency, businessName, businessLogo, getCustomerLifetimePurchases);\r\n      toast({\r\n        title: \"Success\",\r\n        description: `Exported ${customers.length} customers to PDF`\r\n      });\r\n    } catch (error) {\r\n      console.error('Error exporting to PDF:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to export customers to PDF\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  if (customers.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex gap-2\">\r\n      <Button\r\n        variant=\"outline\"\r\n        size=\"sm\"\r\n        onClick={handleCSVExport}\r\n        className=\"gap-2\"\r\n      >\r\n        <Download className=\"h-4 w-4\" />\r\n        Export CSV\r\n      </Button>\r\n      <Button\r\n        variant=\"outline\"\r\n        size=\"sm\"\r\n        onClick={handlePDFExport}\r\n        className=\"gap-2\"\r\n      >\r\n        <FileText className=\"h-4 w-4\" />\r\n        Export PDF\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CustomerExportActions;"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AAEA;AACA;AACA;;;;;;;;AAWA,MAAM,wBAA8D,CAAC,EACnE,SAAS,EACT,QAAQ,EACR,YAAY,EACZ,YAAY,EACZ,eAAe,EACf,4BAA4B,EAC7B;;IACC,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,2IAAQ;IAE1B,MAAM,kBAAkB;QACtB,IAAI;YACF,IAAA,+JAAoB,EAAC,WAAW,UAAU,iBAAiB;YAC3D,MAAM;gBACJ,OAAO;gBACP,aAAa,CAAC,SAAS,EAAE,UAAU,MAAM,CAAC,iBAAiB,CAAC;YAC9D;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF;IACF;IAEA,MAAM,kBAAkB;QACtB,IAAI;YACF,IAAA,+JAAoB,EAAC,WAAW,iBAAiB,UAAU,cAAc,cAAc;YACvF,MAAM;gBACJ,OAAO;gBACP,aAAa,CAAC,SAAS,EAAE,UAAU,MAAM,CAAC,iBAAiB,CAAC;YAC9D;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF;IACF;IAEA,IAAI,UAAU,MAAM,KAAK,GAAG;QAC1B,OAAO;IACT;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,+IAAM;gBACL,SAAQ;gBACR,MAAK;gBACL,SAAS;gBACT,WAAU;;kCAEV,6LAAC,yNAAQ;wBAAC,WAAU;;;;;;oBAAY;;;;;;;0BAGlC,6LAAC,+IAAM;gBACL,SAAQ;gBACR,MAAK;gBACL,SAAS;gBACT,WAAU;;kCAEV,6LAAC,6NAAQ;wBAAC,WAAU;;;;;;oBAAY;;;;;;;;;;;;;AAKxC;GAtEM;;QAQc,2IAAQ;;;KARtB;uCAwES"}},
    {"offset": {"line": 237, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerHeader.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { UserPlus, Users } from 'lucide-react';\r\nimport { Customer } from '@/hooks/useCustomers';\r\nimport CustomerExportActions from './CustomerExportActions';\r\n\r\ninterface CustomerHeaderProps {\r\n  onAddNewCustomer: () => void;\r\n  onFindDuplicates?: () => void;\r\n  customers?: Customer[];\r\n  currency?: string;\r\n  businessName?: string;\r\n  businessLogo?: string;\r\n  getCategoryName?: (categoryId: string | null) => string;\r\n  getCustomerLifetimePurchases?: (customerName: string) => { total: number; count: number };\r\n  canCreate?: boolean;\r\n}\r\n\r\nconst CustomerHeader: React.FC<CustomerHeaderProps> = ({\r\n  onAddNewCustomer,\r\n  onFindDuplicates,\r\n  customers = [],\r\n  currency = 'UGX',\r\n  businessName = 'Your Business',\r\n  businessLogo,\r\n  getCategoryName = () => 'Uncategorized',\r\n  getCustomerLifetimePurchases,\r\n  canCreate = true\r\n}) => {\r\n  return (\r\n    <div className=\"bg-white rounded-lg border p-6\">\r\n      <div className=\"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6\">\r\n        <div className=\"space-y-2\">\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">Customer Management</h1>\r\n          <p className=\"text-gray-600\">Manage your customer relationships and track their activities</p>\r\n        </div>\r\n        <div className=\"flex flex-col sm:flex-row gap-3\">\r\n          <CustomerExportActions\r\n            customers={customers}\r\n            currency={currency}\r\n            businessName={businessName}\r\n            businessLogo={businessLogo}\r\n            getCategoryName={getCategoryName}\r\n            getCustomerLifetimePurchases={getCustomerLifetimePurchases}\r\n          />\r\n          {onFindDuplicates && (\r\n            <Button onClick={onFindDuplicates} variant=\"outline\" className=\"gap-2 px-6 py-3 text-sm font-medium\">\r\n              <Users className=\"h-4 w-4\" />\r\n              Find Duplicates\r\n            </Button>\r\n          )}\r\n          {canCreate && (\r\n            <Button onClick={onAddNewCustomer} className=\"gap-2 px-6 py-3 text-sm font-medium\">\r\n              <UserPlus className=\"h-4 w-4\" />\r\n              Add New Customer\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CustomerHeader;"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AAEA;;;;;AAcA,MAAM,iBAAgD,CAAC,EACrD,gBAAgB,EAChB,gBAAgB,EAChB,YAAY,EAAE,EACd,WAAW,KAAK,EAChB,eAAe,eAAe,EAC9B,YAAY,EACZ,kBAAkB,IAAM,eAAe,EACvC,4BAA4B,EAC5B,YAAY,IAAI,EACjB;IACC,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;sCAAmC;;;;;;sCACjD,6LAAC;4BAAE,WAAU;sCAAgB;;;;;;;;;;;;8BAE/B,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,sKAAqB;4BACpB,WAAW;4BACX,UAAU;4BACV,cAAc;4BACd,cAAc;4BACd,iBAAiB;4BACjB,8BAA8B;;;;;;wBAE/B,kCACC,6LAAC,+IAAM;4BAAC,SAAS;4BAAkB,SAAQ;4BAAU,WAAU;;8CAC7D,6LAAC,gNAAK;oCAAC,WAAU;;;;;;gCAAY;;;;;;;wBAIhC,2BACC,6LAAC,+IAAM;4BAAC,SAAS;4BAAkB,WAAU;;8CAC3C,6LAAC,6NAAQ;oCAAC,WAAU;;;;;;gCAAY;;;;;;;;;;;;;;;;;;;;;;;;AAQ9C;KA3CM;uCA6CS"}},
    {"offset": {"line": 362, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerStatsCards.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Users, TrendingUp, Calendar } from 'lucide-react';\r\n\r\ninterface CustomerStatsCardsProps {\r\n  customerStats: {\r\n    totalCustomers: number;\r\n    customersThisMonth: number;\r\n    customersWithBirthdays: number;\r\n  };\r\n}\r\n\r\nconst CustomerStatsCards: React.FC<CustomerStatsCardsProps> = ({ customerStats }) => {\r\n  return (\r\n    <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-6\">\r\n      <Card className=\"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200 hover:shadow-md transition-shadow\">\r\n        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-3\">\r\n          <CardTitle className=\"text-sm font-semibold text-blue-900\">Total Customers</CardTitle>\r\n          <div className=\"p-2 bg-blue-500 rounded-lg\">\r\n            <Users className=\"h-4 w-4 text-white\" />\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"text-3xl font-bold text-blue-900\">{customerStats.totalCustomers}</div>\r\n          <p className=\"text-xs text-blue-700 mt-1\">Active customer base</p>\r\n        </CardContent>\r\n      </Card>\r\n      \r\n      <Card className=\"bg-gradient-to-br from-green-50 to-green-100 border-green-200 hover:shadow-md transition-shadow\">\r\n        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-3\">\r\n          <CardTitle className=\"text-sm font-semibold text-green-900\">New This Month</CardTitle>\r\n          <div className=\"p-2 bg-green-500 rounded-lg\">\r\n            <TrendingUp className=\"h-4 w-4 text-white\" />\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"text-3xl font-bold text-green-900\">{customerStats.customersThisMonth}</div>\r\n          <p className=\"text-xs text-green-700 mt-1\">Recent acquisitions</p>\r\n        </CardContent>\r\n      </Card>\r\n      \r\n      <Card className=\"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200 hover:shadow-md transition-shadow\">\r\n        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-3\">\r\n          <CardTitle className=\"text-sm font-semibold text-purple-900\">With Birthdays</CardTitle>\r\n          <div className=\"p-2 bg-purple-500 rounded-lg\">\r\n            <Calendar className=\"h-4 w-4 text-white\" />\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"text-3xl font-bold text-purple-900\">{customerStats.customersWithBirthdays}</div>\r\n          <p className=\"text-xs text-purple-700 mt-1\">Special occasions</p>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CustomerStatsCards;"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AAAA;;;;AAUA,MAAM,qBAAwD,CAAC,EAAE,aAAa,EAAE;IAC9E,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,2IAAI;gBAAC,WAAU;;kCACd,6LAAC,iJAAU;wBAAC,WAAU;;0CACpB,6LAAC,gJAAS;gCAAC,WAAU;0CAAsC;;;;;;0CAC3D,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,gNAAK;oCAAC,WAAU;;;;;;;;;;;;;;;;;kCAGrB,6LAAC,kJAAW;;0CACV,6LAAC;gCAAI,WAAU;0CAAoC,cAAc,cAAc;;;;;;0CAC/E,6LAAC;gCAAE,WAAU;0CAA6B;;;;;;;;;;;;;;;;;;0BAI9C,6LAAC,2IAAI;gBAAC,WAAU;;kCACd,6LAAC,iJAAU;wBAAC,WAAU;;0CACpB,6LAAC,gJAAS;gCAAC,WAAU;0CAAuC;;;;;;0CAC5D,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,mOAAU;oCAAC,WAAU;;;;;;;;;;;;;;;;;kCAG1B,6LAAC,kJAAW;;0CACV,6LAAC;gCAAI,WAAU;0CAAqC,cAAc,kBAAkB;;;;;;0CACpF,6LAAC;gCAAE,WAAU;0CAA8B;;;;;;;;;;;;;;;;;;0BAI/C,6LAAC,2IAAI;gBAAC,WAAU;;kCACd,6LAAC,iJAAU;wBAAC,WAAU;;0CACpB,6LAAC,gJAAS;gCAAC,WAAU;0CAAwC;;;;;;0CAC7D,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,yNAAQ;oCAAC,WAAU;;;;;;;;;;;;;;;;;kCAGxB,6LAAC,kJAAW;;0CACV,6LAAC;gCAAI,WAAU;0CAAsC,cAAc,sBAAsB;;;;;;0CACzF,6LAAC;gCAAE,WAAU;0CAA+B;;;;;;;;;;;;;;;;;;;;;;;;AAKtD;KA3CM;uCA6CS"}},
    {"offset": {"line": 588, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerTabs.tsx"],"sourcesContent":["import React from 'react';\r\nimport { TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Users, TrendingUp, Calendar, Filter, FileText } from 'lucide-react';\r\nimport { Customer } from '@/hooks/useCustomers';\r\n\r\ninterface CustomerTabsProps {\r\n  activeTab: string;\r\n  selectedCustomer: Customer | null;\r\n}\r\n\r\nconst CustomerTabs: React.FC<CustomerTabsProps> = ({ activeTab, selectedCustomer }) => {\r\n  return (\r\n    <TabsList className=\"grid w-full grid-cols-2 lg:grid-cols-4 h-14 bg-white border border-gray-200 shadow-sm p-1.5 rounded-lg\">\r\n      <TabsTrigger\r\n        value=\"list\"\r\n        className=\"flex items-center gap-2.5 text-sm font-medium px-4 py-2.5 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:border-blue-200 data-[state=active]:shadow-sm rounded-md transition-all duration-200\"\r\n      >\r\n        <Users className=\"h-4 w-4\" />\r\n        <span className=\"hidden sm:inline\">All Customers</span>\r\n        <span className=\"sm:hidden\">All</span>\r\n      </TabsTrigger>\r\n      <TabsTrigger\r\n        value=\"top\"\r\n        className=\"flex items-center gap-2.5 text-sm font-medium px-4 py-2.5 data-[state=active]:bg-amber-50 data-[state=active]:text-amber-700 data-[state=active]:border-amber-200 data-[state=active]:shadow-sm rounded-md transition-all duration-200\"\r\n      >\r\n        <TrendingUp className=\"h-4 w-4\" />\r\n        <span className=\"hidden sm:inline\">Top Customers</span>\r\n        <span className=\"sm:hidden\">Top</span>\r\n      </TabsTrigger>\r\n      <TabsTrigger\r\n        value=\"inactive\"\r\n        className=\"flex items-center gap-2.5 text-sm font-medium px-4 py-2.5 data-[state=active]:bg-orange-50 data-[state=active]:text-orange-700 data-[state=active]:border-orange-200 data-[state=active]:shadow-sm rounded-md transition-all duration-200\"\r\n      >\r\n        <Calendar className=\"h-4 w-4\" />\r\n        <span className=\"hidden sm:inline\">Inactive</span>\r\n        <span className=\"sm:hidden\">Inactive</span>\r\n      </TabsTrigger>\r\n      {selectedCustomer && (\r\n        <>\r\n          <TabsTrigger\r\n            value=\"details\"\r\n            className=\"flex items-center gap-2.5 text-sm font-medium px-4 py-2.5 data-[state=active]:bg-purple-50 data-[state=active]:text-purple-700 data-[state=active]:border-purple-200 data-[state=active]:shadow-sm rounded-md transition-all duration-200\"\r\n          >\r\n            <Filter className=\"h-4 w-4\" />\r\n            <span className=\"hidden sm:inline\">Details</span>\r\n            <span className=\"sm:hidden\">Details</span>\r\n          </TabsTrigger>\r\n        </>\r\n      )}\r\n    </TabsList>\r\n  );\r\n};\r\n\r\nexport default CustomerTabs;"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AAAA;AAAA;;;;AAQA,MAAM,eAA4C,CAAC,EAAE,SAAS,EAAE,gBAAgB,EAAE;IAChF,qBACE,6LAAC,+IAAQ;QAAC,WAAU;;0BAClB,6LAAC,kJAAW;gBACV,OAAM;gBACN,WAAU;;kCAEV,6LAAC,gNAAK;wBAAC,WAAU;;;;;;kCACjB,6LAAC;wBAAK,WAAU;kCAAmB;;;;;;kCACnC,6LAAC;wBAAK,WAAU;kCAAY;;;;;;;;;;;;0BAE9B,6LAAC,kJAAW;gBACV,OAAM;gBACN,WAAU;;kCAEV,6LAAC,mOAAU;wBAAC,WAAU;;;;;;kCACtB,6LAAC;wBAAK,WAAU;kCAAmB;;;;;;kCACnC,6LAAC;wBAAK,WAAU;kCAAY;;;;;;;;;;;;0BAE9B,6LAAC,kJAAW;gBACV,OAAM;gBACN,WAAU;;kCAEV,6LAAC,yNAAQ;wBAAC,WAAU;;;;;;kCACpB,6LAAC;wBAAK,WAAU;kCAAmB;;;;;;kCACnC,6LAAC;wBAAK,WAAU;kCAAY;;;;;;;;;;;;YAE7B,kCACC;0BACE,cAAA,6LAAC,kJAAW;oBACV,OAAM;oBACN,WAAU;;sCAEV,6LAAC,mNAAM;4BAAC,WAAU;;;;;;sCAClB,6LAAC;4BAAK,WAAU;sCAAmB;;;;;;sCACnC,6LAAC;4BAAK,WAAU;sCAAY;;;;;;;;;;;;;;;;;;;AAMxC;KAzCM;uCA2CS"}},
    {"offset": {"line": 757, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerFilters.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Search, CalendarIcon } from 'lucide-react';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\r\nimport { Calendar } from \"@/components/ui/calendar\";\r\nimport { format } from \"date-fns\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface CustomerFiltersProps {\r\n  activeTab: string;\r\n  searchTerm: string;\r\n  setSearchTerm: (term: string) => void;\r\n  selectedCategory: string;\r\n  setSelectedCategory: (category: string) => void;\r\n  dateFilter: string;\r\n  setDateFilter: (filter: string) => void;\r\n  dateRange: { from: Date | undefined; to: Date | undefined };\r\n  setDateRange: (range: { from: Date | undefined; to: Date | undefined }) => void;\r\n  validCategories: Array<{ id: string; name: string }>;\r\n  filteredCustomers: any[];\r\n  customerStats: {\r\n    categoryBreakdown: Record<string, number>;\r\n  };\r\n  getCategoryName: (categoryId: string | null) => string;\r\n}\r\n\r\nconst CustomerFilters: React.FC<CustomerFiltersProps> = ({\r\n  activeTab,\r\n  searchTerm,\r\n  setSearchTerm,\r\n  selectedCategory,\r\n  setSelectedCategory,\r\n  dateFilter,\r\n  setDateFilter,\r\n  dateRange,\r\n  setDateRange,\r\n  validCategories,\r\n  filteredCustomers,\r\n  customerStats,\r\n  getCategoryName\r\n}) => {\r\n  const isCustomRange = dateFilter === 'custom';\r\n\r\n  // Ensure dateRange has valid default values\r\n  const safeDateRange = dateRange || { from: undefined, to: undefined };\r\n\r\n  if (activeTab !== 'list' && activeTab !== 'top' && activeTab !== 'inactive') {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"xl:w-80 w-full space-y-4\">\r\n      <div>\r\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Search & Filter</h3>\r\n        <p className=\"text-gray-600 text-sm\">Find customers quickly</p>\r\n      </div>\r\n      {activeTab === 'list' && (\r\n        <div className=\"relative\">\r\n          <Search className=\"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5\" />\r\n          <Input\r\n            placeholder=\"Search by name, contact, or location...\"\r\n            autoComplete=\"off\"\r\n            className=\"pl-12 h-12 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500 rounded-lg shadow-sm transition-all duration-200\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* Category Filter */}\r\n      <div className=\"space-y-2\">\r\n        <Label className=\"text-sm font-medium\">Filter by Category</Label>\r\n        <Select value={selectedCategory} onValueChange={setSelectedCategory}>\r\n          <SelectTrigger className=\"h-12\">\r\n            <SelectValue placeholder=\"All categories\" />\r\n          </SelectTrigger>\r\n          <SelectContent>\r\n            <SelectItem value=\"all\">All Categories</SelectItem>\r\n            {validCategories.map((category) => (\r\n              <SelectItem key={category.id} value={category.id}>\r\n                {category.name} ({customerStats.categoryBreakdown[category.id] || 0})\r\n              </SelectItem>\r\n            ))}\r\n          </SelectContent>\r\n        </Select>\r\n      </div>\r\n\r\n      {/* Date Filter */}\r\n      {(activeTab === 'top' || activeTab === 'list') && (\r\n        <div className=\"space-y-2\">\r\n          <Label className=\"text-sm font-medium\">Filter by Date</Label>\r\n          <Select value={dateFilter} onValueChange={setDateFilter}>\r\n            <SelectTrigger className=\"h-12\">\r\n              <SelectValue placeholder=\"All time\" />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"all\">All Time</SelectItem>\r\n              <SelectItem value=\"today\">Today</SelectItem>\r\n              <SelectItem value=\"yesterday\">Yesterday</SelectItem>\r\n              <SelectItem value=\"this-week\">This Week</SelectItem>\r\n              <SelectItem value=\"last-week\">Last Week</SelectItem>\r\n              <SelectItem value=\"this-month\">This Month</SelectItem>\r\n              <SelectItem value=\"last-month\">Last Month</SelectItem>\r\n              <SelectItem value=\"this-year\">This Year</SelectItem>\r\n              <SelectItem value=\"custom\">Custom Range</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n      )}\r\n\r\n      {/* Custom Date Range Picker */}\r\n      {isCustomRange && (activeTab === 'top' || activeTab === 'list') && (\r\n        <div className=\"space-y-2\">\r\n          <Label className=\"text-sm font-medium\">Select Date Range</Label>\r\n          <div className=\"flex flex-col gap-2\">\r\n            <Popover>\r\n              <PopoverTrigger asChild>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className={cn(\r\n                    \"w-full justify-start text-left font-normal h-12\",\r\n                    !safeDateRange.from && \"text-muted-foreground\"\r\n                  )}\r\n                >\r\n                  <CalendarIcon className=\"mr-2 h-4 w-4\" />\r\n                  {safeDateRange.from ? format(safeDateRange.from, \"MMM d, yyyy\") : \"Start Date\"}\r\n                </Button>\r\n              </PopoverTrigger>\r\n              <PopoverContent className=\"w-auto p-0 z-[9999]\" align=\"start\">\r\n                <Calendar\r\n                  mode=\"single\"\r\n                  selected={safeDateRange.from}\r\n                  onSelect={(date) => setDateRange({ ...safeDateRange, from: date })}\r\n                  initialFocus\r\n                  className={cn(\"p-3 pointer-events-auto\")}\r\n                />\r\n              </PopoverContent>\r\n            </Popover>\r\n\r\n            <Popover>\r\n              <PopoverTrigger asChild>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className={cn(\r\n                    \"w-full justify-start text-left font-normal h-12\",\r\n                    !safeDateRange.to && \"text-muted-foreground\"\r\n                  )}\r\n                >\r\n                  <CalendarIcon className=\"mr-2 h-4 w-4\" />\r\n                  {safeDateRange.to ? format(safeDateRange.to, \"MMM d, yyyy\") : \"End Date\"}\r\n                </Button>\r\n              </PopoverTrigger>\r\n              <PopoverContent className=\"w-auto p-0 z-[9999]\" align=\"start\">\r\n                <Calendar\r\n                  mode=\"single\"\r\n                  selected={safeDateRange.to}\r\n                  onSelect={(date) => setDateRange({ ...safeDateRange, to: date })}\r\n                  initialFocus\r\n                  className={cn(\"p-3 pointer-events-auto\")}\r\n                />\r\n              </PopoverContent>\r\n            </Popover>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {(searchTerm || selectedCategory !== 'all') && activeTab === 'list' && (\r\n        <div className=\"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\r\n          <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\r\n          <p className=\"text-sm text-blue-700 font-medium\">\r\n            Found {filteredCustomers.length} customer{filteredCustomers.length !== 1 ? 's' : ''}\r\n            {selectedCategory !== 'all' && ` in ${getCategoryName(selectedCategory)}`}\r\n          </p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CustomerFilters;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1221, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/NoticeTemplateSelector.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { NoticeTemplate, noticeTemplates } from '@/utils/noticeTemplates';\r\n\r\ninterface NoticeTemplateSelectorProps {\r\n  selectedTemplate: string;\r\n  onTemplateChange: (templateId: string) => void;\r\n  onTemplateSelect: (template: NoticeTemplate) => void;\r\n}\r\n\r\nconst NoticeTemplateSelector: React.FC<NoticeTemplateSelectorProps> = ({\r\n  selectedTemplate,\r\n  onTemplateChange,\r\n  onTemplateSelect\r\n}) => {\r\n  const handleTemplateChange = (templateId: string) => {\r\n    onTemplateChange(templateId);\r\n    if (templateId === 'none') {\r\n      // Clear template selection\r\n      return;\r\n    }\r\n    const template = noticeTemplates.find(t => t.id === templateId);\r\n    if (template) {\r\n      onTemplateSelect(template);\r\n    }\r\n  };\r\n\r\n  const getCategoryColor = (category: string) => {\r\n    const colors = {\r\n      payment: 'bg-red-50 text-red-700 border-red-200',\r\n      policy: 'bg-blue-50 text-blue-700 border-blue-200',\r\n      general: 'bg-gray-50 text-gray-700 border-gray-200',\r\n      announcement: 'bg-green-50 text-green-700 border-green-200',\r\n      gratitude: 'bg-purple-50 text-purple-700 border-purple-200'\r\n    };\r\n    return colors[category as keyof typeof colors] || colors.general;\r\n  };\r\n\r\n  // Type guard to ensure we have a valid array\r\n  const templates = Array.isArray(noticeTemplates) ? noticeTemplates : [];\r\n\r\n  return (\r\n    <div className=\"space-y-2\">\r\n      <label className=\"text-sm font-medium text-gray-700\">\r\n        Choose a Template (Optional)\r\n      </label>\r\n      <Select value={selectedTemplate} onValueChange={handleTemplateChange}>\r\n        <SelectTrigger className=\"w-full\">\r\n          <SelectValue placeholder=\"Select a notice template or start from scratch\" />\r\n        </SelectTrigger>\r\n        <SelectContent className=\"max-h-80\">\r\n          <SelectItem value=\"none\">Start from scratch</SelectItem>\r\n          {templates.length > 0 && templates.map((template) => (\r\n            <SelectItem key={template.id} value={template.id}>\r\n              <div className=\"flex items-center justify-between w-full\">\r\n                <span className=\"font-medium\">{template.name}</span>\r\n                <Badge \r\n                  variant=\"outline\" \r\n                  className={`ml-2 text-xs ${getCategoryColor(template.category)}`}\r\n                >\r\n                  {template.category}\r\n                </Badge>\r\n              </div>\r\n            </SelectItem>\r\n          ))}\r\n        </SelectContent>\r\n      </Select>\r\n      \r\n      {selectedTemplate && selectedTemplate !== 'none' && (\r\n        <div className=\"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-md\">\r\n          <p className=\"text-sm text-blue-800\">\r\n            <strong>Template selected:</strong> {templates.find(t => t.id === selectedTemplate)?.name}\r\n          </p>\r\n          <p className=\"text-xs text-blue-600 mt-1\">\r\n            The template content has been added to your message. You can edit it as needed.\r\n          </p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NoticeTemplateSelector;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;;;AAQA,MAAM,yBAAgE,CAAC,EACrE,gBAAgB,EAChB,gBAAgB,EAChB,gBAAgB,EACjB;IACC,MAAM,uBAAuB,CAAC;QAC5B,iBAAiB;QACjB,IAAI,eAAe,QAAQ;YACzB,2BAA2B;YAC3B;QACF;QACA,MAAM,WAAW,qJAAe,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QACpD,IAAI,UAAU;YACZ,iBAAiB;QACnB;IACF;IAEA,MAAM,mBAAmB,CAAC;QACxB,MAAM,SAAS;YACb,SAAS;YACT,QAAQ;YACR,SAAS;YACT,cAAc;YACd,WAAW;QACb;QACA,OAAO,MAAM,CAAC,SAAgC,IAAI,OAAO,OAAO;IAClE;IAEA,6CAA6C;IAC7C,MAAM,YAAY,MAAM,OAAO,CAAC,qJAAe,IAAI,qJAAe,GAAG,EAAE;IAEvE,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAM,WAAU;0BAAoC;;;;;;0BAGrD,6LAAC,+IAAM;gBAAC,OAAO;gBAAkB,eAAe;;kCAC9C,6LAAC,sJAAa;wBAAC,WAAU;kCACvB,cAAA,6LAAC,oJAAW;4BAAC,aAAY;;;;;;;;;;;kCAE3B,6LAAC,sJAAa;wBAAC,WAAU;;0CACvB,6LAAC,mJAAU;gCAAC,OAAM;0CAAO;;;;;;4BACxB,UAAU,MAAM,GAAG,KAAK,UAAU,GAAG,CAAC,CAAC,yBACtC,6LAAC,mJAAU;oCAAmB,OAAO,SAAS,EAAE;8CAC9C,cAAA,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAK,WAAU;0DAAe,SAAS,IAAI;;;;;;0DAC5C,6LAAC,6IAAK;gDACJ,SAAQ;gDACR,WAAW,CAAC,aAAa,EAAE,iBAAiB,SAAS,QAAQ,GAAG;0DAE/D,SAAS,QAAQ;;;;;;;;;;;;mCAPP,SAAS,EAAE;;;;;;;;;;;;;;;;;YAejC,oBAAoB,qBAAqB,wBACxC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAE,WAAU;;0CACX,6LAAC;0CAAO;;;;;;4BAA2B;4BAAE,UAAU,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,mBAAmB;;;;;;;kCAEvF,6LAAC;wBAAE,WAAU;kCAA6B;;;;;;;;;;;;;;;;;;AAOpD;KAtEM;uCAwES"}},
    {"offset": {"line": 1395, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/BusinessNoticeGenerator.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { FileText, Wand2, Download, AlertCircle, MessageSquare } from 'lucide-react';\r\nimport { Customer, Sale } from '@/types';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { generateNoticePDF } from '@/utils/generateNoticePDF';\r\nimport { formalizeText, enhanceForBusiness } from '@/utils/formalizeText';\r\nimport { NoticeTemplate, getTemplateById } from '@/utils/noticeTemplates';\r\nimport { openSMSApp, formatMessageForSMS, canSendSMS, openWhatsApp } from '@/utils/smsUtils';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { MessageCircle } from 'lucide-react';\r\nimport NoticeTemplateSelector from './NoticeTemplateSelector';\r\n\r\ninterface BusinessNoticeGeneratorProps {\r\n  customer: Customer;\r\n  open: boolean;\r\n  onClose: () => void;\r\n  defaultTemplate?: string;\r\n  sale?: Sale;\r\n}\r\n\r\nconst BusinessNoticeGenerator: React.FC<BusinessNoticeGeneratorProps> = ({\r\n  customer,\r\n  open,\r\n  onClose,\r\n  defaultTemplate,\r\n  sale\r\n}) => {\r\n  const [selectedTemplate, setSelectedTemplate] = useState<string>('none');\r\n  const [subject, setSubject] = useState<string>('');\r\n  const [message, setMessage] = useState<string>('');\r\n  const [senderName, setSenderName] = useState<string>('');\r\n  const [isGenerating, setIsGenerating] = useState<boolean>(false);\r\n  const [showPreview, setShowPreview] = useState<boolean>(false);\r\n\r\n  const { settings } = useBusinessSettings();\r\n  const { toast } = useToast();\r\n  const isMobile = useIsMobile();\r\n\r\n  // Load default template when dialog opens\r\n  useEffect(() => {\r\n    if (open && defaultTemplate) {\r\n      const template = getTemplateById(defaultTemplate);\r\n      if (template) {\r\n        setSelectedTemplate(defaultTemplate);\r\n        setSubject(template.subject);\r\n\r\n        // If it's a thank you template and we have sale data, enhance the content\r\n        if (defaultTemplate === 'thank_you' && sale) {\r\n          const saleTotal = sale.items.reduce((total, item) => {\r\n            const itemSubtotal = item.price * item.quantity;\r\n            const discountAmount = item.discountType === 'amount'\r\n              ? (item.discountAmount || 0)\r\n              : (itemSubtotal * (item.discountPercentage || 0)) / 100;\r\n            return total + (itemSubtotal - discountAmount);\r\n          }, 0);\r\n\r\n          // Add tax if applicable\r\n          const taxAmount = saleTotal * ((sale.taxRate || 0) / 100);\r\n          const totalWithTax = saleTotal + taxAmount;\r\n\r\n          // Create items list\r\n          const itemsList = sale.items.map(item =>\r\n            `â€¢ ${item.description} (Qty: ${item.quantity})`\r\n          ).join('\\n');\r\n\r\n          const enhancedContent = `${template.content}\r\n\r\nReceipt Number: ${sale.receiptNumber}\r\n\r\nItems Purchased:\r\n${itemsList}\r\n\r\nTotal Amount: ${settings.currency} ${totalWithTax.toFixed(2)}\r\n\r\nIn case of any inquiries please call ${settings.businessPhone && settings.businessPhone !== '(123) 456-7890' ? settings.businessPhone : 'our office'}.\r\n\r\nWe appreciate your business and look forward to serving you again.`;\r\n\r\n          setMessage(enhancedContent);\r\n        } else {\r\n          setMessage(template.content);\r\n        }\r\n      }\r\n    }\r\n  }, [open, defaultTemplate, sale, settings.currency, settings.businessPhone]);\r\n\r\n  const handleTemplateSelect = (template: NoticeTemplate) => {\r\n    setSubject(template.subject);\r\n    setMessage(template.content);\r\n  };\r\n\r\n  const handleMakeFormal = () => {\r\n    if (!message.trim() || message === 'Write your message here...' || message === 'Write your specific message here...') {\r\n      toast({\r\n        title: \"No message to enhance\",\r\n        description: \"Please enter your message first.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const enhanced = enhanceForBusiness(message);\r\n      setMessage(enhanced);\r\n\r\n      toast({\r\n        title: \"Message enhanced!\",\r\n        description: \"Your message has been made more formal and professional.\",\r\n      });\r\n    } catch (error) {\r\n      console.error('Error enhancing message:', error);\r\n      toast({\r\n        title: \"Enhancement failed\",\r\n        description: \"Could not enhance the message. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleGeneratePDF = async () => {\r\n    if (!message.trim() || message === 'Write your message here...' || message === 'Write your specific message here...') {\r\n      toast({\r\n        title: \"Message required\",\r\n        description: \"Please enter a message before generating the notice.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsGenerating(true);\r\n\r\n    try {\r\n      await generateNoticePDF(\r\n        {\r\n          customer,\r\n          subject: subject || 'Business Notice',\r\n          content: message,\r\n          senderName: senderName || undefined\r\n        },\r\n        settings\r\n      );\r\n\r\n      toast({\r\n        title: \"Notice generated successfully!\",\r\n        description: \"Your professional business notice has been downloaded as a PDF.\",\r\n      });\r\n\r\n      // Reset form after successful generation\r\n      setMessage('');\r\n      setSubject('');\r\n      setSelectedTemplate('none');\r\n      setSenderName('');\r\n      onClose();\r\n\r\n    } catch (error) {\r\n      console.error('Error generating notice:', error);\r\n      toast({\r\n        title: \"Generation failed\",\r\n        description: \"Failed to generate the notice. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsGenerating(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setMessage('');\r\n    setSubject('');\r\n    setSelectedTemplate('none');\r\n    setSenderName('');\r\n    setShowPreview(false);\r\n    onClose();\r\n  };\r\n\r\n  const handleSendSMS = () => {\r\n    if (!message.trim() || message === 'Write your message here...' || message === 'Write your specific message here...') {\r\n      toast({\r\n        title: \"Message required\",\r\n        description: \"Please enter a message before sending SMS.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (!canSendSMS(customer)) {\r\n      toast({\r\n        title: \"Phone number required\",\r\n        description: \"Customer phone number is not available.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Format the message for SMS\r\n      const fullMessage = `${subject ? subject + '\\n\\n' : ''}Dear ${customer.fullName},\\n\\n${message}\\n\\nYours faithfully,\\n${senderName || settings.businessName || 'Management'}`;\r\n\r\n      const formattedMessage = formatMessageForSMS(fullMessage, settings.businessName);\r\n\r\n      openSMSApp({\r\n        phoneNumber: customer.phoneNumber!,\r\n        message: formattedMessage\r\n      });\r\n\r\n      toast({\r\n        title: \"SMS app opened\",\r\n        description: \"Your message has been prepared in the SMS app.\",\r\n      });\r\n\r\n    } catch (error) {\r\n      console.error('Error sending SMS:', error);\r\n      toast({\r\n        title: \"SMS failed\",\r\n        description: \"Failed to open SMS app. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const showSMSOption = isMobile && canSendSMS(customer);\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleClose}>\r\n      <DialogContent className=\"w-[95vw] sm:max-w-4xl max-h-[90vh] overflow-y-auto p-4 sm:p-6\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2 text-base sm:text-lg\">\r\n            <FileText className=\"h-5 w-5\" />\r\n            Send Notice to {customer.fullName}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-2\">\r\n          {/* Compose Section */}\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <h3 className=\"text-base sm:text-lg font-semibold mb-3\">Compose Your Notice</h3>\r\n\r\n              {/* Template Selector */}\r\n              <NoticeTemplateSelector\r\n                selectedTemplate={selectedTemplate}\r\n                onTemplateChange={setSelectedTemplate}\r\n                onTemplateSelect={handleTemplateSelect}\r\n              />\r\n            </div>\r\n\r\n            {/* Subject */}\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"subject\" className=\"text-sm\">Subject Line</Label>\r\n              <Input\r\n                id=\"subject\"\r\n                value={subject}\r\n                onChange={(e) => setSubject(e.target.value)}\r\n                placeholder=\"Enter the subject of your notice\"\r\n                className=\"text-sm h-9\"\r\n              />\r\n            </div>\r\n\r\n            {/* Message */}\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Label htmlFor=\"message\" className=\"text-sm\">Your Message</Label>\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={handleMakeFormal}\r\n                  className=\"text-[10px] h-7 px-2\"\r\n                  disabled={!message.trim() || message === 'Write your message here...' || message === 'Write your specific message here...'}\r\n                >\r\n                  <Wand2 className=\"h-3 w-3 mr-1\" />\r\n                  Make Formal\r\n                </Button>\r\n              </div>\r\n              <Textarea\r\n                id=\"message\"\r\n                value={message}\r\n                onChange={(e) => setMessage(e.target.value)}\r\n                placeholder=\"What do you want to inform the customer about?\"\r\n                rows={isMobile ? 6 : 8}\r\n                className=\"resize-none text-sm\"\r\n              />\r\n              <p className=\"text-[10px] text-gray-500 leading-tight\">\r\n                {selectedTemplate !== 'none' ? 'Template content loaded. Edit as needed.' : 'Write in your own words - we\\'ll format it professionally.'}\r\n              </p>\r\n            </div>\r\n\r\n            {/* Sender Name */}\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"sender\" className=\"text-sm\">Sender Name (Optional)</Label>\r\n              <Input\r\n                id=\"sender\"\r\n                value={senderName}\r\n                onChange={(e) => setSenderName(e.target.value)}\r\n                placeholder=\"Your name (defaults to business name)\"\r\n                className=\"text-sm h-9\"\r\n              />\r\n            </div>\r\n\r\n            {/* Business Settings Alert */}\r\n            {(!settings.businessLogo || !settings.signature) && (\r\n              <Card className=\"border-amber-200 bg-amber-50\">\r\n                <CardContent className=\"p-3\">\r\n                  <div className=\"flex items-start gap-2\">\r\n                    <AlertCircle className=\"h-4 w-4 text-amber-600 mt-0.5 flex-shrink-0\" />\r\n                    <div className=\"text-[11px] sm:text-xs\">\r\n                      <p className=\"text-amber-800 font-medium\">Enhance your notices</p>\r\n                      <p className=\"text-amber-700\">\r\n                        {!settings.businessLogo && 'Add logo '}\r\n                        {(!settings.businessLogo && !settings.signature) && 'and '}\r\n                        {!settings.signature && 'upload signature '}\r\n                        in settings for better notices.\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n          </div>\r\n\r\n          {/* Preview Section */}\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h3 className=\"text-base sm:text-lg font-semibold\">Preview</h3>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => setShowPreview(!showPreview)}\r\n                className=\"h-8 text-xs\"\r\n              >\r\n                {showPreview ? 'Hide' : 'Show'} Preview\r\n              </Button>\r\n            </div>\r\n\r\n            {showPreview && (\r\n              <Card className=\"border-gray-200 shadow-sm\">\r\n                <CardContent className=\"p-4 overflow-x-hidden\">\r\n                  <div className=\"space-y-3 text-[11px] sm:text-sm\">\r\n                    {/* Header */}\r\n                    <div className=\"border-b pb-2\">\r\n                      <div className=\"font-bold text-sm sm:text-base\">{settings.businessName || 'Your Business'}</div>\r\n                      <div className=\"text-gray-600 space-y-0.5\">\r\n                        {settings.businessAddress && <div className=\"truncate\">{settings.businessAddress}</div>}\r\n                        {settings.businessPhone && <div>Phone: {settings.businessPhone}</div>}\r\n                        {settings.businessEmail && <div className=\"truncate\">Email: {settings.businessEmail}</div>}\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Date and Customer */}\r\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\r\n                      <div>Date: {new Date().toLocaleDateString()}</div>\r\n                      <div className=\"font-medium truncate\">{customer.fullName}</div>\r\n                    </div>\r\n\r\n                    {/* Subject */}\r\n                    {subject && (\r\n                      <div className=\"bg-gray-50 p-2 rounded\">\r\n                        <strong>Re: {subject}</strong>\r\n                      </div>\r\n                    )}\r\n\r\n                    {/* Content */}\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"italic\">Dear {customer.fullName},</div>\r\n                      <div className=\"whitespace-pre-wrap leading-relaxed text-gray-800\">\r\n                        {message || 'Your message will appear here...'}\r\n                      </div>\r\n                      <div>Yours faithfully,</div>\r\n                      <div className=\"mt-4 font-bold\">\r\n                        {senderName || settings.businessName || 'Management'}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Actions - Responsive Footer */}\r\n        <div className=\"flex flex-col sm:flex-row justify-end gap-2 sm:gap-3 pt-4 border-t mt-2\">\r\n          <div className=\"flex gap-2 w-full sm:w-auto\">\r\n            <Button variant=\"outline\" onClick={handleClose} className=\"flex-1 sm:flex-none h-10 text-sm\">\r\n              Cancel\r\n            </Button>\r\n            {canSendSMS(customer) && (\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => {\r\n                  openWhatsApp({\r\n                    phoneNumber: customer.phoneNumber!,\r\n                    message: `${subject ? subject + '\\n\\n' : ''}Dear ${customer.fullName},\\n\\n${message}\\n\\nYours faithfully,\\n${senderName || settings.businessName || 'Management'}`\r\n                  });\r\n                  toast({\r\n                    title: \"WhatsApp opened\",\r\n                    description: \"Your message has been prepared in WhatsApp.\",\r\n                  });\r\n                }}\r\n                disabled={!message.trim() || message === 'Write your message here...' || message === 'Write your specific message here...'}\r\n                className=\"flex-1 sm:flex-none gap-2 text-green-600 hover:text-green-700 hover:bg-green-50 h-10 text-sm\"\r\n              >\r\n                <MessageCircle className=\"h-4 w-4\" />\r\n                WhatsApp\r\n              </Button>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"flex gap-2 w-full sm:w-auto\">\r\n            {showSMSOption && (\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={handleSendSMS}\r\n                disabled={!message.trim() || message === 'Write your message here...' || message === 'Write your specific message here...'}\r\n                className=\"flex-1 sm:flex-none gap-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 h-10 text-sm\"\r\n              >\r\n                <MessageSquare className=\"h-4 w-4\" />\r\n                SMS\r\n              </Button>\r\n            )}\r\n            <Button\r\n              onClick={handleGeneratePDF}\r\n              disabled={!message.trim() || message === 'Write your message here...' || message === 'Write your specific message here...' || isGenerating}\r\n              className=\"flex-1 sm:flex-none gap-2 h-10 text-sm\"\r\n            >\r\n              <Download className=\"h-4 w-4\" />\r\n              {isGenerating ? 'PDF...' : 'PDF'}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default BusinessNoticeGenerator;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2216, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerList.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Customer } from '@/types';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Card, CardContent, CardHeader } from '@/components/ui/card';\r\nimport { Eye, Calendar, Receipt, Edit, Mail, Phone, MapPin, Tag, FileText } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport { useSalesData } from '@/hooks/useSalesData';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport LoadingSpinner from '@/components/LoadingSpinner';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\nimport BusinessNoticeGenerator from './BusinessNoticeGenerator';\r\n\r\ninterface CustomerListProps {\r\n  customers: Customer[];\r\n  isLoading: boolean;\r\n  onSelectCustomer: (customer: Customer) => void;\r\n  onEditCustomer: (customer: Customer) => void;\r\n  onDeleteCustomer: (id: string) => Promise<boolean>;\r\n  canEdit?: boolean;\r\n  canDelete?: boolean;\r\n}\r\n\r\nconst CustomerList: React.FC<CustomerListProps> = ({\r\n  customers,\r\n  isLoading,\r\n  onSelectCustomer,\r\n  onEditCustomer,\r\n  canEdit = true,\r\n  canDelete = true\r\n}) => {\r\n  const { user } = useAuth();\r\n  const { getCustomerLifetimePurchases } = useSalesData(user?.id);\r\n  const { settings } = useBusinessSettings();\r\n  const isMobile = useIsMobile();\r\n  const { canViewTotalAmount, canViewSellingPrice } = useFinancialVisibility();\r\n  const [noticeDialogOpen, setNoticeDialogOpen] = useState(false);\r\n  const [selectedCustomerForNotice, setSelectedCustomerForNotice] = useState<Customer | null>(null);\r\n\r\n  // Calculate customer's lifetime purchase total using the new function\r\n  const getCustomerLifetimeTotal = (customerName: string) => {\r\n    if (!(canViewTotalAmount || canViewSellingPrice)) return 'â€¢â€¢â€¢';\r\n    const purchaseData = getCustomerLifetimePurchases(customerName);\r\n    return `${settings.currency} ${formatNumber(purchaseData.total)}`;\r\n  };\r\n\r\n  const handleSendNotice = (customer: Customer) => {\r\n    setSelectedCustomerForNotice(customer);\r\n    setNoticeDialogOpen(true);\r\n  };\r\n\r\n  if (isLoading) {\r\n    return <LoadingSpinner message=\"Loading customers...\" />;\r\n  }\r\n\r\n  if (customers.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-12 bg-gray-50 rounded-lg\">\r\n        <h3 className=\"text-lg font-medium text-gray-900\">No customers yet</h3>\r\n        <p className=\"mt-1 text-sm text-gray-500\">Get started by adding your first customer</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Create a Map to track unique customers by ID to prevent duplicates\r\n  const uniqueCustomers = new Map();\r\n  customers.forEach(customer => {\r\n    if (!uniqueCustomers.has(customer.id)) {\r\n      uniqueCustomers.set(customer.id, customer);\r\n    }\r\n  });\r\n\r\n  // Mobile Card View\r\n  if (isMobile) {\r\n    return (\r\n      <>\r\n        <div className=\"grid grid-cols-1 gap-4\">\r\n          {Array.from(uniqueCustomers.values()).map((customer) => (\r\n            <Card\r\n              key={customer.id}\r\n              className=\"cursor-pointer hover:shadow-md transition-shadow duration-200 border border-gray-200\"\r\n              onClick={() => onSelectCustomer(customer)}\r\n            >\r\n              <CardHeader className=\"pb-3\">\r\n                <div className=\"flex items-start justify-between gap-2\">\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <h3 className=\"font-semibold text-lg text-gray-900 break-words leading-tight\">\r\n                      {customer.fullName}\r\n                    </h3>\r\n                    <div className=\"flex items-center gap-1 mt-1\">\r\n                      <Receipt className=\"h-4 w-4 text-green-600 flex-shrink-0\" />\r\n                      <span className=\"text-sm font-medium text-green-600 truncate\">\r\n                        {getCustomerLifetimeTotal(customer.fullName)}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex gap-1 flex-shrink-0\" onClick={(e) => e.stopPropagation()}>\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      className=\"h-8 w-8 p-0\"\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        handleSendNotice(customer);\r\n                      }}\r\n                    >\r\n                      <FileText className=\"h-4 w-4\" />\r\n                    </Button>\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      className=\"h-8 w-8 p-0\"\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        onSelectCustomer(customer);\r\n                      }}\r\n                    >\r\n                      <Eye className=\"h-4 w-4\" />\r\n                    </Button>\r\n                    {canEdit && (\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        className=\"h-8 w-8 p-0\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          onEditCustomer(customer);\r\n                        }}\r\n                      >\r\n                        <Edit className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent className=\"pt-0\">\r\n                <div className=\"space-y-3\">\r\n                  {/* Contact Information */}\r\n                  <div className=\"space-y-2\">\r\n                    {customer.email && (\r\n                      <div className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                        <Mail className=\"h-4 w-4 text-gray-400 flex-shrink-0\" />\r\n                        <span className=\"truncate\">{customer.email}</span>\r\n                      </div>\r\n                    )}\r\n                    {customer.phoneNumber && (\r\n                      <div className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                        <Phone className=\"h-4 w-4 text-gray-400 flex-shrink-0\" />\r\n                        <span className=\"break-all\">{customer.phoneNumber}</span>\r\n                      </div>\r\n                    )}\r\n                    {customer.location && (\r\n                      <div className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                        <MapPin className=\"h-4 w-4 text-gray-400 flex-shrink-0\" />\r\n                        <span className=\"break-words\">{customer.location}</span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Birthday */}\r\n                  {customer.birthday && (\r\n                    <div className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                      <Calendar className=\"h-4 w-4 text-gray-400 flex-shrink-0\" />\r\n                      <span>Birthday: {format(customer.birthday, 'MMM d, yyyy')}</span>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Tags */}\r\n                  {customer.tags && customer.tags.length > 0 && (\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"flex items-center gap-1 text-sm text-gray-500\">\r\n                        <Tag className=\"h-3 w-3 flex-shrink-0\" />\r\n                        <span>Tags</span>\r\n                      </div>\r\n                      <div className=\"flex flex-wrap gap-1\">\r\n                        {customer.tags.slice(0, 3).map((tag, i) => (\r\n                          <Badge key={i} variant=\"outline\" className=\"text-xs bg-blue-50 border-blue-200 text-blue-700\">\r\n                            {tag}\r\n                          </Badge>\r\n                        ))}\r\n                        {customer.tags.length > 3 && (\r\n                          <Badge variant=\"outline\" className=\"text-xs bg-gray-100 border-gray-200\">\r\n                            +{customer.tags.length - 3}\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n\r\n        {selectedCustomerForNotice && (\r\n          <BusinessNoticeGenerator\r\n            customer={selectedCustomerForNotice}\r\n            open={noticeDialogOpen}\r\n            onClose={() => {\r\n              setNoticeDialogOpen(false);\r\n              setSelectedCustomerForNotice(null);\r\n            }}\r\n          />\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n\r\n  // Desktop Table View\r\n  return (\r\n    <>\r\n      <div className=\"bg-white rounded-lg border\">\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full\">\r\n            <thead className=\"bg-gray-50 border-b\">\r\n              <tr>\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Customer</th>\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Contact</th>\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Lifetime Value</th>\r\n                <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Tags</th>\r\n                <th className=\"text-right py-3 px-4 font-medium text-gray-900\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {Array.from(uniqueCustomers.values()).map((customer, index) => (\r\n                <tr\r\n                  key={customer.id}\r\n                  className={`border-b hover:bg-gray-50 cursor-pointer transition-colors ${index % 2 === 0 ? 'bg-white' : 'bg-gray-25'\r\n                    }`}\r\n                  onClick={() => onSelectCustomer(customer)}\r\n                >\r\n                  <td className=\"py-4 px-4\">\r\n                    <div className=\"flex flex-col\">\r\n                      <span className=\"font-medium text-gray-900 break-words\">{customer.fullName}</span>\r\n                      {customer.location && (\r\n                        <span className=\"text-sm text-gray-500 break-words\">{customer.location}</span>\r\n                      )}\r\n                      {customer.birthday && (\r\n                        <span className=\"text-sm text-gray-500\">\r\n                          Birthday: {format(customer.birthday, 'MMM d, yyyy')}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"py-4 px-4\">\r\n                    <div className=\"flex flex-col space-y-1\">\r\n                      {customer.email && (\r\n                        <div className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                          <Mail className=\"h-3 w-3 text-gray-400 flex-shrink-0\" />\r\n                          <span className=\"break-words\">{customer.email}</span>\r\n                        </div>\r\n                      )}\r\n                      {customer.phoneNumber && (\r\n                        <div className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                          <Phone className=\"h-3 w-3 text-gray-400 flex-shrink-0\" />\r\n                          <span className=\"break-all\">{customer.phoneNumber}</span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"py-4 px-4\">\r\n                    <div className=\"flex items-center gap-1\">\r\n                      <Receipt className=\"h-4 w-4 text-green-600 flex-shrink-0\" />\r\n                      <span className=\"text-sm font-medium text-green-600\">\r\n                        {getCustomerLifetimeTotal(customer.fullName)}\r\n                      </span>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"py-4 px-4\">\r\n                    {customer.tags && customer.tags.length > 0 ? (\r\n                      <div className=\"flex flex-wrap gap-1\">\r\n                        {customer.tags.slice(0, 2).map((tag, i) => (\r\n                          <Badge key={i} variant=\"outline\" className=\"text-xs bg-blue-50 border-blue-200 text-blue-700\">\r\n                            {tag}\r\n                          </Badge>\r\n                        ))}\r\n                        {customer.tags.length > 2 && (\r\n                          <Badge variant=\"outline\" className=\"text-xs bg-gray-100 border-gray-200\">\r\n                            +{customer.tags.length - 2}\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                    ) : (\r\n                      <span className=\"text-sm text-gray-400\">No tags</span>\r\n                    )}\r\n                  </td>\r\n                  <td className=\"py-4 px-4\">\r\n                    <div className=\"flex gap-1 justify-end\" onClick={(e) => e.stopPropagation()}>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        className=\"h-8 w-8 p-0\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          handleSendNotice(customer);\r\n                        }}\r\n                        title=\"Send Notice\"\r\n                      >\r\n                        <FileText className=\"h-4 w-4\" />\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        className=\"h-8 w-8 p-0\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          onSelectCustomer(customer);\r\n                        }}\r\n                        title=\"View Details\"\r\n                      >\r\n                        <Eye className=\"h-4 w-4\" />\r\n                      </Button>\r\n                      {canEdit && (\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          className=\"h-8 w-8 p-0\"\r\n                          onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            onEditCustomer(customer);\r\n                          }}\r\n                          title=\"Edit Customer\"\r\n                        >\r\n                          <Edit className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      )}\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {selectedCustomerForNotice && (\r\n        <BusinessNoticeGenerator\r\n          customer={selectedCustomerForNotice}\r\n          open={noticeDialogOpen}\r\n          onClose={() => {\r\n            setNoticeDialogOpen(false);\r\n            setSelectedCustomerForNotice(null);\r\n          }}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CustomerList;\r\n"],"names":[],"mappings":";;;;;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AAYA,MAAM,eAA4C,CAAC,EACjD,SAAS,EACT,SAAS,EACT,gBAAgB,EAChB,cAAc,EACd,UAAU,IAAI,EACd,YAAY,IAAI,EACjB;;IACC,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,wJAAO;IACxB,MAAM,EAAE,4BAA4B,EAAE,GAAG,IAAA,+IAAY,EAAC,MAAM;IAC5D,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,6JAAmB;IACxC,MAAM,WAAW,IAAA,gJAAW;IAC5B,MAAM,EAAE,kBAAkB,EAAE,mBAAmB,EAAE,GAAG,IAAA,mKAAsB;IAC1E,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAC;IACzD,MAAM,CAAC,2BAA2B,6BAA6B,GAAG,IAAA,yKAAQ,EAAkB;IAE5F,sEAAsE;IACtE,MAAM,2BAA2B,CAAC;QAChC,IAAI,CAAC,CAAC,sBAAsB,mBAAmB,GAAG,OAAO;QACzD,MAAM,eAAe,6BAA6B;QAClD,OAAO,GAAG,SAAS,QAAQ,CAAC,CAAC,EAAE,IAAA,sIAAY,EAAC,aAAa,KAAK,GAAG;IACnE;IAEA,MAAM,mBAAmB,CAAC;QACxB,6BAA6B;QAC7B,oBAAoB;IACtB;IAEA,IAAI,WAAW;QACb,qBAAO,6LAAC,kJAAc;YAAC,SAAQ;;;;;;IACjC;IAEA,IAAI,UAAU,MAAM,KAAK,GAAG;QAC1B,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAG,WAAU;8BAAoC;;;;;;8BAClD,6LAAC;oBAAE,WAAU;8BAA6B;;;;;;;;;;;;IAGhD;IAEA,qEAAqE;IACrE,MAAM,kBAAkB,IAAI;IAC5B,UAAU,OAAO,CAAC,CAAA;QAChB,IAAI,CAAC,gBAAgB,GAAG,CAAC,SAAS,EAAE,GAAG;YACrC,gBAAgB,GAAG,CAAC,SAAS,EAAE,EAAE;QACnC;IACF;IAEA,mBAAmB;IACnB,IAAI,UAAU;QACZ,qBACE;;8BACE,6LAAC;oBAAI,WAAU;8BACZ,MAAM,IAAI,CAAC,gBAAgB,MAAM,IAAI,GAAG,CAAC,CAAC,yBACzC,6LAAC,2IAAI;4BAEH,WAAU;4BACV,SAAS,IAAM,iBAAiB;;8CAEhC,6LAAC,iJAAU;oCAAC,WAAU;8CACpB,cAAA,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAG,WAAU;kEACX,SAAS,QAAQ;;;;;;kEAEpB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC,sNAAO;gEAAC,WAAU;;;;;;0EACnB,6LAAC;gEAAK,WAAU;0EACb,yBAAyB,SAAS,QAAQ;;;;;;;;;;;;;;;;;;0DAIjD,6LAAC;gDAAI,WAAU;gDAA2B,SAAS,CAAC,IAAM,EAAE,eAAe;;kEACzE,6LAAC,+IAAM;wDACL,SAAQ;wDACR,MAAK;wDACL,WAAU;wDACV,SAAS,CAAC;4DACR,EAAE,eAAe;4DACjB,iBAAiB;wDACnB;kEAEA,cAAA,6LAAC,6NAAQ;4DAAC,WAAU;;;;;;;;;;;kEAEtB,6LAAC,+IAAM;wDACL,SAAQ;wDACR,MAAK;wDACL,WAAU;wDACV,SAAS,CAAC;4DACR,EAAE,eAAe;4DACjB,iBAAiB;wDACnB;kEAEA,cAAA,6LAAC,0MAAG;4DAAC,WAAU;;;;;;;;;;;oDAEhB,yBACC,6LAAC,+IAAM;wDACL,SAAQ;wDACR,MAAK;wDACL,WAAU;wDACV,SAAS,CAAC;4DACR,EAAE,eAAe;4DACjB,eAAe;wDACjB;kEAEA,cAAA,6LAAC,sNAAI;4DAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;8CAM1B,6LAAC,kJAAW;oCAAC,WAAU;8CACrB,cAAA,6LAAC;wCAAI,WAAU;;0DAEb,6LAAC;gDAAI,WAAU;;oDACZ,SAAS,KAAK,kBACb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC,6MAAI;gEAAC,WAAU;;;;;;0EAChB,6LAAC;gEAAK,WAAU;0EAAY,SAAS,KAAK;;;;;;;;;;;;oDAG7C,SAAS,WAAW,kBACnB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC,gNAAK;gEAAC,WAAU;;;;;;0EACjB,6LAAC;gEAAK,WAAU;0EAAa,SAAS,WAAW;;;;;;;;;;;;oDAGpD,SAAS,QAAQ,kBAChB,6LAAC;wDAAI,WAAU;;0EACb,6LAAC,uNAAM;gEAAC,WAAU;;;;;;0EAClB,6LAAC;gEAAK,WAAU;0EAAe,SAAS,QAAQ;;;;;;;;;;;;;;;;;;4CAMrD,SAAS,QAAQ,kBAChB,6LAAC;gDAAI,WAAU;;kEACb,6LAAC,yNAAQ;wDAAC,WAAU;;;;;;kEACpB,6LAAC;;4DAAK;4DAAW,IAAA,kKAAM,EAAC,SAAS,QAAQ,EAAE;;;;;;;;;;;;;4CAK9C,SAAS,IAAI,IAAI,SAAS,IAAI,CAAC,MAAM,GAAG,mBACvC,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;;0EACb,6LAAC,0MAAG;gEAAC,WAAU;;;;;;0EACf,6LAAC;0EAAK;;;;;;;;;;;;kEAER,6LAAC;wDAAI,WAAU;;4DACZ,SAAS,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,KAAK,kBACnC,6LAAC,6IAAK;oEAAS,SAAQ;oEAAU,WAAU;8EACxC;mEADS;;;;;4DAIb,SAAS,IAAI,CAAC,MAAM,GAAG,mBACtB,6LAAC,6IAAK;gEAAC,SAAQ;gEAAU,WAAU;;oEAAsC;oEACrE,SAAS,IAAI,CAAC,MAAM,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2BAvGlC,SAAS,EAAE;;;;;;;;;;gBAmHrB,2CACC,6LAAC,wKAAuB;oBACtB,UAAU;oBACV,MAAM;oBACN,SAAS;wBACP,oBAAoB;wBACpB,6BAA6B;oBAC/B;;;;;;;;IAKV;IAEA,qBAAqB;IACrB,qBACE;;0BACE,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAM,WAAU;;0CACf,6LAAC;gCAAM,WAAU;0CACf,cAAA,6LAAC;;sDACC,6LAAC;4CAAG,WAAU;sDAAgD;;;;;;sDAC9D,6LAAC;4CAAG,WAAU;sDAAgD;;;;;;sDAC9D,6LAAC;4CAAG,WAAU;sDAAgD;;;;;;sDAC9D,6LAAC;4CAAG,WAAU;sDAAgD;;;;;;sDAC9D,6LAAC;4CAAG,WAAU;sDAAiD;;;;;;;;;;;;;;;;;0CAGnE,6LAAC;0CACE,MAAM,IAAI,CAAC,gBAAgB,MAAM,IAAI,GAAG,CAAC,CAAC,UAAU,sBACnD,6LAAC;wCAEC,WAAW,CAAC,2DAA2D,EAAE,QAAQ,MAAM,IAAI,aAAa,cACpG;wCACJ,SAAS,IAAM,iBAAiB;;0DAEhC,6LAAC;gDAAG,WAAU;0DACZ,cAAA,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAK,WAAU;sEAAyC,SAAS,QAAQ;;;;;;wDACzE,SAAS,QAAQ,kBAChB,6LAAC;4DAAK,WAAU;sEAAqC,SAAS,QAAQ;;;;;;wDAEvE,SAAS,QAAQ,kBAChB,6LAAC;4DAAK,WAAU;;gEAAwB;gEAC3B,IAAA,kKAAM,EAAC,SAAS,QAAQ,EAAE;;;;;;;;;;;;;;;;;;0DAK7C,6LAAC;gDAAG,WAAU;0DACZ,cAAA,6LAAC;oDAAI,WAAU;;wDACZ,SAAS,KAAK,kBACb,6LAAC;4DAAI,WAAU;;8EACb,6LAAC,6MAAI;oEAAC,WAAU;;;;;;8EAChB,6LAAC;oEAAK,WAAU;8EAAe,SAAS,KAAK;;;;;;;;;;;;wDAGhD,SAAS,WAAW,kBACnB,6LAAC;4DAAI,WAAU;;8EACb,6LAAC,gNAAK;oEAAC,WAAU;;;;;;8EACjB,6LAAC;oEAAK,WAAU;8EAAa,SAAS,WAAW;;;;;;;;;;;;;;;;;;;;;;;0DAKzD,6LAAC;gDAAG,WAAU;0DACZ,cAAA,6LAAC;oDAAI,WAAU;;sEACb,6LAAC,sNAAO;4DAAC,WAAU;;;;;;sEACnB,6LAAC;4DAAK,WAAU;sEACb,yBAAyB,SAAS,QAAQ;;;;;;;;;;;;;;;;;0DAIjD,6LAAC;gDAAG,WAAU;0DACX,SAAS,IAAI,IAAI,SAAS,IAAI,CAAC,MAAM,GAAG,kBACvC,6LAAC;oDAAI,WAAU;;wDACZ,SAAS,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,KAAK,kBACnC,6LAAC,6IAAK;gEAAS,SAAQ;gEAAU,WAAU;0EACxC;+DADS;;;;;wDAIb,SAAS,IAAI,CAAC,MAAM,GAAG,mBACtB,6LAAC,6IAAK;4DAAC,SAAQ;4DAAU,WAAU;;gEAAsC;gEACrE,SAAS,IAAI,CAAC,MAAM,GAAG;;;;;;;;;;;;6GAK/B,6LAAC;oDAAK,WAAU;8DAAwB;;;;;;;;;;;0DAG5C,6LAAC;gDAAG,WAAU;0DACZ,cAAA,6LAAC;oDAAI,WAAU;oDAAyB,SAAS,CAAC,IAAM,EAAE,eAAe;;sEACvE,6LAAC,+IAAM;4DACL,SAAQ;4DACR,MAAK;4DACL,WAAU;4DACV,SAAS,CAAC;gEACR,EAAE,eAAe;gEACjB,iBAAiB;4DACnB;4DACA,OAAM;sEAEN,cAAA,6LAAC,6NAAQ;gEAAC,WAAU;;;;;;;;;;;sEAEtB,6LAAC,+IAAM;4DACL,SAAQ;4DACR,MAAK;4DACL,WAAU;4DACV,SAAS,CAAC;gEACR,EAAE,eAAe;gEACjB,iBAAiB;4DACnB;4DACA,OAAM;sEAEN,cAAA,6LAAC,0MAAG;gEAAC,WAAU;;;;;;;;;;;wDAEhB,yBACC,6LAAC,+IAAM;4DACL,SAAQ;4DACR,MAAK;4DACL,WAAU;4DACV,SAAS,CAAC;gEACR,EAAE,eAAe;gEACjB,eAAe;4DACjB;4DACA,OAAM;sEAEN,cAAA,6LAAC,sNAAI;gEAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;uCAjGnB,SAAS,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;YA6G3B,2CACC,6LAAC,wKAAuB;gBACtB,UAAU;gBACV,MAAM;gBACN,SAAS;oBACP,oBAAoB;oBACpB,6BAA6B;gBAC/B;;;;;;;;AAKV;GApUM;;QAQa,wJAAO;QACiB,+IAAY;QAChC,6JAAmB;QACvB,gJAAW;QACwB,mKAAsB;;;KAZtE;uCAsUS"}},
    {"offset": {"line": 3063, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/TopCustomersList.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Crown, User, TrendingUp, ShoppingBag } from 'lucide-react';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport { useSalesData } from '@/hooks/useSalesData';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { useCustomers } from '@/hooks/useCustomers';\r\nimport LoadingSpinner from '@/components/LoadingSpinner';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { getDateRangeFromFilter } from '@/utils/dateFilters';\r\n\r\ninterface TopCustomersListProps {\r\n  selectedCategory?: string;\r\n  dateFilter?: string;\r\n  dateRange?: { from: Date | undefined; to: Date | undefined };\r\n}\r\n\r\nconst TopCustomersList: React.FC<TopCustomersListProps> = ({ \r\n  selectedCategory = 'all',\r\n  dateFilter = 'all',\r\n  dateRange = { from: undefined, to: undefined }\r\n}) => {\r\n  const { user } = useAuth();\r\n  const { sales, isLoading } = useSalesData(user?.id || '');\r\n  const { customers } = useCustomers();\r\n  const { settings } = useBusinessSettings();\r\n  const navigate = useNavigate();\r\n\r\n  // Pagination state\r\n  const [page, setPage] = React.useState(1);\r\n  const pageSize = 10;\r\n\r\n  // Calculate top customers from sales data\r\n  const getAllTopCustomers = () => {\r\n    // Apply date filter first\r\n    let filteredSales = sales;\r\n    if (dateFilter === 'custom' && dateRange.from && dateRange.to) {\r\n      // Use custom date range\r\n      filteredSales = sales.filter(sale => {\r\n        const saleDate = new Date(sale.date);\r\n        return saleDate >= dateRange.from! && saleDate <= dateRange.to!;\r\n      });\r\n    } else if (dateFilter !== 'all') {\r\n      // Use predefined date filter\r\n      const dateRangeFilter = getDateRangeFromFilter(dateFilter);\r\n      filteredSales = sales.filter(sale => {\r\n        const saleDate = new Date(sale.date);\r\n        return saleDate >= dateRangeFilter.from && saleDate <= dateRangeFilter.to;\r\n      });\r\n    }\r\n\r\n    // Skip quotes since they're not actual purchases\r\n    const nonQuoteSales = filteredSales.filter(sale => sale.paymentStatus !== \"Quote\");\r\n    \r\n    // Group sales by customer name\r\n    const customerMap = new Map<string, { total: number, count: number, customerId?: string }>();\r\n    \r\n    nonQuoteSales.forEach(sale => {\r\n      const customerName = sale.customerName;\r\n      const saleTotal = sale.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);\r\n      \r\n      if (!customerMap.has(customerName)) {\r\n        customerMap.set(customerName, { \r\n          total: saleTotal, \r\n          count: 1,\r\n          customerId: sale.customerId\r\n        });\r\n      } else {\r\n        const current = customerMap.get(customerName)!;\r\n        customerMap.set(customerName, { \r\n          total: current.total + saleTotal, \r\n          count: current.count + 1,\r\n          customerId: current.customerId || sale.customerId\r\n        });\r\n      }\r\n    });\r\n    \r\n    // Convert map to array and sort by total purchases\r\n    let topCustomers = Array.from(customerMap.entries())\r\n      .map(([name, data]) => ({\r\n        id: data.customerId,\r\n        name,\r\n        totalPurchases: data.total,\r\n        orderCount: data.count\r\n      }))\r\n      .sort((a, b) => b.totalPurchases - a.totalPurchases);\r\n\r\n    // Apply category filter if specified\r\n    if (selectedCategory && selectedCategory !== 'all') {\r\n      topCustomers = topCustomers.filter(customer => {\r\n        if (customer.id) {\r\n          const customerData = customers.find(c => c.id === customer.id);\r\n          return customerData?.categoryId === selectedCategory;\r\n        }\r\n        // Fallback to name matching if no ID\r\n        const customerData = customers.find(c => c.fullName === customer.name);\r\n        return customerData?.categoryId === selectedCategory;\r\n      });\r\n    }\r\n    \r\n    return topCustomers;\r\n  };\r\n\r\n  const allTopCustomers = getAllTopCustomers();\r\n  const totalPages = Math.ceil(allTopCustomers.length / pageSize);\r\n  const paginatedCustomers = allTopCustomers.slice((page - 1) * pageSize, page * pageSize);\r\n\r\n  const handleCustomerClick = (customerName: string, customerId?: string) => {\r\n    // First try to find by customerId if available\r\n    if (customerId) {\r\n      const customer = customers.find(c => c.id === customerId);\r\n      if (customer) {\r\n        navigate(`/customers?view=${customer.id}`);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    // Fallback to finding by name\r\n    const customer = customers.find(c => c.fullName === customerName);\r\n    if (customer) {\r\n      navigate(`/customers?view=${customer.id}`);\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-[60vh]\">\r\n        <LoadingSpinner message=\"Loading top customers...\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card className=\"shadow-lg border-0 bg-gradient-to-br from-white to-gray-50\">\r\n        <CardHeader className=\"pb-4\">\r\n          <CardTitle className=\"flex items-center gap-3 text-xl\">\r\n            <div className=\"p-2 bg-amber-100 rounded-lg\">\r\n              <Crown className=\"h-6 w-6 text-amber-600\" />\r\n            </div>\r\n            <span className=\"text-gray-900 font-bold\">Top Customers by Revenue</span>\r\n          </CardTitle>\r\n          <CardDescription className=\"text-gray-600 text-sm\">\r\n            Customers ranked by total purchase amount (excluding quotes)\r\n            {dateFilter !== 'all' && (\r\n              <Badge variant=\"outline\" className=\"ml-2 bg-purple-50 text-purple-700 border-purple-200\">\r\n                {dateFilter === 'custom' ? 'Custom Range' :\r\n                 dateFilter === 'today' ? 'Today' :\r\n                 dateFilter === 'yesterday' ? 'Yesterday' :\r\n                 dateFilter === 'this-week' ? 'This Week' :\r\n                 dateFilter === 'last-week' ? 'Last Week' :\r\n                 dateFilter === 'this-month' ? 'This Month' :\r\n                 dateFilter === 'last-month' ? 'Last Month' :\r\n                 dateFilter === 'this-year' ? 'This Year' : ''}\r\n              </Badge>\r\n            )}\r\n            {selectedCategory !== 'all' && (\r\n              <Badge variant=\"outline\" className=\"ml-2 bg-blue-50 text-blue-700 border-blue-200\">\r\n                Filtered by category\r\n              </Badge>\r\n            )}\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"pt-0\">\r\n          {paginatedCustomers.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <div className=\"w-20 h-20 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center\">\r\n                <User className=\"h-10 w-10 text-gray-400\" />\r\n              </div>\r\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n                {selectedCategory !== 'all' ? 'No customers in this category' : 'No customer data available'}\r\n              </h3>\r\n              <p className=\"text-sm text-gray-500 max-w-md mx-auto\">\r\n                {selectedCategory !== 'all' \r\n                  ? 'Try selecting a different category or add customers to this category.'\r\n                  : 'Sales data will appear here once you have completed transactions.'\r\n                }\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              {paginatedCustomers.map((customer, idx) => {\r\n                const index = (page - 1) * pageSize + idx;\r\n                return (\r\n                <div \r\n                  key={customer.id || customer.name} \r\n                  className=\"group relative bg-white border border-gray-200 rounded-xl p-3 sm:p-4 hover:shadow-md transition-all duration-200 hover:border-gray-300 cursor-pointer\"\r\n                  onClick={() => handleCustomerClick(customer.name, customer.id)}\r\n                >\r\n                  <div className=\"flex items-start gap-3\">\r\n                    {/* Rank Badge */}\r\n                    <div className=\"flex-shrink-0\">\r\n                      <div className={`\r\n                        w-8 h-8 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center font-bold text-xs sm:text-sm\r\n                        ${index === 0 ? 'bg-gradient-to-br from-amber-400 to-amber-600 text-white shadow-lg' : \r\n                          index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-white shadow-md' :\r\n                          index === 2 ? 'bg-gradient-to-br from-amber-600 to-amber-800 text-white shadow-md' :\r\n                          'bg-gradient-to-br from-blue-50 to-blue-100 text-blue-700 border border-blue-200'}\r\n                      `}>\r\n                        {index + 1}\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Customer Info */}\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"flex flex-col gap-2\">\r\n                        {/* Header row with name and badge */}\r\n                        <div className=\"flex items-start justify-between gap-2\">\r\n                          <h4 className=\"font-semibold text-gray-900 text-sm sm:text-base leading-tight break-words flex-1\">\r\n                            {customer.name}\r\n                          </h4>\r\n                          {/* Position Badge */}\r\n                          <div className=\"flex-shrink-0\">\r\n                            {index === 0 && (\r\n                              <Badge className=\"bg-gradient-to-r from-amber-500 to-amber-600 text-white border-0 text-xs font-semibold px-2 py-1 shadow-md\">\r\n                                ðŸ‘‘\r\n                              </Badge>\r\n                            )}\r\n                            {index === 1 && (\r\n                              <Badge variant=\"secondary\" className=\"bg-gradient-to-r from-gray-400 to-gray-500 text-white border-0 text-xs font-semibold px-2 py-1\">\r\n                                ðŸ¥ˆ\r\n                              </Badge>\r\n                            )}\r\n                            {index === 2 && (\r\n                              <Badge variant=\"secondary\" className=\"bg-gradient-to-r from-amber-700 to-amber-800 text-white border-0 text-xs font-semibold px-2 py-1\">\r\n                                ðŸ¥‰\r\n                              </Badge>\r\n                            )}\r\n                            {index > 2 && (\r\n                              <Badge variant=\"outline\" className=\"border-gray-300 text-gray-600 text-xs font-medium px-2 py-1 bg-white\">\r\n                                #{index + 1}\r\n                              </Badge>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* Stats row */}\r\n                        <div className=\"flex flex-col xs:flex-row xs:items-center gap-2 xs:gap-3\">\r\n                          <div className=\"flex items-center gap-1.5\">\r\n                            <div className=\"p-1 bg-green-100 rounded\">\r\n                              <TrendingUp className=\"h-3 w-3 text-green-600\" />\r\n                            </div>\r\n                            <span className=\"font-bold text-green-700 text-sm\">\r\n                              {settings.currency} {formatNumber(customer.totalPurchases)}\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-1.5\">\r\n                            <div className=\"p-1 bg-blue-100 rounded\">\r\n                              <ShoppingBag className=\"h-3 w-3 text-blue-600\" />\r\n                            </div>\r\n                            <span className=\"text-xs font-medium text-gray-600\">\r\n                              {customer.orderCount} {customer.orderCount === 1 ? 'order' : 'orders'}\r\n                            </span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Subtle hover indicator */}\r\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/0 to-purple-500/0 group-hover:from-blue-500/5 group-hover:to-purple-500/5 rounded-xl transition-all duration-200 pointer-events-none\" />\r\n                </div>\r\n                );\r\n              })}\r\n                      {/* Pagination Controls */}\r\n                      {totalPages > 1 && (\r\n                        <div className=\"flex justify-center mt-6 gap-2\">\r\n                          <button\r\n                            className=\"px-3 py-1 rounded border text-sm font-medium bg-white hover:bg-gray-100 disabled:opacity-50\"\r\n                            onClick={() => setPage(page - 1)}\r\n                            disabled={page === 1}\r\n                          >\r\n                            Previous\r\n                          </button>\r\n                          <span className=\"px-2 py-1 text-gray-600 text-sm\">Page {page} of {totalPages}</span>\r\n                          <button\r\n                            className=\"px-3 py-1 rounded border text-sm font-medium bg-white hover:bg-gray-100 disabled:opacity-50\"\r\n                            onClick={() => setPage(page + 1)}\r\n                            disabled={page === totalPages}\r\n                          >\r\n                            Next\r\n                          </button>\r\n                        </div>\r\n                      )}\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TopCustomersList;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3612, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/WeMissYouDialog.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Customer } from '@/types';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { MessageSquare, Mail, Phone } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { openSMSApp, openWhatsApp, formatMessageForSMS, canSendSMS } from '@/utils/smsUtils';\r\nimport { getWeMissYouMessage } from '@/utils/smsUtils';\r\n\r\ninterface WeMissYouDialogProps {\r\n  customer: Customer | null;\r\n  open: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nconst WeMissYouDialog: React.FC<WeMissYouDialogProps> = ({\r\n  customer,\r\n  open,\r\n  onClose,\r\n}) => {\r\n  const { settings } = useBusinessSettings();\r\n  const [message, setMessage] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (customer && open) {\r\n      const baseMessage = getWeMissYouMessage(customer.fullName);\r\n      setMessage(baseMessage);\r\n    }\r\n  }, [customer, open]);\r\n\r\n  const handleSendSMS = () => {\r\n    if (!customer?.phoneNumber) {\r\n      toast.error(\"This customer doesn't have a phone number.\");\r\n      return;\r\n    }\r\n\r\n    if (!message.trim()) {\r\n      toast.error(\"Please enter a message.\");\r\n      return;\r\n    }\r\n\r\n    const formattedMessage = formatMessageForSMS(message, settings.businessName);\r\n    \r\n    try {\r\n      openSMSApp({\r\n        phoneNumber: customer.phoneNumber,\r\n        message: formattedMessage,\r\n      });\r\n      toast.success(\"Opening SMS app...\");\r\n      onClose();\r\n    } catch (error) {\r\n      toast.error(\"Failed to open SMS app.\");\r\n    }\r\n  };\r\n\r\n  const handleSendWhatsApp = () => {\r\n    if (!customer?.phoneNumber) {\r\n      toast.error(\"This customer doesn't have a phone number.\");\r\n      return;\r\n    }\r\n\r\n    if (!message.trim()) {\r\n      toast.error(\"Please enter a message.\");\r\n      return;\r\n    }\r\n\r\n    const formattedMessage = formatMessageForSMS(message, settings.businessName);\r\n    \r\n    try {\r\n      openWhatsApp({\r\n        phoneNumber: customer.phoneNumber,\r\n        message: formattedMessage,\r\n      });\r\n      toast.success(\"Opening WhatsApp...\");\r\n      onClose();\r\n    } catch (error) {\r\n      toast.error(\"Failed to open WhatsApp.\");\r\n    }\r\n  };\r\n\r\n  const handleSendEmail = () => {\r\n    if (!customer?.email) {\r\n      toast.error(\"This customer doesn't have an email address.\");\r\n      return;\r\n    }\r\n\r\n    if (!message.trim()) {\r\n      toast.error(\"Please enter a message.\");\r\n      return;\r\n    }\r\n\r\n    const formattedMessage = formatMessageForSMS(message, settings.businessName);\r\n    const subject = \"We Miss You!\";\r\n    const mailtoLink = `mailto:${customer.email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(formattedMessage)}`;\r\n    \r\n    try {\r\n      window.open(mailtoLink);\r\n      toast.success(\"Opening email client...\");\r\n      onClose();\r\n    } catch (error) {\r\n      toast.error(\"Failed to open email client.\");\r\n    }\r\n  };\r\n\r\n  const canSendEmail = customer?.email && customer.email.trim() !== '';\r\n  const canSendPhone = customer && canSendSMS(customer);\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onClose}>\r\n      <DialogContent className=\"sm:max-w-[600px]\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <MessageSquare className=\"h-5 w-5 text-purple-600\" />\r\n            Send \"We Miss You\" Message\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4 py-4\">\r\n          {customer && (\r\n            <div className=\"space-y-2\">\r\n              <p className=\"text-sm font-medium text-muted-foreground\">\r\n                Sending to: <span className=\"text-foreground font-semibold\">{customer.fullName}</span>\r\n              </p>\r\n              <div className=\"flex flex-wrap gap-2 text-sm text-muted-foreground\">\r\n                {customer.phoneNumber && (\r\n                  <span className=\"flex items-center gap-1\">\r\n                    <Phone className=\"h-3 w-3\" />\r\n                    {customer.phoneNumber}\r\n                  </span>\r\n                )}\r\n                {customer.email && (\r\n                  <span className=\"flex items-center gap-1\">\r\n                    <Mail className=\"h-3 w-3\" />\r\n                    {customer.email}\r\n                  </span>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"space-y-2\">\r\n            <label htmlFor=\"message\" className=\"text-sm font-medium\">\r\n              Message\r\n            </label>\r\n            <Textarea\r\n              id=\"message\"\r\n              value={message}\r\n              onChange={(e) => setMessage(e.target.value)}\r\n              placeholder=\"Enter your message...\"\r\n              className=\"min-h-[200px] resize-none\"\r\n            />\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              Your business name and signature will be added automatically.\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"flex flex-col sm:flex-row gap-2 pt-4\">\r\n            <Button\r\n              onClick={handleSendSMS}\r\n              disabled={!canSendPhone || !message.trim()}\r\n              className=\"flex-1 bg-blue-600 hover:bg-blue-700\"\r\n              title={!canSendPhone ? \"No phone number available\" : \"Send via SMS\"}\r\n            >\r\n              <Phone className=\"h-4 w-4 mr-2\" />\r\n              Send SMS\r\n            </Button>\r\n\r\n            <Button\r\n              onClick={handleSendWhatsApp}\r\n              disabled={!canSendPhone || !message.trim()}\r\n              className=\"flex-1 bg-green-600 hover:bg-green-700\"\r\n              title={!canSendPhone ? \"No phone number available\" : \"Send via WhatsApp\"}\r\n            >\r\n              <MessageSquare className=\"h-4 w-4 mr-2\" />\r\n              WhatsApp\r\n            </Button>\r\n\r\n            <Button\r\n              onClick={handleSendEmail}\r\n              disabled={!canSendEmail || !message.trim()}\r\n              className=\"flex-1 bg-purple-600 hover:bg-purple-700\"\r\n              title={!canSendEmail ? \"No email address available\" : \"Send via Email\"}\r\n            >\r\n              <Mail className=\"h-4 w-4 mr-2\" />\r\n              Email\r\n            </Button>\r\n          </div>\r\n\r\n          <Button\r\n            onClick={onClose}\r\n            variant=\"outline\"\r\n            className=\"w-full\"\r\n          >\r\n            Cancel\r\n          </Button>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default WeMissYouDialog;\r\n"],"names":[],"mappings":";;;;;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;;;;;AASA,MAAM,kBAAkD,CAAC,EACvD,QAAQ,EACR,IAAI,EACJ,OAAO,EACR;;IACC,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,6JAAmB;IACxC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;qCAAC;YACR,IAAI,YAAY,MAAM;gBACpB,MAAM,cAAc,IAAA,kJAAmB,EAAC,SAAS,QAAQ;gBACzD,WAAW;YACb;QACF;oCAAG;QAAC;QAAU;KAAK;IAEnB,MAAM,gBAAgB;QACpB,IAAI,CAAC,UAAU,aAAa;YAC1B,oJAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,IAAI,CAAC,QAAQ,IAAI,IAAI;YACnB,oJAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,MAAM,mBAAmB,IAAA,kJAAmB,EAAC,SAAS,SAAS,YAAY;QAE3E,IAAI;YACF,IAAA,yIAAU,EAAC;gBACT,aAAa,SAAS,WAAW;gBACjC,SAAS;YACX;YACA,oJAAK,CAAC,OAAO,CAAC;YACd;QACF,EAAE,OAAO,OAAO;YACd,oJAAK,CAAC,KAAK,CAAC;QACd;IACF;IAEA,MAAM,qBAAqB;QACzB,IAAI,CAAC,UAAU,aAAa;YAC1B,oJAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,IAAI,CAAC,QAAQ,IAAI,IAAI;YACnB,oJAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,MAAM,mBAAmB,IAAA,kJAAmB,EAAC,SAAS,SAAS,YAAY;QAE3E,IAAI;YACF,IAAA,2IAAY,EAAC;gBACX,aAAa,SAAS,WAAW;gBACjC,SAAS;YACX;YACA,oJAAK,CAAC,OAAO,CAAC;YACd;QACF,EAAE,OAAO,OAAO;YACd,oJAAK,CAAC,KAAK,CAAC;QACd;IACF;IAEA,MAAM,kBAAkB;QACtB,IAAI,CAAC,UAAU,OAAO;YACpB,oJAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,IAAI,CAAC,QAAQ,IAAI,IAAI;YACnB,oJAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,MAAM,mBAAmB,IAAA,kJAAmB,EAAC,SAAS,SAAS,YAAY;QAC3E,MAAM,UAAU;QAChB,MAAM,aAAa,CAAC,OAAO,EAAE,SAAS,KAAK,CAAC,SAAS,EAAE,mBAAmB,SAAS,MAAM,EAAE,mBAAmB,mBAAmB;QAEjI,IAAI;YACF,OAAO,IAAI,CAAC;YACZ,oJAAK,CAAC,OAAO,CAAC;YACd;QACF,EAAE,OAAO,OAAO;YACd,oJAAK,CAAC,KAAK,CAAC;QACd;IACF;IAEA,MAAM,eAAe,UAAU,SAAS,SAAS,KAAK,CAAC,IAAI,OAAO;IAClE,MAAM,eAAe,YAAY,IAAA,yIAAU,EAAC;IAE5C,qBACE,6LAAC,+IAAM;QAAC,MAAM;QAAM,cAAc;kBAChC,cAAA,6LAAC,sJAAa;YAAC,WAAU;;8BACvB,6LAAC,qJAAY;8BACX,cAAA,6LAAC,oJAAW;wBAAC,WAAU;;0CACrB,6LAAC,4OAAa;gCAAC,WAAU;;;;;;4BAA4B;;;;;;;;;;;;8BAKzD,6LAAC;oBAAI,WAAU;;wBACZ,0BACC,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAE,WAAU;;wCAA4C;sDAC3C,6LAAC;4CAAK,WAAU;sDAAiC,SAAS,QAAQ;;;;;;;;;;;;8CAEhF,6LAAC;oCAAI,WAAU;;wCACZ,SAAS,WAAW,kBACnB,6LAAC;4CAAK,WAAU;;8DACd,6LAAC,gNAAK;oDAAC,WAAU;;;;;;gDAChB,SAAS,WAAW;;;;;;;wCAGxB,SAAS,KAAK,kBACb,6LAAC;4CAAK,WAAU;;8DACd,6LAAC,6MAAI;oDAAC,WAAU;;;;;;gDACf,SAAS,KAAK;;;;;;;;;;;;;;;;;;;sCAOzB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAM,SAAQ;oCAAU,WAAU;8CAAsB;;;;;;8CAGzD,6LAAC,mJAAQ;oCACP,IAAG;oCACH,OAAO;oCACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;oCAC1C,aAAY;oCACZ,WAAU;;;;;;8CAEZ,6LAAC;oCAAE,WAAU;8CAAgC;;;;;;;;;;;;sCAK/C,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,+IAAM;oCACL,SAAS;oCACT,UAAU,CAAC,gBAAgB,CAAC,QAAQ,IAAI;oCACxC,WAAU;oCACV,OAAO,CAAC,eAAe,8BAA8B;;sDAErD,6LAAC,gNAAK;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;8CAIpC,6LAAC,+IAAM;oCACL,SAAS;oCACT,UAAU,CAAC,gBAAgB,CAAC,QAAQ,IAAI;oCACxC,WAAU;oCACV,OAAO,CAAC,eAAe,8BAA8B;;sDAErD,6LAAC,4OAAa;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;8CAI5C,6LAAC,+IAAM;oCACL,SAAS;oCACT,UAAU,CAAC,gBAAgB,CAAC,QAAQ,IAAI;oCACxC,WAAU;oCACV,OAAO,CAAC,eAAe,+BAA+B;;sDAEtD,6LAAC,6MAAI;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;;;;;;;sCAKrC,6LAAC,+IAAM;4BACL,SAAS;4BACT,SAAQ;4BACR,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AAOX;GAxLM;;QAKiB,6JAAmB;;;KALpC;uCA0LS"}},
    {"offset": {"line": 3969, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/InactiveCustomersList.tsx"],"sourcesContent":["import React, { useState, useMemo } from 'react';\r\nimport { Customer } from '@/types';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Card, CardContent, CardHeader } from '@/components/ui/card';\r\nimport { Eye, Loader2, Mail, Calendar, AlertCircle, Phone, MapPin, Tag, MessageCircleHeart } from 'lucide-react';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { format, subDays, subMonths, subYears, isAfter } from 'date-fns';\r\nimport { useSalesData } from '@/hooks/useSalesData';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { toast } from 'sonner';\r\nimport WeMissYouDialog from './WeMissYouDialog';\r\n\r\ninterface InactiveCustomersListProps {\r\n  customers: Customer[];\r\n  isLoading: boolean;\r\n  onSelectCustomer: (customer: Customer) => void;\r\n  onSendEmail?: (customer: Customer) => void;\r\n  selectedCategory?: string;\r\n}\r\n\r\ntype InactivityPeriod = '30days' | '60days' | '90days' | '6months' | '1year' | 'all';\r\n\r\nconst InactiveCustomersList: React.FC<InactiveCustomersListProps> = ({ \r\n  customers, \r\n  isLoading, \r\n  onSelectCustomer,\r\n  onSendEmail,\r\n  selectedCategory = 'all'\r\n}) => {\r\n  const { user } = useAuth();\r\n  const { sales, isLoading: salesLoading } = useSalesData(user?.id);\r\n  const [inactivityPeriod, setInactivityPeriod] = useState<InactivityPeriod>('30days');\r\n  const [selectedCustomerForMessage, setSelectedCustomerForMessage] = useState<Customer | null>(null);\r\n\r\n  // Inactive customer email template\r\n  const inactiveCustomerMessage = \"We Miss You!\\n\\nIt's been a while since we last heard from you, and we just wanted to check in. We truly value you as a customer and would love to have you back. If there's anything you need or if we can assist in any way, we're here for you!\\n\\nHope to see you again soon,\";\r\n\r\n  // Calculate the cutoff date based on the selected inactivity period\r\n  const getCutoffDate = (): Date => {\r\n    const now = new Date();\r\n    \r\n    switch(inactivityPeriod) {\r\n      case '30days': return subDays(now, 30);\r\n      case '60days': return subDays(now, 60);\r\n      case '90days': return subDays(now, 90);\r\n      case '6months': return subMonths(now, 6);\r\n      case '1year': return subYears(now, 1);\r\n      case 'all': return new Date(0); // Beginning of time\r\n      default: return subDays(now, 30);\r\n    }\r\n  };\r\n\r\n  // Filter customers who haven't purchased since the cutoff date\r\n  const inactiveCustomers = useMemo(() => {\r\n    if (salesLoading || isLoading || customers.length === 0 || sales.length === 0) {\r\n      return [];\r\n    }\r\n\r\n    const cutoffDate = getCutoffDate();\r\n    \r\n    // Filter customers by category first if specified\r\n    let filteredCustomers = customers;\r\n    if (selectedCategory && selectedCategory !== 'all') {\r\n      filteredCustomers = customers.filter(customer => customer.categoryId === selectedCategory);\r\n    }\r\n    \r\n    // For each customer, find their most recent purchase\r\n    return filteredCustomers.filter(customer => {\r\n      const customerSales = sales.filter(sale => \r\n        sale.customerName.toLowerCase() === customer.fullName.toLowerCase() &&\r\n        sale.paymentStatus !== 'Quote'\r\n      );\r\n      \r\n      // If no sales records, they're inactive\r\n      if (customerSales.length === 0) {\r\n        return true;\r\n      }\r\n      \r\n      // Get the most recent sale date\r\n      const lastPurchaseDate = new Date(Math.max(...customerSales.map(sale => new Date(sale.date).getTime())));\r\n      \r\n      // Check if last purchase is before our cutoff date\r\n      return lastPurchaseDate < cutoffDate;\r\n    });\r\n  }, [customers, sales, inactivityPeriod, salesLoading, isLoading, selectedCategory]);\r\n\r\n  // Format days since last purchase\r\n  const getDaysSinceLastPurchase = (customerName: string): string => {\r\n    const customerSales = sales.filter(sale => \r\n      sale.customerName.toLowerCase() === customerName.toLowerCase() &&\r\n      sale.paymentStatus !== 'Quote'\r\n    );\r\n    \r\n    if (customerSales.length === 0) {\r\n      return \"No purchases\";\r\n    }\r\n    \r\n    const lastPurchaseDate = new Date(Math.max(...customerSales.map(sale => new Date(sale.date).getTime())));\r\n    const daysSince = Math.floor((new Date().getTime() - lastPurchaseDate.getTime()) / (1000 * 60 * 60 * 24));\r\n    \r\n    if (daysSince < 30) {\r\n      return `${daysSince} days ago`;\r\n    } else if (daysSince < 365) {\r\n      const monthsSince = Math.floor(daysSince / 30);\r\n      return `${monthsSince} month${monthsSince > 1 ? 's' : ''} ago`;\r\n    } else {\r\n      const yearsSince = Math.floor(daysSince / 365);\r\n      return `${yearsSince} year${yearsSince > 1 ? 's' : ''} ago`;\r\n    }\r\n  };\r\n\r\n  const handleSendEmail = (customer: Customer) => {\r\n    if (onSendEmail) {\r\n      onSendEmail(customer);\r\n    } else {\r\n      // Fallback if no email handler is provided\r\n      if (customer.email) {\r\n        const mailtoLink = `mailto:${customer.email}?subject=We miss you!&body=${encodeURIComponent(inactiveCustomerMessage)}`;\r\n        window.open(mailtoLink);\r\n      } else {\r\n        toast.error(\"This customer doesn't have an email address.\");\r\n      }\r\n    }\r\n  };\r\n\r\n  if (isLoading || salesLoading) {\r\n    return (\r\n      <div className=\"w-full h-64 flex items-center justify-center\">\r\n        <Loader2 className=\"h-8 w-8 animate-spin text-blue-500\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Filter Controls */}\r\n      <div className=\"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <span className=\"text-sm font-medium text-gray-700\">Show inactive for:</span>\r\n          <Select value={inactivityPeriod} onValueChange={(value: InactivityPeriod) => setInactivityPeriod(value)}>\r\n            <SelectTrigger className=\"w-[160px]\">\r\n              <SelectValue placeholder=\"Select period\" />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"30days\">30 days</SelectItem>\r\n              <SelectItem value=\"60days\">60 days</SelectItem>\r\n              <SelectItem value=\"90days\">90 days</SelectItem>\r\n              <SelectItem value=\"6months\">6 months</SelectItem>\r\n              <SelectItem value=\"1year\">1 year</SelectItem>\r\n              <SelectItem value=\"all\">All inactive</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center gap-2\">\r\n          {selectedCategory !== 'all' && (\r\n            <Badge variant=\"outline\" className=\"bg-blue-50 text-blue-700 border-blue-200\">\r\n              Filtered by category\r\n            </Badge>\r\n          )}\r\n          <Badge variant=\"outline\" className=\"bg-amber-50 text-amber-800 border-amber-200\">\r\n            {inactiveCustomers.length} inactive customers\r\n          </Badge>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Customer Cards */}\r\n      {inactiveCustomers.length === 0 ? (\r\n        <Card className=\"border-dashed\">\r\n          <CardContent className=\"flex flex-col items-center justify-center py-12 text-center\">\r\n            <AlertCircle className=\"h-12 w-12 text-gray-400 mb-4\" />\r\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No inactive customers found</h3>\r\n            <p className=\"text-sm text-gray-500 max-w-md\">\r\n              {selectedCategory !== 'all' \r\n                ? `No customers in the selected category have been inactive for ${\r\n                    inactivityPeriod === '30days' ? 'the last 30 days' : \r\n                    inactivityPeriod === '60days' ? 'the last 60 days' :\r\n                    inactivityPeriod === '90days' ? 'the last 90 days' :\r\n                    inactivityPeriod === '6months' ? 'the last 6 months' :\r\n                    inactivityPeriod === '1year' ? 'the last year' : 'their history'\r\n                  }.`\r\n                : `All of your customers have made purchases within ${\r\n                    inactivityPeriod === '30days' ? 'the last 30 days' : \r\n                    inactivityPeriod === '60days' ? 'the last 60 days' :\r\n                    inactivityPeriod === '90days' ? 'the last 90 days' :\r\n                    inactivityPeriod === '6months' ? 'the last 6 months' :\r\n                    inactivityPeriod === '1year' ? 'the last year' : 'their history'\r\n                  }.`\r\n              }\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      ) : (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n          {inactiveCustomers.map((customer) => (\r\n            <Card \r\n              key={customer.id}\r\n              className=\"cursor-pointer hover:shadow-md transition-shadow duration-200 border border-amber-200 bg-amber-50/30\"\r\n              onClick={() => onSelectCustomer(customer)}\r\n            >\r\n              <CardHeader className=\"pb-3\">\r\n                <div className=\"flex items-start justify-between\">\r\n                  <div className=\"flex-1\">\r\n                    <h3 className=\"font-semibold text-lg text-gray-900 truncate\">\r\n                      {customer.fullName}\r\n                    </h3>\r\n                    <div className=\"flex items-center gap-1 mt-1\">\r\n                      <Calendar className=\"h-4 w-4 text-amber-600\" />\r\n                      <span className=\"text-sm font-medium text-amber-700\">\r\n                        {getDaysSinceLastPurchase(customer.fullName)}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex gap-1 ml-2\" onClick={(e) => e.stopPropagation()}>\r\n                    <Button \r\n                      variant=\"ghost\" \r\n                      size=\"sm\" \r\n                      className=\"h-8 w-8 p-0 hover:bg-purple-50 hover:text-purple-600\"\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        setSelectedCustomerForMessage(customer);\r\n                      }}\r\n                      title=\"Send 'We Miss You' message\"\r\n                    >\r\n                      <MessageCircleHeart className=\"h-4 w-4 text-purple-600\" />\r\n                    </Button>\r\n                    <Button \r\n                      variant=\"ghost\" \r\n                      size=\"sm\" \r\n                      className=\"h-8 w-8 p-0\"\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        onSelectCustomer(customer);\r\n                      }}\r\n                    >\r\n                      <Eye className=\"h-4 w-4\" />\r\n                    </Button>\r\n                    {customer.email && (\r\n                      <Button \r\n                        variant=\"ghost\" \r\n                        size=\"sm\"\r\n                        className=\"h-8 w-8 p-0\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          handleSendEmail(customer);\r\n                        }}\r\n                      >\r\n                        <Mail className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent className=\"pt-0\">\r\n                <div className=\"space-y-3\">\r\n                  {/* Contact Information */}\r\n                  <div className=\"space-y-2\">\r\n                    {customer.email && (\r\n                      <div className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                        <Mail className=\"h-4 w-4 text-gray-400\" />\r\n                        <span className=\"truncate\">{customer.email}</span>\r\n                      </div>\r\n                    )}\r\n                    {customer.phoneNumber && (\r\n                      <div className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                        <Phone className=\"h-4 w-4 text-gray-400\" />\r\n                        <span>{customer.phoneNumber}</span>\r\n                      </div>\r\n                    )}\r\n                    {customer.location && (\r\n                      <div className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                        <MapPin className=\"h-4 w-4 text-gray-400\" />\r\n                        <span className=\"truncate\">{customer.location}</span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Tags */}\r\n                  {customer.tags && customer.tags.length > 0 && (\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"flex items-center gap-1 text-sm text-gray-500\">\r\n                        <Tag className=\"h-3 w-3\" />\r\n                        <span>Tags</span>\r\n                      </div>\r\n                      <div className=\"flex flex-wrap gap-1\">\r\n                        {customer.tags.slice(0, 2).map((tag, i) => (\r\n                          <Badge key={i} variant=\"outline\" className=\"text-xs bg-blue-50 border-blue-200 text-blue-700\">\r\n                            {tag}\r\n                          </Badge>\r\n                        ))}\r\n                        {customer.tags.length > 2 && (\r\n                          <Badge variant=\"outline\" className=\"text-xs bg-gray-100 border-gray-200\">\r\n                            +{customer.tags.length - 2}\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* We Miss You Dialog */}\r\n      <WeMissYouDialog\r\n        customer={selectedCustomerForMessage}\r\n        open={!!selectedCustomerForMessage}\r\n        onClose={() => setSelectedCustomerForMessage(null)}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InactiveCustomersList;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4637, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerForm.tsx"],"sourcesContent":["\r\nimport React from \"react\";\r\nimport { Customer } from \"@/types\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Calendar as CalendarIcon } from \"lucide-react\";\r\nimport { Calendar } from \"@/components/ui/calendar\";\r\nimport {\r\n  Popover,\r\n  PopoverContent,\r\n  PopoverTrigger,\r\n} from \"@/components/ui/popover\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { format } from \"date-fns\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { X } from \"lucide-react\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { DialogFooter } from \"@/components/ui/dialog\";\r\nimport { useCustomerCategories } from \"@/hooks/useCustomerCategories\";\r\n\r\ninterface CustomerFormProps {\r\n  initialData?: Customer;\r\n  onSubmit: (data: Partial<Customer>) => Promise<boolean>;\r\n  onCancel: () => void;\r\n}\r\n\r\nconst CustomerForm: React.FC<CustomerFormProps> = ({\r\n  initialData,\r\n  onSubmit,\r\n  onCancel,\r\n}) => {\r\n  const [isSubmitting, setIsSubmitting] = React.useState(false);\r\n  const { categories } = useCustomerCategories();\r\n  \r\n  // Initialize date state with proper timezone handling \r\n  const [date, setDate] = React.useState<Date | undefined>(() => {\r\n    if (initialData?.birthday) {\r\n      console.log('Initial birthday from props:', initialData.birthday);\r\n      return initialData.birthday;\r\n    }\r\n    return undefined;\r\n  });\r\n  \r\n  // Initialize category selection - use \"none\" instead of empty string\r\n  const [selectedCategoryId, setSelectedCategoryId] = React.useState<string>(\r\n    initialData?.categoryId || \"none\"\r\n  );\r\n  \r\n  // Log the initial birthday from props to help debug\r\n  React.useEffect(() => {\r\n    if (initialData?.birthday) {\r\n      console.log('Initial birthday from props:', initialData.birthday);\r\n      console.log('Is Date object:', initialData.birthday instanceof Date);\r\n      console.log('Date string:', initialData.birthday.toString());\r\n    }\r\n  }, [initialData?.birthday]);\r\n  \r\n  const [socialMedia, setSocialMedia] = React.useState({\r\n    facebook: initialData?.socialMedia?.facebook || \"\",\r\n    instagram: initialData?.socialMedia?.instagram || \"\",\r\n    twitter: initialData?.socialMedia?.twitter || \"\",\r\n    linkedin: initialData?.socialMedia?.linkedin || \"\",\r\n    other: initialData?.socialMedia?.other || \"\",\r\n  });\r\n  \r\n  const [tags, setTags] = React.useState<string[]>(initialData?.tags || []);\r\n  const [tagInput, setTagInput] = React.useState(\"\");\r\n  const [selectedGender, setSelectedGender] = React.useState(initialData?.gender || \"\");\r\n\r\n  const { register, handleSubmit, formState: { errors } } = useForm({\r\n    defaultValues: {\r\n      fullName: initialData?.fullName || \"\",\r\n      email: initialData?.email || \"\",\r\n      phoneNumber: initialData?.phoneNumber || \"\",\r\n      location: initialData?.location || \"\",\r\n      gender: initialData?.gender || \"\",\r\n      notes: initialData?.notes || \"\",\r\n    },\r\n  });\r\n\r\n  const addTag = () => {\r\n    if (tagInput.trim() !== \"\" && !tags.includes(tagInput.trim())) {\r\n      setTags([...tags, tagInput.trim()]);\r\n      setTagInput(\"\");\r\n    }\r\n  };\r\n\r\n  const removeTag = (tagToRemove: string) => {\r\n    setTags(tags.filter((tag) => tag !== tagToRemove));\r\n  };\r\n\r\n  const handleSocialMediaChange = (\r\n    e: React.ChangeEvent<HTMLInputElement>,\r\n    platform: string\r\n  ) => {\r\n    setSocialMedia({\r\n      ...socialMedia,\r\n      [platform]: e.target.value,\r\n    });\r\n  };\r\n\r\n  const onFormSubmit = async (data: any) => {\r\n    setIsSubmitting(true);\r\n    try {\r\n      // Log the date to help debug\r\n      console.log('Selected date before submission:', date);\r\n      \r\n      const customerData: Partial<Customer> = {\r\n        ...data,\r\n        gender: selectedGender,\r\n        birthday: date, // This is the Date object that needs to be correctly handled\r\n        categoryId: selectedCategoryId === \"none\" ? null : selectedCategoryId, // Convert \"none\" back to null\r\n        socialMedia: Object.keys(socialMedia).length > 0 ? socialMedia : null,\r\n        tags: tags.length > 0 ? tags : null,\r\n      };\r\n      \r\n      console.log('Submitting customer data:', customerData);\r\n      await onSubmit(customerData);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  // Generate years for the dropdown (100 years back from current year)\r\n  const currentYear = new Date().getFullYear();\r\n  const years = Array.from({ length: 100 }, (_, i) => currentYear - i);\r\n  \r\n  // Months array for the dropdown\r\n  const months = [\r\n    { value: 0, label: \"January\" },\r\n    { value: 1, label: \"February\" },\r\n    { value: 2, label: \"March\" },\r\n    { value: 3, label: \"April\" },\r\n    { value: 4, label: \"May\" },\r\n    { value: 5, label: \"June\" },\r\n    { value: 6, label: \"July\" },\r\n    { value: 7, label: \"August\" },\r\n    { value: 8, label: \"September\" },\r\n    { value: 9, label: \"October\" },\r\n    { value: 10, label: \"November\" },\r\n    { value: 11, label: \"December\" },\r\n  ];\r\n\r\n  // Handle date selection directly from calendar\r\n  const handleDateSelect = (selectedDate: Date | undefined) => {\r\n    console.log('Date selected from calendar:', selectedDate);\r\n    \r\n    if (selectedDate) {\r\n      // When selecting a date, set it at noon UTC to avoid timezone issues\r\n      const year = selectedDate.getFullYear();\r\n      const month = selectedDate.getMonth();\r\n      const day = selectedDate.getDate();\r\n      \r\n      // Create new date at UTC noon to prevent date shifts\r\n      const correctedDate = new Date(Date.UTC(year, month, day, 12, 0, 0));\r\n      console.log('Corrected date with UTC noon:', correctedDate);\r\n      \r\n      setDate(correctedDate);\r\n    } else {\r\n      setDate(undefined);\r\n    }\r\n  };\r\n\r\n  // Handle year selection with proper date validation\r\n  const handleYearSelect = (year: string) => {\r\n    try {\r\n      const yearNum = parseInt(year);\r\n      const newDate = date ? new Date(date) : new Date();\r\n      \r\n      // Create a UTC date at noon to prevent timezone issues\r\n      const correctedDate = new Date(Date.UTC(\r\n        yearNum,\r\n        newDate.getMonth(),\r\n        newDate.getDate(),\r\n        12, 0, 0\r\n      ));\r\n      \r\n      // Check if the resulting date is valid\r\n      if (!isNaN(correctedDate.getTime())) {\r\n        setDate(correctedDate);\r\n        console.log('Year selected, new date:', correctedDate);\r\n      } else {\r\n        console.error('Invalid date after setting year:', year);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error setting year:', error);\r\n    }\r\n  };\r\n\r\n  // Handle month selection with proper date validation\r\n  const handleMonthSelect = (month: string) => {\r\n    try {\r\n      const monthNum = parseInt(month);\r\n      const newDate = date ? new Date(date) : new Date();\r\n      \r\n      // Create a UTC date at noon to prevent timezone issues\r\n      const correctedDate = new Date(Date.UTC(\r\n        newDate.getFullYear(),\r\n        monthNum,\r\n        newDate.getDate(),\r\n        12, 0, 0\r\n      ));\r\n      \r\n      // Check if the resulting date is valid\r\n      if (!isNaN(correctedDate.getTime())) {\r\n        setDate(correctedDate);\r\n        console.log('Month selected, new date:', correctedDate);\r\n      } else {\r\n        console.error('Invalid date after setting month:', month);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error setting month:', error);\r\n    }\r\n  };\r\n\r\n  // Filter categories to ensure no empty IDs\r\n  const validCategories = categories.filter(category => category.id && category.id.trim() !== '');\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit(onFormSubmit)}>\r\n      <div className=\"space-y-6\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"fullName\">Full Name*</Label>\r\n            <Input\r\n              id=\"fullName\"\r\n              {...register(\"fullName\", { required: \"Name is required\" })}\r\n              className={cn(errors.fullName && \"border-red-500\")}\r\n            />\r\n            {errors.fullName && (\r\n              <p className=\"text-red-500 text-xs\">\r\n                {errors.fullName.message as string}\r\n              </p>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"category\">Category</Label>\r\n            <Select\r\n              value={selectedCategoryId}\r\n              onValueChange={setSelectedCategoryId}\r\n            >\r\n              <SelectTrigger id=\"category\">\r\n                <SelectValue placeholder=\"Select category\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"none\">No Category</SelectItem>\r\n                {validCategories.map((category) => (\r\n                  <SelectItem key={category.id} value={category.id}>\r\n                    {category.name}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"email\">Email Address</Label>\r\n            <Input\r\n              id=\"email\"\r\n              type=\"email\"\r\n              {...register(\"email\", {\r\n                pattern: {\r\n                  value: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$/i,\r\n                  message: \"Invalid email address\",\r\n                },\r\n              })}\r\n              className={cn(errors.email && \"border-red-500\")}\r\n            />\r\n            {errors.email && (\r\n              <p className=\"text-red-500 text-xs\">{errors.email.message as string}</p>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"phoneNumber\">Phone Number</Label>\r\n            <Input id=\"phoneNumber\" {...register(\"phoneNumber\")} />\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"location\">Location</Label>\r\n            <Input id=\"location\" {...register(\"location\")} />\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"gender\">Gender</Label>\r\n            <Select\r\n              value={selectedGender}\r\n              onValueChange={setSelectedGender}\r\n            >\r\n              <SelectTrigger id=\"gender\">\r\n                <SelectValue placeholder=\"Select gender\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"male\">Male</SelectItem>\r\n                <SelectItem value=\"female\">Female</SelectItem>\r\n                <SelectItem value=\"non-binary\">Non-binary</SelectItem>\r\n                <SelectItem value=\"prefer-not-to-say\">\r\n                  Prefer not to say\r\n                </SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label>Birthday</Label>\r\n            <div className=\"flex flex-col gap-2\">\r\n              <div className=\"flex flex-row gap-2\">\r\n                <div className=\"flex-1\">\r\n                  <Popover>\r\n                    <PopoverTrigger asChild>\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        className=\"w-full justify-between\"\r\n                      >\r\n                        {date ? date.getDate() : \"Day\"}\r\n                        <CalendarIcon className=\"h-4 w-4 opacity-50\" />\r\n                      </Button>\r\n                    </PopoverTrigger>\r\n                    <PopoverContent className=\"w-auto p-0\" align=\"start\">\r\n                      <Calendar\r\n                        mode=\"single\"\r\n                        selected={date}\r\n                        onSelect={handleDateSelect}\r\n                        initialFocus\r\n                        captionLayout=\"buttons\"\r\n                        className=\"p-3 pointer-events-auto\"\r\n                        classNames={{\r\n                          caption_label: \"hidden\",\r\n                          dropdown: \"hidden\",\r\n                        }}\r\n                      />\r\n                    </PopoverContent>\r\n                  </Popover>\r\n                </div>\r\n                <div className=\"flex-1\">\r\n                  <Select\r\n                    value={date ? String(date.getMonth()) : undefined}\r\n                    onValueChange={handleMonthSelect}\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"Month\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      {months.map((month) => (\r\n                        <SelectItem key={month.value} value={String(month.value)}>\r\n                          {month.label}\r\n                        </SelectItem>\r\n                      ))}\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n                <div className=\"flex-1\">\r\n                  <Select\r\n                    value={date ? String(date.getFullYear()) : undefined}\r\n                    onValueChange={handleYearSelect}\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"Year\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      {years.map((year) => (\r\n                        <SelectItem key={year} value={String(year)}>\r\n                          {year}\r\n                        </SelectItem>\r\n                      ))}\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n              </div>\r\n              {date && (\r\n                <div className=\"text-sm text-muted-foreground\">\r\n                  Selected: {date ? format(date, \"PPP\") : \"No date selected\"}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"space-y-2\">\r\n          <Label>Tags</Label>\r\n          <div className=\"flex flex-wrap gap-1 mb-2\">\r\n            {tags.map((tag) => (\r\n              <Badge key={tag} variant=\"secondary\">\r\n                {tag}\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"ml-1 rounded-full hover:bg-gray-200\"\r\n                  onClick={() => removeTag(tag)}\r\n                >\r\n                  <X className=\"h-3 w-3\" />\r\n                  <span className=\"sr-only\">Remove tag</span>\r\n                </button>\r\n              </Badge>\r\n            ))}\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <Input\r\n              value={tagInput}\r\n              onChange={(e) => setTagInput(e.target.value)}\r\n              placeholder=\"Add tag\"\r\n              onKeyDown={(e) => e.key === \"Enter\" && (e.preventDefault(), addTag())}\r\n            />\r\n            <Button type=\"button\" onClick={addTag} variant=\"outline\">\r\n              Add\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"space-y-2\">\r\n          <Label>Social Media</Label>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n            <div className=\"space-y-1\">\r\n              <Label htmlFor=\"facebook\" className=\"text-xs\">\r\n                Facebook\r\n              </Label>\r\n              <Input\r\n                id=\"facebook\"\r\n                value={socialMedia.facebook}\r\n                onChange={(e) => handleSocialMediaChange(e, \"facebook\")}\r\n                placeholder=\"Username or URL\"\r\n              />\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <Label htmlFor=\"instagram\" className=\"text-xs\">\r\n                Instagram\r\n              </Label>\r\n              <Input\r\n                id=\"instagram\"\r\n                value={socialMedia.instagram}\r\n                onChange={(e) => handleSocialMediaChange(e, \"instagram\")}\r\n                placeholder=\"Username without @\"\r\n              />\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <Label htmlFor=\"twitter\" className=\"text-xs\">\r\n                Twitter/X\r\n              </Label>\r\n              <Input\r\n                id=\"twitter\"\r\n                value={socialMedia.twitter}\r\n                onChange={(e) => handleSocialMediaChange(e, \"twitter\")}\r\n                placeholder=\"Username without @\"\r\n              />\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <Label htmlFor=\"linkedin\" className=\"text-xs\">\r\n                LinkedIn\r\n              </Label>\r\n              <Input\r\n                id=\"linkedin\"\r\n                value={socialMedia.linkedin}\r\n                onChange={(e) => handleSocialMediaChange(e, \"linkedin\")}\r\n                placeholder=\"Profile URL or username\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"space-y-2\">\r\n          <Label>Birthday</Label>\r\n          <div className=\"flex flex-col gap-2\">\r\n            <div className=\"flex flex-row gap-2\">\r\n              <div className=\"flex-1\">\r\n                <Popover>\r\n                  <PopoverTrigger asChild>\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      className=\"w-full justify-between\"\r\n                    >\r\n                      {date ? date.getDate() : \"Day\"}\r\n                      <CalendarIcon className=\"h-4 w-4 opacity-50\" />\r\n                    </Button>\r\n                  </PopoverTrigger>\r\n                  <PopoverContent className=\"w-auto p-0\" align=\"start\">\r\n                    <Calendar\r\n                      mode=\"single\"\r\n                      selected={date}\r\n                      onSelect={handleDateSelect}\r\n                      initialFocus\r\n                      captionLayout=\"buttons\"\r\n                      className=\"p-3 pointer-events-auto\"\r\n                      classNames={{\r\n                        caption_label: \"hidden\",\r\n                        dropdown: \"hidden\",\r\n                      }}\r\n                    />\r\n                  </PopoverContent>\r\n                </Popover>\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <Select\r\n                  value={date ? String(date.getMonth()) : undefined}\r\n                  onValueChange={handleMonthSelect}\r\n                >\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Month\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    {months.map((month) => (\r\n                      <SelectItem key={month.value} value={String(month.value)}>\r\n                        {month.label}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <Select\r\n                  value={date ? String(date.getFullYear()) : undefined}\r\n                  onValueChange={handleYearSelect}\r\n                >\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Year\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    {years.map((year) => (\r\n                      <SelectItem key={year} value={String(year)}>\r\n                        {year}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n            {date && (\r\n              <div className=\"text-sm text-muted-foreground\">\r\n                Selected: {date ? format(date, \"PPP\") : \"No date selected\"}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"space-y-2\">\r\n          <Label htmlFor=\"notes\">Notes</Label>\r\n          <Textarea\r\n            id=\"notes\"\r\n            {...register(\"notes\")}\r\n            rows={4}\r\n            placeholder=\"Add any notes about this customer...\"\r\n          />\r\n        </div>\r\n\r\n        <DialogFooter>\r\n          <Button variant=\"outline\" type=\"button\" onClick={onCancel}>\r\n            Cancel\r\n          </Button>\r\n          <Button type=\"submit\" disabled={isSubmitting}>\r\n            {isSubmitting ? \"Saving...\" : \"Save Changes\"}\r\n          </Button>\r\n        </DialogFooter>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default CustomerForm;\r\n"],"names":[],"mappings":";;;;;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;AAQA,MAAM,eAA4C,CAAC,EACjD,WAAW,EACX,QAAQ,EACR,QAAQ,EACT;;IACC,MAAM,CAAC,cAAc,gBAAgB,GAAG,wKAAK,CAAC,QAAQ,CAAC;IACvD,MAAM,EAAE,UAAU,EAAE,GAAG,IAAA,iKAAqB;IAE5C,uDAAuD;IACvD,MAAM,CAAC,MAAM,QAAQ,GAAG,wKAAK,CAAC,QAAQ;iCAAmB;YACvD,IAAI,aAAa,UAAU;gBACzB,QAAQ,GAAG,CAAC,gCAAgC,YAAY,QAAQ;gBAChE,OAAO,YAAY,QAAQ;YAC7B;YACA,OAAO;QACT;;IAEA,qEAAqE;IACrE,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,wKAAK,CAAC,QAAQ,CAChE,aAAa,cAAc;IAG7B,oDAAoD;IACpD,wKAAK,CAAC,SAAS;kCAAC;YACd,IAAI,aAAa,UAAU;gBACzB,QAAQ,GAAG,CAAC,gCAAgC,YAAY,QAAQ;gBAChE,QAAQ,GAAG,CAAC,mBAAmB,YAAY,QAAQ,YAAY;gBAC/D,QAAQ,GAAG,CAAC,gBAAgB,YAAY,QAAQ,CAAC,QAAQ;YAC3D;QACF;iCAAG;QAAC,aAAa;KAAS;IAE1B,MAAM,CAAC,aAAa,eAAe,GAAG,wKAAK,CAAC,QAAQ,CAAC;QACnD,UAAU,aAAa,aAAa,YAAY;QAChD,WAAW,aAAa,aAAa,aAAa;QAClD,SAAS,aAAa,aAAa,WAAW;QAC9C,UAAU,aAAa,aAAa,YAAY;QAChD,OAAO,aAAa,aAAa,SAAS;IAC5C;IAEA,MAAM,CAAC,MAAM,QAAQ,GAAG,wKAAK,CAAC,QAAQ,CAAW,aAAa,QAAQ,EAAE;IACxE,MAAM,CAAC,UAAU,YAAY,GAAG,wKAAK,CAAC,QAAQ,CAAC;IAC/C,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,wKAAK,CAAC,QAAQ,CAAC,aAAa,UAAU;IAElF,MAAM,EAAE,QAAQ,EAAE,YAAY,EAAE,WAAW,EAAE,MAAM,EAAE,EAAE,GAAG,IAAA,4KAAO,EAAC;QAChE,eAAe;YACb,UAAU,aAAa,YAAY;YACnC,OAAO,aAAa,SAAS;YAC7B,aAAa,aAAa,eAAe;YACzC,UAAU,aAAa,YAAY;YACnC,QAAQ,aAAa,UAAU;YAC/B,OAAO,aAAa,SAAS;QAC/B;IACF;IAEA,MAAM,SAAS;QACb,IAAI,SAAS,IAAI,OAAO,MAAM,CAAC,KAAK,QAAQ,CAAC,SAAS,IAAI,KAAK;YAC7D,QAAQ;mBAAI;gBAAM,SAAS,IAAI;aAAG;YAClC,YAAY;QACd;IACF;IAEA,MAAM,YAAY,CAAC;QACjB,QAAQ,KAAK,MAAM,CAAC,CAAC,MAAQ,QAAQ;IACvC;IAEA,MAAM,0BAA0B,CAC9B,GACA;QAEA,eAAe;YACb,GAAG,WAAW;YACd,CAAC,SAAS,EAAE,EAAE,MAAM,CAAC,KAAK;QAC5B;IACF;IAEA,MAAM,eAAe,OAAO;QAC1B,gBAAgB;QAChB,IAAI;YACF,6BAA6B;YAC7B,QAAQ,GAAG,CAAC,oCAAoC;YAEhD,MAAM,eAAkC;gBACtC,GAAG,IAAI;gBACP,QAAQ;gBACR,UAAU;gBACV,YAAY,uBAAuB,SAAS,OAAO;gBACnD,aAAa,OAAO,IAAI,CAAC,aAAa,MAAM,GAAG,IAAI,cAAc;gBACjE,MAAM,KAAK,MAAM,GAAG,IAAI,OAAO;YACjC;YAEA,QAAQ,GAAG,CAAC,6BAA6B;YACzC,MAAM,SAAS;QACjB,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,qEAAqE;IACrE,MAAM,cAAc,IAAI,OAAO,WAAW;IAC1C,MAAM,QAAQ,MAAM,IAAI,CAAC;QAAE,QAAQ;IAAI,GAAG,CAAC,GAAG,IAAM,cAAc;IAElE,gCAAgC;IAChC,MAAM,SAAS;QACb;YAAE,OAAO;YAAG,OAAO;QAAU;QAC7B;YAAE,OAAO;YAAG,OAAO;QAAW;QAC9B;YAAE,OAAO;YAAG,OAAO;QAAQ;QAC3B;YAAE,OAAO;YAAG,OAAO;QAAQ;QAC3B;YAAE,OAAO;YAAG,OAAO;QAAM;QACzB;YAAE,OAAO;YAAG,OAAO;QAAO;QAC1B;YAAE,OAAO;YAAG,OAAO;QAAO;QAC1B;YAAE,OAAO;YAAG,OAAO;QAAS;QAC5B;YAAE,OAAO;YAAG,OAAO;QAAY;QAC/B;YAAE,OAAO;YAAG,OAAO;QAAU;QAC7B;YAAE,OAAO;YAAI,OAAO;QAAW;QAC/B;YAAE,OAAO;YAAI,OAAO;QAAW;KAChC;IAED,+CAA+C;IAC/C,MAAM,mBAAmB,CAAC;QACxB,QAAQ,GAAG,CAAC,gCAAgC;QAE5C,IAAI,cAAc;YAChB,qEAAqE;YACrE,MAAM,OAAO,aAAa,WAAW;YACrC,MAAM,QAAQ,aAAa,QAAQ;YACnC,MAAM,MAAM,aAAa,OAAO;YAEhC,qDAAqD;YACrD,MAAM,gBAAgB,IAAI,KAAK,KAAK,GAAG,CAAC,MAAM,OAAO,KAAK,IAAI,GAAG;YACjE,QAAQ,GAAG,CAAC,iCAAiC;YAE7C,QAAQ;QACV,OAAO;YACL,QAAQ;QACV;IACF;IAEA,oDAAoD;IACpD,MAAM,mBAAmB,CAAC;QACxB,IAAI;YACF,MAAM,UAAU,SAAS;YACzB,MAAM,UAAU,OAAO,IAAI,KAAK,QAAQ,IAAI;YAE5C,uDAAuD;YACvD,MAAM,gBAAgB,IAAI,KAAK,KAAK,GAAG,CACrC,SACA,QAAQ,QAAQ,IAChB,QAAQ,OAAO,IACf,IAAI,GAAG;YAGT,uCAAuC;YACvC,IAAI,CAAC,MAAM,cAAc,OAAO,KAAK;gBACnC,QAAQ;gBACR,QAAQ,GAAG,CAAC,4BAA4B;YAC1C,OAAO;gBACL,QAAQ,KAAK,CAAC,oCAAoC;YACpD;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,uBAAuB;QACvC;IACF;IAEA,qDAAqD;IACrD,MAAM,oBAAoB,CAAC;QACzB,IAAI;YACF,MAAM,WAAW,SAAS;YAC1B,MAAM,UAAU,OAAO,IAAI,KAAK,QAAQ,IAAI;YAE5C,uDAAuD;YACvD,MAAM,gBAAgB,IAAI,KAAK,KAAK,GAAG,CACrC,QAAQ,WAAW,IACnB,UACA,QAAQ,OAAO,IACf,IAAI,GAAG;YAGT,uCAAuC;YACvC,IAAI,CAAC,MAAM,cAAc,OAAO,KAAK;gBACnC,QAAQ;gBACR,QAAQ,GAAG,CAAC,6BAA6B;YAC3C,OAAO;gBACL,QAAQ,KAAK,CAAC,qCAAqC;YACrD;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,wBAAwB;QACxC;IACF;IAEA,2CAA2C;IAC3C,MAAM,kBAAkB,WAAW,MAAM,CAAC,CAAA,WAAY,SAAS,EAAE,IAAI,SAAS,EAAE,CAAC,IAAI,OAAO;IAE5F,qBACE,6LAAC;QAAK,UAAU,aAAa;kBAC3B,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,6IAAK;oCAAC,SAAQ;8CAAW;;;;;;8CAC1B,6LAAC,6IAAK;oCACJ,IAAG;oCACF,GAAG,SAAS,YAAY;wCAAE,UAAU;oCAAmB,EAAE;oCAC1D,WAAW,IAAA,4HAAE,EAAC,OAAO,QAAQ,IAAI;;;;;;gCAElC,OAAO,QAAQ,kBACd,6LAAC;oCAAE,WAAU;8CACV,OAAO,QAAQ,CAAC,OAAO;;;;;;;;;;;;sCAK9B,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,6IAAK;oCAAC,SAAQ;8CAAW;;;;;;8CAC1B,6LAAC,+IAAM;oCACL,OAAO;oCACP,eAAe;;sDAEf,6LAAC,sJAAa;4CAAC,IAAG;sDAChB,cAAA,6LAAC,oJAAW;gDAAC,aAAY;;;;;;;;;;;sDAE3B,6LAAC,sJAAa;;8DACZ,6LAAC,mJAAU;oDAAC,OAAM;8DAAO;;;;;;gDACxB,gBAAgB,GAAG,CAAC,CAAC,yBACpB,6LAAC,mJAAU;wDAAmB,OAAO,SAAS,EAAE;kEAC7C,SAAS,IAAI;uDADC,SAAS,EAAE;;;;;;;;;;;;;;;;;;;;;;;sCAQpC,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,6IAAK;oCAAC,SAAQ;8CAAQ;;;;;;8CACvB,6LAAC,6IAAK;oCACJ,IAAG;oCACH,MAAK;oCACJ,GAAG,SAAS,SAAS;wCACpB,SAAS;4CACP,OAAO;4CACP,SAAS;wCACX;oCACF,EAAE;oCACF,WAAW,IAAA,4HAAE,EAAC,OAAO,KAAK,IAAI;;;;;;gCAE/B,OAAO,KAAK,kBACX,6LAAC;oCAAE,WAAU;8CAAwB,OAAO,KAAK,CAAC,OAAO;;;;;;;;;;;;sCAI7D,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,6IAAK;oCAAC,SAAQ;8CAAc;;;;;;8CAC7B,6LAAC,6IAAK;oCAAC,IAAG;oCAAe,GAAG,SAAS,cAAc;;;;;;;;;;;;sCAGrD,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,6IAAK;oCAAC,SAAQ;8CAAW;;;;;;8CAC1B,6LAAC,6IAAK;oCAAC,IAAG;oCAAY,GAAG,SAAS,WAAW;;;;;;;;;;;;sCAG/C,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,6IAAK;oCAAC,SAAQ;8CAAS;;;;;;8CACxB,6LAAC,+IAAM;oCACL,OAAO;oCACP,eAAe;;sDAEf,6LAAC,sJAAa;4CAAC,IAAG;sDAChB,cAAA,6LAAC,oJAAW;gDAAC,aAAY;;;;;;;;;;;sDAE3B,6LAAC,sJAAa;;8DACZ,6LAAC,mJAAU;oDAAC,OAAM;8DAAO;;;;;;8DACzB,6LAAC,mJAAU;oDAAC,OAAM;8DAAS;;;;;;8DAC3B,6LAAC,mJAAU;oDAAC,OAAM;8DAAa;;;;;;8DAC/B,6LAAC,mJAAU;oDAAC,OAAM;8DAAoB;;;;;;;;;;;;;;;;;;;;;;;;sCAO5C,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,6IAAK;8CAAC;;;;;;8CACP,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAI,WAAU;8DACb,cAAA,6LAAC,iJAAO;;0EACN,6LAAC,wJAAc;gEAAC,OAAO;0EACrB,cAAA,6LAAC,+IAAM;oEACL,SAAQ;oEACR,WAAU;;wEAET,OAAO,KAAK,OAAO,KAAK;sFACzB,6LAAC,yNAAY;4EAAC,WAAU;;;;;;;;;;;;;;;;;0EAG5B,6LAAC,wJAAc;gEAAC,WAAU;gEAAa,OAAM;0EAC3C,cAAA,6LAAC,mJAAQ;oEACP,MAAK;oEACL,UAAU;oEACV,UAAU;oEACV,YAAY;oEACZ,eAAc;oEACd,WAAU;oEACV,YAAY;wEACV,eAAe;wEACf,UAAU;oEACZ;;;;;;;;;;;;;;;;;;;;;;8DAKR,6LAAC;oDAAI,WAAU;8DACb,cAAA,6LAAC,+IAAM;wDACL,OAAO,OAAO,OAAO,KAAK,QAAQ,MAAM;wDACxC,eAAe;;0EAEf,6LAAC,sJAAa;0EACZ,cAAA,6LAAC,oJAAW;oEAAC,aAAY;;;;;;;;;;;0EAE3B,6LAAC,sJAAa;0EACX,OAAO,GAAG,CAAC,CAAC,sBACX,6LAAC,mJAAU;wEAAmB,OAAO,OAAO,MAAM,KAAK;kFACpD,MAAM,KAAK;uEADG,MAAM,KAAK;;;;;;;;;;;;;;;;;;;;;8DAOpC,6LAAC;oDAAI,WAAU;8DACb,cAAA,6LAAC,+IAAM;wDACL,OAAO,OAAO,OAAO,KAAK,WAAW,MAAM;wDAC3C,eAAe;;0EAEf,6LAAC,sJAAa;0EACZ,cAAA,6LAAC,oJAAW;oEAAC,aAAY;;;;;;;;;;;0EAE3B,6LAAC,sJAAa;0EACX,MAAM,GAAG,CAAC,CAAC,qBACV,6LAAC,mJAAU;wEAAY,OAAO,OAAO;kFAClC;uEADc;;;;;;;;;;;;;;;;;;;;;;;;;;;wCAQ1B,sBACC,6LAAC;4CAAI,WAAU;;gDAAgC;gDAClC,OAAO,IAAA,kKAAM,EAAC,MAAM,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;8BAOlD,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,6IAAK;sCAAC;;;;;;sCACP,6LAAC;4BAAI,WAAU;sCACZ,KAAK,GAAG,CAAC,CAAC,oBACT,6LAAC,6IAAK;oCAAW,SAAQ;;wCACtB;sDACD,6LAAC;4CACC,MAAK;4CACL,WAAU;4CACV,SAAS,IAAM,UAAU;;8DAEzB,6LAAC,oMAAC;oDAAC,WAAU;;;;;;8DACb,6LAAC;oDAAK,WAAU;8DAAU;;;;;;;;;;;;;mCARlB;;;;;;;;;;sCAahB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,6IAAK;oCACJ,OAAO;oCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;oCAC3C,aAAY;oCACZ,WAAW,CAAC,IAAM,EAAE,GAAG,KAAK,WAAW,CAAC,EAAE,cAAc,IAAI,QAAQ;;;;;;8CAEtE,6LAAC,+IAAM;oCAAC,MAAK;oCAAS,SAAS;oCAAQ,SAAQ;8CAAU;;;;;;;;;;;;;;;;;;8BAM7D,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,6IAAK;sCAAC;;;;;;sCACP,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,6IAAK;4CAAC,SAAQ;4CAAW,WAAU;sDAAU;;;;;;sDAG9C,6LAAC,6IAAK;4CACJ,IAAG;4CACH,OAAO,YAAY,QAAQ;4CAC3B,UAAU,CAAC,IAAM,wBAAwB,GAAG;4CAC5C,aAAY;;;;;;;;;;;;8CAGhB,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,6IAAK;4CAAC,SAAQ;4CAAY,WAAU;sDAAU;;;;;;sDAG/C,6LAAC,6IAAK;4CACJ,IAAG;4CACH,OAAO,YAAY,SAAS;4CAC5B,UAAU,CAAC,IAAM,wBAAwB,GAAG;4CAC5C,aAAY;;;;;;;;;;;;8CAGhB,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,6IAAK;4CAAC,SAAQ;4CAAU,WAAU;sDAAU;;;;;;sDAG7C,6LAAC,6IAAK;4CACJ,IAAG;4CACH,OAAO,YAAY,OAAO;4CAC1B,UAAU,CAAC,IAAM,wBAAwB,GAAG;4CAC5C,aAAY;;;;;;;;;;;;8CAGhB,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,6IAAK;4CAAC,SAAQ;4CAAW,WAAU;sDAAU;;;;;;sDAG9C,6LAAC,6IAAK;4CACJ,IAAG;4CACH,OAAO,YAAY,QAAQ;4CAC3B,UAAU,CAAC,IAAM,wBAAwB,GAAG;4CAC5C,aAAY;;;;;;;;;;;;;;;;;;;;;;;;8BAMpB,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,6IAAK;sCAAC;;;;;;sCACP,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC,iJAAO;;kEACN,6LAAC,wJAAc;wDAAC,OAAO;kEACrB,cAAA,6LAAC,+IAAM;4DACL,SAAQ;4DACR,WAAU;;gEAET,OAAO,KAAK,OAAO,KAAK;8EACzB,6LAAC,yNAAY;oEAAC,WAAU;;;;;;;;;;;;;;;;;kEAG5B,6LAAC,wJAAc;wDAAC,WAAU;wDAAa,OAAM;kEAC3C,cAAA,6LAAC,mJAAQ;4DACP,MAAK;4DACL,UAAU;4DACV,UAAU;4DACV,YAAY;4DACZ,eAAc;4DACd,WAAU;4DACV,YAAY;gEACV,eAAe;gEACf,UAAU;4DACZ;;;;;;;;;;;;;;;;;;;;;;sDAKR,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC,+IAAM;gDACL,OAAO,OAAO,OAAO,KAAK,QAAQ,MAAM;gDACxC,eAAe;;kEAEf,6LAAC,sJAAa;kEACZ,cAAA,6LAAC,oJAAW;4DAAC,aAAY;;;;;;;;;;;kEAE3B,6LAAC,sJAAa;kEACX,OAAO,GAAG,CAAC,CAAC,sBACX,6LAAC,mJAAU;gEAAmB,OAAO,OAAO,MAAM,KAAK;0EACpD,MAAM,KAAK;+DADG,MAAM,KAAK;;;;;;;;;;;;;;;;;;;;;sDAOpC,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC,+IAAM;gDACL,OAAO,OAAO,OAAO,KAAK,WAAW,MAAM;gDAC3C,eAAe;;kEAEf,6LAAC,sJAAa;kEACZ,cAAA,6LAAC,oJAAW;4DAAC,aAAY;;;;;;;;;;;kEAE3B,6LAAC,sJAAa;kEACX,MAAM,GAAG,CAAC,CAAC,qBACV,6LAAC,mJAAU;gEAAY,OAAO,OAAO;0EAClC;+DADc;;;;;;;;;;;;;;;;;;;;;;;;;;;gCAQ1B,sBACC,6LAAC;oCAAI,WAAU;;wCAAgC;wCAClC,OAAO,IAAA,kKAAM,EAAC,MAAM,SAAS;;;;;;;;;;;;;;;;;;;8BAMhD,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,6IAAK;4BAAC,SAAQ;sCAAQ;;;;;;sCACvB,6LAAC,mJAAQ;4BACP,IAAG;4BACF,GAAG,SAAS,QAAQ;4BACrB,MAAM;4BACN,aAAY;;;;;;;;;;;;8BAIhB,6LAAC,qJAAY;;sCACX,6LAAC,+IAAM;4BAAC,SAAQ;4BAAU,MAAK;4BAAS,SAAS;sCAAU;;;;;;sCAG3D,6LAAC,+IAAM;4BAAC,MAAK;4BAAS,UAAU;sCAC7B,eAAe,cAAc;;;;;;;;;;;;;;;;;;;;;;;AAM1C;GAhhBM;;QAMmB,iKAAqB;QAqCc,4KAAO;;;KA3C7D;uCAkhBS"}},
    {"offset": {"line": 5859, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerPurchaseHistory.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useSalesData } from '@/hooks/useSalesData';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { Sale } from '@/types';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow\r\n} from '@/components/ui/table';\r\nimport { format } from 'date-fns';\r\nimport { Link } from 'react-router-dom';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Loader2 } from 'lucide-react';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport ReceiptDialog from '@/components/sales/ReceiptDialog';\r\n\r\ninterface CustomerPurchaseHistoryProps {\r\n  customerId: string;\r\n}\r\n\r\nconst CustomerPurchaseHistory: React.FC<CustomerPurchaseHistoryProps> = ({ customerId }) => {\r\n  const { user } = useAuth();\r\n  const { settings } = useBusinessSettings();\r\n  const { sales, isLoading } = useSalesData(user?.id, 'desc');\r\n\r\n  const [customerSales, setCustomerSales] = useState<Sale[]>([]);\r\n  const [localLoading, setLocalLoading] = useState(true);\r\n  const [customerName, setCustomerName] = useState<string>('');\r\n\r\n  const [selectedSale, setSelectedSale] = useState<Sale | null>(null);\r\n  const [isReceiptDialogOpen, setIsReceiptDialogOpen] = useState(false);\r\n\r\n  // Fetch customer name ONCE for fallback\r\n  useEffect(() => {\r\n    const loadCustomerName = async () => {\r\n      const { data } = await supabase\r\n        .from('customers')\r\n        .select('full_name')\r\n        .eq('id', customerId)\r\n        .single();\r\n\r\n      setCustomerName(data?.full_name || '');\r\n    };\r\n\r\n    loadCustomerName();\r\n  }, [customerId]);\r\n\r\n  useEffect(() => {\r\n    if (!sales || sales.length === 0 || !customerName) {\r\n      setCustomerSales([]);\r\n      setLocalLoading(false);\r\n      return;\r\n    }\r\n\r\n    // PRIMARY: If sale has customerId, match it directly.\r\n    // FALLBACK: Use customerName matching for legacy sales.\r\n    const filtered = sales.filter((sale) => {\r\n      if (sale.customerId) {\r\n        return sale.customerId === customerId;\r\n      }\r\n\r\n      // Fallback for older sales without ID\r\n      const matchesCustomer = sale.customerName?.toLowerCase().trim() === customerName.toLowerCase().trim();\r\n\r\n      // Filter out manual statement entries (Adjustments and Manual Payments)\r\n      const isManualEntry = sale.receiptNumber?.startsWith('ADJ-') || sale.receiptNumber?.startsWith('PAY-');\r\n\r\n      return matchesCustomer && !isManualEntry;\r\n    });\r\n\r\n    setCustomerSales(filtered);\r\n    setLocalLoading(false);\r\n  }, [sales, customerId, customerName]);\r\n\r\n  const formatCurrency = (value: any) => {\r\n    return `${settings.currency} ${formatNumber(value)}`;\r\n  };\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    switch (status?.toUpperCase()) {\r\n      case \"PAID\":\r\n        return <Badge className=\"bg-green-100 text-green-800\">Paid</Badge>;\r\n      case \"NOT PAID\":\r\n        return <Badge className=\"bg-red-100 text-red-800\">Unpaid</Badge>;\r\n      case \"QUOTE\":\r\n        return <Badge className=\"bg-blue-100 text-blue-800\">Quote</Badge>;\r\n      case \"INSTALLMENT SALE\":\r\n        return <Badge className=\"bg-purple-100 text-purple-800\">Installment</Badge>;\r\n      default:\r\n        return <Badge>{status}</Badge>;\r\n    }\r\n  };\r\n\r\n  const getItemsDisplay = (sale: Sale) => {\r\n    if (!sale.items || sale.items.length === 0) {\r\n      return \"No items\";\r\n    }\r\n\r\n    const first = sale.items[0];\r\n    return sale.items.length === 1\r\n      ? `${first.description} (${first.quantity})`\r\n      : `${first.description} (+${sale.items.length - 1} more)`;\r\n  };\r\n\r\n  const handleRowClick = (sale: Sale) => {\r\n    setSelectedSale(sale);\r\n    setIsReceiptDialogOpen(true);\r\n  };\r\n\r\n  if (isLoading || localLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center p-8\">\r\n        <Loader2 className=\"h-8 w-8 animate-spin text-blue-500\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (customerSales.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-8 border rounded-md\">\r\n        <h3 className=\"text-lg font-medium text-gray-900\">No purchase history found</h3>\r\n        <p className=\"mt-1 text-sm text-gray-500\">\r\n          This customer hasn't made any purchases yet\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"rounded-md border\">\r\n        <Table>\r\n          <TableHeader>\r\n            <TableRow>\r\n              <TableHead>Date</TableHead>\r\n              <TableHead>Receipt #</TableHead>\r\n              <TableHead>Amount</TableHead>\r\n              <TableHead>Items</TableHead>\r\n              <TableHead>Status</TableHead>\r\n            </TableRow>\r\n          </TableHeader>\r\n\r\n          <TableBody>\r\n            {customerSales.map((sale) => (\r\n              <TableRow\r\n                key={sale.id}\r\n                className=\"cursor-pointer hover:bg-gray-50\"\r\n                onClick={() => handleRowClick(sale)}\r\n              >\r\n                <TableCell>{format(sale.date, 'MMM d, yyyy')}</TableCell>\r\n\r\n                <TableCell>\r\n                  <Link\r\n                    to={`/sales?receipt=${sale.receiptNumber}`}\r\n                    className=\"text-blue-600 hover:underline\"\r\n                    onClick={(e) => e.stopPropagation()}\r\n                  >\r\n                    {sale.receiptNumber}\r\n                  </Link>\r\n                </TableCell>\r\n\r\n                <TableCell>\r\n                  {formatCurrency(\r\n                    sale.items.reduce(\r\n                      (sum, item) => sum + item.price * item.quantity,\r\n                      0\r\n                    )\r\n                  )}\r\n                </TableCell>\r\n\r\n                <TableCell>\r\n                  <span className=\"text-sm\">{getItemsDisplay(sale)}</span>\r\n                </TableCell>\r\n\r\n                <TableCell>{getStatusBadge(sale.paymentStatus)}</TableCell>\r\n              </TableRow>\r\n            ))}\r\n          </TableBody>\r\n        </Table>\r\n      </div>\r\n\r\n      {selectedSale && (\r\n        <ReceiptDialog\r\n          isOpen={isReceiptDialogOpen}\r\n          sale={selectedSale}\r\n          currency={settings.currency}\r\n          onOpenChange={() => {\r\n            setIsReceiptDialogOpen(false);\r\n            setSelectedSale(null);\r\n          }}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CustomerPurchaseHistory;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6215, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerNotes.tsx"],"sourcesContent":["\r\nimport React, { useState } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Save } from \"lucide-react\";\r\n\r\ninterface CustomerNotesProps {\r\n  notes: string;\r\n  onSave: (notes: string) => Promise<boolean>;\r\n}\r\n\r\nconst CustomerNotes: React.FC<CustomerNotesProps> = ({ notes, onSave }) => {\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [notesContent, setNotesContent] = useState(notes);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const handleSave = async () => {\r\n    setIsSaving(true);\r\n    try {\r\n      const success = await onSave(notesContent);\r\n      if (success) {\r\n        setIsEditing(false);\r\n      }\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Card>\r\n      <CardContent className=\"pt-6\">\r\n        {isEditing ? (\r\n          <div className=\"space-y-4\">\r\n            <Textarea\r\n              value={notesContent}\r\n              onChange={(e) => setNotesContent(e.target.value)}\r\n              rows={8}\r\n              placeholder=\"Enter notes about this customer...\"\r\n              className=\"w-full\"\r\n            />\r\n            <div className=\"flex justify-end gap-2\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => {\r\n                  setNotesContent(notes);\r\n                  setIsEditing(false);\r\n                }}\r\n              >\r\n                Cancel\r\n              </Button>\r\n              <Button onClick={handleSave} disabled={isSaving}>\r\n                {isSaving ? \"Saving...\" : \"Save Notes\"}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            {notes ? (\r\n              <div className=\"whitespace-pre-wrap\">{notes}</div>\r\n            ) : (\r\n              <div className=\"text-muted-foreground italic\">\r\n                No notes for this customer yet.\r\n              </div>\r\n            )}\r\n            <div className=\"flex justify-end\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => setIsEditing(true)}\r\n              >\r\n                <Save className=\"h-4 w-4 mr-1\" />\r\n                Edit Notes\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default CustomerNotes;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAOA,MAAM,gBAA8C,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE;;IACpE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IAEzC,MAAM,aAAa;QACjB,YAAY;QACZ,IAAI;YACF,MAAM,UAAU,MAAM,OAAO;YAC7B,IAAI,SAAS;gBACX,aAAa;YACf;QACF,SAAU;YACR,YAAY;QACd;IACF;IAEA,qBACE,6LAAC,2IAAI;kBACH,cAAA,6LAAC,kJAAW;YAAC,WAAU;sBACpB,0BACC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,mJAAQ;wBACP,OAAO;wBACP,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,KAAK;wBAC/C,MAAM;wBACN,aAAY;wBACZ,WAAU;;;;;;kCAEZ,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,+IAAM;gCACL,SAAQ;gCACR,SAAS;oCACP,gBAAgB;oCAChB,aAAa;gCACf;0CACD;;;;;;0CAGD,6LAAC,+IAAM;gCAAC,SAAS;gCAAY,UAAU;0CACpC,WAAW,cAAc;;;;;;;;;;;;;;;;;yEAKhC,6LAAC;gBAAI,WAAU;;oBACZ,sBACC,6LAAC;wBAAI,WAAU;kCAAuB;;;;;iFAEtC,6LAAC;wBAAI,WAAU;kCAA+B;;;;;;kCAIhD,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,+IAAM;4BACL,SAAQ;4BACR,MAAK;4BACL,SAAS,IAAM,aAAa;;8CAE5B,6LAAC,6MAAI;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASjD;GApEM;KAAA;uCAsES"}},
    {"offset": {"line": 6373, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/SMSNoticeDialog.tsx"],"sourcesContent":["\r\nimport React, { useState } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { MessageSquare, X } from 'lucide-react';\r\nimport { Customer, Sale } from '@/types';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { openSMSApp, formatMessageForSMS } from '@/utils/smsUtils';\r\nimport { getTemplateById } from '@/utils/noticeTemplates';\r\n\r\ninterface SMSNoticeDialogProps {\r\n  customer: Customer | { fullName: string; phoneNumber: string | null };\r\n  sale?: Sale;\r\n  open: boolean;\r\n  onClose: () => void;\r\n  templateId?: string;\r\n}\r\n\r\nconst SMSNoticeDialog: React.FC<SMSNoticeDialogProps> = ({\r\n  customer,\r\n  sale,\r\n  open,\r\n  onClose,\r\n  templateId = 'thank_you'\r\n}) => {\r\n  const [message, setMessage] = useState<string>('');\r\n  const { settings } = useBusinessSettings();\r\n  const { toast } = useToast();\r\n\r\n  React.useEffect(() => {\r\n    if (open && templateId) {\r\n      const template = getTemplateById(templateId);\r\n      if (template) {\r\n        let content = template.content;\r\n        \r\n        // Add sale-specific information if available\r\n        if (sale && templateId === 'payment_reminder') {\r\n          const saleTotal = sale.items.reduce((total, item) => total + (item.price * item.quantity), 0);\r\n          content = `${content}\\n\\nSale Details:\\nReceipt: ${sale.receiptNumber}\\nAmount: ${settings.currency} ${saleTotal.toFixed(2)}`;\r\n        }\r\n        \r\n        setMessage(content);\r\n      }\r\n    }\r\n  }, [open, templateId, sale, settings.currency]);\r\n\r\n  const handleSendSMS = () => {\r\n    if (!message.trim()) {\r\n      toast({\r\n        title: \"Message required\",\r\n        description: \"Please enter a message before sending SMS.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const fullMessage = `Dear ${customer.fullName},\\n\\n${message}\\n\\nYours faithfully,\\n${settings.businessName || 'Management'}`;\r\n      const formattedMessage = formatMessageForSMS(fullMessage, settings.businessName);\r\n      \r\n      openSMSApp({\r\n        phoneNumber: customer.phoneNumber!,\r\n        message: formattedMessage\r\n      });\r\n\r\n      toast({\r\n        title: \"SMS app opened\",\r\n        description: \"Your message has been prepared in the SMS app.\",\r\n      });\r\n\r\n      onClose();\r\n    } catch (error) {\r\n      console.error('Error sending SMS:', error);\r\n      toast({\r\n        title: \"SMS failed\",\r\n        description: \"Failed to open SMS app. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onClose}>\r\n      <DialogContent className=\"max-w-md\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <MessageSquare className=\"h-5 w-5\" />\r\n            Send SMS to {customer.fullName}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4\">\r\n          <div className=\"space-y-2\">\r\n            <label className=\"text-sm font-medium text-gray-700\">Message</label>\r\n            <Textarea\r\n              value={message}\r\n              onChange={(e) => setMessage(e.target.value)}\r\n              placeholder=\"Enter your message...\"\r\n              rows={6}\r\n              className=\"resize-none\"\r\n            />\r\n            <p className=\"text-xs text-gray-500\">\r\n              Message will be formatted for SMS with greeting and signature.\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex justify-end gap-3 pt-4 border-t\">\r\n          <Button variant=\"outline\" onClick={onClose}>\r\n            Cancel\r\n          </Button>\r\n          <Button \r\n            onClick={handleSendSMS}\r\n            disabled={!message.trim()}\r\n            className=\"gap-2\"\r\n          >\r\n            <MessageSquare className=\"h-4 w-4\" />\r\n            Send SMS\r\n          </Button>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default SMSNoticeDialog;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;;;;;;;;;;;AAUA,MAAM,kBAAkD,CAAC,EACvD,QAAQ,EACR,IAAI,EACJ,IAAI,EACJ,OAAO,EACP,aAAa,WAAW,EACzB;;IACC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAS;IAC/C,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,6JAAmB;IACxC,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,2IAAQ;IAE1B,wKAAK,CAAC,SAAS;qCAAC;YACd,IAAI,QAAQ,YAAY;gBACtB,MAAM,WAAW,IAAA,qJAAe,EAAC;gBACjC,IAAI,UAAU;oBACZ,IAAI,UAAU,SAAS,OAAO;oBAE9B,6CAA6C;oBAC7C,IAAI,QAAQ,eAAe,oBAAoB;wBAC7C,MAAM,YAAY,KAAK,KAAK,CAAC,MAAM;mEAAC,CAAC,OAAO,OAAS,QAAS,KAAK,KAAK,GAAG,KAAK,QAAQ;kEAAG;wBAC3F,UAAU,GAAG,QAAQ,4BAA4B,EAAE,KAAK,aAAa,CAAC,UAAU,EAAE,SAAS,QAAQ,CAAC,CAAC,EAAE,UAAU,OAAO,CAAC,IAAI;oBAC/H;oBAEA,WAAW;gBACb;YACF;QACF;oCAAG;QAAC;QAAM;QAAY;QAAM,SAAS,QAAQ;KAAC;IAE9C,MAAM,gBAAgB;QACpB,IAAI,CAAC,QAAQ,IAAI,IAAI;YACnB,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;YACA;QACF;QAEA,IAAI;YACF,MAAM,cAAc,CAAC,KAAK,EAAE,SAAS,QAAQ,CAAC,KAAK,EAAE,QAAQ,uBAAuB,EAAE,SAAS,YAAY,IAAI,cAAc;YAC7H,MAAM,mBAAmB,IAAA,kJAAmB,EAAC,aAAa,SAAS,YAAY;YAE/E,IAAA,yIAAU,EAAC;gBACT,aAAa,SAAS,WAAW;gBACjC,SAAS;YACX;YAEA,MAAM;gBACJ,OAAO;gBACP,aAAa;YACf;YAEA;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sBAAsB;YACpC,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF;IACF;IAEA,qBACE,6LAAC,+IAAM;QAAC,MAAM;QAAM,cAAc;kBAChC,cAAA,6LAAC,sJAAa;YAAC,WAAU;;8BACvB,6LAAC,qJAAY;8BACX,cAAA,6LAAC,oJAAW;wBAAC,WAAU;;0CACrB,6LAAC,4OAAa;gCAAC,WAAU;;;;;;4BAAY;4BACxB,SAAS,QAAQ;;;;;;;;;;;;8BAIlC,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAM,WAAU;0CAAoC;;;;;;0CACrD,6LAAC,mJAAQ;gCACP,OAAO;gCACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;gCAC1C,aAAY;gCACZ,MAAM;gCACN,WAAU;;;;;;0CAEZ,6LAAC;gCAAE,WAAU;0CAAwB;;;;;;;;;;;;;;;;;8BAMzC,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,+IAAM;4BAAC,SAAQ;4BAAU,SAAS;sCAAS;;;;;;sCAG5C,6LAAC,+IAAM;4BACL,SAAS;4BACT,UAAU,CAAC,QAAQ,IAAI;4BACvB,WAAU;;8CAEV,6LAAC,4OAAa;oCAAC,WAAU;;;;;;gCAAY;;;;;;;;;;;;;;;;;;;;;;;;AAOjD;GAzGM;;QAQiB,6JAAmB;QACtB,2IAAQ;;;KATtB;uCA2GS"}},
    {"offset": {"line": 6595, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/PaymentReminderPreviewDialog.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from '@/components/ui/dialog';\r\nimport { Drawer, DrawerContent, DrawerHeader, DrawerTitle, DrawerFooter, DrawerClose } from '@/components/ui/drawer';\r\nimport { Button } from '@/components/ui/button';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { Download, Printer, Share2, X, Loader2, MessageCircle } from 'lucide-react';\r\nimport { Sale, Customer, BusinessSettings } from '@/types';\r\nimport { generatePaymentReminderPDF } from '@/utils/generatePaymentReminderPDF';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { openWhatsApp } from '@/utils/smsUtils';\r\n\r\ninterface PaymentReminderPreviewDialogProps {\r\n    isOpen: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    sale: Sale | null;\r\n    customer?: Customer | null;\r\n    unpaidSales?: Sale[];\r\n}\r\n\r\nconst PaymentReminderPreviewDialog: React.FC<PaymentReminderPreviewDialogProps> = ({\r\n    isOpen,\r\n    onOpenChange,\r\n    sale,\r\n    customer,\r\n    unpaidSales\r\n}) => {\r\n    const isMobile = useIsMobile();\r\n    const { settings, isLoading: settingsLoading } = useBusinessSettings();\r\n    const { toast } = useToast();\r\n    const [pdfUrl, setPdfUrl] = useState<string | null>(null);\r\n    const [pdfBlob, setPdfBlob] = useState<Blob | null>(null);\r\n    const [isGenerating, setIsGenerating] = useState(false);\r\n\r\n    // Prepare customer and sales data\r\n    const targetCustomer: Customer | null = customer || (sale ? {\r\n        id: 'placeholder',\r\n        fullName: sale.customerName,\r\n        phoneNumber: sale.customerContact,\r\n        email: null,\r\n        location: sale.customerAddress,\r\n        createdAt: new Date(),\r\n        updatedAt: new Date(),\r\n        loyaltyPoints: 0,\r\n        totalSpent: 0,\r\n        lastVisit: null,\r\n        categoryId: null,\r\n        birthday: null,\r\n        socialMedia: null,\r\n        gender: null,\r\n        tags: null,\r\n        notes: null\r\n    } as Customer : null);\r\n\r\n    const targetSales = unpaidSales || (sale ? [sale] : []);\r\n\r\n    // Calculate total amount due\r\n    const totalAmountDue = targetSales.reduce((sum, s) => {\r\n        const subtotal = s.items.reduce((itemSum, item) => itemSum + (item.price * item.quantity), 0);\r\n        const taxAmount = subtotal * ((s.taxRate || 0) / 100);\r\n        return sum + subtotal + taxAmount;\r\n    }, 0);\r\n\r\n    useEffect(() => {\r\n        if (isOpen && targetCustomer && targetSales.length > 0 && settings) {\r\n            generatePreview();\r\n        } else if (!isOpen) {\r\n            if (pdfUrl) {\r\n                URL.revokeObjectURL(pdfUrl);\r\n                setPdfUrl(null);\r\n            }\r\n        }\r\n    }, [isOpen, settings]);\r\n\r\n    const generatePreview = async () => {\r\n        if (!targetCustomer || targetSales.length === 0 || !settings) return;\r\n\r\n        setIsGenerating(true);\r\n        try {\r\n            const blob = await generatePaymentReminderPDF(\r\n                targetCustomer,\r\n                targetSales,\r\n                totalAmountDue,\r\n                settings,\r\n                undefined,\r\n                'blob'\r\n            ) as Blob;\r\n\r\n            const url = URL.createObjectURL(blob);\r\n            setPdfUrl(url);\r\n            setPdfBlob(blob);\r\n        } catch (error) {\r\n            console.error('Error generating preview:', error);\r\n            toast({\r\n                title: \"Error\",\r\n                description: \"Failed to generate PDF preview.\",\r\n                variant: \"destructive\"\r\n            });\r\n        } finally {\r\n            setIsGenerating(false);\r\n        }\r\n    };\r\n\r\n    const handleDownload = async () => {\r\n        if (!targetCustomer || targetSales.length === 0 || !settings) return;\r\n        try {\r\n            await generatePaymentReminderPDF(\r\n                targetCustomer,\r\n                targetSales,\r\n                totalAmountDue,\r\n                settings,\r\n                undefined,\r\n                'save'\r\n            );\r\n        } catch (error) {\r\n            toast({\r\n                title: \"Error\",\r\n                description: \"Failed to download PDF.\",\r\n                variant: \"destructive\"\r\n            });\r\n        }\r\n    };\r\n\r\n    const handlePrint = () => {\r\n        if (pdfUrl) {\r\n            const printWindow = window.open(pdfUrl);\r\n            if (printWindow) {\r\n                printWindow.addEventListener('load', () => {\r\n                    printWindow.print();\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleShare = async () => {\r\n        const fileName = `Payment_Reminder_${targetCustomer?.fullName.replace(/\\s+/g, '_') || 'Customer'}.pdf`;\r\n        const message = `Hello ${targetCustomer?.fullName || 'Customer'}, this is a payment reminder from ${settings?.businessName || 'our business'} regarding your outstanding balance of ${settings?.currency || ''} ${totalAmountDue.toLocaleString()}.`;\r\n\r\n        if (navigator.share && pdfBlob) {\r\n            try {\r\n                const file = new File([pdfBlob], fileName, { type: 'application/pdf' });\r\n\r\n                // Check if sharing files is supported\r\n                if (navigator.canShare && navigator.canShare({ files: [file] })) {\r\n                    await navigator.share({\r\n                        files: [file],\r\n                        title: 'Payment Reminder',\r\n                        text: message,\r\n                    });\r\n                    return; // Success\r\n                }\r\n\r\n                // If can't share files, try sharing just text\r\n                await navigator.share({\r\n                    title: 'Payment Reminder',\r\n                    text: message,\r\n                });\r\n            } catch (error) {\r\n                if ((error as Error).name !== 'AbortError') {\r\n                    console.error('Error sharing:', error);\r\n                }\r\n            }\r\n        } else if (navigator.share) {\r\n            // No blob yet, just share text\r\n            try {\r\n                await navigator.share({\r\n                    title: 'Payment Reminder',\r\n                    text: message,\r\n                });\r\n            } catch (error) {\r\n                if ((error as Error).name !== 'AbortError') {\r\n                    console.error('Error sharing:', error);\r\n                }\r\n            }\r\n        } else {\r\n            // Fallback: copy to clipboard\r\n            try {\r\n                await navigator.clipboard.writeText(message);\r\n                toast({\r\n                    title: \"Copied to clipboard\",\r\n                    description: \"Payment reminder summary copied to clipboard.\",\r\n                });\r\n            } catch (err) {\r\n                toast({\r\n                    title: \"Share failed\",\r\n                    description: \"Could not share or copy the message.\",\r\n                    variant: \"destructive\"\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    const Content = () => (\r\n        <div className=\"flex flex-col h-full space-y-4\">\r\n            <div className=\"flex flex-wrap gap-2 justify-center py-2 order-first\">\r\n                <Button\r\n                    variant=\"outline\"\r\n                    onClick={handleShare}\r\n                    className=\"flex-1 min-w-[120px] bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100\"\r\n                >\r\n                    <Share2 className=\"h-4 w-4 mr-2 text-blue-600\" />\r\n                    Share\r\n                </Button>\r\n                <Button\r\n                    variant=\"outline\"\r\n                    onClick={handlePrint}\r\n                    className=\"flex-1 min-w-[120px]\"\r\n                    disabled={!pdfUrl}\r\n                >\r\n                    <Printer className=\"h-4 w-4 mr-2\" />\r\n                    Print\r\n                </Button>\r\n                <Button\r\n                    onClick={handleDownload}\r\n                    className=\"flex-1 min-w-[120px] bg-orange-500 hover:bg-orange-600\"\r\n                >\r\n                    <Download className=\"h-4 w-4 mr-2\" />\r\n                    Download\r\n                </Button>\r\n            </div>\r\n\r\n            <div className=\"flex-1 bg-gray-100 rounded-lg overflow-hidden min-h-[600px] relative\">\r\n                {isGenerating ? (\r\n                    <div className=\"absolute inset-0 flex flex-col items-center justify-center space-y-4 bg-white/50 backdrop-blur-sm\">\r\n                        <Loader2 className=\"h-8 w-8 animate-spin text-orange-500\" />\r\n                        <p className=\"text-sm font-medium text-gray-600\">Generating preview...</p>\r\n                    </div>\r\n                ) : pdfUrl ? (\r\n                    <iframe\r\n                        src={pdfUrl}\r\n                        className=\"w-full h-full min-h-[600px] border-none\"\r\n                        title=\"Payment Reminder Preview\"\r\n                    />\r\n                ) : (\r\n                    <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                        <p className=\"text-sm text-gray-500\">Preview not available.</p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    if (isMobile) {\r\n        return (\r\n            <Drawer open={isOpen} onOpenChange={onOpenChange}>\r\n                <DrawerContent className=\"max-h-[95vh]\">\r\n                    <DrawerHeader className=\"border-b pb-2\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <DrawerTitle>Payment Reminder Preview</DrawerTitle>\r\n                            <DrawerClose asChild>\r\n                                <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\">\r\n                                    <X className=\"h-4 w-4\" />\r\n                                </Button>\r\n                            </DrawerClose>\r\n                        </div>\r\n                    </DrawerHeader>\r\n                    <div className=\"px-4 py-4 overflow-y-auto\">\r\n                        <Content />\r\n                    </div>\r\n                    <DrawerFooter className=\"pt-2 border-t\">\r\n                        <Button variant=\"outline\" onClick={() => onOpenChange(false)}>Close</Button>\r\n                    </DrawerFooter>\r\n                </DrawerContent>\r\n            </Drawer>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <Dialog open={isOpen} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"max-w-4xl max-h-[90vh] flex flex-col p-0 overflow-hidden\">\r\n                <DialogHeader className=\"px-6 py-4 border-b\">\r\n                    <DialogTitle>Payment Reminder Preview</DialogTitle>\r\n                </DialogHeader>\r\n                <div className=\"flex-1 overflow-y-auto p-6 bg-gray-50/50\">\r\n                    <Content />\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n};\r\n\r\nexport default PaymentReminderPreviewDialog;\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;;;;;;;;;;;;AAWA,MAAM,+BAA4E,CAAC,EAC/E,MAAM,EACN,YAAY,EACZ,IAAI,EACJ,QAAQ,EACR,WAAW,EACd;;IACG,MAAM,WAAW,IAAA,gJAAW;IAC5B,MAAM,EAAE,QAAQ,EAAE,WAAW,eAAe,EAAE,GAAG,IAAA,6JAAmB;IACpE,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,2IAAQ;IAC1B,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAgB;IACpD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAc;IACpD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IAEjD,kCAAkC;IAClC,MAAM,iBAAkC,YAAY,CAAC,OAAO;QACxD,IAAI;QACJ,UAAU,KAAK,YAAY;QAC3B,aAAa,KAAK,eAAe;QACjC,OAAO;QACP,UAAU,KAAK,eAAe;QAC9B,WAAW,IAAI;QACf,WAAW,IAAI;QACf,eAAe;QACf,YAAY;QACZ,WAAW;QACX,YAAY;QACZ,UAAU;QACV,aAAa;QACb,QAAQ;QACR,MAAM;QACN,OAAO;IACX,IAAgB,IAAI;IAEpB,MAAM,cAAc,eAAe,CAAC,OAAO;QAAC;KAAK,GAAG,EAAE;IAEtD,6BAA6B;IAC7B,MAAM,iBAAiB,YAAY,MAAM,CAAC,CAAC,KAAK;QAC5C,MAAM,WAAW,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,SAAS,OAAS,UAAW,KAAK,KAAK,GAAG,KAAK,QAAQ,EAAG;QAC3F,MAAM,YAAY,WAAW,CAAC,CAAC,EAAE,OAAO,IAAI,CAAC,IAAI,GAAG;QACpD,OAAO,MAAM,WAAW;IAC5B,GAAG;IAEH,IAAA,0KAAS;kDAAC;YACN,IAAI,UAAU,kBAAkB,YAAY,MAAM,GAAG,KAAK,UAAU;gBAChE;YACJ,OAAO,IAAI,CAAC,QAAQ;gBAChB,IAAI,QAAQ;oBACR,IAAI,eAAe,CAAC;oBACpB,UAAU;gBACd;YACJ;QACJ;iDAAG;QAAC;QAAQ;KAAS;IAErB,MAAM,kBAAkB;QACpB,IAAI,CAAC,kBAAkB,YAAY,MAAM,KAAK,KAAK,CAAC,UAAU;QAE9D,gBAAgB;QAChB,IAAI;YACA,MAAM,OAAO,MAAM,IAAA,2KAA0B,EACzC,gBACA,aACA,gBACA,UACA,WACA;YAGJ,MAAM,MAAM,IAAI,eAAe,CAAC;YAChC,UAAU;YACV,WAAW;QACf,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,MAAM;gBACF,OAAO;gBACP,aAAa;gBACb,SAAS;YACb;QACJ,SAAU;YACN,gBAAgB;QACpB;IACJ;IAEA,MAAM,iBAAiB;QACnB,IAAI,CAAC,kBAAkB,YAAY,MAAM,KAAK,KAAK,CAAC,UAAU;QAC9D,IAAI;YACA,MAAM,IAAA,2KAA0B,EAC5B,gBACA,aACA,gBACA,UACA,WACA;QAER,EAAE,OAAO,OAAO;YACZ,MAAM;gBACF,OAAO;gBACP,aAAa;gBACb,SAAS;YACb;QACJ;IACJ;IAEA,MAAM,cAAc;QAChB,IAAI,QAAQ;YACR,MAAM,cAAc,OAAO,IAAI,CAAC;YAChC,IAAI,aAAa;gBACb,YAAY,gBAAgB,CAAC,QAAQ;oBACjC,YAAY,KAAK;gBACrB;YACJ;QACJ;IACJ;IAEA,MAAM,cAAc;QAChB,MAAM,WAAW,CAAC,iBAAiB,EAAE,gBAAgB,SAAS,QAAQ,QAAQ,QAAQ,WAAW,IAAI,CAAC;QACtG,MAAM,UAAU,CAAC,MAAM,EAAE,gBAAgB,YAAY,WAAW,kCAAkC,EAAE,UAAU,gBAAgB,eAAe,uCAAuC,EAAE,UAAU,YAAY,GAAG,CAAC,EAAE,eAAe,cAAc,GAAG,CAAC,CAAC;QAEpP,IAAI,UAAU,KAAK,IAAI,SAAS;YAC5B,IAAI;gBACA,MAAM,OAAO,IAAI,KAAK;oBAAC;iBAAQ,EAAE,UAAU;oBAAE,MAAM;gBAAkB;gBAErE,sCAAsC;gBACtC,IAAI,UAAU,QAAQ,IAAI,UAAU,QAAQ,CAAC;oBAAE,OAAO;wBAAC;qBAAK;gBAAC,IAAI;oBAC7D,MAAM,UAAU,KAAK,CAAC;wBAClB,OAAO;4BAAC;yBAAK;wBACb,OAAO;wBACP,MAAM;oBACV;oBACA,QAAQ,UAAU;gBACtB;gBAEA,8CAA8C;gBAC9C,MAAM,UAAU,KAAK,CAAC;oBAClB,OAAO;oBACP,MAAM;gBACV;YACJ,EAAE,OAAO,OAAO;gBACZ,IAAI,AAAC,MAAgB,IAAI,KAAK,cAAc;oBACxC,QAAQ,KAAK,CAAC,kBAAkB;gBACpC;YACJ;QACJ,OAAO,IAAI,UAAU,KAAK,EAAE;YACxB,+BAA+B;YAC/B,IAAI;gBACA,MAAM,UAAU,KAAK,CAAC;oBAClB,OAAO;oBACP,MAAM;gBACV;YACJ,EAAE,OAAO,OAAO;gBACZ,IAAI,AAAC,MAAgB,IAAI,KAAK,cAAc;oBACxC,QAAQ,KAAK,CAAC,kBAAkB;gBACpC;YACJ;QACJ,OAAO;YACH,8BAA8B;YAC9B,IAAI;gBACA,MAAM,UAAU,SAAS,CAAC,SAAS,CAAC;gBACpC,MAAM;oBACF,OAAO;oBACP,aAAa;gBACjB;YACJ,EAAE,OAAO,KAAK;gBACV,MAAM;oBACF,OAAO;oBACP,aAAa;oBACb,SAAS;gBACb;YACJ;QACJ;IACJ;IAEA,MAAM,UAAU,kBACZ,6LAAC;YAAI,WAAU;;8BACX,6LAAC;oBAAI,WAAU;;sCACX,6LAAC,+IAAM;4BACH,SAAQ;4BACR,SAAS;4BACT,WAAU;;8CAEV,6LAAC,uNAAM;oCAAC,WAAU;;;;;;gCAA+B;;;;;;;sCAGrD,6LAAC,+IAAM;4BACH,SAAQ;4BACR,SAAS;4BACT,WAAU;4BACV,UAAU,CAAC;;8CAEX,6LAAC,sNAAO;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;sCAGxC,6LAAC,+IAAM;4BACH,SAAS;4BACT,WAAU;;8CAEV,6LAAC,yNAAQ;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;;;;;;;8BAK7C,6LAAC;oBAAI,WAAU;8BACV,6BACG,6LAAC;wBAAI,WAAU;;0CACX,6LAAC,+NAAO;gCAAC,WAAU;;;;;;0CACnB,6LAAC;gCAAE,WAAU;0CAAoC;;;;;;;;;;;mEAErD,uBACA,6LAAC;wBACG,KAAK;wBACL,WAAU;wBACV,OAAM;;;;;iFAGV,6LAAC;wBAAI,WAAU;kCACX,cAAA,6LAAC;4BAAE,WAAU;sCAAwB;;;;;;;;;;;;;;;;;;;;;;IAOzD,IAAI,UAAU;QACV,qBACI,6LAAC,+IAAM;YAAC,MAAM;YAAQ,cAAc;sBAChC,cAAA,6LAAC,sJAAa;gBAAC,WAAU;;kCACrB,6LAAC,qJAAY;wBAAC,WAAU;kCACpB,cAAA,6LAAC;4BAAI,WAAU;;8CACX,6LAAC,oJAAW;8CAAC;;;;;;8CACb,6LAAC,oJAAW;oCAAC,OAAO;8CAChB,cAAA,6LAAC,+IAAM;wCAAC,SAAQ;wCAAQ,MAAK;wCAAK,WAAU;kDACxC,cAAA,6LAAC,oMAAC;4CAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAK7B,6LAAC;wBAAI,WAAU;kCACX,cAAA,6LAAC;;;;;;;;;;kCAEL,6LAAC,qJAAY;wBAAC,WAAU;kCACpB,cAAA,6LAAC,+IAAM;4BAAC,SAAQ;4BAAU,SAAS,IAAM,aAAa;sCAAQ;;;;;;;;;;;;;;;;;;;;;;IAKlF;IAEA,qBACI,6LAAC,+IAAM;QAAC,MAAM;QAAQ,cAAc;kBAChC,cAAA,6LAAC,sJAAa;YAAC,WAAU;;8BACrB,6LAAC,qJAAY;oBAAC,WAAU;8BACpB,cAAA,6LAAC,oJAAW;kCAAC;;;;;;;;;;;8BAEjB,6LAAC;oBAAI,WAAU;8BACX,cAAA,6LAAC;;;;;;;;;;;;;;;;;;;;;AAKrB;GAnQM;;QAOe,gJAAW;QACqB,6JAAmB;QAClD,2IAAQ;;;KATxB;uCAqQS"}},
    {"offset": {"line": 7063, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/PaymentReminderNotice.tsx"],"sourcesContent":["\r\nimport React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Label } from '@/components/ui/label';\r\nimport { AlertTriangle, Download, Link, Share, Edit3, ChevronDown, ChevronUp } from 'lucide-react';\r\nimport { Customer } from '@/types';\r\nimport { Sale } from '@/types';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport { format } from 'date-fns';\r\nimport { generatePaymentReminderPDF } from '@/utils/generatePaymentReminderPDF';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport PaymentReminderPreviewDialog from './PaymentReminderPreviewDialog';\r\n\r\ninterface PaymentReminderNoticeProps {\r\n  customer: Customer;\r\n  unpaidSales: Sale[];\r\n  totalAmountDue: number;\r\n}\r\n\r\nconst PaymentReminderNotice: React.FC<PaymentReminderNoticeProps> = ({\r\n  customer,\r\n  unpaidSales,\r\n  totalAmountDue\r\n}) => {\r\n  const { settings } = useBusinessSettings();\r\n  const { toast } = useToast();\r\n  const isMobile = useIsMobile();\r\n  const [isEditingMessage, setIsEditingMessage] = useState(false);\r\n  const [isExpanded, setIsExpanded] = useState(false);\r\n  const [customMessage, setCustomMessage] = useState(\r\n    'Our records show that you have pending payments for the following items purchased on credit. We kindly request you to complete payment at your earliest convenience.\\n\\nPlease reach out to us if you need any assistance or clarification.'\r\n  );\r\n  const [isPreviewOpen, setIsPreviewOpen] = useState(false);\r\n\r\n  const formatCurrency = (value: number) => {\r\n    return `${settings.currency} ${formatNumber(value)}`;\r\n  };\r\n\r\n  const handleDownloadPDF = async () => {\r\n    setIsPreviewOpen(true);\r\n  };\r\n\r\n  const handleCopyLink = () => {\r\n    // Create outstanding items breakdown\r\n    const itemsBreakdown = unpaidItems.map(item =>\r\n      `${item.receiptNumber} - ${item.description} (Qty: ${item.quantity}) - ${formatCurrency(item.total)}`\r\n    ).join('\\n');\r\n\r\n    const reminderText = `Payment Reminder for ${customer.fullName}\r\n\r\nDear ${customer.fullName},\r\n\r\n${customMessage}\r\n\r\nOutstanding Items:\r\n${itemsBreakdown}\r\n\r\nTotal Outstanding Balance: ${formatCurrency(totalAmountDue)}\r\n\r\nThank you for your continued support.\r\n\r\n${settings.businessName}`;\r\n\r\n    navigator.clipboard.writeText(reminderText);\r\n    toast({\r\n      title: \"Copied\",\r\n      description: \"Payment reminder text with items copied to clipboard\"\r\n    });\r\n  };\r\n\r\n  const handleShare = async () => {\r\n    try {\r\n      // Generate the PDF blob first\r\n      const blob = await generatePaymentReminderPDF(\r\n        customer,\r\n        unpaidSales,\r\n        totalAmountDue,\r\n        settings,\r\n        customMessage,\r\n        'blob'\r\n      ) as Blob;\r\n\r\n      const fileName = `Payment_Reminder_${customer.fullName.replace(/\\s+/g, '_')}.pdf`;\r\n      const reminderText = `Payment Reminder for ${customer.fullName}. Please find the attached document for details.`;\r\n\r\n      if (navigator.share) {\r\n        const file = new File([blob], fileName, { type: 'application/pdf' });\r\n\r\n        if (navigator.canShare && navigator.canShare({ files: [file] })) {\r\n          await navigator.share({\r\n            files: [file],\r\n            title: 'Payment Reminder',\r\n            text: reminderText,\r\n          });\r\n          return;\r\n        }\r\n\r\n        // Fallback to text share if files not supported\r\n        await navigator.share({\r\n          title: 'Payment Reminder',\r\n          text: reminderText,\r\n        });\r\n      } else {\r\n        // Fallback: copy a summary text to clipboard\r\n        const itemsSummary = unpaidItems.map(item =>\r\n          `${item.receiptNumber}: ${formatCurrency(item.total)}`\r\n        ).join(', ');\r\n        const summary = `Payment Reminder for ${customer.fullName}. Total: ${formatCurrency(totalAmountDue)}. Items: ${itemsSummary}`;\r\n\r\n        await navigator.clipboard.writeText(summary);\r\n        toast({\r\n          title: \"Copied to clipboard\",\r\n          description: \"Summary copied as file sharing is not supported.\",\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error sharing PDF:', error);\r\n      toast({\r\n        title: \"Share failed\",\r\n        description: \"Failed to generate or share the PDF.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  // Calculate unpaid items from all unpaid sales\r\n  const unpaidItems = unpaidSales.flatMap(sale =>\r\n    sale.items.map(item => ({\r\n      ...item,\r\n      saleId: sale.id,\r\n      receiptNumber: sale.receiptNumber,\r\n      saleDate: sale.date,\r\n      total: item.price * item.quantity\r\n    }))\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <Card className=\"border-orange-200 bg-orange-50\">\r\n        <CardHeader className={`${isMobile ? 'pb-3 px-4 pt-4' : 'pb-4'}`}>\r\n          <div className={`flex ${isMobile ? 'flex-col gap-3' : 'items-center justify-between'}`}>\r\n            <div className=\"flex items-center gap-2\">\r\n              <AlertTriangle className={`${isMobile ? 'h-4 w-4' : 'h-5 w-5'} text-orange-600`} />\r\n              <CardTitle className={`text-orange-800 ${isMobile ? 'text-lg' : 'text-xl'}`}>\r\n                Payment Reminder Notice\r\n              </CardTitle>\r\n              <div className=\"ml-2 px-2 py-1 bg-orange-200 rounded-md\">\r\n                <span className={`text-orange-800 font-semibold ${isMobile ? 'text-xs' : 'text-sm'}`}>\r\n                  {formatCurrency(totalAmountDue)}\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <div className={`flex ${isMobile ? 'flex-wrap' : ''} gap-2`}>\r\n              <Button\r\n                variant=\"outline\"\r\n                size={isMobile ? \"sm\" : \"sm\"}\r\n                onClick={handleDownloadPDF}\r\n                className={isMobile ? \"flex-1 min-w-[140px]\" : \"\"}\r\n              >\r\n                <Download className=\"h-4 w-4 mr-1\" />\r\n                {isMobile ? \"PDF\" : \"Download PDF\"}\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                size={isMobile ? \"sm\" : \"sm\"}\r\n                onClick={handleCopyLink}\r\n                className={isMobile ? \"flex-1 min-w-[120px]\" : \"\"}\r\n              >\r\n                <Link className=\"h-4 w-4 mr-1\" />\r\n                {isMobile ? \"Copy\" : \"Copy Text\"}\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                size={isMobile ? \"sm\" : \"sm\"}\r\n                onClick={handleShare}\r\n                className={isMobile ? \"flex-1 min-w-[140px]\" : \"bg-blue-50 border-blue-200 text-blue-700 hover:bg-blue-100\"}\r\n              >\r\n                <Share className=\"h-4 w-4 mr-1 text-blue-600\" />\r\n                Share\r\n              </Button>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size={isMobile ? \"sm\" : \"sm\"}\r\n                onClick={() => setIsExpanded(!isExpanded)}\r\n                className={`${isMobile ? \"flex-1 min-w-[120px]\" : \"\"} text-orange-700 hover:bg-orange-100`}\r\n              >\r\n                {isExpanded ? (\r\n                  <>\r\n                    <ChevronUp className=\"h-4 w-4 mr-1\" />\r\n                    Hide Details\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <ChevronDown className=\"h-4 w-4 mr-1\" />\r\n                    View Details\r\n                  </>\r\n                )}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n\r\n        {isExpanded && (\r\n          <CardContent className={isMobile ? \"px-4 pb-4\" : \"\"}>\r\n            <div className=\"space-y-4\">\r\n              <div className={`bg-white ${isMobile ? 'p-3' : 'p-4'} rounded-lg border`}>\r\n                <p className={`${isMobile ? 'text-sm' : 'text-sm'} text-gray-600 mb-3`}>\r\n                  <strong>Dear {customer.fullName},</strong>\r\n                </p>\r\n\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <Label htmlFor=\"reminder-message\" className={`${isMobile ? 'text-sm' : 'text-sm'} font-medium text-gray-700`}>\r\n                      Reminder Message\r\n                    </Label>\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      onClick={() => setIsEditingMessage(!isEditingMessage)}\r\n                      className={`${isMobile ? 'h-7 px-2 text-xs' : 'h-8 px-3'}`}\r\n                    >\r\n                      <Edit3 className={`${isMobile ? 'h-3 w-3 mr-1' : 'h-3 w-3 mr-1'}`} />\r\n                      {isEditingMessage ? 'Save' : 'Edit'}\r\n                    </Button>\r\n                  </div>\r\n\r\n                  {isEditingMessage ? (\r\n                    <Textarea\r\n                      id=\"reminder-message\"\r\n                      value={customMessage}\r\n                      onChange={(e) => setCustomMessage(e.target.value)}\r\n                      className={`${isMobile ? 'min-h-[120px] text-sm' : 'min-h-[100px] text-sm'}`}\r\n                      placeholder=\"Enter your custom reminder message...\"\r\n                    />\r\n                  ) : (\r\n                    <div className={`${isMobile ? 'text-sm' : 'text-sm'} text-gray-600 whitespace-pre-line bg-gray-50 ${isMobile ? 'p-3' : 'p-3'} rounded border`}>\r\n                      {customMessage}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"bg-white rounded-lg border overflow-hidden\">\r\n                {isMobile ? (\r\n                  // Mobile: Stack layout for better readability\r\n                  <div className=\"divide-y divide-gray-200\">\r\n                    <div className=\"bg-orange-100 px-3 py-2\">\r\n                      <h3 className=\"font-semibold text-orange-800 text-sm\">Outstanding Items</h3>\r\n                    </div>\r\n                    {unpaidItems.map((item, index) => (\r\n                      <div key={`${item.saleId}-${index}`} className=\"p-3 space-y-2\">\r\n                        <div className=\"flex justify-between items-start\">\r\n                          <div className=\"flex-1\">\r\n                            <p className=\"font-medium text-sm text-gray-900\">{item.description}</p>\r\n                            <p className=\"text-xs text-gray-500\">Invoice: {item.receiptNumber}</p>\r\n                            <p className=\"text-xs text-gray-500\">{format(item.saleDate, 'MMM d, yyyy')}</p>\r\n                          </div>\r\n                          <div className=\"text-right\">\r\n                            <p className=\"font-semibold text-sm\">{formatCurrency(item.total)}</p>\r\n                            <p className=\"text-xs text-gray-500\">{item.quantity} Ã— {formatCurrency(item.price)}</p>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                    <div className=\"bg-orange-50 px-3 py-3 border-t-2 border-orange-200\">\r\n                      <div className=\"flex justify-between items-center\">\r\n                        <span className=\"font-semibold text-orange-800 text-sm\">Total Outstanding:</span>\r\n                        <span className=\"font-bold text-orange-800 text-lg\">{formatCurrency(totalAmountDue)}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  // Desktop: Table layout\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Invoice #</TableHead>\r\n                        <TableHead>Product Name</TableHead>\r\n                        <TableHead>Qty</TableHead>\r\n                        <TableHead>Price</TableHead>\r\n                        <TableHead>Total</TableHead>\r\n                        <TableHead>Sale Date</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {unpaidItems.map((item, index) => (\r\n                        <TableRow key={`${item.saleId}-${index}`}>\r\n                          <TableCell className=\"font-medium\">{item.receiptNumber}</TableCell>\r\n                          <TableCell>{item.description}</TableCell>\r\n                          <TableCell>{item.quantity}</TableCell>\r\n                          <TableCell>{formatCurrency(item.price)}</TableCell>\r\n                          <TableCell>{formatCurrency(item.total)}</TableCell>\r\n                          <TableCell>{format(item.saleDate, 'MMM d, yyyy')}</TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                      <TableRow className=\"bg-orange-50 border-t-2 border-orange-200\">\r\n                        <TableCell colSpan={4} className=\"font-semibold text-orange-800\">\r\n                          Total Outstanding Balance:\r\n                        </TableCell>\r\n                        <TableCell colSpan={2} className=\"font-bold text-orange-800 text-lg\">\r\n                          {formatCurrency(totalAmountDue)}\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    </TableBody>\r\n                  </Table>\r\n                )}\r\n              </div>\r\n\r\n              <div className={`bg-white ${isMobile ? 'p-3' : 'p-4'} rounded-lg border`}>\r\n                <p className={`${isMobile ? 'text-sm' : 'text-sm'} text-gray-600`}>\r\n                  <strong>Thank you for your continued support.</strong>\r\n                </p>\r\n                <p className={`${isMobile ? 'text-xs' : 'text-sm'} text-gray-500 mt-2`}>\r\n                  {settings.businessName}<br />\r\n                  Notice generated on {format(new Date(), 'MMMM d, yyyy')}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        )}\r\n      </Card>\r\n\r\n      <PaymentReminderPreviewDialog\r\n        isOpen={isPreviewOpen}\r\n        onOpenChange={setIsPreviewOpen}\r\n        sale={null}\r\n        customer={customer}\r\n        unpaidSales={unpaidSales}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PaymentReminderNotice;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7843, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerDetail.tsx"],"sourcesContent":["\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Customer } from '@/types';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Calendar, Edit2, Mail, MapPin, Phone, Trash2, Receipt, CreditCard, FileText, MessageSquare, Cake } from 'lucide-react';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { format } from 'date-fns';\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogFooter } from '@/components/ui/dialog';\r\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from '@/components/ui/alert-dialog';\r\nimport { MoreHorizontal, Trash } from 'lucide-react';\r\nimport CustomerForm from './CustomerForm';\r\nimport CustomerPurchaseHistory from './CustomerPurchaseHistory';\r\nimport CustomerNotes from './CustomerNotes';\r\nimport BusinessNoticeGenerator from './BusinessNoticeGenerator';\r\nimport SMSNoticeDialog from './SMSNoticeDialog';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { useSalesData } from '@/hooks/useSalesData';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport { Loader2, Plus, Download, Printer } from 'lucide-react';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { canSendSMS, getBirthdayMessage, openSMSApp, openWhatsApp, formatMessageForSMS } from '@/utils/smsUtils';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport PaymentReminderNotice from './PaymentReminderNotice';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { generateReceiptNumber } from '@/utils/generateReceiptNumber';\r\nimport { mapSaleToDbSale, Sale } from '@/types';\r\nimport { useInstallmentPayments } from '@/hooks/useInstallmentPayments';\r\n\r\ninterface CustomerDetailProps {\r\n  customer: Customer;\r\n  onUpdate: (data: Partial<Customer>) => Promise<boolean>;\r\n  onDelete: () => Promise<boolean>;\r\n  canEdit?: boolean;\r\n  canDelete?: boolean;\r\n}\r\n\r\nconst CustomerDetail: React.FC<CustomerDetailProps> = ({\r\n  customer,\r\n  onUpdate,\r\n  onDelete,\r\n  canEdit = true,\r\n  canDelete = true\r\n}) => {\r\n  // Statement feature state and ref\r\n  const statementTableRef = React.useRef<HTMLDivElement>(null);\r\n  const [startDate, setStartDate] = useState<string>('');\r\n  const [endDate, setEndDate] = useState<string>('');\r\n  const [manualChargeOpen, setManualChargeOpen] = useState(false);\r\n  const [manualPaymentOpen, setManualPaymentOpen] = useState(false);\r\n  const [isProcessingEntry, setIsProcessingEntry] = useState(false);\r\n\r\n  // Helper to get statement sales for this customer, excluding quotes\r\n  const getStatementSales = () => sales.filter(sale => {\r\n    const status = (sale.paymentStatus || '').toString().toUpperCase();\r\n    const saleDate = new Date(sale.date);\r\n    const start = startDate ? new Date(startDate) : null;\r\n    const end = endDate ? new Date(endDate) : null;\r\n    if (end) end.setHours(23, 59, 59, 999);\r\n    const isWithinRange = (!start || saleDate >= start) &&\r\n      (!end || saleDate <= end);\r\n    return sale.customerName.toLowerCase() === customer.fullName.toLowerCase() && status !== 'QUOTE' && isWithinRange;\r\n  });\r\n\r\n  // Helper to get paid amount for a sale\r\n  const getPaidAmount = (sale: any) => {\r\n    // Normalize payment status for case-insensitive match\r\n    const status = (sale.paymentStatus || '').toString().toUpperCase();\r\n    // Use Sale.amountPaid if present, else fallback to amount_paid, paid, paymentAmount\r\n    if (typeof sale.amountPaid === 'number') return sale.amountPaid;\r\n    if (typeof sale.amount_paid === 'number') return sale.amount_paid;\r\n    if (typeof sale.paid === 'number') return sale.paid;\r\n    if (typeof sale.paymentAmount === 'number') return sale.paymentAmount;\r\n    // If installment sale, sum payments from sale.installments if present\r\n    if (status === 'INSTALLMENT SALE' && Array.isArray(sale.installments)) {\r\n      return sale.installments.reduce((sum: number, inst: any) => sum + (inst.amountPaid || 0), 0);\r\n    }\r\n    // If paymentStatus is Paid, assume full amount paid\r\n    if (status === 'PAID') {\r\n      return sale.items.reduce((sum: number, item: any) => sum + item.price * item.quantity, 0);\r\n    }\r\n    return 0;\r\n  };\r\n\r\n  // Helper to get due amount for a sale\r\n  const getDueAmount = (sale: any, amount: number, paid: number) => {\r\n    if (typeof sale.amountDue === 'number') return sale.amountDue;\r\n    if (typeof sale.amount_due === 'number') return sale.amount_due;\r\n    // For installment sale, due = amount - sum of installment payments\r\n    const status = (sale.paymentStatus || '').toString().toUpperCase();\r\n    if (status === 'INSTALLMENT SALE' && Array.isArray(sale.installments)) {\r\n      const paidInstallments = sale.installments.reduce((sum: number, inst: any) => sum + (inst.amountPaid || 0), 0);\r\n      return amount - paidInstallments;\r\n    }\r\n    // Fallback: amount - paid\r\n    return amount - paid;\r\n  };\r\n\r\n  // Export CSV handler\r\n  const handleExportStatementCSV = () => {\r\n    const allCustomerSales = sales.filter(sale =>\r\n      sale.customerName.toLowerCase() === customer.fullName.toLowerCase() &&\r\n      (sale.paymentStatus || '').toString().toUpperCase() !== 'QUOTE'\r\n    );\r\n\r\n    const start = startDate ? new Date(startDate) : null;\r\n    const end = endDate ? new Date(endDate) : null;\r\n    if (end) end.setHours(23, 59, 59, 999);\r\n\r\n    let openingBalance = 0;\r\n    if (start) {\r\n      allCustomerSales.forEach(sale => {\r\n        const saleDate = new Date(sale.date);\r\n        if (saleDate < start) {\r\n          openingBalance += sale.items.reduce((sum: number, item: any) => sum + item.price * item.quantity, 0);\r\n          openingBalance -= getPaidAmount(sale);\r\n        }\r\n      });\r\n    }\r\n\r\n    const ledgerEntries: any[] = [];\r\n    allCustomerSales.forEach(sale => {\r\n      // Add sale\r\n      const status = (sale.paymentStatus || '').toString().toUpperCase();\r\n      let label = 'Receipt #';\r\n      if (status === 'QUOTE') label = 'Quote #';\r\n      else if (status === 'NOT PAID' || status === 'PARTIAL') label = 'Invoice #';\r\n      else if (sale.receiptNumber.startsWith('ADJ-')) label = 'Adjustment #';\r\n\r\n      ledgerEntries.push({\r\n        date: new Date(sale.date),\r\n        details: `${label}${sale.receiptNumber}`,\r\n        amount: sale.items.reduce((sum, item) => sum + item.price * item.quantity, 0),\r\n        type: 'sale'\r\n      });\r\n\r\n      // Add payments\r\n      if (status === 'INSTALLMENT SALE' && Array.isArray(sale.installments)) {\r\n        sale.installments.forEach(inst => {\r\n          const pAmount = inst.amountPaid || 0;\r\n          if (pAmount > 0) {\r\n            ledgerEntries.push({\r\n              date: inst.date ? new Date(inst.date) : new Date(sale.date),\r\n              details: 'Payment',\r\n              amount: -pAmount,\r\n              type: 'payment'\r\n            });\r\n          }\r\n        });\r\n      } else {\r\n        const paid = getPaidAmount(sale);\r\n        if (paid > 0) {\r\n          ledgerEntries.push({\r\n            date: new Date(sale.date),\r\n            details: 'Payment',\r\n            amount: -paid,\r\n            type: 'payment'\r\n          });\r\n        }\r\n      }\r\n    });\r\n\r\n    ledgerEntries.sort((a, b) => {\r\n      const dateComparison = a.date.getTime() - b.date.getTime();\r\n      if (dateComparison !== 0) return dateComparison;\r\n      return (a.createdAt?.getTime() || 0) - (b.createdAt?.getTime() || 0);\r\n    });\r\n\r\n    const headers = ['Date', 'Details', 'Amount', 'Balance'];\r\n    const rows = [];\r\n    let runningBalance = openingBalance;\r\n\r\n    if (start) {\r\n      rows.push([format(start, 'yyyy-MM-dd'), 'Opening Balance', '-', runningBalance]);\r\n    }\r\n\r\n    ledgerEntries.forEach(entry => {\r\n      const isWithinRange = (!start || entry.date >= start) && (!end || entry.date <= end);\r\n      runningBalance += entry.amount;\r\n\r\n      if (isWithinRange) {\r\n        rows.push([\r\n          format(entry.date, 'yyyy-MM-dd'),\r\n          entry.details,\r\n          entry.amount,\r\n          runningBalance\r\n        ]);\r\n      }\r\n    });\r\n\r\n    const csvContent = [headers, ...rows].map(row => row.join(',')).join('\\n');\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n    const link = document.createElement('a');\r\n    link.href = URL.createObjectURL(blob);\r\n    link.download = `customer_statement_${customer.fullName.replace(/\\s+/g, '_')}_${new Date().toISOString().slice(0, 10)}.csv`;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  };\r\n\r\n  // Export PDF handler (uses new jsPDF-based layout utility)\r\n  const handleExportStatementPDF = async () => {\r\n    const allCustomerSales = sales.filter(sale =>\r\n      sale.customerName.toLowerCase() === customer.fullName.toLowerCase() &&\r\n      (sale.paymentStatus || '').toString().toUpperCase() !== 'QUOTE'\r\n    );\r\n\r\n    const start = startDate ? new Date(startDate) : null;\r\n    const end = endDate ? new Date(endDate) : null;\r\n    if (end) end.setHours(23, 59, 59, 999);\r\n\r\n    let openingBalance = 0;\r\n    if (start) {\r\n      allCustomerSales.forEach(sale => {\r\n        const saleDate = new Date(sale.date);\r\n        if (saleDate < start) {\r\n          openingBalance += sale.items.reduce((sum: number, item: any) => sum + item.price * item.quantity, 0);\r\n          openingBalance -= getPaidAmount(sale);\r\n        }\r\n      });\r\n    }\r\n\r\n    const ledgerEntries: any[] = [];\r\n    allCustomerSales.forEach(sale => {\r\n      const status = (sale.paymentStatus || '').toString().toUpperCase();\r\n      let label = 'Receipt #';\r\n      if (status === 'QUOTE') label = 'Quote #';\r\n      else if (status === 'NOT PAID' || status === 'PARTIAL') label = 'Invoice #';\r\n      else if (sale.receiptNumber.startsWith('ADJ-')) label = 'Adjustment #';\r\n\r\n      ledgerEntries.push({\r\n        date: new Date(sale.date),\r\n        details: `${label}${sale.receiptNumber}`,\r\n        amount: sale.items.reduce((sum, item) => sum + item.price * item.quantity, 0),\r\n        type: 'sale'\r\n      });\r\n\r\n      // Add payments\r\n      if (status === 'INSTALLMENT SALE' && Array.isArray(sale.installments)) {\r\n        sale.installments.forEach(inst => {\r\n          const pAmount = inst.amountPaid || 0;\r\n          if (pAmount > 0) {\r\n            ledgerEntries.push({\r\n              date: inst.date ? new Date(inst.date) : new Date(sale.date),\r\n              details: 'Payment',\r\n              amount: -pAmount,\r\n              type: 'payment'\r\n            });\r\n          }\r\n        });\r\n      } else {\r\n        const paid = getPaidAmount(sale);\r\n        if (paid > 0) {\r\n          ledgerEntries.push({\r\n            date: new Date(sale.date),\r\n            details: 'Payment',\r\n            amount: -paid,\r\n            type: 'payment'\r\n          });\r\n        }\r\n      }\r\n    });\r\n\r\n    ledgerEntries.sort((a, b) => a.date.getTime() - b.date.getTime());\r\n\r\n    const rows = [];\r\n    let runningBalance = openingBalance;\r\n\r\n    if (start) {\r\n      rows.push({\r\n        date: start.toISOString(),\r\n        details: 'Opening Balance',\r\n        amount: openingBalance,\r\n        paid: 0,\r\n        balance: openingBalance\r\n      });\r\n    }\r\n\r\n    ledgerEntries.forEach(entry => {\r\n      const isWithinRange = (!start || entry.date >= start) && (!end || entry.date <= end);\r\n      runningBalance += entry.amount;\r\n\r\n      if (isWithinRange) {\r\n        rows.push({\r\n          date: entry.date.toISOString(),\r\n          details: entry.details,\r\n          amount: entry.amount > 0 ? entry.amount : 0,\r\n          paid: entry.amount < 0 ? Math.abs(entry.amount) : 0,\r\n          balance: runningBalance\r\n        });\r\n      }\r\n    });\r\n\r\n    const { generateStatementPDF } = await import('@/utils/generateStatementPDF');\r\n    await generateStatementPDF(rows, {\r\n      filename: `customer_statement_${customer.fullName.replace(/\\s+/g, '_')}_${new Date().toISOString().slice(0, 10)}.pdf`,\r\n      orientation: 'portrait',\r\n      format: 'a4',\r\n      margins: { top: 15, right: 15, bottom: 15, left: 15 },\r\n      currency: settings.currency,\r\n      customerName: customer.fullName\r\n    });\r\n  };\r\n  const [editDialogOpen, setEditDialogOpen] = useState(false);\r\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\r\n  const [noticeDialogOpen, setNoticeDialogOpen] = useState(false);\r\n  const [smsDialogOpen, setSMSDialogOpen] = useState(false);\r\n  const { user } = useAuth();\r\n  const { sales, isLoading, getCustomerLifetimePurchases, deleteSale, refetch } = useSalesData(user?.id);\r\n  const { currentBusiness } = useBusiness();\r\n  const { settings } = useBusinessSettings();\r\n  const isMobile = useIsMobile();\r\n  const { toast } = useToast();\r\n\r\n  const [lifetimePurchases, setLifetimePurchases] = useState<{ total: number, count: number } | null>(null);\r\n  const [creditSales, setCreditSales] = useState<{ total: number, count: number } | null>(null);\r\n  const [isLoadingLifetime, setIsLoadingLifetime] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const calculatePurchaseData = () => {\r\n      setIsLoadingLifetime(true);\r\n      try {\r\n        if (customer && !isLoading) {\r\n          // Calculate lifetime purchases (excluding quotes)\r\n          const purchaseData = getCustomerLifetimePurchases(customer.fullName);\r\n          setLifetimePurchases(purchaseData);\r\n\r\n          // Calculate credit sales (unpaid sales only)\r\n          const customerSales = sales.filter(sale =>\r\n            sale.customerName.toLowerCase() === customer.fullName.toLowerCase()\r\n          );\r\n\r\n          const unpaidSales = customerSales.filter(sale =>\r\n            sale.paymentStatus === \"NOT PAID\"\r\n          );\r\n\r\n          const creditTotal = unpaidSales.reduce((sum, sale) =>\r\n            sum + sale.items.reduce((itemSum, item) => itemSum + (item.price * item.quantity), 0), 0\r\n          );\r\n\r\n          setCreditSales({\r\n            total: creditTotal,\r\n            count: unpaidSales.length\r\n          });\r\n        } else {\r\n          setLifetimePurchases({ total: 0, count: 0 });\r\n          setCreditSales({ total: 0, count: 0 });\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error calculating purchase data:\", error);\r\n        setLifetimePurchases({ total: 0, count: 0 });\r\n        setCreditSales({ total: 0, count: 0 });\r\n      } finally {\r\n        setIsLoadingLifetime(false);\r\n      }\r\n    };\r\n\r\n    calculatePurchaseData();\r\n  }, [customer, sales, isLoading, getCustomerLifetimePurchases]);\r\n\r\n  const formatCurrency = (value: number) => {\r\n    return `${settings.currency} ${formatNumber(value)}`;\r\n  };\r\n\r\n  const handleUpdate = async (data: Partial<Customer>) => {\r\n    console.log('Customer update data received in detail view:', data);\r\n\r\n    // Create a clean copy of the data to avoid reference issues\r\n    const updatedData = { ...data };\r\n\r\n    // Make sure birthday is properly handled if it exists\r\n    if (updatedData.birthday) {\r\n      console.log('Birthday before update:', updatedData.birthday);\r\n\r\n      // Ensure it's a valid Date object\r\n      if (!(updatedData.birthday instanceof Date) || isNaN(updatedData.birthday.getTime())) {\r\n        console.log('Converting birthday to valid Date object');\r\n\r\n        // If it's a string, convert it to a Date at UTC noon\r\n        if (typeof updatedData.birthday === 'string') {\r\n          // Type-safe string handling\r\n          const birthdayString = updatedData.birthday as string;\r\n          const dateParts = birthdayString.split('-');\r\n          if (dateParts.length === 3) {\r\n            const [year, month, day] = dateParts.map(Number);\r\n            updatedData.birthday = new Date(Date.UTC(year, month - 1, day, 12, 0, 0));\r\n          } else {\r\n            // Handle invalid string format\r\n            console.error('Invalid birthday string format');\r\n            updatedData.birthday = null;\r\n          }\r\n        } else {\r\n          // Handle other non-Date, non-string types\r\n          console.error('Birthday is not a Date or string:', typeof updatedData.birthday);\r\n          updatedData.birthday = null;\r\n        }\r\n      }\r\n    }\r\n\r\n    const success = await onUpdate(updatedData);\r\n    if (success) {\r\n      setEditDialogOpen(false);\r\n    }\r\n    return success;\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    const success = await onDelete();\r\n    if (success) {\r\n      setDeleteDialogOpen(false);\r\n    }\r\n    return success;\r\n  };\r\n\r\n  const showSMSOption = isMobile && canSendSMS(customer);\r\n  const showWhatsAppOption = canSendSMS(customer);\r\n\r\n  // Check if customer has birthday and it's their birthday month or within a few days\r\n  const hasBirthday = customer.birthday !== null;\r\n  const isBirthdayToday = customer.birthday &&\r\n    new Date().toDateString() === customer.birthday.toDateString();\r\n  const isBirthdayThisMonth = customer.birthday &&\r\n    new Date().getMonth() === customer.birthday.getMonth();\r\n\r\n  const handleSendBirthdayWishes = (method: 'sms' | 'whatsapp') => {\r\n    if (!canSendSMS(customer)) {\r\n      toast({\r\n        title: \"Phone number required\",\r\n        description: \"Customer phone number is not available.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const birthdayMessage = getBirthdayMessage(customer.fullName);\r\n      const formattedMessage = formatMessageForSMS(birthdayMessage, settings.businessName);\r\n\r\n      if (method === 'sms') {\r\n        openSMSApp({\r\n          phoneNumber: customer.phoneNumber!,\r\n          message: formattedMessage\r\n        });\r\n        toast({\r\n          title: \"SMS app opened\",\r\n          description: \"Birthday wishes prepared in SMS app.\",\r\n        });\r\n      } else {\r\n        openWhatsApp({\r\n          phoneNumber: customer.phoneNumber!,\r\n          message: formattedMessage\r\n        });\r\n        toast({\r\n          title: \"WhatsApp opened\",\r\n          description: \"Birthday wishes prepared in WhatsApp.\",\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error sending birthday wishes:', error);\r\n      toast({\r\n        title: \"Failed to send\",\r\n        description: \"Failed to open messaging app. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Payment Reminder Notice - Show only if there are credit sales */}\r\n      {creditSales && creditSales.count > 0 && (\r\n        <PaymentReminderNotice\r\n          customer={customer}\r\n          unpaidSales={sales.filter(sale =>\r\n            sale.customerName.toLowerCase() === customer.fullName.toLowerCase() &&\r\n            sale.paymentStatus === \"NOT PAID\"\r\n          )}\r\n          totalAmountDue={creditSales.total}\r\n        />\r\n      )}\r\n\r\n      {/* Birthday Notice - Show if customer has birthday and it's their birthday month */}\r\n      {hasBirthday && isBirthdayThisMonth && (showSMSOption || showWhatsAppOption) && (\r\n        <Card className=\"border-pink-200 bg-gradient-to-r from-pink-50 to-purple-50\">\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"p-2 bg-pink-500 rounded-lg\">\r\n                  <Cake className=\"h-5 w-5 text-white\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-medium text-pink-900\">\r\n                    {isBirthdayToday ? \"ðŸŽ‰ It's their birthday today!\" : \"Birthday this month\"}\r\n                  </h3>\r\n                  <p className=\"text-sm text-pink-700\">\r\n                    {customer.birthday && format(customer.birthday, 'MMMM d')} - Send birthday wishes\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex gap-2\">\r\n                {showSMSOption && (\r\n                  <Button\r\n                    size=\"sm\"\r\n                    onClick={() => handleSendBirthdayWishes('sms')}\r\n                    className=\"bg-pink-500 hover:bg-pink-600 text-white\"\r\n                  >\r\n                    <MessageSquare className=\"h-4 w-4 mr-1\" />\r\n                    SMS Wishes\r\n                  </Button>\r\n                )}\r\n                {showWhatsAppOption && (\r\n                  <Button\r\n                    size=\"sm\"\r\n                    variant=\"outline\"\r\n                    onClick={() => handleSendBirthdayWishes('whatsapp')}\r\n                    className=\"border-green-500 text-green-700 hover:bg-green-50\"\r\n                  >\r\n                    ðŸ“± WhatsApp\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      <Card>\r\n        <CardHeader className=\"pb-4\">\r\n          <div className=\"flex justify-between items-start\">\r\n            <div>\r\n              <CardTitle className=\"text-2xl\">{customer.fullName}</CardTitle>\r\n              <CardDescription>\r\n                Customer since {format(customer.createdAt, 'MMMM d, yyyy')}\r\n              </CardDescription>\r\n            </div>\r\n            <div className=\"flex gap-2 flex-wrap\">\r\n              {showSMSOption && (\r\n                <Button variant=\"outline\" size=\"sm\" onClick={() => setSMSDialogOpen(true)}>\r\n                  <MessageSquare className=\"h-4 w-4 mr-1\" />\r\n                  SMS\r\n                </Button>\r\n              )}\r\n              <Button variant=\"outline\" size=\"sm\" onClick={() => setNoticeDialogOpen(true)}>\r\n                <FileText className=\"h-4 w-4 mr-1\" />\r\n                Send Notice\r\n              </Button>\r\n              {canEdit && (\r\n                <Button variant=\"outline\" size=\"sm\" onClick={() => setEditDialogOpen(true)}>\r\n                  <Edit2 className=\"h-4 w-4 mr-1\" />\r\n                  Edit\r\n                </Button>\r\n              )}\r\n              {canDelete && (\r\n                <Button variant=\"destructive\" size=\"sm\" onClick={() => setDeleteDialogOpen(true)}>\r\n                  <Trash2 className=\"h-4 w-4 mr-1\" />\r\n                  Delete\r\n                </Button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <h3 className=\"font-medium text-gray-500 mb-2\">Contact Information</h3>\r\n                <div className=\"space-y-2\">\r\n                  {customer.email && (\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Mail className=\"h-4 w-4 text-gray-400\" />\r\n                      <a href={`mailto:${customer.email}`} className=\"text-blue-600 hover:underline\">\r\n                        {customer.email}\r\n                      </a>\r\n                    </div>\r\n                  )}\r\n                  {customer.phoneNumber && (\r\n                    <div className=\"flex items-center gap-2 justify-between\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Phone className=\"h-4 w-4 text-gray-400\" />\r\n                        <a href={`tel:${customer.phoneNumber}`} className=\"text-blue-600 hover:underline\">\r\n                          {customer.phoneNumber}\r\n                        </a>\r\n                      </div>\r\n                      {showSMSOption && (\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() => setSMSDialogOpen(true)}\r\n                          className=\"text-blue-600 hover:text-blue-700 hover:bg-blue-50 p-1 h-auto\"\r\n                          title=\"Send SMS\"\r\n                        >\r\n                          <MessageSquare className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                  {customer.location && (\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <MapPin className=\"h-4 w-4 text-gray-400\" />\r\n                      <span>{customer.location}</span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {customer.birthday && (\r\n                <div>\r\n                  <h3 className=\"font-medium text-gray-500 mb-2\">Birthday</h3>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Calendar className=\"h-4 w-4 text-gray-400\" />\r\n                    <span>{format(customer.birthday, 'MMMM d')}</span>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {customer.socialMedia && Object.keys(customer.socialMedia).length > 0 && (\r\n                <div>\r\n                  <h3 className=\"font-medium text-gray-500 mb-2\">Social Media</h3>\r\n                  <div className=\"space-y-1\">\r\n                    {Object.entries(customer.socialMedia).map(([platform, handle]) => (\r\n                      handle && (\r\n                        <div key={platform} className=\"flex items-center gap-2\">\r\n                          <span className=\"capitalize\">{platform}:</span>\r\n                          <span className=\"text-blue-600\">{handle}</span>\r\n                        </div>\r\n                      )\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Lifetime Purchases Section - Updated with credit sales */}\r\n              <div>\r\n                <h3 className=\"font-medium text-gray-500 mb-2\">Purchase Summary</h3>\r\n                {isLoadingLifetime ? (\r\n                  <div className=\"flex items-center\">\r\n                    <Loader2 className=\"h-4 w-4 mr-2 animate-spin text-gray-500\" />\r\n                    <span>Loading purchase data...</span>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-3\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Receipt className=\"h-4 w-4 text-gray-400\" />\r\n                      <span>\r\n                        <strong>Lifetime Purchases:</strong> {lifetimePurchases?.count || 0} orders totaling {formatCurrency(lifetimePurchases?.total || 0)}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <CreditCard className=\"h-4 w-4 text-red-400\" />\r\n                      <span>\r\n                        <strong>Total Credit Sales:</strong> {creditSales?.count || 0} unpaid orders totaling {formatCurrency(creditSales?.total || 0)}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"text-xs text-gray-500\">\r\n                      * Quotes are excluded from totals\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              {customer.tags && customer.tags.length > 0 && (\r\n                <div>\r\n                  <h3 className=\"font-medium text-gray-500 mb-2\">Tags</h3>\r\n                  <div className=\"flex flex-wrap gap-1\">\r\n                    {customer.tags.map((tag, index) => (\r\n                      <Badge key={index} variant=\"outline\" className=\"bg-blue-50\">\r\n                        {tag}\r\n                      </Badge>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {customer.gender && (\r\n                <div>\r\n                  <h3 className=\"font-medium text-gray-500 mb-2\">Gender</h3>\r\n                  <span className=\"capitalize\">{customer.gender}</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Tabs defaultValue=\"purchases\" className=\"w-full\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"purchases\">Purchase History</TabsTrigger>\r\n          <TabsTrigger value=\"notes\">Notes</TabsTrigger>\r\n          <TabsTrigger value=\"statement\">Statement</TabsTrigger>\r\n        </TabsList>\r\n        <TabsContent value=\"purchases\">\r\n          <CustomerPurchaseHistory customerId={customer.id} />\r\n        </TabsContent>\r\n        <TabsContent value=\"notes\">\r\n          <CustomerNotes\r\n            notes={customer.notes || ''}\r\n            onSave={(notes) => onUpdate({ notes })}\r\n          />\r\n        </TabsContent>\r\n        <TabsContent value=\"statement\">\r\n          <div ref={statementTableRef} className=\"bg-white rounded-xl shadow-lg p-6\">\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6\">\r\n              <div>\r\n                <h3 className=\"font-bold text-xl text-gray-800\">Customer Statement</h3>\r\n                <p className=\"text-sm text-gray-500\">Transaction history and balance</p>\r\n              </div>\r\n\r\n              <div className=\"flex flex-wrap items-center gap-4 w-full md:w-auto\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Label htmlFor=\"statement-start\" className=\"text-xs font-medium text-gray-500\">From:</Label>\r\n                  <Input\r\n                    id=\"statement-start\"\r\n                    type=\"date\"\r\n                    value={startDate}\r\n                    onChange={(e) => setStartDate(e.target.value)}\r\n                    className=\"h-9 text-xs w-36\"\r\n                  />\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Label htmlFor=\"statement-end\" className=\"text-xs font-medium text-gray-500\">To:</Label>\r\n                  <Input\r\n                    id=\"statement-end\"\r\n                    type=\"date\"\r\n                    value={endDate}\r\n                    onChange={(e) => setEndDate(e.target.value)}\r\n                    className=\"h-9 text-xs w-36\"\r\n                  />\r\n                </div>\r\n                <div className=\"flex gap-2 ml-auto\">\r\n                  {canEdit && (\r\n                    <>\r\n                      <Button size=\"sm\" variant=\"outline\" className=\"bg-red-50 text-red-700 border-red-200\" onClick={() => setManualChargeOpen(true)}>Add Charge</Button>\r\n                      <Button size=\"sm\" variant=\"outline\" className=\"bg-green-50 text-green-700 border-green-200\" onClick={() => setManualPaymentOpen(true)}>Add Payment</Button>\r\n                    </>\r\n                  )}\r\n                  <Button size=\"sm\" variant=\"outline\" onClick={handleExportStatementCSV}>CSV</Button>\r\n                  <Button size=\"sm\" variant=\"outline\" onClick={handleExportStatementPDF}>PDF</Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"min-w-full text-sm border-collapse\">\r\n                <thead>\r\n                  <tr className=\"bg-blue-600 text-white\">\r\n                    <th className=\"px-4 py-3 text-left font-semibold first:rounded-tl-lg\">Date</th>\r\n                    <th className=\"px-4 py-3 text-left font-semibold\">Details (Receipt/Invoice)</th>\r\n                    <th className=\"px-4 py-3 text-right font-semibold\">Amount</th>\r\n                    <th className=\"px-4 py-3 text-right font-semibold\">Balance</th>\r\n                    <th className=\"px-4 py-3 text-center font-semibold last:rounded-tr-lg\">Actions</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"divide-y divide-gray-200\">\r\n                  {(() => {\r\n                    const allCustomerSales = sales.filter(sale =>\r\n                      sale.customerName.toLowerCase() === customer.fullName.toLowerCase() &&\r\n                      (sale.paymentStatus || '').toString().toUpperCase() !== 'QUOTE'\r\n                    );\r\n\r\n                    const startValue = startDate ? new Date(startDate) : null;\r\n                    const endValue = endDate ? new Date(endDate) : null;\r\n                    if (endValue) endValue.setHours(23, 59, 59, 999);\r\n\r\n                    // Calculate opening balance (all transactions before start date)\r\n                    let openingBalance = 0;\r\n                    if (startValue) {\r\n                      allCustomerSales.forEach(sale => {\r\n                        const saleDate = new Date(sale.date);\r\n                        if (saleDate < startValue) {\r\n                          const amount = sale.items.reduce((sum: number, item: any) => sum + item.price * item.quantity, 0);\r\n                          openingBalance += amount;\r\n                          openingBalance -= getPaidAmount(sale);\r\n                        }\r\n                      });\r\n                    }\r\n\r\n                    const statementSales = allCustomerSales.filter(sale => {\r\n                      const saleDate = new Date(sale.date);\r\n                      return (!startValue || saleDate >= startValue) && (!endValue || saleDate <= endValue);\r\n                    });\r\n\r\n                    const sortedSales = [...statementSales].sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());\r\n\r\n                    let runningBalance = openingBalance;\r\n                    const ledgerEntries: any[] = [];\r\n\r\n                    // Add sales as entries\r\n                    sortedSales.forEach(sale => {\r\n                      const status = (sale.paymentStatus || '').toString().toUpperCase();\r\n                      let label = 'Receipt #';\r\n                      if (status === 'QUOTE') label = 'Quote #';\r\n                      else if (status === 'NOT PAID' || status === 'PARTIAL') label = 'Invoice #';\r\n                      else if (sale.receiptNumber.startsWith('ADJ-')) label = 'Adjustment #';\r\n\r\n                      if (!sale.receiptNumber.startsWith('PAY-')) {\r\n                        ledgerEntries.push({\r\n                          date: new Date(sale.date),\r\n                          details: label + sale.receiptNumber,\r\n                          amount: sale.items.reduce((sum, item) => sum + item.price * item.quantity, 0),\r\n                          type: 'sale',\r\n                          id: sale.id,\r\n                          originalSale: sale,\r\n                          createdAt: sale.createdAt\r\n                        });\r\n                      }\r\n\r\n                      // Add payments from this sale as entries\r\n                      if (status === 'INSTALLMENT SALE' && Array.isArray(sale.installments)) {\r\n                        sale.installments.forEach((inst, iidx) => {\r\n                          const pAmount = inst.amountPaid || 0;\r\n                          if (pAmount > 0) {\r\n                            ledgerEntries.push({\r\n                              date: inst.date ? new Date(inst.date) : new Date(sale.date),\r\n                              details: 'Payment',\r\n                              amount: -pAmount,\r\n                              type: 'payment',\r\n                              id: `${sale.id}-inst-${iidx}`,\r\n                              originalSale: sale,\r\n                              isInstallment: true,\r\n                              createdAt: sale.createdAt // Using sale creation time as roughly correct for initial payment structure or fallback\r\n                            });\r\n                          }\r\n                        });\r\n                      } else {\r\n                        const paid = getPaidAmount(sale);\r\n                        if (paid > 0) {\r\n                          ledgerEntries.push({\r\n                            date: new Date(sale.date),\r\n                            details: 'Payment',\r\n                            amount: -paid,\r\n                            type: 'payment',\r\n                            id: `${sale.id}-payment`,\r\n                            originalSale: sale,\r\n                            // For non-installment sales, the payment is intrinsic to the sale, so we can't delete it separately easily unless it's a Manual Payment (which is a sale itself)\r\n                            isManualPayment: sale.receiptNumber.startsWith('PAY-'),\r\n                            createdAt: sale.createdAt\r\n                          });\r\n                        }\r\n                      }\r\n                    });\r\n\r\n                    // Sort all entries by date, then by creation time\r\n                    ledgerEntries.sort((a, b) => {\r\n                      const dateComparison = a.date.getTime() - b.date.getTime();\r\n                      if (dateComparison !== 0) return dateComparison;\r\n                      return (a.createdAt?.getTime() || 0) - (b.createdAt?.getTime() || 0);\r\n                    });\r\n\r\n                    const rows = [];\r\n                    // Add opening balance row\r\n                    if (startValue) {\r\n                      rows.push(\r\n                        <tr key=\"opening-balance\" className=\"bg-gray-50 italic\">\r\n                          <td className=\"px-4 py-3 text-gray-500\">{format(startValue, 'MMM d, yyyy')}</td>\r\n                          <td className=\"px-4 py-3 text-gray-500 font-medium\">Opening Balance</td>\r\n                          <td className=\"px-4 py-3 text-right text-gray-500\">-</td>\r\n                          <td className=\"px-4 py-3 text-right font-semibold text-gray-600\">{settings.currency} {openingBalance.toLocaleString()}</td>\r\n                        </tr>\r\n                      );\r\n                    }\r\n\r\n                    // Build rows from sorted ledger entries\r\n                    ledgerEntries.forEach((entry) => {\r\n                      const isWithinRange = (!startValue || entry.date >= startValue) && (!endValue || entry.date <= endValue);\r\n\r\n                      runningBalance += entry.amount;\r\n\r\n                      if (isWithinRange) {\r\n                        const isPayment = entry.type === 'payment';\r\n                        rows.push(\r\n                          <tr key={entry.id} className={isPayment ? \"bg-green-50/50 hover:bg-green-50 transition-colors\" : \"hover:bg-blue-50 transition-colors\"}>\r\n                            <td className={`px-4 py-3 ${isPayment ? 'text-green-700 italic' : 'text-gray-600'}`}>\r\n                              {format(entry.date, 'MMM d, yyyy')}\r\n                            </td>\r\n                            <td className={`px-4 py-3 font-medium ${isPayment ? 'text-green-700' : 'text-gray-900'}`}>\r\n                              {entry.details}\r\n                            </td>\r\n                            <td className={`px-4 py-3 text-right ${isPayment ? 'text-green-700' : 'text-gray-900'}`}>\r\n                              {isPayment ? '- ' : ''}{settings.currency} {Math.abs(entry.amount).toLocaleString()}\r\n                            </td>\r\n                            <td className={`px-4 py-3 text-right font-bold ${isPayment ? 'text-green-800' : 'text-gray-900'}`}>\r\n                              {settings.currency} {runningBalance.toLocaleString()}\r\n                            </td>\r\n                            <td className=\"px-4 py-3 text-center whitespace-nowrap\">\r\n                              <Button\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                className=\"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50\"\r\n                                onClick={async () => {\r\n                                  if (confirm('Are you sure you want to delete this entry?')) {\r\n                                    try {\r\n                                      if (entry.isInstallment) {\r\n                                        toast({ title: \"Notice\", description: \"Cannot delete installment payment from this view. Please go to the sale details.\" });\r\n                                      } else if (entry.type === 'sale' || entry.isManualPayment) {\r\n                                        await deleteSale(entry.originalSale.id);\r\n                                        toast({ title: \"Success\", description: \"Entry deleted\" });\r\n                                      } else {\r\n                                        toast({ title: \"Notice\", description: \"Cannot delete this payment directly. Delete the sale instead.\" });\r\n                                      }\r\n                                    } catch (e) {\r\n                                      console.error(e);\r\n                                      toast({ title: \"Error\", description: \"Failed to delete\", variant: \"destructive\" });\r\n                                    }\r\n                                  }\r\n                                }}\r\n                              >\r\n                                <Trash className=\"h-4 w-4\" />\r\n                                <span className=\"sr-only\">Delete</span>\r\n                              </Button>\r\n                            </td>\r\n                          </tr>\r\n                        );\r\n                      }\r\n                    });\r\n\r\n                    return rows;\r\n                  })()\r\n                  }\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n            {getStatementSales().length === 0 && (\r\n              <div className=\"flex flex-col items-center justify-center py-12 text-gray-400\">\r\n                <FileText className=\"h-12 w-12 mb-3 opacity-20\" />\r\n                <p>No transactions found for the selected date range.</p>\r\n              </div>\r\n            )}\r\n\r\n            {getStatementSales().length > 0 && (\r\n              <div className=\"mt-6 flex justify-end\">\r\n                <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-100 min-w-48\">\r\n                  <p className=\"text-xs text-blue-600 font-medium uppercase tracking-wider mb-1\">Current Balance</p>\r\n                  <p className=\"text-2xl font-black text-blue-900\">\r\n                    {settings.currency} {(() => {\r\n                      const salesInView = getStatementSales();\r\n                      let bal = 0;\r\n                      salesInView.forEach(s => {\r\n                        const amt = s.items.reduce((sum, item) => sum + item.price * item.quantity, 0);\r\n                        bal += amt;\r\n                        bal -= getPaidAmount(s);\r\n                      });\r\n                      return bal.toLocaleString();\r\n                    })()}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      <Dialog open={editDialogOpen} onOpenChange={setEditDialogOpen}>\r\n        <DialogContent className=\"max-w-2xl max-h-[90vh]\">\r\n          <DialogHeader>\r\n            <DialogTitle>Edit Customer</DialogTitle>\r\n            <DialogDescription>\r\n              Update customer information. Click save when you're done.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <ScrollArea className=\"h-[calc(80vh-8rem)]\">\r\n            <div className=\"px-1\">\r\n              <CustomerForm\r\n                initialData={customer}\r\n                onSubmit={handleUpdate}\r\n                onCancel={() => setEditDialogOpen(false)}\r\n              />\r\n            </div>\r\n          </ScrollArea>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <BusinessNoticeGenerator\r\n        customer={customer}\r\n        open={noticeDialogOpen}\r\n        onClose={() => setNoticeDialogOpen(false)}\r\n      />\r\n\r\n      <SMSNoticeDialog\r\n        customer={customer}\r\n        open={smsDialogOpen}\r\n        onClose={() => setSMSDialogOpen(false)}\r\n        templateId=\"general_notice\"\r\n      />\r\n\r\n      {/* Manual Charge Dialog */}\r\n      <Dialog open={manualChargeOpen} onOpenChange={setManualChargeOpen}>\r\n        <DialogContent className=\"max-w-md\">\r\n          <DialogHeader>\r\n            <DialogTitle>Add Manual Charge</DialogTitle>\r\n            <DialogDescription>\r\n              Create a debit adjustment for this customer's account.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <form onSubmit={async (e) => {\r\n            e.preventDefault();\r\n            const target = e.target as any;\r\n            const amount = parseFloat(target.amount.value.replace(/,/g, ''));\r\n            const description = target.description.value;\r\n            const dateStr = target.date.value;\r\n            const date = dateStr ? new Date(dateStr) : new Date();\r\n\r\n            if (isNaN(amount) || amount <= 0) {\r\n              toast({ title: \"Error\", description: \"Please enter a valid amount.\", variant: \"destructive\" });\r\n              return;\r\n            }\r\n\r\n            setIsProcessingEntry(true);\r\n            try {\r\n              const receiptNumber = await generateReceiptNumber(currentBusiness?.id || '');\r\n\r\n              const saleDbData = {\r\n                user_id: user?.id,\r\n                location_id: currentBusiness?.id,\r\n                receipt_number: `ADJ-${receiptNumber}`,\r\n                customer_name: customer.fullName,\r\n                customer_id: customer.id,\r\n                date: date.toISOString().split('T')[0],\r\n                items: [{\r\n                  description: description || 'Manual Charge',\r\n                  quantity: 1,\r\n                  price: amount,\r\n                  cost: 0\r\n                }],\r\n                payment_status: 'NOT PAID',\r\n                amount_paid: 0,\r\n                amount_due: amount,\r\n                profit: amount,\r\n                created_at: new Date().toISOString(),\r\n                updated_at: new Date().toISOString()\r\n              };\r\n\r\n              const { error } = await supabase.from('sales' as any).insert(saleDbData);\r\n              if (error) throw error;\r\n\r\n              toast({ title: \"Success\", description: \"Manual charge added successfully.\" });\r\n              setManualChargeOpen(false);\r\n              await refetch();\r\n            } catch (err: any) {\r\n              console.error(err);\r\n              toast({ title: \"Error\", description: err.message || \"Failed to add charge.\", variant: \"destructive\" });\r\n            } finally {\r\n              setIsProcessingEntry(false);\r\n            }\r\n          }}>\r\n            <div className=\"space-y-4 py-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"charge-date\">Date</Label>\r\n                <Input id=\"charge-date\" name=\"date\" type=\"date\" defaultValue={new Date().toISOString().split('T')[0]} required />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"charge-desc\">Description</Label>\r\n                <Input id=\"charge-desc\" name=\"description\" placeholder=\"e.g., Service Fee, Penalty\" required />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"charge-amount\">Amount ({settings.currency})</Label>\r\n                <Input\r\n                  id=\"charge-amount\"\r\n                  name=\"amount\"\r\n                  type=\"text\"\r\n                  inputMode=\"decimal\"\r\n                  placeholder=\"0.00\"\r\n                  required\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"flex justify-end gap-2\">\r\n              <Button type=\"button\" variant=\"outline\" onClick={() => setManualChargeOpen(false)}>Cancel</Button>\r\n              <Button type=\"submit\" disabled={isProcessingEntry}>\r\n                {isProcessingEntry ? <Loader2 className=\"h-4 w-4 animate-spin mr-2\" /> : null}\r\n                Save Charge\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Manual Payment Dialog */}\r\n      <Dialog open={manualPaymentOpen} onOpenChange={setManualPaymentOpen}>\r\n        <DialogContent className=\"max-w-md\">\r\n          <DialogHeader>\r\n            <DialogTitle>Add Manual Payment</DialogTitle>\r\n            <DialogDescription>\r\n              Record a payment or credit to this customer's balance.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <form onSubmit={async (e) => {\r\n            e.preventDefault();\r\n            const target = e.target as any;\r\n            const amount = parseFloat(target.amount.value.replace(/,/g, ''));\r\n            const description = target.description.value;\r\n            const dateStr = target.date.value;\r\n            const date = dateStr ? new Date(dateStr) : new Date();\r\n\r\n            if (isNaN(amount) || amount <= 0) {\r\n              toast({ title: \"Error\", description: \"Please enter a valid amount.\", variant: \"destructive\" });\r\n              return;\r\n            }\r\n\r\n            setIsProcessingEntry(true);\r\n            try {\r\n              const receiptNumber = await generateReceiptNumber(currentBusiness?.id || '');\r\n\r\n              const saleDbData = {\r\n                user_id: user?.id,\r\n                location_id: currentBusiness?.id,\r\n                receipt_number: `PAY-${receiptNumber}`,\r\n                customer_name: customer.fullName,\r\n                customer_id: customer.id,\r\n                date: date.toISOString().split('T')[0],\r\n                items: [{\r\n                  description: description || 'Account Payment',\r\n                  quantity: 1,\r\n                  price: 0,\r\n                  cost: 0\r\n                }],\r\n                payment_status: 'PAID',\r\n                amount_paid: amount,\r\n                amount_due: 0,\r\n                profit: 0,\r\n                created_at: new Date().toISOString(),\r\n                updated_at: new Date().toISOString()\r\n              };\r\n\r\n              const { error } = await supabase.from('sales' as any).insert(saleDbData);\r\n              if (error) throw error;\r\n\r\n              toast({ title: \"Success\", description: \"Manual payment recorded successfully.\" });\r\n              setManualPaymentOpen(false);\r\n              await refetch();\r\n            } catch (err: any) {\r\n              console.error(err);\r\n              toast({ title: \"Error\", description: err.message || \"Failed to record payment.\", variant: \"destructive\" });\r\n            } finally {\r\n              setIsProcessingEntry(false);\r\n            }\r\n          }}>\r\n            <div className=\"space-y-4 py-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"pay-date\">Date</Label>\r\n                <Input id=\"pay-date\" name=\"date\" type=\"date\" defaultValue={new Date().toISOString().split('T')[0]} required />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"pay-desc\">Description</Label>\r\n                <Input id=\"pay-desc\" name=\"description\" placeholder=\"e.g., Cash Payment, Discount, Waiver\" required />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"pay-amount\">Amount ({settings.currency})</Label>\r\n                <Input\r\n                  id=\"pay-amount\"\r\n                  name=\"amount\"\r\n                  type=\"text\"\r\n                  inputMode=\"decimal\"\r\n                  placeholder=\"0.00\"\r\n                  required\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"flex justify-end gap-2\">\r\n              <Button type=\"button\" variant=\"outline\" onClick={() => setManualPaymentOpen(false)}>Cancel</Button>\r\n              <Button type=\"submit\" disabled={isProcessingEntry}>\r\n                {isProcessingEntry ? <Loader2 className=\"h-4 w-4 animate-spin mr-2\" /> : null}\r\n                Save Payment\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Are you sure?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              This action cannot be undone. This will permanently delete customer\r\n              \"{customer.fullName}\" and remove their data from our servers.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n            <AlertDialogAction onClick={handleDelete}>Delete</AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CustomerDetail;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10324, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerContent.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Tabs, TabsContent } from '@/components/ui/tabs';\r\nimport CustomerTabs from '@/components/customers/CustomerTabs';\r\nimport CustomerFilters from '@/components/customers/CustomerFilters';\r\nimport CustomerList from '@/components/customers/CustomerList';\r\nimport TopCustomersList from '@/components/customers/TopCustomersList';\r\nimport InactiveCustomersList from '@/components/customers/InactiveCustomersList';\r\nimport CustomerDetail from '@/components/customers/CustomerDetail';\r\nimport { Customer } from '@/hooks/useCustomers';\r\n\r\ninterface CustomerContentProps {\r\n  activeTab: string;\r\n  setActiveTab: (tab: string) => void;\r\n  selectedCustomer: Customer | null;\r\n  searchTerm: string;\r\n  setSearchTerm: (term: string) => void;\r\n  selectedCategory: string;\r\n  setSelectedCategory: (category: string) => void;\r\n  dateFilter: string;\r\n  setDateFilter: (filter: string) => void;\r\n  dateRange: { from: Date | undefined; to: Date | undefined };\r\n  setDateRange: (range: { from: Date | undefined; to: Date | undefined }) => void;\r\n  validCategories: Array<{ id: string; name: string }>;\r\n  filteredCustomers: Customer[];\r\n  customers: Customer[];\r\n  customerStats: {\r\n    categoryBreakdown: Record<string, number>;\r\n  };\r\n  getCategoryName: (categoryId: string | null) => string;\r\n  onSelectCustomer: (customer: Customer) => void;\r\n  onEditCustomer: (customer: Customer) => void;\r\n  onDeleteCustomer: (id: string) => Promise<boolean>;\r\n  onUpdateCustomer: (id: string, data: any) => Promise<boolean>;\r\n  setSelectedCustomer: (customer: Customer | null) => void;\r\n  canCreate?: boolean;\r\n  canEdit?: boolean;\r\n  canDelete?: boolean;\r\n}\r\n\r\nconst CustomerContent: React.FC<CustomerContentProps> = ({\r\n  activeTab,\r\n  setActiveTab,\r\n  selectedCustomer,\r\n  searchTerm,\r\n  setSearchTerm,\r\n  selectedCategory,\r\n  setSelectedCategory,\r\n  dateFilter,\r\n  setDateFilter,\r\n  dateRange,\r\n  setDateRange,\r\n  validCategories,\r\n  filteredCustomers,\r\n  customers,\r\n  customerStats,\r\n  getCategoryName,\r\n  onSelectCustomer,\r\n  onEditCustomer,\r\n  onDeleteCustomer,\r\n  onUpdateCustomer,\r\n  setSelectedCustomer,\r\n  canCreate = true,\r\n  canEdit = true,\r\n  canDelete = true\r\n}) => {\r\n  return (\r\n    <div className=\"bg-white rounded-xl border shadow-sm\">\r\n      <div className=\"px-8 py-6 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white\">\r\n        <div className=\"flex flex-col xl:flex-row gap-8 items-start\">\r\n          {/* Customer Views Section */}\r\n          <div className=\"flex-1 space-y-6\">\r\n            <div>\r\n              <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Customer Views</h2>\r\n              <p className=\"text-gray-600 text-sm\">Choose how you want to view and manage your customers</p>\r\n            </div>\r\n\r\n            <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\r\n              <CustomerTabs activeTab={activeTab} selectedCustomer={selectedCustomer} />\r\n            </Tabs>\r\n          </div>\r\n\r\n          {/* Search & Filter Section */}\r\n          <CustomerFilters\r\n            activeTab={activeTab}\r\n            searchTerm={searchTerm}\r\n            setSearchTerm={setSearchTerm}\r\n            selectedCategory={selectedCategory}\r\n            setSelectedCategory={setSelectedCategory}\r\n            dateFilter={dateFilter}\r\n            setDateFilter={setDateFilter}\r\n            dateRange={dateRange}\r\n            setDateRange={setDateRange}\r\n            validCategories={validCategories}\r\n            filteredCustomers={filteredCustomers}\r\n            customerStats={customerStats}\r\n            getCategoryName={getCategoryName}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content Area */}\r\n      <div className=\"p-8\">\r\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\r\n          <TabsContent value=\"list\" className=\"mt-0\">\r\n            <CustomerList\r\n              customers={filteredCustomers}\r\n              isLoading={false}\r\n              onSelectCustomer={onSelectCustomer}\r\n              onEditCustomer={onEditCustomer}\r\n              onDeleteCustomer={onDeleteCustomer}\r\n              canEdit={canEdit}\r\n              canDelete={canDelete}\r\n            />\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"top\" className=\"mt-0\">\r\n            <TopCustomersList\r\n              selectedCategory={selectedCategory}\r\n              dateFilter={dateFilter}\r\n              dateRange={dateRange}\r\n            />\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"inactive\" className=\"mt-0\">\r\n            <InactiveCustomersList\r\n              customers={customers}\r\n              isLoading={false}\r\n              onSelectCustomer={onSelectCustomer}\r\n              selectedCategory={selectedCategory}\r\n            />\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"details\" className=\"mt-0\">\r\n            {selectedCustomer && (\r\n              <CustomerDetail\r\n                customer={selectedCustomer}\r\n                onUpdate={async (data) => {\r\n                  const success = await onUpdateCustomer(selectedCustomer.id, data);\r\n                  return success;\r\n                }}\r\n                onDelete={async () => {\r\n                  const success = await onDeleteCustomer(selectedCustomer.id);\r\n                  if (success) {\r\n                    setSelectedCustomer(null);\r\n                    setActiveTab('list');\r\n                  }\r\n                  return success;\r\n                }}\r\n                canEdit={canEdit}\r\n                canDelete={canDelete}\r\n              />\r\n            )}\r\n          </TabsContent>\r\n\r\n        </Tabs>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CustomerContent;"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AAgCA,MAAM,kBAAkD,CAAC,EACvD,SAAS,EACT,YAAY,EACZ,gBAAgB,EAChB,UAAU,EACV,aAAa,EACb,gBAAgB,EAChB,mBAAmB,EACnB,UAAU,EACV,aAAa,EACb,SAAS,EACT,YAAY,EACZ,eAAe,EACf,iBAAiB,EACjB,SAAS,EACT,aAAa,EACb,eAAe,EACf,gBAAgB,EAChB,cAAc,EACd,gBAAgB,EAChB,gBAAgB,EAChB,mBAAmB,EACnB,YAAY,IAAI,EAChB,UAAU,IAAI,EACd,YAAY,IAAI,EACjB;IACC,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCAEb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;;sDACC,6LAAC;4CAAG,WAAU;sDAAwC;;;;;;sDACtD,6LAAC;4CAAE,WAAU;sDAAwB;;;;;;;;;;;;8CAGvC,6LAAC,2IAAI;oCAAC,OAAO;oCAAW,eAAe;oCAAc,WAAU;8CAC7D,cAAA,6LAAC,6JAAY;wCAAC,WAAW;wCAAW,kBAAkB;;;;;;;;;;;;;;;;;sCAK1D,6LAAC,gKAAe;4BACd,WAAW;4BACX,YAAY;4BACZ,eAAe;4BACf,kBAAkB;4BAClB,qBAAqB;4BACrB,YAAY;4BACZ,eAAe;4BACf,WAAW;4BACX,cAAc;4BACd,iBAAiB;4BACjB,mBAAmB;4BACnB,eAAe;4BACf,iBAAiB;;;;;;;;;;;;;;;;;0BAMvB,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,2IAAI;oBAAC,OAAO;oBAAW,eAAe;oBAAc,WAAU;;sCAC7D,6LAAC,kJAAW;4BAAC,OAAM;4BAAO,WAAU;sCAClC,cAAA,6LAAC,6JAAY;gCACX,WAAW;gCACX,WAAW;gCACX,kBAAkB;gCAClB,gBAAgB;gCAChB,kBAAkB;gCAClB,SAAS;gCACT,WAAW;;;;;;;;;;;sCAIf,6LAAC,kJAAW;4BAAC,OAAM;4BAAM,WAAU;sCACjC,cAAA,6LAAC,iKAAgB;gCACf,kBAAkB;gCAClB,YAAY;gCACZ,WAAW;;;;;;;;;;;sCAIf,6LAAC,kJAAW;4BAAC,OAAM;4BAAW,WAAU;sCACtC,cAAA,6LAAC,sKAAqB;gCACpB,WAAW;gCACX,WAAW;gCACX,kBAAkB;gCAClB,kBAAkB;;;;;;;;;;;sCAItB,6LAAC,kJAAW;4BAAC,OAAM;4BAAU,WAAU;sCACpC,kCACC,6LAAC,+JAAc;gCACb,UAAU;gCACV,UAAU,OAAO;oCACf,MAAM,UAAU,MAAM,iBAAiB,iBAAiB,EAAE,EAAE;oCAC5D,OAAO;gCACT;gCACA,UAAU;oCACR,MAAM,UAAU,MAAM,iBAAiB,iBAAiB,EAAE;oCAC1D,IAAI,SAAS;wCACX,oBAAoB;wCACpB,aAAa;oCACf;oCACA,OAAO;gCACT;gCACA,SAAS;gCACT,WAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAS3B;KAvHM;uCAyHS"}},
    {"offset": {"line": 10554, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/BirthdayCard.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { format } from 'date-fns';\r\nimport { Customer } from '@/types';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Cake, MessageSquare } from 'lucide-react';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { canSendSMS, getBirthdayMessage, openSMSApp, openWhatsApp, formatMessageForSMS } from '@/utils/smsUtils';\r\n\r\ninterface BirthdayCardProps {\r\n  customers: Customer[];\r\n}\r\n\r\nconst BirthdayCard: React.FC<BirthdayCardProps> = ({ customers }) => {\r\n  const currentMonth = new Date().getMonth();\r\n  const isMobile = useIsMobile();\r\n  const { settings } = useBusinessSettings();\r\n  const { toast } = useToast();\r\n  \r\n  // Filter customers with birthdays in the current month\r\n  const birthdayCustomers = customers.filter(customer => \r\n    customer.birthday && customer.birthday.getMonth() === currentMonth\r\n  );\r\n  \r\n  // Birthday email template\r\n  const birthdayMessage = \"ðŸŽ‰ Happy Birthday! ðŸŽ‰\\nWishing you a day filled with joy, love, and great memories. Thank you for being a valued part of our Family. We're grateful for your support and wish you nothing but happiness in the year ahead!\";\r\n  \r\n  const handleSendBirthdayWishes = (customer: Customer, method: 'sms' | 'whatsapp') => {\r\n    if (!canSendSMS(customer)) {\r\n      toast({\r\n        title: \"Phone number required\",\r\n        description: \"Customer phone number is not available.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const birthdayMessage = getBirthdayMessage(customer.fullName);\r\n      const formattedMessage = formatMessageForSMS(birthdayMessage, settings.businessName);\r\n      \r\n      if (method === 'sms') {\r\n        openSMSApp({\r\n          phoneNumber: customer.phoneNumber!,\r\n          message: formattedMessage\r\n        });\r\n        toast({\r\n          title: \"SMS app opened\",\r\n          description: \"Birthday wishes prepared in SMS app.\",\r\n        });\r\n      } else {\r\n        openWhatsApp({\r\n          phoneNumber: customer.phoneNumber!,\r\n          message: formattedMessage\r\n        });\r\n        toast({\r\n          title: \"WhatsApp opened\",\r\n          description: \"Birthday wishes prepared in WhatsApp.\",\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error sending birthday wishes:', error);\r\n      toast({\r\n        title: \"Failed to send\",\r\n        description: \"Failed to open messaging app. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader className=\"pb-3\">\r\n        <CardTitle className=\"flex items-center gap-2 text-lg font-medium\">\r\n          <Cake className=\"h-5 w-5 text-blue-500\" />\r\n          <span>This Month's Birthdays</span>\r\n          {birthdayCustomers.length > 0 && (\r\n            <Badge variant=\"secondary\" className=\"ml-2\">\r\n              {birthdayCustomers.length}\r\n            </Badge>\r\n          )}\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent>\r\n        {birthdayCustomers.length > 0 ? (\r\n          <ul className=\"space-y-3\">\r\n            {birthdayCustomers.map(customer => (\r\n              <li key={customer.id} className=\"flex items-center justify-between border-b pb-3\">\r\n                <div>\r\n                  <p className=\"font-medium\">{customer.fullName}</p>\r\n                  <p className=\"text-sm text-gray-500\">\r\n                    {customer.birthday && format(customer.birthday, 'MMMM d')}\r\n                  </p>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  {customer.email && (\r\n                    <a \r\n                      href={`mailto:${customer.email}?subject=Happy Birthday!&body=${encodeURIComponent(birthdayMessage)}`}\r\n                      className=\"text-sm text-blue-500 hover:underline\"\r\n                    >\r\n                      Send email\r\n                    </a>\r\n                  )}\r\n                  {canSendSMS(customer) && isMobile && (\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"outline\"\r\n                      onClick={() => handleSendBirthdayWishes(customer, 'sms')}\r\n                      className=\"text-xs\"\r\n                    >\r\n                      <MessageSquare className=\"h-3 w-3 mr-1\" />\r\n                      SMS\r\n                    </Button>\r\n                  )}\r\n                  {canSendSMS(customer) && (\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"outline\"\r\n                      onClick={() => handleSendBirthdayWishes(customer, 'whatsapp')}\r\n                      className=\"text-xs border-green-500 text-green-700 hover:bg-green-50\"\r\n                    >\r\n                      ðŸ“± WhatsApp\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        ) : (\r\n          <p className=\"text-sm text-gray-500\">No birthdays this month</p>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default BirthdayCard;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10798, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/CustomerCategoryManager.tsx"],"sourcesContent":["\r\nimport React, { useState } from 'react';\r\nimport { useCustomerCategories } from '@/hooks/useCustomerCategories';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n  AlertDialogTrigger,\r\n} from '@/components/ui/alert-dialog';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Plus, Edit, Trash2, Settings } from 'lucide-react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\n\r\nconst CustomerCategoryManager: React.FC = () => {\r\n  const { categories, isLoading, createCategory, updateCategory, deleteCategory } = useCustomerCategories();\r\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\r\n  const [newCategoryName, setNewCategoryName] = useState('');\r\n  const [editingCategory, setEditingCategory] = useState<{ id: string; name: string } | null>(null);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  const handleCreateCategory = async () => {\r\n    if (!newCategoryName.trim()) return;\r\n    \r\n    setIsSubmitting(true);\r\n    const success = await createCategory(newCategoryName);\r\n    if (success) {\r\n      setNewCategoryName('');\r\n      setIsDialogOpen(false);\r\n    }\r\n    setIsSubmitting(false);\r\n  };\r\n\r\n  const handleUpdateCategory = async () => {\r\n    if (!editingCategory || !editingCategory.name.trim()) return;\r\n    \r\n    setIsSubmitting(true);\r\n    const success = await updateCategory(editingCategory.id, editingCategory.name);\r\n    if (success) {\r\n      setEditingCategory(null);\r\n    }\r\n    setIsSubmitting(false);\r\n  };\r\n\r\n  const handleDeleteCategory = async (id: string) => {\r\n    await deleteCategory(id);\r\n  };\r\n\r\n  if (isLoading) {\r\n    return <div>Loading categories...</div>;\r\n  }\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center gap-2\">\r\n          <Settings className=\"h-5 w-5\" />\r\n          Manage Categories\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">\r\n        <div className=\"flex flex-wrap gap-2\">\r\n          {categories.map((category) => (\r\n            <div key={category.id} className=\"flex items-center gap-2 p-2 border rounded-lg\">\r\n              <Badge variant={category.isDefault ? \"default\" : \"secondary\"}>\r\n                {category.name}\r\n              </Badge>\r\n              <div className=\"flex gap-1\">\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={() => setEditingCategory({ id: category.id, name: category.name })}\r\n                  className=\"h-6 w-6 p-0\"\r\n                >\r\n                  <Edit className=\"h-3 w-3\" />\r\n                </Button>\r\n                <AlertDialog>\r\n                  <AlertDialogTrigger asChild>\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      className=\"h-6 w-6 p-0 text-red-600\"\r\n                    >\r\n                      <Trash2 className=\"h-3 w-3\" />\r\n                    </Button>\r\n                  </AlertDialogTrigger>\r\n                  <AlertDialogContent>\r\n                    <AlertDialogHeader>\r\n                      <AlertDialogTitle>Delete Category</AlertDialogTitle>\r\n                      <AlertDialogDescription>\r\n                        Are you sure you want to delete the \"{category.name}\" category?\r\n                        This action cannot be undone.\r\n                      </AlertDialogDescription>\r\n                    </AlertDialogHeader>\r\n                    <AlertDialogFooter>\r\n                      <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n                      <AlertDialogAction onClick={() => handleDeleteCategory(category.id)}>\r\n                        Delete\r\n                      </AlertDialogAction>\r\n                    </AlertDialogFooter>\r\n                  </AlertDialogContent>\r\n                </AlertDialog>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\r\n          <DialogTrigger asChild>\r\n            <Button variant=\"outline\" className=\"gap-2\">\r\n              <Plus className=\"h-4 w-4\" />\r\n              Add Category\r\n            </Button>\r\n          </DialogTrigger>\r\n          <DialogContent>\r\n            <DialogHeader>\r\n              <DialogTitle>Add New Category</DialogTitle>\r\n              <DialogDescription>\r\n                Create a new customer category to organize your customers.\r\n              </DialogDescription>\r\n            </DialogHeader>\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <Label htmlFor=\"categoryName\">Category Name</Label>\r\n                <Input\r\n                  id=\"categoryName\"\r\n                  value={newCategoryName}\r\n                  onChange={(e) => setNewCategoryName(e.target.value)}\r\n                  placeholder=\"Enter category name\"\r\n                />\r\n              </div>\r\n              <div className=\"flex justify-end gap-2\">\r\n                <Button variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\r\n                  Cancel\r\n                </Button>\r\n                <Button \r\n                  onClick={handleCreateCategory}\r\n                  disabled={!newCategoryName.trim() || isSubmitting}\r\n                >\r\n                  {isSubmitting ? 'Creating...' : 'Create'}\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </DialogContent>\r\n        </Dialog>\r\n\r\n        {editingCategory && (\r\n          <Dialog open={!!editingCategory} onOpenChange={() => setEditingCategory(null)}>\r\n            <DialogContent>\r\n              <DialogHeader>\r\n                <DialogTitle>Edit Category</DialogTitle>\r\n                <DialogDescription>\r\n                  Update the category name.\r\n                </DialogDescription>\r\n              </DialogHeader>\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <Label htmlFor=\"editCategoryName\">Category Name</Label>\r\n                  <Input\r\n                    id=\"editCategoryName\"\r\n                    value={editingCategory.name}\r\n                    onChange={(e) => setEditingCategory({ ...editingCategory, name: e.target.value })}\r\n                    placeholder=\"Enter category name\"\r\n                  />\r\n                </div>\r\n                <div className=\"flex justify-end gap-2\">\r\n                  <Button variant=\"outline\" onClick={() => setEditingCategory(null)}>\r\n                    Cancel\r\n                  </Button>\r\n                  <Button \r\n                    onClick={handleUpdateCategory}\r\n                    disabled={!editingCategory.name.trim() || isSubmitting}\r\n                  >\r\n                    {isSubmitting ? 'Updating...' : 'Update'}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </DialogContent>\r\n          </Dialog>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default CustomerCategoryManager;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 11294, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/NewCustomerDialog.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { \r\n  Dialog, \r\n  DialogContent, \r\n  DialogDescription, \r\n  DialogHeader, \r\n  DialogTitle \r\n} from '@/components/ui/dialog';\r\nimport { Customer } from '@/types';\r\nimport CustomerForm from './CustomerForm';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\n\r\ninterface NewCustomerDialogProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  onAddCustomer: (data: Partial<Customer>) => void;\r\n  initialData?: Customer;\r\n}\r\n\r\nconst NewCustomerDialog: React.FC<NewCustomerDialogProps> = ({ \r\n  open, \r\n  onClose, \r\n  onAddCustomer, \r\n  initialData \r\n}) => {\r\n  const handleSubmit = async (data: Partial<Customer>) => {\r\n    onAddCustomer(data);\r\n    return true;\r\n  };\r\n\r\n  const isEditing = !!initialData;\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onClose}>\r\n      <DialogContent className=\"max-w-2xl max-h-[90vh]\">\r\n        <DialogHeader>\r\n          <DialogTitle>{isEditing ? 'Edit Customer' : 'Add New Customer'}</DialogTitle>\r\n          <DialogDescription>\r\n            Fill in the customer details below. Only name is required.\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n        <ScrollArea className=\"h-[calc(80vh-8rem)]\">\r\n          <div className=\"px-1\">\r\n            <CustomerForm \r\n              onSubmit={handleSubmit}\r\n              onCancel={onClose}\r\n              initialData={initialData}\r\n            />\r\n          </div>\r\n        </ScrollArea>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default NewCustomerDialog;\r\n"],"names":[],"mappings":";;;;;AAEA;AAQA;AACA;;;;;AASA,MAAM,oBAAsD,CAAC,EAC3D,IAAI,EACJ,OAAO,EACP,aAAa,EACb,WAAW,EACZ;IACC,MAAM,eAAe,OAAO;QAC1B,cAAc;QACd,OAAO;IACT;IAEA,MAAM,YAAY,CAAC,CAAC;IAEpB,qBACE,6LAAC,+IAAM;QAAC,MAAM;QAAM,cAAc;kBAChC,cAAA,6LAAC,sJAAa;YAAC,WAAU;;8BACvB,6LAAC,qJAAY;;sCACX,6LAAC,oJAAW;sCAAE,YAAY,kBAAkB;;;;;;sCAC5C,6LAAC,0JAAiB;sCAAC;;;;;;;;;;;;8BAIrB,6LAAC,2JAAU;oBAAC,WAAU;8BACpB,cAAA,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,6JAAY;4BACX,UAAU;4BACV,UAAU;4BACV,aAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO3B;KAlCM;uCAoCS"}},
    {"offset": {"line": 11386, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/customers/MergeCustomersDialog.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Label } from '@/components/ui/label';\r\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { AlertCircle, Users, TrendingUp } from 'lucide-react';\r\nimport { Customer } from '@/hooks/useCustomers';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { toast } from 'sonner';\r\n\r\ninterface MergeCustomersDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  customers: Customer[];\r\n  onMergeComplete: () => void;\r\n}\r\n\r\nconst MergeCustomersDialog: React.FC<MergeCustomersDialogProps> = ({\r\n  open,\r\n  onOpenChange,\r\n  customers,\r\n  onMergeComplete\r\n}) => {\r\n  const [primaryCustomerId, setPrimaryCustomerId] = useState<string>(customers[0]?.id || '');\r\n  const [isMerging, setIsMerging] = useState(false);\r\n\r\n  const handleMerge = async () => {\r\n    if (!primaryCustomerId || customers.length < 2) return;\r\n\r\n    setIsMerging(true);\r\n    try {\r\n      const primaryCustomer = customers.find(c => c.id === primaryCustomerId);\r\n      const duplicateIds = customers.filter(c => c.id !== primaryCustomerId).map(c => c.id);\r\n\r\n      if (!primaryCustomer || duplicateIds.length === 0) {\r\n        throw new Error('Invalid selection');\r\n      }\r\n\r\n      // Update all related tables to point to the primary customer\r\n      \r\n      // 1. Update sales\r\n      const { error: salesError } = await supabase\r\n        .from('sales')\r\n        .update({ customer_id: primaryCustomerId })\r\n        .in('customer_id', duplicateIds);\r\n\r\n      if (salesError) {\r\n        console.error('Error updating sales:', salesError);\r\n        throw salesError;\r\n      }\r\n\r\n      // 2. Update messages (if they exist)\r\n      const { error: messagesError } = await supabase\r\n        .from('messages')\r\n        .update({ customer_id: primaryCustomerId })\r\n        .in('customer_id', duplicateIds);\r\n\r\n      if (messagesError && messagesError.code !== 'PGRST116') { // Ignore \"not found\" errors\r\n        console.error('Error updating messages:', messagesError);\r\n        throw messagesError;\r\n      }\r\n\r\n      // 3. Delete duplicate customers\r\n      const { error: deleteError } = await supabase\r\n        .from('customers')\r\n        .delete()\r\n        .in('id', duplicateIds);\r\n\r\n      if (deleteError) {\r\n        console.error('Error deleting customers:', deleteError);\r\n        throw deleteError;\r\n      }\r\n\r\n      toast.success(`Successfully merged ${duplicateIds.length} duplicate customer${duplicateIds.length > 1 ? 's' : ''} into ${primaryCustomer.fullName}`);\r\n      onMergeComplete();\r\n      onOpenChange(false);\r\n    } catch (error: any) {\r\n      console.error('Error merging customers:', error);\r\n      const errorMessage = error?.message || error?.details || 'Failed to merge customers';\r\n      toast.error(`Merge failed: ${errorMessage}`);\r\n    } finally {\r\n      setIsMerging(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <Users className=\"h-5 w-5\" />\r\n            Merge Duplicate Customers\r\n          </DialogTitle>\r\n          <DialogDescription>\r\n            Select which customer record to keep. All sales from duplicates will be transferred to the primary customer.\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4\">\r\n          <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-start gap-2\">\r\n            <AlertCircle className=\"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5\" />\r\n            <div className=\"text-sm text-amber-800\">\r\n              <p className=\"font-semibold mb-1\">This action cannot be undone</p>\r\n              <p>Duplicate customers will be permanently deleted, and all their sales will be transferred to the primary customer.</p>\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <Label className=\"text-base font-semibold mb-3 block\">Select Primary Customer (to keep):</Label>\r\n            <RadioGroup value={primaryCustomerId} onValueChange={setPrimaryCustomerId}>\r\n              <div className=\"space-y-3\">\r\n                {customers.map((customer) => (\r\n                  <Card key={customer.id} className={`cursor-pointer transition-all ${primaryCustomerId === customer.id ? 'border-primary border-2 bg-primary/5' : 'hover:border-gray-300'}`}>\r\n                    <CardContent className=\"p-4\">\r\n                      <div className=\"flex items-start gap-3\">\r\n                        <RadioGroupItem value={customer.id} id={customer.id} className=\"mt-1\" />\r\n                        <label htmlFor={customer.id} className=\"flex-1 cursor-pointer\">\r\n                          <div className=\"flex items-start justify-between\">\r\n                            <div className=\"flex-1\">\r\n                              <div className=\"font-semibold text-base\">{customer.fullName}</div>\r\n                              <div className=\"space-y-1 mt-2 text-sm text-muted-foreground\">\r\n                                {customer.phoneNumber && (\r\n                                  <div>Phone: {customer.phoneNumber}</div>\r\n                                )}\r\n                                {customer.email && (\r\n                                  <div>Email: {customer.email}</div>\r\n                                )}\r\n                                {customer.location && (\r\n                                  <div>Location: {customer.location}</div>\r\n                                )}\r\n                                <div>Created: {customer.createdAt.toLocaleDateString()}</div>\r\n                              </div>\r\n                            </div>\r\n                            {primaryCustomerId === customer.id && (\r\n                              <Badge className=\"bg-primary\">Primary</Badge>\r\n                            )}\r\n                          </div>\r\n                        </label>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                ))}\r\n              </div>\r\n            </RadioGroup>\r\n          </div>\r\n\r\n          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3 flex items-start gap-2\">\r\n            <TrendingUp className=\"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5\" />\r\n            <div className=\"text-sm text-blue-800\">\r\n              <p className=\"font-semibold mb-1\">After merging:</p>\r\n              <ul className=\"list-disc list-inside space-y-1 ml-2\">\r\n                <li>All sales will be linked to the primary customer</li>\r\n                <li>Duplicate customer records will be deleted</li>\r\n                <li>Sales history will be preserved</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)} disabled={isMerging}>\r\n            Cancel\r\n          </Button>\r\n          <Button onClick={handleMerge} disabled={isMerging || !primaryCustomerId}>\r\n            {isMerging ? 'Merging...' : `Merge ${customers.length} Customers`}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default MergeCustomersDialog;\r\n"],"names":[],"mappings":"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"}}]
}