{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/finance.ts"],"sourcesContent":["'use server';\r\n\r\nimport { db, PaymentStatus, ActivityType, ActivityModule } from '../../../prisma/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// --- EXPENSES ---\r\n\r\nexport interface ExpenseInput {\r\n    amount: number;\r\n    description: string;\r\n    category?: string;\r\n    date: Date;\r\n    paymentMethod?: string;\r\n    personInCharge?: string;\r\n    receiptImage?: string;\r\n    cashAccountId?: string;\r\n    userId: string;\r\n    locationId: string;\r\n}\r\n\r\nexport async function createExpenseAction(data: ExpenseInput, linkToCash: boolean) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            // 1. Create the expense\r\n            const expense = await tx.expense.create({\r\n                data: {\r\n                    userId: data.userId,\r\n                    locationId: data.locationId,\r\n                    amount: data.amount,\r\n                    description: data.description,\r\n                    category: data.category || null,\r\n                    date: data.date,\r\n                    paymentMethod: data.paymentMethod || null,\r\n                    personInCharge: data.personInCharge || null,\r\n                    receiptImage: data.receiptImage || null,\r\n                    cashAccountId: linkToCash && data.cashAccountId ? data.cashAccountId : null\r\n                }\r\n            });\r\n\r\n            // 2. If linking to cash, create a cash transaction\r\n            if (linkToCash && data.cashAccountId) {\r\n                const cashTx = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.cashAccountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'cash_out',\r\n                        category: data.category || 'Expense',\r\n                        description: `Expense: ${data.description}`,\r\n                        personInCharge: data.personInCharge || null,\r\n                        date: data.date,\r\n                        paymentMethod: data.paymentMethod || null,\r\n                        receiptImage: data.receiptImage || null\r\n                    }\r\n                });\r\n\r\n                // Update expense with transaction reference\r\n                await tx.expense.update({\r\n                    where: { id: expense.id },\r\n                    data: { cashTransactionId: cashTx.id }\r\n                });\r\n            }\r\n\r\n            return expense;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getExpensesAction(locationId: string) {\r\n    try {\r\n        const expenses = await db.expense.findMany({\r\n            where: { locationId },\r\n            orderBy: { date: 'desc' }\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: expenses.map(e => ({\r\n                ...e,\r\n                created_at: e.createdAt.toISOString(),\r\n                updated_at: e.updatedAt.toISOString(),\r\n                payment_method: e.paymentMethod,\r\n                person_in_charge: e.personInCharge,\r\n                receipt_image: e.receiptImage,\r\n                cash_account_id: e.cashAccountId,\r\n                cash_transaction_id: e.cashTransactionId\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching expenses:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function updateExpenseAction(id: string, updates: any, currentExpense: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            // Update expense\r\n            const updatedExpense = await tx.expense.update({\r\n                where: { id },\r\n                data: {\r\n                    amount: updates.amount,\r\n                    description: updates.description,\r\n                    category: updates.category,\r\n                    date: updates.date,\r\n                    paymentMethod: updates.paymentMethod,\r\n                    personInCharge: updates.personInCharge,\r\n                    receiptImage: updates.receiptImage,\r\n                    cashAccountId: updates.cashAccountId || null\r\n                }\r\n            });\r\n\r\n            const shouldLinkToCash = !!updates.cashAccountId;\r\n            const wasLinkedToCash = !!currentExpense.cashTransactionId;\r\n\r\n            if (shouldLinkToCash && !wasLinkedToCash) {\r\n                // Create new cash transaction\r\n                const cashTx = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: currentExpense.userId,\r\n                        locationId: currentExpense.locationId,\r\n                        accountId: updates.cashAccountId,\r\n                        amount: updates.amount || currentExpense.amount,\r\n                        transactionType: 'cash_out',\r\n                        category: updates.category || currentExpense.category || 'Expense',\r\n                        description: `Expense: ${updates.description || currentExpense.description}`,\r\n                        personInCharge: updates.personInCharge || currentExpense.personInCharge || null,\r\n                        date: updates.date || currentExpense.date,\r\n                        paymentMethod: updates.paymentMethod || currentExpense.paymentMethod || null,\r\n                        receiptImage: updates.receiptImage || currentExpense.receiptImage || null\r\n                    }\r\n                });\r\n                await tx.expense.update({\r\n                    where: { id },\r\n                    data: { cashTransactionId: cashTx.id }\r\n                });\r\n            } else if (shouldLinkToCash && wasLinkedToCash) {\r\n                // Update existing cash transaction\r\n                await tx.cashTransaction.update({\r\n                    where: { id: currentExpense.cashTransactionId },\r\n                    data: {\r\n                        accountId: updates.cashAccountId,\r\n                        amount: updates.amount || currentExpense.amount,\r\n                        category: updates.category || currentExpense.category || 'Expense',\r\n                        description: `Expense: ${updates.description || currentExpense.description}`,\r\n                        personInCharge: updates.personInCharge || currentExpense.personInCharge || null,\r\n                        date: updates.date || currentExpense.date,\r\n                        paymentMethod: updates.paymentMethod || currentExpense.paymentMethod || null,\r\n                        receiptImage: updates.receiptImage || currentExpense.receiptImage || null\r\n                    }\r\n                });\r\n            } else if (!shouldLinkToCash && wasLinkedToCash) {\r\n                // Delete existing cash transaction\r\n                await tx.cashTransaction.delete({\r\n                    where: { id: currentExpense.cashTransactionId }\r\n                });\r\n                await tx.expense.update({\r\n                    where: { id },\r\n                    data: { cashTransactionId: null }\r\n                });\r\n            }\r\n\r\n            return updatedExpense;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error updating expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteExpenseAction(id: string) {\r\n    try {\r\n        await db.$transaction(async (tx) => {\r\n            const expense = await tx.expense.findUnique({\r\n                where: { id },\r\n                select: { cashTransactionId: true }\r\n            });\r\n\r\n            if (expense?.cashTransactionId) {\r\n                await tx.cashTransaction.delete({\r\n                    where: { id: expense.cashTransactionId }\r\n                });\r\n            }\r\n\r\n            await tx.expense.delete({\r\n                where: { id }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n// --- CASH TRANSACTIONS ---\r\n\r\nexport async function getCashTransactionsAction(locationId: string, accountId?: string) {\r\n    try {\r\n        const where: any = { locationId };\r\n        if (accountId) where.accountId = accountId;\r\n\r\n        const transactions = await db.cashTransaction.findMany({\r\n            where,\r\n            orderBy: [{ date: 'desc' }, { createdAt: 'desc' }]\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: transactions.map(t => ({\r\n                ...t,\r\n                created_at: t.createdAt.toISOString(),\r\n                updated_at: t.updatedAt.toISOString(),\r\n                user_id: t.userId,\r\n                account_id: t.accountId,\r\n                location_id: t.locationId,\r\n                transaction_type: t.transactionType,\r\n                person_in_charge: t.personInCharge,\r\n                payment_method: t.paymentMethod,\r\n                receipt_image: t.receiptImage\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching cash transactions:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createCashTransactionAction(data: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            if (data.transactionType === 'transfer' && data.toAccountId) {\r\n                // Create two transactions for a transfer\r\n                const txOut = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.accountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'transfer_out',\r\n                        description: data.description,\r\n                        date: data.date,\r\n                        category: data.category || 'Transfer'\r\n                    }\r\n                });\r\n\r\n                const txIn = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.toAccountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'transfer_in',\r\n                        description: data.description,\r\n                        date: data.date,\r\n                        category: data.category || 'Transfer'\r\n                    }\r\n                });\r\n\r\n                return [txOut, txIn];\r\n            } else {\r\n                const transaction = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.accountId,\r\n                        amount: data.amount,\r\n                        transactionType: data.transactionType,\r\n                        category: data.category,\r\n                        description: data.description,\r\n                        person_in_charge: data.personInCharge,\r\n                        tags: data.tags,\r\n                        date: data.date,\r\n                        paymentMethod: data.paymentMethod,\r\n                        receiptImage: data.receiptImage\r\n                    }\r\n                });\r\n                return transaction;\r\n            }\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating cash transaction:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteCashTransactionAction(id: string, locationId: string) {\r\n    try {\r\n        await db.$transaction(async (tx) => {\r\n            // Check for installment payments linked to this transaction\r\n            await tx.installmentPayment.updateMany({\r\n                where: { cashTransactionId: id },\r\n                data: { cashTransactionId: null }\r\n            });\r\n\r\n            await tx.cashTransaction.delete({\r\n                where: { id, locationId }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting cash transaction:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getAccountOpeningBalanceAction(accountId: string, locationId: string) {\r\n    try {\r\n        const account = await db.cashAccount.findFirst({\r\n            where: { id: accountId, locationId },\r\n            select: { openingBalance: true }\r\n        });\r\n\r\n        return { success: true, data: Number(account?.openingBalance || 0) };\r\n    } catch (error: any) {\r\n        console.error('Error fetching opening balance:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createBulkCashTransactionsAction(transactions: any[]) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            const created = [];\r\n            for (const data of transactions) {\r\n                if (data.transactionType === 'transfer' && data.toAccountId) {\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            locationId: data.locationId,\r\n                            accountId: data.accountId,\r\n                            amount: data.amount,\r\n                            transactionType: 'transfer_out',\r\n                            description: data.description,\r\n                            date: data.date,\r\n                            category: data.category || 'Transfer'\r\n                        }\r\n                    }));\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            locationId: data.locationId,\r\n                            accountId: data.toAccountId,\r\n                            amount: data.amount,\r\n                            transactionType: 'transfer_in',\r\n                            description: data.description,\r\n                            date: data.date,\r\n                            category: data.category || 'Transfer'\r\n                        }\r\n                    }));\r\n                } else {\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            locationId: data.locationId,\r\n                            accountId: data.accountId,\r\n                            amount: data.amount,\r\n                            transactionType: data.transactionType,\r\n                            category: data.category,\r\n                            description: data.description,\r\n                            person_in_charge: data.personInCharge,\r\n                            tags: data.tags,\r\n                            date: data.date,\r\n                            paymentMethod: data.paymentMethod,\r\n                            receiptImage: data.receiptImage\r\n                        }\r\n                    }));\r\n                }\r\n            }\r\n            return created;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating bulk transactions:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MA2EsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,qDAAA"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/finance.ts"],"sourcesContent":["'use server';\r\n\r\nimport { db, PaymentStatus, ActivityType, ActivityModule } from '../../../prisma/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// --- EXPENSES ---\r\n\r\nexport interface ExpenseInput {\r\n    amount: number;\r\n    description: string;\r\n    category?: string;\r\n    date: Date;\r\n    paymentMethod?: string;\r\n    personInCharge?: string;\r\n    receiptImage?: string;\r\n    cashAccountId?: string;\r\n    userId: string;\r\n    locationId: string;\r\n}\r\n\r\nexport async function createExpenseAction(data: ExpenseInput, linkToCash: boolean) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            // 1. Create the expense\r\n            const expense = await tx.expense.create({\r\n                data: {\r\n                    userId: data.userId,\r\n                    locationId: data.locationId,\r\n                    amount: data.amount,\r\n                    description: data.description,\r\n                    category: data.category || null,\r\n                    date: data.date,\r\n                    paymentMethod: data.paymentMethod || null,\r\n                    personInCharge: data.personInCharge || null,\r\n                    receiptImage: data.receiptImage || null,\r\n                    cashAccountId: linkToCash && data.cashAccountId ? data.cashAccountId : null\r\n                }\r\n            });\r\n\r\n            // 2. If linking to cash, create a cash transaction\r\n            if (linkToCash && data.cashAccountId) {\r\n                const cashTx = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.cashAccountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'cash_out',\r\n                        category: data.category || 'Expense',\r\n                        description: `Expense: ${data.description}`,\r\n                        personInCharge: data.personInCharge || null,\r\n                        date: data.date,\r\n                        paymentMethod: data.paymentMethod || null,\r\n                        receiptImage: data.receiptImage || null\r\n                    }\r\n                });\r\n\r\n                // Update expense with transaction reference\r\n                await tx.expense.update({\r\n                    where: { id: expense.id },\r\n                    data: { cashTransactionId: cashTx.id }\r\n                });\r\n            }\r\n\r\n            return expense;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getExpensesAction(locationId: string) {\r\n    try {\r\n        const expenses = await db.expense.findMany({\r\n            where: { locationId },\r\n            orderBy: { date: 'desc' }\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: expenses.map(e => ({\r\n                ...e,\r\n                created_at: e.createdAt.toISOString(),\r\n                updated_at: e.updatedAt.toISOString(),\r\n                payment_method: e.paymentMethod,\r\n                person_in_charge: e.personInCharge,\r\n                receipt_image: e.receiptImage,\r\n                cash_account_id: e.cashAccountId,\r\n                cash_transaction_id: e.cashTransactionId\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching expenses:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function updateExpenseAction(id: string, updates: any, currentExpense: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            // Update expense\r\n            const updatedExpense = await tx.expense.update({\r\n                where: { id },\r\n                data: {\r\n                    amount: updates.amount,\r\n                    description: updates.description,\r\n                    category: updates.category,\r\n                    date: updates.date,\r\n                    paymentMethod: updates.paymentMethod,\r\n                    personInCharge: updates.personInCharge,\r\n                    receiptImage: updates.receiptImage,\r\n                    cashAccountId: updates.cashAccountId || null\r\n                }\r\n            });\r\n\r\n            const shouldLinkToCash = !!updates.cashAccountId;\r\n            const wasLinkedToCash = !!currentExpense.cashTransactionId;\r\n\r\n            if (shouldLinkToCash && !wasLinkedToCash) {\r\n                // Create new cash transaction\r\n                const cashTx = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: currentExpense.userId,\r\n                        locationId: currentExpense.locationId,\r\n                        accountId: updates.cashAccountId,\r\n                        amount: updates.amount || currentExpense.amount,\r\n                        transactionType: 'cash_out',\r\n                        category: updates.category || currentExpense.category || 'Expense',\r\n                        description: `Expense: ${updates.description || currentExpense.description}`,\r\n                        personInCharge: updates.personInCharge || currentExpense.personInCharge || null,\r\n                        date: updates.date || currentExpense.date,\r\n                        paymentMethod: updates.paymentMethod || currentExpense.paymentMethod || null,\r\n                        receiptImage: updates.receiptImage || currentExpense.receiptImage || null\r\n                    }\r\n                });\r\n                await tx.expense.update({\r\n                    where: { id },\r\n                    data: { cashTransactionId: cashTx.id }\r\n                });\r\n            } else if (shouldLinkToCash && wasLinkedToCash) {\r\n                // Update existing cash transaction\r\n                await tx.cashTransaction.update({\r\n                    where: { id: currentExpense.cashTransactionId },\r\n                    data: {\r\n                        accountId: updates.cashAccountId,\r\n                        amount: updates.amount || currentExpense.amount,\r\n                        category: updates.category || currentExpense.category || 'Expense',\r\n                        description: `Expense: ${updates.description || currentExpense.description}`,\r\n                        personInCharge: updates.personInCharge || currentExpense.personInCharge || null,\r\n                        date: updates.date || currentExpense.date,\r\n                        paymentMethod: updates.paymentMethod || currentExpense.paymentMethod || null,\r\n                        receiptImage: updates.receiptImage || currentExpense.receiptImage || null\r\n                    }\r\n                });\r\n            } else if (!shouldLinkToCash && wasLinkedToCash) {\r\n                // Delete existing cash transaction\r\n                await tx.cashTransaction.delete({\r\n                    where: { id: currentExpense.cashTransactionId }\r\n                });\r\n                await tx.expense.update({\r\n                    where: { id },\r\n                    data: { cashTransactionId: null }\r\n                });\r\n            }\r\n\r\n            return updatedExpense;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error updating expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteExpenseAction(id: string) {\r\n    try {\r\n        await db.$transaction(async (tx) => {\r\n            const expense = await tx.expense.findUnique({\r\n                where: { id },\r\n                select: { cashTransactionId: true }\r\n            });\r\n\r\n            if (expense?.cashTransactionId) {\r\n                await tx.cashTransaction.delete({\r\n                    where: { id: expense.cashTransactionId }\r\n                });\r\n            }\r\n\r\n            await tx.expense.delete({\r\n                where: { id }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n// --- CASH TRANSACTIONS ---\r\n\r\nexport async function getCashTransactionsAction(locationId: string, accountId?: string) {\r\n    try {\r\n        const where: any = { locationId };\r\n        if (accountId) where.accountId = accountId;\r\n\r\n        const transactions = await db.cashTransaction.findMany({\r\n            where,\r\n            orderBy: [{ date: 'desc' }, { createdAt: 'desc' }]\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: transactions.map(t => ({\r\n                ...t,\r\n                created_at: t.createdAt.toISOString(),\r\n                updated_at: t.updatedAt.toISOString(),\r\n                user_id: t.userId,\r\n                account_id: t.accountId,\r\n                location_id: t.locationId,\r\n                transaction_type: t.transactionType,\r\n                person_in_charge: t.personInCharge,\r\n                payment_method: t.paymentMethod,\r\n                receipt_image: t.receiptImage\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching cash transactions:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createCashTransactionAction(data: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            if (data.transactionType === 'transfer' && data.toAccountId) {\r\n                // Create two transactions for a transfer\r\n                const txOut = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.accountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'transfer_out',\r\n                        description: data.description,\r\n                        date: data.date,\r\n                        category: data.category || 'Transfer'\r\n                    }\r\n                });\r\n\r\n                const txIn = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.toAccountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'transfer_in',\r\n                        description: data.description,\r\n                        date: data.date,\r\n                        category: data.category || 'Transfer'\r\n                    }\r\n                });\r\n\r\n                return [txOut, txIn];\r\n            } else {\r\n                const transaction = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.accountId,\r\n                        amount: data.amount,\r\n                        transactionType: data.transactionType,\r\n                        category: data.category,\r\n                        description: data.description,\r\n                        person_in_charge: data.personInCharge,\r\n                        tags: data.tags,\r\n                        date: data.date,\r\n                        paymentMethod: data.paymentMethod,\r\n                        receiptImage: data.receiptImage\r\n                    }\r\n                });\r\n                return transaction;\r\n            }\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating cash transaction:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteCashTransactionAction(id: string, locationId: string) {\r\n    try {\r\n        await db.$transaction(async (tx) => {\r\n            // Check for installment payments linked to this transaction\r\n            await tx.installmentPayment.updateMany({\r\n                where: { cashTransactionId: id },\r\n                data: { cashTransactionId: null }\r\n            });\r\n\r\n            await tx.cashTransaction.delete({\r\n                where: { id, locationId }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting cash transaction:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getAccountOpeningBalanceAction(accountId: string, locationId: string) {\r\n    try {\r\n        const account = await db.cashAccount.findFirst({\r\n            where: { id: accountId, locationId },\r\n            select: { openingBalance: true }\r\n        });\r\n\r\n        return { success: true, data: Number(account?.openingBalance || 0) };\r\n    } catch (error: any) {\r\n        console.error('Error fetching opening balance:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createBulkCashTransactionsAction(transactions: any[]) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            const created = [];\r\n            for (const data of transactions) {\r\n                if (data.transactionType === 'transfer' && data.toAccountId) {\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            locationId: data.locationId,\r\n                            accountId: data.accountId,\r\n                            amount: data.amount,\r\n                            transactionType: 'transfer_out',\r\n                            description: data.description,\r\n                            date: data.date,\r\n                            category: data.category || 'Transfer'\r\n                        }\r\n                    }));\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            locationId: data.locationId,\r\n                            accountId: data.toAccountId,\r\n                            amount: data.amount,\r\n                            transactionType: 'transfer_in',\r\n                            description: data.description,\r\n                            date: data.date,\r\n                            category: data.category || 'Transfer'\r\n                        }\r\n                    }));\r\n                } else {\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            locationId: data.locationId,\r\n                            accountId: data.accountId,\r\n                            amount: data.amount,\r\n                            transactionType: data.transactionType,\r\n                            category: data.category,\r\n                            description: data.description,\r\n                            person_in_charge: data.personInCharge,\r\n                            tags: data.tags,\r\n                            date: data.date,\r\n                            paymentMethod: data.paymentMethod,\r\n                            receiptImage: data.receiptImage\r\n                        }\r\n                    }));\r\n                }\r\n            }\r\n            return created;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating bulk transactions:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MAoBsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,uDAAA"}},
    {"offset": {"line": 38, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/finance.ts"],"sourcesContent":["'use server';\r\n\r\nimport { db, PaymentStatus, ActivityType, ActivityModule } from '../../../prisma/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// --- EXPENSES ---\r\n\r\nexport interface ExpenseInput {\r\n    amount: number;\r\n    description: string;\r\n    category?: string;\r\n    date: Date;\r\n    paymentMethod?: string;\r\n    personInCharge?: string;\r\n    receiptImage?: string;\r\n    cashAccountId?: string;\r\n    userId: string;\r\n    locationId: string;\r\n}\r\n\r\nexport async function createExpenseAction(data: ExpenseInput, linkToCash: boolean) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            // 1. Create the expense\r\n            const expense = await tx.expense.create({\r\n                data: {\r\n                    userId: data.userId,\r\n                    locationId: data.locationId,\r\n                    amount: data.amount,\r\n                    description: data.description,\r\n                    category: data.category || null,\r\n                    date: data.date,\r\n                    paymentMethod: data.paymentMethod || null,\r\n                    personInCharge: data.personInCharge || null,\r\n                    receiptImage: data.receiptImage || null,\r\n                    cashAccountId: linkToCash && data.cashAccountId ? data.cashAccountId : null\r\n                }\r\n            });\r\n\r\n            // 2. If linking to cash, create a cash transaction\r\n            if (linkToCash && data.cashAccountId) {\r\n                const cashTx = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.cashAccountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'cash_out',\r\n                        category: data.category || 'Expense',\r\n                        description: `Expense: ${data.description}`,\r\n                        personInCharge: data.personInCharge || null,\r\n                        date: data.date,\r\n                        paymentMethod: data.paymentMethod || null,\r\n                        receiptImage: data.receiptImage || null\r\n                    }\r\n                });\r\n\r\n                // Update expense with transaction reference\r\n                await tx.expense.update({\r\n                    where: { id: expense.id },\r\n                    data: { cashTransactionId: cashTx.id }\r\n                });\r\n            }\r\n\r\n            return expense;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getExpensesAction(locationId: string) {\r\n    try {\r\n        const expenses = await db.expense.findMany({\r\n            where: { locationId },\r\n            orderBy: { date: 'desc' }\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: expenses.map(e => ({\r\n                ...e,\r\n                created_at: e.createdAt.toISOString(),\r\n                updated_at: e.updatedAt.toISOString(),\r\n                payment_method: e.paymentMethod,\r\n                person_in_charge: e.personInCharge,\r\n                receipt_image: e.receiptImage,\r\n                cash_account_id: e.cashAccountId,\r\n                cash_transaction_id: e.cashTransactionId\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching expenses:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function updateExpenseAction(id: string, updates: any, currentExpense: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            // Update expense\r\n            const updatedExpense = await tx.expense.update({\r\n                where: { id },\r\n                data: {\r\n                    amount: updates.amount,\r\n                    description: updates.description,\r\n                    category: updates.category,\r\n                    date: updates.date,\r\n                    paymentMethod: updates.paymentMethod,\r\n                    personInCharge: updates.personInCharge,\r\n                    receiptImage: updates.receiptImage,\r\n                    cashAccountId: updates.cashAccountId || null\r\n                }\r\n            });\r\n\r\n            const shouldLinkToCash = !!updates.cashAccountId;\r\n            const wasLinkedToCash = !!currentExpense.cashTransactionId;\r\n\r\n            if (shouldLinkToCash && !wasLinkedToCash) {\r\n                // Create new cash transaction\r\n                const cashTx = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: currentExpense.userId,\r\n                        locationId: currentExpense.locationId,\r\n                        accountId: updates.cashAccountId,\r\n                        amount: updates.amount || currentExpense.amount,\r\n                        transactionType: 'cash_out',\r\n                        category: updates.category || currentExpense.category || 'Expense',\r\n                        description: `Expense: ${updates.description || currentExpense.description}`,\r\n                        personInCharge: updates.personInCharge || currentExpense.personInCharge || null,\r\n                        date: updates.date || currentExpense.date,\r\n                        paymentMethod: updates.paymentMethod || currentExpense.paymentMethod || null,\r\n                        receiptImage: updates.receiptImage || currentExpense.receiptImage || null\r\n                    }\r\n                });\r\n                await tx.expense.update({\r\n                    where: { id },\r\n                    data: { cashTransactionId: cashTx.id }\r\n                });\r\n            } else if (shouldLinkToCash && wasLinkedToCash) {\r\n                // Update existing cash transaction\r\n                await tx.cashTransaction.update({\r\n                    where: { id: currentExpense.cashTransactionId },\r\n                    data: {\r\n                        accountId: updates.cashAccountId,\r\n                        amount: updates.amount || currentExpense.amount,\r\n                        category: updates.category || currentExpense.category || 'Expense',\r\n                        description: `Expense: ${updates.description || currentExpense.description}`,\r\n                        personInCharge: updates.personInCharge || currentExpense.personInCharge || null,\r\n                        date: updates.date || currentExpense.date,\r\n                        paymentMethod: updates.paymentMethod || currentExpense.paymentMethod || null,\r\n                        receiptImage: updates.receiptImage || currentExpense.receiptImage || null\r\n                    }\r\n                });\r\n            } else if (!shouldLinkToCash && wasLinkedToCash) {\r\n                // Delete existing cash transaction\r\n                await tx.cashTransaction.delete({\r\n                    where: { id: currentExpense.cashTransactionId }\r\n                });\r\n                await tx.expense.update({\r\n                    where: { id },\r\n                    data: { cashTransactionId: null }\r\n                });\r\n            }\r\n\r\n            return updatedExpense;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error updating expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteExpenseAction(id: string) {\r\n    try {\r\n        await db.$transaction(async (tx) => {\r\n            const expense = await tx.expense.findUnique({\r\n                where: { id },\r\n                select: { cashTransactionId: true }\r\n            });\r\n\r\n            if (expense?.cashTransactionId) {\r\n                await tx.cashTransaction.delete({\r\n                    where: { id: expense.cashTransactionId }\r\n                });\r\n            }\r\n\r\n            await tx.expense.delete({\r\n                where: { id }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n// --- CASH TRANSACTIONS ---\r\n\r\nexport async function getCashTransactionsAction(locationId: string, accountId?: string) {\r\n    try {\r\n        const where: any = { locationId };\r\n        if (accountId) where.accountId = accountId;\r\n\r\n        const transactions = await db.cashTransaction.findMany({\r\n            where,\r\n            orderBy: [{ date: 'desc' }, { createdAt: 'desc' }]\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: transactions.map(t => ({\r\n                ...t,\r\n                created_at: t.createdAt.toISOString(),\r\n                updated_at: t.updatedAt.toISOString(),\r\n                user_id: t.userId,\r\n                account_id: t.accountId,\r\n                location_id: t.locationId,\r\n                transaction_type: t.transactionType,\r\n                person_in_charge: t.personInCharge,\r\n                payment_method: t.paymentMethod,\r\n                receipt_image: t.receiptImage\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching cash transactions:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createCashTransactionAction(data: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            if (data.transactionType === 'transfer' && data.toAccountId) {\r\n                // Create two transactions for a transfer\r\n                const txOut = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.accountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'transfer_out',\r\n                        description: data.description,\r\n                        date: data.date,\r\n                        category: data.category || 'Transfer'\r\n                    }\r\n                });\r\n\r\n                const txIn = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.toAccountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'transfer_in',\r\n                        description: data.description,\r\n                        date: data.date,\r\n                        category: data.category || 'Transfer'\r\n                    }\r\n                });\r\n\r\n                return [txOut, txIn];\r\n            } else {\r\n                const transaction = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.accountId,\r\n                        amount: data.amount,\r\n                        transactionType: data.transactionType,\r\n                        category: data.category,\r\n                        description: data.description,\r\n                        person_in_charge: data.personInCharge,\r\n                        tags: data.tags,\r\n                        date: data.date,\r\n                        paymentMethod: data.paymentMethod,\r\n                        receiptImage: data.receiptImage\r\n                    }\r\n                });\r\n                return transaction;\r\n            }\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating cash transaction:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteCashTransactionAction(id: string, locationId: string) {\r\n    try {\r\n        await db.$transaction(async (tx) => {\r\n            // Check for installment payments linked to this transaction\r\n            await tx.installmentPayment.updateMany({\r\n                where: { cashTransactionId: id },\r\n                data: { cashTransactionId: null }\r\n            });\r\n\r\n            await tx.cashTransaction.delete({\r\n                where: { id, locationId }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting cash transaction:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getAccountOpeningBalanceAction(accountId: string, locationId: string) {\r\n    try {\r\n        const account = await db.cashAccount.findFirst({\r\n            where: { id: accountId, locationId },\r\n            select: { openingBalance: true }\r\n        });\r\n\r\n        return { success: true, data: Number(account?.openingBalance || 0) };\r\n    } catch (error: any) {\r\n        console.error('Error fetching opening balance:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createBulkCashTransactionsAction(transactions: any[]) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            const created = [];\r\n            for (const data of transactions) {\r\n                if (data.transactionType === 'transfer' && data.toAccountId) {\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            locationId: data.locationId,\r\n                            accountId: data.accountId,\r\n                            amount: data.amount,\r\n                            transactionType: 'transfer_out',\r\n                            description: data.description,\r\n                            date: data.date,\r\n                            category: data.category || 'Transfer'\r\n                        }\r\n                    }));\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            locationId: data.locationId,\r\n                            accountId: data.toAccountId,\r\n                            amount: data.amount,\r\n                            transactionType: 'transfer_in',\r\n                            description: data.description,\r\n                            date: data.date,\r\n                            category: data.category || 'Transfer'\r\n                        }\r\n                    }));\r\n                } else {\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            locationId: data.locationId,\r\n                            accountId: data.accountId,\r\n                            amount: data.amount,\r\n                            transactionType: data.transactionType,\r\n                            category: data.category,\r\n                            description: data.description,\r\n                            person_in_charge: data.personInCharge,\r\n                            tags: data.tags,\r\n                            date: data.date,\r\n                            paymentMethod: data.paymentMethod,\r\n                            receiptImage: data.receiptImage\r\n                        }\r\n                    }));\r\n                }\r\n            }\r\n            return created;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating bulk transactions:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MAqGsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,uDAAA"}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/finance.ts"],"sourcesContent":["'use server';\r\n\r\nimport { db, PaymentStatus, ActivityType, ActivityModule } from '../../../prisma/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// --- EXPENSES ---\r\n\r\nexport interface ExpenseInput {\r\n    amount: number;\r\n    description: string;\r\n    category?: string;\r\n    date: Date;\r\n    paymentMethod?: string;\r\n    personInCharge?: string;\r\n    receiptImage?: string;\r\n    cashAccountId?: string;\r\n    userId: string;\r\n    locationId: string;\r\n}\r\n\r\nexport async function createExpenseAction(data: ExpenseInput, linkToCash: boolean) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            // 1. Create the expense\r\n            const expense = await tx.expense.create({\r\n                data: {\r\n                    userId: data.userId,\r\n                    locationId: data.locationId,\r\n                    amount: data.amount,\r\n                    description: data.description,\r\n                    category: data.category || null,\r\n                    date: data.date,\r\n                    paymentMethod: data.paymentMethod || null,\r\n                    personInCharge: data.personInCharge || null,\r\n                    receiptImage: data.receiptImage || null,\r\n                    cashAccountId: linkToCash && data.cashAccountId ? data.cashAccountId : null\r\n                }\r\n            });\r\n\r\n            // 2. If linking to cash, create a cash transaction\r\n            if (linkToCash && data.cashAccountId) {\r\n                const cashTx = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.cashAccountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'cash_out',\r\n                        category: data.category || 'Expense',\r\n                        description: `Expense: ${data.description}`,\r\n                        personInCharge: data.personInCharge || null,\r\n                        date: data.date,\r\n                        paymentMethod: data.paymentMethod || null,\r\n                        receiptImage: data.receiptImage || null\r\n                    }\r\n                });\r\n\r\n                // Update expense with transaction reference\r\n                await tx.expense.update({\r\n                    where: { id: expense.id },\r\n                    data: { cashTransactionId: cashTx.id }\r\n                });\r\n            }\r\n\r\n            return expense;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getExpensesAction(locationId: string) {\r\n    try {\r\n        const expenses = await db.expense.findMany({\r\n            where: { locationId },\r\n            orderBy: { date: 'desc' }\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: expenses.map(e => ({\r\n                ...e,\r\n                created_at: e.createdAt.toISOString(),\r\n                updated_at: e.updatedAt.toISOString(),\r\n                payment_method: e.paymentMethod,\r\n                person_in_charge: e.personInCharge,\r\n                receipt_image: e.receiptImage,\r\n                cash_account_id: e.cashAccountId,\r\n                cash_transaction_id: e.cashTransactionId\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching expenses:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function updateExpenseAction(id: string, updates: any, currentExpense: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            // Update expense\r\n            const updatedExpense = await tx.expense.update({\r\n                where: { id },\r\n                data: {\r\n                    amount: updates.amount,\r\n                    description: updates.description,\r\n                    category: updates.category,\r\n                    date: updates.date,\r\n                    paymentMethod: updates.paymentMethod,\r\n                    personInCharge: updates.personInCharge,\r\n                    receiptImage: updates.receiptImage,\r\n                    cashAccountId: updates.cashAccountId || null\r\n                }\r\n            });\r\n\r\n            const shouldLinkToCash = !!updates.cashAccountId;\r\n            const wasLinkedToCash = !!currentExpense.cashTransactionId;\r\n\r\n            if (shouldLinkToCash && !wasLinkedToCash) {\r\n                // Create new cash transaction\r\n                const cashTx = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: currentExpense.userId,\r\n                        locationId: currentExpense.locationId,\r\n                        accountId: updates.cashAccountId,\r\n                        amount: updates.amount || currentExpense.amount,\r\n                        transactionType: 'cash_out',\r\n                        category: updates.category || currentExpense.category || 'Expense',\r\n                        description: `Expense: ${updates.description || currentExpense.description}`,\r\n                        personInCharge: updates.personInCharge || currentExpense.personInCharge || null,\r\n                        date: updates.date || currentExpense.date,\r\n                        paymentMethod: updates.paymentMethod || currentExpense.paymentMethod || null,\r\n                        receiptImage: updates.receiptImage || currentExpense.receiptImage || null\r\n                    }\r\n                });\r\n                await tx.expense.update({\r\n                    where: { id },\r\n                    data: { cashTransactionId: cashTx.id }\r\n                });\r\n            } else if (shouldLinkToCash && wasLinkedToCash) {\r\n                // Update existing cash transaction\r\n                await tx.cashTransaction.update({\r\n                    where: { id: currentExpense.cashTransactionId },\r\n                    data: {\r\n                        accountId: updates.cashAccountId,\r\n                        amount: updates.amount || currentExpense.amount,\r\n                        category: updates.category || currentExpense.category || 'Expense',\r\n                        description: `Expense: ${updates.description || currentExpense.description}`,\r\n                        personInCharge: updates.personInCharge || currentExpense.personInCharge || null,\r\n                        date: updates.date || currentExpense.date,\r\n                        paymentMethod: updates.paymentMethod || currentExpense.paymentMethod || null,\r\n                        receiptImage: updates.receiptImage || currentExpense.receiptImage || null\r\n                    }\r\n                });\r\n            } else if (!shouldLinkToCash && wasLinkedToCash) {\r\n                // Delete existing cash transaction\r\n                await tx.cashTransaction.delete({\r\n                    where: { id: currentExpense.cashTransactionId }\r\n                });\r\n                await tx.expense.update({\r\n                    where: { id },\r\n                    data: { cashTransactionId: null }\r\n                });\r\n            }\r\n\r\n            return updatedExpense;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error updating expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteExpenseAction(id: string) {\r\n    try {\r\n        await db.$transaction(async (tx) => {\r\n            const expense = await tx.expense.findUnique({\r\n                where: { id },\r\n                select: { cashTransactionId: true }\r\n            });\r\n\r\n            if (expense?.cashTransactionId) {\r\n                await tx.cashTransaction.delete({\r\n                    where: { id: expense.cashTransactionId }\r\n                });\r\n            }\r\n\r\n            await tx.expense.delete({\r\n                where: { id }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting expense:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n// --- CASH TRANSACTIONS ---\r\n\r\nexport async function getCashTransactionsAction(locationId: string, accountId?: string) {\r\n    try {\r\n        const where: any = { locationId };\r\n        if (accountId) where.accountId = accountId;\r\n\r\n        const transactions = await db.cashTransaction.findMany({\r\n            where,\r\n            orderBy: [{ date: 'desc' }, { createdAt: 'desc' }]\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: transactions.map(t => ({\r\n                ...t,\r\n                created_at: t.createdAt.toISOString(),\r\n                updated_at: t.updatedAt.toISOString(),\r\n                user_id: t.userId,\r\n                account_id: t.accountId,\r\n                location_id: t.locationId,\r\n                transaction_type: t.transactionType,\r\n                person_in_charge: t.personInCharge,\r\n                payment_method: t.paymentMethod,\r\n                receipt_image: t.receiptImage\r\n            }))\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error fetching cash transactions:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createCashTransactionAction(data: any) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            if (data.transactionType === 'transfer' && data.toAccountId) {\r\n                // Create two transactions for a transfer\r\n                const txOut = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.accountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'transfer_out',\r\n                        description: data.description,\r\n                        date: data.date,\r\n                        category: data.category || 'Transfer'\r\n                    }\r\n                });\r\n\r\n                const txIn = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.toAccountId,\r\n                        amount: data.amount,\r\n                        transactionType: 'transfer_in',\r\n                        description: data.description,\r\n                        date: data.date,\r\n                        category: data.category || 'Transfer'\r\n                    }\r\n                });\r\n\r\n                return [txOut, txIn];\r\n            } else {\r\n                const transaction = await tx.cashTransaction.create({\r\n                    data: {\r\n                        userId: data.userId,\r\n                        locationId: data.locationId,\r\n                        accountId: data.accountId,\r\n                        amount: data.amount,\r\n                        transactionType: data.transactionType,\r\n                        category: data.category,\r\n                        description: data.description,\r\n                        person_in_charge: data.personInCharge,\r\n                        tags: data.tags,\r\n                        date: data.date,\r\n                        paymentMethod: data.paymentMethod,\r\n                        receiptImage: data.receiptImage\r\n                    }\r\n                });\r\n                return transaction;\r\n            }\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating cash transaction:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function deleteCashTransactionAction(id: string, locationId: string) {\r\n    try {\r\n        await db.$transaction(async (tx) => {\r\n            // Check for installment payments linked to this transaction\r\n            await tx.installmentPayment.updateMany({\r\n                where: { cashTransactionId: id },\r\n                data: { cashTransactionId: null }\r\n            });\r\n\r\n            await tx.cashTransaction.delete({\r\n                where: { id, locationId }\r\n            });\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true };\r\n    } catch (error: any) {\r\n        console.error('Error deleting cash transaction:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function getAccountOpeningBalanceAction(accountId: string, locationId: string) {\r\n    try {\r\n        const account = await db.cashAccount.findFirst({\r\n            where: { id: accountId, locationId },\r\n            select: { openingBalance: true }\r\n        });\r\n\r\n        return { success: true, data: Number(account?.openingBalance || 0) };\r\n    } catch (error: any) {\r\n        console.error('Error fetching opening balance:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\nexport async function createBulkCashTransactionsAction(transactions: any[]) {\r\n    try {\r\n        const result = await db.$transaction(async (tx) => {\r\n            const created = [];\r\n            for (const data of transactions) {\r\n                if (data.transactionType === 'transfer' && data.toAccountId) {\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            locationId: data.locationId,\r\n                            accountId: data.accountId,\r\n                            amount: data.amount,\r\n                            transactionType: 'transfer_out',\r\n                            description: data.description,\r\n                            date: data.date,\r\n                            category: data.category || 'Transfer'\r\n                        }\r\n                    }));\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            locationId: data.locationId,\r\n                            accountId: data.toAccountId,\r\n                            amount: data.amount,\r\n                            transactionType: 'transfer_in',\r\n                            description: data.description,\r\n                            date: data.date,\r\n                            category: data.category || 'Transfer'\r\n                        }\r\n                    }));\r\n                } else {\r\n                    created.push(await tx.cashTransaction.create({\r\n                        data: {\r\n                            userId: data.userId,\r\n                            locationId: data.locationId,\r\n                            accountId: data.accountId,\r\n                            amount: data.amount,\r\n                            transactionType: data.transactionType,\r\n                            category: data.category,\r\n                            description: data.description,\r\n                            person_in_charge: data.personInCharge,\r\n                            tags: data.tags,\r\n                            date: data.date,\r\n                            paymentMethod: data.paymentMethod,\r\n                            receiptImage: data.receiptImage\r\n                        }\r\n                    }));\r\n                }\r\n            }\r\n            return created;\r\n        });\r\n\r\n        revalidatePath('/finance');\r\n        return { success: true, data: result };\r\n    } catch (error: any) {\r\n        console.error('Error creating bulk transactions:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MAoLsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,uDAAA"}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/hooks/useExpenses.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport {\r\n  getExpensesAction,\r\n  createExpenseAction,\r\n  updateExpenseAction,\r\n  deleteExpenseAction,\r\n  createBulkCashTransactionsAction,\r\n  ExpenseInput\r\n} from '@/app/actions/finance';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\n\r\nexport interface Expense {\r\n  id: string;\r\n  amount: number;\r\n  description: string;\r\n  category?: string;\r\n  date: Date;\r\n  paymentMethod?: string;\r\n  personInCharge?: string;\r\n  receiptImage?: string;\r\n  cashAccountId?: string;\r\n  cashTransactionId?: string;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nexport const useExpenses = () => {\r\n  const [expenses, setExpenses] = useState<Expense[]>([]);\r\n  const { toast } = useToast();\r\n  const { currentBusiness } = useBusiness();\r\n  const { user } = useAuth();\r\n  const queryClient = useQueryClient();\r\n\r\n  const loadExpenses = useCallback(async (): Promise<Expense[]> => {\r\n    if (!currentBusiness) {\r\n      return [];\r\n    }\r\n\r\n    try {\r\n      const result = await getExpensesAction(currentBusiness.id);\r\n\r\n      if (!result.success || !result.data) {\r\n        throw new Error(result.error || 'Failed to fetch expenses');\r\n      }\r\n\r\n      const formattedExpenses: Expense[] = result.data.map((expense: any) => ({\r\n        id: expense.id,\r\n        amount: Number(expense.amount),\r\n        description: expense.description,\r\n        category: expense.category,\r\n        date: new Date(expense.date),\r\n        paymentMethod: expense.paymentMethod,\r\n        personInCharge: expense.personInCharge,\r\n        receiptImage: expense.receiptImage,\r\n        cashAccountId: expense.cashAccountId,\r\n        cashTransactionId: expense.cashTransactionId,\r\n        createdAt: new Date(expense.createdAt),\r\n        updatedAt: new Date(expense.updatedAt)\r\n      }));\r\n\r\n      return formattedExpenses;\r\n    } catch (error) {\r\n      console.error('Error loading expenses:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to load expenses. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return [];\r\n    }\r\n  }, [currentBusiness?.id, toast]);\r\n\r\n  // React Query caching\r\n  const queryKey = ['expenses', currentBusiness?.id];\r\n  const { data: queriedExpenses, isLoading: isQueryLoading, isFetching } = useQuery({\r\n    queryKey,\r\n    queryFn: loadExpenses,\r\n    enabled: !!currentBusiness?.id,\r\n    staleTime: 5 * 60_000,\r\n    gcTime: 30 * 60_000,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (queriedExpenses) {\r\n      setExpenses(queriedExpenses);\r\n    }\r\n  }, [queriedExpenses]);\r\n\r\n  // Only report loading when there is no cached data yet to avoid skeleton flash\r\n  const isLoading = isQueryLoading && !queriedExpenses;\r\n\r\n  const createExpense = async (expenseData: {\r\n    amount: number;\r\n    description: string;\r\n    category?: string;\r\n    date: Date;\r\n    paymentMethod?: string;\r\n    personInCharge?: string;\r\n    receiptImage?: string;\r\n    linkToCash?: boolean;\r\n    cashAccountId?: string;\r\n  }) => {\r\n    if (!currentBusiness || !user) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: !currentBusiness ? \"No business selected\" : \"User not authenticated\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const input: ExpenseInput = {\r\n        amount: expenseData.amount,\r\n        description: expenseData.description,\r\n        category: expenseData.category,\r\n        date: expenseData.date,\r\n        paymentMethod: expenseData.paymentMethod,\r\n        personInCharge: expenseData.personInCharge,\r\n        receiptImage: expenseData.receiptImage,\r\n        cashAccountId: expenseData.cashAccountId,\r\n        userId: user.id,\r\n        locationId: currentBusiness.id\r\n      };\r\n\r\n      const result = await createExpenseAction(input, !!expenseData.linkToCash);\r\n\r\n      if (!result.success || !result.data) {\r\n        throw new Error(result.error);\r\n      }\r\n\r\n      const data = result.data;\r\n      const newExpense: Expense = {\r\n        id: data.id,\r\n        amount: Number(data.amount),\r\n        description: data.description,\r\n        category: data.category,\r\n        date: new Date(data.date),\r\n        paymentMethod: data.paymentMethod,\r\n        personInCharge: data.personInCharge,\r\n        receiptImage: data.receiptImage,\r\n        cashAccountId: data.cashAccountId,\r\n        cashTransactionId: data.cashTransactionId,\r\n        createdAt: new Date(data.createdAt),\r\n        updatedAt: new Date(data.updatedAt)\r\n      };\r\n\r\n      // Update local state and cache\r\n      setExpenses(prev => [newExpense, ...prev]);\r\n      queryClient.setQueryData(queryKey, (oldData: Expense[] | undefined) => {\r\n        return oldData ? [newExpense, ...oldData] : [newExpense];\r\n      });\r\n\r\n      queryClient.invalidateQueries({ queryKey });\r\n\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Expense created successfully\"\r\n      });\r\n\r\n      return newExpense;\r\n    } catch (error) {\r\n      console.error('Error creating expense:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to create expense. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const updateExpense = async (id: string, updates: Partial<Expense & { linkToCash?: boolean }>) => {\r\n    try {\r\n      const currentExpense = expenses.find(exp => exp.id === id);\r\n      if (!currentExpense) throw new Error('Expense not found');\r\n\r\n      // Prepare update payload\r\n      const updatePayload = {\r\n        amount: updates.amount !== undefined ? updates.amount : currentExpense.amount,\r\n        description: updates.description !== undefined ? updates.description : currentExpense.description,\r\n        category: updates.category !== undefined ? updates.category : currentExpense.category,\r\n        date: updates.date !== undefined ? updates.date : currentExpense.date,\r\n        paymentMethod: updates.paymentMethod !== undefined ? updates.paymentMethod : currentExpense.paymentMethod,\r\n        personInCharge: updates.personInCharge !== undefined ? updates.personInCharge : currentExpense.personInCharge,\r\n        receiptImage: updates.receiptImage !== undefined ? updates.receiptImage : currentExpense.receiptImage,\r\n        cashAccountId: updates.linkToCash ? updates.cashAccountId : (updates.linkToCash === false ? null : currentExpense.cashAccountId)\r\n      };\r\n\r\n      const result = await updateExpenseAction(id, updatePayload, currentExpense);\r\n\r\n      if (!result.success) throw new Error(result.error);\r\n\r\n      queryClient.invalidateQueries({ queryKey });\r\n\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Expense updated successfully\"\r\n      });\r\n    } catch (error) {\r\n      console.error('Error updating expense:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to update expense. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const deleteExpense = async (id: string) => {\r\n    try {\r\n      const result = await deleteExpenseAction(id);\r\n      if (!result.success) throw new Error(result.error);\r\n\r\n      // Optimistic update\r\n      setExpenses(prev => prev.filter(e => e.id !== id));\r\n      queryClient.setQueryData(queryKey, (old: any) => {\r\n        if (!old) return old;\r\n        return (old as Expense[]).filter(e => e.id !== id);\r\n      });\r\n      queryClient.invalidateQueries({ queryKey });\r\n\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Expense deleted successfully\"\r\n      });\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error deleting expense:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to delete expense. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const refreshExpenses = async () => {\r\n    queryClient.invalidateQueries({ queryKey });\r\n  };\r\n\r\n  const createBulkExpenses = async (expensesData: {\r\n    amount: number;\r\n    description: string;\r\n    category?: string;\r\n    date: Date;\r\n    paymentMethod?: string;\r\n    personInCharge?: string;\r\n    receiptImage?: string;\r\n    linkToCash?: boolean;\r\n    cashAccountId?: string;\r\n  }[]) => {\r\n    if (!currentBusiness || !user) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: !currentBusiness ? \"No business selected\" : \"User not authenticated\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const bulkResults: Expense[] = [];\r\n\r\n      // For bulk, since each might need individual linking logic in the action, \r\n      // we'll loop calling the createExpenseAction or we could implement a bulk action.\r\n      // Reusing createExpenseAction is simpler for now as it handles the transaction.\r\n      for (const data of expensesData) {\r\n        const input: ExpenseInput = {\r\n          amount: data.amount,\r\n          description: data.description,\r\n          category: data.category,\r\n          date: data.date,\r\n          paymentMethod: data.paymentMethod,\r\n          personInCharge: data.personInCharge,\r\n          receiptImage: data.receiptImage,\r\n          cashAccountId: data.cashAccountId,\r\n          userId: user.id,\r\n          locationId: currentBusiness.id\r\n        };\r\n\r\n        const result = await createExpenseAction(input, !!data.linkToCash);\r\n\r\n        if (result.success && result.data) {\r\n          const e = result.data;\r\n          bulkResults.push({\r\n            id: e.id,\r\n            amount: Number(e.amount),\r\n            description: e.description,\r\n            category: e.category,\r\n            date: new Date(e.date),\r\n            paymentMethod: e.paymentMethod,\r\n            personInCharge: e.personInCharge,\r\n            receiptImage: e.receiptImage,\r\n            cashAccountId: e.cashAccountId,\r\n            cashTransactionId: e.cashTransactionId,\r\n            createdAt: new Date(e.createdAt),\r\n            updatedAt: new Date(e.updatedAt)\r\n          });\r\n        }\r\n      }\r\n\r\n      queryClient.invalidateQueries({ queryKey });\r\n\r\n      toast({\r\n        title: \"Success\",\r\n        description: `Successfully created ${bulkResults.length} expenses`\r\n      });\r\n\r\n      return bulkResults;\r\n    } catch (error) {\r\n      console.error('Error creating bulk expenses:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to create bulk expenses. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  return {\r\n    expenses,\r\n    isLoading,\r\n    createExpense,\r\n    createBulkExpenses,\r\n    updateExpense,\r\n    deleteExpense,\r\n    refreshExpenses\r\n  };\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 393, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/business-settings.ts"],"sourcesContent":["'use server';\r\n\r\nimport { db } from '../../../prisma/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nexport async function getBusinessSettingsAction(branchId: string) {\r\n    try {\r\n        const settings = await db.branchSettings.findUnique({\r\n            where: { branchId }\r\n        });\r\n\r\n        if (!settings) {\r\n            return null;\r\n        }\r\n\r\n        return {\r\n            id: settings.id,\r\n            business_name: settings.businessName,\r\n            business_address: settings.address,\r\n            business_phone: settings.phone,\r\n            business_email: settings.email,\r\n            business_logo: settings.logo,\r\n            currency: settings.currency,\r\n            signature: settings.signatureImage,\r\n            metadata: settings.metadata || {}\r\n        };\r\n    } catch (error) {\r\n        console.error('Error fetching business settings:', error);\r\n        return null;\r\n    }\r\n}\r\n\r\nexport async function upsertBusinessSettingsAction(branchId: string, userId: string, updateData: any) {\r\n    try {\r\n        // Validate user access to branch\r\n        const branch = await db.branch.findFirst({\r\n            where: {\r\n                id: branchId,\r\n                OR: [\r\n                    { adminId: userId },\r\n                    { users: { some: { id: userId } } }\r\n                ]\r\n            }\r\n        });\r\n\r\n        if (!branch) {\r\n            return { success: false, error: 'Unauthorized to update branch settings' };\r\n        }\r\n\r\n        const data = {\r\n            businessName: updateData.business_name,\r\n            address: updateData.business_address,\r\n            phone: updateData.business_phone,\r\n            email: updateData.business_email,\r\n            logo: updateData.business_logo,\r\n            currency: updateData.currency,\r\n            signatureImage: updateData.signature,\r\n            metadata: updateData.metadata\r\n        };\r\n\r\n        const upserted = await db.branchSettings.upsert({\r\n            where: { branchId: branchId },\r\n            update: data,\r\n            create: {\r\n                branchId: branchId,\r\n                ...data\r\n            }\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: {\r\n                id: upserted.id,\r\n                business_name: upserted.businessName,\r\n                business_address: upserted.address,\r\n                business_phone: upserted.phone,\r\n                business_email: upserted.email,\r\n                business_logo: upserted.logo,\r\n                currency: upserted.currency,\r\n                signature: upserted.signatureImage,\r\n                metadata: upserted.metadata\r\n            }\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error upserting business settings:', error);\r\n        return { success: false, error: error.message || 'Failed to update settings' };\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MAKsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,6DAAA"}},
    {"offset": {"line": 410, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/business-settings.ts"],"sourcesContent":["'use server';\r\n\r\nimport { db } from '../../../prisma/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nexport async function getBusinessSettingsAction(branchId: string) {\r\n    try {\r\n        const settings = await db.branchSettings.findUnique({\r\n            where: { branchId }\r\n        });\r\n\r\n        if (!settings) {\r\n            return null;\r\n        }\r\n\r\n        return {\r\n            id: settings.id,\r\n            business_name: settings.businessName,\r\n            business_address: settings.address,\r\n            business_phone: settings.phone,\r\n            business_email: settings.email,\r\n            business_logo: settings.logo,\r\n            currency: settings.currency,\r\n            signature: settings.signatureImage,\r\n            metadata: settings.metadata || {}\r\n        };\r\n    } catch (error) {\r\n        console.error('Error fetching business settings:', error);\r\n        return null;\r\n    }\r\n}\r\n\r\nexport async function upsertBusinessSettingsAction(branchId: string, userId: string, updateData: any) {\r\n    try {\r\n        // Validate user access to branch\r\n        const branch = await db.branch.findFirst({\r\n            where: {\r\n                id: branchId,\r\n                OR: [\r\n                    { adminId: userId },\r\n                    { users: { some: { id: userId } } }\r\n                ]\r\n            }\r\n        });\r\n\r\n        if (!branch) {\r\n            return { success: false, error: 'Unauthorized to update branch settings' };\r\n        }\r\n\r\n        const data = {\r\n            businessName: updateData.business_name,\r\n            address: updateData.business_address,\r\n            phone: updateData.business_phone,\r\n            email: updateData.business_email,\r\n            logo: updateData.business_logo,\r\n            currency: updateData.currency,\r\n            signatureImage: updateData.signature,\r\n            metadata: updateData.metadata\r\n        };\r\n\r\n        const upserted = await db.branchSettings.upsert({\r\n            where: { branchId: branchId },\r\n            update: data,\r\n            create: {\r\n                branchId: branchId,\r\n                ...data\r\n            }\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: {\r\n                id: upserted.id,\r\n                business_name: upserted.businessName,\r\n                business_address: upserted.address,\r\n                business_phone: upserted.phone,\r\n                business_email: upserted.email,\r\n                business_logo: upserted.logo,\r\n                currency: upserted.currency,\r\n                signature: upserted.signatureImage,\r\n                metadata: upserted.metadata\r\n            }\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error upserting business settings:', error);\r\n        return { success: false, error: error.message || 'Failed to update settings' };\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MAgCsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,gEAAA"}},
    {"offset": {"line": 427, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/hooks/useBusinessSettings.ts"],"sourcesContent":["\r\nimport { useState, useEffect } from 'react';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { getBusinessSettingsAction, upsertBusinessSettingsAction } from '@/app/actions/business-settings';\r\n\r\nexport interface BusinessSettings {\r\n  id?: string;\r\n  businessName: string;\r\n  businessAddress: string;\r\n  businessPhone: string;\r\n  businessEmail: string;\r\n  businessLogo?: string;\r\n  currency: string;\r\n  signature?: string;\r\n  paymentInfo?: string;\r\n  defaultPrintFormat?: 'standard' | 'thermal';\r\n  defaultPrinterName?: string;\r\n  defaultPrinterType?: 'USB' | 'Bluetooth';\r\n  printerPaperSize?: '58mm' | '80mm';\r\n}\r\n\r\n// Utility function to parse payment info text into structured format\r\nexport const parsePaymentInfo = (paymentInfo: string): { method: string, accountNumber: string, accountName: string }[] => {\r\n  if (!paymentInfo || paymentInfo.trim() === '') {\r\n    return [];\r\n  }\r\n\r\n  const lines = paymentInfo.split('\\n').filter(line => line.trim() !== '');\r\n  const methods: { method: string, accountNumber: string, accountName: string }[] = [];\r\n\r\n  for (let i = 0; i < lines.length; i += 3) {\r\n    if (i + 2 < lines.length) {\r\n      methods.push({\r\n        method: lines[i].trim(),\r\n        accountNumber: lines[i + 1].trim(),\r\n        accountName: lines[i + 2].trim()\r\n      });\r\n    }\r\n  }\r\n\r\n  return methods;\r\n};\r\n\r\n// Utility function to convert payment methods array back to string format\r\nexport const convertPaymentMethodsToString = (paymentMethods: { method: string, accountNumber: string, accountName: string }[]): string => {\r\n  return paymentMethods\r\n    .filter(pm => pm.method.trim() !== '' || pm.accountNumber.trim() !== '' || pm.accountName.trim() !== '')\r\n    .map(pm => `${pm.method}\\n${pm.accountNumber}\\n${pm.accountName}`)\r\n    .join('\\n');\r\n};\r\n\r\n// Default settings for new businesses\r\nconst getDefaultSettings = (): BusinessSettings => ({\r\n  businessName: '',\r\n  businessAddress: '',\r\n  businessPhone: '',\r\n  businessEmail: '',\r\n  currency: 'UGX',\r\n  paymentInfo: '',\r\n  defaultPrintFormat: 'standard'\r\n});\r\n\r\nexport const useBusinessSettings = () => {\r\n  const [settings, setSettings] = useState<BusinessSettings>(getDefaultSettings());\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const { toast } = useToast();\r\n  const { currentBusiness } = useBusiness();\r\n\r\n  const loadSettings = async (): Promise<BusinessSettings> => {\r\n    if (!currentBusiness) {\r\n      return getDefaultSettings();\r\n    }\r\n\r\n    try {\r\n      const data = await getBusinessSettingsAction(currentBusiness.id);\r\n\r\n      if (data) {\r\n        // Extract payment info from metadata\r\n        const paymentInfo = data.metadata && typeof data.metadata === 'object' ?\r\n          (data.metadata as Record<string, unknown>).payment_info as string || '' : '';\r\n\r\n        return {\r\n          id: data.id,\r\n          businessName: data.business_name,\r\n          businessAddress: data.business_address,\r\n          businessPhone: data.business_phone,\r\n          businessEmail: data.business_email,\r\n          businessLogo: data.business_logo,\r\n          currency: data.currency,\r\n          signature: data.signature,\r\n          paymentInfo: paymentInfo,\r\n          defaultPrintFormat: data.metadata && typeof data.metadata === 'object' ?\r\n            (data.metadata as Record<string, unknown>).default_print_format as 'standard' | 'thermal' || 'standard' : 'standard',\r\n          defaultPrinterName: data.metadata && typeof data.metadata === 'object' ?\r\n            (data.metadata as Record<string, unknown>).default_printer_name as string || '' : '',\r\n          defaultPrinterType: data.metadata && typeof data.metadata === 'object' ?\r\n            (data.metadata as Record<string, unknown>).default_printer_type as 'USB' | 'Bluetooth' || 'USB' : 'USB',\r\n          printerPaperSize: data.metadata && typeof data.metadata === 'object' ?\r\n            (data.metadata as Record<string, unknown>).printer_paper_size as '58mm' | '80mm' || '58mm' : '58mm'\r\n        };\r\n      } else {\r\n        return getDefaultSettings();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading business settings:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to load business settings. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return getDefaultSettings();\r\n    }\r\n  };\r\n\r\n  const updateSettings = async (newSettings: Partial<BusinessSettings>) => {\r\n    if (!currentBusiness) {\r\n      console.error('No business selected for updating settings');\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"No business selected\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const userData = { user: { id: '00000000-0000-0000-0000-000000000000' } }; // Mocked user id for now\r\n\r\n      // Prepare the metadata object with payment info\r\n      const metadata = {\r\n        payment_info: newSettings.hasOwnProperty('paymentInfo') ? newSettings.paymentInfo : settings.paymentInfo || '',\r\n        default_print_format: newSettings.hasOwnProperty('defaultPrintFormat') ? newSettings.defaultPrintFormat : settings.defaultPrintFormat || 'standard',\r\n        default_printer_name: newSettings.hasOwnProperty('defaultPrinterName') ? newSettings.defaultPrinterName : settings.defaultPrinterName || '',\r\n        default_printer_type: newSettings.hasOwnProperty('defaultPrinterType') ? newSettings.defaultPrinterType : settings.defaultPrinterType || 'USB',\r\n        printer_paper_size: newSettings.hasOwnProperty('printerPaperSize') ? newSettings.printerPaperSize : settings.printerPaperSize || '58mm'\r\n      };\r\n\r\n      const updateData = {\r\n        business_name: newSettings.hasOwnProperty('businessName') ? newSettings.businessName : settings.businessName,\r\n        business_address: newSettings.hasOwnProperty('businessAddress') ? newSettings.businessAddress : settings.businessAddress,\r\n        business_phone: newSettings.hasOwnProperty('businessPhone') ? newSettings.businessPhone : settings.businessPhone,\r\n        business_email: newSettings.hasOwnProperty('businessEmail') ? newSettings.businessEmail : settings.businessEmail,\r\n        business_logo: newSettings.hasOwnProperty('businessLogo') ? newSettings.businessLogo : settings.businessLogo,\r\n        currency: newSettings.hasOwnProperty('currency') ? newSettings.currency : settings.currency,\r\n        signature: newSettings.hasOwnProperty('signature') ? newSettings.signature : settings.signature,\r\n        metadata: metadata\r\n      };\r\n\r\n      const response = await upsertBusinessSettingsAction(currentBusiness.id, userData.user.id, updateData);\r\n\r\n      if (!response.success) {\r\n        console.error('Supabase error updating business settings:', response.error);\r\n        throw new Error(response.error);\r\n      }\r\n\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Business settings updated successfully\"\r\n      });\r\n\r\n      // Refetch settings after update\r\n      refetch();\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error updating business settings:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to update business settings. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  // React Query for settings loading with proper caching\r\n  const { data: queriedData, isLoading: isQueryLoading, isFetching, refetch } = useQuery({\r\n    queryKey: ['businessSettings', currentBusiness?.id],\r\n    queryFn: loadSettings,\r\n    enabled: !!currentBusiness?.id,\r\n    staleTime: 5 * 60_000,\r\n    gcTime: 30 * 60_000,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false,\r\n  });\r\n\r\n  // Sync React Query data with local state\r\n  useEffect(() => {\r\n    if (queriedData) {\r\n      setSettings(queriedData);\r\n    } else if (!currentBusiness) {\r\n      setSettings(getDefaultSettings());\r\n    }\r\n  }, [queriedData, currentBusiness]);\r\n\r\n  // Sync loading state from React Query\r\n  useEffect(() => {\r\n    setIsLoading(isQueryLoading || isFetching);\r\n  }, [isQueryLoading, isFetching]);\r\n\r\n  return {\r\n    settings,\r\n    isLoading,\r\n    updateSettings,\r\n    loadSettings\r\n  };\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 632, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/dateFilters.ts"],"sourcesContent":["\r\nimport { startOfDay, endOfDay, startOfWeek, endOfWeek, startOfMonth, endOfMonth, startOfYear, endOfYear, subDays, subWeeks, subMonths } from 'date-fns';\r\n\r\nexport const getDateRangeFromFilter = (filter: string): { from: Date; to: Date } => {\r\n  const now = new Date();\r\n  const today = startOfDay(now);\r\n  \r\n  switch (filter) {\r\n    case 'today':\r\n      return {\r\n        from: today,\r\n        to: endOfDay(now)\r\n      };\r\n    case 'yesterday':\r\n      const yesterday = subDays(today, 1);\r\n      return {\r\n        from: yesterday,\r\n        to: endOfDay(yesterday)\r\n      };\r\n    case 'this-week':\r\n      return {\r\n        from: startOfWeek(now),\r\n        to: endOfWeek(now)\r\n      };\r\n    case 'last-week':\r\n      const lastWeekStart = startOfWeek(subWeeks(now, 1));\r\n      return {\r\n        from: lastWeekStart,\r\n        to: endOfWeek(lastWeekStart)\r\n      };\r\n    case 'this-month':\r\n      return {\r\n        from: startOfMonth(now),\r\n        to: endOfMonth(now)\r\n      };\r\n    case 'last-month':\r\n      const lastMonthStart = startOfMonth(subMonths(now, 1));\r\n      return {\r\n        from: lastMonthStart,\r\n        to: endOfMonth(lastMonthStart)\r\n      };\r\n    case 'this-year':\r\n      return {\r\n        from: startOfYear(now),\r\n        to: endOfYear(now)\r\n      };\r\n    default:\r\n      // For 'all' or any other case, return a very wide range\r\n      return {\r\n        from: new Date(2000, 0, 1),\r\n        to: endOfDay(now)\r\n      };\r\n  }\r\n};\r\n\r\nexport const isDateInRange = (date: Date, from: Date | undefined, to: Date | undefined): boolean => {\r\n  if (!from && !to) return true;\r\n  if (!from) return date <= to!;\r\n  if (!to) return date >= from;\r\n  return date >= from && date <= to;\r\n};\r\n"],"names":[],"mappings":";;;;;;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEO,MAAM,yBAAyB,CAAC;IACrC,MAAM,MAAM,IAAI;IAChB,MAAM,QAAQ,IAAA,0JAAU,EAAC;IAEzB,OAAQ;QACN,KAAK;YACH,OAAO;gBACL,MAAM;gBACN,IAAI,IAAA,sJAAQ,EAAC;YACf;QACF,KAAK;YACH,MAAM,YAAY,IAAA,oJAAO,EAAC,OAAO;YACjC,OAAO;gBACL,MAAM;gBACN,IAAI,IAAA,sJAAQ,EAAC;YACf;QACF,KAAK;YACH,OAAO;gBACL,MAAM,IAAA,4JAAW,EAAC;gBAClB,IAAI,IAAA,wJAAS,EAAC;YAChB;QACF,KAAK;YACH,MAAM,gBAAgB,IAAA,4JAAW,EAAC,IAAA,sJAAQ,EAAC,KAAK;YAChD,OAAO;gBACL,MAAM;gBACN,IAAI,IAAA,wJAAS,EAAC;YAChB;QACF,KAAK;YACH,OAAO;gBACL,MAAM,IAAA,8JAAY,EAAC;gBACnB,IAAI,IAAA,0JAAU,EAAC;YACjB;QACF,KAAK;YACH,MAAM,iBAAiB,IAAA,8JAAY,EAAC,IAAA,wJAAS,EAAC,KAAK;YACnD,OAAO;gBACL,MAAM;gBACN,IAAI,IAAA,0JAAU,EAAC;YACjB;QACF,KAAK;YACH,OAAO;gBACL,MAAM,IAAA,4JAAW,EAAC;gBAClB,IAAI,IAAA,wJAAS,EAAC;YAChB;QACF;YACE,wDAAwD;YACxD,OAAO;gBACL,MAAM,IAAI,KAAK,MAAM,GAAG;gBACxB,IAAI,IAAA,sJAAQ,EAAC;YACf;IACJ;AACF;AAEO,MAAM,gBAAgB,CAAC,MAAY,MAAwB;IAChE,IAAI,CAAC,QAAQ,CAAC,IAAI,OAAO;IACzB,IAAI,CAAC,MAAM,OAAO,QAAQ;IAC1B,IAAI,CAAC,IAAI,OAAO,QAAQ;IACxB,OAAO,QAAQ,QAAQ,QAAQ;AACjC"}},
    {"offset": {"line": 713, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/hooks/useExpenseData.ts"],"sourcesContent":["import { useMemo } from 'react';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { formatCashCurrency } from '@/lib/utils';\r\nimport { Expense } from '@/hooks/useExpenses';\r\nimport { getDateRangeFromFilter, isDateInRange } from '@/utils/dateFilters';\r\n\r\nexport const useExpenseData = (\r\n  expenses: Expense[],\r\n  dateFilter: string,\r\n  customDateRange: { from: Date | undefined; to: Date | undefined }\r\n) => {\r\n  const { settings } = useBusinessSettings();\r\n\r\n  // Memoize currency formatter\r\n  const formatCurrency = useMemo(() => {\r\n    const currency = settings.currency || 'USD';\r\n    return (amount: number) => {\r\n      return formatCashCurrency(amount, currency);\r\n    };\r\n  }, [settings.currency]);\r\n\r\n  // Memoize filtered expenses based on selected date range\r\n  const filteredExpenses = useMemo(() => {\r\n    if (dateFilter === 'all') {\r\n      return expenses;\r\n    }\r\n\r\n    let from: Date | undefined;\r\n    let to: Date | undefined;\r\n\r\n    if (dateFilter === 'custom') {\r\n      from = customDateRange.from;\r\n      to = customDateRange.to;\r\n    } else {\r\n      const range = getDateRangeFromFilter(dateFilter);\r\n      from = range.from;\r\n      to = range.to;\r\n    }\r\n\r\n    return expenses.filter(expense => isDateInRange(expense.date, from, to));\r\n  }, [expenses, dateFilter, customDateRange]);\r\n\r\n  // Memoize calculated values\r\n  const expenseStats = useMemo(() => {\r\n    const totalExpenses = filteredExpenses.reduce((sum, expense) => sum + expense.amount, 0);\r\n    \r\n    const thisMonthExpenses = filteredExpenses\r\n      .filter(expense => {\r\n        const expenseMonth = expense.date.getMonth();\r\n        const currentMonth = new Date().getMonth();\r\n        const expenseYear = expense.date.getFullYear();\r\n        const currentYear = new Date().getFullYear();\r\n        return expenseMonth === currentMonth && expenseYear === currentYear;\r\n      })\r\n      .reduce((sum, expense) => sum + expense.amount, 0);\r\n\r\n    return {\r\n      totalExpenses,\r\n      thisMonthExpenses,\r\n      transactionCount: filteredExpenses.length\r\n    };\r\n  }, [filteredExpenses]);\r\n\r\n  return {\r\n    filteredExpenses,\r\n    expenseStats,\r\n    formatCurrency\r\n  };\r\n};"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAEA;;;;;;AAEO,MAAM,iBAAiB,CAC5B,UACA,YACA;;IAEA,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,6JAAmB;IAExC,6BAA6B;IAC7B,MAAM,iBAAiB,IAAA,wKAAO;kDAAC;YAC7B,MAAM,WAAW,SAAS,QAAQ,IAAI;YACtC;0DAAO,CAAC;oBACN,OAAO,IAAA,4IAAkB,EAAC,QAAQ;gBACpC;;QACF;iDAAG;QAAC,SAAS,QAAQ;KAAC;IAEtB,yDAAyD;IACzD,MAAM,mBAAmB,IAAA,wKAAO;oDAAC;YAC/B,IAAI,eAAe,OAAO;gBACxB,OAAO;YACT;YAEA,IAAI;YACJ,IAAI;YAEJ,IAAI,eAAe,UAAU;gBAC3B,OAAO,gBAAgB,IAAI;gBAC3B,KAAK,gBAAgB,EAAE;YACzB,OAAO;gBACL,MAAM,QAAQ,IAAA,wJAAsB,EAAC;gBACrC,OAAO,MAAM,IAAI;gBACjB,KAAK,MAAM,EAAE;YACf;YAEA,OAAO,SAAS,MAAM;4DAAC,CAAA,UAAW,IAAA,+IAAa,EAAC,QAAQ,IAAI,EAAE,MAAM;;QACtE;mDAAG;QAAC;QAAU;QAAY;KAAgB;IAE1C,4BAA4B;IAC5B,MAAM,eAAe,IAAA,wKAAO;gDAAC;YAC3B,MAAM,gBAAgB,iBAAiB,MAAM;sEAAC,CAAC,KAAK,UAAY,MAAM,QAAQ,MAAM;qEAAE;YAEtF,MAAM,oBAAoB,iBACvB,MAAM;0EAAC,CAAA;oBACN,MAAM,eAAe,QAAQ,IAAI,CAAC,QAAQ;oBAC1C,MAAM,eAAe,IAAI,OAAO,QAAQ;oBACxC,MAAM,cAAc,QAAQ,IAAI,CAAC,WAAW;oBAC5C,MAAM,cAAc,IAAI,OAAO,WAAW;oBAC1C,OAAO,iBAAiB,gBAAgB,gBAAgB;gBAC1D;yEACC,MAAM;0EAAC,CAAC,KAAK,UAAY,MAAM,QAAQ,MAAM;yEAAE;YAElD,OAAO;gBACL;gBACA;gBACA,kBAAkB,iBAAiB,MAAM;YAC3C;QACF;+CAAG;QAAC;KAAiB;IAErB,OAAO;QACL;QACA;QACA;IACF;AACF;GA9Da;;QAKU,6JAAmB"}},
    {"offset": {"line": 811, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/hooks/useExpenseCategories.ts"],"sourcesContent":["\r\nimport { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\n\r\nexport interface ExpenseCategory {\r\n  id: string;\r\n  name: string;\r\n  isDefault: boolean;\r\n  createdAt: Date;\r\n}\r\n\r\nconst DEFAULT_CATEGORIES = [\r\n  'Rent & Utilities',\r\n  'Salaries & Wages',\r\n  'Marketing & Advertising',\r\n  'Office Supplies & Equipment',\r\n  'Professional Services',\r\n  'Cost of bringing Goods',\r\n  'Delivery To Customer',\r\n  'Insurance',\r\n  'Licenses, Permits & Fees',\r\n  'Software & Subscriptions',\r\n  'Depreciation & Amortization',\r\n  'Training & Development',\r\n  'Communication',\r\n  'Bank & Transaction Fees',\r\n  'Miscellaneous'\r\n];\r\n\r\nexport const useExpenseCategories = () => {\r\n  const [categories, setCategories] = useState<ExpenseCategory[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const { toast } = useToast();\r\n  const { currentBusiness } = useBusiness();\r\n\r\n  const loadCategories = async () => {\r\n    if (!currentBusiness) {\r\n      setCategories([]);\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true);\r\n      const { data, error } = await supabase\r\n        .from('expense_categories')\r\n        .select('*')\r\n        .eq('location_id', currentBusiness.id)\r\n        .order('is_default', { ascending: false })\r\n        .order('name');\r\n\r\n      if (error) throw error;\r\n\r\n      const formattedCategories: ExpenseCategory[] = data?.map(category => ({\r\n        id: category.id,\r\n        name: category.name,\r\n        isDefault: category.is_default,\r\n        createdAt: new Date(category.created_at)\r\n      })) || [];\r\n\r\n      // Remove duplicates based on name (case-insensitive)\r\n      const uniqueCategories = formattedCategories.filter((category, index, self) =>\r\n        index === self.findIndex(c => c.name.toLowerCase() === category.name.toLowerCase())\r\n      );\r\n\r\n      // If no categories exist, create default ones\r\n      if (uniqueCategories.length === 0) {\r\n        await createDefaultCategories();\r\n        return;\r\n      }\r\n\r\n      setCategories(uniqueCategories);\r\n    } catch (error) {\r\n      console.error('Error loading expense categories:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to load expense categories. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const createDefaultCategories = async () => {\r\n    if (!currentBusiness) return;\r\n\r\n    try {\r\n      const { data: userData } = await supabase.auth.getUser();\r\n      if (!userData.user) throw new Error('User not authenticated');\r\n\r\n      // Check if any default categories already exist for this location\r\n      const { data: existingCategories } = await supabase\r\n        .from('expense_categories')\r\n        .select('id, name')\r\n        .eq('location_id', currentBusiness.id)\r\n        .eq('is_default', true);\r\n\r\n      const existingNames = new Set(existingCategories?.map(cat => cat.name.toLowerCase()) || []);\r\n\r\n      // Only create categories that don't already exist\r\n      const categoriesToCreate = DEFAULT_CATEGORIES.filter(\r\n        name => !existingNames.has(name.toLowerCase())\r\n      );\r\n\r\n      if (categoriesToCreate.length === 0) {\r\n        // If all default categories already exist, just reload\r\n        await loadCategories();\r\n        return;\r\n      }\r\n\r\n      const defaultCategoriesData = categoriesToCreate.map(name => ({\r\n        user_id: userData.user.id,\r\n        location_id: currentBusiness.id,\r\n        name,\r\n        is_default: true\r\n      }));\r\n\r\n      const { data, error } = await supabase\r\n        .from('expense_categories')\r\n        .insert(defaultCategoriesData)\r\n        .select();\r\n\r\n      if (error) throw error;\r\n\r\n      const newCategories: ExpenseCategory[] = data?.map(category => ({\r\n        id: category.id,\r\n        name: category.name,\r\n        isDefault: category.is_default,\r\n        createdAt: new Date(category.created_at)\r\n      })) || [];\r\n\r\n      // Combine with existing categories and remove duplicates\r\n      const allCategories = [...(existingCategories?.map(cat => ({\r\n        id: cat.id,\r\n        name: cat.name,\r\n        isDefault: true,\r\n        createdAt: new Date()\r\n      })) || []), ...newCategories];\r\n\r\n      const uniqueCategories = allCategories.filter((category, index, self) =>\r\n        index === self.findIndex(c => c.name.toLowerCase() === category.name.toLowerCase())\r\n      );\r\n\r\n      setCategories(uniqueCategories);\r\n    } catch (error) {\r\n      console.error('Error creating default categories:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to create default categories. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const createCategory = async (name: string) => {\r\n    if (!currentBusiness) return null;\r\n\r\n    try {\r\n      const { data: userData } = await supabase.auth.getUser();\r\n      if (!userData.user) throw new Error('User not authenticated');\r\n\r\n      // Check if category already exists (case-insensitive)\r\n      const existingCategory = categories.find(\r\n        cat => cat.name.toLowerCase() === name.toLowerCase()\r\n      );\r\n      \r\n      if (existingCategory) {\r\n        toast({\r\n          title: \"Category exists\",\r\n          description: \"This category already exists.\",\r\n          variant: \"default\"\r\n        });\r\n        return existingCategory;\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from('expense_categories')\r\n        .insert({\r\n          user_id: userData.user.id,\r\n          location_id: currentBusiness.id,\r\n          name,\r\n          is_default: false\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      const newCategory: ExpenseCategory = {\r\n        id: data.id,\r\n        name: data.name,\r\n        isDefault: data.is_default,\r\n        createdAt: new Date(data.created_at)\r\n      };\r\n\r\n      setCategories([...categories, newCategory]);\r\n      return newCategory;\r\n    } catch (error) {\r\n      console.error('Error creating category:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to create category. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const deleteCategory = async (id: string) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('expense_categories')\r\n        .delete()\r\n        .eq('id', id);\r\n\r\n      if (error) throw error;\r\n\r\n      setCategories(categories.filter(c => c.id !== id));\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error deleting category:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to delete category. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadCategories();\r\n  }, [currentBusiness?.id]);\r\n\r\n  return {\r\n    categories,\r\n    isLoading,\r\n    createCategory,\r\n    deleteCategory,\r\n    refreshCategories: loadCategories\r\n  };\r\n};\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;;;;;;AASA,MAAM,qBAAqB;IACzB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAEM,MAAM,uBAAuB;;IAClC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAoB,EAAE;IAClE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,2IAAQ;IAC1B,MAAM,EAAE,eAAe,EAAE,GAAG,IAAA,qJAAW;IAEvC,MAAM,iBAAiB;QACrB,IAAI,CAAC,iBAAiB;YACpB,cAAc,EAAE;YAChB,aAAa;YACb;QACF;QAEA,IAAI;YACF,aAAa;YACb,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,wJAAQ,CACnC,IAAI,CAAC,sBACL,MAAM,CAAC,KACP,EAAE,CAAC,eAAe,gBAAgB,EAAE,EACpC,KAAK,CAAC,cAAc;gBAAE,WAAW;YAAM,GACvC,KAAK,CAAC;YAET,IAAI,OAAO,MAAM;YAEjB,MAAM,sBAAyC,MAAM,IAAI,CAAA,WAAY,CAAC;oBACpE,IAAI,SAAS,EAAE;oBACf,MAAM,SAAS,IAAI;oBACnB,WAAW,SAAS,UAAU;oBAC9B,WAAW,IAAI,KAAK,SAAS,UAAU;gBACzC,CAAC,MAAM,EAAE;YAET,qDAAqD;YACrD,MAAM,mBAAmB,oBAAoB,MAAM,CAAC,CAAC,UAAU,OAAO,OACpE,UAAU,KAAK,SAAS,CAAC,CAAA,IAAK,EAAE,IAAI,CAAC,WAAW,OAAO,SAAS,IAAI,CAAC,WAAW;YAGlF,8CAA8C;YAC9C,IAAI,iBAAiB,MAAM,KAAK,GAAG;gBACjC,MAAM;gBACN;YACF;YAEA,cAAc;QAChB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,qCAAqC;YACnD,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF,SAAU;YACR,aAAa;QACf;IACF;IAEA,MAAM,0BAA0B;QAC9B,IAAI,CAAC,iBAAiB;QAEtB,IAAI;YACF,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,wJAAQ,CAAC,IAAI,CAAC,OAAO;YACtD,IAAI,CAAC,SAAS,IAAI,EAAE,MAAM,IAAI,MAAM;YAEpC,kEAAkE;YAClE,MAAM,EAAE,MAAM,kBAAkB,EAAE,GAAG,MAAM,wJAAQ,CAChD,IAAI,CAAC,sBACL,MAAM,CAAC,YACP,EAAE,CAAC,eAAe,gBAAgB,EAAE,EACpC,EAAE,CAAC,cAAc;YAEpB,MAAM,gBAAgB,IAAI,IAAI,oBAAoB,IAAI,CAAA,MAAO,IAAI,IAAI,CAAC,WAAW,OAAO,EAAE;YAE1F,kDAAkD;YAClD,MAAM,qBAAqB,mBAAmB,MAAM,CAClD,CAAA,OAAQ,CAAC,cAAc,GAAG,CAAC,KAAK,WAAW;YAG7C,IAAI,mBAAmB,MAAM,KAAK,GAAG;gBACnC,uDAAuD;gBACvD,MAAM;gBACN;YACF;YAEA,MAAM,wBAAwB,mBAAmB,GAAG,CAAC,CAAA,OAAQ,CAAC;oBAC5D,SAAS,SAAS,IAAI,CAAC,EAAE;oBACzB,aAAa,gBAAgB,EAAE;oBAC/B;oBACA,YAAY;gBACd,CAAC;YAED,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,wJAAQ,CACnC,IAAI,CAAC,sBACL,MAAM,CAAC,uBACP,MAAM;YAET,IAAI,OAAO,MAAM;YAEjB,MAAM,gBAAmC,MAAM,IAAI,CAAA,WAAY,CAAC;oBAC9D,IAAI,SAAS,EAAE;oBACf,MAAM,SAAS,IAAI;oBACnB,WAAW,SAAS,UAAU;oBAC9B,WAAW,IAAI,KAAK,SAAS,UAAU;gBACzC,CAAC,MAAM,EAAE;YAET,yDAAyD;YACzD,MAAM,gBAAgB;mBAAK,oBAAoB,IAAI,CAAA,MAAO,CAAC;wBACzD,IAAI,IAAI,EAAE;wBACV,MAAM,IAAI,IAAI;wBACd,WAAW;wBACX,WAAW,IAAI;oBACjB,CAAC,MAAM,EAAE;mBAAM;aAAc;YAE7B,MAAM,mBAAmB,cAAc,MAAM,CAAC,CAAC,UAAU,OAAO,OAC9D,UAAU,KAAK,SAAS,CAAC,CAAA,IAAK,EAAE,IAAI,CAAC,WAAW,OAAO,SAAS,IAAI,CAAC,WAAW;YAGlF,cAAc;QAChB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sCAAsC;YACpD,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF;IACF;IAEA,MAAM,iBAAiB,OAAO;QAC5B,IAAI,CAAC,iBAAiB,OAAO;QAE7B,IAAI;YACF,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,wJAAQ,CAAC,IAAI,CAAC,OAAO;YACtD,IAAI,CAAC,SAAS,IAAI,EAAE,MAAM,IAAI,MAAM;YAEpC,sDAAsD;YACtD,MAAM,mBAAmB,WAAW,IAAI,CACtC,CAAA,MAAO,IAAI,IAAI,CAAC,WAAW,OAAO,KAAK,WAAW;YAGpD,IAAI,kBAAkB;gBACpB,MAAM;oBACJ,OAAO;oBACP,aAAa;oBACb,SAAS;gBACX;gBACA,OAAO;YACT;YAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,wJAAQ,CACnC,IAAI,CAAC,sBACL,MAAM,CAAC;gBACN,SAAS,SAAS,IAAI,CAAC,EAAE;gBACzB,aAAa,gBAAgB,EAAE;gBAC/B;gBACA,YAAY;YACd,GACC,MAAM,GACN,MAAM;YAET,IAAI,OAAO,MAAM;YAEjB,MAAM,cAA+B;gBACnC,IAAI,KAAK,EAAE;gBACX,MAAM,KAAK,IAAI;gBACf,WAAW,KAAK,UAAU;gBAC1B,WAAW,IAAI,KAAK,KAAK,UAAU;YACrC;YAEA,cAAc;mBAAI;gBAAY;aAAY;YAC1C,OAAO;QACT,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;YACA,OAAO;QACT;IACF;IAEA,MAAM,iBAAiB,OAAO;QAC5B,IAAI;YACF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,wJAAQ,CAC7B,IAAI,CAAC,sBACL,MAAM,GACN,EAAE,CAAC,MAAM;YAEZ,IAAI,OAAO,MAAM;YAEjB,cAAc,WAAW,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;YAC9C,OAAO;QACT,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;YACA,OAAO;QACT;IACF;IAEA,IAAA,0KAAS;0CAAC;YACR;QACF;yCAAG;QAAC,iBAAiB;KAAG;IAExB,OAAO;QACL;QACA;QACA;QACA;QACA,mBAAmB;IACrB;AACF;GArNa;;QAGO,2IAAQ;QACE,qJAAW"}},
    {"offset": {"line": 1021, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/alert-dialog.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { buttonVariants } from \"@/components/ui/button\"\r\n\r\nconst AlertDialog = AlertDialogPrimitive.Root\r\n\r\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\r\n\r\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\r\n\r\nconst AlertDialogOverlay = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Overlay\r\n    className={cn(\r\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n    ref={ref}\r\n  />\r\n))\r\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\r\n\r\nconst AlertDialogContent = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPortal>\r\n    <AlertDialogOverlay />\r\n    <AlertDialogPrimitive.Content\r\n      ref={ref}\r\n      className={cn(\r\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  </AlertDialogPortal>\r\n))\r\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\r\n\r\nconst AlertDialogHeader = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col space-y-2 text-center sm:text-left\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\r\n\r\nconst AlertDialogFooter = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\r\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n)\r\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\r\n\r\nconst AlertDialogTitle = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Title\r\n    ref={ref}\r\n    className={cn(\"text-lg font-semibold\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\r\n\r\nconst AlertDialogDescription = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Description\r\n    ref={ref}\r\n    className={cn(\"text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertDialogDescription.displayName =\r\n  AlertDialogPrimitive.Description.displayName\r\n\r\nconst AlertDialogAction = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Action\r\n    ref={ref}\r\n    className={cn(buttonVariants(), className)}\r\n    {...props}\r\n  />\r\n))\r\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\r\n\r\nconst AlertDialogCancel = React.forwardRef<\r\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\r\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\r\n>(({ className, ...props }, ref) => (\r\n  <AlertDialogPrimitive.Cancel\r\n    ref={ref}\r\n    className={cn(\r\n      buttonVariants({ variant: \"outline\" }),\r\n      \"mt-2 sm:mt-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\r\n\r\nexport {\r\n  AlertDialog,\r\n  AlertDialogPortal,\r\n  AlertDialogOverlay,\r\n  AlertDialogTrigger,\r\n  AlertDialogContent,\r\n  AlertDialogHeader,\r\n  AlertDialogFooter,\r\n  AlertDialogTitle,\r\n  AlertDialogDescription,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AACA;;;;;;AAEA,MAAM,cAAc,sLAAyB;AAE7C,MAAM,qBAAqB,yLAA4B;AAEvD,MAAM,oBAAoB,wLAA2B;AAErD,MAAM,mCAAqB,2KAAgB,CAGzC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,yLAA4B;QAC3B,WAAW,IAAA,4HAAE,EACX,2JACA;QAED,GAAG,KAAK;QACT,KAAK;;;;;;KAVH;AAaN,mBAAmB,WAAW,GAAG,yLAA4B,CAAC,WAAW;AAEzE,MAAM,mCAAqB,2KAAgB,OAGzC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;;0BACC,6LAAC;;;;;0BACD,6LAAC,yLAA4B;gBAC3B,KAAK;gBACL,WAAW,IAAA,4HAAE,EACX,+fACA;gBAED,GAAG,KAAK;;;;;;;;;;;;;AAIf,mBAAmB,WAAW,GAAG,yLAA4B,CAAC,WAAW;AAEzE,MAAM,oBAAoB,CAAC,EACzB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,4HAAE,EACX,oDACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,kBAAkB,WAAW,GAAG;AAEhC,MAAM,oBAAoB,CAAC,EACzB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,4HAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,kBAAkB,WAAW,GAAG;AAEhC,MAAM,iCAAmB,2KAAgB,OAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,uLAA0B;QACzB,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,yBAAyB;QACtC,GAAG,KAAK;;;;;;;AAGb,iBAAiB,WAAW,GAAG,uLAA0B,CAAC,WAAW;AAErE,MAAM,uCAAyB,2KAAgB,OAG7C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,6LAAgC;QAC/B,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,uBAAuB,WAAW,GAChC,6LAAgC,CAAC,WAAW;AAE9C,MAAM,kCAAoB,2KAAgB,OAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,wLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,IAAA,uJAAc,KAAI;QAC/B,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,wLAA2B,CAAC,WAAW;AAEvE,MAAM,kCAAoB,2KAAgB,QAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,wLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,IAAA,uJAAc,EAAC;YAAE,SAAS;QAAU,IACpC,gBACA;QAED,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,wLAA2B,CAAC,WAAW"}},
    {"offset": {"line": 1181, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/badge.tsx"],"sourcesContent":["\r\nimport * as React from \"react\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst badgeVariants = cva(\r\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\r\n        secondary:\r\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\r\n        destructive:\r\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\r\n        outline: \"text-foreground\",\r\n        warning:\r\n          \"border-transparent bg-amber-500 text-white hover:bg-amber-600\",\r\n        success:\r\n          \"border-transparent bg-green-600 text-white hover:bg-green-700\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nexport interface BadgeProps\r\n  extends React.HTMLAttributes<HTMLDivElement>,\r\n    VariantProps<typeof badgeVariants> {}\r\n\r\nfunction Badge({ className, variant, ...props }: BadgeProps) {\r\n  return (\r\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\r\n  )\r\n}\r\n\r\nexport { Badge, badgeVariants }\r\n"],"names":[],"mappings":";;;;;;;AAEA;AAEA;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB,0KACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SAAS;YACT,SACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAOF,SAAS,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAmB;IACzD,qBACE,6LAAC;QAAI,WAAW,IAAA,4HAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QAAa,GAAG,KAAK;;;;;;AAExE;KAJS"}},
    {"offset": {"line": 1231, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/ExpenseCategoriesManager.tsx"],"sourcesContent":["\r\nimport React, { useState } from 'react';\r\nimport { useExpenseCategories } from '@/hooks/useExpenseCategories';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Trash2, Plus, Tag } from 'lucide-react';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n  DialogFooter,\r\n  DialogClose,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n  AlertDialogTrigger,\r\n} from '@/components/ui/alert-dialog';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { Badge } from '@/components/ui/badge';\r\n\r\nconst ExpenseCategoriesManager: React.FC = () => {\r\n  const expenseCategories = useExpenseCategories();\r\n  const { categories, createCategory, deleteCategory } = expenseCategories;\r\n  const [newCategoryName, setNewCategoryName] = useState('');\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  const handleCreateCategory = async () => {\r\n    if (!newCategoryName.trim()) return;\r\n    \r\n    setIsSubmitting(true);\r\n    try {\r\n      const result = await createCategory(newCategoryName.trim());\r\n      if (result) {\r\n        setNewCategoryName('');\r\n      }\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteCategory = async (id: string) => {\r\n    setIsSubmitting(true);\r\n    try {\r\n      await deleteCategory(id);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={setIsOpen}>\r\n      <DialogTrigger asChild>\r\n        <Button variant=\"outline\" className=\"gap-2\">\r\n          <Tag className=\"h-4 w-4\" />\r\n          Expense Categories\r\n        </Button>\r\n      </DialogTrigger>\r\n      <DialogContent className=\"sm:max-w-md\">\r\n        <DialogHeader>\r\n          <DialogTitle>Expense Categories</DialogTitle>\r\n          <DialogDescription>\r\n            Manage your expense categories.\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n        \r\n        <div className=\"space-y-4\">\r\n          {/* Add new category */}\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"newCategory\">Add New Category</Label>\r\n            <div className=\"flex gap-2\">\r\n              <Input\r\n                id=\"newCategory\"\r\n                placeholder=\"Enter category name\"\r\n                value={newCategoryName}\r\n                onChange={(e) => setNewCategoryName(e.target.value)}\r\n                onKeyPress={(e) => e.key === 'Enter' && handleCreateCategory()}\r\n              />\r\n              <Button \r\n                onClick={handleCreateCategory} \r\n                disabled={!newCategoryName.trim() || isSubmitting}\r\n                size=\"sm\"\r\n              >\r\n                <Plus className=\"h-4 w-4\" />\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Categories list */}\r\n          <div className=\"space-y-3\">\r\n            {categories.length > 0 ? (\r\n              <div>\r\n                <h4 className=\"text-sm font-medium text-gray-900 mb-2\">Categories</h4>\r\n                <ScrollArea className=\"h-64 rounded-md border p-2\">\r\n                  <div className=\"space-y-1\">\r\n                    {categories.map((category) => (\r\n                      <div key={category.id} className=\"flex items-center justify-between p-2 rounded-md hover:bg-gray-50\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Tag className=\"h-3 w-3 text-gray-500\" />\r\n                          <span className=\"text-sm\">{category.name}</span>\r\n                          {category.isDefault && (\r\n                            <Badge variant=\"secondary\" className=\"text-xs\">Default</Badge>\r\n                          )}\r\n                        </div>\r\n                        <AlertDialog>\r\n                          <AlertDialogTrigger asChild>\r\n                            <Button variant=\"ghost\" size=\"sm\" className=\"h-6 w-6 p-0\">\r\n                              <Trash2 className=\"h-3 w-3 text-red-500\" />\r\n                            </Button>\r\n                          </AlertDialogTrigger>\r\n                          <AlertDialogContent>\r\n                            <AlertDialogHeader>\r\n                              <AlertDialogTitle>Delete Category</AlertDialogTitle>\r\n                              <AlertDialogDescription>\r\n                                Are you sure you want to delete \"{category.name}\"? This action cannot be undone.\r\n                              </AlertDialogDescription>\r\n                            </AlertDialogHeader>\r\n                            <AlertDialogFooter>\r\n                              <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n                              <AlertDialogAction \r\n                                onClick={() => handleDeleteCategory(category.id)}\r\n                                className=\"bg-red-600 hover:bg-red-700\"\r\n                              >\r\n                                Delete\r\n                              </AlertDialogAction>\r\n                            </AlertDialogFooter>\r\n                          </AlertDialogContent>\r\n                        </AlertDialog>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </ScrollArea>\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-4 text-sm text-gray-500\">\r\n                No categories yet. Add one above to get started.\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n        \r\n        <DialogFooter>\r\n          <DialogClose asChild>\r\n            <Button variant=\"outline\">Close</Button>\r\n          </DialogClose>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ExpenseCategoriesManager;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAUA;AAWA;AACA;;;;;;;;;;;;;AAEA,MAAM,2BAAqC;;IACzC,MAAM,oBAAoB,IAAA,+JAAoB;IAC9C,MAAM,EAAE,UAAU,EAAE,cAAc,EAAE,cAAc,EAAE,GAAG;IACvD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IACvD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IAErC,MAAM,uBAAuB;QAC3B,IAAI,CAAC,gBAAgB,IAAI,IAAI;QAE7B,gBAAgB;QAChB,IAAI;YACF,MAAM,SAAS,MAAM,eAAe,gBAAgB,IAAI;YACxD,IAAI,QAAQ;gBACV,mBAAmB;YACrB;QACF,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,MAAM,uBAAuB,OAAO;QAClC,gBAAgB;QAChB,IAAI;YACF,MAAM,eAAe;QACvB,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,qBACE,6LAAC,+IAAM;QAAC,MAAM;QAAQ,cAAc;;0BAClC,6LAAC,sJAAa;gBAAC,OAAO;0BACpB,cAAA,6LAAC,+IAAM;oBAAC,SAAQ;oBAAU,WAAU;;sCAClC,6LAAC,0MAAG;4BAAC,WAAU;;;;;;wBAAY;;;;;;;;;;;;0BAI/B,6LAAC,sJAAa;gBAAC,WAAU;;kCACvB,6LAAC,qJAAY;;0CACX,6LAAC,oJAAW;0CAAC;;;;;;0CACb,6LAAC,0JAAiB;0CAAC;;;;;;;;;;;;kCAKrB,6LAAC;wBAAI,WAAU;;0CAEb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,6IAAK;wCAAC,SAAQ;kDAAc;;;;;;kDAC7B,6LAAC;wCAAI,WAAU;;0DACb,6LAAC,6IAAK;gDACJ,IAAG;gDACH,aAAY;gDACZ,OAAO;gDACP,UAAU,CAAC,IAAM,mBAAmB,EAAE,MAAM,CAAC,KAAK;gDAClD,YAAY,CAAC,IAAM,EAAE,GAAG,KAAK,WAAW;;;;;;0DAE1C,6LAAC,+IAAM;gDACL,SAAS;gDACT,UAAU,CAAC,gBAAgB,IAAI,MAAM;gDACrC,MAAK;0DAEL,cAAA,6LAAC,6MAAI;oDAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;0CAMtB,6LAAC;gCAAI,WAAU;0CACZ,WAAW,MAAM,GAAG,kBACnB,6LAAC;;sDACC,6LAAC;4CAAG,WAAU;sDAAyC;;;;;;sDACvD,6LAAC,2JAAU;4CAAC,WAAU;sDACpB,cAAA,6LAAC;gDAAI,WAAU;0DACZ,WAAW,GAAG,CAAC,CAAC,yBACf,6LAAC;wDAAsB,WAAU;;0EAC/B,6LAAC;gEAAI,WAAU;;kFACb,6LAAC,0MAAG;wEAAC,WAAU;;;;;;kFACf,6LAAC;wEAAK,WAAU;kFAAW,SAAS,IAAI;;;;;;oEACvC,SAAS,SAAS,kBACjB,6LAAC,6IAAK;wEAAC,SAAQ;wEAAY,WAAU;kFAAU;;;;;;;;;;;;0EAGnD,6LAAC,6JAAW;;kFACV,6LAAC,oKAAkB;wEAAC,OAAO;kFACzB,cAAA,6LAAC,+IAAM;4EAAC,SAAQ;4EAAQ,MAAK;4EAAK,WAAU;sFAC1C,cAAA,6LAAC,uNAAM;gFAAC,WAAU;;;;;;;;;;;;;;;;kFAGtB,6LAAC,oKAAkB;;0FACjB,6LAAC,mKAAiB;;kGAChB,6LAAC,kKAAgB;kGAAC;;;;;;kGAClB,6LAAC,wKAAsB;;4FAAC;4FACY,SAAS,IAAI;4FAAC;;;;;;;;;;;;;0FAGpD,6LAAC,mKAAiB;;kGAChB,6LAAC,mKAAiB;kGAAC;;;;;;kGACnB,6LAAC,mKAAiB;wFAChB,SAAS,IAAM,qBAAqB,SAAS,EAAE;wFAC/C,WAAU;kGACX;;;;;;;;;;;;;;;;;;;;;;;;;uDA1BC,SAAS,EAAE;;;;;;;;;;;;;;;;;;;;6FAsC7B,6LAAC;oCAAI,WAAU;8CAAyC;;;;;;;;;;;;;;;;;kCAO9D,6LAAC,qJAAY;kCACX,cAAA,6LAAC,oJAAW;4BAAC,OAAO;sCAClB,cAAA,6LAAC,+IAAM;gCAAC,SAAQ;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;GAjIM;;QACsB,+JAAoB;;;KAD1C;uCAmIS"}},
    {"offset": {"line": 1628, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/ExpenseHeader.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Plus, RefreshCcw, Download, FileText, Upload } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from '@/components/ui/dropdown-menu';\r\nimport ExpenseCategoriesManager from '@/components/expenses/ExpenseCategoriesManager';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\n\r\ninterface ExpenseHeaderProps {\r\n  onAddExpense: () => void;\r\n  onAddBulkExpense: () => void;\r\n  onImportExpenses: () => void;\r\n  onRefresh: () => void;\r\n  isRefreshing: boolean;\r\n  onExportCSV?: () => void;\r\n  onExportPDF?: () => void;\r\n  onDownloadTemplate?: () => void;\r\n  canCreate?: boolean;\r\n}\r\n\r\nconst ExpenseHeader: React.FC<ExpenseHeaderProps> = ({\r\n  onAddExpense,\r\n  onAddBulkExpense,\r\n  onImportExpenses,\r\n  onRefresh,\r\n  isRefreshing,\r\n  onExportCSV,\r\n  onExportPDF,\r\n  onDownloadTemplate,\r\n  canCreate = true\r\n}) => {\r\n  const isMobile = useIsMobile();\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"space-y-2\">\r\n        <h1 className=\"text-2xl md:text-3xl font-bold\">Expenses</h1>\r\n        <p className=\"text-sm md:text-base text-muted-foreground\">\r\n          Track and manage your business expenses\r\n        </p>\r\n      </div>\r\n\r\n      {/* Action Buttons Row 1 */}\r\n      <div className=\"flex flex-wrap gap-2 sm:gap-3\">\r\n        {canCreate && (\r\n          <Button\r\n            onClick={onAddExpense}\r\n            className=\"gap-2 text-sm bg-red-600 hover:bg-red-700 shadow-sm\"\r\n            size={isMobile ? \"sm\" : \"default\"}\r\n          >\r\n            <Plus className=\"h-4 w-4\" />\r\n            Add Expense\r\n          </Button>\r\n        )}\r\n        <Button\r\n          variant=\"outline\"\r\n          onClick={onRefresh}\r\n          disabled={isRefreshing}\r\n          className=\"gap-2 text-sm\"\r\n          size={isMobile ? \"sm\" : \"default\"}\r\n        >\r\n          <RefreshCcw className={`h-4 w-4 ${isRefreshing ? 'animate-spin' : ''}`} />\r\n          Refresh\r\n        </Button>\r\n\r\n        <Button\r\n          variant=\"outline\"\r\n          onClick={onDownloadTemplate}\r\n          className=\"gap-2 text-sm border-green-200 dark:border-green-900/30 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/10\"\r\n          size={isMobile ? \"sm\" : \"default\"}\r\n        >\r\n          <Download className=\"h-4 w-4\" />\r\n          Template\r\n        </Button>\r\n\r\n        <div className=\"hidden sm:block\">\r\n          <ExpenseCategoriesManager />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Action Buttons Row 2 (Secondary Actions) */}\r\n      <div className=\"flex flex-wrap items-center gap-2 pt-1 border-t border-slate-100 dark:border-slate-800/50 mt-2\">\r\n        {canCreate && (\r\n          <Button\r\n            variant=\"ghost\"\r\n            onClick={onAddBulkExpense}\r\n            className=\"gap-2 text-xs h-8 px-3 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/10\"\r\n          >\r\n            <Plus className=\"h-3.5 w-3.5\" />\r\n            Bulk Entry\r\n          </Button>\r\n        )}\r\n        {canCreate && (\r\n          <Button\r\n            variant=\"ghost\"\r\n            onClick={onImportExpenses}\r\n            className=\"gap-2 text-xs h-8 px-3 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/10\"\r\n          >\r\n            <Upload className=\"h-3.5 w-3.5\" />\r\n            Import\r\n          </Button>\r\n        )}\r\n\r\n        <div className=\"h-4 w-[1px] bg-slate-200 dark:bg-slate-700 mx-1\" />\r\n\r\n        {onExportCSV && (\r\n          <Button\r\n            variant=\"ghost\"\r\n            onClick={onExportCSV}\r\n            className=\"gap-2 text-xs h-8 px-3 text-slate-600 dark:text-slate-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/10\"\r\n          >\r\n            <FileText className=\"h-3.5 w-3.5\" />\r\n            CSV Export\r\n          </Button>\r\n        )}\r\n        {onExportPDF && (\r\n          <Button\r\n            variant=\"ghost\"\r\n            onClick={onExportPDF}\r\n            className=\"gap-2 text-xs h-8 px-3 text-slate-600 dark:text-slate-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/10\"\r\n          >\r\n            <FileText className=\"h-3.5 w-3.5\" />\r\n            PDF Export\r\n          </Button>\r\n        )}\r\n\r\n        <div className=\"sm:hidden block ml-auto\">\r\n          <ExpenseCategoriesManager />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ExpenseHeader;"],"names":[],"mappings":";;;;;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAOA;AACA;;;;;;;AAcA,MAAM,gBAA8C,CAAC,EACnD,YAAY,EACZ,gBAAgB,EAChB,gBAAgB,EAChB,SAAS,EACT,YAAY,EACZ,WAAW,EACX,WAAW,EACX,kBAAkB,EAClB,YAAY,IAAI,EACjB;;IACC,MAAM,WAAW,IAAA,gJAAW;IAE5B,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;kCAAiC;;;;;;kCAC/C,6LAAC;wBAAE,WAAU;kCAA6C;;;;;;;;;;;;0BAM5D,6LAAC;gBAAI,WAAU;;oBACZ,2BACC,6LAAC,+IAAM;wBACL,SAAS;wBACT,WAAU;wBACV,MAAM,WAAW,OAAO;;0CAExB,6LAAC,6MAAI;gCAAC,WAAU;;;;;;4BAAY;;;;;;;kCAIhC,6LAAC,+IAAM;wBACL,SAAQ;wBACR,SAAS;wBACT,UAAU;wBACV,WAAU;wBACV,MAAM,WAAW,OAAO;;0CAExB,6LAAC,mOAAU;gCAAC,WAAW,CAAC,QAAQ,EAAE,eAAe,iBAAiB,IAAI;;;;;;4BAAI;;;;;;;kCAI5E,6LAAC,+IAAM;wBACL,SAAQ;wBACR,SAAS;wBACT,WAAU;wBACV,MAAM,WAAW,OAAO;;0CAExB,6LAAC,yNAAQ;gCAAC,WAAU;;;;;;4BAAY;;;;;;;kCAIlC,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,wKAAwB;;;;;;;;;;;;;;;;0BAK7B,6LAAC;gBAAI,WAAU;;oBACZ,2BACC,6LAAC,+IAAM;wBACL,SAAQ;wBACR,SAAS;wBACT,WAAU;;0CAEV,6LAAC,6MAAI;gCAAC,WAAU;;;;;;4BAAgB;;;;;;;oBAInC,2BACC,6LAAC,+IAAM;wBACL,SAAQ;wBACR,SAAS;wBACT,WAAU;;0CAEV,6LAAC,mNAAM;gCAAC,WAAU;;;;;;4BAAgB;;;;;;;kCAKtC,6LAAC;wBAAI,WAAU;;;;;;oBAEd,6BACC,6LAAC,+IAAM;wBACL,SAAQ;wBACR,SAAS;wBACT,WAAU;;0CAEV,6LAAC,6NAAQ;gCAAC,WAAU;;;;;;4BAAgB;;;;;;;oBAIvC,6BACC,6LAAC,+IAAM;wBACL,SAAQ;wBACR,SAAS;wBACT,WAAU;;0CAEV,6LAAC,6NAAQ;gCAAC,WAAU;;;;;;4BAAgB;;;;;;;kCAKxC,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,wKAAwB;;;;;;;;;;;;;;;;;;;;;;AAKnC;GAhHM;;QAWa,gJAAW;;;KAXxB;uCAkHS"}},
    {"offset": {"line": 1886, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/hooks/useFinancialVisibility.ts"],"sourcesContent":["import { useProfiles } from '@/contexts/ProfileContext';\r\n\r\n/**\r\n * Hook to handle financial data visibility based on permissions\r\n */\r\nexport const useFinancialVisibility = () => {\r\n    const { hasPermission } = useProfiles();\r\n\r\n    const canViewCostPrice = hasPermission('inventory', 'view_cost_price');\r\n    const canViewProfit = hasPermission('inventory', 'view_profit');\r\n    const canViewSellingPrice = hasPermission('inventory', 'view_selling_price');\r\n\r\n    // Dashboard-specific permissions\r\n    const canViewTotalSales = hasPermission('dashboard', 'view_total_sales');\r\n    const canViewTotalGrossProfit = hasPermission('dashboard', 'view_gross_profit');\r\n    const canViewTotalExpenses = hasPermission('dashboard', 'view_total_expenses');\r\n    const canViewInventoryValue = hasPermission('dashboard', 'view_inventory_value');\r\n    const canViewSalesTypes = hasPermission('dashboard', 'view_sales_types');\r\n    const canViewAvgPrice = hasPermission('dashboard', 'view_avg_price');\r\n    const canViewTotalAmount = hasPermission('dashboard', 'view_total_amount');\r\n\r\n    // Finance and Expenses permissions\r\n    const canManageFinanceAccounts = hasPermission('finance', 'manage_accounts');\r\n    const canViewFinance = hasPermission('finance', 'view');\r\n    const canViewExpenses = hasPermission('expenses', 'view');\r\n    const canCreateExpenses = hasPermission('expenses', 'create');\r\n    const canEditExpenses = hasPermission('expenses', 'edit');\r\n    const canDeleteExpenses = hasPermission('expenses', 'delete');\r\n\r\n    /**\r\n     * Format a financial value or return a hidden indicator\r\n     */\r\n    const formatFinancial = (value: number | null | undefined, type: 'cost' | 'selling' | 'profit'): string => {\r\n        const hasAccess =\r\n            (type === 'cost' && canViewCostPrice) ||\r\n            (type === 'selling' && canViewSellingPrice) ||\r\n            (type === 'profit' && canViewProfit);\r\n\r\n        if (!hasAccess) {\r\n            return '';\r\n        }\r\n\r\n        return value?.toLocaleString() || '0';\r\n    };\r\n\r\n    return {\r\n        canViewCostPrice,\r\n        canViewProfit,\r\n        canViewSellingPrice,\r\n        canViewTotalSales,\r\n        canViewTotalGrossProfit,\r\n        canViewTotalExpenses,\r\n        canViewInventoryValue,\r\n        canViewSalesTypes,\r\n        canViewAvgPrice,\r\n        canViewTotalAmount,\r\n        canManageFinanceAccounts,\r\n        canViewFinance,\r\n        canViewExpenses,\r\n        canCreateExpenses,\r\n        canEditExpenses,\r\n        canDeleteExpenses,\r\n        formatFinancial,\r\n    };\r\n};\r\n"],"names":[],"mappings":";;;;AAAA;;;AAKO,MAAM,yBAAyB;;IAClC,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,oJAAW;IAErC,MAAM,mBAAmB,cAAc,aAAa;IACpD,MAAM,gBAAgB,cAAc,aAAa;IACjD,MAAM,sBAAsB,cAAc,aAAa;IAEvD,iCAAiC;IACjC,MAAM,oBAAoB,cAAc,aAAa;IACrD,MAAM,0BAA0B,cAAc,aAAa;IAC3D,MAAM,uBAAuB,cAAc,aAAa;IACxD,MAAM,wBAAwB,cAAc,aAAa;IACzD,MAAM,oBAAoB,cAAc,aAAa;IACrD,MAAM,kBAAkB,cAAc,aAAa;IACnD,MAAM,qBAAqB,cAAc,aAAa;IAEtD,mCAAmC;IACnC,MAAM,2BAA2B,cAAc,WAAW;IAC1D,MAAM,iBAAiB,cAAc,WAAW;IAChD,MAAM,kBAAkB,cAAc,YAAY;IAClD,MAAM,oBAAoB,cAAc,YAAY;IACpD,MAAM,kBAAkB,cAAc,YAAY;IAClD,MAAM,oBAAoB,cAAc,YAAY;IAEpD;;KAEC,GACD,MAAM,kBAAkB,CAAC,OAAkC;QACvD,MAAM,YACF,AAAC,SAAS,UAAU,oBACnB,SAAS,aAAa,uBACtB,SAAS,YAAY;QAE1B,IAAI,CAAC,WAAW;YACZ,OAAO;QACX;QAEA,OAAO,OAAO,oBAAoB;IACtC;IAEA,OAAO;QACH;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;IACJ;AACJ;GA3Da;;QACiB,oJAAW"}},
    {"offset": {"line": 1955, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/ExpenseStatsCards.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\ninterface ExpenseStatsCardsProps {\r\n  totalExpenses: number;\r\n  thisMonthExpenses: number;\r\n  transactionCount: number;\r\n  formatCurrency: (amount: number) => string;\r\n  dateFilter: string;\r\n}\r\n\r\nconst ExpenseStatsCards: React.FC<ExpenseStatsCardsProps> = ({\r\n  totalExpenses,\r\n  thisMonthExpenses,\r\n  transactionCount,\r\n  formatCurrency,\r\n  dateFilter\r\n}) => {\r\n  const { canViewTotalExpenses } = useFinancialVisibility();\r\n  return (\r\n    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n      <Card>\r\n        <CardHeader className=\"pb-3\">\r\n          <CardTitle className=\"text-sm font-medium text-muted-foreground\">\r\n            Total Expenses ({dateFilter === 'all' ? 'All Time' : dateFilter.replace('-', ' ').replace(/\\b\\w/g, l => l.toUpperCase())})\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"text-2xl font-bold text-red-600\">\r\n            {canViewTotalExpenses ? formatCurrency(totalExpenses) : ''}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card>\r\n        <CardHeader className=\"pb-3\">\r\n          <CardTitle className=\"text-sm font-medium text-muted-foreground\">\r\n            This Month\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"text-2xl font-bold\">\r\n            {canViewTotalExpenses ? formatCurrency(thisMonthExpenses) : ''}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card>\r\n        <CardHeader className=\"pb-3\">\r\n          <CardTitle className=\"text-sm font-medium text-muted-foreground\">\r\n            Total Transactions\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"text-2xl font-bold\">\r\n            {transactionCount}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ExpenseStatsCards;"],"names":[],"mappings":";;;;;AACA;AACA;;;;;AAUA,MAAM,oBAAsD,CAAC,EAC3D,aAAa,EACb,iBAAiB,EACjB,gBAAgB,EAChB,cAAc,EACd,UAAU,EACX;;IACC,MAAM,EAAE,oBAAoB,EAAE,GAAG,IAAA,mKAAsB;IACvD,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,2IAAI;;kCACH,6LAAC,iJAAU;wBAAC,WAAU;kCACpB,cAAA,6LAAC,gJAAS;4BAAC,WAAU;;gCAA4C;gCAC9C,eAAe,QAAQ,aAAa,WAAW,OAAO,CAAC,KAAK,KAAK,OAAO,CAAC,SAAS,CAAA,IAAK,EAAE,WAAW;gCAAI;;;;;;;;;;;;kCAG7H,6LAAC,kJAAW;kCACV,cAAA,6LAAC;4BAAI,WAAU;sCACZ,uBAAuB,eAAe,iBAAiB;;;;;;;;;;;;;;;;;0BAK9D,6LAAC,2IAAI;;kCACH,6LAAC,iJAAU;wBAAC,WAAU;kCACpB,cAAA,6LAAC,gJAAS;4BAAC,WAAU;sCAA4C;;;;;;;;;;;kCAInE,6LAAC,kJAAW;kCACV,cAAA,6LAAC;4BAAI,WAAU;sCACZ,uBAAuB,eAAe,qBAAqB;;;;;;;;;;;;;;;;;0BAKlE,6LAAC,2IAAI;;kCACH,6LAAC,iJAAU;wBAAC,WAAU;kCACpB,cAAA,6LAAC,gJAAS;4BAAC,WAAU;sCAA4C;;;;;;;;;;;kCAInE,6LAAC,kJAAW;kCACV,cAAA,6LAAC;4BAAI,WAAU;sCACZ;;;;;;;;;;;;;;;;;;;;;;;AAMb;GAlDM;;QAO6B,mKAAsB;;;KAPnD;uCAoDS"}},
    {"offset": {"line": 2110, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/RecentExpensesCard.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Expense } from '@/hooks/useExpenses';\r\n\r\ninterface RecentExpensesCardProps {\r\n  filteredExpenses: Expense[];\r\n  formatCurrency: (amount: number) => string;\r\n}\r\n\r\nconst RecentExpensesCard: React.FC<RecentExpensesCardProps> = ({\r\n  filteredExpenses,\r\n  formatCurrency\r\n}) => {\r\n  return (\r\n    <Card>\r\n      <CardHeader className=\"pb-3 md:pb-6\">\r\n        <CardTitle className=\"text-lg md:text-xl\">Recent Expenses</CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"px-3 md:px-6\">\r\n        {filteredExpenses.length === 0 ? (\r\n          <div className=\"text-center py-8\">\r\n            <p className=\"text-muted-foreground\">No expenses found for the selected period.</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            {filteredExpenses.slice(0, 10).map((expense) => (\r\n              <div key={expense.id} className=\"flex items-center justify-between p-4 border rounded-lg\">\r\n                <div className=\"space-y-1\">\r\n                  <div className=\"font-medium\">{expense.description}</div>\r\n                  <div className=\"text-sm text-muted-foreground\">\r\n                    {expense.date.toLocaleDateString()}  {expense.category || 'Uncategorized'}\r\n                  </div>\r\n                </div>\r\n                <div className=\"text-right\">\r\n                  <div className=\"font-semibold text-red-600\">\r\n                    {formatCurrency(expense.amount)}\r\n                  </div>\r\n                  {expense.cashAccountId && (\r\n                    <div className=\"text-xs text-muted-foreground\">\r\n                      Linked to Cash\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default RecentExpensesCard;"],"names":[],"mappings":";;;;;AACA;;;AAQA,MAAM,qBAAwD,CAAC,EAC7D,gBAAgB,EAChB,cAAc,EACf;IACC,qBACE,6LAAC,2IAAI;;0BACH,6LAAC,iJAAU;gBAAC,WAAU;0BACpB,cAAA,6LAAC,gJAAS;oBAAC,WAAU;8BAAqB;;;;;;;;;;;0BAE5C,6LAAC,kJAAW;gBAAC,WAAU;0BACpB,iBAAiB,MAAM,KAAK,kBAC3B,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAE,WAAU;kCAAwB;;;;;;;;;;6EAGvC,6LAAC;oBAAI,WAAU;8BACZ,iBAAiB,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC,CAAC,wBAClC,6LAAC;4BAAqB,WAAU;;8CAC9B,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;sDAAe,QAAQ,WAAW;;;;;;sDACjD,6LAAC;4CAAI,WAAU;;gDACZ,QAAQ,IAAI,CAAC,kBAAkB;gDAAG;gDAAI,QAAQ,QAAQ,IAAI;;;;;;;;;;;;;8CAG/D,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;sDACZ,eAAe,QAAQ,MAAM;;;;;;wCAE/B,QAAQ,aAAa,kBACpB,6LAAC;4CAAI,WAAU;sDAAgC;;;;;;;;;;;;;2BAZ3C,QAAQ,EAAE;;;;;;;;;;;;;;;;;;;;;AAwBlC;KAzCM;uCA2CS"}},
    {"offset": {"line": 2245, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/tabs.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Tabs = TabsPrimitive.Root\r\n\r\nconst TabsList = React.forwardRef<\r\n  React.ElementRef<typeof TabsPrimitive.List>,\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\r\n>(({ className, ...props }, ref) => (\r\n  <TabsPrimitive.List\r\n    ref={ref}\r\n    className={cn(\r\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTabsList.displayName = TabsPrimitive.List.displayName\r\n\r\nconst TabsTrigger = React.forwardRef<\r\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\r\n>(({ className, ...props }, ref) => (\r\n  <TabsPrimitive.Trigger\r\n    ref={ref}\r\n    className={cn(\r\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\r\n\r\nconst TabsContent = React.forwardRef<\r\n  React.ElementRef<typeof TabsPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\r\n>(({ className, ...props }, ref) => (\r\n  <TabsPrimitive.Content\r\n    ref={ref}\r\n    className={cn(\r\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTabsContent.displayName = TabsPrimitive.Content.displayName\r\n\r\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\r\n"],"names":[],"mappings":";;;;;;;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,OAAO,2KAAkB;AAE/B,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,2KAAkB;QACjB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,8FACA;QAED,GAAG,KAAK;;;;;;;AAGb,SAAS,WAAW,GAAG,2KAAkB,CAAC,WAAW;AAErD,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,8KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,uYACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,8KAAqB,CAAC,WAAW;AAE3D,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,8KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,mIACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,8KAAqB,CAAC,WAAW"}},
    {"offset": {"line": 2312, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/ExpenseCategoriesSummary.tsx"],"sourcesContent":["\r\nimport React, { useState, useMemo } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { PieChart, Pie, ResponsiveContainer, Cell, Legend, Tooltip } from 'recharts';\r\nimport { ChartContainer, ChartTooltipContent } from '@/components/ui/chart';\r\nimport { Expense } from '@/hooks/useExpenses';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\ntype CategorySummaryItem = {\r\n  name: string;\r\n  value: number;\r\n  percentage: number;\r\n  count: number;\r\n};\r\n\r\ntype ExpenseCategoriesSummaryProps = {\r\n  expenses: Expense[];\r\n  formatCurrency: (amount: number) => string;\r\n};\r\n\r\n// Generate improved color palette for pie chart segments\r\nconst COLORS = [\r\n  '#9b87f5', '#7E69AB', '#6E59A5', '#D6BCFA', '#E5DEFF',\r\n  '#0EA5E9', '#F97316', '#D946EF', '#F2FCE2', '#FEF7CD',\r\n  '#FEC6A1', '#FFDEE2', '#FDE1D3', '#D3E4FD', '#F1F0FB'\r\n];\r\n\r\nconst ExpenseCategoriesSummary: React.FC<ExpenseCategoriesSummaryProps> = ({\r\n  expenses,\r\n  formatCurrency\r\n}) => {\r\n  const { canViewTotalExpenses } = useFinancialVisibility();\r\n  const [viewMode, setViewMode] = useState<'category' | 'person'>('category');\r\n\r\n  // Process expenses data to get category or person in charge summaries\r\n  const summarizedData = useMemo(() => {\r\n    const totalExpenseAmount = expenses.reduce((sum, expense) => sum + expense.amount, 0);\r\n\r\n    if (viewMode === 'category') {\r\n      // Group by category (case insensitive)\r\n      const categoryMap = new Map<string, { total: number, count: number }>();\r\n\r\n      expenses.forEach(expense => {\r\n        // Normalize category name (case insensitive) and handle null\r\n        const categoryName = (expense.category || 'Uncategorized').toLowerCase().trim();\r\n\r\n        const existingCategory = categoryMap.get(categoryName);\r\n        if (existingCategory) {\r\n          existingCategory.total += expense.amount;\r\n          existingCategory.count += 1;\r\n        } else {\r\n          categoryMap.set(categoryName, { total: expense.amount, count: 1 });\r\n        }\r\n      });\r\n\r\n      // Convert map to array and sort by amount (descending)\r\n      return Array.from(categoryMap.entries())\r\n        .map(([name, { total, count }]) => ({\r\n          name: name.charAt(0).toUpperCase() + name.slice(1), // Capitalize first letter\r\n          value: total,\r\n          percentage: (total / totalExpenseAmount) * 100,\r\n          count\r\n        }))\r\n        .sort((a, b) => b.value - a.value);\r\n\r\n    } else {\r\n      // Group by person in charge (case insensitive)\r\n      const personMap = new Map<string, { total: number, count: number }>();\r\n\r\n      expenses.forEach(expense => {\r\n        // Normalize person name (case insensitive) and handle null\r\n        const personName = (expense.personInCharge || 'Unassigned').toLowerCase().trim();\r\n\r\n        const existingPerson = personMap.get(personName);\r\n        if (existingPerson) {\r\n          existingPerson.total += expense.amount;\r\n          existingPerson.count += 1;\r\n        } else {\r\n          personMap.set(personName, { total: expense.amount, count: 1 });\r\n        }\r\n      });\r\n\r\n      // Convert map to array and sort by amount (descending)\r\n      return Array.from(personMap.entries())\r\n        .map(([name, { total, count }]) => ({\r\n          name: name.charAt(0).toUpperCase() + name.slice(1), // Capitalize first letter\r\n          value: total,\r\n          percentage: (total / totalExpenseAmount) * 100,\r\n          count\r\n        }))\r\n        .sort((a, b) => b.value - a.value);\r\n    }\r\n  }, [expenses, viewMode]);\r\n\r\n  // Custom tooltip for the pie chart\r\n  const CustomTooltip = ({ active, payload }: any) => {\r\n    if (active && payload && payload.length) {\r\n      const data = payload[0].payload;\r\n      return (\r\n        <div className=\"bg-card p-3 shadow rounded border border-border text-sm\">\r\n          <p className=\"font-medium text-foreground\">{data.name}</p>\r\n          <p className=\"text-primary\">{canViewTotalExpenses ? formatCurrency(data.value) : ''}</p>\r\n          <p className=\"text-muted-foreground\">{data.percentage.toFixed(1)}% of total</p>\r\n          <p className=\"text-xs\">{data.count} expense{data.count !== 1 ? 's' : ''}</p>\r\n        </div>\r\n      );\r\n    }\r\n    return null;\r\n  };\r\n\r\n  return (\r\n    <Card className=\"mt-6\">\r\n      <CardHeader className=\"pb-3\">\r\n        <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n          <CardTitle className=\"text-lg sm:text-xl\">Expense Distribution</CardTitle>\r\n          <Tabs\r\n            value={viewMode}\r\n            onValueChange={(value) => setViewMode(value as 'category' | 'person')}\r\n            className=\"w-full sm:w-auto\"\r\n          >\r\n            <TabsList className=\"grid w-full grid-cols-2\">\r\n              <TabsTrigger value=\"category\">By Category</TabsTrigger>\r\n              <TabsTrigger value=\"person\">By Person</TabsTrigger>\r\n            </TabsList>\r\n          </Tabs>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent className=\"pt-2\">\r\n        {summarizedData.length > 0 ? (\r\n          <div className=\"flex flex-col lg:flex-row space-y-6 lg:space-y-0 lg:space-x-4\">\r\n            {/* Chart section */}\r\n            <div className=\"w-full lg:w-1/2 flex flex-col items-center\">\r\n              <div className=\"h-[220px] sm:h-[260px] w-full max-w-[280px] mx-auto\">\r\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                  <PieChart margin={{ top: 5, right: 5, bottom: 5, left: 5 }}>\r\n                    <Pie\r\n                      data={summarizedData}\r\n                      cx=\"50%\"\r\n                      cy=\"50%\"\r\n                      labelLine={false}\r\n                      outerRadius={80}\r\n                      innerRadius={36}\r\n                      paddingAngle={1.5}\r\n                      dataKey=\"value\"\r\n                      stroke=\"#ffffff\"\r\n                      strokeWidth={1.5}\r\n                    >\r\n                      {summarizedData.map((entry, index) => (\r\n                        <Cell\r\n                          key={`cell-${index}`}\r\n                          fill={COLORS[index % COLORS.length]}\r\n                          className=\"hover:opacity-80 transition-opacity\"\r\n                        />\r\n                      ))}\r\n                    </Pie>\r\n                    <Tooltip content={<CustomTooltip />} />\r\n                  </PieChart>\r\n                </ResponsiveContainer>\r\n              </div>\r\n\r\n              <div className=\"mt-2 text-xs text-center text-muted-foreground\">\r\n                <p>Tap segments for details</p>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Legend section - Mobile optimized */}\r\n            <div className=\"w-full lg:w-1/2\">\r\n              <div className=\"space-y-1\">\r\n                <h3 className=\"text-sm font-medium mb-1.5 px-1\">\r\n                  {viewMode === 'category' ? 'Categories' : 'People'} Breakdown\r\n                </h3>\r\n                <div className=\"space-y-0 max-h-[220px] sm:max-h-[260px] overflow-y-auto pr-1 rounded-md\">\r\n                  {summarizedData.map((item, index) => (\r\n                    <div\r\n                      key={index}\r\n                      className=\"flex justify-between items-center border-b border-border/40 py-2 px-1 hover:bg-muted/50 rounded-sm transition-colors\"\r\n                    >\r\n                      <div className=\"flex items-center space-x-1.5\">\r\n                        <div\r\n                          className=\"w-2.5 h-2.5 rounded-full flex-shrink-0\"\r\n                          style={{ backgroundColor: COLORS[index % COLORS.length] }}\r\n                        />\r\n                        <span className=\"truncate max-w-[120px] sm:max-w-[160px] text-xs sm:text-sm\">\r\n                          {item.name}\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"text-right\">\r\n                        <div className=\"font-medium text-xs sm:text-sm\">{canViewTotalExpenses ? formatCurrency(item.value) : ''}</div>\r\n                        <div className=\"text-[10px] sm:text-xs text-muted-foreground\">\r\n                          {item.percentage.toFixed(1)}%\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"flex flex-col items-center justify-center h-[160px] sm:h-[200px] text-center text-muted-foreground\">\r\n            <p className=\"text-sm\">No expense data available.</p>\r\n            <p className=\"text-xs mt-2\">Try a different date range or add some expenses.</p>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default ExpenseCategoriesSummary;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2791, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/table.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Table = React.forwardRef<\r\n  HTMLTableElement,\r\n  React.HTMLAttributes<HTMLTableElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div className=\"relative w-full overflow-auto\">\r\n    <table\r\n      ref={ref}\r\n      className={cn(\"w-full caption-bottom text-sm\", className)}\r\n      {...props}\r\n    />\r\n  </div>\r\n))\r\nTable.displayName = \"Table\"\r\n\r\nconst TableHeader = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\r\n))\r\nTableHeader.displayName = \"TableHeader\"\r\n\r\nconst TableBody = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tbody\r\n    ref={ref}\r\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\r\n    {...props}\r\n  />\r\n))\r\nTableBody.displayName = \"TableBody\"\r\n\r\nconst TableFooter = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tfoot\r\n    ref={ref}\r\n    className={cn(\r\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableFooter.displayName = \"TableFooter\"\r\n\r\nconst TableRow = React.forwardRef<\r\n  HTMLTableRowElement,\r\n  React.HTMLAttributes<HTMLTableRowElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tr\r\n    ref={ref}\r\n    className={cn(\r\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableRow.displayName = \"TableRow\"\r\n\r\nconst TableHead = React.forwardRef<\r\n  HTMLTableCellElement,\r\n  React.ThHTMLAttributes<HTMLTableCellElement>\r\n>(({ className, ...props }, ref) => (\r\n  <th\r\n    ref={ref}\r\n    className={cn(\r\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableHead.displayName = \"TableHead\"\r\n\r\nconst TableCell = React.forwardRef<\r\n  HTMLTableCellElement,\r\n  React.TdHTMLAttributes<HTMLTableCellElement>\r\n>(({ className, ...props }, ref) => (\r\n  <td\r\n    ref={ref}\r\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\r\n    {...props}\r\n  />\r\n))\r\nTableCell.displayName = \"TableCell\"\r\n\r\nconst TableCaption = React.forwardRef<\r\n  HTMLTableCaptionElement,\r\n  React.HTMLAttributes<HTMLTableCaptionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <caption\r\n    ref={ref}\r\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nTableCaption.displayName = \"TableCaption\"\r\n\r\nexport {\r\n  Table,\r\n  TableHeader,\r\n  TableBody,\r\n  TableFooter,\r\n  TableHead,\r\n  TableRow,\r\n  TableCell,\r\n  TableCaption,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,2KAAgB,MAG5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YACC,KAAK;YACL,WAAW,IAAA,4HAAE,EAAC,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;;AAIf,MAAM,WAAW,GAAG;AAEpB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAM,KAAK;QAAK,WAAW,IAAA,4HAAE,EAAC,mBAAmB;QAAa,GAAG,KAAK;;;;;;;AAEzE,YAAY,WAAW,GAAG;AAE1B,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,2DACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,yBAAW,2KAAgB,OAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,+EACA;QAED,GAAG,KAAK;;;;;;;AAGb,SAAS,WAAW,GAAG;AAEvB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,oGACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,kDAAkD;QAC/D,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,6BAAe,2KAAgB,QAGnC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;;AAGb,aAAa,WAAW,GAAG"}},
    {"offset": {"line": 2935, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/hooks/useCashAccounts.ts"],"sourcesContent":["import { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport { CashAccount, CashTransaction } from '@/types/cash';\r\n\r\nexport const useCashAccounts = () => {\r\n  const [accounts, setAccounts] = useState<CashAccount[]>([]);\r\n  const { toast } = useToast();\r\n  const { currentBusiness } = useBusiness();\r\n  const queryClient = useQueryClient();\r\n\r\n  // Memoize the load function to prevent unnecessary re-renders\r\n  const loadAccounts = useCallback(async (): Promise<CashAccount[]> => {\r\n    try {\r\n      if (!currentBusiness) {\r\n        return [];\r\n      }\r\n\r\n      // Optimize query - only select needed fields and limit for faster loading\r\n      const { data, error } = await supabase\r\n        .from('cash_accounts')\r\n        .select('id, name, description, opening_balance, is_default, created_at, updated_at')\r\n        .eq('location_id', currentBusiness.id)\r\n        .order('is_default', { ascending: false })\r\n        .order('name'); // Load all cash accounts\r\n\r\n      if (error) throw error;\r\n\r\n      const formattedAccounts: CashAccount[] = data?.map(account => ({\r\n        id: account.id,\r\n        name: account.name,\r\n        description: account.description,\r\n        openingBalance: account.opening_balance,\r\n        isDefault: account.is_default,\r\n        createdAt: new Date(account.created_at),\r\n        updatedAt: new Date(account.updated_at)\r\n      })) || [];\r\n\r\n      return formattedAccounts;\r\n    } catch (error) {\r\n      console.error('Error loading cash accounts:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to load cash accounts. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return [];\r\n    }\r\n  }, [currentBusiness?.id, toast]);\r\n\r\n  // React Query caching\r\n  const queryKey = ['cash_accounts', currentBusiness?.id];\r\n  const { data: queriedAccounts, isLoading: isQueryLoading, isFetching } = useQuery({\r\n    queryKey,\r\n    queryFn: loadAccounts,\r\n    enabled: !!currentBusiness?.id,\r\n    staleTime: 0, // Ensure data is always considered stale to get fresh updates\r\n    gcTime: 30 * 60_000,\r\n    refetchOnWindowFocus: true,\r\n    refetchOnReconnect: true,\r\n  });\r\n\r\n  // Sync React Query data with local state\r\n  useEffect(() => {\r\n    if (queriedAccounts) {\r\n      setAccounts(queriedAccounts);\r\n    }\r\n  }, [queriedAccounts]);\r\n\r\n  // Derived loading state: only true when first loading (pre cache)\r\n  const isLoading = isQueryLoading && !queriedAccounts;\r\n\r\n  const refreshAccounts = useCallback(() => {\r\n    queryClient.invalidateQueries({ queryKey });\r\n  }, [queryClient, queryKey]);\r\n\r\n  // Memoize create account function\r\n  const createAccount = useCallback(async (accountData: {\r\n    name: string;\r\n    description?: string;\r\n    openingBalance: number;\r\n    isDefault?: boolean;\r\n  }) => {\r\n    try {\r\n      if (!currentBusiness) {\r\n        toast({\r\n          title: \"Error\",\r\n          description: \"No business selected\",\r\n          variant: \"destructive\"\r\n        });\r\n        return null;\r\n      }\r\n\r\n      const { data: userData } = await supabase.auth.getUser();\r\n      if (!userData.user) throw new Error('User not authenticated');\r\n\r\n      const insertData = {\r\n        user_id: userData.user.id,\r\n        location_id: currentBusiness.id,\r\n        name: accountData.name,\r\n        description: accountData.description || null,\r\n        opening_balance: accountData.openingBalance,\r\n        is_default: accountData.isDefault || false\r\n      };\r\n\r\n      const { data, error } = await supabase\r\n        .from('cash_accounts')\r\n        .insert(insertData)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      // Format the new account and update cache immediately\r\n      const newAccount: CashAccount = {\r\n        id: data.id,\r\n        name: data.name,\r\n        description: data.description,\r\n        openingBalance: data.opening_balance,\r\n        isDefault: data.is_default,\r\n        createdAt: new Date(data.created_at),\r\n        updatedAt: new Date(data.updated_at)\r\n      };\r\n\r\n      // Update local state immediately\r\n      setAccounts(prev => [newAccount, ...prev]);\r\n\r\n      // Update React Query cache immediately\r\n      queryClient.setQueryData(queryKey, (oldData: CashAccount[] | undefined) => {\r\n        return oldData ? [newAccount, ...oldData] : [newAccount];\r\n      });\r\n\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Cash account created successfully\"\r\n      });\r\n\r\n      return data;\r\n    } catch (error) {\r\n      console.error('Error creating cash account:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to create cash account. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return null;\r\n    }\r\n  }, [currentBusiness, loadAccounts, toast]);\r\n\r\n  const updateAccount = async (id: string, updates: Partial<CashAccount>) => {\r\n    try {\r\n      const updateData: any = {};\r\n\r\n      if (updates.name !== undefined) updateData.name = updates.name;\r\n      if (updates.description !== undefined) updateData.description = updates.description;\r\n      if (updates.openingBalance !== undefined) updateData.opening_balance = updates.openingBalance;\r\n      if (updates.isDefault !== undefined) updateData.is_default = updates.isDefault;\r\n\r\n      const { error } = await supabase\r\n        .from('cash_accounts')\r\n        .update(updateData)\r\n        .eq('id', id)\r\n        .eq('location_id', currentBusiness?.id);\r\n\r\n      if (error) throw error;\r\n\r\n      // Optimistic update - update local state\r\n      setAccounts(prev => prev.map(a => a.id === id ? {\r\n        ...a,\r\n        name: updates.name ?? a.name,\r\n        description: updates.description ?? a.description,\r\n        openingBalance: updates.openingBalance ?? a.openingBalance,\r\n        isDefault: updates.isDefault ?? a.isDefault,\r\n        updatedAt: new Date()\r\n      } : a));\r\n\r\n      // Update React Query cache immediately\r\n      queryClient.setQueryData(queryKey, (oldData: CashAccount[] | undefined) => {\r\n        return oldData ? oldData.map(a => a.id === id ? {\r\n          ...a,\r\n          name: updates.name ?? a.name,\r\n          description: updates.description ?? a.description,\r\n          openingBalance: updates.openingBalance ?? a.openingBalance,\r\n          isDefault: updates.isDefault ?? a.isDefault,\r\n          updatedAt: new Date()\r\n        } : a) : [];\r\n      });\r\n\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Cash account updated successfully\"\r\n      });\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error updating cash account:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to update cash account. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const deleteAccount = async (id: string, onDeleted?: () => void) => {\r\n    try {\r\n      if (!currentBusiness) return { success: false, hasTransactions: false };\r\n\r\n      // Check if account has transactions\r\n      const { data: transactions, error: transactionError } = await supabase\r\n        .from('cash_transactions')\r\n        .select('id')\r\n        .eq('account_id', id)\r\n        .eq('location_id', currentBusiness.id);\r\n\r\n      if (transactionError) throw transactionError;\r\n\r\n      // Check if account has linked expenses\r\n      const { data: expenses, error: expenseError } = await supabase\r\n        .from('expenses')\r\n        .select('id')\r\n        .eq('cash_account_id', id)\r\n        .eq('location_id', currentBusiness.id);\r\n\r\n      if (expenseError) throw expenseError;\r\n\r\n      const transactionCount = transactions?.length || 0;\r\n      const expenseCount = expenses?.length || 0;\r\n      const totalLinkedRecords = transactionCount + expenseCount;\r\n\r\n      if (totalLinkedRecords > 0) {\r\n        // Return an object indicating the account has linked records\r\n        const details = [];\r\n        if (transactionCount > 0) details.push(`${transactionCount} transaction(s)`);\r\n        if (expenseCount > 0) details.push(`${expenseCount} expense(s)`);\r\n\r\n        return {\r\n          hasTransactions: true,\r\n          transactionCount: totalLinkedRecords,\r\n          details: `This account has ${details.join(' and ')}. What would you like to do?`,\r\n          success: false\r\n        };\r\n      }\r\n\r\n      // If no linked records, delete the account\r\n      const { error } = await supabase\r\n        .from('cash_accounts')\r\n        .delete()\r\n        .eq('id', id)\r\n        .eq('location_id', currentBusiness.id);\r\n\r\n      if (error) throw error;\r\n      // Optimistic remove\r\n      setAccounts(prev => prev.filter(a => a.id !== id));\r\n      queryClient.invalidateQueries({ queryKey });\r\n\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Cash account deleted successfully\"\r\n      });\r\n\r\n      // Call the callback function if provided\r\n      if (onDeleted) {\r\n        onDeleted();\r\n      }\r\n\r\n      return { success: true, hasTransactions: false };\r\n    } catch (error) {\r\n      console.error('Error deleting cash account:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to delete cash account. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return { success: false, hasTransactions: false };\r\n    }\r\n  };\r\n\r\n  const deleteAccountWithTransactions = async (id: string, deleteTransactions: boolean = false, onDeleted?: () => void) => {\r\n    try {\r\n      if (!currentBusiness) return false;\r\n\r\n      if (deleteTransactions) {\r\n        // First delete associated cash transactions\r\n        const { error: transactionError } = await supabase\r\n          .from('cash_transactions')\r\n          .delete()\r\n          .eq('account_id', id)\r\n          .eq('location_id', currentBusiness.id);\r\n\r\n        if (transactionError) throw transactionError;\r\n\r\n        // Then unlink or delete associated expenses\r\n        const { error: expenseError } = await supabase\r\n          .from('expenses')\r\n          .update({\r\n            cash_account_id: null,\r\n            cash_transaction_id: null\r\n          })\r\n          .eq('cash_account_id', id)\r\n          .eq('location_id', currentBusiness.id);\r\n\r\n        if (expenseError) throw expenseError;\r\n      } else {\r\n        // Just unlink expenses (set cash_account_id to null)\r\n        const { error: expenseError } = await supabase\r\n          .from('expenses')\r\n          .update({\r\n            cash_account_id: null,\r\n            cash_transaction_id: null\r\n          })\r\n          .eq('cash_account_id', id)\r\n          .eq('location_id', currentBusiness.id);\r\n\r\n        if (expenseError) throw expenseError;\r\n      }\r\n\r\n      // Then delete the account\r\n      const { error: accountError } = await supabase\r\n        .from('cash_accounts')\r\n        .delete()\r\n        .eq('id', id)\r\n        .eq('location_id', currentBusiness.id);\r\n\r\n      if (accountError) throw accountError;\r\n      // Optimistic remove\r\n      setAccounts(prev => prev.filter(a => a.id !== id));\r\n      queryClient.invalidateQueries({ queryKey });\r\n\r\n      toast({\r\n        title: \"Success\",\r\n        description: deleteTransactions\r\n          ? \"Cash account and all associated records deleted successfully\"\r\n          : \"Cash account deleted successfully (linked records unlinked)\"\r\n      });\r\n\r\n      // Call the callback function if provided\r\n      if (onDeleted) {\r\n        onDeleted();\r\n      }\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error deleting cash account with transactions:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to delete cash account. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  // Updated balance calculation to use chunked loading like useCashTransactions\r\n  const getAccountBalance = useCallback(async (accountId: string): Promise<number> => {\r\n    try {\r\n      if (!currentBusiness) return 0;\r\n\r\n      // Get the account's opening balance\r\n      const { data: account, error: accountError } = await supabase\r\n        .from('cash_accounts')\r\n        .select('opening_balance')\r\n        .eq('id', accountId)\r\n        .eq('location_id', currentBusiness.id)\r\n        .single();\r\n\r\n      if (accountError) throw accountError;\r\n\r\n      // Get transaction count first to enable chunked loading\r\n      const { count, error: countError } = await supabase\r\n        .from('cash_transactions')\r\n        .select('*', { count: 'exact', head: true })\r\n        .eq('account_id', accountId)\r\n        .eq('location_id', currentBusiness.id);\r\n\r\n      if (countError) {\r\n        console.error('Error getting transaction count for balance calculation:', countError);\r\n        throw countError;\r\n      }\r\n\r\n      console.log(`Calculating balance for account ${accountId}: ${count || 0} transactions found`);\r\n\r\n      // Load all transactions in chunks of 1000 to bypass Supabase limit\r\n      const allTransactions: any[] = [];\r\n      const chunkSize = 1000;\r\n      let start = 0;\r\n\r\n      while (start < (count || 0)) {\r\n        console.log(`Loading balance chunk ${Math.floor(start / chunkSize) + 1}: rows ${start} to ${start + chunkSize - 1}`);\r\n\r\n        const { data: chunk, error: chunkError } = await supabase\r\n          .from('cash_transactions')\r\n          .select('amount, transaction_type')\r\n          .eq('account_id', accountId)\r\n          .eq('location_id', currentBusiness.id)\r\n          .order('date', { ascending: true })\r\n          .order('created_at', { ascending: true })\r\n          .range(start, start + chunkSize - 1);\r\n\r\n        if (chunkError) {\r\n          console.error('Error loading transaction chunk for balance:', chunkError);\r\n          throw chunkError;\r\n        }\r\n\r\n        if (chunk && chunk.length > 0) {\r\n          allTransactions.push(...chunk);\r\n          console.log(`Balance chunk ${Math.floor(start / chunkSize) + 1}: loaded ${chunk.length} transactions`);\r\n        }\r\n\r\n        start += chunkSize;\r\n      }\r\n\r\n      console.log(`Total transactions loaded for balance calculation: ${allTransactions.length}`);\r\n\r\n      // Calculate balance using the same logic as the summary - exactly matching DailyCashSummary calculation\r\n      let balance = Number(account.opening_balance);\r\n\r\n      allTransactions.forEach(transaction => {\r\n        const amount = Number(transaction.amount);\r\n        if (transaction.transaction_type === 'cash_in' || transaction.transaction_type === 'transfer_in') {\r\n          balance += amount;\r\n        } else if (transaction.transaction_type === 'cash_out' || transaction.transaction_type === 'transfer_out') {\r\n          balance -= amount;\r\n        }\r\n      });\r\n\r\n      console.log(`Final calculated balance for account ${accountId}: ${balance}`);\r\n      return balance;\r\n    } catch (error) {\r\n      console.error('Error calculating account balance:', error);\r\n      return 0;\r\n    }\r\n  }, [currentBusiness?.id]);\r\n\r\n  // Initial load handled by React Query (no manual call)\r\n\r\n  // Realtime: invalidate cash accounts cache on changes for current location\r\n  useEffect(() => {\r\n    if (!currentBusiness?.id) return;\r\n\r\n    const channel = supabase\r\n      .channel('cash_accounts_and_transactions_changes')\r\n      .on('postgres_changes', {\r\n        event: '*',\r\n        schema: 'public',\r\n        table: 'cash_accounts',\r\n        filter: `location_id=eq.${currentBusiness.id}`\r\n      }, () => {\r\n        queryClient.invalidateQueries({ queryKey });\r\n      })\r\n      .on('postgres_changes', {\r\n        event: '*',\r\n        schema: 'public',\r\n        table: 'cash_transactions',\r\n        filter: `location_id=eq.${currentBusiness.id}`\r\n      }, () => {\r\n        // Refresh account balances when transactions change\r\n        queryClient.invalidateQueries({ queryKey });\r\n      })\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel);\r\n    };\r\n  }, [currentBusiness?.id]);\r\n\r\n  // Memoize return object to prevent unnecessary re-renders\r\n  return useMemo(() => ({\r\n    accounts,\r\n    isLoading,\r\n    createAccount,\r\n    updateAccount,\r\n    deleteAccount,\r\n    deleteAccountWithTransactions,\r\n    getAccountBalance,\r\n    loadAccounts,\r\n    refreshAccounts\r\n  }), [accounts, isLoading, createAccount, getAccountBalance, loadAccounts]);\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3391, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/drawer.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { Drawer as DrawerPrimitive } from \"vaul\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Drawer = ({\r\n  shouldScaleBackground = true,\r\n  ...props\r\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\r\n  <DrawerPrimitive.Root\r\n    shouldScaleBackground={shouldScaleBackground}\r\n    {...props}\r\n  />\r\n)\r\nDrawer.displayName = \"Drawer\"\r\n\r\nconst DrawerTrigger = DrawerPrimitive.Trigger\r\n\r\nconst DrawerPortal = DrawerPrimitive.Portal\r\n\r\nconst DrawerClose = DrawerPrimitive.Close\r\n\r\nconst DrawerOverlay = React.forwardRef<\r\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\r\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\r\n>(({ className, ...props }, ref) => (\r\n  <DrawerPrimitive.Overlay\r\n    ref={ref}\r\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\r\n    {...props}\r\n  />\r\n))\r\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\r\n\r\nconst DrawerContent = React.forwardRef<\r\n  React.ElementRef<typeof DrawerPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\r\n>(({ className, children, ...props }, ref) => (\r\n  <DrawerPortal>\r\n    <DrawerOverlay />\r\n    <DrawerPrimitive.Content\r\n      ref={ref}\r\n      className={cn(\r\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\r\n      {children}\r\n    </DrawerPrimitive.Content>\r\n  </DrawerPortal>\r\n))\r\nDrawerContent.displayName = \"DrawerContent\"\r\n\r\nconst DrawerHeader = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\r\n    {...props}\r\n  />\r\n)\r\nDrawerHeader.displayName = \"DrawerHeader\"\r\n\r\nconst DrawerFooter = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLDivElement>) => (\r\n  <div\r\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\r\n    {...props}\r\n  />\r\n)\r\nDrawerFooter.displayName = \"DrawerFooter\"\r\n\r\nconst DrawerTitle = React.forwardRef<\r\n  React.ElementRef<typeof DrawerPrimitive.Title>,\r\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\r\n>(({ className, ...props }, ref) => (\r\n  <DrawerPrimitive.Title\r\n    ref={ref}\r\n    className={cn(\r\n      \"text-lg font-semibold leading-none tracking-tight\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\r\n\r\nconst DrawerDescription = React.forwardRef<\r\n  React.ElementRef<typeof DrawerPrimitive.Description>,\r\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\r\n>(({ className, ...props }, ref) => (\r\n  <DrawerPrimitive.Description\r\n    ref={ref}\r\n    className={cn(\"text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\r\n\r\nexport {\r\n  Drawer,\r\n  DrawerPortal,\r\n  DrawerOverlay,\r\n  DrawerTrigger,\r\n  DrawerClose,\r\n  DrawerContent,\r\n  DrawerHeader,\r\n  DrawerFooter,\r\n  DrawerTitle,\r\n  DrawerDescription,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,SAAS,CAAC,EACd,wBAAwB,IAAI,EAC5B,GAAG,OAC+C,iBAClD,6LAAC,mJAAe,CAAC,IAAI;QACnB,uBAAuB;QACtB,GAAG,KAAK;;;;;;KANP;AASN,OAAO,WAAW,GAAG;AAErB,MAAM,gBAAgB,mJAAe,CAAC,OAAO;AAE7C,MAAM,eAAe,mJAAe,CAAC,MAAM;AAE3C,MAAM,cAAc,mJAAe,CAAC,KAAK;AAEzC,MAAM,8BAAgB,2KAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,mJAAe,CAAC,OAAO;QACtB,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,kCAAkC;QAC/C,GAAG,KAAK;;;;;;MAPP;AAUN,cAAc,WAAW,GAAG,mJAAe,CAAC,OAAO,CAAC,WAAW;AAE/D,MAAM,8BAAgB,2KAAgB,OAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,6LAAC;;0BACC,6LAAC;;;;;0BACD,6LAAC,mJAAe,CAAC,OAAO;gBACtB,KAAK;gBACL,WAAW,IAAA,4HAAE,EACX,kGACA;gBAED,GAAG,KAAK;;kCAET,6LAAC;wBAAI,WAAU;;;;;;oBACd;;;;;;;;;;;;;;AAIP,cAAc,WAAW,GAAG;AAE5B,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,4HAAE,EAAC,6CAA6C;QAC1D,GAAG,KAAK;;;;;;MANP;AASN,aAAa,WAAW,GAAG;AAE3B,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,6LAAC;QACC,WAAW,IAAA,4HAAE,EAAC,mCAAmC;QAChD,GAAG,KAAK;;;;;;MANP;AASN,aAAa,WAAW,GAAG;AAE3B,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,mJAAe,CAAC,KAAK;QACpB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,qDACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,mJAAe,CAAC,KAAK,CAAC,WAAW;AAE3D,MAAM,kCAAoB,2KAAgB,OAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,mJAAe,CAAC,WAAW;QAC1B,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,mJAAe,CAAC,WAAW,CAAC,WAAW"}},
    {"offset": {"line": 3540, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/ImageViewer.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Dialog, DialogContent } from '@/components/ui/dialog';\r\nimport { \r\n  Drawer, \r\n  DrawerContent,\r\n  DrawerClose\r\n} from '@/components/ui/drawer';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { X } from 'lucide-react';\r\n\r\ninterface ImageViewerProps {\r\n  isOpen: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  imageUrl: string;\r\n  imageAlt?: string;\r\n}\r\n\r\nconst ImageViewer: React.FC<ImageViewerProps> = ({ \r\n  isOpen, \r\n  onOpenChange, \r\n  imageUrl, \r\n  imageAlt = \"Receipt image\" \r\n}) => {\r\n  const isMobile = useIsMobile();\r\n\r\n  if (isMobile) {\r\n    return (\r\n      <Drawer open={isOpen} onOpenChange={onOpenChange}>\r\n        <DrawerContent className=\"max-h-[90vh]\">\r\n          <div className=\"relative p-4\">\r\n            <DrawerClose className=\"absolute right-4 top-4 z-10 rounded-sm opacity-70 hover:opacity-100 bg-black/50 text-white p-2\">\r\n              <X className=\"h-4 w-4\" />\r\n              <span className=\"sr-only\">Close</span>\r\n            </DrawerClose>\r\n            <div className=\"flex items-center justify-center min-h-[70vh]\">\r\n              <img \r\n                src={imageUrl} \r\n                alt={imageAlt}\r\n                className=\"max-w-full max-h-[80vh] object-contain rounded-lg\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </DrawerContent>\r\n      </Drawer>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-4xl max-h-[90vh] p-4\">\r\n        <div className=\"flex items-center justify-center min-h-[70vh]\">\r\n          <img \r\n            src={imageUrl} \r\n            alt={imageAlt}\r\n            className=\"max-w-full max-h-[80vh] object-contain rounded-lg\"\r\n          />\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ImageViewer;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAKA;AACA;;;;;;;AASA,MAAM,cAA0C,CAAC,EAC/C,MAAM,EACN,YAAY,EACZ,QAAQ,EACR,WAAW,eAAe,EAC3B;;IACC,MAAM,WAAW,IAAA,gJAAW;IAE5B,IAAI,UAAU;QACZ,qBACE,6LAAC,+IAAM;YAAC,MAAM;YAAQ,cAAc;sBAClC,cAAA,6LAAC,sJAAa;gBAAC,WAAU;0BACvB,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,oJAAW;4BAAC,WAAU;;8CACrB,6LAAC,oMAAC;oCAAC,WAAU;;;;;;8CACb,6LAAC;oCAAK,WAAU;8CAAU;;;;;;;;;;;;sCAE5B,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC;gCACC,KAAK;gCACL,KAAK;gCACL,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;IAOxB;IAEA,qBACE,6LAAC,+IAAM;QAAC,MAAM;QAAQ,cAAc;kBAClC,cAAA,6LAAC,sJAAa;YAAC,WAAU;sBACvB,cAAA,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBACC,KAAK;oBACL,KAAK;oBACL,WAAU;;;;;;;;;;;;;;;;;;;;;AAMtB;GA3CM;;QAMa,gJAAW;;;KANxB;uCA6CS"}},
    {"offset": {"line": 3672, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/ViewExpenseDialog.tsx"],"sourcesContent":["\r\nimport React, { useState } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { \r\n  Drawer, \r\n  DrawerContent,\r\n  DrawerClose,\r\n  DrawerHeader,\r\n  DrawerTitle\r\n} from '@/components/ui/drawer';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { X, Eye } from 'lucide-react';\r\nimport { Expense } from '@/hooks/useExpenses';\r\nimport { CashAccount } from '@/types/cash';\r\nimport ImageViewer from '@/components/ui/ImageViewer';\r\n\r\ninterface ViewExpenseDialogProps {\r\n  expense: Expense | null;\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  formatCurrency: (amount: number) => string;\r\n  accounts: CashAccount[];\r\n}\r\n\r\nconst ViewExpenseDialog: React.FC<ViewExpenseDialogProps> = ({\r\n  expense,\r\n  open,\r\n  onOpenChange,\r\n  formatCurrency,\r\n  accounts\r\n}) => {\r\n  const isMobile = useIsMobile();\r\n  const [imageViewerOpen, setImageViewerOpen] = useState(false);\r\n\r\n  if (!expense) return null;\r\n\r\n  const getCashAccountName = (accountId: string | null) => {\r\n    if (!accountId) return null;\r\n    const account = accounts.find(acc => acc.id === accountId);\r\n    return account?.name || 'Unknown Account';\r\n  };\r\n\r\n  const content = (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        <div className=\"space-y-2\">\r\n          <label className=\"text-sm font-medium text-muted-foreground\">Date</label>\r\n          <p className=\"text-sm\">{expense.date.toLocaleDateString()}</p>\r\n        </div>\r\n\r\n        <div className=\"space-y-2\">\r\n          <label className=\"text-sm font-medium text-muted-foreground\">Amount</label>\r\n          <p className=\"text-lg font-semibold text-red-600\">{formatCurrency(expense.amount)}</p>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        <label className=\"text-sm font-medium text-muted-foreground\">Description</label>\r\n        <p className=\"text-sm\">{expense.description}</p>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        <div className=\"space-y-2\">\r\n          <label className=\"text-sm font-medium text-muted-foreground\">Category</label>\r\n          {expense.category ? (\r\n            <Badge variant=\"secondary\">{expense.category}</Badge>\r\n          ) : (\r\n            <p className=\"text-sm text-muted-foreground\">Not specified</p>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"space-y-2\">\r\n          <label className=\"text-sm font-medium text-muted-foreground\">Payment Method</label>\r\n          <p className=\"text-sm\">{expense.paymentMethod || 'Not specified'}</p>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        <label className=\"text-sm font-medium text-muted-foreground\">Person in Charge</label>\r\n        <p className=\"text-sm\">{expense.personInCharge || 'Not specified'}</p>\r\n      </div>\r\n\r\n      {expense.cashAccountId && (\r\n        <div className=\"space-y-2\">\r\n          <label className=\"text-sm font-medium text-muted-foreground\">Cash Account</label>\r\n          <Badge variant=\"outline\">{getCashAccountName(expense.cashAccountId)}</Badge>\r\n        </div>\r\n      )}\r\n\r\n      {expense.receiptImage && (\r\n        <div className=\"space-y-2\">\r\n          <label className=\"text-sm font-medium text-muted-foreground\">Receipt</label>\r\n          <div className=\"relative\">\r\n            <img \r\n              src={expense.receiptImage} \r\n              alt=\"Receipt\" \r\n              className=\"max-w-full h-32 object-contain border rounded cursor-pointer hover:opacity-80 transition-opacity\"\r\n              onClick={() => setImageViewerOpen(true)}\r\n            />\r\n            <Button\r\n              variant=\"secondary\"\r\n              size=\"sm\"\r\n              className=\"absolute top-2 right-2 opacity-80 hover:opacity-100\"\r\n              onClick={() => setImageViewerOpen(true)}\r\n            >\r\n              <Eye className=\"h-4 w-4\" />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  if (isMobile) {\r\n    return (\r\n      <>\r\n        <Drawer open={open} onOpenChange={onOpenChange}>\r\n          <DrawerContent className=\"max-h-[85vh]\">\r\n            <div className=\"relative px-4 py-6 pb-8\">\r\n              <DrawerClose className=\"absolute right-4 top-4 rounded-sm opacity-70 hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring\">\r\n                <X className=\"h-4 w-4\" />\r\n                <span className=\"sr-only\">Close</span>\r\n              </DrawerClose>\r\n              <DrawerHeader className=\"px-0 pb-4\">\r\n                <DrawerTitle className=\"text-lg\">Expense Details</DrawerTitle>\r\n              </DrawerHeader>\r\n              <ScrollArea className=\"h-[calc(85vh-120px)] pr-4\">\r\n                {content}\r\n              </ScrollArea>\r\n            </div>\r\n          </DrawerContent>\r\n        </Drawer>\r\n\r\n        {expense.receiptImage && (\r\n          <ImageViewer\r\n            isOpen={imageViewerOpen}\r\n            onOpenChange={setImageViewerOpen}\r\n            imageUrl={expense.receiptImage}\r\n            imageAlt=\"Receipt image\"\r\n          />\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Dialog open={open} onOpenChange={onOpenChange}>\r\n        <DialogContent className=\"sm:max-w-[600px] max-h-[90vh]\">\r\n          <DialogHeader>\r\n            <DialogTitle>Expense Details</DialogTitle>\r\n          </DialogHeader>\r\n          <ScrollArea className=\"max-h-[70vh] pr-4\">\r\n            {content}\r\n          </ScrollArea>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {expense.receiptImage && (\r\n        <ImageViewer\r\n          isOpen={imageViewerOpen}\r\n          onOpenChange={setImageViewerOpen}\r\n          imageUrl={expense.receiptImage}\r\n          imageAlt=\"Receipt image\"\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ViewExpenseDialog;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4126, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface TextareaProps\r\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}\r\n\r\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\r\n  ({ className, ...props }, ref) => {\r\n    return (\r\n      <textarea\r\n        className={cn(\r\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n          className\r\n        )}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    )\r\n  }\r\n)\r\nTextarea.displayName = \"Textarea\"\r\n\r\nexport { Textarea }\r\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAKA,MAAM,yBAAW,2KAAgB,MAC/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IACxB,qBACE,6LAAC;QACC,WAAW,IAAA,4HAAE,EACX,wSACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 4160, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/switch.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Switch = React.forwardRef<\r\n  React.ElementRef<typeof SwitchPrimitives.Root>,\r\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\r\n>(({ className, ...props }, ref) => (\r\n  <SwitchPrimitives.Root\r\n    className={cn(\r\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\r\n      className\r\n    )}\r\n    {...props}\r\n    ref={ref}\r\n  >\r\n    <SwitchPrimitives.Thumb\r\n      className={cn(\r\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\r\n      )}\r\n    />\r\n  </SwitchPrimitives.Root>\r\n))\r\nSwitch.displayName = SwitchPrimitives.Root.displayName\r\n\r\nexport { Switch }\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,uBAAS,2KAAgB,MAG7B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,6KAAqB;QACpB,WAAW,IAAA,4HAAE,EACX,sXACA;QAED,GAAG,KAAK;QACT,KAAK;kBAEL,cAAA,6LAAC,8KAAsB;YACrB,WAAW,IAAA,4HAAE,EACX;;;;;;;;;;;;AAKR,OAAO,WAAW,GAAG,6KAAqB,CAAC,WAAW"}},
    {"offset": {"line": 4201, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/calendar.tsx"],"sourcesContent":["\r\nimport * as React from \"react\";\r\nimport { ChevronLeft, ChevronRight } from \"lucide-react\";\r\nimport { DayPicker } from \"react-day-picker\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\nimport { buttonVariants } from \"@/components/ui/button\";\r\n\r\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>;\r\n\r\nfunction Calendar({\r\n  className,\r\n  classNames,\r\n  showOutsideDays = true,\r\n  ...props\r\n}: CalendarProps) {\r\n  return (\r\n    <DayPicker\r\n      showOutsideDays={showOutsideDays}\r\n      className={cn(\"p-3 pointer-events-auto\", className)}\r\n      classNames={{\r\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\r\n        month: \"space-y-4\",\r\n        caption: \"flex justify-center pt-1 relative items-center\",\r\n        caption_label: \"text-sm font-medium\",\r\n        caption_dropdowns: \"flex justify-center gap-1\",\r\n        nav: \"space-x-1 flex items-center\",\r\n        nav_button: cn(\r\n          buttonVariants({ variant: \"outline\" }),\r\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\r\n        ),\r\n        nav_button_previous: \"absolute left-1\",\r\n        nav_button_next: \"absolute right-1\",\r\n        table: \"w-full border-collapse space-y-1\",\r\n        head_row: \"flex\",\r\n        head_cell:\r\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\r\n        row: \"flex w-full mt-2\",\r\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\r\n        day: cn(\r\n          buttonVariants({ variant: \"ghost\" }),\r\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\r\n        ),\r\n        day_range_end: \"day-range-end\",\r\n        day_selected:\r\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\r\n        day_today: \"bg-accent text-accent-foreground\",\r\n        day_outside:\r\n          \"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30\",\r\n        day_disabled: \"text-muted-foreground opacity-50\",\r\n        day_range_middle:\r\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\r\n        day_hidden: \"invisible\",\r\n        dropdown: \"bg-background rounded-md border p-1 shadow-md\",\r\n        dropdown_month: \"w-[var(--rdp-caption-dropdown-month-width)]\",\r\n        dropdown_year: \"w-[var(--rdp-caption-dropdown-year-width)]\",\r\n        dropdown_icon: \"w-4 h-4\",\r\n        button_reset: \"appearance-none bg-transparent border-none p-0 m-0\",\r\n        vhidden: \"sr-only\",\r\n        ...classNames,\r\n      }}\r\n      components={{\r\n        IconLeft: ({ ..._props }) => <ChevronLeft className=\"h-4 w-4\" />,\r\n        IconRight: ({ ..._props }) => <ChevronRight className=\"h-4 w-4\" />,\r\n      }}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\nCalendar.displayName = \"Calendar\";\r\n\r\nexport { Calendar };\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AAEA;AACA;;;;;;AAIA,SAAS,SAAS,EAChB,SAAS,EACT,UAAU,EACV,kBAAkB,IAAI,EACtB,GAAG,OACW;IACd,qBACE,6LAAC,8KAAS;QACR,iBAAiB;QACjB,WAAW,IAAA,4HAAE,EAAC,2BAA2B;QACzC,YAAY;YACV,QAAQ;YACR,OAAO;YACP,SAAS;YACT,eAAe;YACf,mBAAmB;YACnB,KAAK;YACL,YAAY,IAAA,4HAAE,EACZ,IAAA,uJAAc,EAAC;gBAAE,SAAS;YAAU,IACpC;YAEF,qBAAqB;YACrB,iBAAiB;YACjB,OAAO;YACP,UAAU;YACV,WACE;YACF,KAAK;YACL,MAAM;YACN,KAAK,IAAA,4HAAE,EACL,IAAA,uJAAc,EAAC;gBAAE,SAAS;YAAQ,IAClC;YAEF,eAAe;YACf,cACE;YACF,WAAW;YACX,aACE;YACF,cAAc;YACd,kBACE;YACF,YAAY;YACZ,UAAU;YACV,gBAAgB;YAChB,eAAe;YACf,eAAe;YACf,cAAc;YACd,SAAS;YACT,GAAG,UAAU;QACf;QACA,YAAY;YACV,UAAU,CAAC,EAAE,GAAG,QAAQ,iBAAK,6LAAC,sOAAW;oBAAC,WAAU;;;;;;YACpD,WAAW,CAAC,EAAE,GAAG,QAAQ,iBAAK,6LAAC,yOAAY;oBAAC,WAAU;;;;;;QACxD;QACC,GAAG,KAAK;;;;;;AAGf;KA1DS;AA2DT,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 4290, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/popover.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Popover = PopoverPrimitive.Root\r\n\r\nconst PopoverTrigger = PopoverPrimitive.Trigger\r\n\r\nconst PopoverContent = React.forwardRef<\r\n  React.ElementRef<typeof PopoverPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\r\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\r\n  <PopoverPrimitive.Portal>\r\n    <PopoverPrimitive.Content\r\n      ref={ref}\r\n      align={align}\r\n      sideOffset={sideOffset}\r\n      className={cn(\r\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  </PopoverPrimitive.Portal>\r\n))\r\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\r\n\r\nexport { Popover, PopoverTrigger, PopoverContent }\r\n"],"names":[],"mappings":";;;;;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,UAAU,8KAAqB;AAErC,MAAM,iBAAiB,iLAAwB;AAE/C,MAAM,+BAAiB,2KAAgB,MAGrC,CAAC,EAAE,SAAS,EAAE,QAAQ,QAAQ,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO,EAAE,oBAC5D,6LAAC,gLAAuB;kBACtB,cAAA,6LAAC,iLAAwB;YACvB,KAAK;YACL,OAAO;YACP,YAAY;YACZ,WAAW,IAAA,4HAAE,EACX,8aACA;YAED,GAAG,KAAK;;;;;;;;;;;;AAIf,eAAe,WAAW,GAAG,iLAAwB,CAAC,WAAW"}},
    {"offset": {"line": 4338, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/ExpenseForm.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Calendar } from '@/components/ui/calendar';\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { CalendarIcon, Upload, X, Plus, Tag, FileText } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport { cn } from '@/lib/utils';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useCashAccounts } from '@/hooks/useCashAccounts';\r\nimport { useExpenseCategories } from '@/hooks/useExpenseCategories';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport ExpenseCategoriesManager from './ExpenseCategoriesManager';\r\n\r\ninterface ExpenseFormProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  onSubmit: (data: any) => Promise<void>;\r\n  initialData?: any;\r\n  title?: string;\r\n}\r\n\r\nconst ExpenseForm: React.FC<ExpenseFormProps> = ({\r\n  open,\r\n  onOpenChange,\r\n  onSubmit,\r\n  initialData,\r\n  title = \"Add New Expense\"\r\n}) => {\r\n  const [amount, setAmount] = useState('');\r\n  const [description, setDescription] = useState('');\r\n  const [category, setCategory] = useState('');\r\n  const [newCategoryName, setNewCategoryName] = useState('');\r\n  const [date, setDate] = useState<Date>(new Date());\r\n  const [paymentMethod, setPaymentMethod] = useState('');\r\n  const [personInCharge, setPersonInCharge] = useState('');\r\n  const [receiptImage, setReceiptImage] = useState('');\r\n  const [linkToCash, setLinkToCash] = useState(false);\r\n  const [cashAccountId, setCashAccountId] = useState('');\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [showCategoryDialog, setShowCategoryDialog] = useState(false);\r\n  const [isCreatingCategory, setIsCreatingCategory] = useState(false);\r\n\r\n  const [receiptFile, setReceiptFile] = useState<File | null>(null);\r\n\r\n  const { accounts } = useCashAccounts();\r\n  const { categories, createCategory } = useExpenseCategories();\r\n  const { toast } = useToast();\r\n\r\n  // Need to get user ID for RLS policies\r\n  const [userId, setUserId] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    supabase.auth.getUser().then(({ data }) => {\r\n      setUserId(data.user?.id || null);\r\n    });\r\n  }, []);\r\n\r\n  // Reset form when dialog opens/closes or initialData changes\r\n  useEffect(() => {\r\n    if (open && initialData) {\r\n      setAmount(initialData.amount?.toString() || '');\r\n      setDescription(initialData.description || '');\r\n      setCategory(initialData.category || '');\r\n      setDate(initialData.date || new Date());\r\n      setPaymentMethod(initialData.paymentMethod || '');\r\n      setPersonInCharge(initialData.personInCharge || '');\r\n      setReceiptImage(initialData.receiptImage || '');\r\n      setLinkToCash(initialData.linkToCash || false);\r\n      setCashAccountId(initialData.cashAccountId || '');\r\n      setReceiptFile(null);\r\n    } else if (open && !initialData) {\r\n      // Reset form for new expense\r\n      setAmount('');\r\n      setDescription('');\r\n      setCategory('');\r\n      setDate(new Date());\r\n      setPaymentMethod('');\r\n      setPersonInCharge('');\r\n      setReceiptImage('');\r\n      setLinkToCash(false);\r\n      setCashAccountId('');\r\n      setReceiptFile(null);\r\n    }\r\n  }, [open, initialData]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    if (!amount || !description) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Amount and description are required\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (linkToCash && !cashAccountId) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Please select a cash account when linking to cash\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n\r\n    try {\r\n      console.log('ExpenseForm: Submitting expense with linkToCash:', linkToCash, 'cashAccountId:', cashAccountId);\r\n\r\n      let finalReceiptUrl = receiptImage;\r\n\r\n      // Handle file upload if a new file was selected\r\n      if (receiptFile) {\r\n        if (!userId) {\r\n          console.error(\"No user ID found for upload\");\r\n          toast({\r\n            title: \"Error\",\r\n            description: \"You must be logged in to upload files\",\r\n            variant: \"destructive\"\r\n          });\r\n          setIsSubmitting(false);\r\n          return;\r\n        }\r\n\r\n        try {\r\n          const fileExt = receiptFile.name.split('.').pop();\r\n          const fileName = `${userId}/receipts/${Date.now()}.${fileExt}`;\r\n\r\n          const { error: uploadError } = await supabase.storage\r\n            .from('product-images')\r\n            .upload(fileName, receiptFile);\r\n\r\n          if (uploadError) {\r\n            console.error('Error uploading receipt:', uploadError);\r\n            throw new Error('Failed to upload receipt image');\r\n          }\r\n\r\n          const { data: { publicUrl } } = supabase.storage\r\n            .from('product-images')\r\n            .getPublicUrl(fileName);\r\n\r\n          finalReceiptUrl = publicUrl;\r\n        } catch (error) {\r\n          console.error('Error uploading receipt:', error);\r\n          toast({\r\n            title: \"Error\",\r\n            description: \"Failed to upload receipt image\",\r\n            variant: \"destructive\"\r\n          });\r\n          setIsSubmitting(false);\r\n          return;\r\n        }\r\n      }\r\n\r\n      const expenseData = {\r\n        amount: parseFloat(amount),\r\n        description,\r\n        category: category || undefined,\r\n        date,\r\n        paymentMethod: paymentMethod || undefined,\r\n        personInCharge: personInCharge || undefined,\r\n        receiptImage: finalReceiptUrl || undefined,\r\n        linkToCash,\r\n        cashAccountId: linkToCash ? cashAccountId : undefined\r\n      };\r\n\r\n      console.log('ExpenseForm: Final expense data:', expenseData);\r\n      await onSubmit(expenseData);\r\n      onOpenChange(false);\r\n    } catch (error) {\r\n      console.error('Error submitting expense:', error);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      // Check file type\r\n      const isImage = file.type.startsWith('image/');\r\n      const isPDF = file.type === 'application/pdf';\r\n\r\n      if (!isImage && !isPDF) {\r\n        toast({\r\n          title: \"Error\",\r\n          description: \"Please select an image or PDF file\",\r\n          variant: \"destructive\"\r\n        });\r\n        return;\r\n      }\r\n\r\n      // Store the file for upload on submit\r\n      setReceiptFile(file);\r\n\r\n      // Create a temporary URL for preview\r\n      const url = URL.createObjectURL(file);\r\n      setReceiptImage(url);\r\n    }\r\n  };\r\n\r\n  const removeImage = () => {\r\n    setReceiptImage('');\r\n  };\r\n\r\n  const isReceiptPDF = (url: string) => {\r\n    // Check if the file is a PDF based on the URL or stored file type\r\n    return url && url.includes('pdf');\r\n  };\r\n\r\n  const handleCategorySelect = (selectedCategory: string) => {\r\n    setCategory(selectedCategory);\r\n    setShowCategoryDialog(false);\r\n  };\r\n\r\n  const handleCreateNewCategory = async () => {\r\n    if (!newCategoryName.trim()) {\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Please enter a category name\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsCreatingCategory(true);\r\n    try {\r\n      const newCategory = await createCategory(newCategoryName.trim());\r\n      if (newCategory) {\r\n        setCategory(newCategory.name);\r\n        setNewCategoryName('');\r\n        toast({\r\n          title: \"Success\",\r\n          description: \"Category created successfully\",\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error creating category:', error);\r\n    } finally {\r\n      setIsCreatingCategory(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Dialog open={open} onOpenChange={onOpenChange}>\r\n        <DialogContent className=\"sm:max-w-md max-h-[90vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle>{title}</DialogTitle>\r\n          </DialogHeader>\r\n\r\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n            <div>\r\n              <Label htmlFor=\"amount\">Amount *</Label>\r\n              <Input\r\n                id=\"amount\"\r\n                type=\"number\"\r\n                step=\"0.01\"\r\n                value={amount}\r\n                onChange={(e) => setAmount(e.target.value)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter') {\r\n                    e.preventDefault();\r\n                    document.getElementById('description')?.focus();\r\n                  }\r\n                }}\r\n                placeholder=\"0.00\"\r\n                disabled={isSubmitting}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"description\">Description *</Label>\r\n              <Textarea\r\n                id=\"description\"\r\n                value={description}\r\n                onChange={(e) => setDescription(e.target.value)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter' && !e.shiftKey) {\r\n                    e.preventDefault();\r\n                    // Try to focus the category button\r\n                    const categoryButton = document.querySelector('button[data-category-select=\"true\"]') as HTMLElement;\r\n                    if (categoryButton) {\r\n                      categoryButton.focus();\r\n                    } else {\r\n                      // Skip to new category input\r\n                      document.getElementById('newCategory')?.focus();\r\n                    }\r\n                  }\r\n                }}\r\n                placeholder=\"Enter expense description\"\r\n                disabled={isSubmitting}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-3\">\r\n              <div>\r\n                <Label>Category</Label>\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  className=\"w-full justify-start text-left font-normal\"\r\n                  onClick={() => setShowCategoryDialog(true)}\r\n                  data-category-select=\"true\"\r\n                  onKeyDown={(e) => {\r\n                    if (e.key === 'Enter') {\r\n                      e.preventDefault();\r\n                      document.getElementById('newCategory')?.focus();\r\n                    }\r\n                  }}\r\n                  disabled={isSubmitting}\r\n                >\r\n                  <Tag className=\"mr-2 h-4 w-4\" />\r\n                  {category || \"Select Category\"}\r\n                </Button>\r\n              </div>\r\n\r\n              <div>\r\n                <Label htmlFor=\"newCategory\">Create New Category</Label>\r\n                <div className=\"flex gap-2\">\r\n                  <Input\r\n                    id=\"newCategory\"\r\n                    value={newCategoryName}\r\n                    onChange={(e) => setNewCategoryName(e.target.value)}\r\n                    onKeyDown={(e) => {\r\n                      if (e.key === 'Enter') {\r\n                        e.preventDefault();\r\n                        // Focus the date picker button\r\n                        const datePickerButton = document.querySelector('button[data-date-picker=\"true\"]') as HTMLElement;\r\n                        datePickerButton?.focus();\r\n                      }\r\n                    }}\r\n                    placeholder=\"Enter new category name\"\r\n                    disabled={isSubmitting || isCreatingCategory}\r\n                  />\r\n                  <Button\r\n                    type=\"button\"\r\n                    onClick={handleCreateNewCategory}\r\n                    disabled={!newCategoryName.trim() || isSubmitting || isCreatingCategory}\r\n                    size=\"sm\"\r\n                  >\r\n                    <Plus className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <Label>Date</Label>\r\n              <Popover>\r\n                <PopoverTrigger asChild>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    className={cn(\r\n                      \"w-full justify-start text-left font-normal\",\r\n                      !date && \"text-muted-foreground\"\r\n                    )}\r\n                    data-date-picker=\"true\"\r\n                    onKeyDown={(e) => {\r\n                      if (e.key === 'Enter') {\r\n                        e.preventDefault();\r\n                        document.getElementById('paymentMethod')?.focus();\r\n                      }\r\n                    }}\r\n                    disabled={isSubmitting}\r\n                  >\r\n                    <CalendarIcon className=\"mr-2 h-4 w-4\" />\r\n                    {date ? format(date, \"PPP\") : <span>Pick a date</span>}\r\n                  </Button>\r\n                </PopoverTrigger>\r\n                <PopoverContent className=\"w-auto p-0\">\r\n                  <Calendar\r\n                    mode=\"single\"\r\n                    selected={date}\r\n                    onSelect={(date) => date && setDate(date)}\r\n                    initialFocus\r\n                  />\r\n                </PopoverContent>\r\n              </Popover>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"paymentMethod\">Payment Method</Label>\r\n              <Input\r\n                id=\"paymentMethod\"\r\n                value={paymentMethod}\r\n                onChange={(e) => setPaymentMethod(e.target.value)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter') {\r\n                    e.preventDefault();\r\n                    document.getElementById('personInCharge')?.focus();\r\n                  }\r\n                }}\r\n                placeholder=\"Enter payment method (e.g., Cash, Credit Card, etc.)\"\r\n                disabled={isSubmitting}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"personInCharge\">Person in Charge</Label>\r\n              <Input\r\n                id=\"personInCharge\"\r\n                value={personInCharge}\r\n                onChange={(e) => setPersonInCharge(e.target.value)}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter') {\r\n                    e.preventDefault();\r\n                    document.getElementById('receipt')?.focus();\r\n                  }\r\n                }}\r\n                placeholder=\"Enter person responsible\"\r\n                disabled={isSubmitting}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"receipt\">Receipt (Image or PDF)</Label>\r\n              <div className=\"space-y-2\">\r\n                <Input\r\n                  id=\"receipt\"\r\n                  type=\"file\"\r\n                  accept=\"image/*,.pdf\"\r\n                  onChange={handleFileUpload}\r\n                  disabled={isSubmitting}\r\n                />\r\n                {receiptImage && (\r\n                  <div className=\"relative inline-block\">\r\n                    {isReceiptPDF(receiptImage) ? (\r\n                      <div className=\"flex items-center gap-2 p-2 border rounded\">\r\n                        <FileText className=\"h-8 w-8 text-red-600\" />\r\n                        <span className=\"text-sm\">PDF Receipt</span>\r\n                        <Button\r\n                          type=\"button\"\r\n                          variant=\"destructive\"\r\n                          size=\"sm\"\r\n                          className=\"ml-auto h-6 w-6 rounded-full p-0\"\r\n                          onClick={removeImage}\r\n                          disabled={isSubmitting}\r\n                        >\r\n                          <X className=\"h-3 w-3\" />\r\n                        </Button>\r\n                      </div>\r\n                    ) : (\r\n                      <>\r\n                        <img\r\n                          src={receiptImage}\r\n                          alt=\"Receipt\"\r\n                          className=\"w-20 h-20 object-cover rounded border\"\r\n                        />\r\n                        <Button\r\n                          type=\"button\"\r\n                          variant=\"destructive\"\r\n                          size=\"sm\"\r\n                          className=\"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0\"\r\n                          onClick={removeImage}\r\n                          disabled={isSubmitting}\r\n                        >\r\n                          <X className=\"h-3 w-3\" />\r\n                        </Button>\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Switch\r\n                id=\"linkToCash\"\r\n                checked={linkToCash}\r\n                onCheckedChange={setLinkToCash}\r\n                disabled={isSubmitting}\r\n              />\r\n              <Label htmlFor=\"linkToCash\">Link to Cash Account</Label>\r\n            </div>\r\n\r\n            {linkToCash && (\r\n              <div>\r\n                <Label htmlFor=\"cashAccount\">Cash Account</Label>\r\n                <Select value={cashAccountId} onValueChange={(value) => {\r\n                  setCashAccountId(value);\r\n                  setTimeout(() => {\r\n                    const submitButton = document.querySelector('button[type=\"submit\"]') as HTMLElement;\r\n                    submitButton?.focus();\r\n                  }, 100);\r\n                }} disabled={isSubmitting}>\r\n                  <SelectTrigger\r\n                    onKeyDown={(e) => {\r\n                      if (e.key === 'Enter') {\r\n                        e.preventDefault();\r\n                        setTimeout(() => {\r\n                          const submitButton = document.querySelector('button[type=\"submit\"]') as HTMLElement;\r\n                          submitButton?.focus();\r\n                        }, 100);\r\n                      }\r\n                    }}\r\n                  >\r\n                    <SelectValue placeholder=\"Select cash account\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    {accounts.map((account) => (\r\n                      <SelectItem key={account.id} value={account.id}>\r\n                        {account.name}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"flex justify-end gap-2\">\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                onClick={() => onOpenChange(false)}\r\n                disabled={isSubmitting}\r\n              >\r\n                Cancel\r\n              </Button>\r\n              <Button type=\"submit\" disabled={isSubmitting}>\r\n                {isSubmitting ? 'Saving...' : 'Save Expense'}\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Category Selection Dialog */}\r\n      <Dialog open={showCategoryDialog} onOpenChange={setShowCategoryDialog}>\r\n        <DialogContent className=\"sm:max-w-md\">\r\n          <DialogHeader>\r\n            <DialogTitle>Select Category</DialogTitle>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4\">\r\n            <ScrollArea className=\"h-64 rounded-md border p-4\">\r\n              <div className=\"space-y-2\">\r\n                {categories.map((cat) => (\r\n                  <Button\r\n                    key={cat.id}\r\n                    variant=\"ghost\"\r\n                    className=\"w-full justify-start\"\r\n                    onClick={() => handleCategorySelect(cat.name)}\r\n                  >\r\n                    <Tag className=\"mr-2 h-4 w-4\" />\r\n                    {cat.name}\r\n                  </Button>\r\n                ))}\r\n              </div>\r\n            </ScrollArea>\r\n\r\n            <ExpenseCategoriesManager />\r\n\r\n            <div className=\"flex justify-end\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => setShowCategoryDialog(false)}\r\n              >\r\n                Cancel\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ExpenseForm;\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;AAUA,MAAM,cAA0C,CAAC,EAC/C,IAAI,EACJ,YAAY,EACZ,QAAQ,EACR,WAAW,EACX,QAAQ,iBAAiB,EAC1B;;IACC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IACvD,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAO,IAAI;IAC3C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAC;IACrD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAAC;IAC7D,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAAC;IAE7D,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAc;IAE5D,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,qJAAe;IACpC,MAAM,EAAE,UAAU,EAAE,cAAc,EAAE,GAAG,IAAA,+JAAoB;IAC3D,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,2IAAQ;IAE1B,uCAAuC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAgB;IAEpD,IAAA,0KAAS;iCAAC;YACR,wJAAQ,CAAC,IAAI,CAAC,OAAO,GAAG,IAAI;yCAAC,CAAC,EAAE,IAAI,EAAE;oBACpC,UAAU,KAAK,IAAI,EAAE,MAAM;gBAC7B;;QACF;gCAAG,EAAE;IAEL,6DAA6D;IAC7D,IAAA,0KAAS;iCAAC;YACR,IAAI,QAAQ,aAAa;gBACvB,UAAU,YAAY,MAAM,EAAE,cAAc;gBAC5C,eAAe,YAAY,WAAW,IAAI;gBAC1C,YAAY,YAAY,QAAQ,IAAI;gBACpC,QAAQ,YAAY,IAAI,IAAI,IAAI;gBAChC,iBAAiB,YAAY,aAAa,IAAI;gBAC9C,kBAAkB,YAAY,cAAc,IAAI;gBAChD,gBAAgB,YAAY,YAAY,IAAI;gBAC5C,cAAc,YAAY,UAAU,IAAI;gBACxC,iBAAiB,YAAY,aAAa,IAAI;gBAC9C,eAAe;YACjB,OAAO,IAAI,QAAQ,CAAC,aAAa;gBAC/B,6BAA6B;gBAC7B,UAAU;gBACV,eAAe;gBACf,YAAY;gBACZ,QAAQ,IAAI;gBACZ,iBAAiB;gBACjB,kBAAkB;gBAClB,gBAAgB;gBAChB,cAAc;gBACd,iBAAiB;gBACjB,eAAe;YACjB;QACF;gCAAG;QAAC;QAAM;KAAY;IAEtB,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAEhB,IAAI,CAAC,UAAU,CAAC,aAAa;YAC3B,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;YACA;QACF;QAEA,IAAI,cAAc,CAAC,eAAe;YAChC,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;YACA;QACF;QAEA,gBAAgB;QAEhB,IAAI;YACF,QAAQ,GAAG,CAAC,oDAAoD,YAAY,kBAAkB;YAE9F,IAAI,kBAAkB;YAEtB,gDAAgD;YAChD,IAAI,aAAa;gBACf,IAAI,CAAC,QAAQ;oBACX,QAAQ,KAAK,CAAC;oBACd,MAAM;wBACJ,OAAO;wBACP,aAAa;wBACb,SAAS;oBACX;oBACA,gBAAgB;oBAChB;gBACF;gBAEA,IAAI;oBACF,MAAM,UAAU,YAAY,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG;oBAC/C,MAAM,WAAW,GAAG,OAAO,UAAU,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,SAAS;oBAE9D,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,wJAAQ,CAAC,OAAO,CAClD,IAAI,CAAC,kBACL,MAAM,CAAC,UAAU;oBAEpB,IAAI,aAAa;wBACf,QAAQ,KAAK,CAAC,4BAA4B;wBAC1C,MAAM,IAAI,MAAM;oBAClB;oBAEA,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE,GAAG,wJAAQ,CAAC,OAAO,CAC7C,IAAI,CAAC,kBACL,YAAY,CAAC;oBAEhB,kBAAkB;gBACpB,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,4BAA4B;oBAC1C,MAAM;wBACJ,OAAO;wBACP,aAAa;wBACb,SAAS;oBACX;oBACA,gBAAgB;oBAChB;gBACF;YACF;YAEA,MAAM,cAAc;gBAClB,QAAQ,WAAW;gBACnB;gBACA,UAAU,YAAY;gBACtB;gBACA,eAAe,iBAAiB;gBAChC,gBAAgB,kBAAkB;gBAClC,cAAc,mBAAmB;gBACjC;gBACA,eAAe,aAAa,gBAAgB;YAC9C;YAEA,QAAQ,GAAG,CAAC,oCAAoC;YAChD,MAAM,SAAS;YACf,aAAa;QACf,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,6BAA6B;QAC7C,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,MAAM,mBAAmB,CAAC;QACxB,MAAM,OAAO,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE;QAChC,IAAI,MAAM;YACR,kBAAkB;YAClB,MAAM,UAAU,KAAK,IAAI,CAAC,UAAU,CAAC;YACrC,MAAM,QAAQ,KAAK,IAAI,KAAK;YAE5B,IAAI,CAAC,WAAW,CAAC,OAAO;gBACtB,MAAM;oBACJ,OAAO;oBACP,aAAa;oBACb,SAAS;gBACX;gBACA;YACF;YAEA,sCAAsC;YACtC,eAAe;YAEf,qCAAqC;YACrC,MAAM,MAAM,IAAI,eAAe,CAAC;YAChC,gBAAgB;QAClB;IACF;IAEA,MAAM,cAAc;QAClB,gBAAgB;IAClB;IAEA,MAAM,eAAe,CAAC;QACpB,kEAAkE;QAClE,OAAO,OAAO,IAAI,QAAQ,CAAC;IAC7B;IAEA,MAAM,uBAAuB,CAAC;QAC5B,YAAY;QACZ,sBAAsB;IACxB;IAEA,MAAM,0BAA0B;QAC9B,IAAI,CAAC,gBAAgB,IAAI,IAAI;YAC3B,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;YACA;QACF;QAEA,sBAAsB;QACtB,IAAI;YACF,MAAM,cAAc,MAAM,eAAe,gBAAgB,IAAI;YAC7D,IAAI,aAAa;gBACf,YAAY,YAAY,IAAI;gBAC5B,mBAAmB;gBACnB,MAAM;oBACJ,OAAO;oBACP,aAAa;gBACf;YACF;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;QAC5C,SAAU;YACR,sBAAsB;QACxB;IACF;IAEA,qBACE;;0BACE,6LAAC,+IAAM;gBAAC,MAAM;gBAAM,cAAc;0BAChC,cAAA,6LAAC,sJAAa;oBAAC,WAAU;;sCACvB,6LAAC,qJAAY;sCACX,cAAA,6LAAC,oJAAW;0CAAE;;;;;;;;;;;sCAGhB,6LAAC;4BAAK,UAAU;4BAAc,WAAU;;8CACtC,6LAAC;;sDACC,6LAAC,6IAAK;4CAAC,SAAQ;sDAAS;;;;;;sDACxB,6LAAC,6IAAK;4CACJ,IAAG;4CACH,MAAK;4CACL,MAAK;4CACL,OAAO;4CACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;4CACzC,WAAW,CAAC;gDACV,IAAI,EAAE,GAAG,KAAK,SAAS;oDACrB,EAAE,cAAc;oDAChB,SAAS,cAAc,CAAC,gBAAgB;gDAC1C;4CACF;4CACA,aAAY;4CACZ,UAAU;;;;;;;;;;;;8CAId,6LAAC;;sDACC,6LAAC,6IAAK;4CAAC,SAAQ;sDAAc;;;;;;sDAC7B,6LAAC,mJAAQ;4CACP,IAAG;4CACH,OAAO;4CACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;4CAC9C,WAAW,CAAC;gDACV,IAAI,EAAE,GAAG,KAAK,WAAW,CAAC,EAAE,QAAQ,EAAE;oDACpC,EAAE,cAAc;oDAChB,mCAAmC;oDACnC,MAAM,iBAAiB,SAAS,aAAa,CAAC;oDAC9C,IAAI,gBAAgB;wDAClB,eAAe,KAAK;oDACtB,OAAO;wDACL,6BAA6B;wDAC7B,SAAS,cAAc,CAAC,gBAAgB;oDAC1C;gDACF;4CACF;4CACA,aAAY;4CACZ,UAAU;;;;;;;;;;;;8CAId,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;;8DACC,6LAAC,6IAAK;8DAAC;;;;;;8DACP,6LAAC,+IAAM;oDACL,MAAK;oDACL,SAAQ;oDACR,WAAU;oDACV,SAAS,IAAM,sBAAsB;oDACrC,wBAAqB;oDACrB,WAAW,CAAC;wDACV,IAAI,EAAE,GAAG,KAAK,SAAS;4DACrB,EAAE,cAAc;4DAChB,SAAS,cAAc,CAAC,gBAAgB;wDAC1C;oDACF;oDACA,UAAU;;sEAEV,6LAAC,0MAAG;4DAAC,WAAU;;;;;;wDACd,YAAY;;;;;;;;;;;;;sDAIjB,6LAAC;;8DACC,6LAAC,6IAAK;oDAAC,SAAQ;8DAAc;;;;;;8DAC7B,6LAAC;oDAAI,WAAU;;sEACb,6LAAC,6IAAK;4DACJ,IAAG;4DACH,OAAO;4DACP,UAAU,CAAC,IAAM,mBAAmB,EAAE,MAAM,CAAC,KAAK;4DAClD,WAAW,CAAC;gEACV,IAAI,EAAE,GAAG,KAAK,SAAS;oEACrB,EAAE,cAAc;oEAChB,+BAA+B;oEAC/B,MAAM,mBAAmB,SAAS,aAAa,CAAC;oEAChD,kBAAkB;gEACpB;4DACF;4DACA,aAAY;4DACZ,UAAU,gBAAgB;;;;;;sEAE5B,6LAAC,+IAAM;4DACL,MAAK;4DACL,SAAS;4DACT,UAAU,CAAC,gBAAgB,IAAI,MAAM,gBAAgB;4DACrD,MAAK;sEAEL,cAAA,6LAAC,6MAAI;gEAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8CAMxB,6LAAC;;sDACC,6LAAC,6IAAK;sDAAC;;;;;;sDACP,6LAAC,iJAAO;;8DACN,6LAAC,wJAAc;oDAAC,OAAO;8DACrB,cAAA,6LAAC,+IAAM;wDACL,SAAQ;wDACR,WAAW,IAAA,4HAAE,EACX,8CACA,CAAC,QAAQ;wDAEX,oBAAiB;wDACjB,WAAW,CAAC;4DACV,IAAI,EAAE,GAAG,KAAK,SAAS;gEACrB,EAAE,cAAc;gEAChB,SAAS,cAAc,CAAC,kBAAkB;4DAC5C;wDACF;wDACA,UAAU;;0EAEV,6LAAC,iOAAY;gEAAC,WAAU;;;;;;4DACvB,OAAO,IAAA,kKAAM,EAAC,MAAM,uBAAS,6LAAC;0EAAK;;;;;;;;;;;;;;;;;8DAGxC,6LAAC,wJAAc;oDAAC,WAAU;8DACxB,cAAA,6LAAC,mJAAQ;wDACP,MAAK;wDACL,UAAU;wDACV,UAAU,CAAC,OAAS,QAAQ,QAAQ;wDACpC,YAAY;;;;;;;;;;;;;;;;;;;;;;;8CAMpB,6LAAC;;sDACC,6LAAC,6IAAK;4CAAC,SAAQ;sDAAgB;;;;;;sDAC/B,6LAAC,6IAAK;4CACJ,IAAG;4CACH,OAAO;4CACP,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;4CAChD,WAAW,CAAC;gDACV,IAAI,EAAE,GAAG,KAAK,SAAS;oDACrB,EAAE,cAAc;oDAChB,SAAS,cAAc,CAAC,mBAAmB;gDAC7C;4CACF;4CACA,aAAY;4CACZ,UAAU;;;;;;;;;;;;8CAId,6LAAC;;sDACC,6LAAC,6IAAK;4CAAC,SAAQ;sDAAiB;;;;;;sDAChC,6LAAC,6IAAK;4CACJ,IAAG;4CACH,OAAO;4CACP,UAAU,CAAC,IAAM,kBAAkB,EAAE,MAAM,CAAC,KAAK;4CACjD,WAAW,CAAC;gDACV,IAAI,EAAE,GAAG,KAAK,SAAS;oDACrB,EAAE,cAAc;oDAChB,SAAS,cAAc,CAAC,YAAY;gDACtC;4CACF;4CACA,aAAY;4CACZ,UAAU;;;;;;;;;;;;8CAId,6LAAC;;sDACC,6LAAC,6IAAK;4CAAC,SAAQ;sDAAU;;;;;;sDACzB,6LAAC;4CAAI,WAAU;;8DACb,6LAAC,6IAAK;oDACJ,IAAG;oDACH,MAAK;oDACL,QAAO;oDACP,UAAU;oDACV,UAAU;;;;;;gDAEX,8BACC,6LAAC;oDAAI,WAAU;8DACZ,aAAa,8BACZ,6LAAC;wDAAI,WAAU;;0EACb,6LAAC,6NAAQ;gEAAC,WAAU;;;;;;0EACpB,6LAAC;gEAAK,WAAU;0EAAU;;;;;;0EAC1B,6LAAC,+IAAM;gEACL,MAAK;gEACL,SAAQ;gEACR,MAAK;gEACL,WAAU;gEACV,SAAS;gEACT,UAAU;0EAEV,cAAA,6LAAC,oMAAC;oEAAC,WAAU;;;;;;;;;;;;;;;;iHAIjB;;0EACE,6LAAC;gEACC,KAAK;gEACL,KAAI;gEACJ,WAAU;;;;;;0EAEZ,6LAAC,+IAAM;gEACL,MAAK;gEACL,SAAQ;gEACR,MAAK;gEACL,WAAU;gEACV,SAAS;gEACT,UAAU;0EAEV,cAAA,6LAAC,oMAAC;oEAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8CAS3B,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,+IAAM;4CACL,IAAG;4CACH,SAAS;4CACT,iBAAiB;4CACjB,UAAU;;;;;;sDAEZ,6LAAC,6IAAK;4CAAC,SAAQ;sDAAa;;;;;;;;;;;;gCAG7B,4BACC,6LAAC;;sDACC,6LAAC,6IAAK;4CAAC,SAAQ;sDAAc;;;;;;sDAC7B,6LAAC,+IAAM;4CAAC,OAAO;4CAAe,eAAe,CAAC;gDAC5C,iBAAiB;gDACjB,WAAW;oDACT,MAAM,eAAe,SAAS,aAAa,CAAC;oDAC5C,cAAc;gDAChB,GAAG;4CACL;4CAAG,UAAU;;8DACX,6LAAC,sJAAa;oDACZ,WAAW,CAAC;wDACV,IAAI,EAAE,GAAG,KAAK,SAAS;4DACrB,EAAE,cAAc;4DAChB,WAAW;gEACT,MAAM,eAAe,SAAS,aAAa,CAAC;gEAC5C,cAAc;4DAChB,GAAG;wDACL;oDACF;8DAEA,cAAA,6LAAC,oJAAW;wDAAC,aAAY;;;;;;;;;;;8DAE3B,6LAAC,sJAAa;8DACX,SAAS,GAAG,CAAC,CAAC,wBACb,6LAAC,mJAAU;4DAAkB,OAAO,QAAQ,EAAE;sEAC3C,QAAQ,IAAI;2DADE,QAAQ,EAAE;;;;;;;;;;;;;;;;;;;;;;8CASrC,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,+IAAM;4CACL,MAAK;4CACL,SAAQ;4CACR,SAAS,IAAM,aAAa;4CAC5B,UAAU;sDACX;;;;;;sDAGD,6LAAC,+IAAM;4CAAC,MAAK;4CAAS,UAAU;sDAC7B,eAAe,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAQxC,6LAAC,+IAAM;gBAAC,MAAM;gBAAoB,cAAc;0BAC9C,cAAA,6LAAC,sJAAa;oBAAC,WAAU;;sCACvB,6LAAC,qJAAY;sCACX,cAAA,6LAAC,oJAAW;0CAAC;;;;;;;;;;;sCAGf,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,2JAAU;oCAAC,WAAU;8CACpB,cAAA,6LAAC;wCAAI,WAAU;kDACZ,WAAW,GAAG,CAAC,CAAC,oBACf,6LAAC,+IAAM;gDAEL,SAAQ;gDACR,WAAU;gDACV,SAAS,IAAM,qBAAqB,IAAI,IAAI;;kEAE5C,6LAAC,0MAAG;wDAAC,WAAU;;;;;;oDACd,IAAI,IAAI;;+CANJ,IAAI,EAAE;;;;;;;;;;;;;;;8CAYnB,6LAAC,wKAAwB;;;;;8CAEzB,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC,+IAAM;wCACL,SAAQ;wCACR,SAAS,IAAM,sBAAsB;kDACtC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASf;GAniBM;;QAuBiB,qJAAe;QACG,+JAAoB;QACzC,2IAAQ;;;KAzBtB;uCAqiBS"}},
    {"offset": {"line": 5313, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/EditExpenseDialog.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Expense } from '@/hooks/useExpenses';\r\nimport ExpenseForm from './ExpenseForm';\r\n\r\ninterface EditExpenseDialogProps {\r\n  expense: Expense | null;\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  onSubmit: (data: any) => Promise<void>;\r\n}\r\n\r\nconst EditExpenseDialog: React.FC<EditExpenseDialogProps> = ({\r\n  expense,\r\n  open,\r\n  onOpenChange,\r\n  onSubmit\r\n}) => {\r\n  if (!expense) return null;\r\n\r\n  const initialData = {\r\n    amount: expense.amount,\r\n    description: expense.description,\r\n    category: expense.category || '',\r\n    date: expense.date,\r\n    paymentMethod: expense.paymentMethod || '',\r\n    personInCharge: expense.personInCharge || '',\r\n    receiptImage: expense.receiptImage || '',\r\n    linkToCash: !!expense.cashAccountId,\r\n    cashAccountId: expense.cashAccountId || ''\r\n  };\r\n\r\n  const handleSubmit = async (data: any) => {\r\n    console.log('EditExpenseDialog handleSubmit data:', data);\r\n    \r\n    // Pass the complete form data including both linkToCash and cashAccountId\r\n    await onSubmit(data);\r\n  };\r\n\r\n  return (\r\n    <ExpenseForm\r\n      open={open}\r\n      onOpenChange={onOpenChange}\r\n      onSubmit={handleSubmit}\r\n      initialData={initialData}\r\n      title=\"Edit Expense\"\r\n    />\r\n  );\r\n};\r\n\r\nexport default EditExpenseDialog;\r\n"],"names":[],"mappings":";;;;;AAGA;;;AASA,MAAM,oBAAsD,CAAC,EAC3D,OAAO,EACP,IAAI,EACJ,YAAY,EACZ,QAAQ,EACT;IACC,IAAI,CAAC,SAAS,OAAO;IAErB,MAAM,cAAc;QAClB,QAAQ,QAAQ,MAAM;QACtB,aAAa,QAAQ,WAAW;QAChC,UAAU,QAAQ,QAAQ,IAAI;QAC9B,MAAM,QAAQ,IAAI;QAClB,eAAe,QAAQ,aAAa,IAAI;QACxC,gBAAgB,QAAQ,cAAc,IAAI;QAC1C,cAAc,QAAQ,YAAY,IAAI;QACtC,YAAY,CAAC,CAAC,QAAQ,aAAa;QACnC,eAAe,QAAQ,aAAa,IAAI;IAC1C;IAEA,MAAM,eAAe,OAAO;QAC1B,QAAQ,GAAG,CAAC,wCAAwC;QAEpD,0EAA0E;QAC1E,MAAM,SAAS;IACjB;IAEA,qBACE,6LAAC,2JAAW;QACV,MAAM;QACN,cAAc;QACd,UAAU;QACV,aAAa;QACb,OAAM;;;;;;AAGZ;KApCM;uCAsCS"}},
    {"offset": {"line": 5362, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/DeleteExpenseDialog.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from '@/components/ui/alert-dialog';\r\nimport { Expense } from '@/hooks/useExpenses';\r\n\r\ninterface DeleteExpenseDialogProps {\r\n  expense: Expense | null;\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  onConfirm: () => Promise<void>;\r\n  formatCurrency: (amount: number) => string;\r\n}\r\n\r\nconst DeleteExpenseDialog: React.FC<DeleteExpenseDialogProps> = ({\r\n  expense,\r\n  open,\r\n  onOpenChange,\r\n  onConfirm,\r\n  formatCurrency\r\n}) => {\r\n  if (!expense) return null;\r\n\r\n  return (\r\n    <AlertDialog open={open} onOpenChange={onOpenChange}>\r\n      <AlertDialogContent>\r\n        <AlertDialogHeader>\r\n          <AlertDialogTitle>Delete Expense</AlertDialogTitle>\r\n          <AlertDialogDescription className=\"space-y-2\">\r\n            <div>Are you sure you want to delete this expense?</div>\r\n            <div className=\"p-3 bg-muted rounded-md\">\r\n              <div className=\"font-medium\">{expense.description}</div>\r\n              <div className=\"text-sm text-muted-foreground\">\r\n                {formatCurrency(expense.amount)}  {expense.date.toLocaleDateString()}\r\n              </div>\r\n            </div>\r\n            <div className=\"text-sm text-destructive\">\r\n              This action cannot be undone.\r\n            </div>\r\n          </AlertDialogDescription>\r\n        </AlertDialogHeader>\r\n        <AlertDialogFooter>\r\n          <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n          <AlertDialogAction onClick={onConfirm} className=\"bg-destructive hover:bg-destructive/90\">\r\n            Delete Expense\r\n          </AlertDialogAction>\r\n        </AlertDialogFooter>\r\n      </AlertDialogContent>\r\n    </AlertDialog>\r\n  );\r\n};\r\n\r\nexport default DeleteExpenseDialog;\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAoBA,MAAM,sBAA0D,CAAC,EAC/D,OAAO,EACP,IAAI,EACJ,YAAY,EACZ,SAAS,EACT,cAAc,EACf;IACC,IAAI,CAAC,SAAS,OAAO;IAErB,qBACE,6LAAC,6JAAW;QAAC,MAAM;QAAM,cAAc;kBACrC,cAAA,6LAAC,oKAAkB;;8BACjB,6LAAC,mKAAiB;;sCAChB,6LAAC,kKAAgB;sCAAC;;;;;;sCAClB,6LAAC,wKAAsB;4BAAC,WAAU;;8CAChC,6LAAC;8CAAI;;;;;;8CACL,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;sDAAe,QAAQ,WAAW;;;;;;sDACjD,6LAAC;4CAAI,WAAU;;gDACZ,eAAe,QAAQ,MAAM;gDAAE;gDAAI,QAAQ,IAAI,CAAC,kBAAkB;;;;;;;;;;;;;8CAGvE,6LAAC;oCAAI,WAAU;8CAA2B;;;;;;;;;;;;;;;;;;8BAK9C,6LAAC,mKAAiB;;sCAChB,6LAAC,mKAAiB;sCAAC;;;;;;sCACnB,6LAAC,mKAAiB;4BAAC,SAAS;4BAAW,WAAU;sCAAyC;;;;;;;;;;;;;;;;;;;;;;;AAOpG;KApCM;uCAsCS"}},
    {"offset": {"line": 5492, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/ExpensesList.tsx"],"sourcesContent":["\r\nimport React, { useState } from 'react';\r\nimport { Eye, Edit, Trash2, Search } from 'lucide-react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { useCashAccounts } from '@/hooks/useCashAccounts';\r\nimport { Expense } from '@/hooks/useExpenses';\r\nimport ViewExpenseDialog from './ViewExpenseDialog';\r\nimport EditExpenseDialog from './EditExpenseDialog';\r\nimport DeleteExpenseDialog from './DeleteExpenseDialog';\r\nimport { formatCashCurrency } from '@/lib/utils';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\n\r\ninterface ExpensesListProps {\r\n  expenses: Expense[];\r\n  onUpdateExpense: (id: string, updates: any) => Promise<any>;\r\n  onDeleteExpense: (id: string) => Promise<boolean>;\r\n  formatCurrency: (amount: number) => string;\r\n}\r\n\r\nconst ExpensesList: React.FC<ExpensesListProps> = ({\r\n  expenses,\r\n  onUpdateExpense,\r\n  onDeleteExpense,\r\n  formatCurrency\r\n}) => {\r\n  const isMobile = useIsMobile();\r\n  const { accounts } = useCashAccounts();\r\n  const { settings } = useBusinessSettings();\r\n  const { canViewTotalExpenses } = useFinancialVisibility();\r\n  const { hasPermission } = useProfiles();\r\n  const currency = settings.currency || 'USD';\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedExpense, setSelectedExpense] = useState<Expense | null>(null);\r\n  const [viewDialogOpen, setViewDialogOpen] = useState(false);\r\n  const [editDialogOpen, setEditDialogOpen] = useState(false);\r\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\r\n\r\n  const filteredExpenses = expenses.filter(expense =>\r\n    expense.description.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    (expense.category && expense.category.toLowerCase().includes(searchTerm.toLowerCase())) ||\r\n    (expense.paymentMethod && expense.paymentMethod.toLowerCase().includes(searchTerm.toLowerCase())) ||\r\n    (expense.personInCharge && expense.personInCharge.toLowerCase().includes(searchTerm.toLowerCase()))\r\n  );\r\n\r\n  const getCashAccountName = (accountId: string | null) => {\r\n    if (!accountId) return null;\r\n    const account = accounts.find(acc => acc.id === accountId);\r\n    return account?.name || 'Unknown Account';\r\n  };\r\n\r\n  const handleView = (expense: Expense) => {\r\n    setSelectedExpense(expense);\r\n    setViewDialogOpen(true);\r\n  };\r\n\r\n  const handleEdit = (expense: Expense) => {\r\n    setSelectedExpense(expense);\r\n    setEditDialogOpen(true);\r\n  };\r\n\r\n  const handleDelete = (expense: Expense) => {\r\n    setSelectedExpense(expense);\r\n    setDeleteDialogOpen(true);\r\n  };\r\n\r\n  const handleUpdateExpense = async (updates: any) => {\r\n    if (selectedExpense) {\r\n      await onUpdateExpense(selectedExpense.id, updates);\r\n      setEditDialogOpen(false);\r\n      setSelectedExpense(null);\r\n    }\r\n  };\r\n\r\n  const handleConfirmDelete = async () => {\r\n    if (selectedExpense) {\r\n      const success = await onDeleteExpense(selectedExpense.id);\r\n      if (success) {\r\n        setDeleteDialogOpen(false);\r\n        setSelectedExpense(null);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Mobile Card View\r\n  if (isMobile) {\r\n    return (\r\n      <>\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex flex-col gap-4\">\r\n              <CardTitle className=\"text-lg\">Expenses List</CardTitle>\r\n              <div className=\"relative\">\r\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4\" />\r\n                <Input\r\n                  placeholder=\"Search expenses...\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  className=\"pl-10\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent className=\"px-3\">\r\n            {filteredExpenses.length === 0 ? (\r\n              <div className=\"text-center py-8\">\r\n                <p className=\"text-muted-foreground\">\r\n                  {searchTerm ? 'No expenses found matching your search.' : 'No expenses found.'}\r\n                </p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-3\">\r\n                {filteredExpenses.map((expense) => (\r\n                  <Card\r\n                    key={expense.id}\r\n                    className=\"p-4 space-y-3 cursor-pointer hover:shadow-md transition-shadow border-l-4 border-l-red-500\"\r\n                    onClick={() => handleView(expense)}\r\n                  >\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div className=\"space-y-1 flex-1\">\r\n                        <div className=\"text-sm font-medium text-muted-foreground\">\r\n                          {expense.date.toLocaleDateString()}\r\n                        </div>\r\n                        <div className=\"text-base font-semibold line-clamp-2\">\r\n                          {expense.description}\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"text-right space-y-1\">\r\n                        <div className=\"text-lg font-bold text-red-600\">\r\n                          {canViewTotalExpenses ? formatCashCurrency(expense.amount, currency) : ''}\r\n                        </div>\r\n                        <div className=\"flex gap-1\" onClick={(e) => e.stopPropagation()}>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleView(expense)}\r\n                            className=\"h-6 w-6 p-0 text-gray-600 hover:text-gray-700\"\r\n                          >\r\n                            <Eye className=\"h-3 w-3\" />\r\n                          </Button>\r\n                          {hasPermission('expenses', 'edit') && (\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleEdit(expense)}\r\n                              className=\"h-6 w-6 p-0 text-blue-600 hover:text-blue-700\"\r\n                            >\r\n                              <Edit className=\"h-3 w-3\" />\r\n                            </Button>\r\n                          )}\r\n                          {hasPermission('expenses', 'delete') && (\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleDelete(expense)}\r\n                              className=\"h-6 w-6 p-0 text-red-600 hover:text-red-700\"\r\n                            >\r\n                              <Trash2 className=\"h-3 w-3\" />\r\n                            </Button>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2 text-sm\">\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <span className=\"font-medium text-muted-foreground\">Category:</span>\r\n                        {expense.category ? (\r\n                          <Badge variant=\"secondary\" className=\"text-xs\">{expense.category}</Badge>\r\n                        ) : (\r\n                          <span className=\"text-muted-foreground\">-</span>\r\n                        )}\r\n                      </div>\r\n\r\n                      {expense.paymentMethod && (\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <span className=\"font-medium text-muted-foreground\">Payment:</span>\r\n                          <span className=\"text-xs\">{expense.paymentMethod}</span>\r\n                        </div>\r\n                      )}\r\n\r\n                      {expense.personInCharge && (\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <span className=\"font-medium text-muted-foreground\">Person in Charge:</span>\r\n                          <span className=\"text-xs\">{expense.personInCharge}</span>\r\n                        </div>\r\n                      )}\r\n\r\n                      {expense.receiptImage && (\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <span className=\"font-medium text-muted-foreground\">Receipt:</span>\r\n                          <Badge variant=\"outline\" className=\"text-xs\">Available</Badge>\r\n                        </div>\r\n                      )}\r\n\r\n                      {expense.cashAccountId && (\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <span className=\"font-medium text-muted-foreground\">Cash Account:</span>\r\n                          <Badge variant=\"outline\" className=\"text-xs\">{getCashAccountName(expense.cashAccountId)}</Badge>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </Card>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* View Dialog */}\r\n        <ViewExpenseDialog\r\n          expense={selectedExpense}\r\n          open={viewDialogOpen}\r\n          onOpenChange={setViewDialogOpen}\r\n          formatCurrency={formatCurrency}\r\n          accounts={accounts}\r\n        />\r\n\r\n        {/* Edit Dialog */}\r\n        <EditExpenseDialog\r\n          expense={selectedExpense}\r\n          open={editDialogOpen}\r\n          onOpenChange={setEditDialogOpen}\r\n          onSubmit={handleUpdateExpense}\r\n        />\r\n\r\n        {/* Delete Dialog */}\r\n        <DeleteExpenseDialog\r\n          expense={selectedExpense}\r\n          open={deleteDialogOpen}\r\n          onOpenChange={setDeleteDialogOpen}\r\n          onConfirm={handleConfirmDelete}\r\n          formatCurrency={formatCurrency}\r\n        />\r\n      </>\r\n    );\r\n  }\r\n\r\n  // Desktop Table View\r\n  return (\r\n    <>\r\n      <Card>\r\n        <CardHeader className=\"pb-4\">\r\n          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n            <CardTitle className=\"text-lg md:text-xl\">Expenses List</CardTitle>\r\n            <div className=\"relative w-full sm:w-80\">\r\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4\" />\r\n              <Input\r\n                placeholder=\"Search expenses by description, category, payment method...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"pl-10\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {filteredExpenses.length === 0 ? (\r\n            <div className=\"text-center py-8\">\r\n              <p className=\"text-muted-foreground\">\r\n                {searchTerm ? 'No expenses found matching your search.' : 'No expenses found.'}\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"overflow-x-auto\">\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead>Date</TableHead>\r\n                    <TableHead>Description</TableHead>\r\n                    <TableHead>Category</TableHead>\r\n                    <TableHead>Amount</TableHead>\r\n                    <TableHead>Payment Method</TableHead>\r\n                    <TableHead>Person In Charge</TableHead>\r\n                    <TableHead>Cash Account</TableHead>\r\n                    <TableHead>Receipt</TableHead>\r\n                    <TableHead className=\"text-right\">Actions</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n                <TableBody>\r\n                  {filteredExpenses.map((expense) => (\r\n                    <TableRow\r\n                      key={expense.id}\r\n                      className=\"cursor-pointer hover:bg-muted/50\"\r\n                      onClick={() => handleView(expense)}\r\n                    >\r\n                      <TableCell className=\"whitespace-nowrap\">\r\n                        {expense.date.toLocaleDateString()}\r\n                      </TableCell>\r\n                      <TableCell className=\"font-medium\">\r\n                        {expense.description}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {expense.category ? (\r\n                          <Badge variant=\"secondary\">{expense.category}</Badge>\r\n                        ) : (\r\n                          <span className=\"text-muted-foreground\">-</span>\r\n                        )}\r\n                      </TableCell>\r\n                      <TableCell className=\"font-semibold text-red-600\">\r\n                        {canViewTotalExpenses ? formatCashCurrency(expense.amount, currency) : ''}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {expense.paymentMethod || <span className=\"text-muted-foreground\">-</span>}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {expense.personInCharge || <span className=\"text-muted-foreground\">-</span>}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {expense.cashAccountId ? (\r\n                          <Badge variant=\"outline\">{getCashAccountName(expense.cashAccountId)}</Badge>\r\n                        ) : (\r\n                          <span className=\"text-muted-foreground\">-</span>\r\n                        )}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {expense.receiptImage ? (\r\n                          <Badge variant=\"outline\">Receipt</Badge>\r\n                        ) : (\r\n                          <span className=\"text-muted-foreground\">-</span>\r\n                        )}\r\n                      </TableCell>\r\n                      <TableCell className=\"text-right\">\r\n                        <div className=\"flex justify-end gap-1\" onClick={(e) => e.stopPropagation()}>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleView(expense)}\r\n                            className=\"h-8 w-8 p-0\"\r\n                          >\r\n                            <Eye className=\"h-4 w-4\" />\r\n                          </Button>\r\n                          {hasPermission('expenses', 'edit') && (\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleEdit(expense)}\r\n                              className=\"h-8 w-8 p-0\"\r\n                            >\r\n                              <Edit className=\"h-4 w-4\" />\r\n                            </Button>\r\n                          )}\r\n                          {hasPermission('expenses', 'delete') && (\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleDelete(expense)}\r\n                              className=\"h-8 w-8 p-0 text-destructive hover:text-destructive\"\r\n                            >\r\n                              <Trash2 className=\"h-4 w-4\" />\r\n                            </Button>\r\n                          )}\r\n                        </div>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n                </TableBody>\r\n              </Table>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* View Dialog */}\r\n      <ViewExpenseDialog\r\n        expense={selectedExpense}\r\n        open={viewDialogOpen}\r\n        onOpenChange={setViewDialogOpen}\r\n        formatCurrency={formatCurrency}\r\n        accounts={accounts}\r\n      />\r\n\r\n      {/* Edit Dialog */}\r\n      <EditExpenseDialog\r\n        expense={selectedExpense}\r\n        open={editDialogOpen}\r\n        onOpenChange={setEditDialogOpen}\r\n        onSubmit={handleUpdateExpense}\r\n      />\r\n\r\n      {/* Delete Dialog */}\r\n      <DeleteExpenseDialog\r\n        expense={selectedExpense}\r\n        open={deleteDialogOpen}\r\n        onOpenChange={setDeleteDialogOpen}\r\n        onConfirm={handleConfirmDelete}\r\n        formatCurrency={formatCurrency}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ExpensesList;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6400, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/ExpenseContent.tsx"],"sourcesContent":["import React from 'react';\r\nimport ExpenseStatsCards from '@/components/expenses/ExpenseStatsCards';\r\nimport RecentExpensesCard from '@/components/expenses/RecentExpensesCard';\r\nimport ExpenseCategoriesSummary from '@/components/expenses/ExpenseCategoriesSummary';\r\nimport ExpensesList from '@/components/expenses/ExpensesList';\r\nimport { Expense } from '@/hooks/useExpenses';\r\n\r\ninterface ExpenseContentProps {\r\n  filteredExpenses: Expense[];\r\n  expenseStats: {\r\n    totalExpenses: number;\r\n    thisMonthExpenses: number;\r\n    transactionCount: number;\r\n  };\r\n  formatCurrency: (amount: number) => string;\r\n  dateFilter: string;\r\n  onUpdateExpense: (id: string, data: any) => Promise<any>;\r\n  onDeleteExpense: (id: string) => Promise<boolean>;\r\n  showOnlyOverview?: boolean;\r\n  showOnlyList?: boolean;\r\n}\r\n\r\nconst ExpenseContent: React.FC<ExpenseContentProps> = ({\r\n  filteredExpenses,\r\n  expenseStats,\r\n  formatCurrency,\r\n  dateFilter,\r\n  onUpdateExpense,\r\n  onDeleteExpense,\r\n  showOnlyOverview = false,\r\n  showOnlyList = false\r\n}) => {\r\n  if (showOnlyOverview) {\r\n    return (\r\n      <div className=\"space-y-4 md:space-y-6\">\r\n        {/* Summary Cards */}\r\n        <ExpenseStatsCards\r\n          totalExpenses={expenseStats.totalExpenses}\r\n          thisMonthExpenses={expenseStats.thisMonthExpenses}\r\n          transactionCount={expenseStats.transactionCount}\r\n          formatCurrency={formatCurrency}\r\n          dateFilter={dateFilter}\r\n        />\r\n\r\n        {/* Categories Summary */}\r\n        <ExpenseCategoriesSummary expenses={filteredExpenses} formatCurrency={formatCurrency} />\r\n\r\n        {/* Recent Expenses */}\r\n        <RecentExpensesCard\r\n          filteredExpenses={filteredExpenses}\r\n          formatCurrency={formatCurrency}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (showOnlyList) {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <ExpensesList\r\n          expenses={filteredExpenses}\r\n          onUpdateExpense={onUpdateExpense}\r\n          onDeleteExpense={onDeleteExpense}\r\n          formatCurrency={formatCurrency}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Fallback / original behavior if neither prop is provided\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <ExpenseStatsCards\r\n        totalExpenses={expenseStats.totalExpenses}\r\n        thisMonthExpenses={expenseStats.thisMonthExpenses}\r\n        transactionCount={expenseStats.transactionCount}\r\n        formatCurrency={formatCurrency}\r\n        dateFilter={dateFilter}\r\n      />\r\n      <ExpensesList\r\n        expenses={filteredExpenses}\r\n        onUpdateExpense={onUpdateExpense}\r\n        onDeleteExpense={onDeleteExpense}\r\n        formatCurrency={formatCurrency}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ExpenseContent;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;;;;;;AAkBA,MAAM,iBAAgD,CAAC,EACrD,gBAAgB,EAChB,YAAY,EACZ,cAAc,EACd,UAAU,EACV,eAAe,EACf,eAAe,EACf,mBAAmB,KAAK,EACxB,eAAe,KAAK,EACrB;IACC,IAAI,kBAAkB;QACpB,qBACE,6LAAC;YAAI,WAAU;;8BAEb,6LAAC,iKAAiB;oBAChB,eAAe,aAAa,aAAa;oBACzC,mBAAmB,aAAa,iBAAiB;oBACjD,kBAAkB,aAAa,gBAAgB;oBAC/C,gBAAgB;oBAChB,YAAY;;;;;;8BAId,6LAAC,wKAAwB;oBAAC,UAAU;oBAAkB,gBAAgB;;;;;;8BAGtE,6LAAC,kKAAkB;oBACjB,kBAAkB;oBAClB,gBAAgB;;;;;;;;;;;;IAIxB;IAEA,IAAI,cAAc;QAChB,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC,4JAAY;gBACX,UAAU;gBACV,iBAAiB;gBACjB,iBAAiB;gBACjB,gBAAgB;;;;;;;;;;;IAIxB;IAEA,2DAA2D;IAC3D,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,iKAAiB;gBAChB,eAAe,aAAa,aAAa;gBACzC,mBAAmB,aAAa,iBAAiB;gBACjD,kBAAkB,aAAa,gBAAgB;gBAC/C,gBAAgB;gBAChB,YAAY;;;;;;0BAEd,6LAAC,4JAAY;gBACX,UAAU;gBACV,iBAAiB;gBACjB,iBAAiB;gBACjB,gBAAgB;;;;;;;;;;;;AAIxB;KAjEM;uCAmES"}},
    {"offset": {"line": 6515, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/ExpensesDateFilter.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Calendar as CalendarIcon } from \"lucide-react\";\r\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\r\nimport { Calendar } from \"@/components/ui/calendar\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { format } from \"date-fns\";\r\n\r\ninterface ExpensesDateFilterProps {\r\n  dateFilter: string;\r\n  dateRange: { from: Date | undefined; to: Date | undefined; };\r\n  onDateFilterChange: (value: string) => void;\r\n  onDateRangeChange: (range: { from: Date | undefined; to: Date | undefined; }) => void;\r\n}\r\n\r\nconst ExpensesDateFilter: React.FC<ExpensesDateFilterProps> = ({\r\n  dateFilter,\r\n  dateRange,\r\n  onDateFilterChange,\r\n  onDateRangeChange\r\n}) => {\r\n  const preventPropagation = (e: React.MouseEvent | React.TouchEvent) => {\r\n    e.stopPropagation();\r\n  };\r\n  \r\n  return (\r\n    <div \r\n      className=\"flex flex-col sm:flex-row gap-4 items-start sm:items-center mb-4\"\r\n      onClick={preventPropagation}\r\n    >\r\n      <div className=\"w-full sm:w-[200px]\">\r\n        <Select value={dateFilter} onValueChange={onDateFilterChange}>\r\n          <SelectTrigger className=\"bg-white shadow-sm\">\r\n            <SelectValue placeholder=\"Select period\" />\r\n          </SelectTrigger>\r\n          <SelectContent className=\"z-50 bg-white shadow-lg\">\r\n            <SelectItem value=\"all\">All Time</SelectItem>\r\n            <SelectItem value=\"today\">Today</SelectItem>\r\n            <SelectItem value=\"yesterday\">Yesterday</SelectItem>\r\n            <SelectItem value=\"this-week\">This Week</SelectItem>\r\n            <SelectItem value=\"last-week\">Last Week</SelectItem>\r\n            <SelectItem value=\"this-month\">This Month</SelectItem>\r\n            <SelectItem value=\"last-month\">Last Month</SelectItem>\r\n            <SelectItem value=\"this-year\">This Year</SelectItem>\r\n            <SelectItem value=\"custom\">Custom Range</SelectItem>\r\n          </SelectContent>\r\n        </Select>\r\n      </div>\r\n\r\n      {dateFilter === 'custom' && (\r\n        <div className=\"flex items-center space-x-2\">\r\n          <Popover>\r\n            <PopoverTrigger asChild>\r\n              <Button\r\n                variant=\"outline\"\r\n                className=\"bg-white flex items-center gap-2 h-10 pl-3 text-left font-normal\"\r\n              >\r\n                <CalendarIcon className=\"h-4 w-4\" />\r\n                <span>{dateRange.from ? format(dateRange.from, \"MMM d, yyyy\") : \"Start Date\"}</span>\r\n              </Button>\r\n            </PopoverTrigger>\r\n            <PopoverContent className=\"w-auto p-0 z-[100] bg-white shadow-lg\" align=\"start\">\r\n              <Calendar\r\n                initialFocus\r\n                mode=\"single\"\r\n                defaultMonth={dateRange?.from}\r\n                selected={dateRange?.from}\r\n                onSelect={(date) => onDateRangeChange({ ...dateRange, from: date })}\r\n                className=\"p-3 pointer-events-auto\"\r\n                showOutsideDays={true}\r\n              />\r\n            </PopoverContent>\r\n          </Popover>\r\n          \r\n          <span className=\"text-muted-foreground\">to</span>\r\n          \r\n          <Popover>\r\n            <PopoverTrigger asChild>\r\n              <Button\r\n                variant=\"outline\"\r\n                className=\"bg-white flex items-center gap-2 h-10 pl-3 text-left font-normal\"\r\n              >\r\n                <CalendarIcon className=\"h-4 w-4\" />\r\n                <span>{dateRange.to ? format(dateRange.to, \"MMM d, yyyy\") : \"End Date\"}</span>\r\n              </Button>\r\n            </PopoverTrigger>\r\n            <PopoverContent className=\"w-auto p-0 z-[100] bg-white shadow-lg\" align=\"start\">\r\n              <Calendar\r\n                initialFocus\r\n                mode=\"single\"\r\n                defaultMonth={dateRange?.to}\r\n                selected={dateRange?.to}\r\n                onSelect={(date) => onDateRangeChange({ ...dateRange, to: date })}\r\n                className=\"p-3 pointer-events-auto\"\r\n                showOutsideDays={true}\r\n              />\r\n            </PopoverContent>\r\n          </Popover>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ExpensesDateFilter;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;AASA,MAAM,qBAAwD,CAAC,EAC7D,UAAU,EACV,SAAS,EACT,kBAAkB,EAClB,iBAAiB,EAClB;IACC,MAAM,qBAAqB,CAAC;QAC1B,EAAE,eAAe;IACnB;IAEA,qBACE,6LAAC;QACC,WAAU;QACV,SAAS;;0BAET,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,+IAAM;oBAAC,OAAO;oBAAY,eAAe;;sCACxC,6LAAC,sJAAa;4BAAC,WAAU;sCACvB,cAAA,6LAAC,oJAAW;gCAAC,aAAY;;;;;;;;;;;sCAE3B,6LAAC,sJAAa;4BAAC,WAAU;;8CACvB,6LAAC,mJAAU;oCAAC,OAAM;8CAAM;;;;;;8CACxB,6LAAC,mJAAU;oCAAC,OAAM;8CAAQ;;;;;;8CAC1B,6LAAC,mJAAU;oCAAC,OAAM;8CAAY;;;;;;8CAC9B,6LAAC,mJAAU;oCAAC,OAAM;8CAAY;;;;;;8CAC9B,6LAAC,mJAAU;oCAAC,OAAM;8CAAY;;;;;;8CAC9B,6LAAC,mJAAU;oCAAC,OAAM;8CAAa;;;;;;8CAC/B,6LAAC,mJAAU;oCAAC,OAAM;8CAAa;;;;;;8CAC/B,6LAAC,mJAAU;oCAAC,OAAM;8CAAY;;;;;;8CAC9B,6LAAC,mJAAU;oCAAC,OAAM;8CAAS;;;;;;;;;;;;;;;;;;;;;;;YAKhC,eAAe,0BACd,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,iJAAO;;0CACN,6LAAC,wJAAc;gCAAC,OAAO;0CACrB,cAAA,6LAAC,+IAAM;oCACL,SAAQ;oCACR,WAAU;;sDAEV,6LAAC,yNAAY;4CAAC,WAAU;;;;;;sDACxB,6LAAC;sDAAM,UAAU,IAAI,GAAG,IAAA,kKAAM,EAAC,UAAU,IAAI,EAAE,iBAAiB;;;;;;;;;;;;;;;;;0CAGpE,6LAAC,wJAAc;gCAAC,WAAU;gCAAwC,OAAM;0CACtE,cAAA,6LAAC,mJAAQ;oCACP,YAAY;oCACZ,MAAK;oCACL,cAAc,WAAW;oCACzB,UAAU,WAAW;oCACrB,UAAU,CAAC,OAAS,kBAAkB;4CAAE,GAAG,SAAS;4CAAE,MAAM;wCAAK;oCACjE,WAAU;oCACV,iBAAiB;;;;;;;;;;;;;;;;;kCAKvB,6LAAC;wBAAK,WAAU;kCAAwB;;;;;;kCAExC,6LAAC,iJAAO;;0CACN,6LAAC,wJAAc;gCAAC,OAAO;0CACrB,cAAA,6LAAC,+IAAM;oCACL,SAAQ;oCACR,WAAU;;sDAEV,6LAAC,yNAAY;4CAAC,WAAU;;;;;;sDACxB,6LAAC;sDAAM,UAAU,EAAE,GAAG,IAAA,kKAAM,EAAC,UAAU,EAAE,EAAE,iBAAiB;;;;;;;;;;;;;;;;;0CAGhE,6LAAC,wJAAc;gCAAC,WAAU;gCAAwC,OAAM;0CACtE,cAAA,6LAAC,mJAAQ;oCACP,YAAY;oCACZ,MAAK;oCACL,cAAc,WAAW;oCACzB,UAAU,WAAW;oCACrB,UAAU,CAAC,OAAS,kBAAkB;4CAAE,GAAG,SAAS;4CAAE,IAAI;wCAAK;oCAC/D,WAAU;oCACV,iBAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQjC;KAvFM;uCAyFS"}},
    {"offset": {"line": 6814, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/checkbox.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\r\nimport { Check } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Checkbox = React.forwardRef<\r\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\r\n>(({ className, ...props }, ref) => (\r\n  <CheckboxPrimitive.Root\r\n    ref={ref}\r\n    className={cn(\r\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <CheckboxPrimitive.Indicator\r\n      className={cn(\"flex items-center justify-center text-current\")}\r\n    >\r\n      <Check className=\"h-4 w-4\" />\r\n    </CheckboxPrimitive.Indicator>\r\n  </CheckboxPrimitive.Root>\r\n))\r\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\r\n\r\nexport { Checkbox }\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,+KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,kTACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,oLAA2B;YAC1B,WAAW,IAAA,4HAAE,EAAC;sBAEd,cAAA,6LAAC,gNAAK;gBAAC,WAAU;;;;;;;;;;;;;;;;;AAIvB,SAAS,WAAW,GAAG,+KAAsB,CAAC,WAAW"}},
    {"offset": {"line": 6864, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/ExpenseBulkAddDialog.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Calendar } from '@/components/ui/calendar';\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\r\nimport { format } from 'date-fns';\r\nimport { Calendar as CalendarIcon, Plus, Trash2, ArrowUp, ArrowDown, Save, X, Info, Receipt, Wallet, Link } from 'lucide-react';\r\nimport { useExpenses } from '@/hooks/useExpenses';\r\nimport { useCashAccounts } from '@/hooks/useCashAccounts';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { cn } from '@/lib/utils';\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Label } from '@/components/ui/label';\r\n\r\ninterface ExpenseRow {\r\n    id: string;\r\n    amount: number;\r\n    description: string;\r\n    category: string;\r\n    date: Date;\r\n    paymentMethod: string;\r\n    personInCharge: string;\r\n    linkToCash: boolean;\r\n    cashAccountId?: string;\r\n}\r\n\r\ninterface ExpenseBulkAddDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    onSuccess: () => void;\r\n}\r\n\r\nconst STORAGE_KEY = 'bulk_expenses_draft';\r\n\r\nconst ExpenseBulkAddDialog: React.FC<ExpenseBulkAddDialogProps> = ({\r\n    open,\r\n    onOpenChange,\r\n    onSuccess\r\n}) => {\r\n    const isMobile = useIsMobile();\r\n    const { user } = useAuth();\r\n    const { accounts } = useCashAccounts();\r\n    const { createBulkExpenses } = useExpenses();\r\n    const [rows, setRows] = useState<ExpenseRow[]>([]);\r\n    const [globalDate, setGlobalDate] = useState<Date>(new Date());\r\n    const [isSaving, setIsSaving] = useState(false);\r\n\r\n    // Load draft from localStorage\r\n    useEffect(() => {\r\n        if (!open) return;\r\n\r\n        const savedDraft = localStorage.getItem(STORAGE_KEY);\r\n        if (savedDraft) {\r\n            try {\r\n                const parsed = JSON.parse(savedDraft);\r\n                setRows(parsed.map((r: any) => ({ ...r, date: new Date(r.date) })));\r\n            } catch (e) {\r\n                console.error('Failed to parse draft', e);\r\n                addEmptyRow();\r\n            }\r\n        } else {\r\n            setRows([]);\r\n            addEmptyRow();\r\n        }\r\n    }, [open]);\r\n\r\n    // Save draft to localStorage whenever rows change\r\n    useEffect(() => {\r\n        if (rows.length > 0) {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(rows));\r\n        } else {\r\n            localStorage.removeItem(STORAGE_KEY);\r\n        }\r\n    }, [rows]);\r\n\r\n    const addEmptyRow = () => {\r\n        const newId = Math.random().toString(36).substr(2, 9);\r\n        const newRow: ExpenseRow = {\r\n            id: newId,\r\n            amount: 0,\r\n            description: '',\r\n            category: 'Other',\r\n            date: globalDate,\r\n            paymentMethod: 'Cash',\r\n            personInCharge: '',\r\n            linkToCash: false,\r\n            cashAccountId: accounts.length > 0 ? accounts[0].id : undefined\r\n        };\r\n        setRows(prev => [...prev, newRow]);\r\n    };\r\n\r\n    const removeRow = (id: string) => {\r\n        setRows(prev => prev.filter(r => r.id !== id));\r\n        if (rows.length === 1) {\r\n            addEmptyRow();\r\n        }\r\n    };\r\n\r\n    const updateRow = (id: string, updates: Partial<ExpenseRow>) => {\r\n        setRows(prev => prev.map(r => r.id === id ? { ...r, ...updates } : r));\r\n    };\r\n\r\n    const moveRow = (id: string, direction: 'up' | 'down') => {\r\n        const index = rows.findIndex(r => r.id === id);\r\n        if (index < 0) return;\r\n        if (direction === 'up' && index === 0) return;\r\n        if (direction === 'down' && index === rows.length - 1) return;\r\n\r\n        const newRows = [...rows];\r\n        const targetIndex = direction === 'up' ? index - 1 : index + 1;\r\n        [newRows[index], newRows[targetIndex]] = [newRows[targetIndex], newRows[index]];\r\n        setRows(newRows);\r\n    };\r\n\r\n    const handleSaveAll = async () => {\r\n        const validRows = rows.filter(r => r.amount > 0 && r.description.trim() !== '');\r\n        if (validRows.length === 0) {\r\n            alert('Please enter at least one valid expense with amount and description');\r\n            return;\r\n        }\r\n\r\n        const invalidLinks = validRows.filter(r => r.linkToCash && !r.cashAccountId);\r\n        if (invalidLinks.length > 0) {\r\n            alert('Please select a finance account for all linked expenses');\r\n            return;\r\n        }\r\n\r\n        setIsSaving(true);\r\n        try {\r\n            await createBulkExpenses(validRows.map(({ id, ...rest }) => ({ ...rest })));\r\n            localStorage.removeItem(STORAGE_KEY);\r\n            onSuccess();\r\n        } catch (e) {\r\n            console.error('Bulk save failed', e);\r\n            alert('Failed to save expenses. Please check your network connection.');\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    const renderDesktop = () => (\r\n        <div className=\"overflow-x-auto rounded-xl border-none shadow-sm bg-white dark:bg-slate-900\">\r\n            <Table>\r\n                <TableHeader className=\"bg-slate-50 dark:bg-slate-800/50\">\r\n                    <TableRow>\r\n                        <TableHead className=\"w-[140px]\">Date</TableHead>\r\n                        <TableHead className=\"w-[130px]\">Amount</TableHead>\r\n                        <TableHead>Description</TableHead>\r\n                        <TableHead className=\"w-[140px]\">Category</TableHead>\r\n                        <TableHead className=\"w-[180px]\">Link to Cash</TableHead>\r\n                        <TableHead className=\"w-[120px] text-right\">Actions</TableHead>\r\n                    </TableRow>\r\n                </TableHeader>\r\n                <TableBody>\r\n                    {rows.map((row) => (\r\n                        <TableRow key={row.id} className=\"hover:bg-muted/30 transition-colors border-slate-100 dark:border-slate-800\">\r\n                            <TableCell>\r\n                                <Popover>\r\n                                    <PopoverTrigger asChild>\r\n                                        <Button\r\n                                            variant=\"outline\"\r\n                                            size=\"sm\"\r\n                                            className={cn(\"w-full justify-start text-left font-normal h-9 rounded-lg\", !row.date && \"text-muted-foreground\")}\r\n                                        >\r\n                                            <CalendarIcon className=\"mr-2 h-3 w-3 shrink-0\" />\r\n                                            <span className=\"truncate\">{row.date ? format(row.date, \"MMM dd, yyyy\") : \"Date\"}</span>\r\n                                        </Button>\r\n                                    </PopoverTrigger>\r\n                                    <PopoverContent className=\"w-auto p-0 z-[70]\" align=\"start\">\r\n                                        <Calendar\r\n                                            mode=\"single\"\r\n                                            selected={row.date}\r\n                                            onSelect={(date) => date && updateRow(row.id, { date })}\r\n                                            initialFocus\r\n                                        />\r\n                                    </PopoverContent>\r\n                                </Popover>\r\n                            </TableCell>\r\n                            <TableCell>\r\n                                <Input\r\n                                    type=\"number\"\r\n                                    value={row.amount || ''}\r\n                                    onChange={(e) => updateRow(row.id, { amount: Number(e.target.value) })}\r\n                                    className=\"h-9 font-medium rounded-lg\"\r\n                                    placeholder=\"0.00\"\r\n                                />\r\n                            </TableCell>\r\n                            <TableCell>\r\n                                <Input\r\n                                    value={row.description}\r\n                                    onChange={(e) => updateRow(row.id, { description: e.target.value })}\r\n                                    placeholder=\"Description...\"\r\n                                    className=\"h-9 rounded-lg\"\r\n                                />\r\n                            </TableCell>\r\n                            <TableCell>\r\n                                <Select\r\n                                    value={row.category}\r\n                                    onValueChange={(val) => updateRow(row.id, { category: val })}\r\n                                >\r\n                                    <SelectTrigger className=\"h-9 rounded-lg\">\r\n                                        <SelectValue />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        <SelectItem value=\"Sales\">Sales</SelectItem>\r\n                                        <SelectItem value=\"Expenses\">Expenses</SelectItem>\r\n                                        <SelectItem value=\"Payroll\">Payroll</SelectItem>\r\n                                        <SelectItem value=\"Supplies\">Supplies</SelectItem>\r\n                                        <SelectItem value=\"Utilities\">Utilities</SelectItem>\r\n                                        <SelectItem value=\"Rent\">Rent</SelectItem>\r\n                                        <SelectItem value=\"Other\">Other</SelectItem>\r\n                                    </SelectContent>\r\n                                </Select>\r\n                            </TableCell>\r\n                            <TableCell>\r\n                                <div className=\"flex flex-col gap-1.5 p-1 bg-slate-50/50 dark:bg-slate-800/50 rounded-lg\">\r\n                                    <div className=\"flex items-center space-x-2\">\r\n                                        <Checkbox\r\n                                            id={`link-${row.id}`}\r\n                                            checked={row.linkToCash}\r\n                                            onCheckedChange={(checked) => updateRow(row.id, { linkToCash: !!checked })}\r\n                                        />\r\n                                        <Label htmlFor={`link-${row.id}`} className=\"text-[10px] font-medium text-slate-600\">Link Transaction</Label>\r\n                                    </div>\r\n                                    {row.linkToCash && (\r\n                                        <Select\r\n                                            value={row.cashAccountId}\r\n                                            onValueChange={(val) => updateRow(row.id, { cashAccountId: val })}\r\n                                        >\r\n                                            <SelectTrigger className=\"text-[10px] h-7 px-2 rounded-md\">\r\n                                                <SelectValue placeholder=\"Select Account\" />\r\n                                            </SelectTrigger>\r\n                                            <SelectContent>\r\n                                                {accounts.map(acc => (\r\n                                                    <SelectItem key={acc.id} value={acc.id}>{acc.name}</SelectItem>\r\n                                                ))}\r\n                                            </SelectContent>\r\n                                        </Select>\r\n                                    )}\r\n                                </div>\r\n                            </TableCell>\r\n                            <TableCell className=\"text-right\">\r\n                                <div className=\"flex items-center justify-end gap-0.5\">\r\n                                    <Button size=\"icon\" variant=\"ghost\" className=\"h-7 w-7 text-muted-foreground\" onClick={() => moveRow(row.id, 'up')}>\r\n                                        <ArrowUp className=\"h-3.5 w-3.5\" />\r\n                                    </Button>\r\n                                    <Button size=\"icon\" variant=\"ghost\" className=\"h-7 w-7 text-muted-foreground\" onClick={() => moveRow(row.id, 'down')}>\r\n                                        <ArrowDown className=\"h-3.5 w-3.5\" />\r\n                                    </Button>\r\n                                    <Button size=\"icon\" variant=\"ghost\" className=\"h-7 w-7 text-destructive/70 hover:text-destructive hover:bg-destructive/10\" onClick={() => removeRow(row.id)}>\r\n                                        <Trash2 className=\"h-3.5 w-3.5\" />\r\n                                    </Button>\r\n                                </div>\r\n                            </TableCell>\r\n                        </TableRow>\r\n                    ))}\r\n                </TableBody>\r\n            </Table>\r\n        </div>\r\n    );\r\n\r\n    const renderMobile = () => (\r\n        <div className=\"space-y-4 px-1\">\r\n            {rows.map((row, index) => (\r\n                <Card key={row.id} className=\"overflow-hidden border-l-4 border-l-red-500/30 shadow-sm\">\r\n                    <CardHeader className=\"flex flex-row items-center justify-between p-3 pb-2 bg-muted/20\">\r\n                        <CardTitle className=\"text-xs font-semibold uppercase tracking-wider text-muted-foreground\">\r\n                            Expense {index + 1}\r\n                        </CardTitle>\r\n                        <div className=\"flex items-center gap-1\">\r\n                            <Button size=\"icon\" variant=\"ghost\" className=\"h-8 w-8 text-muted-foreground\" onClick={() => moveRow(row.id, 'up')}>\r\n                                <ArrowUp className=\"h-4 w-4\" />\r\n                            </Button>\r\n                            <Button size=\"icon\" variant=\"ghost\" className=\"h-8 w-8 text-destructive/70\" onClick={() => removeRow(row.id)}>\r\n                                <Trash2 className=\"h-4 w-4\" />\r\n                            </Button>\r\n                        </div>\r\n                    </CardHeader>\r\n                    <CardContent className=\"p-3 space-y-3\">\r\n                        <div className=\"grid grid-cols-2 gap-2\">\r\n                            <Popover>\r\n                                <PopoverTrigger asChild>\r\n                                    <Button\r\n                                        variant=\"outline\"\r\n                                        size=\"sm\"\r\n                                        className={cn(\"w-full justify-start text-left font-normal h-9 rounded-lg\", !row.date && \"text-muted-foreground\")}\r\n                                    >\r\n                                        <CalendarIcon className=\"mr-2 h-3 w-3\" />\r\n                                        <span className=\"truncate text-xs\">{row.date ? format(row.date, \"MMM dd, yyyy\") : \"Date\"}</span>\r\n                                    </Button>\r\n                                </PopoverTrigger>\r\n                                <PopoverContent className=\"w-auto p-0 z-[70]\" align=\"start\">\r\n                                    <Calendar\r\n                                        mode=\"single\"\r\n                                        selected={row.date}\r\n                                        onSelect={(date) => date && updateRow(row.id, { date })}\r\n                                        initialFocus\r\n                                    />\r\n                                </PopoverContent>\r\n                            </Popover>\r\n                            <Input\r\n                                type=\"number\"\r\n                                placeholder=\"Amount\"\r\n                                value={row.amount || ''}\r\n                                onChange={(e) => updateRow(row.id, { amount: Number(e.target.value) })}\r\n                                className=\"h-9 font-medium rounded-lg\"\r\n                            />\r\n                        </div>\r\n\r\n                        <Input\r\n                            placeholder=\"Description\"\r\n                            value={row.description}\r\n                            onChange={(e) => updateRow(row.id, { description: e.target.value })}\r\n                            className=\"h-9 rounded-lg\"\r\n                        />\r\n\r\n                        <div className=\"grid grid-cols-2 gap-2\">\r\n                            <Select\r\n                                value={row.category}\r\n                                onValueChange={(val) => updateRow(row.id, { category: val })}\r\n                            >\r\n                                <SelectTrigger className=\"h-9 text-xs rounded-lg\">\r\n                                    <SelectValue placeholder=\"Category\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    <SelectItem value=\"Sales\">Sales</SelectItem>\r\n                                    <SelectItem value=\"Expenses\">Expenses</SelectItem>\r\n                                    <SelectItem value=\"Payroll\">Payroll</SelectItem>\r\n                                    <SelectItem value=\"Other\">Other</SelectItem>\r\n                                </SelectContent>\r\n                            </Select>\r\n                            <Select\r\n                                value={row.paymentMethod}\r\n                                onValueChange={(val) => updateRow(row.id, { paymentMethod: val })}\r\n                            >\r\n                                <SelectTrigger className=\"h-9 text-xs rounded-lg\">\r\n                                    <SelectValue placeholder=\"Method\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    <SelectItem value=\"Cash\">Cash</SelectItem>\r\n                                    <SelectItem value=\"M-Pesa\">M-Pesa</SelectItem>\r\n                                    <SelectItem value=\"Bank\">Bank</SelectItem>\r\n                                    <SelectItem value=\"Card\">Card</SelectItem>\r\n                                </SelectContent>\r\n                            </Select>\r\n                        </div>\r\n\r\n                        <div className=\"flex flex-col gap-2 p-2 bg-slate-50 dark:bg-slate-900 rounded-lg border border-slate-100 dark:border-slate-800\">\r\n                            <div className=\"flex items-center space-x-2\">\r\n                                <Checkbox\r\n                                    id={`link-mobile-${row.id}`}\r\n                                    checked={row.linkToCash}\r\n                                    onCheckedChange={(checked) => updateRow(row.id, { linkToCash: !!checked })}\r\n                                />\r\n                                <Label htmlFor={`link-mobile-${row.id}`} className=\"text-xs font-medium\">Link to Finance Account</Label>\r\n                            </div>\r\n                            {row.linkToCash && (\r\n                                <Select\r\n                                    value={row.cashAccountId}\r\n                                    onValueChange={(val) => updateRow(row.id, { cashAccountId: val })}\r\n                                >\r\n                                    <SelectTrigger className=\"h-9 text-xs rounded-md\">\r\n                                        <SelectValue placeholder=\"Select Account\" />\r\n                                    </SelectTrigger>\r\n                                    <SelectContent>\r\n                                        {accounts.map(acc => (\r\n                                            <SelectItem key={acc.id} value={acc.id}>{acc.name}</SelectItem>\r\n                                        ))}\r\n                                    </SelectContent>\r\n                                </Select>\r\n                            )}\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            ))}\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"max-w-[95vw] md:max-w-6xl p-0 overflow-hidden border-none bg-transparent shadow-none\">\r\n                <div className=\"space-y-4 md:space-y-6\">\r\n                    <Card className=\"shadow-2xl overflow-hidden border-none bg-gradient-to-br from-white to-slate-50 dark:from-slate-900 dark:to-slate-950\">\r\n                        <CardHeader className=\"pb-3 bg-white dark:bg-slate-900 border-b\">\r\n                            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                                <div>\r\n                                    <div className=\"flex items-center gap-2 mb-1\">\r\n                                        <div className=\"bg-red-100 dark:bg-red-900/30 p-2 rounded-lg\">\r\n                                            <Receipt className=\"h-5 w-5 text-red-600\" />\r\n                                        </div>\r\n                                        <CardTitle className=\"text-xl font-bold text-slate-800 dark:text-slate-100\">\r\n                                            Bulk Expense Entry\r\n                                        </CardTitle>\r\n                                    </div>\r\n                                    <p className=\"text-sm text-slate-500 dark:text-slate-400\">\r\n                                        Log multiple expenses efficiently. Link them to finance accounts to update cash ledgers automatically.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <Button variant=\"ghost\" onClick={() => onOpenChange(false)} disabled={isSaving}>\r\n                                        <X className=\"h-4 w-4 mr-2\" />\r\n                                        Cancel\r\n                                    </Button>\r\n                                    <Button\r\n                                        onClick={handleSaveAll}\r\n                                        disabled={isSaving}\r\n                                        className=\"bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 shadow-lg font-bold\"\r\n                                    >\r\n                                        {isSaving ? <Save className=\"h-4 w-4 mr-2 animate-spin\" /> : <Save className=\"h-4 w-4 mr-2\" />}\r\n                                        Save {rows.filter(r => r.amount > 0).length} Expenses\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                        </CardHeader>\r\n                        <CardContent className=\"p-4 sm:p-6 space-y-6 max-h-[80vh] overflow-y-auto custom-scrollbar\">\r\n                            <div className=\"bg-white dark:bg-slate-900/50 rounded-xl p-4 border border-slate-100 dark:border-slate-800 space-y-4\">\r\n                                <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                                    <div className=\"flex items-center gap-3 w-full md:w-auto\">\r\n                                        <div className=\"flex-1 md:flex-initial\">\r\n                                            <p className=\"text-[10px] font-semibold text-muted-foreground uppercase mb-1 ml-1\">Default Date</p>\r\n                                            <Popover>\r\n                                                <PopoverTrigger asChild>\r\n                                                    <Button variant=\"outline\" className={cn(\"justify-start text-left font-normal w-full md:w-[220px] h-10 shadow-sm rounded-lg\", !globalDate && \"text-muted-foreground\")}>\r\n                                                        <CalendarIcon className=\"mr-2 h-4 w-4 text-red-500\" />\r\n                                                        {globalDate ? format(globalDate, \"PPP\") : <span>Pick a date</span>}\r\n                                                    </Button>\r\n                                                </PopoverTrigger>\r\n                                                <PopoverContent className=\"w-auto p-0 z-[100]\" align=\"start\">\r\n                                                    <Calendar\r\n                                                        mode=\"single\"\r\n                                                        selected={globalDate}\r\n                                                        onSelect={(date) => date && setGlobalDate(date)}\r\n                                                        initialFocus\r\n                                                    />\r\n                                                </PopoverContent>\r\n                                            </Popover>\r\n                                        </div>\r\n                                        <div className=\"flex items-end h-full\">\r\n                                            <Button\r\n                                                onClick={addEmptyRow}\r\n                                                variant=\"outline\"\r\n                                                className=\"gap-2 h-10 font-semibold border-red-200 dark:border-red-900/30 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/10 rounded-lg\"\r\n                                            >\r\n                                                <Plus className=\"h-4 w-4\" />\r\n                                                Add Row\r\n                                            </Button>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <Alert className=\"bg-orange-50/50 dark:bg-orange-900/10 border-orange-100 dark:border-orange-900 py-2 w-full md:max-w-xs\">\r\n                                        <Info className=\"h-4 w-4 text-orange-500\" />\r\n                                        <AlertDescription className=\"text-[10px] sm:text-xs\">\r\n                                            Rows with <strong>Link Transaction</strong> checked will automatically create cash deductions.\r\n                                        </AlertDescription>\r\n                                    </Alert>\r\n                                </div>\r\n\r\n                                <div className=\"min-h-[300px]\">\r\n                                    {isMobile ? renderMobile() : renderDesktop()}\r\n                                </div>\r\n\r\n                                {rows.length > 5 && (\r\n                                    <div className=\"flex justify-center pt-2\">\r\n                                        <Button\r\n                                            onClick={addEmptyRow}\r\n                                            variant=\"ghost\"\r\n                                            className=\"gap-2 text-muted-foreground hover:text-red-500\"\r\n                                        >\r\n                                            <Plus className=\"h-4 w-4\" />\r\n                                            Add Another Row\r\n                                        </Button>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n};\r\n\r\nexport default ExpenseBulkAddDialog;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8249, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/progress.tsx"],"sourcesContent":["\r\nimport * as React from \"react\"\r\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Progress = React.forwardRef<\r\n  React.ElementRef<typeof ProgressPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\r\n>(({ className, value, ...props }, ref) => (\r\n  <ProgressPrimitive.Root\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative h-4 w-full overflow-hidden rounded-full bg-gray-200\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <ProgressPrimitive.Indicator\r\n      className=\"h-full w-full flex-1 transition-all\"\r\n      style={{ \r\n        transform: `translateX(-${100 - (value || 0)}%)`,\r\n        backgroundColor: \"#16a34a\"\r\n      }}\r\n    />\r\n  </ProgressPrimitive.Root>\r\n))\r\nProgress.displayName = ProgressPrimitive.Root.displayName\r\n\r\nexport { Progress }\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,OAAO,EAAE,oBACjC,6LAAC,+KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,gEACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,oLAA2B;YAC1B,WAAU;YACV,OAAO;gBACL,WAAW,CAAC,YAAY,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC;gBAChD,iBAAiB;YACnB;;;;;;;;;;;;AAIN,SAAS,WAAW,GAAG,+KAAsB,CAAC,WAAW"}},
    {"offset": {"line": 8294, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/csvParser.ts"],"sourcesContent":["\r\nexport interface CSVProductRow {\r\n  'Product Name': string;\r\n  'Category': string;\r\n  'Description': string;\r\n  'Supplier': string;\r\n  'Creation Date': string;\r\n  'Initial Stock': string;\r\n  'Minimum Stock Level': string;\r\n  'Cost Price': string;\r\n  'Selling Price': string;\r\n  'Manufacturer Barcode'?: string;\r\n}\r\n\r\nexport interface CSVTransactionRow {\r\n  'Date': string;\r\n  'Type': string;\r\n  'Amount': string;\r\n  'Description': string;\r\n  'Category': string;\r\n  'Payment Method'?: string;\r\n  'Person In Charge'?: string;\r\n  'To Account'?: string;\r\n}\r\n\r\nexport interface CSVExpenseRow {\r\n  'Date': string;\r\n  'Amount': string;\r\n  'Description': string;\r\n  'Category': string;\r\n  'Payment Method'?: string;\r\n  'Person In Charge'?: string;\r\n  'Link to Finance'?: string; // 'true' or 'false'\r\n  'Finance Account'?: string; // Account name\r\n}\r\n\r\nexport interface ValidationError {\r\n  row: number;\r\n  field: string;\r\n  message: string;\r\n}\r\n\r\nexport interface ParsedCSVResult {\r\n  validRows: CSVProductRow[];\r\n  errors: ValidationError[];\r\n  totalRows: number;\r\n}\r\n\r\n// Proper CSV parser that handles quoted fields with commas\r\nconst parseCSVLine = (line: string): string[] => {\r\n  const result: string[] = [];\r\n  let current = '';\r\n  let inQuotes = false;\r\n  let i = 0;\r\n\r\n  while (i < line.length) {\r\n    const char = line[i];\r\n    const nextChar = line[i + 1];\r\n\r\n    if (char === '\"') {\r\n      if (inQuotes && nextChar === '\"') {\r\n        // Escaped quote - add single quote to current field\r\n        current += '\"';\r\n        i += 2; // Skip both quotes\r\n        continue;\r\n      } else {\r\n        // Toggle quote state\r\n        inQuotes = !inQuotes;\r\n      }\r\n    } else if (char === ',' && !inQuotes) {\r\n      // Field separator - push current field and reset\r\n      result.push(current.trim());\r\n      current = '';\r\n    } else {\r\n      // Regular character - add to current field\r\n      current += char;\r\n    }\r\n\r\n    i++;\r\n  }\r\n\r\n  // Push the last field\r\n  result.push(current.trim());\r\n  return result;\r\n};\r\n\r\nexport const parseCSV = (csvText: string): ParsedCSVResult => {\r\n  const lines = csvText.trim().split('\\n');\r\n  const headers = parseCSVLine(lines[0]).map(h => h.trim());\r\n\r\n  const validRows: CSVProductRow[] = [];\r\n  const errors: ValidationError[] = [];\r\n\r\n  for (let i = 1; i < lines.length; i++) {\r\n    const values = parseCSVLine(lines[i]).map(v => v.trim());\r\n    const row: any = {};\r\n\r\n    // Map values to headers\r\n    headers.forEach((header, index) => {\r\n      row[header] = values[index] || '';\r\n    });\r\n\r\n    // Validate required fields\r\n    const rowErrors = validateCSVRow(row, i + 1);\r\n\r\n    if (rowErrors.length === 0) {\r\n      validRows.push(row as CSVProductRow);\r\n    } else {\r\n      errors.push(...rowErrors);\r\n    }\r\n  }\r\n\r\n  return {\r\n    validRows,\r\n    errors,\r\n    totalRows: lines.length - 1\r\n  };\r\n};\r\n\r\nexport interface ParsedTransactionCSVResult {\r\n  validRows: CSVTransactionRow[];\r\n  errors: ValidationError[];\r\n  totalRows: number;\r\n}\r\n\r\nexport const parseTransactionCSV = (csvText: string): ParsedTransactionCSVResult => {\r\n  const lines = csvText.trim().split('\\n');\r\n  if (lines.length < 1) return { validRows: [], errors: [], totalRows: 0 };\r\n\r\n  const headers = parseCSVLine(lines[0]).map(h => h.trim());\r\n\r\n  const validRows: CSVTransactionRow[] = [];\r\n  const errors: ValidationError[] = [];\r\n\r\n  for (let i = 1; i < lines.length; i++) {\r\n    if (!lines[i].trim()) continue;\r\n\r\n    const values = parseCSVLine(lines[i]).map(v => v.trim());\r\n    const row: any = {};\r\n\r\n    // Map values to headers\r\n    headers.forEach((header, index) => {\r\n      row[header] = values[index] || '';\r\n    });\r\n\r\n    // Validate required fields\r\n    const rowErrors = validateTransactionCSVRow(row, i + 1);\r\n\r\n    if (rowErrors.length === 0) {\r\n      validRows.push(row as CSVTransactionRow);\r\n    } else {\r\n      errors.push(...rowErrors);\r\n    }\r\n  }\r\n\r\n  return {\r\n    validRows,\r\n    errors,\r\n    totalRows: lines.length - 1\r\n  };\r\n};\r\n\r\nexport interface ParsedExpenseCSVResult {\r\n  validRows: CSVExpenseRow[];\r\n  errors: ValidationError[];\r\n  totalRows: number;\r\n}\r\n\r\nexport const parseExpenseCSV = (csvText: string): ParsedExpenseCSVResult => {\r\n  const lines = csvText.trim().split('\\n');\r\n  if (lines.length < 1) return { validRows: [], errors: [], totalRows: 0 };\r\n\r\n  const headers = parseCSVLine(lines[0]).map(h => h.trim());\r\n\r\n  const validRows: CSVExpenseRow[] = [];\r\n  const errors: ValidationError[] = [];\r\n\r\n  for (let i = 1; i < lines.length; i++) {\r\n    if (!lines[i].trim()) continue;\r\n\r\n    const values = parseCSVLine(lines[i]).map(v => v.trim());\r\n    const row: any = {};\r\n\r\n    // Map values to headers\r\n    headers.forEach((header, index) => {\r\n      row[header] = values[index] || '';\r\n    });\r\n\r\n    // Validate required fields\r\n    const rowErrors = validateExpenseCSVRow(row, i + 1);\r\n\r\n    if (rowErrors.length === 0) {\r\n      validRows.push(row as CSVExpenseRow);\r\n    } else {\r\n      errors.push(...rowErrors);\r\n    }\r\n  }\r\n\r\n  return {\r\n    validRows,\r\n    errors,\r\n    totalRows: lines.length - 1\r\n  };\r\n};\r\n\r\nconst validateCSVRow = (row: any, rowNumber: number): ValidationError[] => {\r\n  const errors: ValidationError[] = [];\r\n\r\n  // Only validate that Product Name is present\r\n  if (!row['Product Name']?.trim()) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Product Name',\r\n      message: 'Product Name is required'\r\n    });\r\n  }\r\n\r\n  return errors;\r\n};\r\n\r\nexport const validateTransactionCSVRow = (row: any, rowNumber: number): ValidationError[] => {\r\n  const errors: ValidationError[] = [];\r\n\r\n  if (!row['Amount'] || isNaN(Number(row['Amount'])) || Number(row['Amount']) <= 0) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Amount',\r\n      message: 'Amount must be a positive number'\r\n    });\r\n  }\r\n\r\n  if (!row['Type'] || !['cash_in', 'cash_out', 'transfer'].includes(row['Type'].toLowerCase())) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Type',\r\n      message: 'Type must be \"cash_in\", \"cash_out\", or \"transfer\"'\r\n    });\r\n  }\r\n\r\n  if (!row['Description']?.trim()) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Description',\r\n      message: 'Description is required'\r\n    });\r\n  }\r\n\r\n  if (row['Type']?.toLowerCase() === 'transfer' && !row['To Account']) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'To Account',\r\n      message: 'To Account is required for transfers'\r\n    });\r\n  }\r\n\r\n  return errors;\r\n};\r\n\r\nexport const validateExpenseCSVRow = (row: any, rowNumber: number): ValidationError[] => {\r\n  const errors: ValidationError[] = [];\r\n\r\n  if (!row['Amount'] || isNaN(Number(row['Amount'])) || Number(row['Amount']) <= 0) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Amount',\r\n      message: 'Amount must be a positive number'\r\n    });\r\n  }\r\n\r\n  if (!row['Description']?.trim()) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Description',\r\n      message: 'Description is required'\r\n    });\r\n  }\r\n\r\n  const linkToFinance = row['Link to Finance']?.toString().toLowerCase();\r\n  if (linkToFinance === 'true' && !row['Finance Account']?.trim()) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Finance Account',\r\n      message: 'Finance Account is required when Link to Finance is true'\r\n    });\r\n  }\r\n\r\n  return errors;\r\n};\r\n\r\nexport const generateErrorLogCSV = (errors: ValidationError[], filename: string = 'upload_errors.csv') => {\r\n  const headers = ['Row', 'Field', 'Error Message'];\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...errors.map(error =>\r\n      [error.row, error.field, `\"${error.message}\"`].join(',')\r\n    )\r\n  ].join('\\n');\r\n\r\n  const blob = new Blob([csvContent], { type: 'text/csv' });\r\n  const url = window.URL.createObjectURL(blob);\r\n  const link = document.createElement('a');\r\n  link.href = url;\r\n  link.download = filename;\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  window.URL.revokeObjectURL(url);\r\n};\r\n\r\nexport const extractUniqueCategories = (validRows: CSVProductRow[]): string[] => {\r\n  const categories = validRows\r\n    .map(row => row['Category']?.trim())\r\n    .filter(category => category && category !== '');\r\n\r\n  return [...new Set(categories)];\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8548, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/ExpenseCSVUploadDialog.tsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Upload, FileText, AlertCircle, CheckCircle, Download, Info, Receipt, X } from 'lucide-react';\r\nimport * as XLSX from 'xlsx';\r\nimport { parseExpenseCSV, generateErrorLogCSV, ValidationError, CSVExpenseRow, validateExpenseCSVRow } from '@/utils/csvParser';\r\nimport { cn } from '@/lib/utils';\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { useExpenses } from '@/hooks/useExpenses';\r\nimport { useCashAccounts } from '@/hooks/useCashAccounts';\r\n\r\ninterface ExpenseCSVUploadDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    onUploadComplete: () => void;\r\n}\r\n\r\ninterface UploadState {\r\n    step: 'select' | 'preview' | 'uploading' | 'complete';\r\n    file: File | null;\r\n    validRows: CSVExpenseRow[];\r\n    errors: ValidationError[];\r\n    totalRows: number;\r\n    uploadProgress: number;\r\n    successCount: number;\r\n    failureCount: number;\r\n}\r\n\r\nconst ExpenseCSVUploadDialog: React.FC<ExpenseCSVUploadDialogProps> = ({\r\n    open,\r\n    onOpenChange,\r\n    onUploadComplete\r\n}) => {\r\n    const { createBulkExpenses } = useExpenses();\r\n    const { accounts } = useCashAccounts();\r\n    const [state, setState] = useState<UploadState>({\r\n        step: 'select',\r\n        file: null,\r\n        validRows: [],\r\n        errors: [],\r\n        totalRows: 0,\r\n        uploadProgress: 0,\r\n        successCount: 0,\r\n        failureCount: 0\r\n    });\r\n\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [isUploading, setIsUploading] = useState(false);\r\n\r\n    const convertCSVRowToExpenseBody = (row: CSVExpenseRow) => {\r\n        let expenseDate = new Date();\r\n        const rawDate = row['Date'] as any;\r\n        const dateValue = rawDate?.toString();\r\n\r\n        if (dateValue) {\r\n            if (rawDate instanceof Date) {\r\n                expenseDate = rawDate;\r\n            } else {\r\n                const ddmmyyyyMatch = dateValue.match(/^(\\d{1,2})[/-](\\d{1,2})[/-](\\d{4})$/);\r\n                if (ddmmyyyyMatch) {\r\n                    const [, day, month, year] = ddmmyyyyMatch;\r\n                    expenseDate = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));\r\n                } else {\r\n                    const parsedDate = new Date(dateValue);\r\n                    if (!isNaN(parsedDate.getTime())) {\r\n                        expenseDate = parsedDate;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        let cashAccountId = '';\r\n        const linkToCash = row['Link to Finance']?.toString().toLowerCase() === 'true';\r\n\r\n        if (linkToCash && row['Finance Account']) {\r\n            const targetAccount = accounts?.find(a =>\r\n                a.name.toLowerCase() === row['Finance Account']?.toString().toLowerCase()\r\n            );\r\n            if (targetAccount) {\r\n                cashAccountId = targetAccount.id;\r\n            }\r\n        }\r\n\r\n        return {\r\n            amount: parseFloat(row['Amount']?.toString().replace(/[^0-9.-]/g, '') || '0'),\r\n            description: row['Description'] || '',\r\n            category: row['Category'] || 'Other',\r\n            date: expenseDate,\r\n            paymentMethod: row['Payment Method'] || 'Cash',\r\n            personInCharge: row['Person In Charge'] || '',\r\n            linkToCash,\r\n            cashAccountId: cashAccountId || undefined\r\n        };\r\n    };\r\n\r\n    const handleFileSelect = async (file: File) => {\r\n        const isExcel = file.name.endsWith('.xlsx') || file.name.endsWith('.xls');\r\n        const isCSV = file.name.endsWith('.csv');\r\n\r\n        if (!isExcel && !isCSV) {\r\n            alert('Please select a CSV or Excel file');\r\n            return;\r\n        }\r\n\r\n        let result: { validRows: CSVExpenseRow[], errors: ValidationError[], totalRows: number };\r\n\r\n        if (isExcel) {\r\n            const buffer = await file.arrayBuffer();\r\n            const workbook = XLSX.read(buffer, { cellDates: true });\r\n            const firstSheetName = workbook.SheetNames[0];\r\n            const worksheet = workbook.Sheets[firstSheetName];\r\n            const rawRows = XLSX.utils.sheet_to_json(worksheet) as any[];\r\n\r\n            const csvRows: CSVExpenseRow[] = rawRows.map(row => ({\r\n                'Date': row['Date'] || '',\r\n                'Amount': row['Amount'] || '',\r\n                'Description': row['Description'] || '',\r\n                'Category': row['Category'] || '',\r\n                'Payment Method': row['Payment Method'] || '',\r\n                'Person In Charge': row['Person In Charge'] || '',\r\n                'Link to Finance': row['Link to Finance'] || '',\r\n                'Finance Account': row['Finance Account'] || ''\r\n            }));\r\n\r\n            const validRows: CSVExpenseRow[] = [];\r\n            const errors: ValidationError[] = [];\r\n\r\n            csvRows.forEach((row, index) => {\r\n                const rowErrors = validateExpenseCSVRow(row, index + 2);\r\n\r\n                if (row['Link to Finance']?.toString().toLowerCase() === 'true' && row['Finance Account']) {\r\n                    const match = accounts?.find(a =>\r\n                        a.name.toLowerCase() === row['Finance Account']?.toString().toLowerCase()\r\n                    );\r\n                    if (!match) {\r\n                        rowErrors.push({\r\n                            row: index + 2,\r\n                            field: 'Finance Account',\r\n                            message: `Account \"${row['Finance Account']}\" not found.`\r\n                        });\r\n                    }\r\n                }\r\n\r\n                if (rowErrors.length === 0) {\r\n                    validRows.push(row);\r\n                } else {\r\n                    errors.push(...rowErrors);\r\n                }\r\n            });\r\n\r\n            result = { validRows, errors, totalRows: csvRows.length };\r\n        } else {\r\n            const text = await file.text();\r\n            result = parseExpenseCSV(text);\r\n\r\n            const uploadErrors: ValidationError[] = [];\r\n            const filteredValidRows: CSVExpenseRow[] = [];\r\n\r\n            result.validRows.forEach((row, index) => {\r\n                if (row['Link to Finance']?.toString().toLowerCase() === 'true' && row['Finance Account']) {\r\n                    const match = accounts?.find(a =>\r\n                        a.name.toLowerCase() === row['Finance Account']?.toString().toLowerCase()\r\n                    );\r\n                    if (!match) {\r\n                        uploadErrors.push({\r\n                            row: index + 2,\r\n                            field: 'Finance Account',\r\n                            message: `Account \"${row['Finance Account']}\" not found.`\r\n                        });\r\n                    } else {\r\n                        filteredValidRows.push(row);\r\n                    }\r\n                } else {\r\n                    filteredValidRows.push(row);\r\n                }\r\n            });\r\n\r\n            result.errors.push(...uploadErrors);\r\n            result.validRows = filteredValidRows;\r\n        }\r\n\r\n        setState({\r\n            ...state,\r\n            step: 'preview',\r\n            file,\r\n            validRows: result.validRows,\r\n            errors: result.errors,\r\n            totalRows: result.totalRows\r\n        });\r\n    };\r\n\r\n    const handleConfirmUpload = async () => {\r\n        setState(prev => ({ ...prev, step: 'uploading', uploadProgress: 0 }));\r\n        setIsUploading(true);\r\n\r\n        const expenses = state.validRows.map(convertCSVRowToExpenseBody);\r\n\r\n        try {\r\n            await createBulkExpenses(expenses);\r\n            setState(prev => ({\r\n                ...prev,\r\n                step: 'complete',\r\n                uploadProgress: 100,\r\n                successCount: expenses.length,\r\n                failureCount: 0\r\n            }));\r\n            setTimeout(() => onUploadComplete(), 1500);\r\n        } catch (error) {\r\n            console.error('Bulk upload failed:', error);\r\n            setState(prev => ({\r\n                ...prev,\r\n                step: 'complete',\r\n                uploadProgress: 100,\r\n                successCount: 0,\r\n                failureCount: expenses.length\r\n            }));\r\n        } finally {\r\n            setIsUploading(false);\r\n        }\r\n    };\r\n\r\n    const renderFileSelection = () => (\r\n        <div className=\"space-y-6\">\r\n            <div\r\n                className={cn(\r\n                    \"border-4 border-dashed rounded-3xl p-12 text-center cursor-pointer transition-all duration-300\",\r\n                    isDragging\r\n                        ? \"border-red-500 bg-red-50/50 scale-[1.01] shadow-xl\"\r\n                        : \"border-slate-200 dark:border-slate-800 hover:border-red-400 hover:bg-slate-50/50 dark:hover:bg-slate-900/50\"\r\n                )}\r\n                onDrop={(e) => { e.preventDefault(); setIsDragging(false); handleFileSelect(e.dataTransfer.files[0]); }}\r\n                onDragOver={(e) => { e.preventDefault(); setIsDragging(true); }}\r\n                onDragLeave={() => setIsDragging(false)}\r\n                onClick={() => fileInputRef.current?.click()}\r\n            >\r\n                <div className=\"bg-red-100 dark:bg-red-900/40 w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-sm\">\r\n                    <Upload className=\"h-10 w-10 text-red-600 dark:text-red-400\" />\r\n                </div>\r\n                <h3 className=\"text-2xl font-black text-slate-900 dark:text-slate-100 mb-2\">Select CSV or Excel</h3>\r\n                <p className=\"text-sm text-slate-500 dark:text-slate-400 max-w-sm mx-auto mb-8\">\r\n                    Import multiple expenses quickly. Drag and drop your file here or click to browse.\r\n                </p>\r\n                <div className=\"flex justify-center gap-4\">\r\n                    <div className=\"flex items-center gap-2 px-3 py-1.5 bg-slate-100 dark:bg-slate-800 rounded-full text-[11px] font-bold text-slate-600 dark:text-slate-400\">\r\n                        <FileText className=\"h-3 w-3\" /> .CSV\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2 px-3 py-1.5 bg-green-100 dark:bg-green-900/30 rounded-full text-[11px] font-bold text-green-700 dark:text-green-400\">\r\n                        <FileText className=\"h-3 w-3\" /> .XLSX\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"border rounded-2xl overflow-hidden bg-white dark:bg-slate-900 shadow-sm\">\r\n                <div className=\"bg-slate-50 dark:bg-slate-800/50 px-6 py-3 border-b flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <Info className=\"h-4 w-4 text-red-500\" />\r\n                        <span className=\"text-xs font-black text-slate-700 dark:text-slate-300 uppercase tracking-widest\">Expected Format</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"overflow-x-auto\">\r\n                    <Table>\r\n                        <TableHeader>\r\n                            <TableRow className=\"bg-slate-100/30 dark:bg-slate-900/30\">\r\n                                <TableHead className=\"text-[10px] h-9\">Date</TableHead>\r\n                                <TableHead className=\"text-[10px] h-9\">Amount</TableHead>\r\n                                <TableHead className=\"text-[10px] h-9\">Description</TableHead>\r\n                                <TableHead className=\"text-[10px] h-9\">Link to Finance</TableHead>\r\n                                <TableHead className=\"text-[10px] h-9\">Finance Account</TableHead>\r\n                            </TableRow>\r\n                        </TableHeader>\r\n                        <TableBody>\r\n                            <TableRow className=\"h-9 border-slate-100 dark:border-slate-800\">\r\n                                <TableCell className=\"text-[11px] py-1.5 font-mono\">22/12/2025</TableCell>\r\n                                <TableCell className=\"text-[11px] py-1.5 font-bold\">450.00</TableCell>\r\n                                <TableCell className=\"text-[11px] py-1.5 truncate max-w-[120px]\">Office Rent</TableCell>\r\n                                <TableCell className=\"text-[11px] py-1.5 text-red-600 font-bold italic\">true</TableCell>\r\n                                <TableCell className=\"text-[11px] py-1.5 truncate max-w-[120px]\">Company Wallet</TableCell>\r\n                            </TableRow>\r\n                            <TableRow className=\"h-9 border-none\">\r\n                                <TableCell className=\"text-[11px] py-1.5 font-mono\">23/12/2025</TableCell>\r\n                                <TableCell className=\"text-[11px] py-1.5 font-bold\">120.00</TableCell>\r\n                                <TableCell className=\"text-[11px] py-1.5 truncate max-w-[120px]\">Stationery</TableCell>\r\n                                <TableCell className=\"text-[11px] py-1.5 text-slate-400 font-bold italic\">false</TableCell>\r\n                                <TableCell className=\"text-[11px] py-1.5 text-slate-400 italic\">Leave Empty</TableCell>\r\n                            </TableRow>\r\n                        </TableBody>\r\n                    </Table>\r\n                </div>\r\n            </div>\r\n            <input ref={fileInputRef} type=\"file\" accept=\".csv, .xlsx, .xls\" onChange={(e) => e.target.files?.[0] && handleFileSelect(e.target.files[0])} className=\"hidden\" />\r\n        </div>\r\n    );\r\n\r\n    const renderPreview = () => (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"bg-white dark:bg-slate-900 p-6 rounded-2xl border border-slate-100 dark:border-slate-800 shadow-sm\">\r\n                <div className=\"flex items-center justify-between mb-6\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"bg-red-50 dark:bg-red-900/30 p-2 rounded-xl\">\r\n                            <FileText className=\"h-6 w-6 text-red-600\" />\r\n                        </div>\r\n                        <div>\r\n                            <span className=\"text-lg font-black text-slate-900 dark:text-slate-100\">{state.file?.name}</span>\r\n                            <p className=\"text-xs text-slate-500 uppercase font-bold tracking-tight\">Analyzed Successfully</p>\r\n                        </div>\r\n                    </div>\r\n                    <Button variant=\"ghost\" size=\"sm\" onClick={() => setState(prev => ({ ...prev, step: 'select' }))} className=\"text-red-600 font-bold\">\r\n                        Change File\r\n                    </Button>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                    <Card className=\"shadow-none bg-emerald-50/50 dark:bg-emerald-900/10 border-emerald-100 dark:border-emerald-800/50\">\r\n                        <CardContent className=\"p-6\">\r\n                            <div className=\"text-3xl font-black text-emerald-600 dark:text-emerald-400\">{state.validRows.length}</div>\r\n                            <p className=\"text-[10px] font-black text-emerald-700 dark:text-emerald-500 uppercase tracking-widest mt-1\">Ready to Import</p>\r\n                        </CardContent>\r\n                    </Card>\r\n                    <Card className=\"shadow-none bg-rose-50/50 dark:bg-rose-900/10 border-rose-100 dark:border-rose-800/50\">\r\n                        <CardContent className=\"p-6\">\r\n                            <div className=\"text-3xl font-black text-rose-600 dark:text-rose-400\">{state.errors.length}</div>\r\n                            <p className=\"text-[10px] font-black text-rose-700 dark:text-rose-500 uppercase tracking-widest mt-1\">Invalid Records</p>\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n            </div>\r\n\r\n            {state.errors.length > 0 && (\r\n                <Alert variant=\"destructive\" className=\"bg-rose-50/50 dark:bg-rose-900/10 border-rose-200 dark:border-rose-900/50 rounded-2xl p-4\">\r\n                    <AlertCircle className=\"h-5 w-5 text-rose-600\" />\r\n                    <AlertDescription className=\"text-sm text-rose-700 dark:text-rose-400 leading-relaxed font-bold ml-2\">\r\n                        Heads up! {state.errors.length} rows have errors and will be skipped.\r\n                        <Button\r\n                            variant=\"link\"\r\n                            className=\"p-0 h-auto ml-2 text-rose-800 dark:text-rose-300 underline font-black uppercase text-xs\"\r\n                            onClick={() => generateErrorLogCSV(state.errors, 'expense_errors.csv')}\r\n                        >\r\n                            <Download className=\"h-3 w-3 mr-1 inline\" /> Export Error Log\r\n                        </Button>\r\n                    </AlertDescription>\r\n                </Alert>\r\n            )}\r\n\r\n            <Button\r\n                className=\"w-full h-14 bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 shadow-xl font-black text-lg rounded-2xl\"\r\n                onClick={handleConfirmUpload}\r\n                disabled={state.validRows.length === 0}\r\n            >\r\n                Confirm Import of {state.validRows.length} Expenses\r\n            </Button>\r\n        </div>\r\n    );\r\n\r\n    const renderUploading = () => (\r\n        <div className=\"space-y-10 py-12 text-center\">\r\n            <div className=\"relative w-24 h-24 mx-auto\">\r\n                <div className=\"absolute inset-0 rounded-3xl border-4 border-slate-100 dark:border-slate-800\" />\r\n                <div className=\"absolute inset-0 rounded-3xl border-4 border-t-red-600 animate-spin\" />\r\n                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                    <Receipt className=\"h-10 w-10 text-red-500/30\" />\r\n                </div>\r\n            </div>\r\n            <div className=\"space-y-4\">\r\n                <h3 className=\"text-2xl font-black\">Processing Your Data</h3>\r\n                <div className=\"max-w-xs mx-auto space-y-2\">\r\n                    <Progress value={state.uploadProgress} className=\"h-3 rounded-full bg-slate-100 dark:bg-slate-800\" />\r\n                    <span className=\"text-xs font-black text-slate-400 uppercase tracking-[0.2em]\">{Math.round(state.uploadProgress)}% Complete</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderComplete = () => (\r\n        <div className=\"space-y-8 py-8 text-center animate-in fade-in zoom-in duration-500\">\r\n            <div className=\"bg-emerald-100 dark:bg-emerald-900/30 w-24 h-24 rounded-[2rem] flex items-center justify-center mx-auto shadow-inner\">\r\n                <CheckCircle className=\"h-12 w-12 text-emerald-600 dark:text-emerald-400\" />\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n                <h3 className=\"text-3xl font-black tracking-tight\">Import Complete!</h3>\r\n                <p className=\"text-slate-500 dark:text-slate-400 font-bold uppercase text-xs tracking-widest\">\r\n                    Successfully Added <span className=\"text-emerald-600 dark:text-emerald-400 font-black\">{state.successCount} Records</span>\r\n                </p>\r\n            </div>\r\n            <Button onClick={onUploadComplete} className=\"h-14 px-12 rounded-2xl text-lg font-black bg-slate-900 hover:bg-black dark:bg-white dark:text-black shadow-xl\">\r\n                Return to Dashboard\r\n            </Button>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"max-w-[95vw] md:max-w-4xl p-0 overflow-hidden border-none bg-transparent shadow-none\">\r\n                <div className=\"space-y-6\">\r\n                    <Card className=\"shadow-2xl border-none bg-transparent\">\r\n                        <CardHeader className=\"px-6 py-4 bg-white dark:bg-slate-900 border-b rounded-t-[2rem]\">\r\n                            <div className=\"flex justify-between items-center\">\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className=\"bg-red-600 p-2.5 rounded-2xl text-white shadow-lg\">\r\n                                        <Upload className=\"h-6 w-6\" />\r\n                                    </div>\r\n                                    <div>\r\n                                        <CardTitle className=\"text-2xl font-black tracking-tight\">CSV/Excel Importer</CardTitle>\r\n                                        <p className=\"text-sm font-bold text-slate-500 dark:text-slate-400 uppercase tracking-tight\">Bulk process historical expense logs</p>\r\n                                    </div>\r\n                                </div>\r\n                                <Button variant=\"ghost\" onClick={() => onOpenChange(false)} className=\"bg-white dark:bg-slate-900 shadow-sm border rounded-xl h-10 px-4\">\r\n                                    <X className=\"h-4 w-4 mr-2\" /> Cancel\r\n                                </Button>\r\n                            </div>\r\n                        </CardHeader>\r\n                        <CardContent className=\"p-0\">\r\n                            <div className=\"bg-white/95 dark:bg-slate-900/95 backdrop-blur-sm rounded-b-[2rem] p-8 md:p-12 border shadow-sm min-h-[450px] max-h-[85vh] overflow-y-auto custom-scrollbar flex flex-col justify-center\">\r\n                                {state.step === 'select' && renderFileSelection()}\r\n                                {state.step === 'preview' && renderPreview()}\r\n                                {state.step === 'uploading' && renderUploading()}\r\n                                {state.step === 'complete' && renderComplete()}\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n};\r\n\r\nexport default ExpenseCSVUploadDialog;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9623, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/expenses/ExpenseCenter.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Card } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Plus, LayoutGrid, Upload, Download, Receipt } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\n\r\ninterface ExpenseCenterProps {\r\n    onNewEntry: () => void;\r\n    onBulkEntry: () => void;\r\n    onImportCSV: () => void;\r\n    canCreate?: boolean;\r\n}\r\n\r\nconst ExpenseCenter: React.FC<ExpenseCenterProps> = ({\r\n    onNewEntry,\r\n    onBulkEntry,\r\n    onImportCSV,\r\n    canCreate = true\r\n}) => {\r\n    return (\r\n        <Card className=\"border-none shadow-md overflow-hidden bg-gradient-to-br from-white to-slate-50 dark:from-slate-900 dark:to-slate-950 mb-6\">\r\n            <div className=\"p-4 sm:p-6 space-y-4\">\r\n                <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                    <div className=\"space-y-1\">\r\n                        <h3 className=\"text-lg font-bold tracking-tight\">Expense Center</h3>\r\n                        <p className=\"text-xs text-muted-foreground\">Manage your business expenditures efficiently</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3\">\r\n                    {/* Primary Action - New Single Entry */}\r\n                    <Button\r\n                        type=\"button\"\r\n                        onClick={onNewEntry}\r\n                        disabled={!canCreate}\r\n                        className={cn(\r\n                            \"h-auto py-4 flex flex-col items-center justify-center gap-2 text-white shadow-lg border-none active:scale-[0.98] transition-all\",\r\n                            canCreate ? \"bg-red-600 hover:bg-red-700\" : \"bg-slate-400 cursor-not-allowed opacity-60\"\r\n                        )}\r\n                    >\r\n                        <div className=\"bg-white/20 p-2 rounded-lg\">\r\n                            <Plus className=\"h-5 w-5\" />\r\n                        </div>\r\n                        <div className=\"text-center\">\r\n                            <span className=\"block font-bold\">New Entry</span>\r\n                            <span className=\"block text-[10px] opacity-80 font-medium\">Single Expense</span>\r\n                        </div>\r\n                    </Button>\r\n\r\n                    {/* Bulk Entry */}\r\n                    <Button\r\n                        type=\"button\"\r\n                        onClick={onBulkEntry}\r\n                        variant=\"outline\"\r\n                        disabled={!canCreate}\r\n                        className={cn(\r\n                            \"h-auto py-4 flex flex-col items-center justify-center gap-2 border-slate-200 dark:border-slate-800 shadow-sm active:scale-[0.98] transition-all\",\r\n                            canCreate ? \"hover:bg-orange-50/50 dark:hover:bg-orange-900/10 hover:border-orange-200\" : \"opacity-60 cursor-not-allowed\"\r\n                        )}\r\n                    >\r\n                        <div className=\"bg-orange-100 dark:bg-orange-900/30 p-2 rounded-lg text-orange-600 dark:text-orange-400\">\r\n                            <LayoutGrid className=\"h-5 w-5\" />\r\n                        </div>\r\n                        <div className=\"text-center\">\r\n                            <span className=\"block font-bold\">Bulk Entry</span>\r\n                            <span className=\"block text-[10px] text-muted-foreground font-medium\">Manual Batch</span>\r\n                        </div>\r\n                    </Button>\r\n\r\n                    {/* CSV Import */}\r\n                    <Button\r\n                        type=\"button\"\r\n                        onClick={onImportCSV}\r\n                        variant=\"outline\"\r\n                        disabled={!canCreate}\r\n                        className={cn(\r\n                            \"h-auto py-4 flex flex-col items-center justify-center gap-2 border-slate-200 dark:border-slate-800 shadow-sm active:scale-[0.98] transition-all\",\r\n                            canCreate ? \"hover:bg-emerald-50/50 dark:hover:bg-emerald-900/10 hover:border-emerald-200\" : \"opacity-60 cursor-not-allowed\"\r\n                        )}\r\n                    >\r\n                        <div className=\"bg-emerald-100 dark:bg-emerald-900/30 p-2 rounded-lg text-emerald-600 dark:text-emerald-400\">\r\n                            <Upload className=\"h-5 w-5\" />\r\n                        </div>\r\n                        <div className=\"text-center\">\r\n                            <span className=\"block font-bold\">Import CSV</span>\r\n                            <span className=\"block text-[10px] text-muted-foreground font-medium\">Process Legacy Logs</span>\r\n                        </div>\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n        </Card>\r\n    );\r\n};\r\n\r\nexport default ExpenseCenter;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAAA;AAAA;AACA;;;;;;AASA,MAAM,gBAA8C,CAAC,EACjD,UAAU,EACV,WAAW,EACX,WAAW,EACX,YAAY,IAAI,EACnB;IACG,qBACI,6LAAC,2IAAI;QAAC,WAAU;kBACZ,cAAA,6LAAC;YAAI,WAAU;;8BACX,6LAAC;oBAAI,WAAU;8BACX,cAAA,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAG,WAAU;0CAAmC;;;;;;0CACjD,6LAAC;gCAAE,WAAU;0CAAgC;;;;;;;;;;;;;;;;;8BAIrD,6LAAC;oBAAI,WAAU;;sCAEX,6LAAC,+IAAM;4BACH,MAAK;4BACL,SAAS;4BACT,UAAU,CAAC;4BACX,WAAW,IAAA,4HAAE,EACT,mIACA,YAAY,gCAAgC;;8CAGhD,6LAAC;oCAAI,WAAU;8CACX,cAAA,6LAAC,6MAAI;wCAAC,WAAU;;;;;;;;;;;8CAEpB,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAK,WAAU;sDAAkB;;;;;;sDAClC,6LAAC;4CAAK,WAAU;sDAA2C;;;;;;;;;;;;;;;;;;sCAKnE,6LAAC,+IAAM;4BACH,MAAK;4BACL,SAAS;4BACT,SAAQ;4BACR,UAAU,CAAC;4BACX,WAAW,IAAA,4HAAE,EACT,mJACA,YAAY,8EAA8E;;8CAG9F,6LAAC;oCAAI,WAAU;8CACX,cAAA,6LAAC,mOAAU;wCAAC,WAAU;;;;;;;;;;;8CAE1B,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAK,WAAU;sDAAkB;;;;;;sDAClC,6LAAC;4CAAK,WAAU;sDAAsD;;;;;;;;;;;;;;;;;;sCAK9E,6LAAC,+IAAM;4BACH,MAAK;4BACL,SAAS;4BACT,SAAQ;4BACR,UAAU,CAAC;4BACX,WAAW,IAAA,4HAAE,EACT,mJACA,YAAY,iFAAiF;;8CAGjG,6LAAC;oCAAI,WAAU;8CACX,cAAA,6LAAC,mNAAM;wCAAC,WAAU;;;;;;;;;;;8CAEtB,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;4CAAK,WAAU;sDAAkB;;;;;;sDAClC,6LAAC;4CAAK,WAAU;sDAAsD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOlG;KA/EM;uCAiFS"}},
    {"offset": {"line": 9864, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/exportExpensesToCSV.ts"],"sourcesContent":["import { Expense } from '@/hooks/useExpenses';\r\nimport { format } from 'date-fns';\r\n\r\nexport const exportExpensesToCSV = (\r\n  expenses: Expense[],\r\n  formatCurrency: (amount: number) => string,\r\n  currency: string = 'USD'\r\n) => {\r\n  if (expenses.length === 0) {\r\n    alert('No expenses to export');\r\n    return;\r\n  }\r\n\r\n  const headers = [\r\n    'Date',\r\n    'Description',\r\n    'Category',\r\n    'Amount',\r\n    'Payment Method',\r\n    'Person in Charge',\r\n    'Cash Account',\r\n    'Receipt Available'\r\n  ];\r\n\r\n  const csvData = expenses.map(expense => [\r\n    format(expense.date, 'yyyy-MM-dd'),\r\n    `\"${expense.description.replace(/\"/g, '\"\"')}\"`,\r\n    expense.category || '',\r\n    expense.amount.toString(),\r\n    expense.paymentMethod || '',\r\n    expense.personInCharge || '',\r\n    expense.cashAccountId ? 'Yes' : 'No',\r\n    expense.receiptImage ? 'Yes' : 'No'\r\n  ]);\r\n\r\n  const csvContent = [headers, ...csvData]\r\n    .map(row => row.join(','))\r\n    .join('\\n');\r\n\r\n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n  const link = document.createElement('a');\r\n  \r\n  if (link.download !== undefined) {\r\n    const url = URL.createObjectURL(blob);\r\n    link.setAttribute('href', url);\r\n    link.setAttribute('download', `expenses-${currency}-${format(new Date(), 'yyyy-MM-dd')}.csv`);\r\n    link.style.visibility = 'hidden';\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  }\r\n};"],"names":[],"mappings":";;;;AACA;;AAEO,MAAM,sBAAsB,CACjC,UACA,gBACA,WAAmB,KAAK;IAExB,IAAI,SAAS,MAAM,KAAK,GAAG;QACzB,MAAM;QACN;IACF;IAEA,MAAM,UAAU;QACd;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,MAAM,UAAU,SAAS,GAAG,CAAC,CAAA,UAAW;YACtC,IAAA,kKAAM,EAAC,QAAQ,IAAI,EAAE;YACrB,CAAC,CAAC,EAAE,QAAQ,WAAW,CAAC,OAAO,CAAC,MAAM,MAAM,CAAC,CAAC;YAC9C,QAAQ,QAAQ,IAAI;YACpB,QAAQ,MAAM,CAAC,QAAQ;YACvB,QAAQ,aAAa,IAAI;YACzB,QAAQ,cAAc,IAAI;YAC1B,QAAQ,aAAa,GAAG,QAAQ;YAChC,QAAQ,YAAY,GAAG,QAAQ;SAChC;IAED,MAAM,aAAa;QAAC;WAAY;KAAQ,CACrC,GAAG,CAAC,CAAA,MAAO,IAAI,IAAI,CAAC,MACpB,IAAI,CAAC;IAER,MAAM,OAAO,IAAI,KAAK;QAAC;KAAW,EAAE;QAAE,MAAM;IAA0B;IACtE,MAAM,OAAO,SAAS,aAAa,CAAC;IAEpC,IAAI,KAAK,QAAQ,KAAK,WAAW;QAC/B,MAAM,MAAM,IAAI,eAAe,CAAC;QAChC,KAAK,YAAY,CAAC,QAAQ;QAC1B,KAAK,YAAY,CAAC,YAAY,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE,IAAA,kKAAM,EAAC,IAAI,QAAQ,cAAc,IAAI,CAAC;QAC5F,KAAK,KAAK,CAAC,UAAU,GAAG;QACxB,SAAS,IAAI,CAAC,WAAW,CAAC;QAC1B,KAAK,KAAK;QACV,SAAS,IAAI,CAAC,WAAW,CAAC;IAC5B;AACF"}},
    {"offset": {"line": 9922, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/exportExpensesToPDF.ts"],"sourcesContent":["import { Expense } from '@/hooks/useExpenses';\r\nimport { format } from 'date-fns';\r\nimport jsPDF from 'jspdf';\r\n\r\nexport const exportExpensesToPDF = (\r\n  expenses: Expense[],\r\n  formatCurrency: (amount: number) => string,\r\n  currency: string = 'USD',\r\n  businessName?: string,\r\n  businessLogo?: string,\r\n  dateFilter?: string,\r\n  customDateRange?: { from: Date | undefined; to: Date | undefined }\r\n): void => {\r\n  if (expenses.length === 0) {\r\n    alert('No expenses to export');\r\n    return;\r\n  }\r\n\r\n  // Create PDF document in landscape orientation for better table layout\r\n  const doc = new jsPDF({\r\n    orientation: 'landscape',\r\n    unit: 'mm',\r\n    format: 'a4'\r\n  });\r\n\r\n  const pageWidth = doc.internal.pageSize.getWidth();\r\n  const pageHeight = doc.internal.pageSize.getHeight();\r\n  const margin = 8;\r\n\r\n  let yPosition = margin;\r\n\r\n  // Business name and title\r\n  doc.setFontSize(20);\r\n  doc.setFont('helvetica', 'bold');\r\n  const title = businessName || 'Business';\r\n  doc.text(title, margin, yPosition);\r\n  \r\n  yPosition += 12;\r\n  doc.setFontSize(16);\r\n  doc.text('Expenses Report', margin, yPosition);\r\n  \r\n  // Report period\r\n  yPosition += 10;\r\n  doc.setFontSize(12);\r\n  doc.setFont('helvetica', 'normal');\r\n  let periodText = '';\r\n  \r\n  if (dateFilter && dateFilter !== 'all') {\r\n    switch (dateFilter) {\r\n      case 'today':\r\n        periodText = `Period: Today (${format(new Date(), 'MMM dd, yyyy')})`;\r\n        break;\r\n      case 'yesterday':\r\n        const yesterday = new Date();\r\n        yesterday.setDate(yesterday.getDate() - 1);\r\n        periodText = `Period: Yesterday (${format(yesterday, 'MMM dd, yyyy')})`;\r\n        break;\r\n      case 'this-week':\r\n        periodText = 'Period: This Week';\r\n        break;\r\n      case 'last-week':\r\n        periodText = 'Period: Last Week';\r\n        break;\r\n      case 'this-month':\r\n        periodText = `Period: This Month (${format(new Date(), 'MMMM yyyy')})`;\r\n        break;\r\n      case 'last-month':\r\n        const lastMonth = new Date();\r\n        lastMonth.setMonth(lastMonth.getMonth() - 1);\r\n        periodText = `Period: Last Month (${format(lastMonth, 'MMMM yyyy')})`;\r\n        break;\r\n      case 'this-year':\r\n        periodText = `Period: This Year (${format(new Date(), 'yyyy')})`;\r\n        break;\r\n      case 'custom':\r\n        if (customDateRange?.from && customDateRange?.to) {\r\n          periodText = `Period: ${format(customDateRange.from, 'MMM dd, yyyy')} - ${format(customDateRange.to, 'MMM dd, yyyy')}`;\r\n        } else if (customDateRange?.from) {\r\n          periodText = `Period: From ${format(customDateRange.from, 'MMM dd, yyyy')}`;\r\n        } else if (customDateRange?.to) {\r\n          periodText = `Period: Until ${format(customDateRange.to, 'MMM dd, yyyy')}`;\r\n        } else {\r\n          periodText = 'Period: Custom Range';\r\n        }\r\n        break;\r\n      default:\r\n        periodText = 'Period: All Time';\r\n    }\r\n  } else {\r\n    periodText = 'Period: All Time';\r\n  }\r\n  \r\n  doc.text(periodText, margin, yPosition);\r\n  \r\n  // Generation date\r\n  yPosition += 6;\r\n  doc.setFontSize(10);\r\n  doc.text(`Generated on: ${format(new Date(), 'MMM dd, yyyy HH:mm')}`, margin, yPosition);\r\n  \r\n  yPosition += 10;\r\n\r\n  // Calculate totals\r\n  const totalAmount = expenses.reduce((sum, expense) => sum + expense.amount, 0);\r\n\r\n  // Draw table manually using pure jsPDF vector graphics\r\n  const tableStartY = yPosition;\r\n  const rowHeight = 6;\r\n  const headerHeight = 8;\r\n  \r\n  // Define column widths and positions\r\n  const columns = [\r\n    { header: 'Date', width: 25, x: margin },\r\n    { header: 'Description', width: 65, x: margin + 25 },\r\n    { header: 'Category', width: 30, x: margin + 90 },\r\n    { header: `Amount (${currency})`, width: 30, x: margin + 120 },\r\n    { header: 'Payment', width: 30, x: margin + 150 },\r\n    { header: 'Person', width: 35, x: margin + 180 },\r\n    { header: 'Cash', width: 20, x: margin + 215 },\r\n    { header: 'Receipt', width: 20, x: margin + 235 }\r\n  ];\r\n\r\n  // Draw table header\r\n  doc.setFillColor(240, 240, 240);\r\n  doc.rect(margin, tableStartY, pageWidth - 2 * margin, headerHeight, 'F');\r\n  \r\n  doc.setFontSize(9);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(0, 0, 0);\r\n  \r\n  columns.forEach(col => {\r\n    doc.text(col.header, col.x + 2, tableStartY + 6);\r\n  });\r\n\r\n  // Draw header border\r\n  doc.setLineWidth(0.5);\r\n  doc.setDrawColor(0, 0, 0);\r\n  doc.rect(margin, tableStartY, pageWidth - 2 * margin, headerHeight);\r\n\r\n  // Draw table data\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setFontSize(8);\r\n  \r\n  let currentY = tableStartY + headerHeight;\r\n  const maxRowsPerPage = Math.floor((pageHeight - currentY - 20) / rowHeight);\r\n  \r\n  expenses.forEach((expense, index) => {\r\n    // Check if we need a new page\r\n    if (index > 0 && index % maxRowsPerPage === 0) {\r\n      doc.addPage();\r\n      currentY = margin;\r\n      \r\n      // Redraw header on new page\r\n      doc.setFillColor(240, 240, 240);\r\n      doc.rect(margin, currentY, pageWidth - 2 * margin, headerHeight, 'F');\r\n      doc.setFont('helvetica', 'bold');\r\n      doc.setFontSize(9);\r\n      \r\n      columns.forEach(col => {\r\n        doc.text(col.header, col.x + 2, currentY + 6);\r\n      });\r\n      \r\n      doc.rect(margin, currentY, pageWidth - 2 * margin, headerHeight);\r\n      currentY += headerHeight;\r\n      doc.setFont('helvetica', 'normal');\r\n      doc.setFontSize(8);\r\n    }\r\n\r\n    // Alternate row colors\r\n    if (index % 2 === 1) {\r\n      doc.setFillColor(248, 248, 248);\r\n      doc.rect(margin, currentY, pageWidth - 2 * margin, rowHeight, 'F');\r\n    }\r\n\r\n    // Draw row data\r\n    const rowData = [\r\n      format(expense.date, 'MM/dd/yyyy'),\r\n      expense.description.length > 30 ? expense.description.substring(0, 27) + '...' : expense.description,\r\n      expense.category || '-',\r\n      formatCurrency(expense.amount),\r\n      expense.paymentMethod?.substring(0, 12) || '-',\r\n      expense.personInCharge?.substring(0, 15) || '-',\r\n      expense.cashAccountId ? 'Yes' : 'No',\r\n      expense.receiptImage ? 'Yes' : 'No'\r\n    ];\r\n\r\n    columns.forEach((col, colIndex) => {\r\n      const text = rowData[colIndex];\r\n      const textX = col.x + 2;\r\n      \r\n      // Right align amount column\r\n      if (colIndex === 3) {\r\n        const textWidth = doc.getTextWidth(text);\r\n        doc.text(text, col.x + col.width - textWidth - 2, currentY + 4.5);\r\n      } else {\r\n        doc.text(text, textX, currentY + 4.5);\r\n      }\r\n    });\r\n\r\n    // Draw row border\r\n    doc.setLineWidth(0.1);\r\n    doc.rect(margin, currentY, pageWidth - 2 * margin, rowHeight);\r\n\r\n    currentY += rowHeight;\r\n  });\r\n\r\n  // Add summary\r\n  currentY += 8;\r\n  \r\n  // Check if summary fits on current page\r\n  if (currentY + 25 > pageHeight - margin) {\r\n    doc.addPage();\r\n    currentY = margin + 12;\r\n  }\r\n\r\n  // Summary section\r\n  doc.setFontSize(14);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.text('Summary', margin, currentY);\r\n  \r\n  currentY += 12;\r\n  doc.setFontSize(11);\r\n  doc.setFont('helvetica', 'normal');\r\n  \r\n  const summaryData = [\r\n    ['Total Expenses:', expenses.length.toString()],\r\n    ['Total Amount:', formatCurrency(totalAmount)],\r\n    ['With Receipts:', expenses.filter(e => e.receiptImage).length.toString()],\r\n    ['Cash Linked:', expenses.filter(e => e.cashAccountId).length.toString()]\r\n  ];\r\n\r\n  summaryData.forEach((row, index) => {\r\n    const y = currentY + (index * 5);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text(row[0], margin, y);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.text(row[1], margin + 50, y);\r\n  });\r\n\r\n  // Add page numbers and watermark to all pages\r\n  const totalPages = doc.getNumberOfPages();\r\n  for (let i = 1; i <= totalPages; i++) {\r\n    doc.setPage(i);\r\n    doc.setFontSize(8);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.text(\r\n      `Page ${i} of ${totalPages}`,\r\n      pageWidth - margin - 20,\r\n      pageHeight - 10\r\n    );\r\n    \r\n    // Add watermark\r\n    doc.setFontSize(10);\r\n    doc.setFont('helvetica', 'italic');\r\n    doc.setTextColor(150, 150, 150);\r\n    doc.text(\r\n      'Created By Gonza Systems',\r\n      margin,\r\n      pageHeight - 5\r\n    );\r\n    doc.setTextColor(0, 0, 0); // Reset color\r\n  }\r\n\r\n  // Save the PDF\r\n  const fileName = `expenses_report_${format(new Date(), 'yyyy-MM-dd')}.pdf`;\r\n  doc.save(fileName);\r\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10189, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/generateExpenseTemplate.ts"],"sourcesContent":["import * as XLSX from 'xlsx';\r\n\r\nexport const generateExpenseTemplate = () => {\r\n    const headers = [\r\n        'Date',\r\n        'Amount',\r\n        'Description',\r\n        'Category',\r\n        'Payment Method',\r\n        'Person In Charge',\r\n        'Link to Finance',\r\n        'Finance Account'\r\n    ];\r\n\r\n    const sampleData = [\r\n        {\r\n            'Date': '22/12/2025',\r\n            'Amount': '450.00',\r\n            'Description': 'Office Rent',\r\n            'Category': 'Rent',\r\n            'Payment Method': 'Bank',\r\n            'Person In Charge': 'Admin',\r\n            'Link to Finance': 'true',\r\n            'Finance Account': 'Company Wallet'\r\n        },\r\n        {\r\n            'Date': '23/12/2025',\r\n            'Amount': '120.00',\r\n            'Description': 'Stationery',\r\n            'Category': 'Supplies',\r\n            'Payment Method': 'Cash',\r\n            'Person In Charge': 'Manager',\r\n            'Link to Finance': 'false',\r\n            'Finance Account': ''\r\n        }\r\n    ];\r\n\r\n    const worksheet = XLSX.utils.json_to_sheet(sampleData, { header: headers });\r\n    const workbook = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(workbook, worksheet, \"Expenses Template\");\r\n\r\n    // Generate and download\r\n    XLSX.writeFile(workbook, \"expense_import_template.xlsx\");\r\n};\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,0BAA0B;IACnC,MAAM,UAAU;QACZ;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACH;IAED,MAAM,aAAa;QACf;YACI,QAAQ;YACR,UAAU;YACV,eAAe;YACf,YAAY;YACZ,kBAAkB;YAClB,oBAAoB;YACpB,mBAAmB;YACnB,mBAAmB;QACvB;QACA;YACI,QAAQ;YACR,UAAU;YACV,eAAe;YACf,YAAY;YACZ,kBAAkB;YAClB,oBAAoB;YACpB,mBAAmB;YACnB,mBAAmB;QACvB;KACH;IAED,MAAM,YAAY,yIAAU,CAAC,aAAa,CAAC,YAAY;QAAE,QAAQ;IAAQ;IACzE,MAAM,WAAW,yIAAU,CAAC,QAAQ;IACpC,yIAAU,CAAC,iBAAiB,CAAC,UAAU,WAAW;IAElD,wBAAwB;IACxB,6IAAc,CAAC,UAAU;AAC7B"}},
    {"offset": {"line": 10243, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/pages/Expenses.tsx"],"sourcesContent":["import React, { useState, useMemo, useCallback } from 'react';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useExpenses } from '@/hooks/useExpenses';\r\nimport { useExpenseData } from '@/hooks/useExpenseData';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport ExpenseHeader from '@/components/expenses/ExpenseHeader';\r\nimport ExpenseContent from '@/components/expenses/ExpenseContent';\r\nimport ExpensesDateFilter from '@/components/expenses/ExpensesDateFilter';\r\nimport EditExpenseDialog from '@/components/expenses/EditExpenseDialog'; // Use existing EditExpenseDialog or ViewExpenseDialog for single entry? \r\nimport ExpenseForm from '@/components/expenses/ExpenseForm'; // Use ExpenseForm directly or in a Dialog\r\nimport { Dialog, DialogContent } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport ExpenseBulkAddDialog from '@/components/expenses/ExpenseBulkAddDialog';\r\nimport ExpenseCSVUploadDialog from '@/components/expenses/ExpenseCSVUploadDialog';\r\nimport ExpenseCenter from '@/components/expenses/ExpenseCenter';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { formatCashCurrency } from '@/lib/utils';\r\nimport { LayoutGrid, List, PieChart, Plus, Upload, AlertCircle } from 'lucide-react';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\nimport { Alert, AlertTitle, AlertDescription } from '@/components/ui/alert';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { exportExpensesToCSV } from '@/utils/exportExpensesToCSV';\r\nimport { exportExpensesToPDF } from '@/utils/exportExpensesToPDF';\r\nimport { generateExpenseTemplate } from '@/utils/generateExpenseTemplate';\r\n\r\nconst Expenses = () => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const isMobile = useIsMobile();\r\n  const { hasPermission, isLoading: profilesLoading } = useProfiles();\r\n  const { settings } = useBusinessSettings();\r\n  const {\r\n    expenses,\r\n    isLoading,\r\n    createExpense,\r\n    updateExpense,\r\n    deleteExpense,\r\n    refreshExpenses\r\n  } = useExpenses();\r\n\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n  const [isFormDialogOpen, setIsFormDialogOpen] = useState(false);\r\n  const [isBulkEntryOpen, setIsBulkEntryOpen] = useState(false);\r\n  const [isCSVUploadOpen, setIsCSVUploadOpen] = useState(false);\r\n  const [dateFilter, setDateFilter] = useState('all');\r\n  const [customDateRange, setCustomDateRange] = useState<{ from: Date | undefined; to: Date | undefined; }>({\r\n    from: undefined,\r\n    to: undefined\r\n  });\r\n\r\n  const { filteredExpenses, expenseStats, formatCurrency } = useExpenseData(\r\n    expenses || [],\r\n    dateFilter,\r\n    customDateRange\r\n  );\r\n\r\n  const handleCreateExpense = async (data: any) => {\r\n    try {\r\n      await createExpense(data);\r\n      setIsFormDialogOpen(false);\r\n    } catch (error) {\r\n      console.error('Error creating expense:', error);\r\n    }\r\n  };\r\n\r\n  const handleExportCSV = useCallback(() => {\r\n    const currency = settings?.currency || 'USD';\r\n    exportExpensesToCSV(filteredExpenses, formatCurrency, currency);\r\n  }, [filteredExpenses, formatCurrency, settings?.currency]);\r\n\r\n  const handleExportPDF = useCallback(() => {\r\n    const currency = settings?.currency || 'USD';\r\n    exportExpensesToPDF(\r\n      filteredExpenses,\r\n      formatCurrency,\r\n      currency,\r\n      settings?.businessName,\r\n      settings?.businessLogo,\r\n      dateFilter,\r\n      customDateRange\r\n    );\r\n  }, [filteredExpenses, formatCurrency, settings, dateFilter, customDateRange]);\r\n\r\n  if (profilesLoading || isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-[400px]\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!hasPermission('expenses', 'view')) {\r\n    return (\r\n      <div className=\"max-w-4xl mx-auto p-6\">\r\n        <Alert variant=\"destructive\">\r\n          <AlertCircle className=\"h-4 w-4\" />\r\n          <AlertTitle>Access Denied</AlertTitle>\r\n          <AlertDescription>\r\n            You do not have permission to view expenses.\r\n            Please contact your administrator if you believe this is an error.\r\n          </AlertDescription>\r\n        </Alert>\r\n        <div className=\"mt-4\">\r\n          <Button onClick={() => navigate('/')} variant=\"outline\">\r\n            Back to Dashboard\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const canCreate = hasPermission('expenses', 'create');\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <ExpenseHeader\r\n        onAddExpense={() => setIsFormDialogOpen(true)}\r\n        isRefreshing={isLoading}\r\n        onRefresh={refreshExpenses}\r\n        onAddBulkExpense={() => setIsBulkEntryOpen(true)}\r\n        onImportExpenses={() => setIsCSVUploadOpen(true)}\r\n        onExportCSV={handleExportCSV}\r\n        onExportPDF={handleExportPDF}\r\n        onDownloadTemplate={() => generateExpenseTemplate()}\r\n        canCreate={canCreate}\r\n      />\r\n\r\n      <ExpenseForm\r\n        open={isFormDialogOpen}\r\n        onOpenChange={setIsFormDialogOpen}\r\n        onSubmit={handleCreateExpense}\r\n      />\r\n\r\n      <ExpenseBulkAddDialog\r\n        open={isBulkEntryOpen}\r\n        onOpenChange={setIsBulkEntryOpen}\r\n        onSuccess={() => {\r\n          setIsBulkEntryOpen(false);\r\n          refreshExpenses();\r\n        }}\r\n      />\r\n\r\n      <ExpenseCSVUploadDialog\r\n        open={isCSVUploadOpen}\r\n        onOpenChange={setIsCSVUploadOpen}\r\n        onUploadComplete={() => {\r\n          setIsCSVUploadOpen(false);\r\n          refreshExpenses();\r\n        }}\r\n      />\r\n\r\n      <div className=\"px-4 md:px-0\">\r\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full space-y-6\">\r\n          <TabsList className={`grid w-full ${isMobile ? 'grid-cols-2 gap-1 h-auto py-1' : 'grid-cols-2'} bg-slate-100/50 dark:bg-slate-800/50 p-1 rounded-xl`}>\r\n            <TabsTrigger value=\"overview\" className=\"flex items-center gap-2 py-2.5 rounded-lg data-[state=active]:bg-white dark:data-[state=active]:bg-slate-900 data-[state=active]:shadow-sm\">\r\n              <PieChart className=\"h-4 w-4\" />\r\n              <span>Overview</span>\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"expenses-list\" className=\"flex items-center gap-2 py-2.5 rounded-lg data-[state=active]:bg-white dark:data-[state=active]:bg-slate-900 data-[state=active]:shadow-sm\">\r\n              <List className=\"h-4 w-4\" />\r\n              <span>List</span>\r\n            </TabsTrigger>\r\n          </TabsList>\r\n\r\n          <TabsContent value=\"overview\" className=\"space-y-6 animate-in fade-in-50 duration-300\">\r\n            <ExpenseCenter\r\n              onNewEntry={() => setIsFormDialogOpen(true)}\r\n              onBulkEntry={() => setIsBulkEntryOpen(true)}\r\n              onImportCSV={() => setIsCSVUploadOpen(true)}\r\n              canCreate={canCreate}\r\n            />\r\n\r\n            <ExpensesDateFilter\r\n              dateFilter={dateFilter}\r\n              dateRange={customDateRange}\r\n              onDateFilterChange={setDateFilter}\r\n              onDateRangeChange={setCustomDateRange}\r\n            />\r\n\r\n            <ExpenseContent\r\n              filteredExpenses={filteredExpenses}\r\n              expenseStats={expenseStats}\r\n              formatCurrency={formatCurrency}\r\n              dateFilter={dateFilter}\r\n              onUpdateExpense={updateExpense}\r\n              onDeleteExpense={deleteExpense}\r\n              showOnlyOverview={true}\r\n            />\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"expenses-list\" className=\"space-y-6 animate-in fade-in-50 duration-300\">\r\n            <ExpensesDateFilter\r\n              dateFilter={dateFilter}\r\n              dateRange={customDateRange}\r\n              onDateFilterChange={setDateFilter}\r\n              onDateRangeChange={setCustomDateRange}\r\n            />\r\n\r\n            <ExpenseContent\r\n              filteredExpenses={filteredExpenses}\r\n              expenseStats={expenseStats}\r\n              formatCurrency={formatCurrency}\r\n              dateFilter={dateFilter}\r\n              onUpdateExpense={updateExpense}\r\n              onDeleteExpense={deleteExpense}\r\n              showOnlyList={true}\r\n            />\r\n          </TabsContent>\r\n\r\n        </Tabs>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Expenses;\r\n"],"names":[],"mappings":"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"}}]
}