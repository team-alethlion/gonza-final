{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/business-settings.ts"],"sourcesContent":["'use server';\r\n\r\nimport { db } from '../../../prisma/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nexport async function getBusinessSettingsAction(branchId: string) {\r\n    try {\r\n        const settings = await db.branchSettings.findUnique({\r\n            where: { branchId }\r\n        });\r\n\r\n        if (!settings) {\r\n            return null;\r\n        }\r\n\r\n        return {\r\n            id: settings.id,\r\n            business_name: settings.businessName,\r\n            business_address: settings.address,\r\n            business_phone: settings.phone,\r\n            business_email: settings.email,\r\n            business_logo: settings.logo,\r\n            currency: settings.currency,\r\n            signature: settings.signatureImage,\r\n            metadata: settings.metadata || {}\r\n        };\r\n    } catch (error) {\r\n        console.error('Error fetching business settings:', error);\r\n        return null;\r\n    }\r\n}\r\n\r\nexport async function upsertBusinessSettingsAction(branchId: string, userId: string, updateData: any) {\r\n    try {\r\n        // Validate user access to branch\r\n        const branch = await db.branch.findFirst({\r\n            where: {\r\n                id: branchId,\r\n                OR: [\r\n                    { adminId: userId },\r\n                    { users: { some: { id: userId } } }\r\n                ]\r\n            }\r\n        });\r\n\r\n        if (!branch) {\r\n            return { success: false, error: 'Unauthorized to update branch settings' };\r\n        }\r\n\r\n        const data = {\r\n            businessName: updateData.business_name,\r\n            address: updateData.business_address,\r\n            phone: updateData.business_phone,\r\n            email: updateData.business_email,\r\n            logo: updateData.business_logo,\r\n            currency: updateData.currency,\r\n            signatureImage: updateData.signature,\r\n            metadata: updateData.metadata\r\n        };\r\n\r\n        const upserted = await db.branchSettings.upsert({\r\n            where: { branchId: branchId },\r\n            update: data,\r\n            create: {\r\n                branchId: branchId,\r\n                ...data\r\n            }\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: {\r\n                id: upserted.id,\r\n                business_name: upserted.businessName,\r\n                business_address: upserted.address,\r\n                business_phone: upserted.phone,\r\n                business_email: upserted.email,\r\n                business_logo: upserted.logo,\r\n                currency: upserted.currency,\r\n                signature: upserted.signatureImage,\r\n                metadata: upserted.metadata\r\n            }\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error upserting business settings:', error);\r\n        return { success: false, error: error.message || 'Failed to update settings' };\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MAKsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,6DAAA"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/business-settings.ts"],"sourcesContent":["'use server';\r\n\r\nimport { db } from '../../../prisma/db';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nexport async function getBusinessSettingsAction(branchId: string) {\r\n    try {\r\n        const settings = await db.branchSettings.findUnique({\r\n            where: { branchId }\r\n        });\r\n\r\n        if (!settings) {\r\n            return null;\r\n        }\r\n\r\n        return {\r\n            id: settings.id,\r\n            business_name: settings.businessName,\r\n            business_address: settings.address,\r\n            business_phone: settings.phone,\r\n            business_email: settings.email,\r\n            business_logo: settings.logo,\r\n            currency: settings.currency,\r\n            signature: settings.signatureImage,\r\n            metadata: settings.metadata || {}\r\n        };\r\n    } catch (error) {\r\n        console.error('Error fetching business settings:', error);\r\n        return null;\r\n    }\r\n}\r\n\r\nexport async function upsertBusinessSettingsAction(branchId: string, userId: string, updateData: any) {\r\n    try {\r\n        // Validate user access to branch\r\n        const branch = await db.branch.findFirst({\r\n            where: {\r\n                id: branchId,\r\n                OR: [\r\n                    { adminId: userId },\r\n                    { users: { some: { id: userId } } }\r\n                ]\r\n            }\r\n        });\r\n\r\n        if (!branch) {\r\n            return { success: false, error: 'Unauthorized to update branch settings' };\r\n        }\r\n\r\n        const data = {\r\n            businessName: updateData.business_name,\r\n            address: updateData.business_address,\r\n            phone: updateData.business_phone,\r\n            email: updateData.business_email,\r\n            logo: updateData.business_logo,\r\n            currency: updateData.currency,\r\n            signatureImage: updateData.signature,\r\n            metadata: updateData.metadata\r\n        };\r\n\r\n        const upserted = await db.branchSettings.upsert({\r\n            where: { branchId: branchId },\r\n            update: data,\r\n            create: {\r\n                branchId: branchId,\r\n                ...data\r\n            }\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            data: {\r\n                id: upserted.id,\r\n                business_name: upserted.businessName,\r\n                business_address: upserted.address,\r\n                business_phone: upserted.phone,\r\n                business_email: upserted.email,\r\n                business_logo: upserted.logo,\r\n                currency: upserted.currency,\r\n                signature: upserted.signatureImage,\r\n                metadata: upserted.metadata\r\n            }\r\n        };\r\n    } catch (error: any) {\r\n        console.error('Error upserting business settings:', error);\r\n        return { success: false, error: error.message || 'Failed to update settings' };\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MAgCsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,gEAAA"}},
    {"offset": {"line": 38, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/hooks/useBusinessSettings.ts"],"sourcesContent":["\r\nimport { useState, useEffect } from 'react';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { getBusinessSettingsAction, upsertBusinessSettingsAction } from '@/app/actions/business-settings';\r\n\r\nexport interface BusinessSettings {\r\n  id?: string;\r\n  businessName: string;\r\n  businessAddress: string;\r\n  businessPhone: string;\r\n  businessEmail: string;\r\n  businessLogo?: string;\r\n  currency: string;\r\n  signature?: string;\r\n  paymentInfo?: string;\r\n  defaultPrintFormat?: 'standard' | 'thermal';\r\n  defaultPrinterName?: string;\r\n  defaultPrinterType?: 'USB' | 'Bluetooth';\r\n  printerPaperSize?: '58mm' | '80mm';\r\n}\r\n\r\n// Utility function to parse payment info text into structured format\r\nexport const parsePaymentInfo = (paymentInfo: string): { method: string, accountNumber: string, accountName: string }[] => {\r\n  if (!paymentInfo || paymentInfo.trim() === '') {\r\n    return [];\r\n  }\r\n\r\n  const lines = paymentInfo.split('\\n').filter(line => line.trim() !== '');\r\n  const methods: { method: string, accountNumber: string, accountName: string }[] = [];\r\n\r\n  for (let i = 0; i < lines.length; i += 3) {\r\n    if (i + 2 < lines.length) {\r\n      methods.push({\r\n        method: lines[i].trim(),\r\n        accountNumber: lines[i + 1].trim(),\r\n        accountName: lines[i + 2].trim()\r\n      });\r\n    }\r\n  }\r\n\r\n  return methods;\r\n};\r\n\r\n// Utility function to convert payment methods array back to string format\r\nexport const convertPaymentMethodsToString = (paymentMethods: { method: string, accountNumber: string, accountName: string }[]): string => {\r\n  return paymentMethods\r\n    .filter(pm => pm.method.trim() !== '' || pm.accountNumber.trim() !== '' || pm.accountName.trim() !== '')\r\n    .map(pm => `${pm.method}\\n${pm.accountNumber}\\n${pm.accountName}`)\r\n    .join('\\n');\r\n};\r\n\r\n// Default settings for new businesses\r\nconst getDefaultSettings = (): BusinessSettings => ({\r\n  businessName: '',\r\n  businessAddress: '',\r\n  businessPhone: '',\r\n  businessEmail: '',\r\n  currency: 'UGX',\r\n  paymentInfo: '',\r\n  defaultPrintFormat: 'standard'\r\n});\r\n\r\nexport const useBusinessSettings = () => {\r\n  const [settings, setSettings] = useState<BusinessSettings>(getDefaultSettings());\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const { toast } = useToast();\r\n  const { currentBusiness } = useBusiness();\r\n\r\n  const loadSettings = async (): Promise<BusinessSettings> => {\r\n    if (!currentBusiness) {\r\n      return getDefaultSettings();\r\n    }\r\n\r\n    try {\r\n      const data = await getBusinessSettingsAction(currentBusiness.id);\r\n\r\n      if (data) {\r\n        // Extract payment info from metadata\r\n        const paymentInfo = data.metadata && typeof data.metadata === 'object' ?\r\n          (data.metadata as Record<string, unknown>).payment_info as string || '' : '';\r\n\r\n        return {\r\n          id: data.id,\r\n          businessName: data.business_name,\r\n          businessAddress: data.business_address,\r\n          businessPhone: data.business_phone,\r\n          businessEmail: data.business_email,\r\n          businessLogo: data.business_logo,\r\n          currency: data.currency,\r\n          signature: data.signature,\r\n          paymentInfo: paymentInfo,\r\n          defaultPrintFormat: data.metadata && typeof data.metadata === 'object' ?\r\n            (data.metadata as Record<string, unknown>).default_print_format as 'standard' | 'thermal' || 'standard' : 'standard',\r\n          defaultPrinterName: data.metadata && typeof data.metadata === 'object' ?\r\n            (data.metadata as Record<string, unknown>).default_printer_name as string || '' : '',\r\n          defaultPrinterType: data.metadata && typeof data.metadata === 'object' ?\r\n            (data.metadata as Record<string, unknown>).default_printer_type as 'USB' | 'Bluetooth' || 'USB' : 'USB',\r\n          printerPaperSize: data.metadata && typeof data.metadata === 'object' ?\r\n            (data.metadata as Record<string, unknown>).printer_paper_size as '58mm' | '80mm' || '58mm' : '58mm'\r\n        };\r\n      } else {\r\n        return getDefaultSettings();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading business settings:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to load business settings. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return getDefaultSettings();\r\n    }\r\n  };\r\n\r\n  const updateSettings = async (newSettings: Partial<BusinessSettings>) => {\r\n    if (!currentBusiness) {\r\n      console.error('No business selected for updating settings');\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"No business selected\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const userData = { user: { id: '00000000-0000-0000-0000-000000000000' } }; // Mocked user id for now\r\n\r\n      // Prepare the metadata object with payment info\r\n      const metadata = {\r\n        payment_info: newSettings.hasOwnProperty('paymentInfo') ? newSettings.paymentInfo : settings.paymentInfo || '',\r\n        default_print_format: newSettings.hasOwnProperty('defaultPrintFormat') ? newSettings.defaultPrintFormat : settings.defaultPrintFormat || 'standard',\r\n        default_printer_name: newSettings.hasOwnProperty('defaultPrinterName') ? newSettings.defaultPrinterName : settings.defaultPrinterName || '',\r\n        default_printer_type: newSettings.hasOwnProperty('defaultPrinterType') ? newSettings.defaultPrinterType : settings.defaultPrinterType || 'USB',\r\n        printer_paper_size: newSettings.hasOwnProperty('printerPaperSize') ? newSettings.printerPaperSize : settings.printerPaperSize || '58mm'\r\n      };\r\n\r\n      const updateData = {\r\n        business_name: newSettings.hasOwnProperty('businessName') ? newSettings.businessName : settings.businessName,\r\n        business_address: newSettings.hasOwnProperty('businessAddress') ? newSettings.businessAddress : settings.businessAddress,\r\n        business_phone: newSettings.hasOwnProperty('businessPhone') ? newSettings.businessPhone : settings.businessPhone,\r\n        business_email: newSettings.hasOwnProperty('businessEmail') ? newSettings.businessEmail : settings.businessEmail,\r\n        business_logo: newSettings.hasOwnProperty('businessLogo') ? newSettings.businessLogo : settings.businessLogo,\r\n        currency: newSettings.hasOwnProperty('currency') ? newSettings.currency : settings.currency,\r\n        signature: newSettings.hasOwnProperty('signature') ? newSettings.signature : settings.signature,\r\n        metadata: metadata\r\n      };\r\n\r\n      const response = await upsertBusinessSettingsAction(currentBusiness.id, userData.user.id, updateData);\r\n\r\n      if (!response.success) {\r\n        console.error('Supabase error updating business settings:', response.error);\r\n        throw new Error(response.error);\r\n      }\r\n\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Business settings updated successfully\"\r\n      });\r\n\r\n      // Refetch settings after update\r\n      refetch();\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error updating business settings:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to update business settings. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  // React Query for settings loading with proper caching\r\n  const { data: queriedData, isLoading: isQueryLoading, isFetching, refetch } = useQuery({\r\n    queryKey: ['businessSettings', currentBusiness?.id],\r\n    queryFn: loadSettings,\r\n    enabled: !!currentBusiness?.id,\r\n    staleTime: 5 * 60_000,\r\n    gcTime: 30 * 60_000,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false,\r\n  });\r\n\r\n  // Sync React Query data with local state\r\n  useEffect(() => {\r\n    if (queriedData) {\r\n      setSettings(queriedData);\r\n    } else if (!currentBusiness) {\r\n      setSettings(getDefaultSettings());\r\n    }\r\n  }, [queriedData, currentBusiness]);\r\n\r\n  // Sync loading state from React Query\r\n  useEffect(() => {\r\n    setIsLoading(isQueryLoading || isFetching);\r\n  }, [isQueryLoading, isFetching]);\r\n\r\n  return {\r\n    settings,\r\n    isLoading,\r\n    updateSettings,\r\n    loadSettings\r\n  };\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 243, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/ProductImage.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Image as ImageIcon } from 'lucide-react';\r\n\r\ninterface ProductImageProps {\r\n  imageUrl?: string | null;\r\n  alt: string;\r\n  size?: 'sm' | 'md';\r\n}\r\n\r\nconst ProductImage: React.FC<ProductImageProps> = ({\r\n  imageUrl,\r\n  alt,\r\n  size = 'md'\r\n}) => {\r\n  const dimensions = size === 'sm' ? 'w-10 h-10' : 'w-12 h-12';\r\n  \r\n  if (imageUrl) {\r\n    return (\r\n      <img \r\n        src={imageUrl} \r\n        alt={alt} \r\n        className={`${dimensions} object-cover rounded-md`}\r\n      />\r\n    );\r\n  }\r\n  \r\n  return (\r\n    <div className={`${dimensions} bg-gray-100 flex items-center justify-center rounded-md`}>\r\n      <ImageIcon size={size === 'sm' ? 16 : 18} className=\"text-gray-400\" />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductImage;\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAQA,MAAM,eAA4C,CAAC,EACjD,QAAQ,EACR,GAAG,EACH,OAAO,IAAI,EACZ;IACC,MAAM,aAAa,SAAS,OAAO,cAAc;IAEjD,IAAI,UAAU;QACZ,qBACE,6LAAC;YACC,KAAK;YACL,KAAK;YACL,WAAW,GAAG,WAAW,wBAAwB,CAAC;;;;;;IAGxD;IAEA,qBACE,6LAAC;QAAI,WAAW,GAAG,WAAW,wDAAwD,CAAC;kBACrF,cAAA,6LAAC,gNAAS;YAAC,MAAM,SAAS,OAAO,KAAK;YAAI,WAAU;;;;;;;;;;;AAG1D;KAtBM;uCAwBS"}},
    {"offset": {"line": 291, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/badge.tsx"],"sourcesContent":["\r\nimport * as React from \"react\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst badgeVariants = cva(\r\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\r\n        secondary:\r\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\r\n        destructive:\r\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\r\n        outline: \"text-foreground\",\r\n        warning:\r\n          \"border-transparent bg-amber-500 text-white hover:bg-amber-600\",\r\n        success:\r\n          \"border-transparent bg-green-600 text-white hover:bg-green-700\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nexport interface BadgeProps\r\n  extends React.HTMLAttributes<HTMLDivElement>,\r\n    VariantProps<typeof badgeVariants> {}\r\n\r\nfunction Badge({ className, variant, ...props }: BadgeProps) {\r\n  return (\r\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\r\n  )\r\n}\r\n\r\nexport { Badge, badgeVariants }\r\n"],"names":[],"mappings":";;;;;;;AAEA;AAEA;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB,0KACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SAAS;YACT,SACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAOF,SAAS,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAmB;IACzD,qBACE,6LAAC;QAAI,WAAW,IAAA,4HAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QAAa,GAAG,KAAK;;;;;;AAExE;KAJS"}},
    {"offset": {"line": 341, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/StockStatusBadge.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Product } from '@/types';\r\n\r\ninterface StockStatusBadgeProps {\r\n  product: Product;\r\n}\r\n\r\nconst StockStatusBadge: React.FC<StockStatusBadgeProps> = ({ product }) => {\r\n  if (product.quantity === 0) {\r\n    return <Badge variant=\"destructive\">Out of stock</Badge>;\r\n  }\r\n  \r\n  if (product.quantity <= product.minimumStock) {\r\n    return <Badge variant=\"warning\">Low stock</Badge>;\r\n  }\r\n  \r\n  return <Badge variant=\"success\">In stock</Badge>;\r\n};\r\n\r\nexport default StockStatusBadge;\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAOA,MAAM,mBAAoD,CAAC,EAAE,OAAO,EAAE;IACpE,IAAI,QAAQ,QAAQ,KAAK,GAAG;QAC1B,qBAAO,6LAAC,6IAAK;YAAC,SAAQ;sBAAc;;;;;;IACtC;IAEA,IAAI,QAAQ,QAAQ,IAAI,QAAQ,YAAY,EAAE;QAC5C,qBAAO,6LAAC,6IAAK;YAAC,SAAQ;sBAAU;;;;;;IAClC;IAEA,qBAAO,6LAAC,6IAAK;QAAC,SAAQ;kBAAU;;;;;;AAClC;KAVM;uCAYS"}},
    {"offset": {"line": 390, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/ProductActions.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { MoreHorizontal, Edit, Info } from 'lucide-react';\r\nimport { Product } from '@/types';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuLabel,\r\n  DropdownMenuTrigger,\r\n} from '@/components/ui/dropdown-menu';\r\n\r\ninterface ProductActionsProps {\r\n  product: Product;\r\n  onView: (id: string) => void;\r\n  onEdit: (id: string) => void;\r\n}\r\n\r\nconst ProductActions: React.FC<ProductActionsProps> = ({\r\n  product,\r\n  onView,\r\n  onEdit,\r\n}) => {\r\n  const { hasPermission } = useProfiles();\r\n  return (\r\n    <>\r\n      <DropdownMenu>\r\n        <DropdownMenuTrigger asChild>\r\n          <Button variant=\"ghost\" size=\"icon\">\r\n            <MoreHorizontal className=\"h-4 w-4\" />\r\n            <span className=\"sr-only\">Open menu</span>\r\n          </Button>\r\n        </DropdownMenuTrigger>\r\n        <DropdownMenuContent align=\"end\">\r\n          <DropdownMenuLabel>Actions</DropdownMenuLabel>\r\n          <DropdownMenuItem onClick={() => onView(product.id)}>\r\n            <Info className=\"mr-2 h-4 w-4\" /> View details\r\n          </DropdownMenuItem>\r\n          {hasPermission('inventory', 'edit') && (\r\n            <DropdownMenuItem onClick={() => onEdit(product.id)}>\r\n              <Edit className=\"mr-2 h-4 w-4\" /> Edit\r\n            </DropdownMenuItem>\r\n          )}\r\n        </DropdownMenuContent>\r\n      </DropdownMenu>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ProductActions;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAEA;AACA;;;;;;;AAcA,MAAM,iBAAgD,CAAC,EACrD,OAAO,EACP,MAAM,EACN,MAAM,EACP;;IACC,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,oJAAW;IACrC,qBACE;kBACE,cAAA,6LAAC,+JAAY;;8BACX,6LAAC,sKAAmB;oBAAC,OAAO;8BAC1B,cAAA,6LAAC,+IAAM;wBAAC,SAAQ;wBAAQ,MAAK;;0CAC3B,6LAAC,qOAAc;gCAAC,WAAU;;;;;;0CAC1B,6LAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;8BAG9B,6LAAC,sKAAmB;oBAAC,OAAM;;sCACzB,6LAAC,oKAAiB;sCAAC;;;;;;sCACnB,6LAAC,mKAAgB;4BAAC,SAAS,IAAM,OAAO,QAAQ,EAAE;;8CAChD,6LAAC,6MAAI;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;wBAElC,cAAc,aAAa,yBAC1B,6LAAC,mKAAgB;4BAAC,SAAS,IAAM,OAAO,QAAQ,EAAE;;8CAChD,6LAAC,sNAAI;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;;;;;;;;;;;;;;AAO/C;GA7BM;;QAKsB,oJAAW;;;KALjC;uCA+BS"}},
    {"offset": {"line": 519, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/checkbox.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\r\nimport { Check } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Checkbox = React.forwardRef<\r\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\r\n>(({ className, ...props }, ref) => (\r\n  <CheckboxPrimitive.Root\r\n    ref={ref}\r\n    className={cn(\r\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <CheckboxPrimitive.Indicator\r\n      className={cn(\"flex items-center justify-center text-current\")}\r\n    >\r\n      <Check className=\"h-4 w-4\" />\r\n    </CheckboxPrimitive.Indicator>\r\n  </CheckboxPrimitive.Root>\r\n))\r\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\r\n\r\nexport { Checkbox }\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,+KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,kTACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,oLAA2B;YAC1B,WAAW,IAAA,4HAAE,EAAC;sBAEd,cAAA,6LAAC,gNAAK;gBAAC,WAAU;;;;;;;;;;;;;;;;;AAIvB,SAAS,WAAW,GAAG,+KAAsB,CAAC,WAAW"}},
    {"offset": {"line": 569, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/hooks/useFinancialVisibility.ts"],"sourcesContent":["import { useProfiles } from '@/contexts/ProfileContext';\r\n\r\n/**\r\n * Hook to handle financial data visibility based on permissions\r\n */\r\nexport const useFinancialVisibility = () => {\r\n    const { hasPermission } = useProfiles();\r\n\r\n    const canViewCostPrice = hasPermission('inventory', 'view_cost_price');\r\n    const canViewProfit = hasPermission('inventory', 'view_profit');\r\n    const canViewSellingPrice = hasPermission('inventory', 'view_selling_price');\r\n\r\n    // Dashboard-specific permissions\r\n    const canViewTotalSales = hasPermission('dashboard', 'view_total_sales');\r\n    const canViewTotalGrossProfit = hasPermission('dashboard', 'view_gross_profit');\r\n    const canViewTotalExpenses = hasPermission('dashboard', 'view_total_expenses');\r\n    const canViewInventoryValue = hasPermission('dashboard', 'view_inventory_value');\r\n    const canViewSalesTypes = hasPermission('dashboard', 'view_sales_types');\r\n    const canViewAvgPrice = hasPermission('dashboard', 'view_avg_price');\r\n    const canViewTotalAmount = hasPermission('dashboard', 'view_total_amount');\r\n\r\n    // Finance and Expenses permissions\r\n    const canManageFinanceAccounts = hasPermission('finance', 'manage_accounts');\r\n    const canViewFinance = hasPermission('finance', 'view');\r\n    const canViewExpenses = hasPermission('expenses', 'view');\r\n    const canCreateExpenses = hasPermission('expenses', 'create');\r\n    const canEditExpenses = hasPermission('expenses', 'edit');\r\n    const canDeleteExpenses = hasPermission('expenses', 'delete');\r\n\r\n    /**\r\n     * Format a financial value or return a hidden indicator\r\n     */\r\n    const formatFinancial = (value: number | null | undefined, type: 'cost' | 'selling' | 'profit'): string => {\r\n        const hasAccess =\r\n            (type === 'cost' && canViewCostPrice) ||\r\n            (type === 'selling' && canViewSellingPrice) ||\r\n            (type === 'profit' && canViewProfit);\r\n\r\n        if (!hasAccess) {\r\n            return '•••';\r\n        }\r\n\r\n        return value?.toLocaleString() || '0';\r\n    };\r\n\r\n    return {\r\n        canViewCostPrice,\r\n        canViewProfit,\r\n        canViewSellingPrice,\r\n        canViewTotalSales,\r\n        canViewTotalGrossProfit,\r\n        canViewTotalExpenses,\r\n        canViewInventoryValue,\r\n        canViewSalesTypes,\r\n        canViewAvgPrice,\r\n        canViewTotalAmount,\r\n        canManageFinanceAccounts,\r\n        canViewFinance,\r\n        canViewExpenses,\r\n        canCreateExpenses,\r\n        canEditExpenses,\r\n        canDeleteExpenses,\r\n        formatFinancial,\r\n    };\r\n};\r\n"],"names":[],"mappings":";;;;AAAA;;;AAKO,MAAM,yBAAyB;;IAClC,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,oJAAW;IAErC,MAAM,mBAAmB,cAAc,aAAa;IACpD,MAAM,gBAAgB,cAAc,aAAa;IACjD,MAAM,sBAAsB,cAAc,aAAa;IAEvD,iCAAiC;IACjC,MAAM,oBAAoB,cAAc,aAAa;IACrD,MAAM,0BAA0B,cAAc,aAAa;IAC3D,MAAM,uBAAuB,cAAc,aAAa;IACxD,MAAM,wBAAwB,cAAc,aAAa;IACzD,MAAM,oBAAoB,cAAc,aAAa;IACrD,MAAM,kBAAkB,cAAc,aAAa;IACnD,MAAM,qBAAqB,cAAc,aAAa;IAEtD,mCAAmC;IACnC,MAAM,2BAA2B,cAAc,WAAW;IAC1D,MAAM,iBAAiB,cAAc,WAAW;IAChD,MAAM,kBAAkB,cAAc,YAAY;IAClD,MAAM,oBAAoB,cAAc,YAAY;IACpD,MAAM,kBAAkB,cAAc,YAAY;IAClD,MAAM,oBAAoB,cAAc,YAAY;IAEpD;;KAEC,GACD,MAAM,kBAAkB,CAAC,OAAkC;QACvD,MAAM,YACF,AAAC,SAAS,UAAU,oBACnB,SAAS,aAAa,uBACtB,SAAS,YAAY;QAE1B,IAAI,CAAC,WAAW;YACZ,OAAO;QACX;QAEA,OAAO,OAAO,oBAAoB;IACtC;IAEA,OAAO;QACH;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;IACJ;AACJ;GA3Da;;QACiB,oJAAW"}},
    {"offset": {"line": 638, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/MobileProductCard.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Product } from '@/types';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport ProductImage from './ProductImage';\r\nimport StockStatusBadge from './StockStatusBadge';\r\nimport ProductActions from './ProductActions';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\ninterface MobileProductCardProps {\r\n  product: Product;\r\n  onView: (id: string) => void;\r\n  onEdit: (id: string) => void;\r\n  showAllFields?: boolean;\r\n  enableBulkActions?: boolean;\r\n  isSelected?: boolean;\r\n  onToggleSelection?: (productId: string) => void;\r\n}\r\n\r\nconst MobileProductCard: React.FC<MobileProductCardProps> = ({\r\n  product,\r\n  onView,\r\n  onEdit,\r\n  showAllFields = true,\r\n  enableBulkActions = false,\r\n  isSelected = false,\r\n  onToggleSelection\r\n}) => {\r\n  const { settings } = useBusinessSettings();\r\n  const { formatFinancial, canViewCostPrice, canViewSellingPrice, canViewProfit } = useFinancialVisibility();\r\n\r\n  // Calculate total cost\r\n  const totalCost = product.quantity * product.costPrice;\r\n\r\n  return (\r\n    <TooltipProvider>\r\n      <div\r\n        className=\"py-4 px-4 hover:bg-gray-50 border-b last:border-b-0 rounded-md\"\r\n        onClick={() => onView(product.id)}\r\n      >\r\n        <div className=\"flex justify-between items-start mb-3\">\r\n          <div className=\"flex items-center gap-3\">\r\n            {enableBulkActions && (\r\n              <div onClick={(e) => e.stopPropagation()}>\r\n                <Checkbox\r\n                  checked={isSelected}\r\n                  onCheckedChange={() => onToggleSelection?.(product.id)}\r\n                  aria-label={`Select ${product.name}`}\r\n                />\r\n              </div>\r\n            )}\r\n            <ProductImage imageUrl={product.imageUrl} alt={product.name} />\r\n            <div>\r\n              <Tooltip>\r\n                <TooltipTrigger asChild>\r\n                  <h3 className=\"font-medium text-sales-dark cursor-help max-w-[150px] truncate\">{product.name}</h3>\r\n                </TooltipTrigger>\r\n                <TooltipContent side=\"top\" className=\"max-w-xs\">\r\n                  <div className=\"space-y-1\">\r\n                    <p className=\"font-bold break-words whitespace-normal\">{product.name}</p>\r\n                    {product.description && (\r\n                      <p className=\"text-xs text-muted-foreground whitespace-pre-wrap\">{product.description}</p>\r\n                    )}\r\n                  </div>\r\n                </TooltipContent>\r\n              </Tooltip>\r\n              <p className=\"text-sm text-muted-foreground\">#{product.itemNumber}</p>\r\n            </div>\r\n          </div>\r\n          <div onClick={(e) => e.stopPropagation()}>\r\n            <ProductActions\r\n              product={product}\r\n              onView={onView}\r\n              onEdit={onEdit}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className={`grid grid-cols-2 gap-y-2.5 text-sm ${enableBulkActions ? 'ml-20' : 'ml-14'}`}>\r\n          {product.category && (\r\n            <>\r\n              <div className=\"text-muted-foreground font-medium\">Category:</div>\r\n              <div className=\"font-normal\">{product.category}</div>\r\n            </>\r\n          )}\r\n\r\n          <div className=\"text-muted-foreground font-medium\">Quantity:</div>\r\n          <div className=\"font-medium\">{product.quantity % 1 === 0 ? product.quantity : product.quantity.toFixed(2)}</div>\r\n\r\n          <div className=\"text-muted-foreground font-medium\">Status:</div>\r\n          <div><StockStatusBadge product={product} /></div>\r\n\r\n          {product.costPrice !== undefined && product.costPrice !== null && (\r\n            <>\r\n              <div className=\"text-muted-foreground font-medium\">Cost Price:</div>\r\n              <div className=\"font-medium tabular-nums\">\r\n                {canViewCostPrice ? `${settings.currency} ${formatFinancial(product.costPrice, 'cost')}` : '•••'}\r\n              </div>\r\n\r\n              <div className=\"text-muted-foreground font-medium\">Total Cost:</div>\r\n              <div className=\"font-medium tabular-nums\">\r\n                {canViewCostPrice ? `${settings.currency} ${formatNumber(totalCost)}` : '•••'}\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          {showAllFields && product.sellingPrice !== undefined && product.sellingPrice !== null && (\r\n            <>\r\n              <div className=\"text-muted-foreground font-medium\">Selling Price:</div>\r\n              <div className=\"font-medium tabular-nums\">\r\n                {canViewSellingPrice ? `${settings.currency} ${formatFinancial(product.sellingPrice, 'selling')}` : '•••'}\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </TooltipProvider>\r\n  );\r\n};\r\n\r\nexport default MobileProductCard;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 956, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/table.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Table = React.forwardRef<\r\n  HTMLTableElement,\r\n  React.HTMLAttributes<HTMLTableElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div className=\"relative w-full overflow-auto\">\r\n    <table\r\n      ref={ref}\r\n      className={cn(\"w-full caption-bottom text-sm\", className)}\r\n      {...props}\r\n    />\r\n  </div>\r\n))\r\nTable.displayName = \"Table\"\r\n\r\nconst TableHeader = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\r\n))\r\nTableHeader.displayName = \"TableHeader\"\r\n\r\nconst TableBody = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tbody\r\n    ref={ref}\r\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\r\n    {...props}\r\n  />\r\n))\r\nTableBody.displayName = \"TableBody\"\r\n\r\nconst TableFooter = React.forwardRef<\r\n  HTMLTableSectionElement,\r\n  React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tfoot\r\n    ref={ref}\r\n    className={cn(\r\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableFooter.displayName = \"TableFooter\"\r\n\r\nconst TableRow = React.forwardRef<\r\n  HTMLTableRowElement,\r\n  React.HTMLAttributes<HTMLTableRowElement>\r\n>(({ className, ...props }, ref) => (\r\n  <tr\r\n    ref={ref}\r\n    className={cn(\r\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableRow.displayName = \"TableRow\"\r\n\r\nconst TableHead = React.forwardRef<\r\n  HTMLTableCellElement,\r\n  React.ThHTMLAttributes<HTMLTableCellElement>\r\n>(({ className, ...props }, ref) => (\r\n  <th\r\n    ref={ref}\r\n    className={cn(\r\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTableHead.displayName = \"TableHead\"\r\n\r\nconst TableCell = React.forwardRef<\r\n  HTMLTableCellElement,\r\n  React.TdHTMLAttributes<HTMLTableCellElement>\r\n>(({ className, ...props }, ref) => (\r\n  <td\r\n    ref={ref}\r\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\r\n    {...props}\r\n  />\r\n))\r\nTableCell.displayName = \"TableCell\"\r\n\r\nconst TableCaption = React.forwardRef<\r\n  HTMLTableCaptionElement,\r\n  React.HTMLAttributes<HTMLTableCaptionElement>\r\n>(({ className, ...props }, ref) => (\r\n  <caption\r\n    ref={ref}\r\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n))\r\nTableCaption.displayName = \"TableCaption\"\r\n\r\nexport {\r\n  Table,\r\n  TableHeader,\r\n  TableBody,\r\n  TableFooter,\r\n  TableHead,\r\n  TableRow,\r\n  TableCell,\r\n  TableCaption,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,2KAAgB,MAG5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YACC,KAAK;YACL,WAAW,IAAA,4HAAE,EAAC,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;;AAIf,MAAM,WAAW,GAAG;AAEpB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAM,KAAK;QAAK,WAAW,IAAA,4HAAE,EAAC,mBAAmB;QAAa,GAAG,KAAK;;;;;;;AAEzE,YAAY,WAAW,GAAG;AAE1B,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,2DACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,yBAAW,2KAAgB,OAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,+EACA;QAED,GAAG,KAAK;;;;;;;AAGb,SAAS,WAAW,GAAG;AAEvB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,oGACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,kDAAkD;QAC/D,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,6BAAe,2KAAgB,QAGnC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;;AAGb,aAAa,WAAW,GAAG"}},
    {"offset": {"line": 1100, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/TableSortHeader.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { TableHead } from '@/components/ui/table';\r\nimport { ChevronUp, ChevronDown } from 'lucide-react';\r\nimport { SortField } from './InventoryTable'; // Import SortField from InventoryTable\r\n\r\ninterface TableSortHeaderProps {\r\n  field: SortField;\r\n  currentSortField: SortField;\r\n  sortOrder: 'asc' | 'desc';\r\n  onSort: (field: SortField) => void;\r\n  children: React.ReactNode;\r\n  className?: string;\r\n}\r\n\r\nconst TableSortHeader: React.FC<TableSortHeaderProps> = ({\r\n  field,\r\n  currentSortField,\r\n  sortOrder,\r\n  onSort,\r\n  children,\r\n  className\r\n}) => {\r\n  return (\r\n    <TableHead \r\n      className={`cursor-pointer hover:bg-muted/80 ${className || ''}`} \r\n      onClick={() => onSort(field)}\r\n    >\r\n      <div className=\"flex items-center justify-between\">\r\n        {children}\r\n        {currentSortField === field && (\r\n          <div className=\"ml-1\">\r\n            {sortOrder === 'asc' ? (\r\n              <ChevronUp className=\"h-4 w-4\" />\r\n            ) : (\r\n              <ChevronDown className=\"h-4 w-4\" />\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </TableHead>\r\n  );\r\n};\r\n\r\nexport default TableSortHeader;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;;;;AAYA,MAAM,kBAAkD,CAAC,EACvD,KAAK,EACL,gBAAgB,EAChB,SAAS,EACT,MAAM,EACN,QAAQ,EACR,SAAS,EACV;IACC,qBACE,6LAAC,iJAAS;QACR,WAAW,CAAC,iCAAiC,EAAE,aAAa,IAAI;QAChE,SAAS,IAAM,OAAO;kBAEtB,cAAA,6LAAC;YAAI,WAAU;;gBACZ;gBACA,qBAAqB,uBACpB,6LAAC;oBAAI,WAAU;8BACZ,cAAc,sBACb,6LAAC,gOAAS;wBAAC,WAAU;;;;;iFAErB,6LAAC,sOAAW;wBAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;AAOrC;KA3BM;uCA6BS"}},
    {"offset": {"line": 1162, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/InlineEditableCell.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Check, X, Edit } from 'lucide-react';\r\nimport { formatNumber } from '@/lib/utils';\r\n\r\ninterface InlineEditableCellProps {\r\n  value: string | number;\r\n  type: 'text' | 'number' | 'select';\r\n  options?: string[];\r\n  currency?: string;\r\n  onSave: (newValue: string | number) => Promise<boolean>;\r\n  className?: string;\r\n  displayFormatter?: (value: string | number) => string;\r\n}\r\n\r\nconst InlineEditableCell: React.FC<InlineEditableCellProps> = ({\r\n  value,\r\n  type,\r\n  options = [],\r\n  currency,\r\n  onSave,\r\n  className = '',\r\n  displayFormatter\r\n}) => {\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [editValue, setEditValue] = useState(value.toString());\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  const handleEdit = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setIsEditing(true);\r\n    setEditValue(value.toString());\r\n  };\r\n\r\n  const handleCancel = (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setIsEditing(false);\r\n    setEditValue(value.toString());\r\n  };\r\n\r\n  const handleSave = async (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setIsSaving(true);\r\n    \r\n    try {\r\n      const newValue = type === 'number' ? parseFloat(editValue) || 0 : editValue;\r\n      const success = await onSave(newValue);\r\n      \r\n      if (success) {\r\n        setIsEditing(false);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error saving:', error);\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    e.stopPropagation();\r\n    if (e.key === 'Enter') {\r\n      handleSave(e as any);\r\n    } else if (e.key === 'Escape') {\r\n      handleCancel(e as any);\r\n    }\r\n  };\r\n\r\n  const getDisplayValue = () => {\r\n    if (displayFormatter) {\r\n      return displayFormatter(value);\r\n    }\r\n    \r\n    if (type === 'number' && currency) {\r\n      return `${currency} ${formatNumber(value as number)}`;\r\n    }\r\n    \r\n    return value.toString();\r\n  };\r\n\r\n  if (!isEditing) {\r\n    return (\r\n      <div \r\n        className={`group cursor-pointer flex items-center gap-2 ${className}`}\r\n        onClick={handleEdit}\r\n      >\r\n        <span className=\"flex-1\">{getDisplayValue()}</span>\r\n        <Edit className=\"h-3 w-3 opacity-0 group-hover:opacity-50 transition-opacity\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-1\" onClick={(e) => e.stopPropagation()}>\r\n      {type === 'select' ? (\r\n        <Select value={editValue} onValueChange={setEditValue}>\r\n          <SelectTrigger className=\"h-8 text-xs\">\r\n            <SelectValue />\r\n          </SelectTrigger>\r\n          <SelectContent>\r\n            {options.map((option) => (\r\n              <SelectItem key={option} value={option}>\r\n                {option}\r\n              </SelectItem>\r\n            ))}\r\n          </SelectContent>\r\n        </Select>\r\n      ) : (\r\n        <Input\r\n          type={type}\r\n          value={editValue}\r\n          onChange={(e) => setEditValue(e.target.value)}\r\n          onKeyDown={handleKeyDown}\r\n          className=\"h-8 text-xs\"\r\n          autoFocus\r\n          step={type === 'number' ? '0.01' : undefined}\r\n        />\r\n      )}\r\n      <Button\r\n        size=\"icon\"\r\n        variant=\"ghost\"\r\n        className=\"h-6 w-6\"\r\n        onClick={handleSave}\r\n        disabled={isSaving}\r\n      >\r\n        <Check className=\"h-3 w-3\" />\r\n      </Button>\r\n      <Button\r\n        size=\"icon\"\r\n        variant=\"ghost\"\r\n        className=\"h-6 w-6\"\r\n        onClick={handleCancel}\r\n        disabled={isSaving}\r\n      >\r\n        <X className=\"h-3 w-3\" />\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InlineEditableCell;"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;;;;;;;;;AAYA,MAAM,qBAAwD,CAAC,EAC7D,KAAK,EACL,IAAI,EACJ,UAAU,EAAE,EACZ,QAAQ,EACR,MAAM,EACN,YAAY,EAAE,EACd,gBAAgB,EACjB;;IACC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC,MAAM,QAAQ;IACzD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IAEzC,MAAM,aAAa,CAAC;QAClB,EAAE,eAAe;QACjB,aAAa;QACb,aAAa,MAAM,QAAQ;IAC7B;IAEA,MAAM,eAAe,CAAC;QACpB,EAAE,eAAe;QACjB,aAAa;QACb,aAAa,MAAM,QAAQ;IAC7B;IAEA,MAAM,aAAa,OAAO;QACxB,EAAE,eAAe;QACjB,YAAY;QAEZ,IAAI;YACF,MAAM,WAAW,SAAS,WAAW,WAAW,cAAc,IAAI;YAClE,MAAM,UAAU,MAAM,OAAO;YAE7B,IAAI,SAAS;gBACX,aAAa;YACf;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,iBAAiB;QACjC,SAAU;YACR,YAAY;QACd;IACF;IAEA,MAAM,gBAAgB,CAAC;QACrB,EAAE,eAAe;QACjB,IAAI,EAAE,GAAG,KAAK,SAAS;YACrB,WAAW;QACb,OAAO,IAAI,EAAE,GAAG,KAAK,UAAU;YAC7B,aAAa;QACf;IACF;IAEA,MAAM,kBAAkB;QACtB,IAAI,kBAAkB;YACpB,OAAO,iBAAiB;QAC1B;QAEA,IAAI,SAAS,YAAY,UAAU;YACjC,OAAO,GAAG,SAAS,CAAC,EAAE,IAAA,sIAAY,EAAC,QAAkB;QACvD;QAEA,OAAO,MAAM,QAAQ;IACvB;IAEA,IAAI,CAAC,WAAW;QACd,qBACE,6LAAC;YACC,WAAW,CAAC,6CAA6C,EAAE,WAAW;YACtE,SAAS;;8BAET,6LAAC;oBAAK,WAAU;8BAAU;;;;;;8BAC1B,6LAAC,sNAAI;oBAAC,WAAU;;;;;;;;;;;;IAGtB;IAEA,qBACE,6LAAC;QAAI,WAAU;QAA0B,SAAS,CAAC,IAAM,EAAE,eAAe;;YACvE,SAAS,yBACR,6LAAC,+IAAM;gBAAC,OAAO;gBAAW,eAAe;;kCACvC,6LAAC,sJAAa;wBAAC,WAAU;kCACvB,cAAA,6LAAC,oJAAW;;;;;;;;;;kCAEd,6LAAC,sJAAa;kCACX,QAAQ,GAAG,CAAC,CAAC,uBACZ,6LAAC,mJAAU;gCAAc,OAAO;0CAC7B;+BADc;;;;;;;;;;;;;;;yEAOvB,6LAAC,6IAAK;gBACJ,MAAM;gBACN,OAAO;gBACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;gBAC5C,WAAW;gBACX,WAAU;gBACV,SAAS;gBACT,MAAM,SAAS,WAAW,SAAS;;;;;;0BAGvC,6LAAC,+IAAM;gBACL,MAAK;gBACL,SAAQ;gBACR,WAAU;gBACV,SAAS;gBACT,UAAU;0BAEV,cAAA,6LAAC,gNAAK;oBAAC,WAAU;;;;;;;;;;;0BAEnB,6LAAC,+IAAM;gBACL,MAAK;gBACL,SAAQ;gBACR,WAAU;gBACV,SAAS;gBACT,UAAU;0BAEV,cAAA,6LAAC,oMAAC;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAIrB;GA1HM;KAAA;uCA4HS"}},
    {"offset": {"line": 1364, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/DesktopProductTable.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport { Product } from '@/types';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport TableSortHeader from './TableSortHeader';\r\nimport StockStatusBadge from './StockStatusBadge';\r\nimport ProductActions from './ProductActions';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\nimport ProductImage from './ProductImage';\r\nimport { SortField } from './InventoryTable';\r\nimport { format } from 'date-fns';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport InlineEditableCell from './InlineEditableCell';\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\ntype SortOrder = 'asc' | 'desc';\r\n\r\ninterface DesktopProductTableProps {\r\n  products: Product[];\r\n  sortField: SortField;\r\n  sortOrder: SortOrder;\r\n  handleSort: (field: SortField) => void;\r\n  onView: (id: string) => void;\r\n  onEdit: (id: string) => void;\r\n  showAllFields?: boolean;\r\n  enableBulkActions?: boolean;\r\n  selectedProductIds?: Set<string>;\r\n  onToggleProductSelection?: (productId: string) => void;\r\n  onToggleAllProducts?: (productIds: string[]) => void;\r\n  onUpdateProduct?: (id: string, updates: Partial<Product>) => Promise<boolean>;\r\n  categories?: string[];\r\n}\r\n\r\nconst DesktopProductTable: React.FC<DesktopProductTableProps> = ({\r\n  products,\r\n  sortField,\r\n  sortOrder,\r\n  handleSort,\r\n  onView,\r\n  onEdit,\r\n  showAllFields = true,\r\n  enableBulkActions = false,\r\n  selectedProductIds = new Set(),\r\n  onToggleProductSelection,\r\n  onToggleAllProducts,\r\n  onUpdateProduct,\r\n  categories = []\r\n}) => {\r\n  const { settings } = useBusinessSettings();\r\n  const { hasPermission } = useProfiles();\r\n  const { canViewCostPrice, canViewSellingPrice, formatFinancial } = useFinancialVisibility();\r\n  const canEdit = hasPermission('inventory', 'edit');\r\n\r\n  // Calculate total cost for a product\r\n  const calculateTotalCost = (product: Product) => {\r\n    return product.quantity * product.costPrice;\r\n  };\r\n\r\n  const productIds = products.map(p => p.id);\r\n  const allSelected = productIds.length > 0 && productIds.every(id => selectedProductIds.has(id));\r\n\r\n  // Simplified version (less columns) - used for top selling products and Products page\r\n  if (!showAllFields) {\r\n    return (\r\n      <div className=\"overflow-hidden rounded-md border\">\r\n        <TooltipProvider>\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow className=\"bg-muted/50\">\r\n                {enableBulkActions && (\r\n                  <TableHead className=\"w-[50px]\">\r\n                    <Checkbox\r\n                      checked={allSelected}\r\n                      onCheckedChange={() => onToggleAllProducts?.(productIds)}\r\n                      aria-label=\"Select all products\"\r\n                    />\r\n                  </TableHead>\r\n                )}\r\n                <TableHead className=\"w-[80px]\">Image</TableHead>\r\n                <TableSortHeader\r\n                  field=\"itemNumber\"\r\n                  currentSortField={sortField}\r\n                  sortOrder={sortOrder}\r\n                  onSort={handleSort}\r\n                  className=\"w-[100px]\"\r\n                >\r\n                  Item #\r\n                </TableSortHeader>\r\n                <TableSortHeader\r\n                  field=\"name\"\r\n                  currentSortField={sortField}\r\n                  sortOrder={sortOrder}\r\n                  onSort={handleSort}\r\n                  className=\"w-[160px]\"\r\n                >\r\n                  Product Name\r\n                </TableSortHeader>\r\n                <TableSortHeader\r\n                  field=\"category\"\r\n                  currentSortField={sortField}\r\n                  sortOrder={sortOrder}\r\n                  onSort={handleSort}\r\n                  className=\"w-[120px]\"\r\n                >\r\n                  Category\r\n                </TableSortHeader>\r\n                <TableSortHeader\r\n                  field=\"quantity\"\r\n                  currentSortField={sortField}\r\n                  sortOrder={sortOrder}\r\n                  onSort={handleSort}\r\n                  className=\"w-[80px] text-right\"\r\n                >\r\n                  Quantity\r\n                </TableSortHeader>\r\n                <TableHead className=\"w-[80px]\">Status</TableHead>\r\n                {canViewCostPrice && (\r\n                  <TableSortHeader\r\n                    field=\"costPrice\"\r\n                    currentSortField={sortField}\r\n                    sortOrder={sortOrder}\r\n                    onSort={handleSort}\r\n                    className=\"w-[100px] text-right\"\r\n                  >\r\n                    Cost Price\r\n                  </TableSortHeader>\r\n                )}\r\n                {canViewSellingPrice && (\r\n                  <TableSortHeader\r\n                    field=\"sellingPrice\"\r\n                    currentSortField={sortField}\r\n                    sortOrder={sortOrder}\r\n                    onSort={handleSort}\r\n                    className=\"w-[100px] text-right\"\r\n                  >\r\n                    Selling Price\r\n                  </TableSortHeader>\r\n                )}\r\n                <TableHead className=\"w-[100px] text-center\">Created Date</TableHead>\r\n                <TableHead className=\"w-[80px] text-right\">Actions</TableHead>\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {products.map((product) => (\r\n                <TableRow\r\n                  key={product.id}\r\n                  className=\"hover:bg-gray-50 cursor-pointer\"\r\n                  onClick={() => onView(product.id)}\r\n                >\r\n                  {enableBulkActions && (\r\n                    <TableCell onClick={(e) => e.stopPropagation()}>\r\n                      <Checkbox\r\n                        checked={selectedProductIds.has(product.id)}\r\n                        onCheckedChange={() => onToggleProductSelection?.(product.id)}\r\n                        aria-label={`Select ${product.name}`}\r\n                      />\r\n                    </TableCell>\r\n                  )}\r\n                  <TableCell>\r\n                    <ProductImage imageUrl={product.imageUrl} alt={product.name} size=\"sm\" />\r\n                  </TableCell>\r\n                  <TableCell className=\"font-mono text-sm max-w-[100px] truncate\">\r\n                    <Tooltip>\r\n                      <TooltipTrigger asChild>\r\n                        <span className=\"cursor-help\">{product.itemNumber}</span>\r\n                      </TooltipTrigger>\r\n                      <TooltipContent>\r\n                        <p className=\"font-mono\">{product.itemNumber}</p>\r\n                      </TooltipContent>\r\n                    </Tooltip>\r\n                  </TableCell>\r\n                  <TableCell className=\"font-medium max-w-[160px] truncate\">\r\n                    <Tooltip>\r\n                      <TooltipTrigger asChild>\r\n                        <span className=\"cursor-help\">{product.name}</span>\r\n                      </TooltipTrigger>\r\n                      <TooltipContent className=\"max-w-xs\">\r\n                        <div className=\"space-y-1\">\r\n                          <p className=\"font-bold break-words whitespace-normal\">{product.name}</p>\r\n                          {product.description && (\r\n                            <p className=\"text-xs text-muted-foreground whitespace-pre-wrap\">{product.description}</p>\r\n                          )}\r\n                        </div>\r\n                      </TooltipContent>\r\n                    </Tooltip>\r\n                  </TableCell>\r\n                  <TableCell className=\"max-w-[120px]\" onClick={(e) => e.stopPropagation()}>\r\n                    {onUpdateProduct && canEdit ? (\r\n                      <InlineEditableCell\r\n                        value={product.category}\r\n                        type=\"select\"\r\n                        options={categories}\r\n                        onSave={(newValue) => onUpdateProduct(product.id, { category: newValue as string })}\r\n                      />\r\n                    ) : (\r\n                      <span className=\"truncate\">{product.category}</span>\r\n                    )}\r\n                  </TableCell>\r\n                  <TableCell className=\"text-right font-medium\">{product.quantity % 1 === 0 ? product.quantity : product.quantity.toFixed(2)}</TableCell>\r\n                  <TableCell><StockStatusBadge product={product} /></TableCell>\r\n                  <TableCell><StockStatusBadge product={product} /></TableCell>\r\n                  {canViewCostPrice && (\r\n                    <TableCell className=\"text-right font-medium tabular-nums\" onClick={(e) => e.stopPropagation()}>\r\n                      {onUpdateProduct && canEdit ? (\r\n                        <InlineEditableCell\r\n                          value={product.costPrice}\r\n                          type=\"number\"\r\n                          currency={settings.currency}\r\n                          onSave={(newValue) => onUpdateProduct(product.id, { costPrice: newValue as number })}\r\n                          className=\"text-right\"\r\n                        />\r\n                      ) : (\r\n                        <span>{settings.currency} {formatFinancial(product.costPrice, 'cost')}</span>\r\n                      )}\r\n                    </TableCell>\r\n                  )}\r\n                  {canViewSellingPrice && (\r\n                    <TableCell className=\"text-right font-medium tabular-nums\" onClick={(e) => e.stopPropagation()}>\r\n                      {onUpdateProduct && canEdit ? (\r\n                        <InlineEditableCell\r\n                          value={product.sellingPrice}\r\n                          type=\"number\"\r\n                          currency={settings.currency}\r\n                          onSave={(newValue) => onUpdateProduct(product.id, { sellingPrice: newValue as number })}\r\n                          className=\"text-right\"\r\n                        />\r\n                      ) : (\r\n                        <span>{settings.currency} {formatFinancial(product.sellingPrice, 'selling')}</span>\r\n\r\n                      )}\r\n                    </TableCell>\r\n                  )}\r\n                  <TableCell className=\"text-center text-sm text-muted-foreground\">\r\n                    {format(product.createdAt, 'MMM dd, yyyy')}\r\n                  </TableCell>\r\n                  <TableCell className=\"text-right\" onClick={(e) => e.stopPropagation()}>\r\n                    <ProductActions\r\n                      product={product}\r\n                      onView={onView}\r\n                      onEdit={onEdit}\r\n                    />\r\n                  </TableCell>\r\n                </TableRow>\r\n              ))}\r\n            </TableBody>\r\n          </Table>\r\n        </TooltipProvider>\r\n      </div >\r\n    );\r\n  }\r\n\r\n  // Full view (more columns) - now includes Created Date and Item Number\r\n  return (\r\n    <div className=\"overflow-hidden rounded-md border\">\r\n      <TooltipProvider>\r\n        <Table>\r\n          <TableHeader>\r\n            <TableRow className=\"bg-muted/50\">\r\n              {enableBulkActions && (\r\n                <TableHead className=\"w-[50px]\">\r\n                  <Checkbox\r\n                    checked={allSelected}\r\n                    onCheckedChange={() => onToggleAllProducts?.(productIds)}\r\n                    aria-label=\"Select all products\"\r\n                  />\r\n                </TableHead>\r\n              )}\r\n              <TableHead className=\"w-[80px]\">Image</TableHead>\r\n              <TableSortHeader\r\n                field=\"itemNumber\"\r\n                currentSortField={sortField}\r\n                sortOrder={sortOrder}\r\n                onSort={handleSort}\r\n                className=\"w-[100px]\"\r\n              >\r\n                Item #\r\n              </TableSortHeader>\r\n              <TableSortHeader\r\n                field=\"name\"\r\n                currentSortField={sortField}\r\n                sortOrder={sortOrder}\r\n                onSort={handleSort}\r\n                className=\"w-[180px]\"\r\n              >\r\n                Product Name\r\n              </TableSortHeader>\r\n              <TableSortHeader\r\n                field=\"category\"\r\n                currentSortField={sortField}\r\n                sortOrder={sortOrder}\r\n                onSort={handleSort}\r\n                className=\"w-[120px]\"\r\n              >\r\n                Category\r\n              </TableSortHeader>\r\n              <TableSortHeader\r\n                field=\"quantity\"\r\n                currentSortField={sortField}\r\n                sortOrder={sortOrder}\r\n                onSort={handleSort}\r\n                className=\"w-[80px] text-right\"\r\n              >\r\n                Quantity\r\n              </TableSortHeader>\r\n              <TableHead className=\"w-[80px]\">Status</TableHead>\r\n              {canViewCostPrice && (\r\n                <>\r\n                  <TableSortHeader\r\n                    field=\"costPrice\"\r\n                    currentSortField={sortField}\r\n                    sortOrder={sortOrder}\r\n                    onSort={handleSort}\r\n                    className=\"w-[100px] text-right\"\r\n                  >\r\n                    Cost Price\r\n                  </TableSortHeader>\r\n                  <TableHead className=\"w-[100px] text-right\">Total Cost</TableHead>\r\n                </>\r\n              )}\r\n              {canViewSellingPrice && (\r\n                <TableSortHeader\r\n                  field=\"sellingPrice\"\r\n                  currentSortField={sortField}\r\n                  sortOrder={sortOrder}\r\n                  onSort={handleSort}\r\n                  className=\"w-[100px] text-right\"\r\n                >\r\n                  Selling Price\r\n                </TableSortHeader>\r\n              )}\r\n              <TableHead className=\"w-[100px] text-center\">Created Date</TableHead>\r\n              <TableHead className=\"w-[80px] text-right\">Actions</TableHead>\r\n            </TableRow>\r\n          </TableHeader>\r\n          <TableBody>\r\n            {products.map((product) => (\r\n              <TableRow\r\n                key={product.id}\r\n                className=\"hover:bg-gray-50 cursor-pointer\"\r\n                onClick={() => onView(product.id)}\r\n              >\r\n                {enableBulkActions && (\r\n                  <TableCell onClick={(e) => e.stopPropagation()}>\r\n                    <Checkbox\r\n                      checked={selectedProductIds.has(product.id)}\r\n                      onCheckedChange={() => onToggleProductSelection?.(product.id)}\r\n                      aria-label={`Select ${product.name}`}\r\n                    />\r\n                  </TableCell>\r\n                )}\r\n                <TableCell>\r\n                  <ProductImage imageUrl={product.imageUrl} alt={product.name} size=\"sm\" />\r\n                </TableCell>\r\n                <TableCell className=\"font-mono text-sm max-w-[100px] truncate\">\r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <span className=\"cursor-help\">{product.itemNumber}</span>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p className=\"font-mono\">{product.itemNumber}</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                </TableCell>\r\n                <TableCell className=\"font-medium max-w-[180px] truncate\">\r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <span className=\"cursor-help\">{product.name}</span>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent className=\"max-w-xs\">\r\n                      <div className=\"space-y-1\">\r\n                        <p className=\"font-bold break-words whitespace-normal\">{product.name}</p>\r\n                        {product.description && (\r\n                          <p className=\"text-xs text-muted-foreground whitespace-pre-wrap\">{product.description}</p>\r\n                        )}\r\n                      </div>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                </TableCell>\r\n                <TableCell className=\"max-w-[120px]\" onClick={(e) => e.stopPropagation()}>\r\n                  {onUpdateProduct && canEdit ? (\r\n                    <InlineEditableCell\r\n                      value={product.category}\r\n                      type=\"select\"\r\n                      options={categories}\r\n                      onSave={(newValue) => onUpdateProduct(product.id, { category: newValue as string })}\r\n                    />\r\n                  ) : (\r\n                    <span className=\"truncate\">{product.category}</span>\r\n                  )}\r\n                </TableCell>\r\n                <TableCell className=\"text-right font-medium\">{product.quantity % 1 === 0 ? product.quantity : product.quantity.toFixed(2)}</TableCell>\r\n                <TableCell><StockStatusBadge product={product} /></TableCell>\r\n                {canViewCostPrice && (\r\n                  <>\r\n                    <TableCell className=\"text-right font-medium tabular-nums\" onClick={(e) => e.stopPropagation()}>\r\n                      {onUpdateProduct && canEdit ? (\r\n                        <InlineEditableCell\r\n                          value={product.costPrice}\r\n                          type=\"number\"\r\n                          currency={settings.currency}\r\n                          onSave={(newValue) => onUpdateProduct(product.id, { costPrice: newValue as number })}\r\n                          className=\"text-right\"\r\n                        />\r\n                      ) : (\r\n                        <span>{settings.currency} {formatFinancial(product.costPrice, 'cost')}</span>\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell className=\"text-right font-medium tabular-nums\">\r\n                      {settings.currency} {formatFinancial(calculateTotalCost(product), 'cost')}\r\n                    </TableCell>\r\n                  </>\r\n                )}\r\n                {canViewSellingPrice && (\r\n                  <TableCell className=\"text-right font-medium tabular-nums\" onClick={(e) => e.stopPropagation()}>\r\n                    {onUpdateProduct && canEdit ? (\r\n                      <InlineEditableCell\r\n                        value={product.sellingPrice}\r\n                        type=\"number\"\r\n                        currency={settings.currency}\r\n                        onSave={(newValue) => onUpdateProduct(product.id, { sellingPrice: newValue as number })}\r\n                        className=\"text-right\"\r\n                      />\r\n                    ) : (\r\n                      <span>{settings.currency} {formatFinancial(product.sellingPrice, 'price')}</span>\r\n                    )}\r\n                  </TableCell>\r\n                )}\r\n                <TableCell className=\"text-center text-sm text-muted-foreground\">\r\n                  {format(product.createdAt, 'MMM dd, yyyy')}\r\n                </TableCell>\r\n                <TableCell className=\"text-right\" onClick={(e) => e.stopPropagation()}>\r\n                  <ProductActions\r\n                    product={product}\r\n                    onView={onView}\r\n                    onEdit={onEdit}\r\n                  />\r\n                </TableCell>\r\n              </TableRow>\r\n            ))}\r\n          </TableBody>\r\n        </Table>\r\n      </TooltipProvider>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DesktopProductTable;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2359, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/EmptyProductState.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Package, Plus } from 'lucide-react';\r\n\r\nconst EmptyProductState: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  \r\n  return (\r\n    <div className=\"text-center py-12 px-4 border-dashed border-2 rounded-lg bg-white\">\r\n      <div className=\"inline-flex items-center justify-center w-12 h-12 rounded-full bg-muted mb-4\">\r\n        <Package className=\"h-6 w-6 text-muted-foreground\" />\r\n      </div>\r\n      <h3 className=\"text-lg font-medium text-gray-900\">No products found</h3>\r\n      <p className=\"mt-1 text-sm text-muted-foreground\">\r\n        Start managing your inventory by adding your first product.\r\n      </p>\r\n      <div className=\"mt-6\">\r\n        <Button onClick={() => navigate('/inventory/new')} className=\"gap-2\">\r\n          <Plus size={16} /> Add New Product\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EmptyProductState;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;;;;;;AAEA,MAAM,oBAA8B;;IAClC,MAAM,WAAW,IAAA,kLAAW;IAE5B,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,sNAAO;oBAAC,WAAU;;;;;;;;;;;0BAErB,6LAAC;gBAAG,WAAU;0BAAoC;;;;;;0BAClD,6LAAC;gBAAE,WAAU;0BAAqC;;;;;;0BAGlD,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,+IAAM;oBAAC,SAAS,IAAM,SAAS;oBAAmB,WAAU;;sCAC3D,6LAAC,6MAAI;4BAAC,MAAM;;;;;;wBAAM;;;;;;;;;;;;;;;;;;AAK5B;GAnBM;;QACa,kLAAW;;;KADxB;uCAqBS"}},
    {"offset": {"line": 2457, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/InventoryTable.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Product } from '@/types';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport MobileProductCard from './MobileProductCard';\r\nimport DesktopProductTable from './DesktopProductTable';\r\nimport EmptyProductState from './EmptyProductState';\r\n\r\ninterface InventoryTableProps {\r\n  products: Product[];\r\n  isLoading: boolean;\r\n  showAllFields?: boolean;\r\n  enableBulkActions?: boolean;\r\n  selectedProductIds?: Set<string>;\r\n  onToggleProductSelection?: (productId: string) => void;\r\n  onToggleAllProducts?: (productIds: string[]) => void;\r\n  sortField?: SortField;\r\n  sortOrder?: 'asc' | 'desc';\r\n  onSort?: (field: SortField) => void;\r\n  onUpdateProduct?: (id: string, updates: Partial<Product>) => Promise<boolean>;\r\n  categories?: string[];\r\n}\r\n\r\nexport type SortField = 'name' | 'category' | 'quantity' | 'sellingPrice' | 'costPrice' | 'itemNumber';\r\ntype SortOrder = 'asc' | 'desc';\r\n\r\nconst InventoryTable: React.FC<InventoryTableProps> = ({ \r\n  products, \r\n  isLoading, \r\n  showAllFields = true,\r\n  enableBulkActions = false,\r\n  selectedProductIds = new Set(),\r\n  onToggleProductSelection,\r\n  onToggleAllProducts,\r\n  sortField: externalSortField,\r\n  sortOrder: externalSortOrder,\r\n  onSort: externalOnSort,\r\n  onUpdateProduct,\r\n  categories = []\r\n}) => {\r\n  const navigate = useNavigate();\r\n  const isMobile = useIsMobile();\r\n  \r\n  // Internal sorting state (fallback if no external sorting is provided)\r\n  const [internalSortField, setInternalSortField] = React.useState<SortField>('name');\r\n  const [internalSortOrder, setInternalSortOrder] = React.useState<SortOrder>('asc');\r\n\r\n  // Use external sorting if provided, otherwise use internal\r\n  const sortField = externalSortField || internalSortField;\r\n  const sortOrder = externalSortOrder || internalSortOrder;\r\n\r\n  const handleEdit = (id: string) => {\r\n    navigate(`/inventory/edit/${id}`);\r\n  };\r\n\r\n  const handleView = (id: string) => {\r\n    navigate(`/inventory/${id}`);\r\n  };\r\n\r\n  const handleSort = (field: SortField) => {\r\n    if (externalOnSort) {\r\n      // Use external sort handler if provided\r\n      externalOnSort(field);\r\n    } else {\r\n      // Use internal sorting logic\r\n      if (sortField === field) {\r\n        setInternalSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\r\n      } else {\r\n        setInternalSortField(field);\r\n        setInternalSortOrder('asc');\r\n      }\r\n    }\r\n  };\r\n\r\n  const sortedProducts = React.useMemo(() => {\r\n    return [...products].sort((a, b) => {\r\n      let comparison = 0;\r\n      \r\n      switch (sortField) {\r\n        case 'name':\r\n          comparison = a.name.localeCompare(b.name);\r\n          break;\r\n        case 'category':\r\n          comparison = a.category.localeCompare(b.category);\r\n          break;\r\n        case 'quantity':\r\n          comparison = a.quantity - b.quantity;\r\n          break;\r\n        case 'sellingPrice':\r\n          comparison = a.sellingPrice - b.sellingPrice;\r\n          break;\r\n        case 'costPrice':\r\n          comparison = a.costPrice - b.costPrice;\r\n          break;\r\n        case 'itemNumber':\r\n          comparison = a.itemNumber.localeCompare(b.itemNumber);\r\n          break;\r\n      }\r\n      \r\n      return sortOrder === 'asc' ? comparison : -comparison;\r\n    });\r\n  }, [products, sortField, sortOrder]);\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-64\">\r\n        <div className=\"animate-pulse\">Loading inventory data...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (products.length === 0) {\r\n    return <EmptyProductState />;\r\n  }\r\n\r\n  // Mobile product cards view\r\n  if (isMobile) {\r\n    const productIds = sortedProducts.map(p => p.id);\r\n    const allSelected = productIds.length > 0 && productIds.every(id => selectedProductIds.has(id));\r\n\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        {/* Mobile Select All Header */}\r\n        {enableBulkActions && sortedProducts.length > 0 && (\r\n          <div className=\"flex items-center justify-between px-4 py-2 bg-muted/30 rounded-md\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={allSelected}\r\n                onChange={() => onToggleAllProducts?.(productIds)}\r\n                className=\"rounded border-gray-300\"\r\n                id=\"mobile-select-all\"\r\n              />\r\n              <label htmlFor=\"mobile-select-all\" className=\"text-sm font-medium\">\r\n                Select All ({productIds.length})\r\n              </label>\r\n            </div>\r\n            <div className=\"text-sm text-muted-foreground\">\r\n              {selectedProductIds.size} selected\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {/* Product Cards */}\r\n        <div className=\"divide-y\">\r\n          {sortedProducts.map((product) => (\r\n            <MobileProductCard \r\n              key={product.id}\r\n              product={product}\r\n              onView={handleView}\r\n              onEdit={handleEdit}\r\n              showAllFields={showAllFields}\r\n              enableBulkActions={enableBulkActions}\r\n              isSelected={selectedProductIds.has(product.id)}\r\n              onToggleSelection={onToggleProductSelection}\r\n            />\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Desktop table view\r\n  return (\r\n    <DesktopProductTable\r\n      products={sortedProducts}\r\n      sortField={sortField}\r\n      sortOrder={sortOrder}\r\n      handleSort={handleSort}\r\n      onView={handleView}\r\n      onEdit={handleEdit}\r\n      showAllFields={showAllFields}\r\n      enableBulkActions={enableBulkActions}\r\n      selectedProductIds={selectedProductIds}\r\n      onToggleProductSelection={onToggleProductSelection}\r\n      onToggleAllProducts={onToggleAllProducts}\r\n      onUpdateProduct={onUpdateProduct}\r\n      categories={categories}\r\n    />\r\n  );\r\n};\r\n\r\nexport default InventoryTable;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAEA;AACA;AACA;AACA;;;;;;;;;AAoBA,MAAM,iBAAgD,CAAC,EACrD,QAAQ,EACR,SAAS,EACT,gBAAgB,IAAI,EACpB,oBAAoB,KAAK,EACzB,qBAAqB,IAAI,KAAK,EAC9B,wBAAwB,EACxB,mBAAmB,EACnB,WAAW,iBAAiB,EAC5B,WAAW,iBAAiB,EAC5B,QAAQ,cAAc,EACtB,eAAe,EACf,aAAa,EAAE,EAChB;;IACC,MAAM,WAAW,IAAA,kLAAW;IAC5B,MAAM,WAAW,IAAA,gJAAW;IAE5B,uEAAuE;IACvE,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,wKAAK,CAAC,QAAQ,CAAY;IAC5E,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,wKAAK,CAAC,QAAQ,CAAY;IAE5E,2DAA2D;IAC3D,MAAM,YAAY,qBAAqB;IACvC,MAAM,YAAY,qBAAqB;IAEvC,MAAM,aAAa,CAAC;QAClB,SAAS,CAAC,gBAAgB,EAAE,IAAI;IAClC;IAEA,MAAM,aAAa,CAAC;QAClB,SAAS,CAAC,WAAW,EAAE,IAAI;IAC7B;IAEA,MAAM,aAAa,CAAC;QAClB,IAAI,gBAAgB;YAClB,wCAAwC;YACxC,eAAe;QACjB,OAAO;YACL,6BAA6B;YAC7B,IAAI,cAAc,OAAO;gBACvB,qBAAqB,cAAc,QAAQ,SAAS;YACtD,OAAO;gBACL,qBAAqB;gBACrB,qBAAqB;YACvB;QACF;IACF;IAEA,MAAM,iBAAiB,wKAAK,CAAC,OAAO;kDAAC;YACnC,OAAO;mBAAI;aAAS,CAAC,IAAI;0DAAC,CAAC,GAAG;oBAC5B,IAAI,aAAa;oBAEjB,OAAQ;wBACN,KAAK;4BACH,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI;4BACxC;wBACF,KAAK;4BACH,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,EAAE,QAAQ;4BAChD;wBACF,KAAK;4BACH,aAAa,EAAE,QAAQ,GAAG,EAAE,QAAQ;4BACpC;wBACF,KAAK;4BACH,aAAa,EAAE,YAAY,GAAG,EAAE,YAAY;4BAC5C;wBACF,KAAK;4BACH,aAAa,EAAE,SAAS,GAAG,EAAE,SAAS;4BACtC;wBACF,KAAK;4BACH,aAAa,EAAE,UAAU,CAAC,aAAa,CAAC,EAAE,UAAU;4BACpD;oBACJ;oBAEA,OAAO,cAAc,QAAQ,aAAa,CAAC;gBAC7C;;QACF;iDAAG;QAAC;QAAU;QAAW;KAAU;IAEnC,IAAI,WAAW;QACb,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;0BAAgB;;;;;;;;;;;IAGrC;IAEA,IAAI,SAAS,MAAM,KAAK,GAAG;QACzB,qBAAO,6LAAC,kKAAiB;;;;;IAC3B;IAEA,4BAA4B;IAC5B,IAAI,UAAU;QACZ,MAAM,aAAa,eAAe,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE;QAC/C,MAAM,cAAc,WAAW,MAAM,GAAG,KAAK,WAAW,KAAK,CAAC,CAAA,KAAM,mBAAmB,GAAG,CAAC;QAE3F,qBACE,6LAAC;YAAI,WAAU;;gBAEZ,qBAAqB,eAAe,MAAM,GAAG,mBAC5C,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,MAAK;oCACL,SAAS;oCACT,UAAU,IAAM,sBAAsB;oCACtC,WAAU;oCACV,IAAG;;;;;;8CAEL,6LAAC;oCAAM,SAAQ;oCAAoB,WAAU;;wCAAsB;wCACpD,WAAW,MAAM;wCAAC;;;;;;;;;;;;;sCAGnC,6LAAC;4BAAI,WAAU;;gCACZ,mBAAmB,IAAI;gCAAC;;;;;;;;;;;;;8BAM/B,6LAAC;oBAAI,WAAU;8BACZ,eAAe,GAAG,CAAC,CAAC,wBACnB,6LAAC,kKAAiB;4BAEhB,SAAS;4BACT,QAAQ;4BACR,QAAQ;4BACR,eAAe;4BACf,mBAAmB;4BACnB,YAAY,mBAAmB,GAAG,CAAC,QAAQ,EAAE;4BAC7C,mBAAmB;2BAPd,QAAQ,EAAE;;;;;;;;;;;;;;;;IAa3B;IAEA,qBAAqB;IACrB,qBACE,6LAAC,oKAAmB;QAClB,UAAU;QACV,WAAW;QACX,WAAW;QACX,YAAY;QACZ,QAAQ;QACR,QAAQ;QACR,eAAe;QACf,mBAAmB;QACnB,oBAAoB;QACpB,0BAA0B;QAC1B,qBAAqB;QACrB,iBAAiB;QACjB,YAAY;;;;;;AAGlB;GA1JM;;QAca,kLAAW;QACX,gJAAW;;;KAfxB;uCA4JS"}},
    {"offset": {"line": 2691, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/InventoryFilters.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Search, Filter } from 'lucide-react';\r\nimport { Input } from '@/components/ui/input';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n} from '@/components/ui/card';\r\nimport { ProductCategory, ProductFilters } from '@/types';\r\nimport { cn } from '@/lib/utils';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\n\r\ninterface InventoryFiltersProps {\r\n  filters: ProductFilters;\r\n  setFilters: (filters: ProductFilters) => void;\r\n  categories: ProductCategory[];\r\n  productsCount: number;\r\n}\r\n\r\nconst InventoryFilters: React.FC<InventoryFiltersProps> = ({\r\n  filters,\r\n  setFilters,\r\n  categories,\r\n  productsCount\r\n}) => {\r\n  const isMobile = useIsMobile();\r\n\r\n  const [localSearch, setLocalSearch] = React.useState(filters.search);\r\n\r\n  // Sync local search with filters when externally changed\r\n  React.useEffect(() => {\r\n    if (filters.search !== localSearch) {\r\n      setLocalSearch(filters.search);\r\n    }\r\n  }, [filters.search]);\r\n\r\n  const updateFilter = (key: keyof ProductFilters, value: string) => {\r\n    setFilters({\r\n      ...filters,\r\n      [key]: value\r\n    });\r\n  };\r\n\r\n  const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setLocalSearch(e.target.value);\r\n  };\r\n\r\n  const handleSearchKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (e.key === 'Enter') {\r\n      updateFilter('search', localSearch);\r\n    }\r\n  };\r\n\r\n  const handleBlur = () => {\r\n    if (localSearch !== filters.search) {\r\n      updateFilter('search', localSearch);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Card className=\"mb-6 shadow-sm\">\r\n      <CardContent className={cn(\"p-4\", isMobile && \"p-3\")}>\r\n        <div className=\"flex flex-col md:flex-row gap-3\">\r\n          {/* Search */}\r\n          <div className=\"flex items-center relative flex-grow\">\r\n            <Search className=\"h-4 w-4 absolute left-3 text-gray-400\" />\r\n            <Input\r\n              placeholder=\"Search products...\"\r\n              className=\"pl-9\"\r\n              value={localSearch}\r\n              onChange={handleSearchChange}\r\n              onKeyDown={handleSearchKeyDown}\r\n              onBlur={handleBlur}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex flex-wrap gap-3\">\r\n            {/* Category filter */}\r\n            <div className=\"min-w-[180px]\">\r\n              <Select\r\n                value={filters.category || 'all'}\r\n                onValueChange={(value) => updateFilter('category', value === 'all' ? '' : value)}\r\n              >\r\n                <SelectTrigger className={cn(\r\n                  \"w-full\",\r\n                  filters.category !== '' && \"border-primary\"\r\n                )}>\r\n                  <span className=\"flex items-center gap-2\">\r\n                    <Filter className=\"h-4 w-4\" />\r\n                    <SelectValue placeholder=\"All Categories\" />\r\n                  </span>\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">All Categories</SelectItem>\r\n                  {categories.map((category) => (\r\n                    <SelectItem key={category.id} value={category.name}>\r\n                      {category.name}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            {/* Stock status */}\r\n            <div className=\"min-w-[150px]\">\r\n              <Select\r\n                value={filters.stockStatus}\r\n                onValueChange={(value) => updateFilter('stockStatus', value as any)}\r\n              >\r\n                <SelectTrigger className={cn(\r\n                  filters.stockStatus !== 'all' && \"border-primary\"\r\n                )}>\r\n                  <SelectValue placeholder=\"Stock Status\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">All Stock</SelectItem>\r\n                  <SelectItem value=\"inStock\">In Stock</SelectItem>\r\n                  <SelectItem value=\"lowStock\">Low Stock</SelectItem>\r\n                  <SelectItem value=\"outOfStock\">Out of Stock</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            {/* Results count */}\r\n            <div className=\"flex items-center\">\r\n              <Badge variant=\"secondary\" className=\"text-xs\">\r\n                {productsCount} {productsCount === 1 ? 'product' : 'products'} found\r\n              </Badge>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default InventoryFilters;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2988, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/InventoryStats.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Product } from '@/types';\r\nimport { Package, AlertTriangle, Ban, TrendingUp, DollarSign } from 'lucide-react';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\ninterface InventoryStatsProps {\r\n  products: Product[];\r\n  hideStockValue?: boolean;\r\n  // Optional overrides to show totals beyond the current page without fetching all rows here\r\n  totalCountOverride?: number;\r\n  totalCostValueOverride?: number;\r\n  lowStockOverride?: number;\r\n  outOfStockOverride?: number;\r\n  totalStockValueOverride?: number;\r\n}\r\n\r\nconst InventoryStats: React.FC<InventoryStatsProps> = ({\r\n  products,\r\n  hideStockValue = false,\r\n  totalCountOverride,\r\n  totalCostValueOverride,\r\n  lowStockOverride,\r\n  outOfStockOverride,\r\n  totalStockValueOverride\r\n}) => {\r\n\r\n  const { settings } = useBusinessSettings();\r\n  const { canViewCostPrice, canViewSellingPrice } = useFinancialVisibility();\r\n\r\n\r\n  // Calculate stats\r\n  const totalProducts = typeof totalCountOverride === 'number' ? totalCountOverride : products.length;\r\n  const lowStockProducts = typeof lowStockOverride === 'number' ? lowStockOverride : products.filter(p => p.quantity > 0 && p.quantity <= p.minimumStock).length;\r\n  const outOfStockProducts = typeof outOfStockOverride === 'number' ? outOfStockOverride : products.filter(p => p.quantity === 0).length;\r\n\r\n  const totalInventoryValue = typeof totalCostValueOverride === 'number'\r\n    ? totalCostValueOverride\r\n    : products.reduce((sum, product) => sum + (product.costPrice * product.quantity), 0);\r\n\r\n  const totalStockValue = typeof totalStockValueOverride === 'number'\r\n    ? totalStockValueOverride\r\n    : products.reduce((sum, product) => {\r\n      return sum + (product.sellingPrice * product.quantity);\r\n    }, 0);\r\n\r\n  // Get dynamic font size based on text length\r\n  const getDynamicFontSize = (text: string) => {\r\n    const length = text.length;\r\n    if (length > 15) return \"text-sm md:text-lg\"; // Very long numbers\r\n    if (length > 12) return \"text-base md:text-xl\"; // Long numbers\r\n    if (length > 8) return \"text-lg md:text-xl\"; // Medium numbers\r\n    return \"text-lg md:text-2xl\"; // Short numbers (default)\r\n  };\r\n\r\n  return (\r\n    <div className={`grid gap-3 md:gap-4 mb-6 ${hideStockValue ? 'grid-cols-2 md:grid-cols-4' : 'grid-cols-2 md:grid-cols-3 xl:grid-cols-5'}`}>\r\n      <Card className=\"overflow-hidden\">\r\n        <CardContent className=\"p-4 md:p-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-blue-100 text-blue-500\">\r\n              <Package className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n            </div>\r\n            <div className=\"ml-3 md:ml-4 min-w-0\">\r\n              <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Total Products</p>\r\n              <h3 className=\"text-lg md:text-2xl font-bold\">{totalProducts}</h3>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card className=\"overflow-hidden\">\r\n        <CardContent className=\"p-4 md:p-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-amber-100 text-amber-500\">\r\n              <AlertTriangle className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n            </div>\r\n            <div className=\"ml-3 md:ml-4 min-w-0\">\r\n              <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Low Stock</p>\r\n              <h3 className=\"text-lg md:text-2xl font-bold\">{lowStockProducts}</h3>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card className=\"overflow-hidden\">\r\n        <CardContent className=\"p-4 md:p-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-red-100 text-red-500\">\r\n              <Ban className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n            </div>\r\n            <div className=\"ml-3 md:ml-4 min-w-0\">\r\n              <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Out of Stock</p>\r\n              <h3 className=\"text-lg md:text-2xl font-bold\">{outOfStockProducts}</h3>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card className=\"overflow-hidden\">\r\n        <CardContent className=\"p-4 md:p-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-green-100 text-green-500\">\r\n              <TrendingUp className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n            </div>\r\n            <div className=\"ml-3 md:ml-4 min-w-0 flex-1\">\r\n              <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Cost Value</p>\r\n              <h3 className={`${getDynamicFontSize(`${settings.currency} ${formatNumber(totalInventoryValue)}`)} font-bold break-all leading-tight`}>\r\n                {canViewCostPrice ? `${settings.currency} ${formatNumber(totalInventoryValue)}` : '•••'}\r\n              </h3>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {!hideStockValue && (\r\n        <Card className=\"overflow-hidden\">\r\n          <CardContent className=\"p-4 md:p-6\">\r\n            <div className=\"flex items-center\">\r\n              <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-purple-100 text-purple-500\">\r\n                <DollarSign className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n              </div>\r\n              <div className=\"ml-3 md:ml-4 min-w-0 flex-1\">\r\n                <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Stock Value</p>\r\n                <h3 className={`${getDynamicFontSize(`${settings.currency} ${formatNumber(totalStockValue)}`)} font-bold break-all leading-tight`}>\r\n                  {canViewSellingPrice ? `${settings.currency} ${formatNumber(totalStockValue)}` : '•••'}\r\n                </h3>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InventoryStats;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3366, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/inventoryCacheUtils.ts"],"sourcesContent":["import { QueryClient } from \"@tanstack/react-query\";\r\n\r\n/**\r\n * Utility to clear inventory-related caches (both localStorage and React Query)\r\n * to ensure real-time data accuracy.\r\n */\r\nexport const clearInventoryCaches = (queryClient?: QueryClient) => {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    // 1. Clear LocalStorage (Legacy / Manual caches)\r\n    const keys = Object.keys(localStorage);\r\n    const patterns = [\r\n        'allProductsStats_',\r\n        'stockSummary_',\r\n        'soldItems_',\r\n        'dashboardData_',\r\n        'analyticsData_'\r\n    ];\r\n\r\n    let clearedCount = 0;\r\n    keys.forEach(key => {\r\n        if (patterns.some(pattern => key.startsWith(pattern))) {\r\n            localStorage.removeItem(key);\r\n            clearedCount++;\r\n        }\r\n    });\r\n\r\n    if (clearedCount > 0) {\r\n        console.log(`[Cache] Cleared ${clearedCount} inventory-related localStorage entries.`);\r\n    }\r\n\r\n    // 2. Invalidate React Query Keys (Modern State)\r\n    if (queryClient) {\r\n        console.log('[Cache] Invalidating React Query inventory keys...');\r\n        // Invalidate specific keys used in the inventory module\r\n        queryClient.invalidateQueries({ queryKey: ['inventory_global_stats'] });\r\n        queryClient.invalidateQueries({ queryKey: ['stockSummary'] });\r\n        queryClient.invalidateQueries({ queryKey: ['products'] });\r\n        queryClient.invalidateQueries({ queryKey: ['sales'] });\r\n        queryClient.invalidateQueries({ queryKey: ['all-products-for-scanner'] });\r\n        queryClient.invalidateQueries({ queryKey: ['all-products'] });\r\n    }\r\n};\r\n"],"names":[],"mappings":";;;;AAMO,MAAM,uBAAuB,CAAC;IACjC;;IAEA,iDAAiD;IACjD,MAAM,OAAO,OAAO,IAAI,CAAC;IACzB,MAAM,WAAW;QACb;QACA;QACA;QACA;QACA;KACH;IAED,IAAI,eAAe;IACnB,KAAK,OAAO,CAAC,CAAA;QACT,IAAI,SAAS,IAAI,CAAC,CAAA,UAAW,IAAI,UAAU,CAAC,WAAW;YACnD,aAAa,UAAU,CAAC;YACxB;QACJ;IACJ;IAEA,IAAI,eAAe,GAAG;QAClB,QAAQ,GAAG,CAAC,CAAC,gBAAgB,EAAE,aAAa,wCAAwC,CAAC;IACzF;IAEA,gDAAgD;IAChD,IAAI,aAAa;QACb,QAAQ,GAAG,CAAC;QACZ,wDAAwD;QACxD,YAAY,iBAAiB,CAAC;YAAE,UAAU;gBAAC;aAAyB;QAAC;QACrE,YAAY,iBAAiB,CAAC;YAAE,UAAU;gBAAC;aAAe;QAAC;QAC3D,YAAY,iBAAiB,CAAC;YAAE,UAAU;gBAAC;aAAW;QAAC;QACvD,YAAY,iBAAiB,CAAC;YAAE,UAAU;gBAAC;aAAQ;QAAC;QACpD,YAAY,iBAAiB,CAAC;YAAE,UAAU;gBAAC;aAA2B;QAAC;QACvE,YAAY,iBAAiB,CAAC;YAAE,UAAU;gBAAC;aAAe;QAAC;IAC/D;AACJ"}},
    {"offset": {"line": 3435, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/products.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { db } from '../../../prisma/db';\r\nimport { Product, ProductFormData, mapDbProductToProduct, mapProductToDbProduct } from '@/types';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// We implement server actions for the products here\r\n\r\nexport async function getProductsAction({\r\n  userId,\r\n  businessId,\r\n  page,\r\n  pageSize,\r\n  search,\r\n  category,\r\n  stockStatus,\r\n}: {\r\n  userId: string;\r\n  businessId: string;\r\n  page: number;\r\n  pageSize: number;\r\n  search?: string;\r\n  category?: string;\r\n  stockStatus?: 'inStock' | 'outOfStock' | 'lowStock' | 'all';\r\n}) {\r\n  if (!userId || !businessId) return { products: [], count: 0 };\r\n\r\n  const skip = (page - 1) * pageSize;\r\n  const take = pageSize;\r\n\r\n  let whereClause: any = {\r\n    userId: userId,\r\n    branchId: businessId,\r\n  };\r\n\r\n  if (search) {\r\n    whereClause.OR = [\r\n      { name: { contains: search, mode: 'insensitive' } },\r\n      { description: { contains: search, mode: 'insensitive' } },\r\n      { sku: { contains: search, mode: 'insensitive' } },\r\n      { barcode: { contains: search, mode: 'insensitive' } },\r\n    ];\r\n  }\r\n\r\n  if (category) {\r\n    whereClause.category = { name: category };\r\n  }\r\n\r\n  if (stockStatus === 'outOfStock') {\r\n    whereClause.stock = 0;\r\n  } else if (stockStatus === 'inStock') {\r\n    whereClause.stock = { gt: 0 };\r\n  } else if (stockStatus === 'lowStock') {\r\n    // Handling lowStock is complex because minStock is compared locally or using direct SQL in Prisma\r\n    // For now, we will handle it with Prisma's raw query or by filtering in memory if necessary\r\n    // Fortunately, since PRISMA 5.0, column comparison still needs raw queries or we can fetch and filter if small\r\n    // Here we'll fetch them all if lowStock is enabled, or add a generated column. \r\n    // We will do a basic fetch and filter later if needed.\r\n  }\r\n\r\n  try {\r\n    const [productsData, totalCount] = await Promise.all([\r\n      db.product.findMany({\r\n        where: whereClause,\r\n        skip,\r\n        take,\r\n        orderBy: [{ createdAt: 'desc' }, { id: 'desc' }],\r\n        include: {\r\n          category: true,\r\n          supplier: true,\r\n        }\r\n      }),\r\n      db.product.count({ where: whereClause })\r\n    ]);\r\n\r\n    // Map the Prisma product model back to the application's Product type\r\n    let formattedProducts = productsData.map((p: any) => {\r\n      // Assuming mapping exists, we will map it\r\n      return {\r\n        id: p.id,\r\n        name: p.name,\r\n        description: p.description || '',\r\n        category: p.category?.name || 'Uncategorized',\r\n        quantity: p.stock,\r\n        costPrice: p.costPrice,\r\n        sellingPrice: p.sellingPrice,\r\n        supplier: p.supplier?.name,\r\n        imageUrl: p.image,\r\n        barcode: p.barcode,\r\n        itemNumber: p.sku || '',\r\n        minimumStock: p.minStock,\r\n        createdAt: p.createdAt,\r\n      };\r\n    });\r\n\r\n    if (stockStatus === 'lowStock') {\r\n      formattedProducts = formattedProducts.filter((p: any) => p.quantity > 0 && p.quantity <= p.minimumStock);\r\n    }\r\n\r\n    return { products: formattedProducts as any[], count: totalCount };\r\n  } catch (error) {\r\n    console.error('Error fetching products from DB:', error);\r\n    return { products: [], count: 0 };\r\n  }\r\n}\r\n\r\nexport async function getProductsByIdsAction(ids: string[], businessId?: string) {\r\n  try {\r\n    const where: any = {\r\n      id: { in: ids }\r\n    };\r\n    if (businessId) {\r\n      where.branchId = businessId;\r\n    }\r\n\r\n    const products = await db.product.findMany({\r\n      where,\r\n      include: {\r\n        category: true,\r\n        supplier: true,\r\n      }\r\n    });\r\n\r\n    return products.map((p: any) => ({\r\n      id: p.id,\r\n      name: p.name,\r\n      description: p.description || '',\r\n      category: p.category?.name || 'Uncategorized',\r\n      quantity: p.stock,\r\n      costPrice: p.costPrice,\r\n      sellingPrice: p.sellingPrice,\r\n      supplier: p.supplier?.name,\r\n      imageUrl: p.image,\r\n      barcode: p.barcode,\r\n      itemNumber: p.sku || '',\r\n      minimumStock: p.minStock,\r\n      createdAt: p.createdAt,\r\n    }));\r\n  } catch (error) {\r\n    console.error('Error fetching products by ids:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function createProductAction(data: any) {\r\n  try {\r\n    const result = await db.$transaction(async (tx: any) => {\r\n      // 1. Generate next SKU/itemNumber for this branch\r\n      const lastProduct = await tx.product.findFirst({\r\n        where: { branchId: data.businessId },\r\n        orderBy: { sku: 'desc' },\r\n        select: { sku: true }\r\n      });\r\n\r\n      let nextSku = \"PROD-0001\";\r\n      if (lastProduct && lastProduct.sku) {\r\n        const currentNumber = parseInt(lastProduct.sku.replace(\"PROD-\", \"\")) || 0;\r\n        nextSku = `PROD-${(currentNumber + 1).toString().padStart(4, '0')}`;\r\n      }\r\n\r\n      // 2. Create the product\r\n      const product = await tx.product.create({\r\n        data: {\r\n          name: data.name,\r\n          description: data.description,\r\n          branchId: data.businessId,\r\n          userId: data.userId,\r\n          categoryId: data.categoryId || null,\r\n          supplierId: data.supplierId || null,\r\n          sku: nextSku,\r\n          barcode: data.barcode,\r\n          image: data.imageUrl,\r\n          costPrice: data.costPrice || 0,\r\n          sellingPrice: data.sellingPrice || 0,\r\n          stock: data.quantity || 0,\r\n          minStock: data.minimumStock || 0,\r\n          createdAt: data.createdAt ? new Date(data.createdAt) : new Date(),\r\n        },\r\n        include: {\r\n          category: true,\r\n          supplier: true,\r\n        }\r\n      });\r\n\r\n      // 3. Create initial stock history if quantity > 0\r\n      if (data.quantity > 0) {\r\n        await tx.productHistory.create({\r\n          data: {\r\n            userId: data.userId,\r\n            locationId: data.businessId,\r\n            productId: product.id,\r\n            previousQuantity: 0,\r\n            newQuantity: data.quantity,\r\n            changeReason: `[${product.name}] | Initial stock`,\r\n            createdAt: data.createdAt ? new Date(data.createdAt) : new Date(),\r\n          }\r\n        });\r\n      }\r\n\r\n      return product;\r\n    });\r\n\r\n    return {\r\n      id: result.id,\r\n      name: result.name,\r\n      description: result.description || '',\r\n      category: result.category?.name || 'Uncategorized',\r\n      quantity: result.stock,\r\n      costPrice: result.costPrice,\r\n      sellingPrice: result.sellingPrice,\r\n      supplier: result.supplier?.name,\r\n      imageUrl: result.image,\r\n      barcode: result.barcode,\r\n      itemNumber: result.sku || '',\r\n      minimumStock: result.minStock,\r\n      createdAt: result.createdAt,\r\n    };\r\n  } catch (error) {\r\n    console.error('Error creating product:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function updateProductAction(id: string, updates: any) {\r\n  try {\r\n    const result = await db.$transaction(async (tx: any) => {\r\n      // 1. Get current product state\r\n      const current = await tx.product.findUnique({\r\n        where: { id },\r\n        select: { stock: true, name: true }\r\n      });\r\n\r\n      if (!current) throw new Error(\"Product not found\");\r\n\r\n      // 2. Perform update\r\n      const updated = await tx.product.update({\r\n        where: { id },\r\n        data: {\r\n          name: updates.name,\r\n          description: updates.description,\r\n          categoryId: updates.categoryId !== undefined ? updates.categoryId : undefined,\r\n          supplierId: updates.supplierId !== undefined ? updates.supplierId : undefined,\r\n          sku: updates.itemNumber || updates.sku,\r\n          barcode: updates.barcode,\r\n          image: updates.imageUrl,\r\n          costPrice: updates.costPrice,\r\n          sellingPrice: updates.sellingPrice,\r\n          stock: updates.quantity,\r\n          minStock: updates.minimumStock,\r\n        }\r\n      });\r\n\r\n      // 3. Create history if quantity changed\r\n      if (updates.quantity !== undefined && updates.quantity !== current.stock && updates.customChangeReason !== 'skip-history') {\r\n        let changeReason = updates.customChangeReason;\r\n        if (!changeReason) {\r\n          if (updates.isFromSale) changeReason = \"Sale\";\r\n          else if (updates.quantity > current.stock) changeReason = \"Manual stock addition\";\r\n          else changeReason = \"Manual stock reduction\";\r\n        }\r\n\r\n        const snapshottedReason = `[${updated.name}] | ${changeReason}`;\r\n\r\n        await tx.productHistory.create({\r\n          data: {\r\n            userId: updates.userId,\r\n            locationId: updates.businessId,\r\n            productId: updated.id,\r\n            previousQuantity: current.stock,\r\n            newQuantity: updates.quantity,\r\n            changeReason: snapshottedReason,\r\n            referenceId: updates.referenceId || null,\r\n          }\r\n        });\r\n      }\r\n\r\n      return updated;\r\n    });\r\n\r\n    return result;\r\n  } catch (error) {\r\n    console.error('Error updating product:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function deleteProductAction(id: string) {\r\n  try {\r\n    await db.product.delete({\r\n      where: { id }\r\n    });\r\n    // revalidatePath('/inventory/products');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error deleting product:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport async function updateProductsBulkAction(\r\n  updates: Array<{ id: string; updated: Partial<any> }>,\r\n  businessId: string\r\n) {\r\n  try {\r\n    // Prisma transaction for bulk updates\r\n    const updatePromises = updates.map(u =>\r\n      db.product.update({\r\n        where: { id: u.id },\r\n        data: {\r\n          ...(u.updated.name && { name: u.updated.name }),\r\n          ...(u.updated.description !== undefined && { description: u.updated.description }),\r\n          ...(u.updated.categoryId !== undefined && { categoryId: u.updated.categoryId }),\r\n          ...(u.updated.supplierId !== undefined && { supplierId: u.updated.supplierId }),\r\n          ...(u.updated.sku !== undefined && { sku: u.updated.sku }),\r\n          ...(u.updated.barcode !== undefined && { barcode: u.updated.barcode }),\r\n          ...(u.updated.costPrice !== undefined && { costPrice: u.updated.costPrice }),\r\n          ...(u.updated.sellingPrice !== undefined && { sellingPrice: u.updated.sellingPrice }),\r\n          ...(u.updated.quantity !== undefined && { stock: u.updated.quantity }),\r\n          ...(u.updated.minimumStock !== undefined && { minStock: u.updated.minimumStock }),\r\n        }\r\n      })\r\n    );\r\n\r\n    await db.$transaction(updatePromises);\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error performing bulk update:', error);\r\n    return false;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MAQsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,qDAAA"}},
    {"offset": {"line": 3452, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/products.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { db } from '../../../prisma/db';\r\nimport { Product, ProductFormData, mapDbProductToProduct, mapProductToDbProduct } from '@/types';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// We implement server actions for the products here\r\n\r\nexport async function getProductsAction({\r\n  userId,\r\n  businessId,\r\n  page,\r\n  pageSize,\r\n  search,\r\n  category,\r\n  stockStatus,\r\n}: {\r\n  userId: string;\r\n  businessId: string;\r\n  page: number;\r\n  pageSize: number;\r\n  search?: string;\r\n  category?: string;\r\n  stockStatus?: 'inStock' | 'outOfStock' | 'lowStock' | 'all';\r\n}) {\r\n  if (!userId || !businessId) return { products: [], count: 0 };\r\n\r\n  const skip = (page - 1) * pageSize;\r\n  const take = pageSize;\r\n\r\n  let whereClause: any = {\r\n    userId: userId,\r\n    branchId: businessId,\r\n  };\r\n\r\n  if (search) {\r\n    whereClause.OR = [\r\n      { name: { contains: search, mode: 'insensitive' } },\r\n      { description: { contains: search, mode: 'insensitive' } },\r\n      { sku: { contains: search, mode: 'insensitive' } },\r\n      { barcode: { contains: search, mode: 'insensitive' } },\r\n    ];\r\n  }\r\n\r\n  if (category) {\r\n    whereClause.category = { name: category };\r\n  }\r\n\r\n  if (stockStatus === 'outOfStock') {\r\n    whereClause.stock = 0;\r\n  } else if (stockStatus === 'inStock') {\r\n    whereClause.stock = { gt: 0 };\r\n  } else if (stockStatus === 'lowStock') {\r\n    // Handling lowStock is complex because minStock is compared locally or using direct SQL in Prisma\r\n    // For now, we will handle it with Prisma's raw query or by filtering in memory if necessary\r\n    // Fortunately, since PRISMA 5.0, column comparison still needs raw queries or we can fetch and filter if small\r\n    // Here we'll fetch them all if lowStock is enabled, or add a generated column. \r\n    // We will do a basic fetch and filter later if needed.\r\n  }\r\n\r\n  try {\r\n    const [productsData, totalCount] = await Promise.all([\r\n      db.product.findMany({\r\n        where: whereClause,\r\n        skip,\r\n        take,\r\n        orderBy: [{ createdAt: 'desc' }, { id: 'desc' }],\r\n        include: {\r\n          category: true,\r\n          supplier: true,\r\n        }\r\n      }),\r\n      db.product.count({ where: whereClause })\r\n    ]);\r\n\r\n    // Map the Prisma product model back to the application's Product type\r\n    let formattedProducts = productsData.map((p: any) => {\r\n      // Assuming mapping exists, we will map it\r\n      return {\r\n        id: p.id,\r\n        name: p.name,\r\n        description: p.description || '',\r\n        category: p.category?.name || 'Uncategorized',\r\n        quantity: p.stock,\r\n        costPrice: p.costPrice,\r\n        sellingPrice: p.sellingPrice,\r\n        supplier: p.supplier?.name,\r\n        imageUrl: p.image,\r\n        barcode: p.barcode,\r\n        itemNumber: p.sku || '',\r\n        minimumStock: p.minStock,\r\n        createdAt: p.createdAt,\r\n      };\r\n    });\r\n\r\n    if (stockStatus === 'lowStock') {\r\n      formattedProducts = formattedProducts.filter((p: any) => p.quantity > 0 && p.quantity <= p.minimumStock);\r\n    }\r\n\r\n    return { products: formattedProducts as any[], count: totalCount };\r\n  } catch (error) {\r\n    console.error('Error fetching products from DB:', error);\r\n    return { products: [], count: 0 };\r\n  }\r\n}\r\n\r\nexport async function getProductsByIdsAction(ids: string[], businessId?: string) {\r\n  try {\r\n    const where: any = {\r\n      id: { in: ids }\r\n    };\r\n    if (businessId) {\r\n      where.branchId = businessId;\r\n    }\r\n\r\n    const products = await db.product.findMany({\r\n      where,\r\n      include: {\r\n        category: true,\r\n        supplier: true,\r\n      }\r\n    });\r\n\r\n    return products.map((p: any) => ({\r\n      id: p.id,\r\n      name: p.name,\r\n      description: p.description || '',\r\n      category: p.category?.name || 'Uncategorized',\r\n      quantity: p.stock,\r\n      costPrice: p.costPrice,\r\n      sellingPrice: p.sellingPrice,\r\n      supplier: p.supplier?.name,\r\n      imageUrl: p.image,\r\n      barcode: p.barcode,\r\n      itemNumber: p.sku || '',\r\n      minimumStock: p.minStock,\r\n      createdAt: p.createdAt,\r\n    }));\r\n  } catch (error) {\r\n    console.error('Error fetching products by ids:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function createProductAction(data: any) {\r\n  try {\r\n    const result = await db.$transaction(async (tx: any) => {\r\n      // 1. Generate next SKU/itemNumber for this branch\r\n      const lastProduct = await tx.product.findFirst({\r\n        where: { branchId: data.businessId },\r\n        orderBy: { sku: 'desc' },\r\n        select: { sku: true }\r\n      });\r\n\r\n      let nextSku = \"PROD-0001\";\r\n      if (lastProduct && lastProduct.sku) {\r\n        const currentNumber = parseInt(lastProduct.sku.replace(\"PROD-\", \"\")) || 0;\r\n        nextSku = `PROD-${(currentNumber + 1).toString().padStart(4, '0')}`;\r\n      }\r\n\r\n      // 2. Create the product\r\n      const product = await tx.product.create({\r\n        data: {\r\n          name: data.name,\r\n          description: data.description,\r\n          branchId: data.businessId,\r\n          userId: data.userId,\r\n          categoryId: data.categoryId || null,\r\n          supplierId: data.supplierId || null,\r\n          sku: nextSku,\r\n          barcode: data.barcode,\r\n          image: data.imageUrl,\r\n          costPrice: data.costPrice || 0,\r\n          sellingPrice: data.sellingPrice || 0,\r\n          stock: data.quantity || 0,\r\n          minStock: data.minimumStock || 0,\r\n          createdAt: data.createdAt ? new Date(data.createdAt) : new Date(),\r\n        },\r\n        include: {\r\n          category: true,\r\n          supplier: true,\r\n        }\r\n      });\r\n\r\n      // 3. Create initial stock history if quantity > 0\r\n      if (data.quantity > 0) {\r\n        await tx.productHistory.create({\r\n          data: {\r\n            userId: data.userId,\r\n            locationId: data.businessId,\r\n            productId: product.id,\r\n            previousQuantity: 0,\r\n            newQuantity: data.quantity,\r\n            changeReason: `[${product.name}] | Initial stock`,\r\n            createdAt: data.createdAt ? new Date(data.createdAt) : new Date(),\r\n          }\r\n        });\r\n      }\r\n\r\n      return product;\r\n    });\r\n\r\n    return {\r\n      id: result.id,\r\n      name: result.name,\r\n      description: result.description || '',\r\n      category: result.category?.name || 'Uncategorized',\r\n      quantity: result.stock,\r\n      costPrice: result.costPrice,\r\n      sellingPrice: result.sellingPrice,\r\n      supplier: result.supplier?.name,\r\n      imageUrl: result.image,\r\n      barcode: result.barcode,\r\n      itemNumber: result.sku || '',\r\n      minimumStock: result.minStock,\r\n      createdAt: result.createdAt,\r\n    };\r\n  } catch (error) {\r\n    console.error('Error creating product:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function updateProductAction(id: string, updates: any) {\r\n  try {\r\n    const result = await db.$transaction(async (tx: any) => {\r\n      // 1. Get current product state\r\n      const current = await tx.product.findUnique({\r\n        where: { id },\r\n        select: { stock: true, name: true }\r\n      });\r\n\r\n      if (!current) throw new Error(\"Product not found\");\r\n\r\n      // 2. Perform update\r\n      const updated = await tx.product.update({\r\n        where: { id },\r\n        data: {\r\n          name: updates.name,\r\n          description: updates.description,\r\n          categoryId: updates.categoryId !== undefined ? updates.categoryId : undefined,\r\n          supplierId: updates.supplierId !== undefined ? updates.supplierId : undefined,\r\n          sku: updates.itemNumber || updates.sku,\r\n          barcode: updates.barcode,\r\n          image: updates.imageUrl,\r\n          costPrice: updates.costPrice,\r\n          sellingPrice: updates.sellingPrice,\r\n          stock: updates.quantity,\r\n          minStock: updates.minimumStock,\r\n        }\r\n      });\r\n\r\n      // 3. Create history if quantity changed\r\n      if (updates.quantity !== undefined && updates.quantity !== current.stock && updates.customChangeReason !== 'skip-history') {\r\n        let changeReason = updates.customChangeReason;\r\n        if (!changeReason) {\r\n          if (updates.isFromSale) changeReason = \"Sale\";\r\n          else if (updates.quantity > current.stock) changeReason = \"Manual stock addition\";\r\n          else changeReason = \"Manual stock reduction\";\r\n        }\r\n\r\n        const snapshottedReason = `[${updated.name}] | ${changeReason}`;\r\n\r\n        await tx.productHistory.create({\r\n          data: {\r\n            userId: updates.userId,\r\n            locationId: updates.businessId,\r\n            productId: updated.id,\r\n            previousQuantity: current.stock,\r\n            newQuantity: updates.quantity,\r\n            changeReason: snapshottedReason,\r\n            referenceId: updates.referenceId || null,\r\n          }\r\n        });\r\n      }\r\n\r\n      return updated;\r\n    });\r\n\r\n    return result;\r\n  } catch (error) {\r\n    console.error('Error updating product:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function deleteProductAction(id: string) {\r\n  try {\r\n    await db.product.delete({\r\n      where: { id }\r\n    });\r\n    // revalidatePath('/inventory/products');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error deleting product:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport async function updateProductsBulkAction(\r\n  updates: Array<{ id: string; updated: Partial<any> }>,\r\n  businessId: string\r\n) {\r\n  try {\r\n    // Prisma transaction for bulk updates\r\n    const updatePromises = updates.map(u =>\r\n      db.product.update({\r\n        where: { id: u.id },\r\n        data: {\r\n          ...(u.updated.name && { name: u.updated.name }),\r\n          ...(u.updated.description !== undefined && { description: u.updated.description }),\r\n          ...(u.updated.categoryId !== undefined && { categoryId: u.updated.categoryId }),\r\n          ...(u.updated.supplierId !== undefined && { supplierId: u.updated.supplierId }),\r\n          ...(u.updated.sku !== undefined && { sku: u.updated.sku }),\r\n          ...(u.updated.barcode !== undefined && { barcode: u.updated.barcode }),\r\n          ...(u.updated.costPrice !== undefined && { costPrice: u.updated.costPrice }),\r\n          ...(u.updated.sellingPrice !== undefined && { sellingPrice: u.updated.sellingPrice }),\r\n          ...(u.updated.quantity !== undefined && { stock: u.updated.quantity }),\r\n          ...(u.updated.minimumStock !== undefined && { minStock: u.updated.minimumStock }),\r\n        }\r\n      })\r\n    );\r\n\r\n    await db.$transaction(updatePromises);\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error performing bulk update:', error);\r\n    return false;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MAgJsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,uDAAA"}},
    {"offset": {"line": 3469, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/products.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { db } from '../../../prisma/db';\r\nimport { Product, ProductFormData, mapDbProductToProduct, mapProductToDbProduct } from '@/types';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// We implement server actions for the products here\r\n\r\nexport async function getProductsAction({\r\n  userId,\r\n  businessId,\r\n  page,\r\n  pageSize,\r\n  search,\r\n  category,\r\n  stockStatus,\r\n}: {\r\n  userId: string;\r\n  businessId: string;\r\n  page: number;\r\n  pageSize: number;\r\n  search?: string;\r\n  category?: string;\r\n  stockStatus?: 'inStock' | 'outOfStock' | 'lowStock' | 'all';\r\n}) {\r\n  if (!userId || !businessId) return { products: [], count: 0 };\r\n\r\n  const skip = (page - 1) * pageSize;\r\n  const take = pageSize;\r\n\r\n  let whereClause: any = {\r\n    userId: userId,\r\n    branchId: businessId,\r\n  };\r\n\r\n  if (search) {\r\n    whereClause.OR = [\r\n      { name: { contains: search, mode: 'insensitive' } },\r\n      { description: { contains: search, mode: 'insensitive' } },\r\n      { sku: { contains: search, mode: 'insensitive' } },\r\n      { barcode: { contains: search, mode: 'insensitive' } },\r\n    ];\r\n  }\r\n\r\n  if (category) {\r\n    whereClause.category = { name: category };\r\n  }\r\n\r\n  if (stockStatus === 'outOfStock') {\r\n    whereClause.stock = 0;\r\n  } else if (stockStatus === 'inStock') {\r\n    whereClause.stock = { gt: 0 };\r\n  } else if (stockStatus === 'lowStock') {\r\n    // Handling lowStock is complex because minStock is compared locally or using direct SQL in Prisma\r\n    // For now, we will handle it with Prisma's raw query or by filtering in memory if necessary\r\n    // Fortunately, since PRISMA 5.0, column comparison still needs raw queries or we can fetch and filter if small\r\n    // Here we'll fetch them all if lowStock is enabled, or add a generated column. \r\n    // We will do a basic fetch and filter later if needed.\r\n  }\r\n\r\n  try {\r\n    const [productsData, totalCount] = await Promise.all([\r\n      db.product.findMany({\r\n        where: whereClause,\r\n        skip,\r\n        take,\r\n        orderBy: [{ createdAt: 'desc' }, { id: 'desc' }],\r\n        include: {\r\n          category: true,\r\n          supplier: true,\r\n        }\r\n      }),\r\n      db.product.count({ where: whereClause })\r\n    ]);\r\n\r\n    // Map the Prisma product model back to the application's Product type\r\n    let formattedProducts = productsData.map((p: any) => {\r\n      // Assuming mapping exists, we will map it\r\n      return {\r\n        id: p.id,\r\n        name: p.name,\r\n        description: p.description || '',\r\n        category: p.category?.name || 'Uncategorized',\r\n        quantity: p.stock,\r\n        costPrice: p.costPrice,\r\n        sellingPrice: p.sellingPrice,\r\n        supplier: p.supplier?.name,\r\n        imageUrl: p.image,\r\n        barcode: p.barcode,\r\n        itemNumber: p.sku || '',\r\n        minimumStock: p.minStock,\r\n        createdAt: p.createdAt,\r\n      };\r\n    });\r\n\r\n    if (stockStatus === 'lowStock') {\r\n      formattedProducts = formattedProducts.filter((p: any) => p.quantity > 0 && p.quantity <= p.minimumStock);\r\n    }\r\n\r\n    return { products: formattedProducts as any[], count: totalCount };\r\n  } catch (error) {\r\n    console.error('Error fetching products from DB:', error);\r\n    return { products: [], count: 0 };\r\n  }\r\n}\r\n\r\nexport async function getProductsByIdsAction(ids: string[], businessId?: string) {\r\n  try {\r\n    const where: any = {\r\n      id: { in: ids }\r\n    };\r\n    if (businessId) {\r\n      where.branchId = businessId;\r\n    }\r\n\r\n    const products = await db.product.findMany({\r\n      where,\r\n      include: {\r\n        category: true,\r\n        supplier: true,\r\n      }\r\n    });\r\n\r\n    return products.map((p: any) => ({\r\n      id: p.id,\r\n      name: p.name,\r\n      description: p.description || '',\r\n      category: p.category?.name || 'Uncategorized',\r\n      quantity: p.stock,\r\n      costPrice: p.costPrice,\r\n      sellingPrice: p.sellingPrice,\r\n      supplier: p.supplier?.name,\r\n      imageUrl: p.image,\r\n      barcode: p.barcode,\r\n      itemNumber: p.sku || '',\r\n      minimumStock: p.minStock,\r\n      createdAt: p.createdAt,\r\n    }));\r\n  } catch (error) {\r\n    console.error('Error fetching products by ids:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function createProductAction(data: any) {\r\n  try {\r\n    const result = await db.$transaction(async (tx: any) => {\r\n      // 1. Generate next SKU/itemNumber for this branch\r\n      const lastProduct = await tx.product.findFirst({\r\n        where: { branchId: data.businessId },\r\n        orderBy: { sku: 'desc' },\r\n        select: { sku: true }\r\n      });\r\n\r\n      let nextSku = \"PROD-0001\";\r\n      if (lastProduct && lastProduct.sku) {\r\n        const currentNumber = parseInt(lastProduct.sku.replace(\"PROD-\", \"\")) || 0;\r\n        nextSku = `PROD-${(currentNumber + 1).toString().padStart(4, '0')}`;\r\n      }\r\n\r\n      // 2. Create the product\r\n      const product = await tx.product.create({\r\n        data: {\r\n          name: data.name,\r\n          description: data.description,\r\n          branchId: data.businessId,\r\n          userId: data.userId,\r\n          categoryId: data.categoryId || null,\r\n          supplierId: data.supplierId || null,\r\n          sku: nextSku,\r\n          barcode: data.barcode,\r\n          image: data.imageUrl,\r\n          costPrice: data.costPrice || 0,\r\n          sellingPrice: data.sellingPrice || 0,\r\n          stock: data.quantity || 0,\r\n          minStock: data.minimumStock || 0,\r\n          createdAt: data.createdAt ? new Date(data.createdAt) : new Date(),\r\n        },\r\n        include: {\r\n          category: true,\r\n          supplier: true,\r\n        }\r\n      });\r\n\r\n      // 3. Create initial stock history if quantity > 0\r\n      if (data.quantity > 0) {\r\n        await tx.productHistory.create({\r\n          data: {\r\n            userId: data.userId,\r\n            locationId: data.businessId,\r\n            productId: product.id,\r\n            previousQuantity: 0,\r\n            newQuantity: data.quantity,\r\n            changeReason: `[${product.name}] | Initial stock`,\r\n            createdAt: data.createdAt ? new Date(data.createdAt) : new Date(),\r\n          }\r\n        });\r\n      }\r\n\r\n      return product;\r\n    });\r\n\r\n    return {\r\n      id: result.id,\r\n      name: result.name,\r\n      description: result.description || '',\r\n      category: result.category?.name || 'Uncategorized',\r\n      quantity: result.stock,\r\n      costPrice: result.costPrice,\r\n      sellingPrice: result.sellingPrice,\r\n      supplier: result.supplier?.name,\r\n      imageUrl: result.image,\r\n      barcode: result.barcode,\r\n      itemNumber: result.sku || '',\r\n      minimumStock: result.minStock,\r\n      createdAt: result.createdAt,\r\n    };\r\n  } catch (error) {\r\n    console.error('Error creating product:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function updateProductAction(id: string, updates: any) {\r\n  try {\r\n    const result = await db.$transaction(async (tx: any) => {\r\n      // 1. Get current product state\r\n      const current = await tx.product.findUnique({\r\n        where: { id },\r\n        select: { stock: true, name: true }\r\n      });\r\n\r\n      if (!current) throw new Error(\"Product not found\");\r\n\r\n      // 2. Perform update\r\n      const updated = await tx.product.update({\r\n        where: { id },\r\n        data: {\r\n          name: updates.name,\r\n          description: updates.description,\r\n          categoryId: updates.categoryId !== undefined ? updates.categoryId : undefined,\r\n          supplierId: updates.supplierId !== undefined ? updates.supplierId : undefined,\r\n          sku: updates.itemNumber || updates.sku,\r\n          barcode: updates.barcode,\r\n          image: updates.imageUrl,\r\n          costPrice: updates.costPrice,\r\n          sellingPrice: updates.sellingPrice,\r\n          stock: updates.quantity,\r\n          minStock: updates.minimumStock,\r\n        }\r\n      });\r\n\r\n      // 3. Create history if quantity changed\r\n      if (updates.quantity !== undefined && updates.quantity !== current.stock && updates.customChangeReason !== 'skip-history') {\r\n        let changeReason = updates.customChangeReason;\r\n        if (!changeReason) {\r\n          if (updates.isFromSale) changeReason = \"Sale\";\r\n          else if (updates.quantity > current.stock) changeReason = \"Manual stock addition\";\r\n          else changeReason = \"Manual stock reduction\";\r\n        }\r\n\r\n        const snapshottedReason = `[${updated.name}] | ${changeReason}`;\r\n\r\n        await tx.productHistory.create({\r\n          data: {\r\n            userId: updates.userId,\r\n            locationId: updates.businessId,\r\n            productId: updated.id,\r\n            previousQuantity: current.stock,\r\n            newQuantity: updates.quantity,\r\n            changeReason: snapshottedReason,\r\n            referenceId: updates.referenceId || null,\r\n          }\r\n        });\r\n      }\r\n\r\n      return updated;\r\n    });\r\n\r\n    return result;\r\n  } catch (error) {\r\n    console.error('Error updating product:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function deleteProductAction(id: string) {\r\n  try {\r\n    await db.product.delete({\r\n      where: { id }\r\n    });\r\n    // revalidatePath('/inventory/products');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error deleting product:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport async function updateProductsBulkAction(\r\n  updates: Array<{ id: string; updated: Partial<any> }>,\r\n  businessId: string\r\n) {\r\n  try {\r\n    // Prisma transaction for bulk updates\r\n    const updatePromises = updates.map(u =>\r\n      db.product.update({\r\n        where: { id: u.id },\r\n        data: {\r\n          ...(u.updated.name && { name: u.updated.name }),\r\n          ...(u.updated.description !== undefined && { description: u.updated.description }),\r\n          ...(u.updated.categoryId !== undefined && { categoryId: u.updated.categoryId }),\r\n          ...(u.updated.supplierId !== undefined && { supplierId: u.updated.supplierId }),\r\n          ...(u.updated.sku !== undefined && { sku: u.updated.sku }),\r\n          ...(u.updated.barcode !== undefined && { barcode: u.updated.barcode }),\r\n          ...(u.updated.costPrice !== undefined && { costPrice: u.updated.costPrice }),\r\n          ...(u.updated.sellingPrice !== undefined && { sellingPrice: u.updated.sellingPrice }),\r\n          ...(u.updated.quantity !== undefined && { stock: u.updated.quantity }),\r\n          ...(u.updated.minimumStock !== undefined && { minStock: u.updated.minimumStock }),\r\n        }\r\n      })\r\n    );\r\n\r\n    await db.$transaction(updatePromises);\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error performing bulk update:', error);\r\n    return false;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MA+NsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,uDAAA"}},
    {"offset": {"line": 3486, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/products.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { db } from '../../../prisma/db';\r\nimport { Product, ProductFormData, mapDbProductToProduct, mapProductToDbProduct } from '@/types';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// We implement server actions for the products here\r\n\r\nexport async function getProductsAction({\r\n  userId,\r\n  businessId,\r\n  page,\r\n  pageSize,\r\n  search,\r\n  category,\r\n  stockStatus,\r\n}: {\r\n  userId: string;\r\n  businessId: string;\r\n  page: number;\r\n  pageSize: number;\r\n  search?: string;\r\n  category?: string;\r\n  stockStatus?: 'inStock' | 'outOfStock' | 'lowStock' | 'all';\r\n}) {\r\n  if (!userId || !businessId) return { products: [], count: 0 };\r\n\r\n  const skip = (page - 1) * pageSize;\r\n  const take = pageSize;\r\n\r\n  let whereClause: any = {\r\n    userId: userId,\r\n    branchId: businessId,\r\n  };\r\n\r\n  if (search) {\r\n    whereClause.OR = [\r\n      { name: { contains: search, mode: 'insensitive' } },\r\n      { description: { contains: search, mode: 'insensitive' } },\r\n      { sku: { contains: search, mode: 'insensitive' } },\r\n      { barcode: { contains: search, mode: 'insensitive' } },\r\n    ];\r\n  }\r\n\r\n  if (category) {\r\n    whereClause.category = { name: category };\r\n  }\r\n\r\n  if (stockStatus === 'outOfStock') {\r\n    whereClause.stock = 0;\r\n  } else if (stockStatus === 'inStock') {\r\n    whereClause.stock = { gt: 0 };\r\n  } else if (stockStatus === 'lowStock') {\r\n    // Handling lowStock is complex because minStock is compared locally or using direct SQL in Prisma\r\n    // For now, we will handle it with Prisma's raw query or by filtering in memory if necessary\r\n    // Fortunately, since PRISMA 5.0, column comparison still needs raw queries or we can fetch and filter if small\r\n    // Here we'll fetch them all if lowStock is enabled, or add a generated column. \r\n    // We will do a basic fetch and filter later if needed.\r\n  }\r\n\r\n  try {\r\n    const [productsData, totalCount] = await Promise.all([\r\n      db.product.findMany({\r\n        where: whereClause,\r\n        skip,\r\n        take,\r\n        orderBy: [{ createdAt: 'desc' }, { id: 'desc' }],\r\n        include: {\r\n          category: true,\r\n          supplier: true,\r\n        }\r\n      }),\r\n      db.product.count({ where: whereClause })\r\n    ]);\r\n\r\n    // Map the Prisma product model back to the application's Product type\r\n    let formattedProducts = productsData.map((p: any) => {\r\n      // Assuming mapping exists, we will map it\r\n      return {\r\n        id: p.id,\r\n        name: p.name,\r\n        description: p.description || '',\r\n        category: p.category?.name || 'Uncategorized',\r\n        quantity: p.stock,\r\n        costPrice: p.costPrice,\r\n        sellingPrice: p.sellingPrice,\r\n        supplier: p.supplier?.name,\r\n        imageUrl: p.image,\r\n        barcode: p.barcode,\r\n        itemNumber: p.sku || '',\r\n        minimumStock: p.minStock,\r\n        createdAt: p.createdAt,\r\n      };\r\n    });\r\n\r\n    if (stockStatus === 'lowStock') {\r\n      formattedProducts = formattedProducts.filter((p: any) => p.quantity > 0 && p.quantity <= p.minimumStock);\r\n    }\r\n\r\n    return { products: formattedProducts as any[], count: totalCount };\r\n  } catch (error) {\r\n    console.error('Error fetching products from DB:', error);\r\n    return { products: [], count: 0 };\r\n  }\r\n}\r\n\r\nexport async function getProductsByIdsAction(ids: string[], businessId?: string) {\r\n  try {\r\n    const where: any = {\r\n      id: { in: ids }\r\n    };\r\n    if (businessId) {\r\n      where.branchId = businessId;\r\n    }\r\n\r\n    const products = await db.product.findMany({\r\n      where,\r\n      include: {\r\n        category: true,\r\n        supplier: true,\r\n      }\r\n    });\r\n\r\n    return products.map((p: any) => ({\r\n      id: p.id,\r\n      name: p.name,\r\n      description: p.description || '',\r\n      category: p.category?.name || 'Uncategorized',\r\n      quantity: p.stock,\r\n      costPrice: p.costPrice,\r\n      sellingPrice: p.sellingPrice,\r\n      supplier: p.supplier?.name,\r\n      imageUrl: p.image,\r\n      barcode: p.barcode,\r\n      itemNumber: p.sku || '',\r\n      minimumStock: p.minStock,\r\n      createdAt: p.createdAt,\r\n    }));\r\n  } catch (error) {\r\n    console.error('Error fetching products by ids:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function createProductAction(data: any) {\r\n  try {\r\n    const result = await db.$transaction(async (tx: any) => {\r\n      // 1. Generate next SKU/itemNumber for this branch\r\n      const lastProduct = await tx.product.findFirst({\r\n        where: { branchId: data.businessId },\r\n        orderBy: { sku: 'desc' },\r\n        select: { sku: true }\r\n      });\r\n\r\n      let nextSku = \"PROD-0001\";\r\n      if (lastProduct && lastProduct.sku) {\r\n        const currentNumber = parseInt(lastProduct.sku.replace(\"PROD-\", \"\")) || 0;\r\n        nextSku = `PROD-${(currentNumber + 1).toString().padStart(4, '0')}`;\r\n      }\r\n\r\n      // 2. Create the product\r\n      const product = await tx.product.create({\r\n        data: {\r\n          name: data.name,\r\n          description: data.description,\r\n          branchId: data.businessId,\r\n          userId: data.userId,\r\n          categoryId: data.categoryId || null,\r\n          supplierId: data.supplierId || null,\r\n          sku: nextSku,\r\n          barcode: data.barcode,\r\n          image: data.imageUrl,\r\n          costPrice: data.costPrice || 0,\r\n          sellingPrice: data.sellingPrice || 0,\r\n          stock: data.quantity || 0,\r\n          minStock: data.minimumStock || 0,\r\n          createdAt: data.createdAt ? new Date(data.createdAt) : new Date(),\r\n        },\r\n        include: {\r\n          category: true,\r\n          supplier: true,\r\n        }\r\n      });\r\n\r\n      // 3. Create initial stock history if quantity > 0\r\n      if (data.quantity > 0) {\r\n        await tx.productHistory.create({\r\n          data: {\r\n            userId: data.userId,\r\n            locationId: data.businessId,\r\n            productId: product.id,\r\n            previousQuantity: 0,\r\n            newQuantity: data.quantity,\r\n            changeReason: `[${product.name}] | Initial stock`,\r\n            createdAt: data.createdAt ? new Date(data.createdAt) : new Date(),\r\n          }\r\n        });\r\n      }\r\n\r\n      return product;\r\n    });\r\n\r\n    return {\r\n      id: result.id,\r\n      name: result.name,\r\n      description: result.description || '',\r\n      category: result.category?.name || 'Uncategorized',\r\n      quantity: result.stock,\r\n      costPrice: result.costPrice,\r\n      sellingPrice: result.sellingPrice,\r\n      supplier: result.supplier?.name,\r\n      imageUrl: result.image,\r\n      barcode: result.barcode,\r\n      itemNumber: result.sku || '',\r\n      minimumStock: result.minStock,\r\n      createdAt: result.createdAt,\r\n    };\r\n  } catch (error) {\r\n    console.error('Error creating product:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function updateProductAction(id: string, updates: any) {\r\n  try {\r\n    const result = await db.$transaction(async (tx: any) => {\r\n      // 1. Get current product state\r\n      const current = await tx.product.findUnique({\r\n        where: { id },\r\n        select: { stock: true, name: true }\r\n      });\r\n\r\n      if (!current) throw new Error(\"Product not found\");\r\n\r\n      // 2. Perform update\r\n      const updated = await tx.product.update({\r\n        where: { id },\r\n        data: {\r\n          name: updates.name,\r\n          description: updates.description,\r\n          categoryId: updates.categoryId !== undefined ? updates.categoryId : undefined,\r\n          supplierId: updates.supplierId !== undefined ? updates.supplierId : undefined,\r\n          sku: updates.itemNumber || updates.sku,\r\n          barcode: updates.barcode,\r\n          image: updates.imageUrl,\r\n          costPrice: updates.costPrice,\r\n          sellingPrice: updates.sellingPrice,\r\n          stock: updates.quantity,\r\n          minStock: updates.minimumStock,\r\n        }\r\n      });\r\n\r\n      // 3. Create history if quantity changed\r\n      if (updates.quantity !== undefined && updates.quantity !== current.stock && updates.customChangeReason !== 'skip-history') {\r\n        let changeReason = updates.customChangeReason;\r\n        if (!changeReason) {\r\n          if (updates.isFromSale) changeReason = \"Sale\";\r\n          else if (updates.quantity > current.stock) changeReason = \"Manual stock addition\";\r\n          else changeReason = \"Manual stock reduction\";\r\n        }\r\n\r\n        const snapshottedReason = `[${updated.name}] | ${changeReason}`;\r\n\r\n        await tx.productHistory.create({\r\n          data: {\r\n            userId: updates.userId,\r\n            locationId: updates.businessId,\r\n            productId: updated.id,\r\n            previousQuantity: current.stock,\r\n            newQuantity: updates.quantity,\r\n            changeReason: snapshottedReason,\r\n            referenceId: updates.referenceId || null,\r\n          }\r\n        });\r\n      }\r\n\r\n      return updated;\r\n    });\r\n\r\n    return result;\r\n  } catch (error) {\r\n    console.error('Error updating product:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function deleteProductAction(id: string) {\r\n  try {\r\n    await db.product.delete({\r\n      where: { id }\r\n    });\r\n    // revalidatePath('/inventory/products');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error deleting product:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport async function updateProductsBulkAction(\r\n  updates: Array<{ id: string; updated: Partial<any> }>,\r\n  businessId: string\r\n) {\r\n  try {\r\n    // Prisma transaction for bulk updates\r\n    const updatePromises = updates.map(u =>\r\n      db.product.update({\r\n        where: { id: u.id },\r\n        data: {\r\n          ...(u.updated.name && { name: u.updated.name }),\r\n          ...(u.updated.description !== undefined && { description: u.updated.description }),\r\n          ...(u.updated.categoryId !== undefined && { categoryId: u.updated.categoryId }),\r\n          ...(u.updated.supplierId !== undefined && { supplierId: u.updated.supplierId }),\r\n          ...(u.updated.sku !== undefined && { sku: u.updated.sku }),\r\n          ...(u.updated.barcode !== undefined && { barcode: u.updated.barcode }),\r\n          ...(u.updated.costPrice !== undefined && { costPrice: u.updated.costPrice }),\r\n          ...(u.updated.sellingPrice !== undefined && { sellingPrice: u.updated.sellingPrice }),\r\n          ...(u.updated.quantity !== undefined && { stock: u.updated.quantity }),\r\n          ...(u.updated.minimumStock !== undefined && { minStock: u.updated.minimumStock }),\r\n        }\r\n      })\r\n    );\r\n\r\n    await db.$transaction(updatePromises);\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error performing bulk update:', error);\r\n    return false;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MA8RsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,uDAAA"}},
    {"offset": {"line": 3503, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/app/actions/products.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { db } from '../../../prisma/db';\r\nimport { Product, ProductFormData, mapDbProductToProduct, mapProductToDbProduct } from '@/types';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// We implement server actions for the products here\r\n\r\nexport async function getProductsAction({\r\n  userId,\r\n  businessId,\r\n  page,\r\n  pageSize,\r\n  search,\r\n  category,\r\n  stockStatus,\r\n}: {\r\n  userId: string;\r\n  businessId: string;\r\n  page: number;\r\n  pageSize: number;\r\n  search?: string;\r\n  category?: string;\r\n  stockStatus?: 'inStock' | 'outOfStock' | 'lowStock' | 'all';\r\n}) {\r\n  if (!userId || !businessId) return { products: [], count: 0 };\r\n\r\n  const skip = (page - 1) * pageSize;\r\n  const take = pageSize;\r\n\r\n  let whereClause: any = {\r\n    userId: userId,\r\n    branchId: businessId,\r\n  };\r\n\r\n  if (search) {\r\n    whereClause.OR = [\r\n      { name: { contains: search, mode: 'insensitive' } },\r\n      { description: { contains: search, mode: 'insensitive' } },\r\n      { sku: { contains: search, mode: 'insensitive' } },\r\n      { barcode: { contains: search, mode: 'insensitive' } },\r\n    ];\r\n  }\r\n\r\n  if (category) {\r\n    whereClause.category = { name: category };\r\n  }\r\n\r\n  if (stockStatus === 'outOfStock') {\r\n    whereClause.stock = 0;\r\n  } else if (stockStatus === 'inStock') {\r\n    whereClause.stock = { gt: 0 };\r\n  } else if (stockStatus === 'lowStock') {\r\n    // Handling lowStock is complex because minStock is compared locally or using direct SQL in Prisma\r\n    // For now, we will handle it with Prisma's raw query or by filtering in memory if necessary\r\n    // Fortunately, since PRISMA 5.0, column comparison still needs raw queries or we can fetch and filter if small\r\n    // Here we'll fetch them all if lowStock is enabled, or add a generated column. \r\n    // We will do a basic fetch and filter later if needed.\r\n  }\r\n\r\n  try {\r\n    const [productsData, totalCount] = await Promise.all([\r\n      db.product.findMany({\r\n        where: whereClause,\r\n        skip,\r\n        take,\r\n        orderBy: [{ createdAt: 'desc' }, { id: 'desc' }],\r\n        include: {\r\n          category: true,\r\n          supplier: true,\r\n        }\r\n      }),\r\n      db.product.count({ where: whereClause })\r\n    ]);\r\n\r\n    // Map the Prisma product model back to the application's Product type\r\n    let formattedProducts = productsData.map((p: any) => {\r\n      // Assuming mapping exists, we will map it\r\n      return {\r\n        id: p.id,\r\n        name: p.name,\r\n        description: p.description || '',\r\n        category: p.category?.name || 'Uncategorized',\r\n        quantity: p.stock,\r\n        costPrice: p.costPrice,\r\n        sellingPrice: p.sellingPrice,\r\n        supplier: p.supplier?.name,\r\n        imageUrl: p.image,\r\n        barcode: p.barcode,\r\n        itemNumber: p.sku || '',\r\n        minimumStock: p.minStock,\r\n        createdAt: p.createdAt,\r\n      };\r\n    });\r\n\r\n    if (stockStatus === 'lowStock') {\r\n      formattedProducts = formattedProducts.filter((p: any) => p.quantity > 0 && p.quantity <= p.minimumStock);\r\n    }\r\n\r\n    return { products: formattedProducts as any[], count: totalCount };\r\n  } catch (error) {\r\n    console.error('Error fetching products from DB:', error);\r\n    return { products: [], count: 0 };\r\n  }\r\n}\r\n\r\nexport async function getProductsByIdsAction(ids: string[], businessId?: string) {\r\n  try {\r\n    const where: any = {\r\n      id: { in: ids }\r\n    };\r\n    if (businessId) {\r\n      where.branchId = businessId;\r\n    }\r\n\r\n    const products = await db.product.findMany({\r\n      where,\r\n      include: {\r\n        category: true,\r\n        supplier: true,\r\n      }\r\n    });\r\n\r\n    return products.map((p: any) => ({\r\n      id: p.id,\r\n      name: p.name,\r\n      description: p.description || '',\r\n      category: p.category?.name || 'Uncategorized',\r\n      quantity: p.stock,\r\n      costPrice: p.costPrice,\r\n      sellingPrice: p.sellingPrice,\r\n      supplier: p.supplier?.name,\r\n      imageUrl: p.image,\r\n      barcode: p.barcode,\r\n      itemNumber: p.sku || '',\r\n      minimumStock: p.minStock,\r\n      createdAt: p.createdAt,\r\n    }));\r\n  } catch (error) {\r\n    console.error('Error fetching products by ids:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function createProductAction(data: any) {\r\n  try {\r\n    const result = await db.$transaction(async (tx: any) => {\r\n      // 1. Generate next SKU/itemNumber for this branch\r\n      const lastProduct = await tx.product.findFirst({\r\n        where: { branchId: data.businessId },\r\n        orderBy: { sku: 'desc' },\r\n        select: { sku: true }\r\n      });\r\n\r\n      let nextSku = \"PROD-0001\";\r\n      if (lastProduct && lastProduct.sku) {\r\n        const currentNumber = parseInt(lastProduct.sku.replace(\"PROD-\", \"\")) || 0;\r\n        nextSku = `PROD-${(currentNumber + 1).toString().padStart(4, '0')}`;\r\n      }\r\n\r\n      // 2. Create the product\r\n      const product = await tx.product.create({\r\n        data: {\r\n          name: data.name,\r\n          description: data.description,\r\n          branchId: data.businessId,\r\n          userId: data.userId,\r\n          categoryId: data.categoryId || null,\r\n          supplierId: data.supplierId || null,\r\n          sku: nextSku,\r\n          barcode: data.barcode,\r\n          image: data.imageUrl,\r\n          costPrice: data.costPrice || 0,\r\n          sellingPrice: data.sellingPrice || 0,\r\n          stock: data.quantity || 0,\r\n          minStock: data.minimumStock || 0,\r\n          createdAt: data.createdAt ? new Date(data.createdAt) : new Date(),\r\n        },\r\n        include: {\r\n          category: true,\r\n          supplier: true,\r\n        }\r\n      });\r\n\r\n      // 3. Create initial stock history if quantity > 0\r\n      if (data.quantity > 0) {\r\n        await tx.productHistory.create({\r\n          data: {\r\n            userId: data.userId,\r\n            locationId: data.businessId,\r\n            productId: product.id,\r\n            previousQuantity: 0,\r\n            newQuantity: data.quantity,\r\n            changeReason: `[${product.name}] | Initial stock`,\r\n            createdAt: data.createdAt ? new Date(data.createdAt) : new Date(),\r\n          }\r\n        });\r\n      }\r\n\r\n      return product;\r\n    });\r\n\r\n    return {\r\n      id: result.id,\r\n      name: result.name,\r\n      description: result.description || '',\r\n      category: result.category?.name || 'Uncategorized',\r\n      quantity: result.stock,\r\n      costPrice: result.costPrice,\r\n      sellingPrice: result.sellingPrice,\r\n      supplier: result.supplier?.name,\r\n      imageUrl: result.image,\r\n      barcode: result.barcode,\r\n      itemNumber: result.sku || '',\r\n      minimumStock: result.minStock,\r\n      createdAt: result.createdAt,\r\n    };\r\n  } catch (error) {\r\n    console.error('Error creating product:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function updateProductAction(id: string, updates: any) {\r\n  try {\r\n    const result = await db.$transaction(async (tx: any) => {\r\n      // 1. Get current product state\r\n      const current = await tx.product.findUnique({\r\n        where: { id },\r\n        select: { stock: true, name: true }\r\n      });\r\n\r\n      if (!current) throw new Error(\"Product not found\");\r\n\r\n      // 2. Perform update\r\n      const updated = await tx.product.update({\r\n        where: { id },\r\n        data: {\r\n          name: updates.name,\r\n          description: updates.description,\r\n          categoryId: updates.categoryId !== undefined ? updates.categoryId : undefined,\r\n          supplierId: updates.supplierId !== undefined ? updates.supplierId : undefined,\r\n          sku: updates.itemNumber || updates.sku,\r\n          barcode: updates.barcode,\r\n          image: updates.imageUrl,\r\n          costPrice: updates.costPrice,\r\n          sellingPrice: updates.sellingPrice,\r\n          stock: updates.quantity,\r\n          minStock: updates.minimumStock,\r\n        }\r\n      });\r\n\r\n      // 3. Create history if quantity changed\r\n      if (updates.quantity !== undefined && updates.quantity !== current.stock && updates.customChangeReason !== 'skip-history') {\r\n        let changeReason = updates.customChangeReason;\r\n        if (!changeReason) {\r\n          if (updates.isFromSale) changeReason = \"Sale\";\r\n          else if (updates.quantity > current.stock) changeReason = \"Manual stock addition\";\r\n          else changeReason = \"Manual stock reduction\";\r\n        }\r\n\r\n        const snapshottedReason = `[${updated.name}] | ${changeReason}`;\r\n\r\n        await tx.productHistory.create({\r\n          data: {\r\n            userId: updates.userId,\r\n            locationId: updates.businessId,\r\n            productId: updated.id,\r\n            previousQuantity: current.stock,\r\n            newQuantity: updates.quantity,\r\n            changeReason: snapshottedReason,\r\n            referenceId: updates.referenceId || null,\r\n          }\r\n        });\r\n      }\r\n\r\n      return updated;\r\n    });\r\n\r\n    return result;\r\n  } catch (error) {\r\n    console.error('Error updating product:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function deleteProductAction(id: string) {\r\n  try {\r\n    await db.product.delete({\r\n      where: { id }\r\n    });\r\n    // revalidatePath('/inventory/products');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error deleting product:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport async function updateProductsBulkAction(\r\n  updates: Array<{ id: string; updated: Partial<any> }>,\r\n  businessId: string\r\n) {\r\n  try {\r\n    // Prisma transaction for bulk updates\r\n    const updatePromises = updates.map(u =>\r\n      db.product.update({\r\n        where: { id: u.id },\r\n        data: {\r\n          ...(u.updated.name && { name: u.updated.name }),\r\n          ...(u.updated.description !== undefined && { description: u.updated.description }),\r\n          ...(u.updated.categoryId !== undefined && { categoryId: u.updated.categoryId }),\r\n          ...(u.updated.supplierId !== undefined && { supplierId: u.updated.supplierId }),\r\n          ...(u.updated.sku !== undefined && { sku: u.updated.sku }),\r\n          ...(u.updated.barcode !== undefined && { barcode: u.updated.barcode }),\r\n          ...(u.updated.costPrice !== undefined && { costPrice: u.updated.costPrice }),\r\n          ...(u.updated.sellingPrice !== undefined && { sellingPrice: u.updated.sellingPrice }),\r\n          ...(u.updated.quantity !== undefined && { stock: u.updated.quantity }),\r\n          ...(u.updated.minimumStock !== undefined && { minStock: u.updated.minimumStock }),\r\n        }\r\n      })\r\n    );\r\n\r\n    await db.$transaction(updatePromises);\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error performing bulk update:', error);\r\n    return false;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;MA2SsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,4DAAA"}},
    {"offset": {"line": 3520, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/hooks/useProducts.ts"],"sourcesContent":["import { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { Product, ProductFormData, ProductFilters } from '@/types';\r\nimport { useBusinessSettings } from './useBusinessSettings';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport { clearInventoryCaches } from '@/utils/inventoryCacheUtils';\r\n\r\n// Import our new Server Actions\r\nimport {\r\n  getProductsAction,\r\n  createProductAction,\r\n  updateProductAction,\r\n  deleteProductAction,\r\n  updateProductsBulkAction\r\n} from '@/app/actions/products';\r\n\r\nexport const useProducts = (userId: string | undefined, initialPageSize: number = 50) => {\r\n  const [products, setProducts] = useState<Product[]>([]);\r\n  const [page, setPage] = useState(1);\r\n  const [pageSize, setPageSize] = useState(initialPageSize);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const { settings } = useBusinessSettings();\r\n  const { currentBusiness } = useBusiness();\r\n  const queryClient = useQueryClient();\r\n\r\n  const [filters, setFilters] = useState<ProductFilters>({\r\n    search: '',\r\n    category: 'all',\r\n    stockStatus: 'all'\r\n  });\r\n\r\n  const [typingTimer, setTypingTimer] = useState<NodeJS.Timeout | null>(null);\r\n\r\n  const setFiltersWithTypingState = useCallback((newFilters: ProductFilters) => {\r\n    if (newFilters.search !== filters.search) {\r\n      setIsTyping(true);\r\n      if (typingTimer) clearTimeout(typingTimer);\r\n      const timer = setTimeout(() => {\r\n        setIsTyping(false);\r\n      }, 600);\r\n      setTypingTimer(timer);\r\n    }\r\n    setFilters(newFilters);\r\n  }, [filters.search, typingTimer]);\r\n\r\n  // Use Server Action instead of Supabase\r\n  const loadProducts = useCallback(async (): Promise<{ products: Product[], count: number }> => {\r\n    if (!userId || !currentBusiness) {\r\n      return { products: [], count: 0 };\r\n    }\r\n\r\n    try {\r\n      // Server Action call\r\n      const result = await getProductsAction({\r\n        userId,\r\n        businessId: currentBusiness.id,\r\n        page,\r\n        pageSize,\r\n        search: filters.search,\r\n        category: filters.category === 'all' ? undefined : filters.category,\r\n        stockStatus: filters.stockStatus,\r\n      });\r\n      return result as { products: Product[], count: number };\r\n    } catch (error) {\r\n      console.error('Error loading products from server action:', error);\r\n      return { products: [], count: 0 };\r\n    }\r\n  }, [userId, currentBusiness?.id, page, pageSize, filters.search, filters.category, filters.stockStatus]);\r\n\r\n  const baseQueryKey = useMemo(() => ['products', userId, currentBusiness?.id], [userId, currentBusiness?.id]);\r\n  const queryKey = useMemo(() => [...baseQueryKey, page, pageSize, filters.search, filters.category, filters.stockStatus], [baseQueryKey, page, pageSize, filters.search, filters.category, filters.stockStatus]);\r\n\r\n  const { data: queriedData, isLoading: isQueryLoading, isFetching, refetch } = useQuery({\r\n    queryKey,\r\n    queryFn: loadProducts,\r\n    enabled: !!userId && !!currentBusiness?.id,\r\n    staleTime: 30_000,\r\n    gcTime: 30 * 60_000,\r\n    refetchOnWindowFocus: true,\r\n    refetchOnReconnect: true,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (queriedData) {\r\n      setProducts(queriedData.products);\r\n      setTotalCount(queriedData.count);\r\n    }\r\n  }, [queriedData]);\r\n\r\n  const isLoading = (isQueryLoading && !queriedData) && !isTyping;\r\n\r\n  // Supabase Storage remains untouched since Prisma doesn't do file storage\r\n  // but we isolate it here.\r\n  const uploadProductImage = async (imageFile: File): Promise<string | null> => {\r\n    try {\r\n      if (!userId) return null;\r\n      const fileExt = imageFile.name.split('.').pop();\r\n      const fileName = `${Date.now()}.${fileExt}`;\r\n      const filePath = `${userId}/${fileName}`;\r\n\r\n      const { error: uploadError } = await supabase.storage\r\n        .from('product-images')\r\n        .upload(filePath, imageFile, { upsert: true });\r\n\r\n      if (uploadError) {\r\n        console.error('Error uploading image:', uploadError);\r\n        return null;\r\n      }\r\n\r\n      const { data: { publicUrl } } = supabase.storage\r\n        .from('product-images')\r\n        .getPublicUrl(filePath);\r\n\r\n      return publicUrl;\r\n    } catch (error) {\r\n      console.error('Error in uploadProductImage:', error);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const createProduct = async (productData: ProductFormData): Promise<Product | null> => {\r\n    try {\r\n      if (!userId || !currentBusiness) return null;\r\n\r\n      const result = await createProductAction({\r\n        ...productData,\r\n        userId,\r\n        businessId: currentBusiness.id\r\n      });\r\n\r\n      if (!result) return null;\r\n\r\n      const newProduct = result as Product;\r\n\r\n      setProducts(prev => [newProduct, ...prev]);\r\n      setTotalCount(c => c + 1);\r\n\r\n      queryClient.invalidateQueries({ queryKey: baseQueryKey });\r\n      clearInventoryCaches(queryClient);\r\n\r\n      return newProduct;\r\n    } catch (error) {\r\n      console.error('Error creating product:', error);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const updateProduct = async (\r\n    id: string,\r\n    updates: Partial<Product>,\r\n    imageFile?: File | null,\r\n    isFromSale = false,\r\n    customChangeReason?: string,\r\n    adjustmentDate?: Date,\r\n    referenceId?: string,\r\n    receiptNumber?: string\r\n  ): Promise<boolean> => {\r\n    try {\r\n      if (!userId || !currentBusiness) return false;\r\n\r\n      let imageUrl = updates.imageUrl;\r\n      if (imageFile) {\r\n        imageUrl = await uploadProductImage(imageFile);\r\n      }\r\n\r\n      const result = await updateProductAction(id, {\r\n        ...updates,\r\n        imageUrl,\r\n        userId,\r\n        businessId: currentBusiness.id,\r\n        isFromSale,\r\n        customChangeReason,\r\n        referenceId\r\n      });\r\n\r\n      if (!result) return false;\r\n\r\n      queryClient.invalidateQueries({ queryKey: baseQueryKey });\r\n      clearInventoryCaches(queryClient);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error updating product:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const deleteProduct = async (id: string): Promise<boolean> => {\r\n    try {\r\n      if (!userId) return false;\r\n\r\n      const success = await deleteProductAction(id);\r\n\r\n      if (success) {\r\n        queryClient.invalidateQueries({ queryKey: baseQueryKey });\r\n        clearInventoryCaches(queryClient);\r\n        return true;\r\n      }\r\n      return false;\r\n    } catch (error) {\r\n      console.error('Error deleting product:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const updateProductsBulk = async (\r\n    updates: Array<{ id: string; updated: Partial<Product>; imageFile?: File | null }>,\r\n    userIdForHistory?: string,\r\n    changeReason?: string,\r\n    referenceId?: string,\r\n    adjustmentDate?: Date,\r\n    receiptNumber?: string\r\n  ): Promise<boolean> => {\r\n    try {\r\n      if (!userId || !currentBusiness) return false;\r\n\r\n      const success = await updateProductsBulkAction(\r\n        updates.map(u => ({ id: u.id, updated: u.updated })),\r\n        currentBusiness.id\r\n      );\r\n\r\n      if (success) {\r\n        queryClient.invalidateQueries({ queryKey: baseQueryKey });\r\n        clearInventoryCaches(queryClient);\r\n      }\r\n\r\n      return success;\r\n    } catch (error) {\r\n      console.error('Error in bulk update:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  return {\r\n    products,\r\n    isLoading,\r\n    loadProducts,\r\n    page,\r\n    setPage,\r\n    pageSize,\r\n    setPageSize,\r\n    totalCount,\r\n    createProduct,\r\n    updateProduct,\r\n    updateProductsBulk,\r\n    deleteProduct,\r\n    uploadProductImage,\r\n    refetch,\r\n    isFetching,\r\n    filters,\r\n    setFilters: setFiltersWithTypingState,\r\n  };\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3809, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/exportProductsForUpdate.ts"],"sourcesContent":["\r\nimport { Product } from '@/types';\r\n\r\nexport const exportProductsForUpdate = (products: Product[]): void => {\r\n  // Define CSV header - simplified for updates, no currency symbols\r\n  const headers = [\r\n    'Item Number',\r\n    'Name',\r\n    'Category',\r\n    'Quantity',\r\n    'Cost Price',\r\n    'Selling Price',\r\n    'Supplier',\r\n    'Description'\r\n  ];\r\n  \r\n  // Create rows for each product - only editable fields\r\n  const rows = products.map(product => {\r\n    return [\r\n      product.itemNumber,\r\n      product.name,\r\n      product.category,\r\n      product.quantity.toString(),\r\n      product.costPrice.toString(),\r\n      product.sellingPrice.toString(),\r\n      product.supplier || '',\r\n      product.description || ''\r\n    ];\r\n  });\r\n  \r\n  // Combine header and rows\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))\r\n  ].join('\\n');\r\n\r\n  // Create a direct download using data URL\r\n  const dataUrl = `data:text/csv;charset=utf-8,${encodeURIComponent(csvContent)}`;\r\n  const filename = `products_for_update_${new Date().toISOString().slice(0, 10)}.csv`;\r\n  \r\n  // Create and trigger download\r\n  const link = document.createElement('a');\r\n  link.href = dataUrl;\r\n  link.download = filename;\r\n  link.style.display = 'none';\r\n  \r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n};\r\n"],"names":[],"mappings":";;;;AAGO,MAAM,0BAA0B,CAAC;IACtC,kEAAkE;IAClE,MAAM,UAAU;QACd;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,sDAAsD;IACtD,MAAM,OAAO,SAAS,GAAG,CAAC,CAAA;QACxB,OAAO;YACL,QAAQ,UAAU;YAClB,QAAQ,IAAI;YACZ,QAAQ,QAAQ;YAChB,QAAQ,QAAQ,CAAC,QAAQ;YACzB,QAAQ,SAAS,CAAC,QAAQ;YAC1B,QAAQ,YAAY,CAAC,QAAQ;YAC7B,QAAQ,QAAQ,IAAI;YACpB,QAAQ,WAAW,IAAI;SACxB;IACH;IAEA,0BAA0B;IAC1B,MAAM,aAAa;QACjB,QAAQ,IAAI,CAAC;WACV,KAAK,GAAG,CAAC,CAAA,MAAO,IAAI,GAAG,CAAC,CAAA,OAAQ,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC;KACtD,CAAC,IAAI,CAAC;IAEP,0CAA0C;IAC1C,MAAM,UAAU,CAAC,4BAA4B,EAAE,mBAAmB,aAAa;IAC/E,MAAM,WAAW,CAAC,oBAAoB,EAAE,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC;IAEnF,8BAA8B;IAC9B,MAAM,OAAO,SAAS,aAAa,CAAC;IACpC,KAAK,IAAI,GAAG;IACZ,KAAK,QAAQ,GAAG;IAChB,KAAK,KAAK,CAAC,OAAO,GAAG;IAErB,SAAS,IAAI,CAAC,WAAW,CAAC;IAC1B,KAAK,KAAK;IACV,SAAS,IAAI,CAAC,WAAW,CAAC;AAC5B"}},
    {"offset": {"line": 3862, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/exportProductsToCSV.ts"],"sourcesContent":["\r\nimport { Product, BusinessSettings } from '@/types';\r\n\r\nexport const exportProductsToCSV = (products: Product[]): void => {\r\n  // Get currency from business settings\r\n  const savedSettings = localStorage.getItem('businessSettings');\r\n  const settings: BusinessSettings = savedSettings \r\n    ? JSON.parse(savedSettings)\r\n    : { currency: 'USD' };\r\n\r\n  // Define CSV header - ADDED Item Number\r\n  const headers = [\r\n    'Item Number',\r\n    'Name',\r\n    'Category',\r\n    'Quantity',\r\n    'Minimum Stock',\r\n    `Cost Price (${settings.currency})`,\r\n    `Selling Price (${settings.currency})`,\r\n    'Supplier',\r\n    'Description',\r\n    'Created Date',\r\n    'Last Updated'\r\n  ];\r\n  \r\n  // Create rows for each product - ADDED Item Number\r\n  const rows = products.map(product => {\r\n    return [\r\n      product.itemNumber,\r\n      product.name,\r\n      product.category,\r\n      product.quantity.toString(),\r\n      product.minimumStock.toString(),\r\n      product.costPrice.toFixed(2),\r\n      product.sellingPrice.toFixed(2),\r\n      product.supplier || 'N/A',\r\n      product.description ? product.description.replace(/,/g, ';').replace(/\\n/g, ' ') : 'N/A',\r\n      new Date(product.createdAt).toLocaleDateString(),\r\n      new Date(product.updatedAt).toLocaleDateString()\r\n    ];\r\n  });\r\n  \r\n  // Combine header and rows\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...rows.map(row => row.join(','))\r\n  ].join('\\n');\r\n\r\n  // Create a direct download using data URL\r\n  const dataUrl = `data:text/csv;charset=utf-8,${encodeURIComponent(csvContent)}`;\r\n  const filename = `products_${new Date().toISOString().slice(0, 10)}.csv`;\r\n  \r\n  // Create and trigger download\r\n  const link = document.createElement('a');\r\n  link.href = dataUrl;\r\n  link.download = filename;\r\n  link.style.display = 'none';\r\n  \r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n};\r\n"],"names":[],"mappings":";;;;AAGO,MAAM,sBAAsB,CAAC;IAClC,sCAAsC;IACtC,MAAM,gBAAgB,aAAa,OAAO,CAAC;IAC3C,MAAM,WAA6B,gBAC/B,KAAK,KAAK,CAAC,iBACX;QAAE,UAAU;IAAM;IAEtB,wCAAwC;IACxC,MAAM,UAAU;QACd;QACA;QACA;QACA;QACA;QACA,CAAC,YAAY,EAAE,SAAS,QAAQ,CAAC,CAAC,CAAC;QACnC,CAAC,eAAe,EAAE,SAAS,QAAQ,CAAC,CAAC,CAAC;QACtC;QACA;QACA;QACA;KACD;IAED,mDAAmD;IACnD,MAAM,OAAO,SAAS,GAAG,CAAC,CAAA;QACxB,OAAO;YACL,QAAQ,UAAU;YAClB,QAAQ,IAAI;YACZ,QAAQ,QAAQ;YAChB,QAAQ,QAAQ,CAAC,QAAQ;YACzB,QAAQ,YAAY,CAAC,QAAQ;YAC7B,QAAQ,SAAS,CAAC,OAAO,CAAC;YAC1B,QAAQ,YAAY,CAAC,OAAO,CAAC;YAC7B,QAAQ,QAAQ,IAAI;YACpB,QAAQ,WAAW,GAAG,QAAQ,WAAW,CAAC,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,OAAO,OAAO;YACnF,IAAI,KAAK,QAAQ,SAAS,EAAE,kBAAkB;YAC9C,IAAI,KAAK,QAAQ,SAAS,EAAE,kBAAkB;SAC/C;IACH;IAEA,0BAA0B;IAC1B,MAAM,aAAa;QACjB,QAAQ,IAAI,CAAC;WACV,KAAK,GAAG,CAAC,CAAA,MAAO,IAAI,IAAI,CAAC;KAC7B,CAAC,IAAI,CAAC;IAEP,0CAA0C;IAC1C,MAAM,UAAU,CAAC,4BAA4B,EAAE,mBAAmB,aAAa;IAC/E,MAAM,WAAW,CAAC,SAAS,EAAE,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC;IAExE,8BAA8B;IAC9B,MAAM,OAAO,SAAS,aAAa,CAAC;IACpC,KAAK,IAAI,GAAG;IACZ,KAAK,QAAQ,GAAG;IAChB,KAAK,KAAK,CAAC,OAAO,GAAG;IAErB,SAAS,IAAI,CAAC,WAAW,CAAC;IAC1B,KAAK,KAAK;IACV,SAAS,IAAI,CAAC,WAAW,CAAC;AAC5B"}},
    {"offset": {"line": 3926, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/exportProductsToPDF.ts"],"sourcesContent":["\r\nimport { Product } from '@/types';\r\nimport jsPDF from 'jspdf';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport { BusinessSettings } from '@/hooks/useBusinessSettings';\r\n\r\nexport const exportProductsToPDF = (products: Product[], businessSettings?: BusinessSettings): void => {\r\n  // Use provided business settings or fallback to defaults\r\n  const settings = businessSettings || {\r\n    businessName: 'Your Business',\r\n    businessAddress: 'Business Address',\r\n    businessPhone: '(123) 456-7890',\r\n    businessEmail: 'support@yourbusiness.com',\r\n    currency: 'USD'\r\n  };\r\n\r\n  // Create new PDF document in portrait orientation\r\n  const pdf = new jsPDF({\r\n    orientation: 'portrait',\r\n    unit: 'mm',\r\n    format: 'a4',\r\n    compress: true\r\n  });\r\n\r\n  const pageWidth = pdf.internal.pageSize.getWidth();\r\n  const pageHeight = pdf.internal.pageSize.getHeight();\r\n  const margins = { top: 10, right: 10, bottom: 10, left: 10 };\r\n  const contentWidth = pageWidth - margins.left - margins.right;\r\n\r\n  let currentY = margins.top;\r\n\r\n  // Function to add watermark to current page\r\n  const addWatermark = () => {\r\n    pdf.setFontSize(8);\r\n    pdf.setFont('helvetica', 'normal');\r\n    pdf.setTextColor(150, 150, 150); // Light gray color\r\n    pdf.text('Created By Gonza Systems', pageWidth / 2, pageHeight - 10, { align: 'center' });\r\n    pdf.setTextColor(0, 0, 0); // Reset to black\r\n  };\r\n\r\n  // Optimized table setup with better column widths for more content\r\n  const colWidths = [20, 55, 30, 25, 25, 25]; // Item #, Name, Category, Qty, Cost, Price\r\n  const rowHeight = 6;\r\n  const headerHeight = 8;\r\n\r\n  // Table headers\r\n  const headers = [\r\n    'Item #',\r\n    'Product Name',\r\n    'Category',\r\n    'Qty',\r\n    `Cost (${settings.currency})`,\r\n    `Price (${settings.currency})`\r\n  ];\r\n\r\n  // Function to draw table headers\r\n  const drawTableHeaders = () => {\r\n    // Draw header background\r\n    pdf.setFillColor(243, 244, 246);\r\n    pdf.rect(margins.left, currentY - 1, contentWidth, headerHeight, 'F');\r\n\r\n    // Draw header borders\r\n    pdf.setLineWidth(0.2);\r\n    pdf.rect(margins.left, currentY - 1, contentWidth, headerHeight);\r\n\r\n    // Header text\r\n    pdf.setFontSize(8);\r\n    pdf.setFont('helvetica', 'bold');\r\n    let currentX = margins.left;\r\n\r\n    headers.forEach((header, index) => {\r\n      const colWidth = colWidths[index];\r\n      const textWidth = pdf.getTextWidth(header);\r\n      const textX = currentX + (colWidth - textWidth) / 2;\r\n      pdf.text(header, textX, currentY + 5);\r\n\r\n      if (index < headers.length - 1) {\r\n        pdf.line(currentX + colWidth, currentY - 1, currentX + colWidth, currentY + headerHeight - 1);\r\n      }\r\n\r\n      currentX += colWidth;\r\n    });\r\n\r\n    currentY += headerHeight;\r\n  };\r\n\r\n  // Helper function to check if we need a new page\r\n  const checkPageBreak = (neededHeight: number) => {\r\n    if (currentY + neededHeight > pageHeight - margins.bottom - 15) { // Reserve space for watermark\r\n      addWatermark(); // Add watermark to current page before creating new one\r\n      pdf.addPage();\r\n      currentY = margins.top;\r\n      drawTableHeaders();\r\n      pdf.setFont('helvetica', 'normal');\r\n      pdf.setFontSize(7);\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  // Business header - made smaller\r\n  pdf.setFontSize(14);\r\n  pdf.setFont('helvetica', 'bold');\r\n  const businessName = settings.businessName || 'Your Business';\r\n  const businessNameWidth = pdf.getTextWidth(businessName);\r\n  pdf.text(businessName, (pageWidth - businessNameWidth) / 2, currentY);\r\n  currentY += 4;\r\n\r\n  // Business address - smaller\r\n  if (settings.businessAddress) {\r\n    pdf.setFontSize(9);\r\n    pdf.setFont('helvetica', 'normal');\r\n    const addressWidth = pdf.getTextWidth(settings.businessAddress);\r\n    pdf.text(settings.businessAddress, (pageWidth - addressWidth) / 2, currentY);\r\n    currentY += 3;\r\n  }\r\n\r\n  // Business contact info - smaller\r\n  if (settings.businessPhone || settings.businessEmail) {\r\n    pdf.setFontSize(8);\r\n    const contactInfo = [settings.businessPhone, settings.businessEmail].filter(Boolean).join(' | ');\r\n    const contactWidth = pdf.getTextWidth(contactInfo);\r\n    pdf.text(contactInfo, (pageWidth - contactWidth) / 2, currentY);\r\n    currentY += 3;\r\n  }\r\n\r\n  currentY += 3;\r\n\r\n  // Report title - smaller\r\n  pdf.setFontSize(12);\r\n  pdf.setFont('helvetica', 'bold');\r\n  const title = `Products Inventory Report`;\r\n  const titleWidth = pdf.getTextWidth(title);\r\n  pdf.text(title, (pageWidth - titleWidth) / 2, currentY);\r\n  currentY += 4;\r\n\r\n  // Generation date - smaller\r\n  pdf.setFontSize(8);\r\n  pdf.setFont('helvetica', 'normal');\r\n  const currentDate = new Date().toLocaleDateString();\r\n  const dateText = `Generated on ${currentDate}`;\r\n  const dateWidth = pdf.getTextWidth(dateText);\r\n  pdf.text(dateText, (pageWidth - dateWidth) / 2, currentY);\r\n  currentY += 6;\r\n\r\n  // Summary statistics - smaller and more compact\r\n  const totalProducts = products.length;\r\n  const lowStockProducts = products.filter(p => p.quantity > 0 && p.quantity <= p.minimumStock).length;\r\n  const outOfStockProducts = products.filter(p => p.quantity === 0).length;\r\n  const totalInventoryValue = products.reduce((sum, product) => sum + (product.costPrice * product.quantity), 0);\r\n\r\n  // Compact summary box\r\n  const summaryBoxHeight = 15;\r\n  pdf.setFillColor(248, 249, 250);\r\n  pdf.rect(margins.left, currentY - 2, contentWidth, summaryBoxHeight, 'F');\r\n  pdf.setLineWidth(0.2);\r\n  pdf.setDrawColor(200, 200, 200);\r\n  pdf.rect(margins.left, currentY - 2, contentWidth, summaryBoxHeight);\r\n\r\n  // Summary content - more compact\r\n  pdf.setFontSize(9);\r\n  pdf.setFont('helvetica', 'bold');\r\n  pdf.text('Inventory Summary', margins.left + 5, currentY + 2);\r\n\r\n  pdf.setFontSize(7);\r\n  pdf.setFont('helvetica', 'normal');\r\n  const summaryData = [\r\n    `Total: ${totalProducts}`,\r\n    `Low Stock: ${lowStockProducts}`,\r\n    `Out of Stock: ${outOfStockProducts}`,\r\n    `Total Value: ${settings.currency} ${formatNumber(totalInventoryValue)}`\r\n  ];\r\n\r\n  let summaryY = currentY + 6;\r\n  summaryData.forEach((item, index) => {\r\n    const xPos = margins.left + 5 + (index % 2) * (contentWidth / 2);\r\n    if (index === 2) summaryY += 3;\r\n    pdf.text(item, xPos, summaryY + Math.floor(index / 2) * 3);\r\n  });\r\n\r\n  currentY += summaryBoxHeight + 4;\r\n\r\n  // Draw initial table headers\r\n  checkPageBreak(headerHeight + 5);\r\n  drawTableHeaders();\r\n\r\n  // Table data with smaller font - use products as provided (already sorted)\r\n  pdf.setFont('helvetica', 'normal');\r\n  pdf.setFontSize(7);\r\n\r\n  products.forEach((product, index) => {\r\n    checkPageBreak(rowHeight + 2);\r\n\r\n    const rowData = [\r\n      product.itemNumber || '',\r\n      product.name || '',\r\n      product.category || '',\r\n      product.quantity.toString(),\r\n      formatNumber(product.costPrice),\r\n      formatNumber(product.sellingPrice)\r\n    ];\r\n\r\n    // Draw row background (alternating)\r\n    if (index % 2 === 0) {\r\n      pdf.setFillColor(249, 250, 251);\r\n      pdf.rect(margins.left, currentY - 1, contentWidth, rowHeight, 'F');\r\n    }\r\n\r\n    // Highlight low stock and out of stock items\r\n    if (product.quantity === 0) {\r\n      pdf.setFillColor(254, 226, 226); // red background\r\n      pdf.rect(margins.left, currentY - 1, contentWidth, rowHeight, 'F');\r\n    } else if (product.quantity <= product.minimumStock) {\r\n      pdf.setFillColor(254, 243, 199); // yellow background\r\n      pdf.rect(margins.left, currentY - 1, contentWidth, rowHeight, 'F');\r\n    }\r\n\r\n    // Draw row borders\r\n    pdf.setLineWidth(0.1);\r\n    pdf.rect(margins.left, currentY - 1, contentWidth, rowHeight);\r\n\r\n    let currentX = margins.left;\r\n\r\n    rowData.forEach((data, colIndex) => {\r\n      const colWidth = colWidths[colIndex];\r\n      let text = data;\r\n\r\n      // Truncate text if too long - more aggressive truncation\r\n      if (colIndex === 1) { // Product name column\r\n        while (pdf.getTextWidth(text) > colWidth - 3 && text.length > 3) {\r\n          text = text.substring(0, text.length - 4) + '...';\r\n        }\r\n      } else if (colIndex === 2) { // Category column\r\n        while (pdf.getTextWidth(text) > colWidth - 3 && text.length > 3) {\r\n          text = text.substring(0, text.length - 4) + '...';\r\n        }\r\n      }\r\n\r\n      let textX = currentX + 1.5;\r\n\r\n      // Right align quantity and price columns\r\n      if (colIndex >= 3) {\r\n        const textWidth = pdf.getTextWidth(text);\r\n        textX = currentX + colWidth - textWidth - 1.5;\r\n      }\r\n\r\n      pdf.setTextColor(0, 0, 0);\r\n      pdf.text(text, textX, currentY + 3.5);\r\n\r\n      if (colIndex < rowData.length - 1) {\r\n        pdf.line(currentX + colWidth, currentY - 1, currentX + colWidth, currentY + rowHeight - 1);\r\n      }\r\n\r\n      currentX += colWidth;\r\n    });\r\n\r\n    currentY += rowHeight;\r\n  });\r\n\r\n  // Footer - smaller\r\n  currentY += 5;\r\n  checkPageBreak(10);\r\n\r\n  pdf.setFontSize(7);\r\n  pdf.setFont('helvetica', 'italic');\r\n  pdf.setTextColor(100, 100, 100);\r\n  const footerText = `This report contains ${products.length} products. Generated by ${settings.businessName || 'Inventory System'}`;\r\n  const footerWidth = pdf.getTextWidth(footerText);\r\n  pdf.text(footerText, (pageWidth - footerWidth) / 2, currentY);\r\n\r\n  // Add watermark to the final page\r\n  addWatermark();\r\n\r\n  // Save the PDF\r\n  const filename = `products-inventory-${new Date().toISOString().slice(0, 10)}.pdf`;\r\n  pdf.save(filename);\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4183, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/progress.tsx"],"sourcesContent":["\r\nimport * as React from \"react\"\r\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Progress = React.forwardRef<\r\n  React.ElementRef<typeof ProgressPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\r\n>(({ className, value, ...props }, ref) => (\r\n  <ProgressPrimitive.Root\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative h-4 w-full overflow-hidden rounded-full bg-gray-200\",\r\n      className\r\n    )}\r\n    {...props}\r\n  >\r\n    <ProgressPrimitive.Indicator\r\n      className=\"h-full w-full flex-1 transition-all\"\r\n      style={{ \r\n        transform: `translateX(-${100 - (value || 0)}%)`,\r\n        backgroundColor: \"#16a34a\"\r\n      }}\r\n    />\r\n  </ProgressPrimitive.Root>\r\n))\r\nProgress.displayName = ProgressPrimitive.Root.displayName\r\n\r\nexport { Progress }\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,OAAO,EAAE,oBACjC,6LAAC,+KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,gEACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,oLAA2B;YAC1B,WAAU;YACV,OAAO;gBACL,WAAW,CAAC,YAAY,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC;gBAChD,iBAAiB;YACnB;;;;;;;;;;;;AAIN,SAAS,WAAW,GAAG,+KAAsB,CAAC,WAAW"}},
    {"offset": {"line": 4228, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/BulkOperationProgress.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { CheckCircle, AlertCircle, Info } from 'lucide-react';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\n\r\ninterface BulkOperationProgressProps {\r\n    title: string;\r\n    currentCount: number;\r\n    totalCount: number;\r\n    status: 'processing' | 'completed' | 'failed';\r\n    successCount?: number;\r\n    failureCount?: number;\r\n    onClose?: () => void;\r\n}\r\n\r\nexport const BulkOperationProgress: React.FC<BulkOperationProgressProps> = ({\r\n    title,\r\n    currentCount,\r\n    totalCount,\r\n    status,\r\n    successCount,\r\n    failureCount,\r\n}) => {\r\n    const progressPercentage = Math.round((currentCount / totalCount) * 100);\r\n\r\n    return (\r\n        <div className=\"space-y-6 py-4\">\r\n            {status === 'processing' && (\r\n                <Alert>\r\n                    <Info className=\"h-4 w-4\" />\r\n                    <AlertDescription>\r\n                        <strong>Please do not close this tab or dialog until the process is complete.</strong>\r\n                    </AlertDescription>\r\n                </Alert>\r\n            )}\r\n\r\n            <div className=\"text-center space-y-4\">\r\n                {status === 'processing' ? (\r\n                    <div className=\"mx-auto h-12 w-12 animate-spin rounded-full border-4 border-muted border-t-primary\"></div>\r\n                ) : status === 'completed' ? (\r\n                    <CheckCircle className=\"mx-auto h-12 w-12 text-green-500\" />\r\n                ) : (\r\n                    <AlertCircle className=\"mx-auto h-12 w-12 text-destructive\" />\r\n                )}\r\n\r\n                <div>\r\n                    <h3 className=\"text-lg font-semibold\">{title}</h3>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                        {status === 'processing'\r\n                            ? `Processing item ${currentCount} of ${totalCount}`\r\n                            : status === 'completed'\r\n                                ? `Successfully processed ${successCount ?? totalCount} items${failureCount ? `, ${failureCount} failed` : ''}`\r\n                                : 'The operation failed to complete.'\r\n                        }\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between text-xs font-medium text-muted-foreground\">\r\n                    <span>Progress</span>\r\n                    <span>{progressPercentage}%</span>\r\n                </div>\r\n                <Progress value={progressPercentage} className=\"h-2 w-full\" />\r\n            </div>\r\n\r\n            {(successCount !== undefined || failureCount !== undefined) && status === 'completed' && (\r\n                <div className=\"grid grid-cols-2 gap-4 pt-2\">\r\n                    <div className=\"bg-green-50 border border-green-100 rounded-lg p-3 text-center\">\r\n                        <div className=\"text-xl font-bold text-green-700\">{successCount ?? 0}</div>\r\n                        <div className=\"text-xs text-green-600 font-medium\">Successful</div>\r\n                    </div>\r\n                    <div className=\"bg-red-50 border border-red-100 rounded-lg p-3 text-center\">\r\n                        <div className=\"text-xl font-bold text-red-700\">{failureCount ?? 0}</div>\r\n                        <div className=\"text-xs text-red-600 font-medium\">Failed</div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AAAA;AACA;;;;;AAYO,MAAM,wBAA8D,CAAC,EACxE,KAAK,EACL,YAAY,EACZ,UAAU,EACV,MAAM,EACN,YAAY,EACZ,YAAY,EACf;IACG,MAAM,qBAAqB,KAAK,KAAK,CAAC,AAAC,eAAe,aAAc;IAEpE,qBACI,6LAAC;QAAI,WAAU;;YACV,WAAW,8BACR,6LAAC,6IAAK;;kCACF,6LAAC,6MAAI;wBAAC,WAAU;;;;;;kCAChB,6LAAC,wJAAgB;kCACb,cAAA,6LAAC;sCAAO;;;;;;;;;;;;;;;;;0BAKpB,6LAAC;gBAAI,WAAU;;oBACV,WAAW,6BACR,6LAAC;wBAAI,WAAU;;;;;mEACf,WAAW,4BACX,6LAAC,6OAAW;wBAAC,WAAU;;;;;iFAEvB,6LAAC,sOAAW;wBAAC,WAAU;;;;;;kCAG3B,6LAAC;;0CACG,6LAAC;gCAAG,WAAU;0CAAyB;;;;;;0CACvC,6LAAC;gCAAE,WAAU;0CACR,WAAW,eACN,CAAC,gBAAgB,EAAE,aAAa,IAAI,EAAE,YAAY,GAClD,WAAW,cACP,CAAC,uBAAuB,EAAE,gBAAgB,WAAW,MAAM,EAAE,eAAe,CAAC,EAAE,EAAE,aAAa,OAAO,CAAC,GAAG,IAAI,GAC7G;;;;;;;;;;;;;;;;;;0BAMtB,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;0CAAK;;;;;;0CACN,6LAAC;;oCAAM;oCAAmB;;;;;;;;;;;;;kCAE9B,6LAAC,mJAAQ;wBAAC,OAAO;wBAAoB,WAAU;;;;;;;;;;;;YAGlD,CAAC,iBAAiB,aAAa,iBAAiB,SAAS,KAAK,WAAW,6BACtE,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,WAAU;0CAAoC,gBAAgB;;;;;;0CACnE,6LAAC;gCAAI,WAAU;0CAAqC;;;;;;;;;;;;kCAExD,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,WAAU;0CAAkC,gBAAgB;;;;;;0CACjE,6LAAC;gCAAI,WAAU;0CAAmC;;;;;;;;;;;;;;;;;;;;;;;;AAM1E;KAjEa"}},
    {"offset": {"line": 4446, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/BulkDeleteDialog.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Product } from '@/types';\r\nimport { BulkOperationProgress } from './BulkOperationProgress';\r\n\r\ninterface BulkDeleteDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  selectedProducts: Product[];\r\n  onConfirm: () => void;\r\n  isDeleting: boolean;\r\n  deletionProgress?: {\r\n    current: number;\r\n    total: number;\r\n  };\r\n}\r\n\r\nconst BulkDeleteDialog: React.FC<BulkDeleteDialogProps> = ({\r\n  open,\r\n  onOpenChange,\r\n  selectedProducts,\r\n  onConfirm,\r\n  isDeleting,\r\n  deletionProgress\r\n}) => {\r\n  const progressPercentage = deletionProgress\r\n    ? Math.round((deletionProgress.current / deletionProgress.total) * 100)\r\n    : 0;\r\n\r\n  // Prevent dialog from closing during deletion process\r\n  const handleOpenChange = (newOpen: boolean) => {\r\n    if (!isDeleting) {\r\n      onOpenChange(newOpen);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleOpenChange}>\r\n      <DialogContent className=\"pointer-events-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle>Delete Selected Products</DialogTitle>\r\n          <DialogDescription>\r\n            Are you sure you want to delete {selectedProducts.length} product{selectedProducts.length > 1 ? 's' : ''}?\r\n            This action cannot be undone.\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"max-h-40 overflow-y-auto\">\r\n          <div className=\"space-y-1\">\r\n            {selectedProducts.map((product) => (\r\n              <div key={product.id} className=\"text-sm text-muted-foreground\">\r\n                • {product.name}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Progress Bar */}\r\n        {isDeleting && deletionProgress && (\r\n          <BulkOperationProgress\r\n            title=\"Deleting Products...\"\r\n            currentCount={deletionProgress.current}\r\n            totalCount={deletionProgress.total}\r\n            status=\"processing\"\r\n          />\r\n        )}\r\n\r\n        <DialogFooter>\r\n          <Button\r\n            variant=\"outline\"\r\n            onClick={() => handleOpenChange(false)}\r\n            disabled={isDeleting}\r\n          >\r\n            Cancel\r\n          </Button>\r\n          <Button\r\n            variant=\"destructive\"\r\n            onClick={onConfirm}\r\n            disabled={isDeleting}\r\n          >\r\n            {isDeleting ? `Deleting... (${progressPercentage}%)` : `Delete ${selectedProducts.length} Product${selectedProducts.length > 1 ? 's' : ''}`}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default BulkDeleteDialog;\r\n"],"names":[],"mappings":";;;;;AAEA;AAQA;AAGA;;;;;AAcA,MAAM,mBAAoD,CAAC,EACzD,IAAI,EACJ,YAAY,EACZ,gBAAgB,EAChB,SAAS,EACT,UAAU,EACV,gBAAgB,EACjB;IACC,MAAM,qBAAqB,mBACvB,KAAK,KAAK,CAAC,AAAC,iBAAiB,OAAO,GAAG,iBAAiB,KAAK,GAAI,OACjE;IAEJ,sDAAsD;IACtD,MAAM,mBAAmB,CAAC;QACxB,IAAI,CAAC,YAAY;YACf,aAAa;QACf;IACF;IAEA,qBACE,6LAAC,+IAAM;QAAC,MAAM;QAAM,cAAc;kBAChC,cAAA,6LAAC,sJAAa;YAAC,WAAU;;8BACvB,6LAAC,qJAAY;;sCACX,6LAAC,oJAAW;sCAAC;;;;;;sCACb,6LAAC,0JAAiB;;gCAAC;gCACgB,iBAAiB,MAAM;gCAAC;gCAAS,iBAAiB,MAAM,GAAG,IAAI,MAAM;gCAAG;;;;;;;;;;;;;8BAK7G,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAI,WAAU;kCACZ,iBAAiB,GAAG,CAAC,CAAC,wBACrB,6LAAC;gCAAqB,WAAU;;oCAAgC;oCAC3D,QAAQ,IAAI;;+BADP,QAAQ,EAAE;;;;;;;;;;;;;;;gBAQzB,cAAc,kCACb,6LAAC,oLAAqB;oBACpB,OAAM;oBACN,cAAc,iBAAiB,OAAO;oBACtC,YAAY,iBAAiB,KAAK;oBAClC,QAAO;;;;;;8BAIX,6LAAC,qJAAY;;sCACX,6LAAC,+IAAM;4BACL,SAAQ;4BACR,SAAS,IAAM,iBAAiB;4BAChC,UAAU;sCACX;;;;;;sCAGD,6LAAC,+IAAM;4BACL,SAAQ;4BACR,SAAS;4BACT,UAAU;sCAET,aAAa,CAAC,aAAa,EAAE,mBAAmB,EAAE,CAAC,GAAG,CAAC,OAAO,EAAE,iBAAiB,MAAM,CAAC,QAAQ,EAAE,iBAAiB,MAAM,GAAG,IAAI,MAAM,IAAI;;;;;;;;;;;;;;;;;;;;;;;AAMvJ;KArEM;uCAuES"}},
    {"offset": {"line": 4586, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/csvParser.ts"],"sourcesContent":["\r\nexport interface CSVProductRow {\r\n  'Product Name': string;\r\n  'Category': string;\r\n  'Description': string;\r\n  'Supplier': string;\r\n  'Creation Date': string;\r\n  'Initial Stock': string;\r\n  'Minimum Stock Level': string;\r\n  'Cost Price': string;\r\n  'Selling Price': string;\r\n  'Manufacturer Barcode'?: string;\r\n}\r\n\r\nexport interface CSVTransactionRow {\r\n  'Date': string;\r\n  'Type': string;\r\n  'Amount': string;\r\n  'Description': string;\r\n  'Category': string;\r\n  'Payment Method'?: string;\r\n  'Person In Charge'?: string;\r\n  'To Account'?: string;\r\n}\r\n\r\nexport interface CSVExpenseRow {\r\n  'Date': string;\r\n  'Amount': string;\r\n  'Description': string;\r\n  'Category': string;\r\n  'Payment Method'?: string;\r\n  'Person In Charge'?: string;\r\n  'Link to Finance'?: string; // 'true' or 'false'\r\n  'Finance Account'?: string; // Account name\r\n}\r\n\r\nexport interface ValidationError {\r\n  row: number;\r\n  field: string;\r\n  message: string;\r\n}\r\n\r\nexport interface ParsedCSVResult {\r\n  validRows: CSVProductRow[];\r\n  errors: ValidationError[];\r\n  totalRows: number;\r\n}\r\n\r\n// Proper CSV parser that handles quoted fields with commas\r\nconst parseCSVLine = (line: string): string[] => {\r\n  const result: string[] = [];\r\n  let current = '';\r\n  let inQuotes = false;\r\n  let i = 0;\r\n\r\n  while (i < line.length) {\r\n    const char = line[i];\r\n    const nextChar = line[i + 1];\r\n\r\n    if (char === '\"') {\r\n      if (inQuotes && nextChar === '\"') {\r\n        // Escaped quote - add single quote to current field\r\n        current += '\"';\r\n        i += 2; // Skip both quotes\r\n        continue;\r\n      } else {\r\n        // Toggle quote state\r\n        inQuotes = !inQuotes;\r\n      }\r\n    } else if (char === ',' && !inQuotes) {\r\n      // Field separator - push current field and reset\r\n      result.push(current.trim());\r\n      current = '';\r\n    } else {\r\n      // Regular character - add to current field\r\n      current += char;\r\n    }\r\n\r\n    i++;\r\n  }\r\n\r\n  // Push the last field\r\n  result.push(current.trim());\r\n  return result;\r\n};\r\n\r\nexport const parseCSV = (csvText: string): ParsedCSVResult => {\r\n  const lines = csvText.trim().split('\\n');\r\n  const headers = parseCSVLine(lines[0]).map(h => h.trim());\r\n\r\n  const validRows: CSVProductRow[] = [];\r\n  const errors: ValidationError[] = [];\r\n\r\n  for (let i = 1; i < lines.length; i++) {\r\n    const values = parseCSVLine(lines[i]).map(v => v.trim());\r\n    const row: any = {};\r\n\r\n    // Map values to headers\r\n    headers.forEach((header, index) => {\r\n      row[header] = values[index] || '';\r\n    });\r\n\r\n    // Validate required fields\r\n    const rowErrors = validateCSVRow(row, i + 1);\r\n\r\n    if (rowErrors.length === 0) {\r\n      validRows.push(row as CSVProductRow);\r\n    } else {\r\n      errors.push(...rowErrors);\r\n    }\r\n  }\r\n\r\n  return {\r\n    validRows,\r\n    errors,\r\n    totalRows: lines.length - 1\r\n  };\r\n};\r\n\r\nexport interface ParsedTransactionCSVResult {\r\n  validRows: CSVTransactionRow[];\r\n  errors: ValidationError[];\r\n  totalRows: number;\r\n}\r\n\r\nexport const parseTransactionCSV = (csvText: string): ParsedTransactionCSVResult => {\r\n  const lines = csvText.trim().split('\\n');\r\n  if (lines.length < 1) return { validRows: [], errors: [], totalRows: 0 };\r\n\r\n  const headers = parseCSVLine(lines[0]).map(h => h.trim());\r\n\r\n  const validRows: CSVTransactionRow[] = [];\r\n  const errors: ValidationError[] = [];\r\n\r\n  for (let i = 1; i < lines.length; i++) {\r\n    if (!lines[i].trim()) continue;\r\n\r\n    const values = parseCSVLine(lines[i]).map(v => v.trim());\r\n    const row: any = {};\r\n\r\n    // Map values to headers\r\n    headers.forEach((header, index) => {\r\n      row[header] = values[index] || '';\r\n    });\r\n\r\n    // Validate required fields\r\n    const rowErrors = validateTransactionCSVRow(row, i + 1);\r\n\r\n    if (rowErrors.length === 0) {\r\n      validRows.push(row as CSVTransactionRow);\r\n    } else {\r\n      errors.push(...rowErrors);\r\n    }\r\n  }\r\n\r\n  return {\r\n    validRows,\r\n    errors,\r\n    totalRows: lines.length - 1\r\n  };\r\n};\r\n\r\nexport interface ParsedExpenseCSVResult {\r\n  validRows: CSVExpenseRow[];\r\n  errors: ValidationError[];\r\n  totalRows: number;\r\n}\r\n\r\nexport const parseExpenseCSV = (csvText: string): ParsedExpenseCSVResult => {\r\n  const lines = csvText.trim().split('\\n');\r\n  if (lines.length < 1) return { validRows: [], errors: [], totalRows: 0 };\r\n\r\n  const headers = parseCSVLine(lines[0]).map(h => h.trim());\r\n\r\n  const validRows: CSVExpenseRow[] = [];\r\n  const errors: ValidationError[] = [];\r\n\r\n  for (let i = 1; i < lines.length; i++) {\r\n    if (!lines[i].trim()) continue;\r\n\r\n    const values = parseCSVLine(lines[i]).map(v => v.trim());\r\n    const row: any = {};\r\n\r\n    // Map values to headers\r\n    headers.forEach((header, index) => {\r\n      row[header] = values[index] || '';\r\n    });\r\n\r\n    // Validate required fields\r\n    const rowErrors = validateExpenseCSVRow(row, i + 1);\r\n\r\n    if (rowErrors.length === 0) {\r\n      validRows.push(row as CSVExpenseRow);\r\n    } else {\r\n      errors.push(...rowErrors);\r\n    }\r\n  }\r\n\r\n  return {\r\n    validRows,\r\n    errors,\r\n    totalRows: lines.length - 1\r\n  };\r\n};\r\n\r\nconst validateCSVRow = (row: any, rowNumber: number): ValidationError[] => {\r\n  const errors: ValidationError[] = [];\r\n\r\n  // Only validate that Product Name is present\r\n  if (!row['Product Name']?.trim()) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Product Name',\r\n      message: 'Product Name is required'\r\n    });\r\n  }\r\n\r\n  return errors;\r\n};\r\n\r\nexport const validateTransactionCSVRow = (row: any, rowNumber: number): ValidationError[] => {\r\n  const errors: ValidationError[] = [];\r\n\r\n  if (!row['Amount'] || isNaN(Number(row['Amount'])) || Number(row['Amount']) <= 0) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Amount',\r\n      message: 'Amount must be a positive number'\r\n    });\r\n  }\r\n\r\n  if (!row['Type'] || !['cash_in', 'cash_out', 'transfer'].includes(row['Type'].toLowerCase())) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Type',\r\n      message: 'Type must be \"cash_in\", \"cash_out\", or \"transfer\"'\r\n    });\r\n  }\r\n\r\n  if (!row['Description']?.trim()) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Description',\r\n      message: 'Description is required'\r\n    });\r\n  }\r\n\r\n  if (row['Type']?.toLowerCase() === 'transfer' && !row['To Account']) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'To Account',\r\n      message: 'To Account is required for transfers'\r\n    });\r\n  }\r\n\r\n  return errors;\r\n};\r\n\r\nexport const validateExpenseCSVRow = (row: any, rowNumber: number): ValidationError[] => {\r\n  const errors: ValidationError[] = [];\r\n\r\n  if (!row['Amount'] || isNaN(Number(row['Amount'])) || Number(row['Amount']) <= 0) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Amount',\r\n      message: 'Amount must be a positive number'\r\n    });\r\n  }\r\n\r\n  if (!row['Description']?.trim()) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Description',\r\n      message: 'Description is required'\r\n    });\r\n  }\r\n\r\n  const linkToFinance = row['Link to Finance']?.toString().toLowerCase();\r\n  if (linkToFinance === 'true' && !row['Finance Account']?.trim()) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Finance Account',\r\n      message: 'Finance Account is required when Link to Finance is true'\r\n    });\r\n  }\r\n\r\n  return errors;\r\n};\r\n\r\nexport const generateErrorLogCSV = (errors: ValidationError[], filename: string = 'upload_errors.csv') => {\r\n  const headers = ['Row', 'Field', 'Error Message'];\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...errors.map(error =>\r\n      [error.row, error.field, `\"${error.message}\"`].join(',')\r\n    )\r\n  ].join('\\n');\r\n\r\n  const blob = new Blob([csvContent], { type: 'text/csv' });\r\n  const url = window.URL.createObjectURL(blob);\r\n  const link = document.createElement('a');\r\n  link.href = url;\r\n  link.download = filename;\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  window.URL.revokeObjectURL(url);\r\n};\r\n\r\nexport const extractUniqueCategories = (validRows: CSVProductRow[]): string[] => {\r\n  const categories = validRows\r\n    .map(row => row['Category']?.trim())\r\n    .filter(category => category && category !== '');\r\n\r\n  return [...new Set(categories)];\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4840, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/types/index.ts"],"sourcesContent":["// Sale item type definition\r\nexport interface SaleItem {\r\n  description: string;\r\n  quantity: number;\r\n  price: number;\r\n  cost: number;\r\n  productId?: string;\r\n  discountPercentage?: number;\r\n  discountType?: 'percentage' | 'amount';\r\n  discountAmount?: number;\r\n}\r\n\r\nexport interface SalesCategory {\r\n  id: string;\r\n  user_id: string;\r\n  location_id?: string;\r\n  name: string;\r\n  is_default: boolean;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface Sale {\r\n  id: string;\r\n  receiptNumber: string;\r\n  customerName: string;\r\n  customerAddress?: string;\r\n  customerContact?: string;\r\n  customerId?: string;\r\n  items: SaleItem[];\r\n  paymentStatus: 'Paid' | 'NOT PAID' | 'Quote' | 'Installment Sale';\r\n  profit: number;\r\n  date: Date;\r\n  taxRate?: number;\r\n  cashTransactionId?: string;\r\n  amountPaid?: number;\r\n  amountDue?: number;\r\n  notes?: string;\r\n  categoryId?: string;\r\n  installments?: Array<{\r\n    date?: string | Date;\r\n    amountPaid?: number;\r\n  }>;\r\n  createdAt: Date;\r\n}\r\n\r\n// Supabase database schema and Json type\r\nexport type Json =\r\n  | string\r\n  | number\r\n  | boolean\r\n  | null\r\n  | { [key: string]: Json | undefined }\r\n  | Json[];\r\n\r\n// Supabase database sale structure\r\nexport interface DbSale {\r\n  id: string;\r\n  user_id: string;\r\n  location_id: string;\r\n  receipt_number: string;\r\n  customer_name: string;\r\n  customer_address?: string | null;\r\n  customer_contact?: string | null;\r\n  customer_id?: string | null;\r\n  items: Json;\r\n  payment_status: string;\r\n  profit: number;\r\n  date: string;\r\n  tax_rate?: number | null;\r\n  created_at: string;\r\n  updated_at: string;\r\n  cash_transaction_id?: string | null;\r\n  amount_paid?: number | null;\r\n  amount_due?: number | null;\r\n  notes?: string | null;\r\n  category_id?: string | null;\r\n}\r\n\r\n// Expense interface - add cashTransactionId field\r\nexport interface Expense {\r\n  id: string;\r\n  amount: number;\r\n  description: string;\r\n  category: string | null;\r\n  date: Date;\r\n  paymentMethod: string | null;\r\n  personInCharge: string | null;\r\n  receiptImage: string | null;\r\n  cashAccountId: string | null;\r\n  cashTransactionId: string | null; // Add this field\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\n// Supabase database expense structure\r\nexport interface DbExpense {\r\n  id: string;\r\n  user_id: string;\r\n  amount: number;\r\n  description: string;\r\n  category: string | null;\r\n  date: string;\r\n  payment_method: string | null;\r\n  person_in_charge: string | null;\r\n  receipt_image: string | null;\r\n  cash_account_id: string | null;\r\n  cash_transaction_id: string | null; // Add this field\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface SaleFormData {\r\n  customerName: string;\r\n  customerAddress: string;\r\n  customerContact: string;\r\n  customerId?: string; // Added customerId field\r\n  items: SaleItem[];\r\n  paymentStatus: \"Paid\" | \"NOT PAID\" | \"Quote\" | \"Installment Sale\";\r\n  receiptNumber?: string;\r\n  taxRate?: number | null;\r\n  amountPaid?: number;\r\n  amountDue?: number;\r\n  notes?: string;\r\n  categoryId?: string;\r\n}\r\n\r\n// Analytics data type\r\nexport interface AnalyticsData {\r\n  totalSales: number;\r\n  totalProfit: number;\r\n  totalCost: number;\r\n  paidSalesCount: number;\r\n  pendingSalesCount: number;\r\n}\r\n\r\n// Form validation errors\r\nexport interface FormErrors {\r\n  customerName?: string;\r\n  customerAddress?: string;\r\n  customerContact?: string;\r\n  itemDescription?: string;\r\n  quantity?: string;\r\n  salePrice?: string;\r\n  costOfProduction?: string;\r\n  taxRate?: string;\r\n}\r\n\r\n// BusinessSettings interface to include paymentInfo\r\nexport interface BusinessSettings {\r\n  businessName: string;\r\n  businessAddress: string;\r\n  businessPhone: string;\r\n  businessEmail: string;\r\n  businessLogo?: string;\r\n  currency: string;\r\n  signature?: string;\r\n  paymentInfo?: string; // Added payment information field\r\n  defaultPrintFormat?: 'standard' | 'thermal'; // Added default print format\r\n  defaultPrinterName?: string; // Added default printer name\r\n  defaultPrinterType?: 'USB' | 'Bluetooth'; // Added default printer type\r\n}\r\n\r\n// Database business settings structure\r\nexport interface DbBusinessSettings {\r\n  id?: string;\r\n  user_id: string; // Make sure this is required, not optional\r\n  business_name: string;\r\n  business_address: string;\r\n  business_phone: string;\r\n  business_email: string;\r\n  business_logo?: string;\r\n  currency: string;\r\n  signature?: string;\r\n  metadata?: Json | null; // Add metadata field\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\n// Updated UserProfile interface to match the Supabase database structure\r\nexport interface UserProfile {\r\n  id: string;\r\n  full_name: string | null;\r\n  display_name: string | null;\r\n  avatar_url: string | null;\r\n  created_at: string | null;\r\n  updated_at: string | null;\r\n}\r\n\r\n// New interfaces for Product management - ADDED itemNumber\r\nexport interface Product {\r\n  id: string;\r\n  itemNumber: string; // Added item number field\r\n  barcode: string | null; // Added barcode field\r\n  manufacturerBarcode: string | null; // Added manufacturer barcode field\r\n  name: string;\r\n  description: string | null;\r\n  category: string;\r\n  quantity: number;\r\n  costPrice: number;\r\n  sellingPrice: number;\r\n  supplier: string | null;\r\n  imageUrl: string | null;\r\n  minimumStock: number;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nexport interface DbProduct {\r\n  id: string;\r\n  user_id: string;\r\n  item_number: string; // Added item number field\r\n  barcode: string | null; // Added barcode field\r\n  manufacturer_barcode: string | null; // Added manufacturer barcode field\r\n  name: string;\r\n  description: string | null;\r\n  category: string;\r\n  quantity: number;\r\n  cost_price: number;\r\n  selling_price: number;\r\n  supplier: string | null;\r\n  image_url: string | null;\r\n  minimum_stock: number;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface ProductFormData {\r\n  name: string;\r\n  barcode?: string; // Added barcode field\r\n  manufacturerBarcode?: string; // Added manufacturer barcode field\r\n  description?: string;\r\n  category?: string;\r\n  quantity: number; // Always a number, never undefined\r\n  costPrice?: number;\r\n  sellingPrice?: number;\r\n  supplier?: string;\r\n  minimumStock?: number;\r\n  imageFile?: File | null;\r\n  imageUrl?: string | null;\r\n  createdAt?: Date; // Added created date field\r\n}\r\n\r\nexport interface ProductCategory {\r\n  id: string;\r\n  name: string;\r\n}\r\n\r\nexport interface DbProductCategory {\r\n  id: string;\r\n  user_id: string;\r\n  name: string;\r\n  created_at: string;\r\n}\r\n\r\nexport interface StockHistoryEntry {\r\n  id: string;\r\n  productId: string;\r\n  oldQuantity: number;\r\n  newQuantity: number;\r\n  changeReason: string;\r\n  referenceId?: string | null;\r\n  receiptNumber?: string;\r\n  createdAt: Date;\r\n  product?: {\r\n    name: string;\r\n    costPrice: number;\r\n    sellingPrice: number;\r\n    itemNumber: string;\r\n  };\r\n}\r\n\r\nexport interface DbStockHistoryEntry {\r\n  id: string;\r\n  user_id: string;\r\n  product_id: string;\r\n  previous_quantity: number;\r\n  new_quantity: number;\r\n  change_reason: string;\r\n  reference_id?: string | null;\r\n  created_at: string;\r\n}\r\n\r\nexport interface ProductFilters {\r\n  search: string;\r\n  category: string;\r\n  stockStatus: 'all' | 'inStock' | 'lowStock' | 'outOfStock';\r\n}\r\n\r\n// Customer management types\r\nexport interface Customer {\r\n  id: string;\r\n  fullName: string;\r\n  email: string | null;\r\n  phoneNumber: string | null;\r\n  birthday: Date | null;\r\n  location: string | null;\r\n  categoryId: string | null; // Added category relationship\r\n  socialMedia: {\r\n    facebook?: string;\r\n    instagram?: string;\r\n    twitter?: string;\r\n    linkedin?: string;\r\n    other?: string;\r\n  } | null;\r\n  gender: string | null;\r\n  tags: string[] | null;\r\n  notes: string | null;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nexport interface DbCustomer {\r\n  id: string;\r\n  user_id: string;\r\n  full_name: string;\r\n  email: string | null;\r\n  phone_number: string | null;\r\n  birthday: string | null;\r\n  location: string | null;\r\n  category_id: string | null; // Added category relationship\r\n  social_media: Json | null;\r\n  gender: string | null;\r\n  tags: string[] | null;\r\n  notes: string | null;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface CustomerFormData {\r\n  fullName: string;\r\n  email: string;\r\n  phoneNumber: string;\r\n  birthday: Date | null;\r\n  location: string;\r\n  categoryId: string | null; // Added category field\r\n  socialMedia: {\r\n    facebook?: string;\r\n    instagram?: string;\r\n    twitter?: string;\r\n    linkedin?: string;\r\n    other?: string;\r\n  };\r\n  gender: string;\r\n  tags: string[];\r\n  notes: string;\r\n}\r\n\r\n// Utility functions for database conversions\r\nexport const mapDbSaleToSale = (dbSale: DbSale): Sale => {\r\n  // Parse items and ensure numeric fields are numbers, not strings\r\n  // This is critical for discount calculations to work correctly\r\n  const items = (Array.isArray(dbSale.items) ? dbSale.items : []).map((item: any) => {\r\n    const discountPercentage = item.discountPercentage !== undefined ? Number(item.discountPercentage) : undefined;\r\n    const discountAmount = item.discountAmount !== undefined ? Number(item.discountAmount) : undefined;\r\n\r\n    // Infer discountType if missing (for legacy data)\r\n    let discountType = item.discountType as 'percentage' | 'amount' | undefined;\r\n    if (!discountType) {\r\n      if (discountPercentage && discountPercentage > 0) {\r\n        discountType = 'percentage';\r\n      } else if (discountAmount && discountAmount > 0) {\r\n        discountType = 'amount';\r\n      }\r\n    }\r\n\r\n    return {\r\n      description: item.description || '',\r\n      quantity: Number(item.quantity) || 0,\r\n      price: Number(item.price) || 0,\r\n      cost: Number(item.cost) || 0,\r\n      productId: item.productId || undefined,\r\n      discountType,\r\n      discountPercentage,\r\n      discountAmount,\r\n      createdAt: item.createdAt || undefined,\r\n    };\r\n  }) as SaleItem[];\r\n\r\n  return {\r\n    id: dbSale.id,\r\n    receiptNumber: dbSale.receipt_number,\r\n    customerName: dbSale.customer_name,\r\n    customerAddress: dbSale.customer_address || '',\r\n    customerContact: dbSale.customer_contact || '',\r\n    customerId: dbSale.customer_id || undefined,\r\n    items,\r\n    paymentStatus: dbSale.payment_status as 'Paid' | 'NOT PAID' | 'Quote' | 'Installment Sale',\r\n    profit: Number(dbSale.profit),\r\n    date: new Date(dbSale.date),\r\n    taxRate: dbSale.tax_rate ? Number(dbSale.tax_rate) : 0,\r\n    cashTransactionId: dbSale.cash_transaction_id || undefined,\r\n    amountPaid: dbSale.amount_paid ? Number(dbSale.amount_paid) : undefined,\r\n    amountDue: dbSale.amount_due ? Number(dbSale.amount_due) : undefined,\r\n    notes: dbSale.notes || '',\r\n    categoryId: dbSale.category_id || undefined,\r\n    createdAt: new Date(dbSale.created_at),\r\n  };\r\n};\r\n\r\nexport const mapSaleToDbSale = (\r\n  saleData: SaleFormData,\r\n  selectedDate: Date,\r\n  profit: number,\r\n  receiptNumber: string,\r\n  userId: string,\r\n  locationId: string,\r\n  cashTransactionId?: string | null\r\n): Omit<DbSale, 'id' | 'created_at' | 'updated_at'> => {\r\n  return {\r\n    user_id: userId,\r\n    location_id: locationId,\r\n    receipt_number: receiptNumber,\r\n    customer_name: saleData.customerName,\r\n    customer_address: saleData.customerAddress || null,\r\n    customer_contact: saleData.customerContact || null,\r\n    customer_id: saleData.customerId || null, // Include customer_id\r\n    items: (saleData.items as unknown) as Json,\r\n    payment_status: saleData.paymentStatus,\r\n    profit: profit,\r\n    date: selectedDate.toISOString().split('T')[0],\r\n    tax_rate: saleData.taxRate || 0,\r\n    cash_transaction_id: cashTransactionId || null,\r\n    amount_paid: saleData.amountPaid || null,\r\n    amount_due: saleData.amountDue || null,\r\n    notes: saleData.notes || null,\r\n    category_id: saleData.categoryId || null,\r\n  };\r\n};\r\n\r\n// Conversion functions for business settings\r\nexport const mapDbBusinessSettingsToBusinessSettings = (dbSettings: DbBusinessSettings): BusinessSettings => {\r\n  return {\r\n    businessName: dbSettings.business_name,\r\n    businessAddress: dbSettings.business_address,\r\n    businessPhone: dbSettings.business_phone,\r\n    businessEmail: dbSettings.business_email,\r\n    businessLogo: dbSettings.business_logo,\r\n    currency: dbSettings.currency,\r\n    signature: dbSettings.signature,\r\n    paymentInfo: dbSettings.metadata && typeof dbSettings.metadata === 'object' ?\r\n      (dbSettings.metadata as Record<string, unknown>).payment_info as string || '' : '',\r\n    defaultPrintFormat: dbSettings.metadata && typeof dbSettings.metadata === 'object' ?\r\n      (dbSettings.metadata as Record<string, unknown>).default_print_format as 'standard' | 'thermal' || 'standard' : 'standard',\r\n    defaultPrinterName: dbSettings.metadata && typeof dbSettings.metadata === 'object' ?\r\n      (dbSettings.metadata as Record<string, unknown>).default_printer_name as string || '' : '',\r\n    defaultPrinterType: dbSettings.metadata && typeof dbSettings.metadata === 'object' ?\r\n      (dbSettings.metadata as Record<string, unknown>).default_printer_type as 'USB' | 'Bluetooth' || 'USB' : 'USB'\r\n  };\r\n};\r\n\r\nexport const mapBusinessSettingsToDbBusinessSettings = (\r\n  settings: BusinessSettings,\r\n  userId: string\r\n): DbBusinessSettings => {\r\n  // Create metadata object with payment_info\r\n  const metadata: Json = {\r\n    payment_info: settings.paymentInfo || '',\r\n    default_print_format: settings.defaultPrintFormat || 'standard',\r\n    default_printer_name: settings.defaultPrinterName || '',\r\n    default_printer_type: settings.defaultPrinterType || 'USB'\r\n  };\r\n\r\n  return {\r\n    user_id: userId,\r\n    business_name: settings.businessName,\r\n    business_address: settings.businessAddress,\r\n    business_phone: settings.businessPhone,\r\n    business_email: settings.businessEmail,\r\n    business_logo: settings.businessLogo,\r\n    currency: settings.currency,\r\n    signature: settings.signature,\r\n    metadata: metadata, // Include metadata in the return object\r\n    updated_at: new Date().toISOString()\r\n  };\r\n};\r\n\r\n// Conversion functions for products and categories - ADDED itemNumber\r\nexport const mapDbProductToProduct = (dbProduct: DbProduct): Product => {\r\n  return {\r\n    id: dbProduct.id,\r\n    itemNumber: dbProduct.item_number, // Added item number mapping\r\n    barcode: dbProduct.barcode, // Added barcode mapping\r\n    manufacturerBarcode: dbProduct.manufacturer_barcode, // Added manufacturer barcode mapping\r\n    name: dbProduct.name,\r\n    description: dbProduct.description,\r\n    category: dbProduct.category,\r\n    quantity: dbProduct.quantity,\r\n    costPrice: Number(dbProduct.cost_price),\r\n    sellingPrice: Number(dbProduct.selling_price),\r\n    supplier: dbProduct.supplier,\r\n    imageUrl: dbProduct.image_url,\r\n    minimumStock: dbProduct.minimum_stock,\r\n    createdAt: new Date(dbProduct.created_at),\r\n    updatedAt: new Date(dbProduct.updated_at)\r\n  };\r\n};\r\n\r\nexport const mapProductToDbProduct = (product: Partial<Product>, userId: string): Partial<DbProduct> => {\r\n  const result: Partial<DbProduct> = {\r\n    user_id: userId\r\n  };\r\n\r\n  if (product.id) result.id = product.id;\r\n  if (product.itemNumber) result.item_number = product.itemNumber; // Added item number mapping\r\n  if (product.barcode !== undefined) result.barcode = product.barcode; // Added barcode mapping\r\n  if (product.manufacturerBarcode !== undefined) result.manufacturer_barcode = product.manufacturerBarcode; // Added manufacturer barcode mapping\r\n  if (product.name) result.name = product.name;\r\n  result.description = product.description;\r\n  if (product.category) result.category = product.category;\r\n  if (product.quantity !== undefined) result.quantity = product.quantity;\r\n  if (product.costPrice !== undefined) {\r\n    result.cost_price = product.costPrice;\r\n    console.log(`DEBUG: Mapping costPrice ${product.costPrice} to cost_price`);\r\n  }\r\n  if (product.sellingPrice !== undefined) {\r\n    result.selling_price = product.sellingPrice;\r\n    console.log(`DEBUG: Mapping sellingPrice ${product.sellingPrice} to selling_price`);\r\n  }\r\n  result.supplier = product.supplier;\r\n  result.image_url = product.imageUrl;\r\n  if (product.minimumStock !== undefined) result.minimum_stock = product.minimumStock;\r\n\r\n  return result;\r\n};\r\n\r\nexport const mapDbProductCategoryToProductCategory = (dbCategory: DbProductCategory): ProductCategory => {\r\n  return {\r\n    id: dbCategory.id,\r\n    name: dbCategory.name\r\n  };\r\n};\r\n\r\nexport const mapDbStockHistoryToStockHistory = (dbHistory: DbStockHistoryEntry): StockHistoryEntry => {\r\n  return {\r\n    id: dbHistory.id,\r\n    productId: dbHistory.product_id,\r\n    oldQuantity: dbHistory.previous_quantity,\r\n    newQuantity: dbHistory.new_quantity,\r\n    changeReason: dbHistory.change_reason,\r\n    referenceId: dbHistory.reference_id || null,\r\n    createdAt: new Date(dbHistory.created_at)\r\n  };\r\n};\r\n\r\n// Updated Customer mapping functions to include categoryId\r\nexport const mapDbCustomerToCustomer = (dbCustomer: DbCustomer): Customer => {\r\n  let birthday = null;\r\n\r\n  if (dbCustomer.birthday) {\r\n    try {\r\n      const birthdayStr = String(dbCustomer.birthday);\r\n      const [year, month, day] = birthdayStr.split('-').map(Number);\r\n\r\n      if (!isNaN(year) && !isNaN(month) && !isNaN(day)) {\r\n        birthday = new Date(Date.UTC(year, month - 1, day, 12, 0, 0));\r\n\r\n        console.log(\r\n          'Converting DB birthday to Date object:',\r\n          dbCustomer.birthday,\r\n          '→',\r\n          birthday,\r\n          '(UTC string:',\r\n          birthday.toISOString(),\r\n          ')'\r\n        );\r\n      } else {\r\n        console.error('Invalid date components in birthday:', dbCustomer.birthday);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error parsing birthday:', error, dbCustomer.birthday);\r\n    }\r\n  }\r\n\r\n  return {\r\n    id: dbCustomer.id,\r\n    fullName: dbCustomer.full_name,\r\n    email: dbCustomer.email,\r\n    phoneNumber: dbCustomer.phone_number,\r\n    birthday: birthday,\r\n    location: dbCustomer.location,\r\n    categoryId: dbCustomer.category_id, // Added category mapping\r\n    socialMedia: dbCustomer.social_media as any,\r\n    gender: dbCustomer.gender,\r\n    tags: dbCustomer.tags,\r\n    notes: dbCustomer.notes,\r\n    createdAt: new Date(dbCustomer.created_at),\r\n    updatedAt: new Date(dbCustomer.updated_at)\r\n  };\r\n};\r\n\r\nexport const mapCustomerToDbCustomer = (customer: Partial<Customer>, userId: string): Partial<DbCustomer> => {\r\n  const result: Partial<DbCustomer> = {\r\n    user_id: userId\r\n  };\r\n\r\n  if (customer.id) result.id = customer.id;\r\n  if (customer.fullName) result.full_name = customer.fullName;\r\n  result.email = customer.email;\r\n  result.phone_number = customer.phoneNumber;\r\n  if (customer.birthday) result.birthday = customer.birthday.toISOString().split('T')[0];\r\n  result.location = customer.location;\r\n  result.category_id = customer.categoryId; // Added category mapping\r\n  result.social_media = customer.socialMedia as Json;\r\n  result.gender = customer.gender;\r\n  result.tags = customer.tags;\r\n  result.notes = customer.notes;\r\n\r\n  return result;\r\n};\r\n\r\n// Conversion functions for expenses\r\nexport const mapDbExpenseToExpense = (dbExpense: DbExpense): Expense => {\r\n  return {\r\n    id: dbExpense.id,\r\n    amount: Number(dbExpense.amount),\r\n    description: dbExpense.description,\r\n    category: dbExpense.category,\r\n    date: new Date(dbExpense.date),\r\n    paymentMethod: dbExpense.payment_method,\r\n    personInCharge: dbExpense.person_in_charge,\r\n    receiptImage: dbExpense.receipt_image,\r\n    cashAccountId: dbExpense.cash_account_id,\r\n    cashTransactionId: dbExpense.cash_transaction_id,\r\n    createdAt: new Date(dbExpense.created_at),\r\n    updatedAt: new Date(dbExpense.updated_at)\r\n  };\r\n};\r\n\r\nexport const mapExpenseToDbExpense = (expense: Partial<Expense>, userId: string): Partial<DbExpense> => {\r\n  const result: Partial<DbExpense> = {\r\n    user_id: userId\r\n  };\r\n\r\n  if (expense.id) result.id = expense.id;\r\n  if (expense.amount !== undefined) result.amount = expense.amount;\r\n  if (expense.description) result.description = expense.description;\r\n  result.category = expense.category;\r\n  if (expense.date) result.date = expense.date.toISOString().split('T')[0];\r\n  result.payment_method = expense.paymentMethod;\r\n  result.person_in_charge = expense.personInCharge;\r\n  result.receipt_image = expense.receiptImage;\r\n  result.cash_account_id = expense.cashAccountId;\r\n  result.cash_transaction_id = expense.cashTransactionId;\r\n\r\n  return result;\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5120, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/hooks/useCategories.ts"],"sourcesContent":["\r\nimport { useState, useEffect } from 'react';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { ProductCategory, DbProductCategory, mapDbProductCategoryToProductCategory } from '@/types';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\n\r\nexport const useCategories = (userId: string | undefined) => {\r\n  const [categories, setCategories] = useState<ProductCategory[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const { toast } = useToast();\r\n  const { currentBusiness } = useBusiness();\r\n\r\n  const loadCategories = async () => {\r\n    try {\r\n      if (!userId || !currentBusiness) return;\r\n      \r\n      setIsLoading(true);\r\n      const { data, error } = await supabase\r\n        .from('product_categories')\r\n        .select('*')\r\n        .eq('location_id', currentBusiness.id)\r\n        .order('name');\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      const formattedCategories: ProductCategory[] = data ? \r\n        data.map((item: DbProductCategory) => mapDbProductCategoryToProductCategory(item)) : [];\r\n      \r\n      setCategories(formattedCategories);\r\n    } catch (error) {\r\n      console.error('Error loading categories:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to load product categories. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadCategories();\r\n  }, [userId, currentBusiness?.id]);\r\n\r\n  const createCategory = async (name: string) => {\r\n    try {\r\n      if (!userId || !currentBusiness) return null;\r\n\r\n      // Check if category already exists\r\n      const existingCategory = categories.find(\r\n        cat => cat.name.toLowerCase() === name.toLowerCase()\r\n      );\r\n      \r\n      if (existingCategory) {\r\n        toast({\r\n          title: \"Category exists\",\r\n          description: \"This category already exists.\",\r\n          variant: \"default\"\r\n        });\r\n        return existingCategory;\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from('product_categories')\r\n        .insert({\r\n          user_id: userId,\r\n          location_id: currentBusiness.id,\r\n          name\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      if (data) {\r\n        const newCategory = mapDbProductCategoryToProductCategory(data as DbProductCategory);\r\n        setCategories([...categories, newCategory]);\r\n        return newCategory;\r\n      }\r\n      \r\n      return null;\r\n    } catch (error) {\r\n      console.error('Error creating category:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to create category. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const updateCategory = async (id: string, name: string) => {\r\n    try {\r\n      if (!userId) return false;\r\n\r\n      // Check if category already exists\r\n      const existingCategory = categories.find(\r\n        cat => cat.name.toLowerCase() === name.toLowerCase() && cat.id !== id\r\n      );\r\n      \r\n      if (existingCategory) {\r\n        toast({\r\n          title: \"Category exists\",\r\n          description: \"Another category with this name already exists.\",\r\n          variant: \"default\"\r\n        });\r\n        return false;\r\n      }\r\n\r\n      const { data, error } = await supabase\r\n        .from('product_categories')\r\n        .update({ name })\r\n        .eq('id', id)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      if (data) {\r\n        const updatedCategory = mapDbProductCategoryToProductCategory(data as DbProductCategory);\r\n        setCategories(categories.map(c => c.id === id ? updatedCategory : c));\r\n        return true;\r\n      }\r\n      \r\n      return false;\r\n    } catch (error) {\r\n      console.error('Error updating category:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to update category. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const deleteCategory = async (id: string) => {\r\n    try {\r\n      if (!userId) return false;\r\n\r\n      // First check if there are any products using this category\r\n      const { data: products, error: productsError } = await supabase\r\n        .from('products')\r\n        .select('id')\r\n        .eq('category', categories.find(c => c.id === id)?.name || '');\r\n      \r\n      if (productsError) throw productsError;\r\n      \r\n      if (products && products.length > 0) {\r\n        toast({\r\n          title: \"Cannot delete category\",\r\n          description: \"This category is being used by one or more products.\",\r\n          variant: \"destructive\"\r\n        });\r\n        return false;\r\n      }\r\n\r\n      const { error } = await supabase\r\n        .from('product_categories')\r\n        .delete()\r\n        .eq('id', id);\r\n\r\n      if (error) throw error;\r\n\r\n      setCategories(categories.filter(c => c.id !== id));\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error deleting category:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"Failed to delete category. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  return { \r\n    categories, \r\n    isLoading, \r\n    loadCategories,\r\n    createCategory,\r\n    updateCategory,\r\n    deleteCategory\r\n  };\r\n};\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;AACA;;;;;;;AAEO,MAAM,gBAAgB,CAAC;;IAC5B,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAoB,EAAE;IAClE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,2IAAQ;IAC1B,MAAM,EAAE,eAAe,EAAE,GAAG,IAAA,qJAAW;IAEvC,MAAM,iBAAiB;QACrB,IAAI;YACF,IAAI,CAAC,UAAU,CAAC,iBAAiB;YAEjC,aAAa;YACb,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,wJAAQ,CACnC,IAAI,CAAC,sBACL,MAAM,CAAC,KACP,EAAE,CAAC,eAAe,gBAAgB,EAAE,EACpC,KAAK,CAAC;YAET,IAAI,OAAO;gBACT,MAAM;YACR;YAEA,MAAM,sBAAyC,OAC7C,KAAK,GAAG,CAAC,CAAC,OAA4B,IAAA,iKAAqC,EAAC,SAAS,EAAE;YAEzF,cAAc;QAChB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF,SAAU;YACR,aAAa;QACf;IACF;IAEA,IAAA,0KAAS;mCAAC;YACR;QACF;kCAAG;QAAC;QAAQ,iBAAiB;KAAG;IAEhC,MAAM,iBAAiB,OAAO;QAC5B,IAAI;YACF,IAAI,CAAC,UAAU,CAAC,iBAAiB,OAAO;YAExC,mCAAmC;YACnC,MAAM,mBAAmB,WAAW,IAAI,CACtC,CAAA,MAAO,IAAI,IAAI,CAAC,WAAW,OAAO,KAAK,WAAW;YAGpD,IAAI,kBAAkB;gBACpB,MAAM;oBACJ,OAAO;oBACP,aAAa;oBACb,SAAS;gBACX;gBACA,OAAO;YACT;YAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,wJAAQ,CACnC,IAAI,CAAC,sBACL,MAAM,CAAC;gBACN,SAAS;gBACT,aAAa,gBAAgB,EAAE;gBAC/B;YACF,GACC,MAAM,GACN,MAAM;YAET,IAAI,OAAO,MAAM;YAEjB,IAAI,MAAM;gBACR,MAAM,cAAc,IAAA,iKAAqC,EAAC;gBAC1D,cAAc;uBAAI;oBAAY;iBAAY;gBAC1C,OAAO;YACT;YAEA,OAAO;QACT,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;YACA,OAAO;QACT;IACF;IAEA,MAAM,iBAAiB,OAAO,IAAY;QACxC,IAAI;YACF,IAAI,CAAC,QAAQ,OAAO;YAEpB,mCAAmC;YACnC,MAAM,mBAAmB,WAAW,IAAI,CACtC,CAAA,MAAO,IAAI,IAAI,CAAC,WAAW,OAAO,KAAK,WAAW,MAAM,IAAI,EAAE,KAAK;YAGrE,IAAI,kBAAkB;gBACpB,MAAM;oBACJ,OAAO;oBACP,aAAa;oBACb,SAAS;gBACX;gBACA,OAAO;YACT;YAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,wJAAQ,CACnC,IAAI,CAAC,sBACL,MAAM,CAAC;gBAAE;YAAK,GACd,EAAE,CAAC,MAAM,IACT,MAAM,GACN,MAAM;YAET,IAAI,OAAO,MAAM;YAEjB,IAAI,MAAM;gBACR,MAAM,kBAAkB,IAAA,iKAAqC,EAAC;gBAC9D,cAAc,WAAW,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,KAAK,kBAAkB;gBAClE,OAAO;YACT;YAEA,OAAO;QACT,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;YACA,OAAO;QACT;IACF;IAEA,MAAM,iBAAiB,OAAO;QAC5B,IAAI;YACF,IAAI,CAAC,QAAQ,OAAO;YAEpB,4DAA4D;YAC5D,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,aAAa,EAAE,GAAG,MAAM,wJAAQ,CAC5D,IAAI,CAAC,YACL,MAAM,CAAC,MACP,EAAE,CAAC,YAAY,WAAW,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,KAAK,QAAQ;YAE7D,IAAI,eAAe,MAAM;YAEzB,IAAI,YAAY,SAAS,MAAM,GAAG,GAAG;gBACnC,MAAM;oBACJ,OAAO;oBACP,aAAa;oBACb,SAAS;gBACX;gBACA,OAAO;YACT;YAEA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,wJAAQ,CAC7B,IAAI,CAAC,sBACL,MAAM,GACN,EAAE,CAAC,MAAM;YAEZ,IAAI,OAAO,MAAM;YAEjB,cAAc,WAAW,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;YAC9C,OAAO;QACT,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;YACA,OAAO;QACT;IACF;IAEA,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;IACF;AACF;GAvLa;;QAGO,2IAAQ;QACE,qJAAW"}},
    {"offset": {"line": 5291, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/hooks/useBulkProducts.ts"],"sourcesContent":["\r\nimport { useState } from 'react';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useCategories } from '@/hooks/useCategories';\r\nimport { ProductFormData } from '@/types';\r\nimport { toast } from 'sonner';\r\n\r\nexport const useBulkProducts = () => {\r\n  const { user } = useAuth();\r\n  const { createProduct } = useProducts(user?.id);\r\n  const { categories, createCategory } = useCategories(user?.id);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n\r\n  const createMissingCategories = async (productCategories: string[]) => {\r\n    const existingCategoryNames = categories.map(cat => cat.name.toLowerCase());\r\n    const uniqueCategories = [...new Set(productCategories.filter(cat => cat.trim() !== ''))];\r\n    const missingCategories = uniqueCategories.filter(\r\n      category => !existingCategoryNames.includes(category.toLowerCase())\r\n    );\r\n\r\n    const createdCategories: string[] = [];\r\n    const failedCategories: string[] = [];\r\n\r\n    for (const categoryName of missingCategories) {\r\n      try {\r\n        const result = await createCategory(categoryName);\r\n        if (result) {\r\n          createdCategories.push(categoryName);\r\n        } else {\r\n          failedCategories.push(categoryName);\r\n        }\r\n      } catch (error) {\r\n        console.error(`Failed to create category ${categoryName}:`, error);\r\n        failedCategories.push(categoryName);\r\n      }\r\n    }\r\n\r\n    return { createdCategories, failedCategories };\r\n  };\r\n\r\n  const bulkCreateProducts = async (\r\n    products: ProductFormData[], \r\n    progressCallback?: (current: number, total: number) => void\r\n  ) => {\r\n    if (!user?.id) {\r\n      throw new Error('User not authenticated');\r\n    }\r\n\r\n    setIsUploading(true);\r\n    let successCount = 0;\r\n    let failureCount = 0;\r\n    const errors: string[] = [];\r\n\r\n    try {\r\n      // Extract all categories from products\r\n      const productCategories = products.map(p => p.category).filter(Boolean);\r\n      \r\n      // Create missing categories first\r\n      if (productCategories.length > 0) {\r\n        const { createdCategories, failedCategories } = await createMissingCategories(productCategories);\r\n        \r\n        if (createdCategories.length > 0) {\r\n          toast.success(`Created ${createdCategories.length} new categories`);\r\n        }\r\n        \r\n        if (failedCategories.length > 0) {\r\n          toast.error(`Failed to create ${failedCategories.length} categories`);\r\n        }\r\n      }\r\n\r\n      // Now create products with progress tracking\r\n      for (let i = 0; i < products.length; i++) {\r\n        const productData = products[i];\r\n        \r\n        try {\r\n          const result = await createProduct(productData);\r\n          if (result) {\r\n            successCount++;\r\n          } else {\r\n            failureCount++;\r\n            errors.push(`Failed to create product: ${productData.name}`);\r\n          }\r\n        } catch (error) {\r\n          failureCount++;\r\n          errors.push(`Error creating ${productData.name}: ${error}`);\r\n          console.error(`Error creating product ${productData.name}:`, error);\r\n        }\r\n        \r\n        // Update progress after each product\r\n        if (progressCallback) {\r\n          progressCallback(successCount + failureCount, products.length);\r\n        }\r\n      }\r\n\r\n      // Show summary toast only if no progress callback (for regular usage)\r\n      if (!progressCallback) {\r\n        if (successCount > 0) {\r\n          toast.success(`Successfully created ${successCount} products`);\r\n        }\r\n        \r\n        if (failureCount > 0) {\r\n          toast.error(`${failureCount} products failed to upload`);\r\n        }\r\n      }\r\n\r\n      return { successCount, failureCount, errors };\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  const detectNewCategories = (products: ProductFormData[]) => {\r\n    const existingCategoryNames = categories.map(cat => cat.name.toLowerCase());\r\n    const productCategories = products.map(p => p.category).filter(Boolean);\r\n    const uniqueCategories = [...new Set(productCategories)];\r\n    \r\n    return uniqueCategories.filter(\r\n      category => !existingCategoryNames.includes(category.toLowerCase())\r\n    );\r\n  };\r\n\r\n  return {\r\n    bulkCreateProducts,\r\n    detectNewCategories,\r\n    isUploading\r\n  };\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5426, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/CSVUploadDialog.tsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Upload, FileText, AlertCircle, CheckCircle, Download, Plus, Info } from 'lucide-react';\r\nimport { parseCSV, generateErrorLogCSV, ValidationError, CSVProductRow, extractUniqueCategories } from '@/utils/csvParser';\r\nimport { ProductFormData } from '@/types';\r\nimport { cn } from '@/lib/utils';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useBulkProducts } from '@/hooks/useBulkProducts';\r\nimport { BulkOperationProgress } from './BulkOperationProgress';\r\n\r\ninterface CSVUploadDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  onUpload: (products: ProductFormData[]) => Promise<void>;\r\n  categories: string[];\r\n}\r\n\r\ninterface UploadState {\r\n  step: 'select' | 'preview' | 'uploading' | 'complete';\r\n  file: File | null;\r\n  validRows: CSVProductRow[];\r\n  errors: ValidationError[];\r\n  totalRows: number;\r\n  uploadProgress: number;\r\n  successCount: number;\r\n  failureCount: number;\r\n  newCategories: string[];\r\n  currentProductIndex: number;\r\n}\r\n\r\nconst CSVUploadDialog: React.FC<CSVUploadDialogProps> = ({\r\n  open,\r\n  onOpenChange,\r\n  onUpload,\r\n  categories\r\n}) => {\r\n  const { detectNewCategories, bulkCreateProducts } = useBulkProducts();\r\n  const [state, setState] = useState<UploadState>({\r\n    step: 'select',\r\n    file: null,\r\n    validRows: [],\r\n    errors: [],\r\n    totalRows: 0,\r\n    uploadProgress: 0,\r\n    successCount: 0,\r\n    failureCount: 0,\r\n    newCategories: [],\r\n    currentProductIndex: 0\r\n  });\r\n\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n\r\n  const handleFileSelect = async (file: File) => {\r\n    if (!file.name.endsWith('.csv')) {\r\n      alert('Please select a CSV file');\r\n      return;\r\n    }\r\n\r\n    const text = await file.text();\r\n    const result = parseCSV(text);\r\n\r\n    // Convert CSV rows to ProductFormData to detect new categories\r\n    const products = result.validRows.map(convertCSVRowToProduct);\r\n    const newCategories = detectNewCategories(products);\r\n\r\n    setState({\r\n      ...state,\r\n      step: 'preview',\r\n      file,\r\n      validRows: result.validRows,\r\n      errors: result.errors,\r\n      totalRows: result.totalRows,\r\n      newCategories\r\n    });\r\n  };\r\n\r\n  const handleFileInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      handleFileSelect(file);\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    setIsDragging(false);\r\n\r\n    const file = e.dataTransfer.files[0];\r\n    if (file) {\r\n      handleFileSelect(file);\r\n    }\r\n  };\r\n\r\n  const handleDragOver = (e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    setIsDragging(true);\r\n  };\r\n\r\n  const handleDragLeave = () => {\r\n    setIsDragging(false);\r\n  };\r\n\r\n  const convertCSVRowToProduct = (row: CSVProductRow): ProductFormData => {\r\n    let creationDate = new Date();\r\n\r\n    // Accept any date format - try multiple parsing approaches\r\n    const dateValue = row['Creation Date'];\r\n    if (dateValue) {\r\n      // Try DD/MM/YYYY format first\r\n      const ddmmyyyyMatch = dateValue.match(/^(\\d{1,2})\\/(\\d{1,2})\\/(\\d{4})$/);\r\n      if (ddmmyyyyMatch) {\r\n        const [, day, month, year] = ddmmyyyyMatch;\r\n        creationDate = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));\r\n      } else {\r\n        // Try standard date parsing for other formats\r\n        const parsedDate = new Date(dateValue);\r\n        if (!isNaN(parsedDate.getTime())) {\r\n          creationDate = parsedDate;\r\n        }\r\n      }\r\n    }\r\n\r\n    return {\r\n      name: row['Product Name'],\r\n      category: row['Category'] || '',\r\n      description: row['Description'] || '',\r\n      supplier: row['Supplier'] || '',\r\n      quantity: row['Initial Stock'] ? Number(row['Initial Stock']) : 0,\r\n      minimumStock: row['Minimum Stock Level'] ? Number(row['Minimum Stock Level']) : undefined,\r\n      costPrice: row['Cost Price'] ? Number(row['Cost Price']) : undefined,\r\n      sellingPrice: row['Selling Price'] ? Number(row['Selling Price']) : undefined,\r\n      manufacturerBarcode: row['Manufacturer Barcode'] || '',\r\n      imageFile: null,\r\n      imageUrl: null,\r\n      createdAt: creationDate\r\n    };\r\n  };\r\n\r\n  const handleConfirmUpload = async () => {\r\n    setState(prev => ({ ...prev, step: 'uploading', uploadProgress: 0, currentProductIndex: 0 }));\r\n    setIsUploading(true);\r\n\r\n    const products = state.validRows.map(convertCSVRowToProduct);\r\n\r\n    try {\r\n      // Use the bulk upload function directly with progress tracking\r\n      await bulkCreateProducts(products, (current, total) => {\r\n        const progress = Math.round((current / total) * 100);\r\n        setState(prev => ({\r\n          ...prev,\r\n          uploadProgress: progress,\r\n          currentProductIndex: current,\r\n          successCount: current,\r\n          failureCount: 0\r\n        }));\r\n      });\r\n\r\n      setState(prev => ({\r\n        ...prev,\r\n        step: 'complete',\r\n        uploadProgress: 100,\r\n        successCount: products.length,\r\n        failureCount: 0,\r\n        currentProductIndex: products.length\r\n      }));\r\n    } catch (error) {\r\n      console.error('Bulk upload failed:', error);\r\n      setState(prev => ({\r\n        ...prev,\r\n        step: 'complete',\r\n        uploadProgress: 100,\r\n        successCount: 0,\r\n        failureCount: products.length,\r\n        currentProductIndex: products.length\r\n      }));\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    // Prevent closing during upload\r\n    if (isUploading) return;\r\n\r\n    // Check if we just completed a successful upload\r\n    const wasSuccessfulUpload = state.step === 'complete' && state.successCount > 0;\r\n\r\n    setState({\r\n      step: 'select',\r\n      file: null,\r\n      validRows: [],\r\n      errors: [],\r\n      totalRows: 0,\r\n      uploadProgress: 0,\r\n      successCount: 0,\r\n      failureCount: 0,\r\n      newCategories: [],\r\n      currentProductIndex: 0\r\n    });\r\n\r\n    onOpenChange(false);\r\n\r\n    // Trigger refresh if upload was successful\r\n    if (wasSuccessfulUpload) {\r\n      // Small delay to ensure dialog closes first\r\n      setTimeout(() => {\r\n        window.location.reload();\r\n      }, 100);\r\n    }\r\n  };\r\n\r\n  const handleOpenChange = (newOpen: boolean) => {\r\n    // Prevent dialog from closing during upload\r\n    if (!isUploading) {\r\n      onOpenChange(newOpen);\r\n    }\r\n  };\r\n\r\n  const renderFileSelection = () => (\r\n    <div className=\"space-y-4\">\r\n      <div\r\n        className={cn(\r\n          \"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\",\r\n          isDragging ? \"border-blue-500 bg-blue-50\" : \"border-gray-300 hover:border-gray-400\"\r\n        )}\r\n        onDrop={handleDrop}\r\n        onDragOver={handleDragOver}\r\n        onDragLeave={handleDragLeave}\r\n        onClick={() => fileInputRef.current?.click()}\r\n      >\r\n        <Upload className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\r\n        <p className=\"text-lg font-medium text-gray-900 mb-2\">\r\n          Upload CSV File\r\n        </p>\r\n        <p className=\"text-sm text-gray-500\">\r\n          Drag and drop your CSV file here, or click to browse\r\n        </p>\r\n        <p className=\"text-xs text-gray-400 mt-2\">\r\n          Supports all date formats | Accepts negative values | Use quotes for fields with commas\r\n        </p>\r\n      </div>\r\n\r\n      <input\r\n        ref={fileInputRef}\r\n        type=\"file\"\r\n        accept=\".csv\"\r\n        onChange={handleFileInputChange}\r\n        className=\"hidden\"\r\n      />\r\n    </div>\r\n  );\r\n\r\n  const renderPreview = () => (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"grid grid-cols-3 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-2xl font-bold text-green-600\">{state.validRows.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Valid products</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-2xl font-bold text-red-600\">{state.errors.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Errors found</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-2xl font-bold text-blue-600\">{state.totalRows}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Total rows</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {state.newCategories.length > 0 && (\r\n        <Alert>\r\n          <Plus className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            <div className=\"space-y-2\">\r\n              <p>The following {state.newCategories.length} new categories will be created:</p>\r\n              <div className=\"flex flex-wrap gap-1\">\r\n                {state.newCategories.map((category, index) => (\r\n                  <Badge key={index} variant=\"outline\" className=\"text-xs\">\r\n                    {category}\r\n                  </Badge>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {state.errors.length > 0 && (\r\n        <Alert variant=\"destructive\">\r\n          <AlertCircle className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            {state.errors.length} rows have errors and will be skipped.\r\n            <Button\r\n              variant=\"link\"\r\n              className=\"p-0 h-auto ml-2\"\r\n              onClick={() => generateErrorLogCSV(state.errors)}\r\n            >\r\n              <Download className=\"h-3 w-3 mr-1\" />\r\n              Download error log\r\n            </Button>\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      <div className=\"flex justify-end space-x-2\">\r\n        <Button variant=\"outline\" onClick={() => setState(prev => ({ ...prev, step: 'select' }))}>\r\n          Back\r\n        </Button>\r\n        <Button\r\n          onClick={handleConfirmUpload}\r\n          disabled={state.validRows.length === 0}\r\n        >\r\n          Upload {state.validRows.length} Products\r\n          {state.newCategories.length > 0 && ` & Create ${state.newCategories.length} Categories`}\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderUploading = () => (\r\n    <BulkOperationProgress\r\n      title=\"Uploading Products...\"\r\n      currentCount={state.currentProductIndex}\r\n      totalCount={state.validRows.length}\r\n      status=\"processing\"\r\n    />\r\n  );\r\n\r\n  const renderComplete = () => (\r\n    <div className=\"space-y-4\">\r\n      <BulkOperationProgress\r\n        title=\"Upload Complete!\"\r\n        currentCount={state.currentProductIndex}\r\n        totalCount={state.validRows.length}\r\n        status={state.failureCount > 0 ? 'failed' : 'completed'}\r\n        successCount={state.successCount}\r\n        failureCount={state.failureCount}\r\n      />\r\n      <div className=\"flex justify-center\">\r\n        <Button onClick={handleClose}>Close</Button>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleOpenChange}>\r\n      <DialogContent className=\"sm:max-w-[500px] pointer-events-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <FileText className=\"h-5 w-5\" />\r\n            Upload Products via CSV\r\n          </DialogTitle>\r\n          <DialogDescription>\r\n            Upload multiple products at once using a CSV file (DD/MM/YYYY date format)\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        {state.step === 'select' && renderFileSelection()}\r\n        {state.step === 'preview' && renderPreview()}\r\n        {state.step === 'uploading' && renderUploading()}\r\n        {state.step === 'complete' && renderComplete()}\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default CSVUploadDialog;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6054, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/csvUpdateParser.ts"],"sourcesContent":["export interface CSVProductUpdateRow {\r\n  'Item Number': string;\r\n  'Name': string;\r\n  'Category': string;\r\n  'Quantity': string;\r\n  'Cost Price': string;\r\n  'Selling Price': string;\r\n  'Supplier': string;\r\n  'Description': string;\r\n  'Manufacturer Barcode'?: string;\r\n  'Barcode'?: string;\r\n}\r\n\r\nexport interface UpdateValidationError {\r\n  row: number;\r\n  field: string;\r\n  message: string;\r\n}\r\n\r\nexport interface ParsedCSVUpdateResult {\r\n  validRows: CSVProductUpdateRow[];\r\n  errors: UpdateValidationError[];\r\n  totalRows: number;\r\n}\r\n\r\n// Parse CSV line handling quoted fields\r\nconst parseCSVLine = (line: string): string[] => {\r\n  const result: string[] = [];\r\n  let current = '';\r\n  let inQuotes = false;\r\n  let i = 0;\r\n\r\n  while (i < line.length) {\r\n    const char = line[i];\r\n    const nextChar = line[i + 1];\r\n\r\n    if (char === '\"') {\r\n      if (inQuotes && nextChar === '\"') {\r\n        current += '\"';\r\n        i += 2;\r\n        continue;\r\n      } else {\r\n        inQuotes = !inQuotes;\r\n      }\r\n    } else if (char === ',' && !inQuotes) {\r\n      result.push(current.trim());\r\n      current = '';\r\n    } else {\r\n      current += char;\r\n    }\r\n\r\n    i++;\r\n  }\r\n\r\n  result.push(current.trim());\r\n  return result;\r\n};\r\n\r\nexport const parseCSVUpdate = (csvText: string): ParsedCSVUpdateResult => {\r\n  const lines = csvText.trim().split('\\n');\r\n  const headers = parseCSVLine(lines[0]).map(h => h.trim());\r\n\r\n  const validRows: CSVProductUpdateRow[] = [];\r\n  const errors: UpdateValidationError[] = [];\r\n\r\n  for (let i = 1; i < lines.length; i++) {\r\n    const values = parseCSVLine(lines[i]).map(v => v.trim());\r\n    const row: any = {};\r\n\r\n    // Map values to headers\r\n    headers.forEach((header, index) => {\r\n      row[header] = values[index] || '';\r\n    });\r\n\r\n    // Validate row\r\n    const rowErrors = validateCSVUpdateRow(row, i + 1);\r\n\r\n    if (rowErrors.length === 0) {\r\n      validRows.push(row as CSVProductUpdateRow);\r\n    } else {\r\n      errors.push(...rowErrors);\r\n    }\r\n  }\r\n\r\n  return {\r\n    validRows,\r\n    errors,\r\n    totalRows: lines.length - 1\r\n  };\r\n};\r\n\r\nconst validateCSVUpdateRow = (row: any, rowNumber: number): UpdateValidationError[] => {\r\n  const errors: UpdateValidationError[] = [];\r\n\r\n  // Item Number is required for updates\r\n  if (!row['Item Number']?.trim()) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Item Number',\r\n      message: 'Item Number is required for updates'\r\n    });\r\n  }\r\n\r\n  // Validate numeric fields if provided\r\n  if (row['Quantity'] && row['Quantity'].trim() !== '' && isNaN(Number(row['Quantity']))) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Quantity',\r\n      message: 'Quantity must be a number'\r\n    });\r\n  }\r\n\r\n  if (row['Cost Price'] && row['Cost Price'].trim() !== '' && isNaN(Number(row['Cost Price']))) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Cost Price',\r\n      message: 'Cost Price must be a number'\r\n    });\r\n  }\r\n\r\n  if (row['Selling Price'] && row['Selling Price'].trim() !== '' && isNaN(Number(row['Selling Price']))) {\r\n    errors.push({\r\n      row: rowNumber,\r\n      field: 'Selling Price',\r\n      message: 'Selling Price must be a number'\r\n    });\r\n  }\r\n\r\n  return errors;\r\n};\r\n\r\nexport const generateUpdateErrorLogCSV = (errors: UpdateValidationError[]) => {\r\n  const headers = ['Row', 'Field', 'Error Message'];\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...errors.map(error =>\r\n      [error.row, error.field, `\"${error.message}\"`].join(',')\r\n    )\r\n  ].join('\\n');\r\n\r\n  const blob = new Blob([csvContent], { type: 'text/csv' });\r\n  const url = window.URL.createObjectURL(blob);\r\n  const link = document.createElement('a');\r\n  link.href = url;\r\n  link.download = 'product_update_errors.csv';\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  window.URL.revokeObjectURL(url);\r\n};\r\n\r\nexport const extractUpdateCategories = (validRows: CSVProductUpdateRow[]): string[] => {\r\n  const categories = validRows\r\n    .map(row => row['Category']?.trim())\r\n    .filter(category => category && category !== '');\r\n\r\n  return [...new Set(categories)];\r\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6191, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/hooks/useProductCSVUpdate.ts"],"sourcesContent":["import { useState } from 'react';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useCategories } from '@/hooks/useCategories';\r\nimport { CSVProductUpdateRow } from '@/utils/csvUpdateParser';\r\nimport { Product } from '@/types';\r\n\r\nexport interface ProductUpdateData {\r\n  productId: string;\r\n  itemNumber: string;\r\n  updates: {\r\n    name?: string;\r\n    category?: string;\r\n    quantity?: number;\r\n    costPrice?: number;\r\n    sellingPrice?: number;\r\n    supplier?: string;\r\n    description?: string;\r\n    manufacturerBarcode?: string;\r\n    barcode?: string;\r\n  };\r\n  quantityChange?: {\r\n    oldQuantity: number;\r\n    newQuantity: number;\r\n  };\r\n}\r\n\r\nexport const useProductCSVUpdate = (userId: string | undefined) => {\r\n  const [isUpdating, setIsUpdating] = useState(false);\r\n  const [updateProgress, setUpdateProgress] = useState<{ current: number; total: number } | null>(null);\r\n  const { toast } = useToast();\r\n  // Load all products by setting a very high page size\r\n  const { products, updateProduct } = useProducts(userId, 10000);\r\n  const { categories, createCategory } = useCategories(userId);\r\n\r\n  const validateUpdates = (\r\n    updateRows: CSVProductUpdateRow[]\r\n  ): { validUpdates: ProductUpdateData[]; errors: string[] } => {\r\n    const validUpdates: ProductUpdateData[] = [];\r\n    const errors: string[] = [];\r\n\r\n    updateRows.forEach((row, index) => {\r\n      const itemNumber = row['Item Number']?.trim();\r\n      // Handle leading zeros - Excel removes them but database has them\r\n      const paddedItemNumber = itemNumber?.padStart(4, '0');\r\n      const product = products.find(p =>\r\n        p.itemNumber === itemNumber || p.itemNumber === paddedItemNumber\r\n      );\r\n\r\n      if (!product) {\r\n        errors.push(`Row ${index + 1}: Product with Item Number \"${itemNumber}\" not found`);\r\n        return;\r\n      }\r\n\r\n      const updates: ProductUpdateData['updates'] = {};\r\n      let quantityChange: ProductUpdateData['quantityChange'] | undefined;\r\n\r\n      // Check each field for updates\r\n      if (row['Name']?.trim() && row['Name'].trim() !== product.name) {\r\n        updates.name = row['Name'].trim();\r\n      }\r\n\r\n      if (row['Category']?.trim() && row['Category'].trim() !== product.category) {\r\n        updates.category = row['Category'].trim();\r\n      }\r\n\r\n      if (row['Quantity']?.trim() !== '' && !isNaN(Number(row['Quantity']))) {\r\n        const newQuantity = Number(row['Quantity']);\r\n        if (newQuantity !== product.quantity) {\r\n          updates.quantity = newQuantity;\r\n          quantityChange = {\r\n            oldQuantity: product.quantity,\r\n            newQuantity: newQuantity\r\n          };\r\n        }\r\n      }\r\n\r\n      if (row['Cost Price']?.trim() !== '' && !isNaN(Number(row['Cost Price']))) {\r\n        const newCostPrice = Number(row['Cost Price']);\r\n        // Use precision-safe comparison for numbers\r\n        if (Math.abs(newCostPrice - product.costPrice) > 0.001) {\r\n          updates.costPrice = newCostPrice;\r\n        }\r\n      }\r\n\r\n      if (row['Selling Price']?.trim() !== '' && !isNaN(Number(row['Selling Price']))) {\r\n        const newSellingPrice = Number(row['Selling Price']);\r\n        // Use precision-safe comparison for numbers\r\n        if (Math.abs(newSellingPrice - product.sellingPrice) > 0.001) {\r\n          updates.sellingPrice = newSellingPrice;\r\n        }\r\n      }\r\n\r\n      if (row['Supplier']?.trim() && row['Supplier'].trim() !== (product.supplier || '')) {\r\n        updates.supplier = row['Supplier'].trim();\r\n      }\r\n\r\n      if (row['Description']?.trim() && row['Description'].trim() !== (product.description || '')) {\r\n        updates.description = row['Description'].trim();\r\n      }\r\n\r\n      if (row['Manufacturer Barcode']?.trim() !== undefined && row['Manufacturer Barcode'].trim() !== (product.manufacturerBarcode || '')) {\r\n        updates.manufacturerBarcode = row['Manufacturer Barcode'].trim();\r\n      }\r\n\r\n      if (row['Barcode']?.trim() !== undefined && row['Barcode'].trim() !== (product.barcode || '')) {\r\n        updates.barcode = row['Barcode'].trim();\r\n      }\r\n\r\n      // Only add if there are actual updates\r\n      if (Object.keys(updates).length > 0) {\r\n        validUpdates.push({\r\n          productId: product.id,\r\n          itemNumber: product.itemNumber,\r\n          updates,\r\n          quantityChange\r\n        });\r\n      }\r\n    });\r\n\r\n    return { validUpdates, errors };\r\n  };\r\n\r\n  const detectNewCategories = (updateRows: CSVProductUpdateRow[]): string[] => {\r\n    const existingCategories = categories.map(cat => cat.name);\r\n    const csvCategories = updateRows\r\n      .map(row => row['Category']?.trim())\r\n      .filter(category => category && category !== '');\r\n\r\n    return [...new Set(csvCategories)].filter(category => !existingCategories.includes(category));\r\n  };\r\n\r\n  const bulkUpdateProducts = async (\r\n    updateRows: CSVProductUpdateRow[],\r\n    onProgress?: (current: number, total: number) => void\r\n  ) => {\r\n    setIsUpdating(true);\r\n    setUpdateProgress({ current: 0, total: updateRows.length });\r\n\r\n    try {\r\n      // Validate updates\r\n      const { validUpdates, errors } = validateUpdates(updateRows);\r\n\r\n      if (errors.length > 0) {\r\n        throw new Error(`Validation errors: ${errors.join(', ')}`);\r\n      }\r\n\r\n      // Create new categories if needed\r\n      const newCategories = detectNewCategories(updateRows);\r\n      for (const categoryName of newCategories) {\r\n        await createCategory(categoryName);\r\n      }\r\n\r\n      // Update products\r\n      let successCount = 0;\r\n      let failureCount = 0;\r\n\r\n      for (let i = 0; i < validUpdates.length; i++) {\r\n        const updateData = validUpdates[i];\r\n\r\n        try {\r\n          console.log(`DEBUG: Calling updateProduct for ${updateData.itemNumber} with updates:`, updateData.updates);\r\n\r\n          // Update product - the updateProduct function will handle stock history for quantity changes\r\n          const success = await updateProduct(\r\n            updateData.productId,\r\n            updateData.updates,\r\n            undefined, // no image file\r\n            false, // not from sale\r\n            'CSV Edit' // custom change reason for stock history\r\n          );\r\n\r\n          console.log(`DEBUG: UpdateProduct result for ${updateData.itemNumber}: ${success}`);\r\n\r\n          if (success) {\r\n            successCount++;\r\n          } else {\r\n            failureCount++;\r\n          }\r\n        } catch (error) {\r\n          console.error(`Error updating product ${updateData.itemNumber}:`, error);\r\n          failureCount++;\r\n        }\r\n\r\n        const current = i + 1;\r\n        setUpdateProgress({ current, total: validUpdates.length });\r\n        onProgress?.(current, validUpdates.length);\r\n      }\r\n\r\n      if (successCount > 0) {\r\n        toast({\r\n          title: \"Products updated successfully\",\r\n          description: `${successCount} product${successCount > 1 ? 's' : ''} updated successfully`,\r\n        });\r\n      }\r\n\r\n      if (failureCount > 0) {\r\n        toast({\r\n          title: \"Some updates failed\",\r\n          description: `${failureCount} product${failureCount > 1 ? 's' : ''} could not be updated`,\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n\r\n      return { successCount, failureCount };\r\n\r\n    } catch (error) {\r\n      console.error('Bulk update failed:', error);\r\n      toast({\r\n        title: \"Update failed\",\r\n        description: error instanceof Error ? error.message : \"An error occurred during the update\",\r\n        variant: \"destructive\"\r\n      });\r\n      throw error;\r\n    } finally {\r\n      setIsUpdating(false);\r\n      setUpdateProgress(null);\r\n    }\r\n  };\r\n\r\n  return {\r\n    isUpdating,\r\n    updateProgress,\r\n    validateUpdates,\r\n    detectNewCategories,\r\n    bulkUpdateProducts\r\n  };\r\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6387, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/CSVUpdateDialog.tsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Upload, FileText, AlertCircle, CheckCircle, Download, Edit, Info } from 'lucide-react';\r\nimport { parseCSVUpdate, generateUpdateErrorLogCSV, UpdateValidationError, CSVProductUpdateRow, extractUpdateCategories } from '@/utils/csvUpdateParser';\r\nimport { cn } from '@/lib/utils';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useProductCSVUpdate } from '@/hooks/useProductCSVUpdate';\r\nimport { BulkOperationProgress } from './BulkOperationProgress';\r\n\r\ninterface CSVUpdateDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  userId: string | undefined;\r\n}\r\n\r\ninterface UpdateState {\r\n  step: 'select' | 'preview' | 'updating' | 'complete';\r\n  file: File | null;\r\n  validRows: CSVProductUpdateRow[];\r\n  errors: UpdateValidationError[];\r\n  totalRows: number;\r\n  updateProgress: number;\r\n  successCount: number;\r\n  failureCount: number;\r\n  newCategories: string[];\r\n  currentProductIndex: number;\r\n}\r\n\r\nconst CSVUpdateDialog: React.FC<CSVUpdateDialogProps> = ({\r\n  open,\r\n  onOpenChange,\r\n  userId\r\n}) => {\r\n  const { bulkUpdateProducts, detectNewCategories, isUpdating } = useProductCSVUpdate(userId);\r\n  const [state, setState] = useState<UpdateState>({\r\n    step: 'select',\r\n    file: null,\r\n    validRows: [],\r\n    errors: [],\r\n    totalRows: 0,\r\n    updateProgress: 0,\r\n    successCount: 0,\r\n    failureCount: 0,\r\n    newCategories: [],\r\n    currentProductIndex: 0\r\n  });\r\n\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n\r\n  const handleFileSelect = async (file: File) => {\r\n    if (!file.name.endsWith('.csv')) {\r\n      alert('Please select a CSV file');\r\n      return;\r\n    }\r\n\r\n    const text = await file.text();\r\n    const result = parseCSVUpdate(text);\r\n\r\n    // Detect new categories\r\n    const newCategories = detectNewCategories(result.validRows);\r\n\r\n    setState({\r\n      ...state,\r\n      step: 'preview',\r\n      file,\r\n      validRows: result.validRows,\r\n      errors: result.errors,\r\n      totalRows: result.totalRows,\r\n      newCategories\r\n    });\r\n  };\r\n\r\n  const handleFileInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      handleFileSelect(file);\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    setIsDragging(false);\r\n\r\n    const file = e.dataTransfer.files[0];\r\n    if (file) {\r\n      handleFileSelect(file);\r\n    }\r\n  };\r\n\r\n  const handleDragOver = (e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    setIsDragging(true);\r\n  };\r\n\r\n  const handleDragLeave = () => {\r\n    setIsDragging(false);\r\n  };\r\n\r\n  const handleConfirmUpdate = async () => {\r\n    setState(prev => ({ ...prev, step: 'updating', updateProgress: 0, currentProductIndex: 0 }));\r\n\r\n    try {\r\n      const result = await bulkUpdateProducts(state.validRows, (current, total) => {\r\n        const progress = Math.round((current / total) * 100);\r\n        setState(prev => ({\r\n          ...prev,\r\n          updateProgress: progress,\r\n          currentProductIndex: current\r\n        }));\r\n      });\r\n\r\n      setState(prev => ({\r\n        ...prev,\r\n        step: 'complete',\r\n        updateProgress: 100,\r\n        successCount: result.successCount,\r\n        failureCount: result.failureCount,\r\n        currentProductIndex: state.validRows.length\r\n      }));\r\n    } catch (error) {\r\n      console.error('Update failed:', error);\r\n      setState(prev => ({\r\n        ...prev,\r\n        step: 'complete',\r\n        updateProgress: 100,\r\n        successCount: 0,\r\n        failureCount: state.validRows.length,\r\n        currentProductIndex: state.validRows.length\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    if (isUpdating) return;\r\n\r\n    const wasSuccessfulUpdate = state.step === 'complete' && state.successCount > 0;\r\n\r\n    setState({\r\n      step: 'select',\r\n      file: null,\r\n      validRows: [],\r\n      errors: [],\r\n      totalRows: 0,\r\n      updateProgress: 0,\r\n      successCount: 0,\r\n      failureCount: 0,\r\n      newCategories: [],\r\n      currentProductIndex: 0\r\n    });\r\n\r\n    onOpenChange(false);\r\n\r\n    if (wasSuccessfulUpdate) {\r\n      setTimeout(() => {\r\n        window.location.reload();\r\n      }, 100);\r\n    }\r\n  };\r\n\r\n  const handleOpenChange = (newOpen: boolean) => {\r\n    if (!isUpdating) {\r\n      onOpenChange(newOpen);\r\n    }\r\n  };\r\n\r\n  const renderFileSelection = () => (\r\n    <div className=\"space-y-4\">\r\n      <div\r\n        className={cn(\r\n          \"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\",\r\n          isDragging ? \"border-blue-500 bg-blue-50\" : \"border-gray-300 hover:border-gray-400\"\r\n        )}\r\n        onDrop={handleDrop}\r\n        onDragOver={handleDragOver}\r\n        onDragLeave={handleDragLeave}\r\n        onClick={() => fileInputRef.current?.click()}\r\n      >\r\n        <Upload className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\r\n        <p className=\"text-lg font-medium text-gray-900 mb-2\">\r\n          Upload CSV File for Product Updates\r\n        </p>\r\n        <p className=\"text-sm text-gray-500\">\r\n          Drag and drop your CSV file here, or click to browse\r\n        </p>\r\n        <p className=\"text-xs text-gray-400 mt-2\">\r\n          Make sure the CSV includes Item Number column for product identification\r\n        </p>\r\n      </div>\r\n\r\n      <input\r\n        ref={fileInputRef}\r\n        type=\"file\"\r\n        accept=\".csv\"\r\n        onChange={handleFileInputChange}\r\n        className=\"hidden\"\r\n      />\r\n    </div>\r\n  );\r\n\r\n  const renderPreview = () => (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"grid grid-cols-3 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-2xl font-bold text-blue-600\">{state.validRows.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Products to update</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-2xl font-bold text-red-600\">{state.errors.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Errors found</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-2xl font-bold text-green-600\">{state.totalRows}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Total rows</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {state.newCategories.length > 0 && (\r\n        <Alert>\r\n          <Edit className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            <div className=\"space-y-2\">\r\n              <p>The following {state.newCategories.length} new categories will be created:</p>\r\n              <div className=\"flex flex-wrap gap-1\">\r\n                {state.newCategories.map((category, index) => (\r\n                  <Badge key={index} variant=\"outline\" className=\"text-xs\">\r\n                    {category}\r\n                  </Badge>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {state.errors.length > 0 && (\r\n        <Alert variant=\"destructive\">\r\n          <AlertCircle className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            {state.errors.length} rows have errors and will be skipped.\r\n            <Button\r\n              variant=\"link\"\r\n              className=\"p-0 h-auto ml-2\"\r\n              onClick={() => generateUpdateErrorLogCSV(state.errors)}\r\n            >\r\n              <Download className=\"h-3 w-3 mr-1\" />\r\n              Download error log\r\n            </Button>\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      <Alert>\r\n        <Info className=\"h-4 w-4\" />\r\n        <AlertDescription>\r\n          <div className=\"space-y-1\">\r\n            <p><strong>Update Rules:</strong></p>\r\n            <ul className=\"text-sm space-y-1 ml-2\">\r\n              <li>• Only fields with changes will be updated</li>\r\n              <li>• Empty fields will be ignored (no changes)</li>\r\n              <li>• Quantity changes will be tracked in stock history</li>\r\n              <li>• Products are identified by Item Number</li>\r\n            </ul>\r\n          </div>\r\n        </AlertDescription>\r\n      </Alert>\r\n\r\n      <div className=\"flex justify-end space-x-2\">\r\n        <Button variant=\"outline\" onClick={() => setState(prev => ({ ...prev, step: 'select' }))}>\r\n          Back\r\n        </Button>\r\n        <Button\r\n          onClick={handleConfirmUpdate}\r\n          disabled={state.validRows.length === 0}\r\n        >\r\n          Update {state.validRows.length} Products\r\n          {state.newCategories.length > 0 && ` & Create ${state.newCategories.length} Categories`}\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderUpdating = () => (\r\n    <BulkOperationProgress\r\n      title=\"Updating Products...\"\r\n      currentCount={state.currentProductIndex}\r\n      totalCount={state.validRows.length}\r\n      status=\"processing\"\r\n    />\r\n  );\r\n\r\n  const renderComplete = () => (\r\n    <div className=\"space-y-4\">\r\n      <BulkOperationProgress\r\n        title=\"Update Complete!\"\r\n        currentCount={state.currentProductIndex}\r\n        totalCount={state.validRows.length}\r\n        status={state.failureCount > 0 ? 'failed' : 'completed'}\r\n        successCount={state.successCount}\r\n        failureCount={state.failureCount}\r\n      />\r\n      <div className=\"flex justify-center\">\r\n        <Button onClick={handleClose}>Close</Button>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleOpenChange}>\r\n      <DialogContent className=\"sm:max-w-[500px] pointer-events-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <FileText className=\"h-5 w-5\" />\r\n            Update Products via CSV\r\n          </DialogTitle>\r\n          <DialogDescription>\r\n            Update existing products using a CSV file with Item Numbers for identification\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        {state.step === 'select' && renderFileSelection()}\r\n        {state.step === 'preview' && renderPreview()}\r\n        {state.step === 'updating' && renderUpdating()}\r\n        {state.step === 'complete' && renderComplete()}\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default CSVUpdateDialog;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7049, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/ui/switch.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Switch = React.forwardRef<\r\n  React.ElementRef<typeof SwitchPrimitives.Root>,\r\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\r\n>(({ className, ...props }, ref) => (\r\n  <SwitchPrimitives.Root\r\n    className={cn(\r\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\r\n      className\r\n    )}\r\n    {...props}\r\n    ref={ref}\r\n  >\r\n    <SwitchPrimitives.Thumb\r\n      className={cn(\r\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\r\n      )}\r\n    />\r\n  </SwitchPrimitives.Root>\r\n))\r\nSwitch.displayName = SwitchPrimitives.Root.displayName\r\n\r\nexport { Switch }\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,uBAAS,2KAAgB,MAG7B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,6KAAqB;QACpB,WAAW,IAAA,4HAAE,EACX,sXACA;QAED,GAAG,KAAK;QACT,KAAK;kBAEL,cAAA,6LAAC,8KAAsB;YACrB,WAAW,IAAA,4HAAE,EACX;;;;;;;;;;;;AAKR,OAAO,WAAW,GAAG,6KAAqB,CAAC,WAAW"}},
    {"offset": {"line": 7090, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/BulkPrintDialog.tsx"],"sourcesContent":["\r\nimport React, { useState } from 'react';\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Product } from '@/types';\r\nimport { BulkOperationProgress } from './BulkOperationProgress';\r\nimport { Printer, Settings2 } from 'lucide-react';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Label } from '@/components/ui/label';\r\n\r\ninterface BulkPrintDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    selectedProducts: Product[];\r\n    onConfirm: (showPrice: boolean) => void;\r\n    isPrinting: boolean;\r\n    printProgress?: {\r\n        current: number;\r\n        total: number;\r\n    };\r\n}\r\n\r\nconst BulkPrintDialog: React.FC<BulkPrintDialogProps> = ({\r\n    open,\r\n    onOpenChange,\r\n    selectedProducts,\r\n    onConfirm,\r\n    isPrinting,\r\n    printProgress\r\n}) => {\r\n    const [showPrice, setShowPrice] = useState(true);\r\n\r\n    // Prevent dialog from closing during printing process\r\n    const handleOpenChange = (newOpen: boolean) => {\r\n        if (!isPrinting) {\r\n            onOpenChange(newOpen);\r\n        }\r\n    };\r\n\r\n    const productCount = selectedProducts.length;\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={handleOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[425px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle className=\"flex items-center gap-2\">\r\n                        <Printer className=\"h-5 w-5\" />\r\n                        Print Barcode Labels\r\n                    </DialogTitle>\r\n                    <DialogDescription>\r\n                        You are about to print barcodes for {productCount} product{productCount > 1 ? 's' : ''}.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <div className=\"space-y-4 py-4\">\r\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg bg-muted/30\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Settings2 className=\"h-4 w-4 text-muted-foreground\" />\r\n                            <div className=\"space-y-0.5\">\r\n                                <Label htmlFor=\"bulk-print-price\" className=\"text-sm font-medium cursor-pointer\">\r\n                                    Show Price on Label\r\n                                </Label>\r\n                                <p className=\"text-xs text-muted-foreground\">Include selling price on each label</p>\r\n                            </div>\r\n                        </div>\r\n                        <Switch\r\n                            id=\"bulk-print-price\"\r\n                            checked={showPrice}\r\n                            onCheckedChange={setShowPrice}\r\n                            disabled={isPrinting}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"max-h-40 overflow-y-auto border rounded-md p-2 bg-muted/10\">\r\n                        <div className=\"space-y-1\">\r\n                            {selectedProducts.map((product) => (\r\n                                <div key={product.id} className=\"text-xs text-muted-foreground truncate px-2 py-1\">\r\n                                    • {product.name} ({product.itemNumber})\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Progress Bar */}\r\n                {isPrinting && printProgress && (\r\n                    <BulkOperationProgress\r\n                        title=\"Printing Labels...\"\r\n                        currentCount={printProgress.current}\r\n                        totalCount={printProgress.total}\r\n                        status=\"processing\"\r\n                    />\r\n                )}\r\n\r\n                <DialogFooter>\r\n                    <Button\r\n                        variant=\"outline\"\r\n                        onClick={() => handleOpenChange(false)}\r\n                        disabled={isPrinting}\r\n                    >\r\n                        Cancel\r\n                    </Button>\r\n                    <Button\r\n                        onClick={() => onConfirm(showPrice)}\r\n                        disabled={isPrinting || productCount === 0}\r\n                        className=\"gap-2\"\r\n                    >\r\n                        {isPrinting ? (\r\n                            `Printing... ${Math.round((printProgress?.current || 0) / (printProgress?.total || 1) * 100)}%`\r\n                        ) : (\r\n                            <>\r\n                                <Printer className=\"h-4 w-4\" />\r\n                                Print {productCount} Label{productCount > 1 ? 's' : ''}\r\n                            </>\r\n                        )}\r\n                    </Button>\r\n                </DialogFooter>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n};\r\n\r\nexport default BulkPrintDialog;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAQA;AAEA;AACA;AAAA;AACA;AACA;;;;;;;;;;AAcA,MAAM,kBAAkD,CAAC,EACrD,IAAI,EACJ,YAAY,EACZ,gBAAgB,EAChB,SAAS,EACT,UAAU,EACV,aAAa,EAChB;;IACG,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,sDAAsD;IACtD,MAAM,mBAAmB,CAAC;QACtB,IAAI,CAAC,YAAY;YACb,aAAa;QACjB;IACJ;IAEA,MAAM,eAAe,iBAAiB,MAAM;IAE5C,qBACI,6LAAC,+IAAM;QAAC,MAAM;QAAM,cAAc;kBAC9B,cAAA,6LAAC,sJAAa;YAAC,WAAU;;8BACrB,6LAAC,qJAAY;;sCACT,6LAAC,oJAAW;4BAAC,WAAU;;8CACnB,6LAAC,sNAAO;oCAAC,WAAU;;;;;;gCAAY;;;;;;;sCAGnC,6LAAC,0JAAiB;;gCAAC;gCACsB;gCAAa;gCAAS,eAAe,IAAI,MAAM;gCAAG;;;;;;;;;;;;;8BAI/F,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAI,WAAU;;sDACX,6LAAC,gOAAS;4CAAC,WAAU;;;;;;sDACrB,6LAAC;4CAAI,WAAU;;8DACX,6LAAC,6IAAK;oDAAC,SAAQ;oDAAmB,WAAU;8DAAqC;;;;;;8DAGjF,6LAAC;oDAAE,WAAU;8DAAgC;;;;;;;;;;;;;;;;;;8CAGrD,6LAAC,+IAAM;oCACH,IAAG;oCACH,SAAS;oCACT,iBAAiB;oCACjB,UAAU;;;;;;;;;;;;sCAIlB,6LAAC;4BAAI,WAAU;sCACX,cAAA,6LAAC;gCAAI,WAAU;0CACV,iBAAiB,GAAG,CAAC,CAAC,wBACnB,6LAAC;wCAAqB,WAAU;;4CAAmD;4CAC5E,QAAQ,IAAI;4CAAC;4CAAG,QAAQ,UAAU;4CAAC;;uCADhC,QAAQ,EAAE;;;;;;;;;;;;;;;;;;;;;gBASnC,cAAc,+BACX,6LAAC,oLAAqB;oBAClB,OAAM;oBACN,cAAc,cAAc,OAAO;oBACnC,YAAY,cAAc,KAAK;oBAC/B,QAAO;;;;;;8BAIf,6LAAC,qJAAY;;sCACT,6LAAC,+IAAM;4BACH,SAAQ;4BACR,SAAS,IAAM,iBAAiB;4BAChC,UAAU;sCACb;;;;;;sCAGD,6LAAC,+IAAM;4BACH,SAAS,IAAM,UAAU;4BACzB,UAAU,cAAc,iBAAiB;4BACzC,WAAU;sCAET,aACG,CAAC,YAAY,EAAE,KAAK,KAAK,CAAC,CAAC,eAAe,WAAW,CAAC,IAAI,CAAC,eAAe,SAAS,CAAC,IAAI,KAAK,CAAC,CAAC,iBAE/F;;kDACI,6LAAC,sNAAO;wCAAC,WAAU;;;;;;oCAAY;oCACxB;oCAAa;oCAAO,eAAe,IAAI,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;AAQpF;GAlGM;KAAA;uCAoGS"}},
    {"offset": {"line": 7340, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/BarcodeExportDialog.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group';\r\nimport { Download } from 'lucide-react';\r\n\r\nexport interface BarcodeExportConfig {\r\n    showPrice: boolean;\r\n}\r\n\r\ninterface BarcodeExportDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    productCount: number;\r\n    onConfirm: (config: BarcodeExportConfig) => void;\r\n    isExporting: boolean;\r\n}\r\n\r\nconst BarcodeExportDialog: React.FC<BarcodeExportDialogProps> = ({\r\n    open,\r\n    onOpenChange,\r\n    productCount,\r\n    onConfirm,\r\n    isExporting,\r\n}) => {\r\n    const [showPrice, setShowPrice] = useState(true);\r\n\r\n    const handleConfirm = () => {\r\n        onConfirm({\r\n            showPrice,\r\n        });\r\n    };\r\n\r\n    // Standardized calculation for A4 (210x297mm) with 10mm margins\r\n    // 50x30mm labels with 2mm spacing\r\n    const calculateLayout = () => {\r\n        const labelWidth = 45;\r\n        const labelHeight = 30;\r\n        const spacing = 2;\r\n        const pageWidth = 210;\r\n        const pageHeight = 297;\r\n        const margin = 10;\r\n\r\n        const cols = Math.floor((pageWidth - (2 * margin) + spacing) / (labelWidth + spacing));\r\n        const rows = Math.floor((pageHeight - (2 * margin) + spacing) / (labelHeight + spacing));\r\n\r\n        return { cols, rows, itemsPerPage: cols * rows };\r\n    };\r\n\r\n    const calculatePages = () => {\r\n        const { itemsPerPage } = calculateLayout();\r\n        return Math.ceil(productCount / itemsPerPage);\r\n    };\r\n\r\n    const { cols, rows, itemsPerPage } = calculateLayout();\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-md\">\r\n                <DialogHeader>\r\n                    <DialogTitle>Export Barcodes to PDF</DialogTitle>\r\n                    <DialogDescription>\r\n                        Barcodes are automatically arranged on A4 paper (45mm × 30mm labels).\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <div className=\"space-y-6 py-4\">\r\n                    {/* Product Count Info */}\r\n                    <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\r\n                        <p className=\"text-sm text-blue-900\">\r\n                            <strong>{productCount}</strong> product{productCount !== 1 ? 's' : ''} with barcodes will be exported\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Layout Info */}\r\n                    <div className=\"space-y-2\">\r\n                        <Label className=\"text-base font-semibold\">Automatic Layout</Label>\r\n                        <div className=\"text-sm text-muted-foreground space-y-1\">\r\n                            <p>• {cols} columns × {rows} rows</p>\r\n                            <p>• {itemsPerPage} barcodes per page</p>\r\n                            <p>• Fixed size: 45mm × 30mm</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Show Price Toggle */}\r\n                    <div className=\"flex items-center justify-between py-2 border-t\">\r\n                        <div className=\"space-y-0.5\">\r\n                            <Label className=\"text-sm font-medium\">Include Price</Label>\r\n                            <p className=\"text-xs text-muted-foreground\">Show product price on each barcode</p>\r\n                        </div>\r\n                        <Switch\r\n                            checked={showPrice}\r\n                            onCheckedChange={setShowPrice}\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Estimated Pages */}\r\n                    <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-3\">\r\n                        <p className=\"text-sm text-gray-700\">\r\n                            <strong>Estimated pages:</strong> {calculatePages()}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Actions */}\r\n                <div className=\"flex flex-col gap-2\">\r\n                    <Button\r\n                        onClick={handleConfirm}\r\n                        disabled={isExporting}\r\n                        className=\"w-full gap-2\"\r\n                    >\r\n                        <Download className=\"h-4 w-4\" />\r\n                        {isExporting ? 'Exporting...' : 'Export PDF'}\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"outline\"\r\n                        onClick={() => onOpenChange(false)}\r\n                        disabled={isExporting}\r\n                        className=\"w-full\"\r\n                    >\r\n                        Cancel\r\n                    </Button>\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n};\r\n\r\nexport default BarcodeExportDialog;\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;AAcA,MAAM,sBAA0D,CAAC,EAC7D,IAAI,EACJ,YAAY,EACZ,YAAY,EACZ,SAAS,EACT,WAAW,EACd;;IACG,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,MAAM,gBAAgB;QAClB,UAAU;YACN;QACJ;IACJ;IAEA,gEAAgE;IAChE,kCAAkC;IAClC,MAAM,kBAAkB;QACpB,MAAM,aAAa;QACnB,MAAM,cAAc;QACpB,MAAM,UAAU;QAChB,MAAM,YAAY;QAClB,MAAM,aAAa;QACnB,MAAM,SAAS;QAEf,MAAM,OAAO,KAAK,KAAK,CAAC,CAAC,YAAa,IAAI,SAAU,OAAO,IAAI,CAAC,aAAa,OAAO;QACpF,MAAM,OAAO,KAAK,KAAK,CAAC,CAAC,aAAc,IAAI,SAAU,OAAO,IAAI,CAAC,cAAc,OAAO;QAEtF,OAAO;YAAE;YAAM;YAAM,cAAc,OAAO;QAAK;IACnD;IAEA,MAAM,iBAAiB;QACnB,MAAM,EAAE,YAAY,EAAE,GAAG;QACzB,OAAO,KAAK,IAAI,CAAC,eAAe;IACpC;IAEA,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,YAAY,EAAE,GAAG;IAErC,qBACI,6LAAC,+IAAM;QAAC,MAAM;QAAM,cAAc;kBAC9B,cAAA,6LAAC,sJAAa;YAAC,WAAU;;8BACrB,6LAAC,qJAAY;;sCACT,6LAAC,oJAAW;sCAAC;;;;;;sCACb,6LAAC,0JAAiB;sCAAC;;;;;;;;;;;;8BAKvB,6LAAC;oBAAI,WAAU;;sCAEX,6LAAC;4BAAI,WAAU;sCACX,cAAA,6LAAC;gCAAE,WAAU;;kDACT,6LAAC;kDAAQ;;;;;;oCAAsB;oCAAS,iBAAiB,IAAI,MAAM;oCAAG;;;;;;;;;;;;sCAK9E,6LAAC;4BAAI,WAAU;;8CACX,6LAAC,6IAAK;oCAAC,WAAU;8CAA0B;;;;;;8CAC3C,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;;gDAAE;gDAAG;gDAAK;gDAAY;gDAAK;;;;;;;sDAC5B,6LAAC;;gDAAE;gDAAG;gDAAa;;;;;;;sDACnB,6LAAC;sDAAE;;;;;;;;;;;;;;;;;;sCAKX,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAI,WAAU;;sDACX,6LAAC,6IAAK;4CAAC,WAAU;sDAAsB;;;;;;sDACvC,6LAAC;4CAAE,WAAU;sDAAgC;;;;;;;;;;;;8CAEjD,6LAAC,+IAAM;oCACH,SAAS;oCACT,iBAAiB;;;;;;;;;;;;sCAKzB,6LAAC;4BAAI,WAAU;sCACX,cAAA,6LAAC;gCAAE,WAAU;;kDACT,6LAAC;kDAAO;;;;;;oCAAyB;oCAAE;;;;;;;;;;;;;;;;;;8BAM/C,6LAAC;oBAAI,WAAU;;sCACX,6LAAC,+IAAM;4BACH,SAAS;4BACT,UAAU;4BACV,WAAU;;8CAEV,6LAAC,yNAAQ;oCAAC,WAAU;;;;;;gCACnB,cAAc,iBAAiB;;;;;;;sCAEpC,6LAAC,+IAAM;4BACH,SAAQ;4BACR,SAAS,IAAM,aAAa;4BAC5B,UAAU;4BACV,WAAU;sCACb;;;;;;;;;;;;;;;;;;;;;;;AAOrB;GA5GM;KAAA;uCA8GS"}},
    {"offset": {"line": 7639, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/csvTemplate.ts"],"sourcesContent":["\r\nexport const generateProductCSVTemplate = () => {\r\n  const headers = [\r\n    'Product Name',\r\n    'Category',\r\n    'Description',\r\n    'Supplier',\r\n    'Creation Date',\r\n    'Initial Stock',\r\n    'Minimum Stock Level',\r\n    'Cost Price',\r\n    'Selling Price'\r\n  ];\r\n\r\n  const sampleData = [\r\n    [\r\n      '\"Sample Product with, commas\"',\r\n      'Electronics',\r\n      '\"A detailed product description, with commas and other punctuation!\"',\r\n      '\"Supplier Name, Inc.\"',\r\n      '15/01/2024',\r\n      '10',\r\n      '5',\r\n      '50.00',\r\n      '75.00'\r\n    ],\r\n    [\r\n      'Simple Product Name',\r\n      'Home & Garden',\r\n      'Basic description without commas',\r\n      'Basic Supplier',\r\n      '2024-01-16',\r\n      '-5',\r\n      '0',\r\n      '-25.50',\r\n      '100.75'\r\n    ]\r\n  ];\r\n\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...sampleData.map(row => row.join(','))\r\n  ].join('\\n');\r\n\r\n  const blob = new Blob([csvContent], { type: 'text/csv' });\r\n  const url = window.URL.createObjectURL(blob);\r\n  const link = document.createElement('a');\r\n  link.href = url;\r\n  link.download = 'product_template.csv';\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  window.URL.revokeObjectURL(url);\r\n};\r\n\r\nexport const generateTransactionCSVTemplate = () => {\r\n  const headers = [\r\n    'Date',\r\n    'Type',\r\n    'Amount',\r\n    'Description',\r\n    'Category',\r\n    'Payment Method',\r\n    'Person In Charge',\r\n    'To Account'\r\n  ];\r\n\r\n  const sampleData = [\r\n    [\r\n      '22/12/2025',\r\n      'cash_in',\r\n      '1500.00',\r\n      'Sales income from morning shift',\r\n      'Sales',\r\n      'Cash',\r\n      'John Doe',\r\n      ''\r\n    ],\r\n    [\r\n      '22/12/2025',\r\n      'cash_out',\r\n      '200.50',\r\n      'Purchased cleaning supplies',\r\n      'Expenses',\r\n      'Cash',\r\n      'Jane Smith',\r\n      ''\r\n    ],\r\n    [\r\n      '22/12/2025',\r\n      'transfer',\r\n      '5000.00',\r\n      'Moving funds to main safe',\r\n      'Internal',\r\n      '',\r\n      'Admin',\r\n      'Main Safe'\r\n    ]\r\n  ];\r\n\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...sampleData.map(row => row.join(','))\r\n  ].join('\\n');\r\n\r\n  const blob = new Blob([csvContent], { type: 'text/csv' });\r\n  const url = window.URL.createObjectURL(blob);\r\n  const link = document.createElement('a');\r\n  link.href = url;\r\n  link.download = 'transaction_template.csv';\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  window.URL.revokeObjectURL(url);\r\n};\r\n"],"names":[],"mappings":";;;;;;AACO,MAAM,6BAA6B;IACxC,MAAM,UAAU;QACd;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,MAAM,aAAa;QACjB;YACE;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;SACD;QACD;YACE;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;SACD;KACF;IAED,MAAM,aAAa;QACjB,QAAQ,IAAI,CAAC;WACV,WAAW,GAAG,CAAC,CAAA,MAAO,IAAI,IAAI,CAAC;KACnC,CAAC,IAAI,CAAC;IAEP,MAAM,OAAO,IAAI,KAAK;QAAC;KAAW,EAAE;QAAE,MAAM;IAAW;IACvD,MAAM,MAAM,OAAO,GAAG,CAAC,eAAe,CAAC;IACvC,MAAM,OAAO,SAAS,aAAa,CAAC;IACpC,KAAK,IAAI,GAAG;IACZ,KAAK,QAAQ,GAAG;IAChB,SAAS,IAAI,CAAC,WAAW,CAAC;IAC1B,KAAK,KAAK;IACV,SAAS,IAAI,CAAC,WAAW,CAAC;IAC1B,OAAO,GAAG,CAAC,eAAe,CAAC;AAC7B;AAEO,MAAM,iCAAiC;IAC5C,MAAM,UAAU;QACd;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,MAAM,aAAa;QACjB;YACE;YACA;YACA;YACA;YACA;YACA;YACA;YACA;SACD;QACD;YACE;YACA;YACA;YACA;YACA;YACA;YACA;YACA;SACD;QACD;YACE;YACA;YACA;YACA;YACA;YACA;YACA;YACA;SACD;KACF;IAED,MAAM,aAAa;QACjB,QAAQ,IAAI,CAAC;WACV,WAAW,GAAG,CAAC,CAAA,MAAO,IAAI,IAAI,CAAC;KACnC,CAAC,IAAI,CAAC;IAEP,MAAM,OAAO,IAAI,KAAK;QAAC;KAAW,EAAE;QAAE,MAAM;IAAW;IACvD,MAAM,MAAM,OAAO,GAAG,CAAC,eAAe,CAAC;IACvC,MAAM,OAAO,SAAS,aAAa,CAAC;IACpC,KAAK,IAAI,GAAG;IACZ,KAAK,QAAQ,GAAG;IAChB,SAAS,IAAI,CAAC,WAAW,CAAC;IAC1B,KAAK,KAAK;IACV,SAAS,IAAI,CAAC,WAAW,CAAC;IAC1B,OAAO,GAAG,CAAC,eAAe,CAAC;AAC7B"}},
    {"offset": {"line": 7767, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/utils/exportBarcodeToPDF.ts"],"sourcesContent":["import React from 'react';\r\nimport jsPDF from 'jspdf';\r\nimport html2canvas from 'html2canvas';\r\nimport Barcode from 'react-barcode';\r\nimport { createRoot } from 'react-dom/client';\r\nimport { Product } from '@/types';\r\n\r\ninterface BarcodeExportOptions {\r\n    productName: string;\r\n    barcodeValue: string;\r\n    price?: number;\r\n    currency?: string;\r\n    showPrice?: boolean;\r\n}\r\n\r\n/**\r\n * Render barcode to canvas and return image data URL\r\n */\r\nconst renderBarcodeToImage = async (options: BarcodeExportOptions): Promise<string> => {\r\n    const { productName, barcodeValue, price, currency = 'KES', showPrice = true } = options;\r\n\r\n    // Create a temporary container\r\n    const container = document.createElement('div');\r\n    container.style.position = 'absolute';\r\n    container.style.left = '-9999px';\r\n    container.style.top = '-9999px';\r\n    container.style.width = '300px'; // Base width for 50mm label\r\n    container.style.padding = '15px';\r\n    container.style.backgroundColor = 'white';\r\n    container.style.fontFamily = 'Arial, sans-serif';\r\n    document.body.appendChild(container);\r\n\r\n    try {\r\n        // Create the barcode container with styling\r\n        const barcodeContainer = document.createElement('div');\r\n        barcodeContainer.style.display = 'flex';\r\n        barcodeContainer.style.flexDirection = 'column';\r\n        barcodeContainer.style.alignItems = 'center';\r\n        barcodeContainer.style.gap = '8px';\r\n\r\n        // Product name\r\n        const nameElement = document.createElement('div');\r\n        nameElement.textContent = productName.length > 30 ? productName.substring(0, 27) + '...' : productName;\r\n        nameElement.style.fontSize = '14px';\r\n        nameElement.style.fontWeight = 'bold';\r\n        nameElement.style.textAlign = 'center';\r\n        nameElement.style.maxWidth = '100%';\r\n        nameElement.style.wordWrap = 'break-word';\r\n        barcodeContainer.appendChild(nameElement);\r\n\r\n        // Barcode SVG container\r\n        const svgContainer = document.createElement('div');\r\n        svgContainer.id = 'barcode-svg-container';\r\n        barcodeContainer.appendChild(svgContainer);\r\n\r\n        // Price (if applicable)\r\n        if (showPrice && price !== undefined) {\r\n            const priceElement = document.createElement('div');\r\n            priceElement.textContent = `${currency} ${price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;\r\n            priceElement.style.fontSize = '14px';\r\n            priceElement.style.fontWeight = 'bold';\r\n            priceElement.style.textAlign = 'center';\r\n            barcodeContainer.appendChild(priceElement);\r\n        }\r\n\r\n        container.appendChild(barcodeContainer);\r\n\r\n        // Render the barcode using React\r\n        const root = createRoot(svgContainer);\r\n        await new Promise<void>((resolve) => {\r\n            const BarcodeComponent = Barcode as any;\r\n            root.render(\r\n                React.createElement(BarcodeComponent, {\r\n                    value: barcodeValue,\r\n                    width: 1.5,\r\n                    height: 60,\r\n                    fontSize: 12\r\n                })\r\n            );\r\n            // Give React time to render\r\n            setTimeout(() => resolve(), 100);\r\n        });\r\n\r\n        // Convert to canvas\r\n        const canvas = await html2canvas(container, {\r\n            backgroundColor: '#ffffff',\r\n            scale: 2,\r\n        });\r\n\r\n        // Get image data URL\r\n        const imageDataUrl = canvas.toDataURL('image/jpeg', 0.95);\r\n\r\n        // Cleanup\r\n        root.unmount();\r\n        document.body.removeChild(container);\r\n\r\n        return imageDataUrl;\r\n    } catch (error) {\r\n        document.body.removeChild(container);\r\n        throw error;\r\n    }\r\n};\r\n\r\n/**\r\n * Export a single barcode as a PDF file\r\n */\r\nexport const exportSingleBarcodeToPDF = async (options: BarcodeExportOptions): Promise<void> => {\r\n    try {\r\n        const imageDataUrl = await renderBarcodeToImage(options);\r\n\r\n        // Create PDF\r\n        const pdf = new jsPDF({\r\n            orientation: 'portrait',\r\n            unit: 'mm',\r\n            format: 'a4',\r\n        });\r\n\r\n        // Add title\r\n        pdf.setFontSize(16);\r\n        pdf.text('Product Barcode', 105, 20, { align: 'center' });\r\n\r\n        // Add barcode image centered - Fixed 45x30mm\r\n        const imgWidth = 45;\r\n        const imgHeight = 30;\r\n        const x = (210 - imgWidth) / 2; // Center on A4 width (210mm)\r\n        const y = 40;\r\n\r\n        pdf.addImage(imageDataUrl, 'JPEG', x, y, imgWidth, imgHeight);\r\n\r\n        // Save PDF\r\n        const sanitizedName = options.productName.replace(/[^a-z0-9]/gi, '_').toLowerCase();\r\n        pdf.save(`barcode_${sanitizedName}_${Date.now()}.pdf`);\r\n    } catch (error) {\r\n        console.error('Error exporting barcode to PDF:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n/**\r\n * Export multiple barcodes to a single PDF file\r\n */\r\nexport const exportBulkBarcodesToPDF = async (\r\n    products: Product[],\r\n    options: { showPrice?: boolean; currency?: string } = {}\r\n): Promise<void> => {\r\n    const { showPrice = true, currency = 'KES' } = options;\r\n\r\n    try {\r\n        // Filter products with barcodes\r\n        const productsWithBarcodes = products.filter(p => p.barcode);\r\n\r\n        if (productsWithBarcodes.length === 0) {\r\n            throw new Error('No products with barcodes to export');\r\n        }\r\n\r\n        const pdf = new jsPDF({\r\n            orientation: 'portrait',\r\n            unit: 'mm',\r\n            format: 'a4',\r\n        });\r\n\r\n        // Layout configuration - Standardized 45x30mm labels\r\n        const labelWidth = 45;\r\n        const labelHeight = 30;\r\n        const spacing = 2; // Reduced spacing for better fit\r\n        const pageWidth = 210; // A4 width in mm\r\n        const pageHeight = 297; // A4 height in mm\r\n        const margin = 10;\r\n\r\n        // Calculate how many labels fit across (columns)\r\n        const cols = Math.floor((pageWidth - (2 * margin) + spacing) / (labelWidth + spacing));\r\n        // Calculate how many labels fit down (rows)\r\n        const rows = Math.floor((pageHeight - (2 * margin) + spacing) / (labelHeight + spacing));\r\n\r\n        const itemsPerPage = cols * rows;\r\n\r\n        // Calculate centered margins based on calculated grid\r\n        const totalGridWidth = (cols * labelWidth) + ((cols - 1) * spacing);\r\n        const totalGridHeight = (rows * labelHeight) + ((rows - 1) * spacing);\r\n\r\n        const marginX = (pageWidth - totalGridWidth) / 2;\r\n        const marginY = (pageHeight - totalGridHeight) / 2;\r\n\r\n        let itemCount = 0;\r\n\r\n        for (const product of productsWithBarcodes) {\r\n            if (itemCount > 0 && itemCount % itemsPerPage === 0) {\r\n                pdf.addPage();\r\n            }\r\n\r\n            const pageIndex = itemCount % itemsPerPage;\r\n            const row = Math.floor(pageIndex / cols);\r\n            const col = pageIndex % cols;\r\n\r\n            const x = marginX + (col * (labelWidth + spacing));\r\n            const y = marginY + (row * (labelHeight + spacing));\r\n\r\n            // Render barcode to image\r\n            const imageDataUrl = await renderBarcodeToImage({\r\n                productName: product.name,\r\n                barcodeValue: product.barcode!,\r\n                price: product.sellingPrice,\r\n                currency,\r\n                showPrice,\r\n            });\r\n\r\n            // Add border for visual separation (optional)\r\n            pdf.setDrawColor(200, 200, 200);\r\n            pdf.rect(x, y, labelWidth, labelHeight);\r\n\r\n            // Add barcode image\r\n            const imgWidth = labelWidth - 4;\r\n            const imgHeight = labelHeight - 4;\r\n            pdf.addImage(imageDataUrl, 'JPEG', x + 2, y + 2, imgWidth, imgHeight);\r\n\r\n            itemCount++;\r\n        }\r\n\r\n        // Add summary on first page\r\n        pdf.setPage(1);\r\n        pdf.setFontSize(10);\r\n        pdf.setTextColor(100, 100, 100);\r\n        pdf.text(`Total barcodes: ${productsWithBarcodes.length}`, 105, 5, { align: 'center' });\r\n\r\n        // Save PDF\r\n        const timestamp = new Date().toISOString().split('T')[0];\r\n        pdf.save(`barcodes_bulk_${timestamp}_${productsWithBarcodes.length}_items.pdf`);\r\n    } catch (error) {\r\n        console.error('Error exporting bulk barcodes to PDF:', error);\r\n        throw error;\r\n    }\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7966, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/pages/Products.tsx"],"sourcesContent":["import React, { useState, useMemo, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Plus, RefreshCw, Download, Upload, Trash2, ArrowLeft, Printer } from 'lucide-react';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport InventoryTable from '@/components/inventory/InventoryTable';\r\nimport InventoryFilters from '@/components/inventory/InventoryFilters';\r\nimport InventoryStats from '@/components/inventory/InventoryStats';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport { exportProductsForUpdate } from '@/utils/exportProductsForUpdate';\r\nimport { exportProductsToCSV } from '@/utils/exportProductsToCSV';\r\nimport { exportProductsToPDF } from '@/utils/exportProductsToPDF';\r\nimport LoadingSpinner from '@/components/LoadingSpinner';\r\nimport BulkDeleteDialog from '@/components/inventory/BulkDeleteDialog';\r\nimport CSVUploadDialog from '@/components/inventory/CSVUploadDialog';\r\nimport CSVUpdateDialog from '@/components/inventory/CSVUpdateDialog';\r\nimport BulkPrintDialog from '@/components/inventory/BulkPrintDialog';\r\nimport BarcodeExportDialog, { BarcodeExportConfig } from '@/components/inventory/BarcodeExportDialog';\r\nimport { useBulkProducts } from '@/hooks/useBulkProducts';\r\nimport { generateProductCSVTemplate } from '@/utils/csvTemplate';\r\nimport { useCategories } from '@/hooks/useCategories';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { SortField } from '@/components/inventory/InventoryTable';\r\nimport { Product } from '@/types';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { exportBulkBarcodesToPDF } from '@/utils/exportBarcodeToPDF';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n  DropdownMenuSeparator,\r\n} from '@/components/ui/dropdown-menu';\r\nimport { ChevronDown } from 'lucide-react';\r\n\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\n\r\ntype SortOrder = 'asc' | 'desc';\r\n\r\nconst Products = () => {\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const { currentBusiness, isLoading: businessLoading } = useBusiness();\r\n  const { hasPermission } = useProfiles();\r\n  const { toast } = useToast();\r\n  const isMobile = useIsMobile();\r\n\r\n  const canCreate = hasPermission('inventory', 'create');\r\n  const canEdit = hasPermission('inventory', 'edit');\r\n  const canDelete = hasPermission('inventory', 'delete');\r\n  const canView = hasPermission('inventory', 'view');\r\n\r\n  const {\r\n    products,\r\n    filteredProducts,\r\n    isLoading,\r\n    loadProducts,\r\n    filters,\r\n    setFilters,\r\n    deleteProduct,\r\n    updateProduct,\r\n    page,\r\n    setPage,\r\n    pageSize,\r\n    setPageSize,\r\n    totalCount,\r\n    refetch,\r\n    isFetching\r\n  } = useProducts(user?.id, 50);\r\n\r\n  const { categories } = useCategories(user?.id);\r\n  const { bulkCreateProducts } = useBulkProducts();\r\n  const { settings } = useBusinessSettings();\r\n\r\n\r\n  // Bulk actions state\r\n  const [selectedProductIds, setSelectedProductIds] = useState<Set<string>>(new Set());\r\n  const [bulkDeleteOpen, setBulkDeleteOpen] = useState(false);\r\n  const [bulkPrintOpen, setBulkPrintOpen] = useState(false);\r\n  const [productsToPrint, setProductsToPrint] = useState<Product[]>([]);\r\n  const [csvUploadOpen, setCsvUploadOpen] = useState(false);\r\n  const [csvUpdateOpen, setCsvUpdateOpen] = useState(false);\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n  const [isPrinting, setIsPrinting] = useState(false);\r\n  const [isExportingBarcodes, setIsExportingBarcodes] = useState(false);\r\n  const [barcodeExportOpen, setBarcodeExportOpen] = useState(false);\r\n  const [productsToExport, setProductsToExport] = useState<Product[]>([]);\r\n  const [deletionProgress, setDeletionProgress] = useState<{ current: number; total: number } | undefined>(undefined);\r\n  const [printProgress, setPrintProgress] = useState<{ current: number; total: number } | undefined>(undefined);\r\n\r\n  // Add sorting state\r\n  const [sortField, setSortField] = useState<SortField>('name');\r\n  const [sortOrder, setSortOrder] = useState<SortOrder>('asc');\r\n\r\n  // Global totals (all products, not just current page)\r\n  const [totalCostValueAll, setTotalCostValueAll] = useState<number | undefined>(undefined);\r\n  const [lowStockAll, setLowStockAll] = useState<number | undefined>(undefined);\r\n  const [outOfStockAll, setOutOfStockAll] = useState<number | undefined>(undefined);\r\n  const [totalStockValueAll, setTotalStockValueAll] = useState<number | undefined>(undefined);\r\n\r\n  // Lightweight aggregate: fetch only needed columns and cache for 5 minutes to avoid slowing the UI\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    const loadTotals = async () => {\r\n      if (!user?.id || !currentBusiness?.id) return;\r\n\r\n      const cacheKey = `allProductsStats_${currentBusiness.id}`;\r\n      const cachedRaw = localStorage.getItem(cacheKey);\r\n      try {\r\n        if (cachedRaw) {\r\n          const cached = JSON.parse(cachedRaw) as { costValue: number; lowStock: number; outOfStock: number; stockValue: number; ts: number };\r\n          if (Date.now() - cached.ts < 5 * 60 * 1000) {\r\n            setTotalCostValueAll(cached.costValue);\r\n            setLowStockAll(cached.lowStock);\r\n            setOutOfStockAll(cached.outOfStock);\r\n            setTotalStockValueAll(cached.stockValue);\r\n            return;\r\n          }\r\n        }\r\n      } catch { }\r\n\r\n      // Fetch minimal fields and compute locally; runs once and caches\r\n      const { data, error } = await supabase\r\n        .from('products' as any)\r\n        .select('cost_price, selling_price, quantity, minimum_stock')\r\n        .eq('location_id', currentBusiness.id);\r\n\r\n      if (!cancelled && !error && data) {\r\n        let costValue = 0;\r\n        let lowStock = 0;\r\n        let outOfStock = 0;\r\n        let stockValue = 0;\r\n\r\n        data.forEach((row: any) => {\r\n          const qty = Number(row.quantity) || 0;\r\n          const cost = Number(row.cost_price) || 0;\r\n          const selling = Number(row.selling_price) || 0;\r\n          const minStock = Number(row.minimum_stock) || 0;\r\n\r\n          costValue += cost * qty;\r\n          stockValue += selling * qty;\r\n\r\n          if (qty === 0) {\r\n            outOfStock++;\r\n          } else if (qty > 0 && qty <= minStock) {\r\n            lowStock++;\r\n          }\r\n        });\r\n\r\n        setTotalCostValueAll(costValue);\r\n        setLowStockAll(lowStock);\r\n        setOutOfStockAll(outOfStock);\r\n        setTotalStockValueAll(stockValue);\r\n\r\n        try {\r\n          localStorage.setItem(cacheKey, JSON.stringify({\r\n            costValue,\r\n            lowStock,\r\n            outOfStock,\r\n            stockValue,\r\n            ts: Date.now()\r\n          }));\r\n        } catch { }\r\n      }\r\n    };\r\n    // Run in the background; UI uses page values until ready\r\n    loadTotals();\r\n    return () => { cancelled = true; };\r\n  }, [user?.id, currentBusiness?.id]);\r\n\r\n  // Memoize sorted and filtered products\r\n  const sortedProducts = useMemo(() => {\r\n    return [...filteredProducts].sort((a, b) => {\r\n      let comparison = 0;\r\n\r\n      switch (sortField) {\r\n        case 'name':\r\n          comparison = a.name.localeCompare(b.name);\r\n          break;\r\n        case 'category':\r\n          comparison = a.category.localeCompare(b.category);\r\n          break;\r\n        case 'quantity':\r\n          comparison = a.quantity - b.quantity;\r\n          break;\r\n        case 'sellingPrice':\r\n          comparison = a.sellingPrice - b.sellingPrice;\r\n          break;\r\n        case 'costPrice':\r\n          comparison = a.costPrice - b.costPrice;\r\n          break;\r\n        case 'itemNumber':\r\n          comparison = a.itemNumber.localeCompare(b.itemNumber);\r\n          break;\r\n      }\r\n\r\n      return sortOrder === 'asc' ? comparison : -comparison;\r\n    });\r\n  }, [filteredProducts, sortField, sortOrder]);\r\n\r\n  const handleRefresh = async () => {\r\n    await refetch();\r\n    setSelectedProductIds(new Set());\r\n    toast({\r\n      title: \"Products refreshed\",\r\n      description: \"Your product list has been updated.\",\r\n    });\r\n  };\r\n\r\n  // Fetch all products for export (bypassing pagination)\r\n  const fetchAllProductsForExport = async (): Promise<Product[]> => {\r\n    if (!user?.id || !currentBusiness?.id) return [];\r\n\r\n    try {\r\n      let query = supabase\r\n        .from('products' as any)\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .eq('location_id', currentBusiness.id);\r\n\r\n      // Apply the same filters as the current view\r\n      if (filters.search) {\r\n        const searchTerm = filters.search;\r\n        query = query.or(`name.ilike.%${searchTerm}%,description.ilike.%${searchTerm}%,category.ilike.%${searchTerm}%,supplier.ilike.%${searchTerm}%,item_number.ilike.%${searchTerm}%`);\r\n      }\r\n\r\n      if (filters.category) {\r\n        query = query.eq('category', filters.category);\r\n      }\r\n\r\n      if (filters.stockStatus === 'outOfStock') {\r\n        query = query.eq('quantity', 0);\r\n      } else if (filters.stockStatus === 'inStock') {\r\n        query = query.gt('quantity', 0);\r\n      }\r\n\r\n      const { data, error } = await query.order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n\r\n      if (data) {\r\n        const { mapDbProductToProduct } = await import('@/types');\r\n        let formattedProducts = (data as any[]).map(mapDbProductToProduct);\r\n\r\n        // Apply low stock filter client-side\r\n        if (filters.stockStatus === 'lowStock') {\r\n          formattedProducts = formattedProducts.filter(p => p.quantity > 0 && p.quantity <= p.minimumStock);\r\n        }\r\n\r\n        // Apply the same sorting as the UI\r\n        return formattedProducts.sort((a, b) => {\r\n          let comparison = 0;\r\n\r\n          switch (sortField) {\r\n            case 'name':\r\n              comparison = a.name.localeCompare(b.name);\r\n              break;\r\n            case 'category':\r\n              comparison = a.category.localeCompare(b.category);\r\n              break;\r\n            case 'quantity':\r\n              comparison = a.quantity - b.quantity;\r\n              break;\r\n            case 'sellingPrice':\r\n              comparison = a.sellingPrice - b.sellingPrice;\r\n              break;\r\n            case 'costPrice':\r\n              comparison = a.costPrice - b.costPrice;\r\n              break;\r\n            case 'itemNumber':\r\n              comparison = a.itemNumber.localeCompare(b.itemNumber);\r\n              break;\r\n          }\r\n\r\n          return sortOrder === 'asc' ? comparison : -comparison;\r\n        });\r\n      }\r\n      return [];\r\n    } catch (error) {\r\n      console.error('Error fetching all products for export:', error);\r\n      toast({\r\n        title: \"Export failed\",\r\n        description: \"Failed to fetch products for export. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return [];\r\n    }\r\n  };\r\n\r\n  const handleExportCSV = async () => {\r\n    toast({\r\n      title: \"Preparing export...\",\r\n      description: \"Fetching all products. Please wait.\",\r\n    });\r\n\r\n    const allProducts = await fetchAllProductsForExport();\r\n\r\n    if (allProducts.length > 0) {\r\n      exportProductsToCSV(allProducts);\r\n      toast({\r\n        title: \"Export successful\",\r\n        description: `${allProducts.length} products exported to CSV file.`,\r\n      });\r\n    } else {\r\n      toast({\r\n        title: \"No products to export\",\r\n        description: \"There are no products matching your current filters.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleExportForUpdate = async () => {\r\n    toast({\r\n      title: \"Preparing export...\",\r\n      description: \"Fetching all products. Please wait.\",\r\n    });\r\n\r\n    const allProducts = await fetchAllProductsForExport();\r\n\r\n    if (allProducts.length > 0) {\r\n      exportProductsForUpdate(allProducts);\r\n      toast({\r\n        title: \"Export successful\",\r\n        description: `${allProducts.length} products exported for editing. Use this file with 'Update via CSV'.`,\r\n      });\r\n    } else {\r\n      toast({\r\n        title: \"No products to export\",\r\n        description: \"There are no products matching your current filters.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleExportPDF = async () => {\r\n    toast({\r\n      title: \"Preparing export...\",\r\n      description: \"Fetching all products. Please wait.\",\r\n    });\r\n\r\n    const allProducts = await fetchAllProductsForExport();\r\n\r\n    if (allProducts.length > 0) {\r\n      exportProductsToPDF(allProducts, settings);\r\n      toast({\r\n        title: \"Export successful\",\r\n        description: `${allProducts.length} products exported to PDF file.`,\r\n      });\r\n    } else {\r\n      toast({\r\n        title: \"No products to export\",\r\n        description: \"There are no products matching your current filters.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDownloadTemplate = () => {\r\n    generateProductCSVTemplate();\r\n    toast({\r\n      title: \"Template downloaded\",\r\n      description: \"CSV template has been downloaded to your device.\",\r\n    });\r\n  };\r\n\r\n  const handleCSVUpload = async (products: any[]) => {\r\n    try {\r\n      await bulkCreateProducts(products);\r\n      setCsvUploadOpen(false);\r\n      await loadProducts();\r\n    } catch (error) {\r\n      console.error('CSV upload failed:', error);\r\n      toast({\r\n        title: \"Upload failed\",\r\n        description: \"There was an error uploading your products. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleToggleProductSelection = (productId: string) => {\r\n    const newSelectedIds = new Set(selectedProductIds);\r\n    if (newSelectedIds.has(productId)) {\r\n      newSelectedIds.delete(productId);\r\n    } else {\r\n      newSelectedIds.add(productId);\r\n    }\r\n    setSelectedProductIds(newSelectedIds);\r\n  };\r\n\r\n  const handleToggleAllProducts = (productIds: string[]) => {\r\n    if (selectedProductIds.size === productIds.length) {\r\n      setSelectedProductIds(new Set());\r\n    } else {\r\n      setSelectedProductIds(new Set(productIds));\r\n    }\r\n  };\r\n\r\n  const handleBulkDelete = async () => {\r\n    if (selectedProductIds.size === 0) return;\r\n\r\n    setIsDeleting(true);\r\n    setDeletionProgress({ current: 0, total: selectedProductIds.size });\r\n\r\n    let successCount = 0;\r\n    let failureCount = 0;\r\n    let currentCount = 0;\r\n\r\n    try {\r\n      for (const productId of selectedProductIds) {\r\n        try {\r\n          const success = await deleteProduct(productId);\r\n          if (success) {\r\n            successCount++;\r\n          } else {\r\n            failureCount++;\r\n          }\r\n        } catch (error) {\r\n          failureCount++;\r\n          console.error(`Error deleting product ${productId}:`, error);\r\n        }\r\n\r\n        currentCount++;\r\n        setDeletionProgress({ current: currentCount, total: selectedProductIds.size });\r\n      }\r\n\r\n      setSelectedProductIds(new Set());\r\n\r\n      if (successCount > 0) {\r\n        toast({\r\n          title: \"Products deleted\",\r\n          description: `Successfully deleted ${successCount} product${successCount > 1 ? 's' : ''}`,\r\n        });\r\n      }\r\n\r\n      if (failureCount > 0) {\r\n        toast({\r\n          title: \"Some deletions failed\",\r\n          description: `${failureCount} product${failureCount > 1 ? 's' : ''} could not be deleted`,\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n\r\n      setBulkDeleteOpen(false);\r\n      // Only refresh once at the end, after dialog is closed\r\n      await loadProducts();\r\n\r\n    } finally {\r\n      setIsDeleting(false);\r\n      setDeletionProgress(undefined);\r\n    }\r\n  };\r\n\r\n  const handleOpenBulkPrint = async (all: boolean = false) => {\r\n    if (all) {\r\n      toast({\r\n        title: \"Preparing for bulk print...\",\r\n        description: \"Fetching all products matching current filters.\",\r\n      });\r\n      const allFiltered = await fetchAllProductsForExport();\r\n      if (allFiltered.length === 0) {\r\n        toast({\r\n          title: \"No products found\",\r\n          description: \"There are no products matching your current filters to print.\",\r\n          variant: \"destructive\"\r\n        });\r\n        return;\r\n      }\r\n      setProductsToPrint(allFiltered);\r\n    } else {\r\n      if (selectedProductIds.size === 0) {\r\n        toast({\r\n          title: \"No products selected\",\r\n          description: \"Please select products to print or use 'Print All'.\",\r\n          variant: \"destructive\"\r\n        });\r\n        return;\r\n      }\r\n      setProductsToPrint(selectedProducts);\r\n    }\r\n    setBulkPrintOpen(true);\r\n  };\r\n\r\n  const handleConfirmBulkPrint = async (showPrice: boolean) => {\r\n    if (productsToPrint.length === 0) return;\r\n\r\n    setIsPrinting(true);\r\n    setPrintProgress({ current: 0, total: productsToPrint.length });\r\n\r\n    let successCount = 0;\r\n    let failureCount = 0;\r\n\r\n    try {\r\n      for (const p of productsToPrint) {\r\n        if (!p.barcode) {\r\n          failureCount++;\r\n          setPrintProgress(prev => prev ? { ...prev, current: prev.current + 1 } : undefined);\r\n          continue;\r\n        }\r\n\r\n        try {\r\n          const priceText = showPrice\r\n            ? `TEXT 15,180,\"3\",0,1,1,\"${settings.currency} ${formatNumber(p.sellingPrice)}\"\\n`\r\n            : '';\r\n\r\n          const response = await fetch('http://localhost:5000/print/label', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            mode: 'cors',\r\n            body: JSON.stringify({\r\n              PrinterName: settings.defaultPrinterName || 'Label Printer',\r\n              Content: `SIZE 50 mm, 30 mm\\nGAP 3 mm, 0 mm\\nCLS\\nTEXT 15,20,\"3\",0,1,1,\"${p.name}\"\\nBARCODE 15,70,\"128\",60,1,0,2,2,\"${p.barcode}\"\\n${priceText}PRINT 1\\n`\r\n            })\r\n          });\r\n\r\n          if (response.ok) {\r\n            successCount++;\r\n          } else {\r\n            failureCount++;\r\n          }\r\n        } catch (err) {\r\n          console.error(`Failed to print label for ${p.name}:`, err);\r\n          failureCount++;\r\n        }\r\n\r\n        setPrintProgress(prev => prev ? { ...prev, current: prev.current + 1 } : undefined);\r\n\r\n        // Minor delay to prevent overwhelming the bridge/printer\r\n        await new Promise(resolve => setTimeout(resolve, 100));\r\n      }\r\n\r\n      if (successCount > 0) {\r\n        toast({\r\n          title: \"Printing successful\",\r\n          description: `Sent ${successCount} labels to the printer.`,\r\n        });\r\n      }\r\n\r\n      if (failureCount > 0) {\r\n        toast({\r\n          title: \"Some labels failed\",\r\n          description: `${failureCount} labels could not be printed. Check your connection.`,\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n\r\n      setBulkPrintOpen(false);\r\n    } finally {\r\n      setIsPrinting(false);\r\n      setPrintProgress(undefined);\r\n    }\r\n  };\r\n\r\n  const handleBulkBarcodeExport = async (all: boolean = false) => {\r\n    setIsExportingBarcodes(true);\r\n    try {\r\n      let productsToExport: Product[] = [];\r\n\r\n      if (all) {\r\n        toast({\r\n          title: \"Preparing barcode export...\",\r\n          description: \"Fetching all products matching current filters.\",\r\n        });\r\n        productsToExport = await fetchAllProductsForExport();\r\n      } else {\r\n        if (selectedProductIds.size === 0) {\r\n          toast({\r\n            title: \"No products selected\",\r\n            description: \"Please select products to export barcodes.\",\r\n            variant: \"destructive\"\r\n          });\r\n          return;\r\n        }\r\n        productsToExport = selectedProducts;\r\n      }\r\n\r\n      const productsWithBarcodes = productsToExport.filter(p => p.barcode);\r\n\r\n      if (productsWithBarcodes.length === 0) {\r\n        toast({\r\n          title: \"No barcodes to export\",\r\n          description: \"None of the selected products have barcodes.\",\r\n          variant: \"destructive\"\r\n        });\r\n        return;\r\n      }\r\n\r\n      toast({\r\n        title: \"Generating PDF...\",\r\n        description: `Exporting ${productsWithBarcodes.length} barcode${productsWithBarcodes.length > 1 ? 's' : ''}...`,\r\n      });\r\n\r\n      await exportBulkBarcodesToPDF(productsWithBarcodes, {\r\n        showPrice: true,\r\n        currency: settings.currency\r\n      });\r\n\r\n      toast({\r\n        title: \"Export successful\",\r\n        description: `${productsWithBarcodes.length} barcode${productsWithBarcodes.length > 1 ? 's' : ''} exported to PDF.`,\r\n      });\r\n\r\n      if (productsToExport.length > productsWithBarcodes.length) {\r\n        const skipped = productsToExport.length - productsWithBarcodes.length;\r\n        toast({\r\n          title: \"Some products skipped\",\r\n          description: `${skipped} product${skipped > 1 ? 's' : ''} without barcodes were not included.`,\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Barcode export failed:', error);\r\n      toast({\r\n        title: \"Export failed\",\r\n        description: \"Failed to export barcodes. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsExportingBarcodes(false);\r\n    }\r\n  };\r\n\r\n  const handleOpenBarcodeExport = async (all: boolean = false) => {\r\n    try {\r\n      let products: Product[] = [];\r\n\r\n      if (all) {\r\n        toast({\r\n          title: \"Preparing barcode export...\",\r\n          description: \"Fetching all products matching current filters.\",\r\n        });\r\n        products = await fetchAllProductsForExport();\r\n      } else {\r\n        if (selectedProductIds.size === 0) {\r\n          toast({\r\n            title: \"No products selected\",\r\n            description: \"Please select products to export barcodes.\",\r\n            variant: \"destructive\"\r\n          });\r\n          return;\r\n        }\r\n        products = selectedProducts;\r\n      }\r\n\r\n      const productsWithBarcodes = products.filter(p => p.barcode);\r\n\r\n      if (productsWithBarcodes.length === 0) {\r\n        toast({\r\n          title: \"No barcodes to export\",\r\n          description: \"None of the selected products have barcodes.\",\r\n          variant: \"destructive\"\r\n        });\r\n        return;\r\n      }\r\n\r\n      setProductsToExport(productsWithBarcodes);\r\n      setBarcodeExportOpen(true);\r\n    } catch (error) {\r\n      console.error('Failed to prepare barcode export:', error);\r\n      toast({\r\n        title: \"Export preparation failed\",\r\n        description: \"Failed to prepare products for export.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleConfirmBarcodeExport = async (config: BarcodeExportConfig) => {\r\n    setIsExportingBarcodes(true);\r\n    try {\r\n      toast({\r\n        title: \"Generating PDF...\",\r\n        description: `Exporting ${productsToExport.length} barcode${productsToExport.length > 1 ? 's' : ''}...`,\r\n      });\r\n\r\n      await exportBulkBarcodesToPDF(productsToExport, {\r\n        showPrice: config.showPrice,\r\n        currency: settings.currency,\r\n      });\r\n\r\n      toast({\r\n        title: \"Export successful\",\r\n        description: `${productsToExport.length} barcode${productsToExport.length > 1 ? 's' : ''} exported to PDF.`,\r\n      });\r\n\r\n      setBarcodeExportOpen(false);\r\n    } catch (error) {\r\n      console.error('Barcode export failed:', error);\r\n      toast({\r\n        title: \"Export failed\",\r\n        description: \"Failed to export barcodes. Please try again.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsExportingBarcodes(false);\r\n    }\r\n  };\r\n\r\n  const handleUpdateProduct = async (id: string, updates: Partial<Product>) => {\r\n    try {\r\n      const success = await updateProduct(id, updates);\r\n      if (success) {\r\n        toast({\r\n          title: \"Product updated\",\r\n          description: \"Product details have been updated successfully.\",\r\n        });\r\n        return true;\r\n      } else {\r\n        toast({\r\n          title: \"Update failed\",\r\n          description: \"Failed to update product. Please try again.\",\r\n          variant: \"destructive\"\r\n        });\r\n        return false;\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating product:', error);\r\n      toast({\r\n        title: \"Update failed\",\r\n        description: \"An error occurred while updating the product.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const selectedProducts = useMemo(() => {\r\n    return sortedProducts.filter(product => selectedProductIds.has(product.id));\r\n  }, [sortedProducts, selectedProductIds]);\r\n\r\n  if (businessLoading || !currentBusiness || (isLoading && products.length === 0)) {\r\n    return (\r\n      <div className=\"flex flex-col items-center justify-center min-h-[60vh] space-y-4\">\r\n        <LoadingSpinner />\r\n        <p className=\"text-muted-foreground\">Loading products...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-3 md:p-6 space-y-4 md:space-y-6\">\r\n      {/* Header Section - Improved Mobile Layout */}\r\n      <div className=\"space-y-3 md:space-y-4\">\r\n        <div className=\"flex flex-col gap-3 md:flex-row md:items-center md:justify-between\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              onClick={() => navigate('/inventory')}\r\n              className=\"shrink-0 h-8 w-8\"\r\n              title=\"Back to inventory\"\r\n            >\r\n              <ArrowLeft className=\"h-4 w-4\" />\r\n            </Button>\r\n            <div className=\"space-y-1\">\r\n              <h1 className=\"text-lg md:text-2xl lg:text-3xl font-bold text-sales-dark\">Products</h1>\r\n              <p className=\"text-xs md:text-base text-muted-foreground\">\r\n                Manage your product inventory and pricing\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Mobile Action Buttons - Improved Layout */}\r\n          {isMobile ? (\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex gap-2\">\r\n                {canCreate && (\r\n                  <Button onClick={() => navigate('/inventory/new')} className=\"flex-1 gap-2 h-9\">\r\n                    <Plus size={16} /> Add Product\r\n                  </Button>\r\n                )}\r\n                <Button\r\n                  onClick={handleRefresh}\r\n                  variant=\"outline\"\r\n                  size=\"icon\"\r\n                  disabled={isLoading || isFetching}\r\n                  className=\"shrink-0 h-9 w-9\"\r\n                >\r\n                  <RefreshCw className={`h-4 w-4 ${(isLoading || isFetching) ? 'animate-spin' : ''}`} />\r\n                </Button>\r\n              </div>\r\n              <div className=\"grid grid-cols-2 gap-2\">\r\n                {canCreate && (\r\n                  <>\r\n                    <Button onClick={handleDownloadTemplate} variant=\"outline\" className=\"gap-1 text-xs h-8\">\r\n                      <Download size={14} /> Template\r\n                    </Button>\r\n                    <Button onClick={() => setCsvUploadOpen(true)} variant=\"outline\" className=\"gap-1 text-xs h-8\">\r\n                      <Upload size={14} /> Add CSV\r\n                    </Button>\r\n                  </>\r\n                )}\r\n              </div>\r\n              <div className=\"grid grid-cols-2 gap-2\">\r\n                {canEdit && (\r\n                  <>\r\n                    <Button onClick={handleExportForUpdate} variant=\"outline\" className=\"gap-1 text-xs h-8\">\r\n                      <Download size={14} /> Export for Editing\r\n                    </Button>\r\n                    <Button onClick={() => setCsvUpdateOpen(true)} variant=\"outline\" className=\"gap-1 text-xs h-8\">\r\n                      <Upload size={14} /> Update CSV\r\n                    </Button>\r\n                  </>\r\n                )}\r\n              </div>\r\n              <div className=\"grid grid-cols-2 gap-2\">\r\n                {canView && (\r\n                  <>\r\n                    <Button onClick={handleExportCSV} variant=\"outline\" className=\"gap-1 text-xs h-8\">\r\n                      <Download size={14} /> Full Export\r\n                    </Button>\r\n                    <Button onClick={handleExportPDF} variant=\"outline\" className=\"gap-1 text-xs h-8\">\r\n                      <Download size={14} /> PDF\r\n                    </Button>\r\n                  </>\r\n                )}\r\n              </div>\r\n              {canDelete && selectedProductIds.size > 0 && (\r\n                <Button\r\n                  onClick={() => setBulkDeleteOpen(true)}\r\n                  variant=\"destructive\"\r\n                  className=\"w-full gap-2 text-xs h-8\"\r\n                  disabled={isDeleting}\r\n                >\r\n                  <Trash2 size={14} /> Delete Selected ({selectedProductIds.size})\r\n                </Button>\r\n              )}\r\n              {canEdit && (\r\n                <div className=\"grid grid-cols-2 gap-2\">\r\n                  <Button\r\n                    onClick={() => handleOpenBulkPrint(false)}\r\n                    variant=\"outline\"\r\n                    className=\"gap-2 text-xs h-8\"\r\n                    disabled={selectedProductIds.size === 0 || isPrinting}\r\n                  >\r\n                    <Printer size={14} /> Print Selected\r\n                  </Button>\r\n                  <Button\r\n                    onClick={() => handleOpenBulkPrint(true)}\r\n                    variant=\"outline\"\r\n                    className=\"gap-2 text-xs h-8\"\r\n                    disabled={totalCount === 0 || isPrinting}\r\n                  >\r\n                    <Printer size={14} /> Print All ({totalCount})\r\n                  </Button>\r\n                </div>\r\n              )}\r\n              {canView && (\r\n                <div className=\"grid grid-cols-2 gap-2\">\r\n                  <Button\r\n                    onClick={() => handleOpenBarcodeExport(false)}\r\n                    variant=\"outline\"\r\n                    className=\"gap-2 text-xs h-8\"\r\n                    disabled={selectedProductIds.size === 0 || isExportingBarcodes}\r\n                  >\r\n                    <Download size={14} /> Export Barcodes\r\n                  </Button>\r\n                  <Button\r\n                    onClick={() => handleOpenBarcodeExport(true)}\r\n                    variant=\"outline\"\r\n                    className=\"gap-2 text-xs h-8\"\r\n                    disabled={totalCount === 0 || isExportingBarcodes}\r\n                  >\r\n                    <Download size={14} /> All Barcodes\r\n                  </Button>\r\n                </div>\r\n              )}\r\n            </div>\r\n          ) : (\r\n            // Desktop Action Buttons\r\n            <div className=\"flex items-center gap-2 flex-wrap\">\r\n              <Button\r\n                onClick={handleRefresh}\r\n                variant=\"outline\"\r\n                size=\"icon\"\r\n                disabled={isLoading || isFetching}\r\n                title=\"Refresh products\"\r\n              >\r\n                <RefreshCw className={`h-4 w-4 ${(isLoading || isFetching) ? 'animate-spin' : ''}`} />\r\n              </Button>\r\n\r\n              {canCreate && (\r\n                <>\r\n                  <Button onClick={handleDownloadTemplate} variant=\"outline\" className=\"gap-2\">\r\n                    <Download size={16} /> CSV Template\r\n                  </Button>\r\n                  <Button onClick={() => setCsvUploadOpen(true)} variant=\"outline\" className=\"gap-2\">\r\n                    <Upload size={16} /> Add via CSV\r\n                  </Button>\r\n                </>\r\n              )}\r\n\r\n              {canEdit && (\r\n                <>\r\n                  <Button onClick={handleExportForUpdate} variant=\"outline\" className=\"gap-2\">\r\n                    <Download size={16} /> Export for Editing\r\n                  </Button>\r\n                  <Button onClick={() => setCsvUpdateOpen(true)} variant=\"outline\" className=\"gap-2\">\r\n                    <Upload size={16} /> Update via CSV\r\n                  </Button>\r\n                </>\r\n              )}\r\n\r\n              {canView && (\r\n                <>\r\n                  <Button onClick={handleExportCSV} variant=\"outline\" className=\"gap-2\">\r\n                    <Download size={16} /> Full Export\r\n                  </Button>\r\n                  <Button onClick={handleExportPDF} variant=\"outline\" className=\"gap-2\">\r\n                    <Download size={16} /> Export PDF\r\n                  </Button>\r\n                </>\r\n              )}\r\n              {canDelete && selectedProductIds.size > 0 && (\r\n                <Button\r\n                  onClick={() => setBulkDeleteOpen(true)}\r\n                  variant=\"destructive\"\r\n                  className=\"gap-2\"\r\n                  disabled={isDeleting}\r\n                >\r\n                  <Trash2 size={16} /> Delete Selected ({selectedProductIds.size})\r\n                </Button>\r\n              )}\r\n              {canEdit && (\r\n                <>\r\n                  <Button\r\n                    onClick={() => handleOpenBulkPrint(false)}\r\n                    variant=\"outline\"\r\n                    className=\"gap-2\"\r\n                    disabled={selectedProductIds.size === 0 || isPrinting}\r\n                  >\r\n                    <Printer size={16} /> Print Selected\r\n                  </Button>\r\n                  <Button\r\n                    onClick={() => handleOpenBulkPrint(true)}\r\n                    variant=\"outline\"\r\n                    className=\"gap-2\"\r\n                    disabled={totalCount === 0 || isPrinting}\r\n                  >\r\n                    <Printer size={16} /> Print All ({totalCount})\r\n                  </Button>\r\n                </>\r\n              )}\r\n              {canView && (\r\n                <DropdownMenu>\r\n                  <DropdownMenuTrigger asChild>\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      className=\"gap-2\"\r\n                      disabled={isExportingBarcodes}\r\n                    >\r\n                      <Download size={16} /> Export Barcodes <ChevronDown size={16} />\r\n                    </Button>\r\n                  </DropdownMenuTrigger>\r\n                  <DropdownMenuContent align=\"end\">\r\n                    <DropdownMenuItem\r\n                      onClick={() => handleOpenBarcodeExport(false)}\r\n                      disabled={selectedProductIds.size === 0}\r\n                    >\r\n                      <Download className=\"mr-2 h-4 w-4\" />\r\n                      Selected Products ({selectedProductIds.size})\r\n                    </DropdownMenuItem>\r\n                    <DropdownMenuSeparator />\r\n                    <DropdownMenuItem\r\n                      onClick={() => handleOpenBarcodeExport(true)}\r\n                      disabled={totalCount === 0}\r\n                    >\r\n                      <Download className=\"mr-2 h-4 w-4\" />\r\n                      All Products ({totalCount})\r\n                    </DropdownMenuItem>\r\n                  </DropdownMenuContent>\r\n                </DropdownMenu>\r\n              )}\r\n              {canCreate && (\r\n                <Button onClick={() => navigate('/inventory/new')} className=\"gap-2\">\r\n                  <Plus size={16} /> Add Product\r\n                </Button>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <InventoryStats\r\n        products={products}\r\n        hideStockValue={true}\r\n        totalCountOverride={totalCount}\r\n        totalCostValueOverride={totalCostValueAll}\r\n        lowStockOverride={lowStockAll}\r\n        outOfStockOverride={outOfStockAll}\r\n        totalStockValueOverride={totalStockValueAll}\r\n      />\r\n\r\n      {/* Filters Card - Better Mobile Layout */}\r\n      <Card className=\"shadow-sm\">\r\n        <CardHeader className=\"pb-2 md:pb-6\">\r\n          <CardTitle className=\"text-sm md:text-lg\">Filter Products</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"pt-0\">\r\n          <InventoryFilters\r\n            filters={filters}\r\n            setFilters={setFilters}\r\n            categories={categories}\r\n            productsCount={sortedProducts.length}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Products Table */}\r\n      <Card className=\"shadow-sm\">\r\n        <CardHeader className=\"pb-2 md:pb-6\">\r\n          <CardTitle className=\"text-sm md:text-lg flex items-center justify-between\">\r\n            <span>\r\n              Products ({totalCount})\r\n              {selectedProductIds.size > 0 && (\r\n                <span className=\"text-xs font-normal text-muted-foreground ml-2\">\r\n                  {selectedProductIds.size} selected\r\n                </span>\r\n              )}\r\n            </span>\r\n          </CardTitle>\r\n          <div className=\"text-xs text-muted-foreground mt-2 p-2 bg-blue-50 rounded border-l-4 border-blue-400\">\r\n            💡 <strong>Tip:</strong> Click on Category, Cost Price, or Selling Price to edit them directly in the table\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"p-0\">\r\n          <InventoryTable\r\n            products={sortedProducts}\r\n            isLoading={isLoading}\r\n            showAllFields={true}\r\n            enableBulkActions={true}\r\n            selectedProductIds={selectedProductIds}\r\n            onToggleProductSelection={handleToggleProductSelection}\r\n            onToggleAllProducts={handleToggleAllProducts}\r\n            sortField={sortField}\r\n            sortOrder={sortOrder}\r\n            onSort={(field) => {\r\n              if (sortField === field) {\r\n                setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\r\n              } else {\r\n                setSortField(field);\r\n                setSortOrder('asc');\r\n              }\r\n            }}\r\n            onUpdateProduct={handleUpdateProduct}\r\n            categories={categories.map(cat => cat.name)}\r\n          />\r\n          {/* Pagination Controls */}\r\n          <div className=\"flex items-center justify-between p-3 md:p-4 border-t\">\r\n            <div className=\"text-xs md:text-sm text-muted-foreground\">\r\n              Showing {(page - 1) * pageSize + 1}–{Math.min(page * pageSize, totalCount)} of {totalCount}\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <select\r\n                className=\"border rounded px-2 py-1 text-xs md:text-sm\"\r\n                value={pageSize}\r\n                onChange={(e) => setPageSize(Number(e.target.value))}\r\n              >\r\n                {[20, 50, 100].map(size => (\r\n                  <option key={size} value={size}>{size} / page</option>\r\n                ))}\r\n              </select>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                disabled={page === 1 || isLoading}\r\n                onClick={() => setPage(Math.max(1, page - 1))}\r\n              >\r\n                Prev\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                disabled={page * pageSize >= totalCount || isLoading}\r\n                onClick={() => setPage(page + 1)}\r\n              >\r\n                Next\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Dialogs */}\r\n      <CSVUploadDialog\r\n        open={csvUploadOpen}\r\n        onOpenChange={setCsvUploadOpen}\r\n        onUpload={handleCSVUpload}\r\n        categories={categories.map(cat => cat.name)}\r\n      />\r\n\r\n      <CSVUpdateDialog\r\n        open={csvUpdateOpen}\r\n        onOpenChange={setCsvUpdateOpen}\r\n        userId={user?.id}\r\n      />\r\n\r\n      <BulkDeleteDialog\r\n        open={bulkDeleteOpen}\r\n        onOpenChange={setBulkDeleteOpen}\r\n        selectedProducts={selectedProducts}\r\n        onConfirm={handleBulkDelete}\r\n        isDeleting={isDeleting}\r\n        deletionProgress={deletionProgress}\r\n      />\r\n\r\n      <BulkPrintDialog\r\n        open={bulkPrintOpen}\r\n        onOpenChange={setBulkPrintOpen}\r\n        selectedProducts={productsToPrint}\r\n        onConfirm={handleConfirmBulkPrint}\r\n        isPrinting={isPrinting}\r\n        printProgress={printProgress}\r\n      />\r\n\r\n      <BarcodeExportDialog\r\n        open={barcodeExportOpen}\r\n        onOpenChange={setBarcodeExportOpen}\r\n        productCount={productsToExport.filter(p => p.barcode).length}\r\n        onConfirm={handleConfirmBarcodeExport}\r\n        isExporting={isExportingBarcodes}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Products;\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAOA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA,MAAM,WAAW;;IACf,MAAM,WAAW,IAAA,kLAAW;IAC5B,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,wJAAO;IACxB,MAAM,EAAE,eAAe,EAAE,WAAW,eAAe,EAAE,GAAG,IAAA,qJAAW;IACnE,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,oJAAW;IACrC,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,2IAAQ;IAC1B,MAAM,WAAW,IAAA,gJAAW;IAE5B,MAAM,YAAY,cAAc,aAAa;IAC7C,MAAM,UAAU,cAAc,aAAa;IAC3C,MAAM,YAAY,cAAc,aAAa;IAC7C,MAAM,UAAU,cAAc,aAAa;IAE3C,MAAM,EACJ,QAAQ,EACR,gBAAgB,EAChB,SAAS,EACT,YAAY,EACZ,OAAO,EACP,UAAU,EACV,aAAa,EACb,aAAa,EACb,IAAI,EACJ,OAAO,EACP,QAAQ,EACR,WAAW,EACX,UAAU,EACV,OAAO,EACP,UAAU,EACX,GAAG,IAAA,6IAAW,EAAC,MAAM,IAAI;IAE1B,MAAM,EAAE,UAAU,EAAE,GAAG,IAAA,iJAAa,EAAC,MAAM;IAC3C,MAAM,EAAE,kBAAkB,EAAE,GAAG,IAAA,qJAAe;IAC9C,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,6JAAmB;IAGxC,qBAAqB;IACrB,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAAc,IAAI;IAC9E,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAC;IACrD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAY,EAAE;IACpE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,yKAAQ,EAAC;IAC/D,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,yKAAQ,EAAC;IAC3D,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAY,EAAE;IACtE,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAiD;IACzG,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAiD;IAEnG,oBAAoB;IACpB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAY;IACtD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAY;IAEtD,sDAAsD;IACtD,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,yKAAQ,EAAqB;IAC/E,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAqB;IACnE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAqB;IACvE,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAAqB;IAEjF,mGAAmG;IACnG,IAAA,0KAAS;8BAAC;YACR,IAAI,YAAY;YAChB,MAAM;iDAAa;oBACjB,IAAI,CAAC,MAAM,MAAM,CAAC,iBAAiB,IAAI;oBAEvC,MAAM,WAAW,CAAC,iBAAiB,EAAE,gBAAgB,EAAE,EAAE;oBACzD,MAAM,YAAY,aAAa,OAAO,CAAC;oBACvC,IAAI;wBACF,IAAI,WAAW;4BACb,MAAM,SAAS,KAAK,KAAK,CAAC;4BAC1B,IAAI,KAAK,GAAG,KAAK,OAAO,EAAE,GAAG,IAAI,KAAK,MAAM;gCAC1C,qBAAqB,OAAO,SAAS;gCACrC,eAAe,OAAO,QAAQ;gCAC9B,iBAAiB,OAAO,UAAU;gCAClC,sBAAsB,OAAO,UAAU;gCACvC;4BACF;wBACF;oBACF,EAAE,OAAM,CAAE;oBAEV,iEAAiE;oBACjE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,wJAAQ,CACnC,IAAI,CAAC,YACL,MAAM,CAAC,sDACP,EAAE,CAAC,eAAe,gBAAgB,EAAE;oBAEvC,IAAI,CAAC,aAAa,CAAC,SAAS,MAAM;wBAChC,IAAI,YAAY;wBAChB,IAAI,WAAW;wBACf,IAAI,aAAa;wBACjB,IAAI,aAAa;wBAEjB,KAAK,OAAO;6DAAC,CAAC;gCACZ,MAAM,MAAM,OAAO,IAAI,QAAQ,KAAK;gCACpC,MAAM,OAAO,OAAO,IAAI,UAAU,KAAK;gCACvC,MAAM,UAAU,OAAO,IAAI,aAAa,KAAK;gCAC7C,MAAM,WAAW,OAAO,IAAI,aAAa,KAAK;gCAE9C,aAAa,OAAO;gCACpB,cAAc,UAAU;gCAExB,IAAI,QAAQ,GAAG;oCACb;gCACF,OAAO,IAAI,MAAM,KAAK,OAAO,UAAU;oCACrC;gCACF;4BACF;;wBAEA,qBAAqB;wBACrB,eAAe;wBACf,iBAAiB;wBACjB,sBAAsB;wBAEtB,IAAI;4BACF,aAAa,OAAO,CAAC,UAAU,KAAK,SAAS,CAAC;gCAC5C;gCACA;gCACA;gCACA;gCACA,IAAI,KAAK,GAAG;4BACd;wBACF,EAAE,OAAM,CAAE;oBACZ;gBACF;;YACA,yDAAyD;YACzD;YACA;sCAAO;oBAAQ,YAAY;gBAAM;;QACnC;6BAAG;QAAC,MAAM;QAAI,iBAAiB;KAAG;IAElC,uCAAuC;IACvC,MAAM,iBAAiB,IAAA,wKAAO;4CAAC;YAC7B,OAAO;mBAAI;aAAiB,CAAC,IAAI;oDAAC,CAAC,GAAG;oBACpC,IAAI,aAAa;oBAEjB,OAAQ;wBACN,KAAK;4BACH,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI;4BACxC;wBACF,KAAK;4BACH,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,EAAE,QAAQ;4BAChD;wBACF,KAAK;4BACH,aAAa,EAAE,QAAQ,GAAG,EAAE,QAAQ;4BACpC;wBACF,KAAK;4BACH,aAAa,EAAE,YAAY,GAAG,EAAE,YAAY;4BAC5C;wBACF,KAAK;4BACH,aAAa,EAAE,SAAS,GAAG,EAAE,SAAS;4BACtC;wBACF,KAAK;4BACH,aAAa,EAAE,UAAU,CAAC,aAAa,CAAC,EAAE,UAAU;4BACpD;oBACJ;oBAEA,OAAO,cAAc,QAAQ,aAAa,CAAC;gBAC7C;;QACF;2CAAG;QAAC;QAAkB;QAAW;KAAU;IAE3C,MAAM,gBAAgB;QACpB,MAAM;QACN,sBAAsB,IAAI;QAC1B,MAAM;YACJ,OAAO;YACP,aAAa;QACf;IACF;IAEA,uDAAuD;IACvD,MAAM,4BAA4B;QAChC,IAAI,CAAC,MAAM,MAAM,CAAC,iBAAiB,IAAI,OAAO,EAAE;QAEhD,IAAI;YACF,IAAI,QAAQ,wJAAQ,CACjB,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,EAAE,CAAC,eAAe,gBAAgB,EAAE;YAEvC,6CAA6C;YAC7C,IAAI,QAAQ,MAAM,EAAE;gBAClB,MAAM,aAAa,QAAQ,MAAM;gBACjC,QAAQ,MAAM,EAAE,CAAC,CAAC,YAAY,EAAE,WAAW,qBAAqB,EAAE,WAAW,kBAAkB,EAAE,WAAW,kBAAkB,EAAE,WAAW,qBAAqB,EAAE,WAAW,CAAC,CAAC;YACjL;YAEA,IAAI,QAAQ,QAAQ,EAAE;gBACpB,QAAQ,MAAM,EAAE,CAAC,YAAY,QAAQ,QAAQ;YAC/C;YAEA,IAAI,QAAQ,WAAW,KAAK,cAAc;gBACxC,QAAQ,MAAM,EAAE,CAAC,YAAY;YAC/B,OAAO,IAAI,QAAQ,WAAW,KAAK,WAAW;gBAC5C,QAAQ,MAAM,EAAE,CAAC,YAAY;YAC/B;YAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,MAAM,KAAK,CAAC,cAAc;gBAAE,WAAW;YAAM;YAE3E,IAAI,OAAO,MAAM;YAEjB,IAAI,MAAM;gBACR,MAAM,EAAE,qBAAqB,EAAE,GAAG;gBAClC,IAAI,oBAAoB,AAAC,KAAe,GAAG,CAAC;gBAE5C,qCAAqC;gBACrC,IAAI,QAAQ,WAAW,KAAK,YAAY;oBACtC,oBAAoB,kBAAkB,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,GAAG,KAAK,EAAE,QAAQ,IAAI,EAAE,YAAY;gBAClG;gBAEA,mCAAmC;gBACnC,OAAO,kBAAkB,IAAI,CAAC,CAAC,GAAG;oBAChC,IAAI,aAAa;oBAEjB,OAAQ;wBACN,KAAK;4BACH,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI;4BACxC;wBACF,KAAK;4BACH,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,EAAE,QAAQ;4BAChD;wBACF,KAAK;4BACH,aAAa,EAAE,QAAQ,GAAG,EAAE,QAAQ;4BACpC;wBACF,KAAK;4BACH,aAAa,EAAE,YAAY,GAAG,EAAE,YAAY;4BAC5C;wBACF,KAAK;4BACH,aAAa,EAAE,SAAS,GAAG,EAAE,SAAS;4BACtC;wBACF,KAAK;4BACH,aAAa,EAAE,UAAU,CAAC,aAAa,CAAC,EAAE,UAAU;4BACpD;oBACJ;oBAEA,OAAO,cAAc,QAAQ,aAAa,CAAC;gBAC7C;YACF;YACA,OAAO,EAAE;QACX,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2CAA2C;YACzD,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;YACA,OAAO,EAAE;QACX;IACF;IAEA,MAAM,kBAAkB;QACtB,MAAM;YACJ,OAAO;YACP,aAAa;QACf;QAEA,MAAM,cAAc,MAAM;QAE1B,IAAI,YAAY,MAAM,GAAG,GAAG;YAC1B,IAAA,6JAAmB,EAAC;YACpB,MAAM;gBACJ,OAAO;gBACP,aAAa,GAAG,YAAY,MAAM,CAAC,+BAA+B,CAAC;YACrE;QACF,OAAO;YACL,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF;IACF;IAEA,MAAM,wBAAwB;QAC5B,MAAM;YACJ,OAAO;YACP,aAAa;QACf;QAEA,MAAM,cAAc,MAAM;QAE1B,IAAI,YAAY,MAAM,GAAG,GAAG;YAC1B,IAAA,qKAAuB,EAAC;YACxB,MAAM;gBACJ,OAAO;gBACP,aAAa,GAAG,YAAY,MAAM,CAAC,oEAAoE,CAAC;YAC1G;QACF,OAAO;YACL,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF;IACF;IAEA,MAAM,kBAAkB;QACtB,MAAM;YACJ,OAAO;YACP,aAAa;QACf;QAEA,MAAM,cAAc,MAAM;QAE1B,IAAI,YAAY,MAAM,GAAG,GAAG;YAC1B,IAAA,6JAAmB,EAAC,aAAa;YACjC,MAAM;gBACJ,OAAO;gBACP,aAAa,GAAG,YAAY,MAAM,CAAC,+BAA+B,CAAC;YACrE;QACF,OAAO;YACL,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF;IACF;IAEA,MAAM,yBAAyB;QAC7B,IAAA,4JAA0B;QAC1B,MAAM;YACJ,OAAO;YACP,aAAa;QACf;IACF;IAEA,MAAM,kBAAkB,OAAO;QAC7B,IAAI;YACF,MAAM,mBAAmB;YACzB,iBAAiB;YACjB,MAAM;QACR,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sBAAsB;YACpC,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF;IACF;IAEA,MAAM,+BAA+B,CAAC;QACpC,MAAM,iBAAiB,IAAI,IAAI;QAC/B,IAAI,eAAe,GAAG,CAAC,YAAY;YACjC,eAAe,MAAM,CAAC;QACxB,OAAO;YACL,eAAe,GAAG,CAAC;QACrB;QACA,sBAAsB;IACxB;IAEA,MAAM,0BAA0B,CAAC;QAC/B,IAAI,mBAAmB,IAAI,KAAK,WAAW,MAAM,EAAE;YACjD,sBAAsB,IAAI;QAC5B,OAAO;YACL,sBAAsB,IAAI,IAAI;QAChC;IACF;IAEA,MAAM,mBAAmB;QACvB,IAAI,mBAAmB,IAAI,KAAK,GAAG;QAEnC,cAAc;QACd,oBAAoB;YAAE,SAAS;YAAG,OAAO,mBAAmB,IAAI;QAAC;QAEjE,IAAI,eAAe;QACnB,IAAI,eAAe;QACnB,IAAI,eAAe;QAEnB,IAAI;YACF,KAAK,MAAM,aAAa,mBAAoB;gBAC1C,IAAI;oBACF,MAAM,UAAU,MAAM,cAAc;oBACpC,IAAI,SAAS;wBACX;oBACF,OAAO;wBACL;oBACF;gBACF,EAAE,OAAO,OAAO;oBACd;oBACA,QAAQ,KAAK,CAAC,CAAC,uBAAuB,EAAE,UAAU,CAAC,CAAC,EAAE;gBACxD;gBAEA;gBACA,oBAAoB;oBAAE,SAAS;oBAAc,OAAO,mBAAmB,IAAI;gBAAC;YAC9E;YAEA,sBAAsB,IAAI;YAE1B,IAAI,eAAe,GAAG;gBACpB,MAAM;oBACJ,OAAO;oBACP,aAAa,CAAC,qBAAqB,EAAE,aAAa,QAAQ,EAAE,eAAe,IAAI,MAAM,IAAI;gBAC3F;YACF;YAEA,IAAI,eAAe,GAAG;gBACpB,MAAM;oBACJ,OAAO;oBACP,aAAa,GAAG,aAAa,QAAQ,EAAE,eAAe,IAAI,MAAM,GAAG,qBAAqB,CAAC;oBACzF,SAAS;gBACX;YACF;YAEA,kBAAkB;YAClB,uDAAuD;YACvD,MAAM;QAER,SAAU;YACR,cAAc;YACd,oBAAoB;QACtB;IACF;IAEA,MAAM,sBAAsB,OAAO,MAAe,KAAK;QACrD,IAAI,KAAK;YACP,MAAM;gBACJ,OAAO;gBACP,aAAa;YACf;YACA,MAAM,cAAc,MAAM;YAC1B,IAAI,YAAY,MAAM,KAAK,GAAG;gBAC5B,MAAM;oBACJ,OAAO;oBACP,aAAa;oBACb,SAAS;gBACX;gBACA;YACF;YACA,mBAAmB;QACrB,OAAO;YACL,IAAI,mBAAmB,IAAI,KAAK,GAAG;gBACjC,MAAM;oBACJ,OAAO;oBACP,aAAa;oBACb,SAAS;gBACX;gBACA;YACF;YACA,mBAAmB;QACrB;QACA,iBAAiB;IACnB;IAEA,MAAM,yBAAyB,OAAO;QACpC,IAAI,gBAAgB,MAAM,KAAK,GAAG;QAElC,cAAc;QACd,iBAAiB;YAAE,SAAS;YAAG,OAAO,gBAAgB,MAAM;QAAC;QAE7D,IAAI,eAAe;QACnB,IAAI,eAAe;QAEnB,IAAI;YACF,KAAK,MAAM,KAAK,gBAAiB;gBAC/B,IAAI,CAAC,EAAE,OAAO,EAAE;oBACd;oBACA,iBAAiB,CAAA,OAAQ,OAAO;4BAAE,GAAG,IAAI;4BAAE,SAAS,KAAK,OAAO,GAAG;wBAAE,IAAI;oBACzE;gBACF;gBAEA,IAAI;oBACF,MAAM,YAAY,YACd,CAAC,uBAAuB,EAAE,SAAS,QAAQ,CAAC,CAAC,EAAE,IAAA,sIAAY,EAAC,EAAE,YAAY,EAAE,GAAG,CAAC,GAChF;oBAEJ,MAAM,WAAW,MAAM,MAAM,qCAAqC;wBAChE,QAAQ;wBACR,SAAS;4BAAE,gBAAgB;wBAAmB;wBAC9C,MAAM;wBACN,MAAM,KAAK,SAAS,CAAC;4BACnB,aAAa,SAAS,kBAAkB,IAAI;4BAC5C,SAAS,CAAC,8DAA8D,EAAE,EAAE,IAAI,CAAC,mCAAmC,EAAE,EAAE,OAAO,CAAC,GAAG,EAAE,UAAU,SAAS,CAAC;wBAC3J;oBACF;oBAEA,IAAI,SAAS,EAAE,EAAE;wBACf;oBACF,OAAO;wBACL;oBACF;gBACF,EAAE,OAAO,KAAK;oBACZ,QAAQ,KAAK,CAAC,CAAC,0BAA0B,EAAE,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE;oBACtD;gBACF;gBAEA,iBAAiB,CAAA,OAAQ,OAAO;wBAAE,GAAG,IAAI;wBAAE,SAAS,KAAK,OAAO,GAAG;oBAAE,IAAI;gBAEzE,yDAAyD;gBACzD,MAAM,IAAI,QAAQ,CAAA,UAAW,WAAW,SAAS;YACnD;YAEA,IAAI,eAAe,GAAG;gBACpB,MAAM;oBACJ,OAAO;oBACP,aAAa,CAAC,KAAK,EAAE,aAAa,uBAAuB,CAAC;gBAC5D;YACF;YAEA,IAAI,eAAe,GAAG;gBACpB,MAAM;oBACJ,OAAO;oBACP,aAAa,GAAG,aAAa,oDAAoD,CAAC;oBAClF,SAAS;gBACX;YACF;YAEA,iBAAiB;QACnB,SAAU;YACR,cAAc;YACd,iBAAiB;QACnB;IACF;IAEA,MAAM,0BAA0B,OAAO,MAAe,KAAK;QACzD,uBAAuB;QACvB,IAAI;YACF,IAAI,mBAA8B,EAAE;YAEpC,IAAI,KAAK;gBACP,MAAM;oBACJ,OAAO;oBACP,aAAa;gBACf;gBACA,mBAAmB,MAAM;YAC3B,OAAO;gBACL,IAAI,mBAAmB,IAAI,KAAK,GAAG;oBACjC,MAAM;wBACJ,OAAO;wBACP,aAAa;wBACb,SAAS;oBACX;oBACA;gBACF;gBACA,mBAAmB;YACrB;YAEA,MAAM,uBAAuB,iBAAiB,MAAM,CAAC,CAAA,IAAK,EAAE,OAAO;YAEnE,IAAI,qBAAqB,MAAM,KAAK,GAAG;gBACrC,MAAM;oBACJ,OAAO;oBACP,aAAa;oBACb,SAAS;gBACX;gBACA;YACF;YAEA,MAAM;gBACJ,OAAO;gBACP,aAAa,CAAC,UAAU,EAAE,qBAAqB,MAAM,CAAC,QAAQ,EAAE,qBAAqB,MAAM,GAAG,IAAI,MAAM,GAAG,GAAG,CAAC;YACjH;YAEA,MAAM,IAAA,gKAAuB,EAAC,sBAAsB;gBAClD,WAAW;gBACX,UAAU,SAAS,QAAQ;YAC7B;YAEA,MAAM;gBACJ,OAAO;gBACP,aAAa,GAAG,qBAAqB,MAAM,CAAC,QAAQ,EAAE,qBAAqB,MAAM,GAAG,IAAI,MAAM,GAAG,iBAAiB,CAAC;YACrH;YAEA,IAAI,iBAAiB,MAAM,GAAG,qBAAqB,MAAM,EAAE;gBACzD,MAAM,UAAU,iBAAiB,MAAM,GAAG,qBAAqB,MAAM;gBACrE,MAAM;oBACJ,OAAO;oBACP,aAAa,GAAG,QAAQ,QAAQ,EAAE,UAAU,IAAI,MAAM,GAAG,oCAAoC,CAAC;gBAChG;YACF;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B;YACxC,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF,SAAU;YACR,uBAAuB;QACzB;IACF;IAEA,MAAM,0BAA0B,OAAO,MAAe,KAAK;QACzD,IAAI;YACF,IAAI,WAAsB,EAAE;YAE5B,IAAI,KAAK;gBACP,MAAM;oBACJ,OAAO;oBACP,aAAa;gBACf;gBACA,WAAW,MAAM;YACnB,OAAO;gBACL,IAAI,mBAAmB,IAAI,KAAK,GAAG;oBACjC,MAAM;wBACJ,OAAO;wBACP,aAAa;wBACb,SAAS;oBACX;oBACA;gBACF;gBACA,WAAW;YACb;YAEA,MAAM,uBAAuB,SAAS,MAAM,CAAC,CAAA,IAAK,EAAE,OAAO;YAE3D,IAAI,qBAAqB,MAAM,KAAK,GAAG;gBACrC,MAAM;oBACJ,OAAO;oBACP,aAAa;oBACb,SAAS;gBACX;gBACA;YACF;YAEA,oBAAoB;YACpB,qBAAqB;QACvB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,qCAAqC;YACnD,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF;IACF;IAEA,MAAM,6BAA6B,OAAO;QACxC,uBAAuB;QACvB,IAAI;YACF,MAAM;gBACJ,OAAO;gBACP,aAAa,CAAC,UAAU,EAAE,iBAAiB,MAAM,CAAC,QAAQ,EAAE,iBAAiB,MAAM,GAAG,IAAI,MAAM,GAAG,GAAG,CAAC;YACzG;YAEA,MAAM,IAAA,gKAAuB,EAAC,kBAAkB;gBAC9C,WAAW,OAAO,SAAS;gBAC3B,UAAU,SAAS,QAAQ;YAC7B;YAEA,MAAM;gBACJ,OAAO;gBACP,aAAa,GAAG,iBAAiB,MAAM,CAAC,QAAQ,EAAE,iBAAiB,MAAM,GAAG,IAAI,MAAM,GAAG,iBAAiB,CAAC;YAC7G;YAEA,qBAAqB;QACvB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B;YACxC,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;QACF,SAAU;YACR,uBAAuB;QACzB;IACF;IAEA,MAAM,sBAAsB,OAAO,IAAY;QAC7C,IAAI;YACF,MAAM,UAAU,MAAM,cAAc,IAAI;YACxC,IAAI,SAAS;gBACX,MAAM;oBACJ,OAAO;oBACP,aAAa;gBACf;gBACA,OAAO;YACT,OAAO;gBACL,MAAM;oBACJ,OAAO;oBACP,aAAa;oBACb,SAAS;gBACX;gBACA,OAAO;YACT;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;YACA,OAAO;QACT;IACF;IAEA,MAAM,mBAAmB,IAAA,wKAAO;8CAAC;YAC/B,OAAO,eAAe,MAAM;sDAAC,CAAA,UAAW,mBAAmB,GAAG,CAAC,QAAQ,EAAE;;QAC3E;6CAAG;QAAC;QAAgB;KAAmB;IAEvC,IAAI,mBAAmB,CAAC,mBAAoB,aAAa,SAAS,MAAM,KAAK,GAAI;QAC/E,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC,kJAAc;;;;;8BACf,6LAAC;oBAAE,WAAU;8BAAwB;;;;;;;;;;;;IAG3C;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,+IAAM;oCACL,SAAQ;oCACR,MAAK;oCACL,SAAS,IAAM,SAAS;oCACxB,WAAU;oCACV,OAAM;8CAEN,cAAA,6LAAC,gOAAS;wCAAC,WAAU;;;;;;;;;;;8CAEvB,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAG,WAAU;sDAA4D;;;;;;sDAC1E,6LAAC;4CAAE,WAAU;sDAA6C;;;;;;;;;;;;;;;;;;wBAO7D,yBACC,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;;wCACZ,2BACC,6LAAC,+IAAM;4CAAC,SAAS,IAAM,SAAS;4CAAmB,WAAU;;8DAC3D,6LAAC,6MAAI;oDAAC,MAAM;;;;;;gDAAM;;;;;;;sDAGtB,6LAAC,+IAAM;4CACL,SAAS;4CACT,SAAQ;4CACR,MAAK;4CACL,UAAU,aAAa;4CACvB,WAAU;sDAEV,cAAA,6LAAC,gOAAS;gDAAC,WAAW,CAAC,QAAQ,EAAE,AAAC,aAAa,aAAc,iBAAiB,IAAI;;;;;;;;;;;;;;;;;8CAGtF,6LAAC;oCAAI,WAAU;8CACZ,2BACC;;0DACE,6LAAC,+IAAM;gDAAC,SAAS;gDAAwB,SAAQ;gDAAU,WAAU;;kEACnE,6LAAC,yNAAQ;wDAAC,MAAM;;;;;;oDAAM;;;;;;;0DAExB,6LAAC,+IAAM;gDAAC,SAAS,IAAM,iBAAiB;gDAAO,SAAQ;gDAAU,WAAU;;kEACzE,6LAAC,mNAAM;wDAAC,MAAM;;;;;;oDAAM;;;;;;;;;;;;;;8CAK5B,6LAAC;oCAAI,WAAU;8CACZ,yBACC;;0DACE,6LAAC,+IAAM;gDAAC,SAAS;gDAAuB,SAAQ;gDAAU,WAAU;;kEAClE,6LAAC,yNAAQ;wDAAC,MAAM;;;;;;oDAAM;;;;;;;0DAExB,6LAAC,+IAAM;gDAAC,SAAS,IAAM,iBAAiB;gDAAO,SAAQ;gDAAU,WAAU;;kEACzE,6LAAC,mNAAM;wDAAC,MAAM;;;;;;oDAAM;;;;;;;;;;;;;;8CAK5B,6LAAC;oCAAI,WAAU;8CACZ,yBACC;;0DACE,6LAAC,+IAAM;gDAAC,SAAS;gDAAiB,SAAQ;gDAAU,WAAU;;kEAC5D,6LAAC,yNAAQ;wDAAC,MAAM;;;;;;oDAAM;;;;;;;0DAExB,6LAAC,+IAAM;gDAAC,SAAS;gDAAiB,SAAQ;gDAAU,WAAU;;kEAC5D,6LAAC,yNAAQ;wDAAC,MAAM;;;;;;oDAAM;;;;;;;;;;;;;;gCAK7B,aAAa,mBAAmB,IAAI,GAAG,mBACtC,6LAAC,+IAAM;oCACL,SAAS,IAAM,kBAAkB;oCACjC,SAAQ;oCACR,WAAU;oCACV,UAAU;;sDAEV,6LAAC,uNAAM;4CAAC,MAAM;;;;;;wCAAM;wCAAmB,mBAAmB,IAAI;wCAAC;;;;;;;gCAGlE,yBACC,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,+IAAM;4CACL,SAAS,IAAM,oBAAoB;4CACnC,SAAQ;4CACR,WAAU;4CACV,UAAU,mBAAmB,IAAI,KAAK,KAAK;;8DAE3C,6LAAC,sNAAO;oDAAC,MAAM;;;;;;gDAAM;;;;;;;sDAEvB,6LAAC,+IAAM;4CACL,SAAS,IAAM,oBAAoB;4CACnC,SAAQ;4CACR,WAAU;4CACV,UAAU,eAAe,KAAK;;8DAE9B,6LAAC,sNAAO;oDAAC,MAAM;;;;;;gDAAM;gDAAa;gDAAW;;;;;;;;;;;;;gCAIlD,yBACC,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,+IAAM;4CACL,SAAS,IAAM,wBAAwB;4CACvC,SAAQ;4CACR,WAAU;4CACV,UAAU,mBAAmB,IAAI,KAAK,KAAK;;8DAE3C,6LAAC,yNAAQ;oDAAC,MAAM;;;;;;gDAAM;;;;;;;sDAExB,6LAAC,+IAAM;4CACL,SAAS,IAAM,wBAAwB;4CACvC,SAAQ;4CACR,WAAU;4CACV,UAAU,eAAe,KAAK;;8DAE9B,6LAAC,yNAAQ;oDAAC,MAAM;;;;;;gDAAM;;;;;;;;;;;;;;;;;;uEAM9B,yBAAyB;sCACzB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,+IAAM;oCACL,SAAS;oCACT,SAAQ;oCACR,MAAK;oCACL,UAAU,aAAa;oCACvB,OAAM;8CAEN,cAAA,6LAAC,gOAAS;wCAAC,WAAW,CAAC,QAAQ,EAAE,AAAC,aAAa,aAAc,iBAAiB,IAAI;;;;;;;;;;;gCAGnF,2BACC;;sDACE,6LAAC,+IAAM;4CAAC,SAAS;4CAAwB,SAAQ;4CAAU,WAAU;;8DACnE,6LAAC,yNAAQ;oDAAC,MAAM;;;;;;gDAAM;;;;;;;sDAExB,6LAAC,+IAAM;4CAAC,SAAS,IAAM,iBAAiB;4CAAO,SAAQ;4CAAU,WAAU;;8DACzE,6LAAC,mNAAM;oDAAC,MAAM;;;;;;gDAAM;;;;;;;;;gCAKzB,yBACC;;sDACE,6LAAC,+IAAM;4CAAC,SAAS;4CAAuB,SAAQ;4CAAU,WAAU;;8DAClE,6LAAC,yNAAQ;oDAAC,MAAM;;;;;;gDAAM;;;;;;;sDAExB,6LAAC,+IAAM;4CAAC,SAAS,IAAM,iBAAiB;4CAAO,SAAQ;4CAAU,WAAU;;8DACzE,6LAAC,mNAAM;oDAAC,MAAM;;;;;;gDAAM;;;;;;;;;gCAKzB,yBACC;;sDACE,6LAAC,+IAAM;4CAAC,SAAS;4CAAiB,SAAQ;4CAAU,WAAU;;8DAC5D,6LAAC,yNAAQ;oDAAC,MAAM;;;;;;gDAAM;;;;;;;sDAExB,6LAAC,+IAAM;4CAAC,SAAS;4CAAiB,SAAQ;4CAAU,WAAU;;8DAC5D,6LAAC,yNAAQ;oDAAC,MAAM;;;;;;gDAAM;;;;;;;;;gCAI3B,aAAa,mBAAmB,IAAI,GAAG,mBACtC,6LAAC,+IAAM;oCACL,SAAS,IAAM,kBAAkB;oCACjC,SAAQ;oCACR,WAAU;oCACV,UAAU;;sDAEV,6LAAC,uNAAM;4CAAC,MAAM;;;;;;wCAAM;wCAAmB,mBAAmB,IAAI;wCAAC;;;;;;;gCAGlE,yBACC;;sDACE,6LAAC,+IAAM;4CACL,SAAS,IAAM,oBAAoB;4CACnC,SAAQ;4CACR,WAAU;4CACV,UAAU,mBAAmB,IAAI,KAAK,KAAK;;8DAE3C,6LAAC,sNAAO;oDAAC,MAAM;;;;;;gDAAM;;;;;;;sDAEvB,6LAAC,+IAAM;4CACL,SAAS,IAAM,oBAAoB;4CACnC,SAAQ;4CACR,WAAU;4CACV,UAAU,eAAe,KAAK;;8DAE9B,6LAAC,sNAAO;oDAAC,MAAM;;;;;;gDAAM;gDAAa;gDAAW;;;;;;;;;gCAIlD,yBACC,6LAAC,+JAAY;;sDACX,6LAAC,sKAAmB;4CAAC,OAAO;sDAC1B,cAAA,6LAAC,+IAAM;gDACL,SAAQ;gDACR,WAAU;gDACV,UAAU;;kEAEV,6LAAC,yNAAQ;wDAAC,MAAM;;;;;;oDAAM;kEAAiB,6LAAC,sOAAW;wDAAC,MAAM;;;;;;;;;;;;;;;;;sDAG9D,6LAAC,sKAAmB;4CAAC,OAAM;;8DACzB,6LAAC,mKAAgB;oDACf,SAAS,IAAM,wBAAwB;oDACvC,UAAU,mBAAmB,IAAI,KAAK;;sEAEtC,6LAAC,yNAAQ;4DAAC,WAAU;;;;;;wDAAiB;wDACjB,mBAAmB,IAAI;wDAAC;;;;;;;8DAE9C,6LAAC,wKAAqB;;;;;8DACtB,6LAAC,mKAAgB;oDACf,SAAS,IAAM,wBAAwB;oDACvC,UAAU,eAAe;;sEAEzB,6LAAC,yNAAQ;4DAAC,WAAU;;;;;;wDAAiB;wDACtB;wDAAW;;;;;;;;;;;;;;;;;;;gCAKjC,2BACC,6LAAC,+IAAM;oCAAC,SAAS,IAAM,SAAS;oCAAmB,WAAU;;sDAC3D,6LAAC,6MAAI;4CAAC,MAAM;;;;;;wCAAM;;;;;;;;;;;;;;;;;;;;;;;;0BAS9B,6LAAC,+JAAc;gBACb,UAAU;gBACV,gBAAgB;gBAChB,oBAAoB;gBACpB,wBAAwB;gBACxB,kBAAkB;gBAClB,oBAAoB;gBACpB,yBAAyB;;;;;;0BAI3B,6LAAC,2IAAI;gBAAC,WAAU;;kCACd,6LAAC,iJAAU;wBAAC,WAAU;kCACpB,cAAA,6LAAC,gJAAS;4BAAC,WAAU;sCAAqB;;;;;;;;;;;kCAE5C,6LAAC,kJAAW;wBAAC,WAAU;kCACrB,cAAA,6LAAC,iKAAgB;4BACf,SAAS;4BACT,YAAY;4BACZ,YAAY;4BACZ,eAAe,eAAe,MAAM;;;;;;;;;;;;;;;;;0BAM1C,6LAAC,2IAAI;gBAAC,WAAU;;kCACd,6LAAC,iJAAU;wBAAC,WAAU;;0CACpB,6LAAC,gJAAS;gCAAC,WAAU;0CACnB,cAAA,6LAAC;;wCAAK;wCACO;wCAAW;wCACrB,mBAAmB,IAAI,GAAG,mBACzB,6LAAC;4CAAK,WAAU;;gDACb,mBAAmB,IAAI;gDAAC;;;;;;;;;;;;;;;;;;0CAKjC,6LAAC;gCAAI,WAAU;;oCAAuF;kDACjG,6LAAC;kDAAO;;;;;;oCAAa;;;;;;;;;;;;;kCAG5B,6LAAC,kJAAW;wBAAC,WAAU;;0CACrB,6LAAC,+JAAc;gCACb,UAAU;gCACV,WAAW;gCACX,eAAe;gCACf,mBAAmB;gCACnB,oBAAoB;gCACpB,0BAA0B;gCAC1B,qBAAqB;gCACrB,WAAW;gCACX,WAAW;gCACX,QAAQ,CAAC;oCACP,IAAI,cAAc,OAAO;wCACvB,aAAa,cAAc,QAAQ,SAAS;oCAC9C,OAAO;wCACL,aAAa;wCACb,aAAa;oCACf;gCACF;gCACA,iBAAiB;gCACjB,YAAY,WAAW,GAAG,CAAC,CAAA,MAAO,IAAI,IAAI;;;;;;0CAG5C,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;4CAA2C;4CAC/C,CAAC,OAAO,CAAC,IAAI,WAAW;4CAAE;4CAAE,KAAK,GAAG,CAAC,OAAO,UAAU;4CAAY;4CAAK;;;;;;;kDAElF,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDACC,WAAU;gDACV,OAAO;gDACP,UAAU,CAAC,IAAM,YAAY,OAAO,EAAE,MAAM,CAAC,KAAK;0DAEjD;oDAAC;oDAAI;oDAAI;iDAAI,CAAC,GAAG,CAAC,CAAA,qBACjB,6LAAC;wDAAkB,OAAO;;4DAAO;4DAAK;;uDAAzB;;;;;;;;;;0DAGjB,6LAAC,+IAAM;gDACL,SAAQ;gDACR,MAAK;gDACL,UAAU,SAAS,KAAK;gDACxB,SAAS,IAAM,QAAQ,KAAK,GAAG,CAAC,GAAG,OAAO;0DAC3C;;;;;;0DAGD,6LAAC,+IAAM;gDACL,SAAQ;gDACR,MAAK;gDACL,UAAU,OAAO,YAAY,cAAc;gDAC3C,SAAS,IAAM,QAAQ,OAAO;0DAC/B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAST,6LAAC,gKAAe;gBACd,MAAM;gBACN,cAAc;gBACd,UAAU;gBACV,YAAY,WAAW,GAAG,CAAC,CAAA,MAAO,IAAI,IAAI;;;;;;0BAG5C,6LAAC,gKAAe;gBACd,MAAM;gBACN,cAAc;gBACd,QAAQ,MAAM;;;;;;0BAGhB,6LAAC,iKAAgB;gBACf,MAAM;gBACN,cAAc;gBACd,kBAAkB;gBAClB,WAAW;gBACX,YAAY;gBACZ,kBAAkB;;;;;;0BAGpB,6LAAC,gKAAe;gBACd,MAAM;gBACN,cAAc;gBACd,kBAAkB;gBAClB,WAAW;gBACX,YAAY;gBACZ,eAAe;;;;;;0BAGjB,6LAAC,oKAAmB;gBAClB,MAAM;gBACN,cAAc;gBACd,cAAc,iBAAiB,MAAM,CAAC,CAAA,IAAK,EAAE,OAAO,EAAE,MAAM;gBAC5D,WAAW;gBACX,aAAa;;;;;;;;;;;;AAIrB;GA9jCM;;QACa,kLAAW;QACX,wJAAO;QACgC,qJAAW;QACzC,oJAAW;QACnB,2IAAQ;QACT,gJAAW;QAuBxB,6IAAW;QAEQ,iJAAa;QACL,qJAAe;QACzB,6JAAmB;;;KAjCpC;uCAgkCS"}}]
}