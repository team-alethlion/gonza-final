{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/InventoryStats.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Product } from '@/types';\r\nimport { Package, AlertTriangle, Ban, TrendingUp, DollarSign } from 'lucide-react';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { formatNumber } from '@/lib/utils';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\ninterface InventoryStatsProps {\r\n  products: Product[];\r\n  hideStockValue?: boolean;\r\n  // Optional overrides to show totals beyond the current page without fetching all rows here\r\n  totalCountOverride?: number;\r\n  totalCostValueOverride?: number;\r\n  lowStockOverride?: number;\r\n  outOfStockOverride?: number;\r\n  totalStockValueOverride?: number;\r\n}\r\n\r\nconst InventoryStats: React.FC<InventoryStatsProps> = ({\r\n  products,\r\n  hideStockValue = false,\r\n  totalCountOverride,\r\n  totalCostValueOverride,\r\n  lowStockOverride,\r\n  outOfStockOverride,\r\n  totalStockValueOverride\r\n}) => {\r\n\r\n  const { settings } = useBusinessSettings();\r\n  const { canViewCostPrice, canViewSellingPrice } = useFinancialVisibility();\r\n\r\n\r\n  // Calculate stats\r\n  const totalProducts = typeof totalCountOverride === 'number' ? totalCountOverride : products.length;\r\n  const lowStockProducts = typeof lowStockOverride === 'number' ? lowStockOverride : products.filter(p => p.quantity > 0 && p.quantity <= p.minimumStock).length;\r\n  const outOfStockProducts = typeof outOfStockOverride === 'number' ? outOfStockOverride : products.filter(p => p.quantity === 0).length;\r\n\r\n  const totalInventoryValue = typeof totalCostValueOverride === 'number'\r\n    ? totalCostValueOverride\r\n    : products.reduce((sum, product) => sum + (product.costPrice * product.quantity), 0);\r\n\r\n  const totalStockValue = typeof totalStockValueOverride === 'number'\r\n    ? totalStockValueOverride\r\n    : products.reduce((sum, product) => {\r\n      return sum + (product.sellingPrice * product.quantity);\r\n    }, 0);\r\n\r\n  // Get dynamic font size based on text length\r\n  const getDynamicFontSize = (text: string) => {\r\n    const length = text.length;\r\n    if (length > 15) return \"text-sm md:text-lg\"; // Very long numbers\r\n    if (length > 12) return \"text-base md:text-xl\"; // Long numbers\r\n    if (length > 8) return \"text-lg md:text-xl\"; // Medium numbers\r\n    return \"text-lg md:text-2xl\"; // Short numbers (default)\r\n  };\r\n\r\n  return (\r\n    <div className={`grid gap-3 md:gap-4 mb-6 ${hideStockValue ? 'grid-cols-2 md:grid-cols-4' : 'grid-cols-2 md:grid-cols-3 xl:grid-cols-5'}`}>\r\n      <Card className=\"overflow-hidden\">\r\n        <CardContent className=\"p-4 md:p-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-blue-100 text-blue-500\">\r\n              <Package className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n            </div>\r\n            <div className=\"ml-3 md:ml-4 min-w-0\">\r\n              <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Total Products</p>\r\n              <h3 className=\"text-lg md:text-2xl font-bold\">{totalProducts}</h3>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card className=\"overflow-hidden\">\r\n        <CardContent className=\"p-4 md:p-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-amber-100 text-amber-500\">\r\n              <AlertTriangle className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n            </div>\r\n            <div className=\"ml-3 md:ml-4 min-w-0\">\r\n              <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Low Stock</p>\r\n              <h3 className=\"text-lg md:text-2xl font-bold\">{lowStockProducts}</h3>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card className=\"overflow-hidden\">\r\n        <CardContent className=\"p-4 md:p-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-red-100 text-red-500\">\r\n              <Ban className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n            </div>\r\n            <div className=\"ml-3 md:ml-4 min-w-0\">\r\n              <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Out of Stock</p>\r\n              <h3 className=\"text-lg md:text-2xl font-bold\">{outOfStockProducts}</h3>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card className=\"overflow-hidden\">\r\n        <CardContent className=\"p-4 md:p-6\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-green-100 text-green-500\">\r\n              <TrendingUp className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n            </div>\r\n            <div className=\"ml-3 md:ml-4 min-w-0 flex-1\">\r\n              <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Cost Value</p>\r\n              <h3 className={`${getDynamicFontSize(`${settings.currency} ${formatNumber(totalInventoryValue)}`)} font-bold break-all leading-tight`}>\r\n                {canViewCostPrice ? `${settings.currency} ${formatNumber(totalInventoryValue)}` : '•••'}\r\n              </h3>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {!hideStockValue && (\r\n        <Card className=\"overflow-hidden\">\r\n          <CardContent className=\"p-4 md:p-6\">\r\n            <div className=\"flex items-center\">\r\n              <div className=\"inline-flex h-8 w-8 md:h-10 md:w-10 shrink-0 items-center justify-center rounded-lg bg-purple-100 text-purple-500\">\r\n                <DollarSign className=\"h-4 w-4 md:h-5 md:w-5\" />\r\n              </div>\r\n              <div className=\"ml-3 md:ml-4 min-w-0 flex-1\">\r\n                <p className=\"text-xs md:text-sm font-medium text-gray-500 truncate\">Stock Value</p>\r\n                <h3 className={`${getDynamicFontSize(`${settings.currency} ${formatNumber(totalStockValue)}`)} font-bold break-all leading-tight`}>\r\n                  {canViewSellingPrice ? `${settings.currency} ${formatNumber(totalStockValue)}` : '•••'}\r\n                </h3>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InventoryStats;\r\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;AAaA,MAAM,iBAAgD,CAAC,EACrD,QAAQ,EACR,iBAAiB,KAAK,EACtB,kBAAkB,EAClB,sBAAsB,EACtB,gBAAgB,EAChB,kBAAkB,EAClB,uBAAuB,EACxB;;IAEC,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,6JAAmB;IACxC,MAAM,EAAE,gBAAgB,EAAE,mBAAmB,EAAE,GAAG,IAAA,mKAAsB;IAGxE,kBAAkB;IAClB,MAAM,gBAAgB,OAAO,uBAAuB,WAAW,qBAAqB,SAAS,MAAM;IACnG,MAAM,mBAAmB,OAAO,qBAAqB,WAAW,mBAAmB,SAAS,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,GAAG,KAAK,EAAE,QAAQ,IAAI,EAAE,YAAY,EAAE,MAAM;IAC9J,MAAM,qBAAqB,OAAO,uBAAuB,WAAW,qBAAqB,SAAS,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK,GAAG,MAAM;IAEtI,MAAM,sBAAsB,OAAO,2BAA2B,WAC1D,yBACA,SAAS,MAAM,CAAC,CAAC,KAAK,UAAY,MAAO,QAAQ,SAAS,GAAG,QAAQ,QAAQ,EAAG;IAEpF,MAAM,kBAAkB,OAAO,4BAA4B,WACvD,0BACA,SAAS,MAAM,CAAC,CAAC,KAAK;QACtB,OAAO,MAAO,QAAQ,YAAY,GAAG,QAAQ,QAAQ;IACvD,GAAG;IAEL,6CAA6C;IAC7C,MAAM,qBAAqB,CAAC;QAC1B,MAAM,SAAS,KAAK,MAAM;QAC1B,IAAI,SAAS,IAAI,OAAO,sBAAsB,oBAAoB;QAClE,IAAI,SAAS,IAAI,OAAO,wBAAwB,eAAe;QAC/D,IAAI,SAAS,GAAG,OAAO,sBAAsB,iBAAiB;QAC9D,OAAO,uBAAuB,0BAA0B;IAC1D;IAEA,qBACE,6LAAC;QAAI,WAAW,CAAC,yBAAyB,EAAE,iBAAiB,+BAA+B,6CAA6C;;0BACvI,6LAAC,2IAAI;gBAAC,WAAU;0BACd,cAAA,6LAAC,kJAAW;oBAAC,WAAU;8BACrB,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,sNAAO;oCAAC,WAAU;;;;;;;;;;;0CAErB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAE,WAAU;kDAAwD;;;;;;kDACrE,6LAAC;wCAAG,WAAU;kDAAiC;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAMvD,6LAAC,2IAAI;gBAAC,WAAU;0BACd,cAAA,6LAAC,kJAAW;oBAAC,WAAU;8BACrB,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,4OAAa;oCAAC,WAAU;;;;;;;;;;;0CAE3B,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAE,WAAU;kDAAwD;;;;;;kDACrE,6LAAC;wCAAG,WAAU;kDAAiC;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAMvD,6LAAC,2IAAI;gBAAC,WAAU;0BACd,cAAA,6LAAC,kJAAW;oBAAC,WAAU;8BACrB,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,0MAAG;oCAAC,WAAU;;;;;;;;;;;0CAEjB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAE,WAAU;kDAAwD;;;;;;kDACrE,6LAAC;wCAAG,WAAU;kDAAiC;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAMvD,6LAAC,2IAAI;gBAAC,WAAU;0BACd,cAAA,6LAAC,kJAAW;oBAAC,WAAU;8BACrB,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,mOAAU;oCAAC,WAAU;;;;;;;;;;;0CAExB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAE,WAAU;kDAAwD;;;;;;kDACrE,6LAAC;wCAAG,WAAW,GAAG,mBAAmB,GAAG,SAAS,QAAQ,CAAC,CAAC,EAAE,IAAA,sIAAY,EAAC,sBAAsB,EAAE,kCAAkC,CAAC;kDAClI,mBAAmB,GAAG,SAAS,QAAQ,CAAC,CAAC,EAAE,IAAA,sIAAY,EAAC,sBAAsB,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAO3F,CAAC,gCACA,6LAAC,2IAAI;gBAAC,WAAU;0BACd,cAAA,6LAAC,kJAAW;oBAAC,WAAU;8BACrB,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,mOAAU;oCAAC,WAAU;;;;;;;;;;;0CAExB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAE,WAAU;kDAAwD;;;;;;kDACrE,6LAAC;wCAAG,WAAW,GAAG,mBAAmB,GAAG,SAAS,QAAQ,CAAC,CAAC,EAAE,IAAA,sIAAY,EAAC,kBAAkB,EAAE,kCAAkC,CAAC;kDAC9H,sBAAsB,GAAG,SAAS,QAAQ,CAAC,CAAC,EAAE,IAAA,sIAAY,EAAC,kBAAkB,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASnG;GArHM;;QAUiB,6JAAmB;QACU,mKAAsB;;;KAXpE;uCAuHS"}},
    {"offset": {"line": 382, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/ProductImage.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Image as ImageIcon } from 'lucide-react';\r\n\r\ninterface ProductImageProps {\r\n  imageUrl?: string | null;\r\n  alt: string;\r\n  size?: 'sm' | 'md';\r\n}\r\n\r\nconst ProductImage: React.FC<ProductImageProps> = ({\r\n  imageUrl,\r\n  alt,\r\n  size = 'md'\r\n}) => {\r\n  const dimensions = size === 'sm' ? 'w-10 h-10' : 'w-12 h-12';\r\n  \r\n  if (imageUrl) {\r\n    return (\r\n      <img \r\n        src={imageUrl} \r\n        alt={alt} \r\n        className={`${dimensions} object-cover rounded-md`}\r\n      />\r\n    );\r\n  }\r\n  \r\n  return (\r\n    <div className={`${dimensions} bg-gray-100 flex items-center justify-center rounded-md`}>\r\n      <ImageIcon size={size === 'sm' ? 16 : 18} className=\"text-gray-400\" />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductImage;\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAQA,MAAM,eAA4C,CAAC,EACjD,QAAQ,EACR,GAAG,EACH,OAAO,IAAI,EACZ;IACC,MAAM,aAAa,SAAS,OAAO,cAAc;IAEjD,IAAI,UAAU;QACZ,qBACE,6LAAC;YACC,KAAK;YACL,KAAK;YACL,WAAW,GAAG,WAAW,wBAAwB,CAAC;;;;;;IAGxD;IAEA,qBACE,6LAAC;QAAI,WAAW,GAAG,WAAW,wDAAwD,CAAC;kBACrF,cAAA,6LAAC,gNAAS;YAAC,MAAM,SAAS,OAAO,KAAK;YAAI,WAAU;;;;;;;;;;;AAG1D;KAtBM;uCAwBS"}},
    {"offset": {"line": 430, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/ProductSuggestionsPanel.tsx"],"sourcesContent":["\r\n\r\nimport React from 'react';\r\nimport { Product } from '@/types';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Package, Search, X } from 'lucide-react';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport ProductImage from './ProductImage';\r\nimport {\r\n  Sheet,\r\n  SheetContent,\r\n  SheetDescription,\r\n  SheetHeader,\r\n  SheetTitle,\r\n} from '@/components/ui/sheet';\r\nimport { Button } from '@/components/ui/button';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\n\r\ninterface ProductSuggestionsPanelProps {\r\n  suggestions: Product[];\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSelectProduct: (product: Product) => void;\r\n  searchTerm: string;\r\n  isLoading?: boolean;\r\n}\r\n\r\nconst ProductSuggestionsPanel: React.FC<ProductSuggestionsPanelProps> = ({\r\n  suggestions,\r\n  isOpen,\r\n  onClose,\r\n  onSelectProduct,\r\n  searchTerm,\r\n  isLoading = false\r\n}) => {\r\n  const { settings } = useBusinessSettings();\r\n  const isMobile = useIsMobile();\r\n\r\n  const highlightMatch = (text: string, searchTerm: string) => {\r\n    if (!searchTerm) return text;\r\n\r\n    // Escape special regex characters in searchTerm\r\n    const escapedSearchTerm = searchTerm.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\r\n    const regex = new RegExp(`(${escapedSearchTerm})`, 'gi');\r\n    const parts = text.split(regex);\r\n\r\n    return parts.map((part, index) =>\r\n      regex.test(part) ? (\r\n        <span key={index} className=\"bg-yellow-200 font-medium\">\r\n          {part}\r\n        </span>\r\n      ) : (\r\n        <span key={index}>{part}</span>\r\n      )\r\n    );\r\n  };\r\n\r\n  const handleProductSelect = (product: Product) => {\r\n    onSelectProduct(product);\r\n    onClose();\r\n  };\r\n\r\n  // Mobile dropdown implementation\r\n  if (isMobile) {\r\n    if (!isOpen) return null;\r\n    if (suggestions.length === 0 && !isLoading) return null;\r\n\r\n    return (\r\n      <div className=\"bg-white border border-gray-200 rounded-md shadow-lg max-h-80 overflow-y-auto\">\r\n        <div className=\"p-2 border-b bg-gray-50\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Search className=\"h-4 w-4 text-gray-600\" />\r\n              <span className=\"text-sm font-medium\">Suggestions</span>\r\n            </div>\r\n            <Button variant=\"ghost\" size=\"icon\" onClick={onClose} className=\"h-6 w-6\">\r\n              <X className=\"h-3 w-3\" />\r\n            </Button>\r\n          </div>\r\n          <p className=\"text-xs text-gray-500 mt-1\">\r\n            {isLoading\r\n              ? 'Searching for products...'\r\n              : suggestions.length > 0\r\n                ? `Found ${suggestions.length} product${suggestions.length > 1 ? 's' : ''}`\r\n                : 'No products found'\r\n            }\r\n          </p>\r\n        </div>\r\n\r\n        {isLoading && (\r\n          <div className=\"p-8 text-center bg-white\">\r\n            <div className=\"h-6 w-6 border-2 border-primary border-t-transparent animate-spin rounded-full mx-auto mb-2\" />\r\n            <span className=\"text-xs text-gray-500\">Searching...</span>\r\n          </div>\r\n        )}\r\n\r\n        {!isLoading && suggestions.length > 0 && (\r\n          <div className=\"max-h-64 overflow-y-auto bg-primary\">\r\n            {suggestions.map((product) => (\r\n              <div\r\n                key={product.id}\r\n                className=\"p-3 hover:bg-primary-foreground/20 cursor-pointer border-b border-primary-foreground/20 last:border-b-0 bg-white mx-1 my-1 rounded\"\r\n                onClick={() => handleProductSelect(product)}\r\n              >\r\n                <div className=\"flex items-start gap-3\">\r\n                  <ProductImage imageUrl={product.imageUrl} alt={product.name} size=\"sm\" />\r\n\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-center gap-2 mb-1\">\r\n                      <Package className=\"h-4 w-4 text-gray-400 flex-shrink-0\" />\r\n                      <div className=\"font-medium text-sm truncate\">\r\n                        {highlightMatch(product.name, searchTerm)}\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-2 mb-2\">\r\n                      <Badge variant=\"outline\" className=\"text-xs\">\r\n                        {product.category}\r\n                      </Badge>\r\n                      <span className=\"text-xs text-gray-500\">\r\n                        Item #: {highlightMatch(product.itemNumber, searchTerm)}\r\n                      </span>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-between text-xs text-gray-600 mb-1\">\r\n                      <span>Qty: {product.quantity % 1 === 0 ? product.quantity : product.quantity.toFixed(2)}</span>\r\n                      <span className=\"font-medium\">\r\n                        {settings.currency} {product.sellingPrice.toFixed(2)}\r\n                      </span>\r\n                    </div>\r\n\r\n                    {product.description && (\r\n                      <div className=\"text-xs text-gray-500 truncate\">\r\n                        {highlightMatch(product.description, searchTerm)}\r\n                      </div>\r\n                    )}\r\n\r\n                    {product.supplier && (\r\n                      <div className=\"text-xs text-gray-500 mt-1\">\r\n                        Supplier: {highlightMatch(product.supplier, searchTerm)}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {!isLoading && suggestions.length === 0 && (\r\n          <div className=\"p-8 text-center bg-white\">\r\n            <Search className=\"h-8 w-8 text-gray-300 mx-auto mb-2\" />\r\n            <p className=\"text-xs text-gray-500\">No products found matching \"{searchTerm}\"</p>\r\n          </div>\r\n        )}\r\n\r\n        {suggestions.length >= 50 && (\r\n          <div className=\"p-3 border-t bg-primary text-center\">\r\n            <span className=\"text-xs text-primary-foreground\">\r\n              Showing top 50 results. Keep typing to refine...\r\n            </span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Desktop sidebar implementation\r\n  return (\r\n    <Sheet open={isOpen} onOpenChange={onClose} modal={false}>\r\n      <SheetContent\r\n        className=\"w-full sm:w-[400px] sm:max-w-[400px] p-0 z-[100] pointer-events-auto flex flex-col bg-primary\"\r\n        side=\"right\"\r\n        onOpenAutoFocus={(e) => e.preventDefault()}\r\n        onCloseAutoFocus={(e) => e.preventDefault()}\r\n      >\r\n        <SheetHeader className=\"p-4 border-b border-primary-foreground/20 bg-primary flex-shrink-0\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Search className=\"h-4 w-4 text-primary-foreground\" />\r\n              <SheetTitle className=\"text-base text-primary-foreground\">Product Suggestions</SheetTitle>\r\n            </div>\r\n            <Button variant=\"ghost\" size=\"icon\" onClick={onClose} className=\"h-8 w-8 text-primary-foreground hover:bg-primary-foreground/20\">\r\n              <X className=\"h-4 w-4\" />\r\n            </Button>\r\n          </div>\r\n          <SheetDescription className=\"text-left text-primary-foreground/80\">\r\n            {isLoading\r\n              ? 'Searching for products...'\r\n              : suggestions.length > 0\r\n                ? `Found ${suggestions.length} product${suggestions.length > 1 ? 's' : ''} matching \"${searchTerm}\"`\r\n                : `No products found matching \"${searchTerm}\"`\r\n            }\r\n          </SheetDescription>\r\n        </SheetHeader>\r\n\r\n        {isLoading ? (\r\n          <div className=\"flex-1 flex flex-col items-center justify-center p-8 text-primary-foreground bg-primary\">\r\n            <div className=\"h-8 w-8 border-2 border-primary-foreground border-t-transparent animate-spin rounded-full mb-4\" />\r\n            <p className=\"text-sm\">Searching products...</p>\r\n          </div>\r\n        ) : suggestions.length > 0 ? (\r\n          <ScrollArea className=\"flex-1 h-0 bg-primary\">\r\n            <div className=\"p-2\">\r\n              {suggestions.map((product) => (\r\n                <div\r\n                  key={product.id}\r\n                  className=\"p-3 hover:bg-primary-foreground/20 cursor-pointer border-b border-primary-foreground/20 last:border-b-0 rounded-md mx-1 my-1 hover:shadow-sm transition-all bg-white\"\r\n                  onClick={() => handleProductSelect(product)}\r\n                >\r\n                  <div className=\"flex items-start gap-3\">\r\n                    <ProductImage imageUrl={product.imageUrl} alt={product.name} size=\"sm\" />\r\n\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"flex items-center gap-2 mb-1\">\r\n                        <Package className=\"h-4 w-4 text-gray-400 flex-shrink-0\" />\r\n                        <div className=\"font-medium text-sm truncate\">\r\n                          {highlightMatch(product.name, searchTerm)}\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center gap-2 mb-2\">\r\n                        <Badge variant=\"outline\" className=\"text-xs\">\r\n                          {product.category}\r\n                        </Badge>\r\n                        <span className=\"text-xs text-gray-500\">\r\n                          Item #: {highlightMatch(product.itemNumber, searchTerm)}\r\n                        </span>\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center justify-between text-xs text-gray-600 mb-1\">\r\n                        <span>Qty: {product.quantity % 1 === 0 ? product.quantity : product.quantity.toFixed(2)}</span>\r\n                        <span className=\"font-medium\">\r\n                          {settings.currency} {product.sellingPrice.toFixed(2)}\r\n                        </span>\r\n                      </div>\r\n\r\n                      {product.description && (\r\n                        <div className=\"text-xs text-gray-500 truncate\">\r\n                          {highlightMatch(product.description, searchTerm)}\r\n                        </div>\r\n                      )}\r\n\r\n                      {product.supplier && (\r\n                        <div className=\"text-xs text-gray-500 mt-1\">\r\n                          Supplier: {highlightMatch(product.supplier, searchTerm)}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </ScrollArea>\r\n        ) : (\r\n          <div className=\"p-8 text-center text-primary-foreground flex-1 flex flex-col items-center justify-center bg-primary\">\r\n            <Search className=\"h-12 w-12 mx-auto mb-4 text-primary-foreground/50\" />\r\n            <p className=\"text-sm\">No products found</p>\r\n            <p className=\"text-xs mt-1\">Try adjusting your search term</p>\r\n          </div>\r\n        )}\r\n\r\n        {suggestions.length >= 50 && (\r\n          <div className=\"p-3 border-t bg-primary text-center flex-shrink-0\">\r\n            <span className=\"text-xs text-primary-foreground\">\r\n              Showing top 50 results. Keep typing to refine...\r\n            </span>\r\n          </div>\r\n        )}\r\n      </SheetContent>\r\n    </Sheet>\r\n  );\r\n};\r\n\r\nexport default ProductSuggestionsPanel;\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1105, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/ItemSalesDialog.tsx"],"sourcesContent":["\r\nimport React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Edit, Printer } from 'lucide-react';\r\nimport { formatCashCurrency } from '@/lib/utils';\r\nimport { format, isSameDay } from 'date-fns';\r\nimport { Sale } from '@/types';\r\nimport { getDateRangeFromFilter } from '@/utils/dateFilters';\r\nimport ReceiptDialog from '@/components/sales/ReceiptDialog';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\ninterface ItemSalesDialogProps {\r\n  isOpen: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  itemDescription: string;\r\n  sales: Sale[];\r\n  currency: string;\r\n  dateFilter: string;\r\n  dateRange: { from: Date | undefined; to: Date | undefined; };\r\n  specificDate: Date | undefined;\r\n}\r\n\r\nconst ItemSalesDialog: React.FC<ItemSalesDialogProps> = ({\r\n  isOpen,\r\n  onOpenChange,\r\n  itemDescription,\r\n  sales,\r\n  currency,\r\n  dateFilter,\r\n  dateRange,\r\n  specificDate\r\n}) => {\r\n  const navigate = useNavigate();\r\n  const { hasPermission } = useProfiles();\r\n  const { canViewSellingPrice } = useFinancialVisibility();\r\n  const [selectedSale, setSelectedSale] = useState<Sale | null>(null);\r\n  const [isReceiptOpen, setIsReceiptOpen] = useState(false);\r\n\r\n  // Apply the same date filtering logic as in SoldItemsTab\r\n  const getFilteredSales = () => {\r\n    let from: Date, to: Date;\r\n\r\n    if (dateFilter === 'specific-date' && specificDate) {\r\n      // Use the specific date for both from and to\r\n      from = new Date(specificDate);\r\n      from.setHours(0, 0, 0, 0);\r\n      to = new Date(specificDate);\r\n      to.setHours(23, 59, 59, 999);\r\n    } else if (dateFilter === 'custom' && dateRange.from && dateRange.to) {\r\n      // Use the custom date range\r\n      from = dateRange.from;\r\n      to = dateRange.to;\r\n    } else {\r\n      // Use predefined date filter\r\n      const range = getDateRangeFromFilter(dateFilter);\r\n      from = range.from;\r\n      to = range.to;\r\n    }\r\n\r\n    // Filter sales by date range and exclude quotes, then filter by item\r\n    const filteredSales = sales.filter(sale => {\r\n      const saleDate = new Date(sale.date);\r\n\r\n      let dateMatches = false;\r\n      if (dateFilter === 'specific-date' && specificDate) {\r\n        dateMatches = isSameDay(saleDate, specificDate);\r\n      } else {\r\n        dateMatches = saleDate >= from && saleDate <= to;\r\n      }\r\n\r\n      const hasItem = sale.items.some(item => item.description === itemDescription);\r\n      const isNotQuote = sale.paymentStatus !== 'Quote';\r\n\r\n      return dateMatches && hasItem && isNotQuote;\r\n    });\r\n\r\n    return filteredSales;\r\n  };\r\n\r\n  const relevantSales = getFilteredSales();\r\n\r\n  const handleEditSale = (sale: Sale) => {\r\n    navigate('/new-sale', { state: { editSale: sale } });\r\n    onOpenChange(false); // Close the dialog\r\n  };\r\n\r\n  const handleViewReceipt = (sale: Sale) => {\r\n    setSelectedSale(sale);\r\n    setIsReceiptOpen(true);\r\n  };\r\n\r\n  const handleCloseReceipt = () => {\r\n    setIsReceiptOpen(false);\r\n    setSelectedSale(null);\r\n  };\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-5xl max-h-[80vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle>Sales for \"{itemDescription}\"</DialogTitle>\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            {relevantSales.length} sale{relevantSales.length !== 1 ? 's' : ''} found in the selected period\r\n          </p>\r\n        </DialogHeader>\r\n\r\n        {relevantSales.length === 0 ? (\r\n          <div className=\"text-center py-8 text-muted-foreground\">\r\n            No sales found for this item in the selected period.\r\n          </div>\r\n        ) : (\r\n          <div className=\"overflow-x-auto\">\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Date</TableHead>\r\n                  <TableHead>Receipt #</TableHead>\r\n                  <TableHead>Customer</TableHead>\r\n                  <TableHead className=\"text-right\">Quantity</TableHead>\r\n                  <TableHead className=\"text-right\">Unit Price</TableHead>\r\n                  <TableHead className=\"text-right\">Total</TableHead>\r\n                  <TableHead>Status</TableHead>\r\n                  <TableHead className=\"text-center\">Actions</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {relevantSales.map((sale) => {\r\n                  const item = sale.items.find(item => item.description === itemDescription);\r\n                  if (!item) return null;\r\n\r\n                  return (\r\n                    <TableRow key={sale.id}>\r\n                      <TableCell>{format(sale.date, 'MMM d, yyyy')}</TableCell>\r\n                      <TableCell className=\"font-medium\">#{sale.receiptNumber}</TableCell>\r\n                      <TableCell>{sale.customerName}</TableCell>\r\n                      <TableCell className=\"text-right\">{item.quantity}</TableCell>\r\n                      <TableCell className=\"text-right\">\r\n                        {canViewSellingPrice ? formatCashCurrency(item.price, currency) : '•••'}\r\n                      </TableCell>\r\n                      <TableCell className=\"text-right\">\r\n                        {canViewSellingPrice ? formatCashCurrency(item.price * item.quantity, currency) : '•••'}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge\r\n                          variant={\r\n                            sale.paymentStatus === 'Paid' ? 'default' :\r\n                              sale.paymentStatus === 'NOT PAID' ? 'destructive' :\r\n                                'secondary'\r\n                          }\r\n                        >\r\n                          {sale.paymentStatus}\r\n                        </Badge>\r\n                      </TableCell>\r\n                      <TableCell className=\"text-center\">\r\n                        <div className=\"flex justify-center gap-1\">\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleViewReceipt(sale)}\r\n                            className=\"h-8 w-8 p-0\"\r\n                            title=\"View Receipt\"\r\n                          >\r\n                            <Printer className=\"h-4 w-4\" />\r\n                            <span className=\"sr-only\">View Receipt</span>\r\n                          </Button>\r\n                          {hasPermission('sales', 'edit') && (\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleEditSale(sale)}\r\n                              className=\"h-8 w-8 p-0\"\r\n                              title=\"Edit Sale\"\r\n                            >\r\n                              <Edit className=\"h-4 w-4\" />\r\n                              <span className=\"sr-only\">Edit Sale</span>\r\n                            </Button>\r\n                          )}\r\n                        </div>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  );\r\n                })}\r\n              </TableBody>\r\n            </Table>\r\n          </div>\r\n        )}\r\n      </DialogContent>\r\n\r\n      {/* Receipt Dialog */}\r\n      <ReceiptDialog\r\n        isOpen={isReceiptOpen}\r\n        sale={selectedSale}\r\n        currency={currency}\r\n        onOpenChange={handleCloseReceipt}\r\n      />\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ItemSalesDialog;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1527, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/StockSummaryFilters.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Download, FileText, CalendarIcon } from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport DateRangeFilter from '@/components/sales/DateRangeFilter';\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\r\nimport { Calendar } from '@/components/ui/calendar';\r\nimport { cn } from '@/lib/utils';\r\n\r\ninterface StockSummaryFiltersProps {\r\n  period: 'today' | 'yesterday' | 'this-week' | 'last-week' | 'this-month' | 'last-month' | 'this-year' | 'all-time' | 'specific-day' | 'custom';\r\n  setPeriod: (period: any) => void;\r\n  dateRange: { from: Date | undefined; to: Date | undefined };\r\n  setDateRange: (range: { from: Date | undefined; to: Date | undefined }) => void;\r\n  specificDay: Date | undefined;\r\n  setSpecificDay: (date: Date | undefined) => void;\r\n  onExportCSV: () => void;\r\n  onExportPDF: () => void;\r\n}\r\n\r\nconst StockSummaryFilters: React.FC<StockSummaryFiltersProps> = ({\r\n  period,\r\n  setPeriod,\r\n  dateRange,\r\n  setDateRange,\r\n  specificDay,\r\n  setSpecificDay,\r\n  onExportCSV,\r\n  onExportPDF\r\n}) => {\r\n  const getPeriodLabel = () => {\r\n    switch (period) {\r\n      case 'today': return 'Today';\r\n      case 'yesterday': return 'Yesterday';\r\n      case 'this-week': return 'This Week';\r\n      case 'last-week': return 'Last Week';\r\n      case 'this-month': return 'This Month';\r\n      case 'last-month': return 'Last Month';\r\n      case 'this-year': return 'This Year';\r\n      case 'all-time': return 'All Time';\r\n      case 'specific-day': return 'Specific Day';\r\n      case 'custom': return 'Custom Range';\r\n      default: return 'This Month';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Header with Export Buttons */}\r\n      <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n        <h3 className=\"text-lg font-semibold\">Stock Summary</h3>\r\n        <div className=\"flex flex-col md:flex-row gap-2\">\r\n          <Button onClick={onExportCSV} variant=\"outline\" size=\"sm\">\r\n            <Download className=\"h-4 w-4 mr-2\" />\r\n            CSV\r\n          </Button>\r\n          <Button onClick={onExportPDF} variant=\"outline\" size=\"sm\">\r\n            <FileText className=\"h-4 w-4 mr-2\" />\r\n            PDF\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filter Controls */}\r\n      <div className=\"flex flex-col md:flex-row gap-4\">\r\n        {/* Period Selector */}\r\n        <div className=\"w-full md:w-[200px]\">\r\n          <Select value={period} onValueChange={(value: any) => setPeriod(value)}>\r\n            <SelectTrigger className=\"bg-white\">\r\n              <SelectValue placeholder=\"Select period\" />\r\n            </SelectTrigger>\r\n            <SelectContent className=\"bg-white\">\r\n              <SelectItem value=\"today\">Today</SelectItem>\r\n              <SelectItem value=\"yesterday\">Yesterday</SelectItem>\r\n              <SelectItem value=\"this-week\">This Week</SelectItem>\r\n              <SelectItem value=\"last-week\">Last Week</SelectItem>\r\n              <SelectItem value=\"this-month\">This Month</SelectItem>\r\n              <SelectItem value=\"last-month\">Last Month</SelectItem>\r\n              <SelectItem value=\"this-year\">This Year</SelectItem>\r\n              <SelectItem value=\"all-time\">All Time</SelectItem>\r\n              <SelectItem value=\"specific-day\">Specific Day</SelectItem>\r\n              <SelectItem value=\"custom\">Custom Range</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n\r\n        {/* Specific Day Picker */}\r\n        {period === 'specific-day' && (\r\n          <div className=\"w-full md:w-auto\">\r\n            <Popover>\r\n              <PopoverTrigger asChild>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className={cn(\r\n                    \"w-full md:w-[240px] justify-start text-left font-normal bg-white\",\r\n                    !specificDay && \"text-muted-foreground\"\r\n                  )}\r\n                >\r\n                  <CalendarIcon className=\"mr-2 h-4 w-4\" />\r\n                  {specificDay ? format(specificDay, \"PPP\") : <span>Pick a specific day</span>}\r\n                </Button>\r\n              </PopoverTrigger>\r\n              <PopoverContent className=\"w-auto p-0 z-[100] bg-white shadow-lg\" align=\"start\">\r\n                <Calendar\r\n                  mode=\"single\"\r\n                  selected={specificDay}\r\n                  onSelect={setSpecificDay}\r\n                  initialFocus\r\n                  className=\"p-3 pointer-events-auto\"\r\n                />\r\n              </PopoverContent>\r\n            </Popover>\r\n          </div>\r\n        )}\r\n\r\n        {/* Custom Date Range */}\r\n        {period === 'custom' && (\r\n          <DateRangeFilter\r\n            dateRange={dateRange}\r\n            onDateRangeChange={setDateRange}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {/* Current Period Display */}\r\n      <div className=\"text-sm text-muted-foreground\">\r\n        Showing data for: <span className=\"font-medium\">{getPeriodLabel()}</span>\r\n        {period === 'specific-day' && specificDay && (\r\n          <span className=\"ml-2\">\r\n            ({format(specificDay, \"MMM d, yyyy\")})\r\n          </span>\r\n        )}\r\n        {period === 'custom' && dateRange?.from && dateRange?.to && (\r\n          <span className=\"ml-2\">\r\n            ({format(dateRange.from, \"MMM d, yyyy\")} - {format(dateRange.to, \"MMM d, yyyy\")})\r\n          </span>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StockSummaryFilters;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAaA,MAAM,sBAA0D,CAAC,EAC/D,MAAM,EACN,SAAS,EACT,SAAS,EACT,YAAY,EACZ,WAAW,EACX,cAAc,EACd,WAAW,EACX,WAAW,EACZ;IACC,MAAM,iBAAiB;QACrB,OAAQ;YACN,KAAK;gBAAS,OAAO;YACrB,KAAK;gBAAa,OAAO;YACzB,KAAK;gBAAa,OAAO;YACzB,KAAK;gBAAa,OAAO;YACzB,KAAK;gBAAc,OAAO;YAC1B,KAAK;gBAAc,OAAO;YAC1B,KAAK;gBAAa,OAAO;YACzB,KAAK;gBAAY,OAAO;YACxB,KAAK;gBAAgB,OAAO;YAC5B,KAAK;gBAAU,OAAO;YACtB;gBAAS,OAAO;QAClB;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;kCAAwB;;;;;;kCACtC,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,+IAAM;gCAAC,SAAS;gCAAa,SAAQ;gCAAU,MAAK;;kDACnD,6LAAC,yNAAQ;wCAAC,WAAU;;;;;;oCAAiB;;;;;;;0CAGvC,6LAAC,+IAAM;gCAAC,SAAS;gCAAa,SAAQ;gCAAU,MAAK;;kDACnD,6LAAC,6NAAQ;wCAAC,WAAU;;;;;;oCAAiB;;;;;;;;;;;;;;;;;;;0BAO3C,6LAAC;gBAAI,WAAU;;kCAEb,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,+IAAM;4BAAC,OAAO;4BAAQ,eAAe,CAAC,QAAe,UAAU;;8CAC9D,6LAAC,sJAAa;oCAAC,WAAU;8CACvB,cAAA,6LAAC,oJAAW;wCAAC,aAAY;;;;;;;;;;;8CAE3B,6LAAC,sJAAa;oCAAC,WAAU;;sDACvB,6LAAC,mJAAU;4CAAC,OAAM;sDAAQ;;;;;;sDAC1B,6LAAC,mJAAU;4CAAC,OAAM;sDAAY;;;;;;sDAC9B,6LAAC,mJAAU;4CAAC,OAAM;sDAAY;;;;;;sDAC9B,6LAAC,mJAAU;4CAAC,OAAM;sDAAY;;;;;;sDAC9B,6LAAC,mJAAU;4CAAC,OAAM;sDAAa;;;;;;sDAC/B,6LAAC,mJAAU;4CAAC,OAAM;sDAAa;;;;;;sDAC/B,6LAAC,mJAAU;4CAAC,OAAM;sDAAY;;;;;;sDAC9B,6LAAC,mJAAU;4CAAC,OAAM;sDAAW;;;;;;sDAC7B,6LAAC,mJAAU;4CAAC,OAAM;sDAAe;;;;;;sDACjC,6LAAC,mJAAU;4CAAC,OAAM;sDAAS;;;;;;;;;;;;;;;;;;;;;;;oBAMhC,WAAW,gCACV,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,iJAAO;;8CACN,6LAAC,wJAAc;oCAAC,OAAO;8CACrB,cAAA,6LAAC,+IAAM;wCACL,SAAQ;wCACR,WAAW,IAAA,4HAAE,EACX,oEACA,CAAC,eAAe;;0DAGlB,6LAAC,iOAAY;gDAAC,WAAU;;;;;;4CACvB,cAAc,IAAA,kKAAM,EAAC,aAAa,uBAAS,6LAAC;0DAAK;;;;;;;;;;;;;;;;;8CAGtD,6LAAC,wJAAc;oCAAC,WAAU;oCAAwC,OAAM;8CACtE,cAAA,6LAAC,mJAAQ;wCACP,MAAK;wCACL,UAAU;wCACV,UAAU;wCACV,YAAY;wCACZ,WAAU;;;;;;;;;;;;;;;;;;;;;;oBAQnB,WAAW,0BACV,6LAAC,4JAAe;wBACd,WAAW;wBACX,mBAAmB;;;;;;;;;;;;0BAMzB,6LAAC;gBAAI,WAAU;;oBAAgC;kCAC3B,6LAAC;wBAAK,WAAU;kCAAe;;;;;;oBAChD,WAAW,kBAAkB,6BAC5B,6LAAC;wBAAK,WAAU;;4BAAO;4BACnB,IAAA,kKAAM,EAAC,aAAa;4BAAe;;;;;;;oBAGxC,WAAW,YAAY,WAAW,QAAQ,WAAW,oBACpD,6LAAC;wBAAK,WAAU;;4BAAO;4BACnB,IAAA,kKAAM,EAAC,UAAU,IAAI,EAAE;4BAAe;4BAAI,IAAA,kKAAM,EAAC,UAAU,EAAE,EAAE;4BAAe;;;;;;;;;;;;;;;;;;;AAM5F;KAxHM;uCA0HS"}},
    {"offset": {"line": 1909, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/StockSummaryTable.tsx"],"sourcesContent":["\r\nimport React, { useState, useMemo, useEffect } from 'react';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Search, ArrowUpDown, ArrowUp, ArrowDown, ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport ProductImage from '@/components/inventory/ProductImage';\r\nimport LoadingSpinner from '@/components/LoadingSpinner';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useBusiness } from '@/contexts/BusinessContext';\r\nimport { Product } from '@/types';\r\nimport { Pagination, PaginationContent, PaginationItem, PaginationLink, PaginationNext, PaginationPrevious } from '@/components/ui/pagination';\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\n\r\ninterface StockSummaryData {\r\n  productId: string;\r\n  productName: string;\r\n  itemNumber: string;\r\n  imageUrl?: string | null;\r\n  costPrice: number;\r\n  sellingPrice: number;\r\n  openingStock: number;\r\n  itemsSold: number;\r\n  stockIn: number;\r\n  transferOut: number;\r\n  returnIn: number;\r\n  returnOut: number;\r\n  returnOut: number;\r\n  adjustmentsIn: number;\r\n  adjustmentsOut: number;\r\n  closingStock: number;\r\n  category?: string;\r\n  revaluation: number;\r\n}\r\n\r\ninterface StockSummaryTableProps {\r\n  data: StockSummaryData[];\r\n  isLoading: boolean;\r\n  onProductClick: (productId: string) => void;\r\n  onFilteredDataChange?: (filteredData: StockSummaryData[]) => void;\r\n  currentProducts?: Product[];\r\n}\r\n\r\ntype SortField = 'productName' | 'category' | 'openingStock' | 'itemsSold' | 'stockIn' | 'transferOut' | 'returnIn' | 'returnOut' | 'closingStock';\r\ntype SortOrder = 'asc' | 'desc';\r\n\r\ninterface TableFilters {\r\n  searchTerm: string;\r\n  categoryFilter: string;\r\n  stockStatusFilter: string;\r\n  sortField: SortField;\r\n  sortOrder: SortOrder;\r\n}\r\n\r\nconst StockSummaryTable: React.FC<StockSummaryTableProps> = ({\r\n  data,\r\n  isLoading,\r\n  onProductClick,\r\n  onFilteredDataChange,\r\n  currentProducts = []\r\n}) => {\r\n  const { currentBusiness } = useBusiness();\r\n  const { canViewCostPrice } = useFinancialVisibility();\r\n\r\n  // Generate cache key for table filters\r\n  const getTableFiltersCacheKey = () => {\r\n    return `stockSummaryTableFilters_${currentBusiness?.id || 'default'}`;\r\n  };\r\n\r\n  // Load persisted table filters\r\n  const getPersistedTableFilters = (): TableFilters => {\r\n    try {\r\n      const saved = localStorage.getItem(getTableFiltersCacheKey());\r\n      if (saved) {\r\n        return JSON.parse(saved);\r\n      }\r\n    } catch (error) {\r\n      console.warn('Error loading persisted table filters:', error);\r\n    }\r\n    return {\r\n      searchTerm: '',\r\n      categoryFilter: 'all',\r\n      stockStatusFilter: 'all',\r\n      sortField: 'productName',\r\n      sortOrder: 'asc'\r\n    };\r\n  };\r\n\r\n  const persistedFilters = getPersistedTableFilters();\r\n  const [searchTerm, setSearchTerm] = useState(persistedFilters.searchTerm);\r\n  const [categoryFilter, setCategoryFilter] = useState(persistedFilters.categoryFilter);\r\n  const [stockStatusFilter, setStockStatusFilter] = useState(persistedFilters.stockStatusFilter);\r\n  const [sortField, setSortField] = useState<SortField>(persistedFilters.sortField);\r\n  const [sortOrder, setSortOrder] = useState<SortOrder>(persistedFilters.sortOrder);\r\n\r\n  // Pagination state\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const itemsPerPage = 15;\r\n\r\n  // Persist table filters whenever they change\r\n  useEffect(() => {\r\n    const filtersToSave: TableFilters = {\r\n      searchTerm,\r\n      categoryFilter,\r\n      stockStatusFilter,\r\n      sortField,\r\n      sortOrder\r\n    };\r\n    localStorage.setItem(getTableFiltersCacheKey(), JSON.stringify(filtersToSave));\r\n  }, [searchTerm, categoryFilter, stockStatusFilter, sortField, sortOrder, currentBusiness?.id]);\r\n\r\n  // Check if closing stock matches current quantity\r\n  const isStockMismatch = (item: StockSummaryData): boolean => {\r\n    const currentProduct = currentProducts.find(p => p.id === item.productId);\r\n    return currentProduct ? currentProduct.quantity !== item.closingStock : false;\r\n  };\r\n\r\n  // Get unique categories from data\r\n  const categories = useMemo(() => {\r\n    const uniqueCategories = Array.from(new Set(data.map(item => item.category).filter(Boolean)));\r\n    return uniqueCategories.sort();\r\n  }, [data]);\r\n\r\n  // Filter and sort data\r\n  const filteredAndSortedData = useMemo(() => {\r\n    let filtered = data.filter(item => {\r\n      // Search filter\r\n      if (searchTerm) {\r\n        const searchLower = searchTerm.toLowerCase();\r\n        const matchesSearch =\r\n          item.productName.toLowerCase().includes(searchLower) ||\r\n          item.itemNumber.toLowerCase().includes(searchLower) ||\r\n          (item.category && item.category.toLowerCase().includes(searchLower));\r\n        if (!matchesSearch) return false;\r\n      }\r\n\r\n      // Category filter\r\n      if (categoryFilter !== 'all' && item.category !== categoryFilter) {\r\n        return false;\r\n      }\r\n\r\n      // Stock status filter\r\n      if (stockStatusFilter !== 'all') {\r\n        if (stockStatusFilter === 'in-stock' && item.closingStock <= 0) return false;\r\n        if (stockStatusFilter === 'out-of-stock' && item.closingStock > 0) return false;\r\n        if (stockStatusFilter === 'low-stock' && (item.closingStock > 10 || item.closingStock <= 0)) return false;\r\n      }\r\n\r\n      return true;\r\n    });\r\n\r\n    // Sort data\r\n    filtered.sort((a, b) => {\r\n      let comparison = 0;\r\n\r\n      switch (sortField) {\r\n        case 'productName':\r\n          comparison = a.productName.localeCompare(b.productName);\r\n          break;\r\n        case 'category':\r\n          comparison = (a.category || '').localeCompare(b.category || '');\r\n          break;\r\n        case 'openingStock':\r\n          comparison = a.openingStock - b.openingStock;\r\n          break;\r\n        case 'itemsSold':\r\n          comparison = a.itemsSold - b.itemsSold;\r\n          break;\r\n        case 'stockIn':\r\n          comparison = a.stockIn - b.stockIn;\r\n          break;\r\n        case 'transferOut':\r\n          comparison = a.transferOut - b.transferOut;\r\n          break;\r\n        case 'returnIn':\r\n          comparison = a.returnIn - b.returnIn;\r\n          break;\r\n        case 'returnOut':\r\n          comparison = a.returnOut - b.returnOut;\r\n          break;\r\n        case 'closingStock':\r\n          comparison = a.closingStock - b.closingStock;\r\n          break;\r\n      }\r\n\r\n      return sortOrder === 'asc' ? comparison : -comparison;\r\n    });\r\n\r\n    return filtered;\r\n  }, [data, searchTerm, categoryFilter, stockStatusFilter, sortField, sortOrder]);\r\n\r\n  // Pagination calculations\r\n  const totalPages = Math.ceil(filteredAndSortedData.length / itemsPerPage);\r\n  const startIndex = (currentPage - 1) * itemsPerPage;\r\n  const endIndex = startIndex + itemsPerPage;\r\n  const paginatedData = filteredAndSortedData.slice(startIndex, endIndex);\r\n\r\n  // Reset page when filters change\r\n  useEffect(() => {\r\n    setCurrentPage(1);\r\n  }, [searchTerm, categoryFilter, stockStatusFilter]);\r\n\r\n  // Notify parent component when filtered data changes\r\n  useEffect(() => {\r\n    if (onFilteredDataChange) {\r\n      onFilteredDataChange(filteredAndSortedData);\r\n    }\r\n  }, [filteredAndSortedData, onFilteredDataChange]);\r\n\r\n  const handleSort = (field: SortField) => {\r\n    if (sortField === field) {\r\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\r\n    } else {\r\n      setSortField(field);\r\n      setSortOrder('asc');\r\n    }\r\n  };\r\n\r\n  const getSortIcon = (field: SortField) => {\r\n    if (sortField !== field) {\r\n      return <ArrowUpDown className=\"h-4 w-4\" />;\r\n    }\r\n    return sortOrder === 'asc' ? <ArrowUp className=\"h-4 w-4\" /> : <ArrowDown className=\"h-4 w-4\" />;\r\n  };\r\n\r\n  const totals = React.useMemo(() => {\r\n    return filteredAndSortedData.reduce((acc, item) => ({\r\n      openingStock: acc.openingStock + item.openingStock,\r\n      itemsSold: acc.itemsSold + item.itemsSold,\r\n      stockIn: acc.stockIn + item.stockIn,\r\n      transferOut: acc.transferOut + item.transferOut,\r\n      returnIn: acc.returnIn + item.returnIn,\r\n      returnOut: acc.returnOut + item.returnOut,\r\n      returnOut: acc.returnOut + item.returnOut,\r\n      adjustmentsIn: acc.adjustmentsIn + (item.adjustmentsIn || 0),\r\n      adjustmentsOut: acc.adjustmentsOut + (item.adjustmentsOut || 0),\r\n      closingStock: acc.closingStock + item.closingStock\r\n    }), {\r\n      openingStock: 0,\r\n      itemsSold: 0,\r\n      stockIn: 0,\r\n      transferOut: 0,\r\n      returnIn: 0,\r\n      returnOut: 0,\r\n      adjustmentsIn: 0,\r\n      adjustmentsOut: 0,\r\n      closingStock: 0\r\n    });\r\n  }, [filteredAndSortedData]);\r\n\r\n  const handlePageChange = (page: number) => {\r\n    setCurrentPage(page);\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex justify-center py-8\">\r\n        <LoadingSpinner />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Filters */}\r\n      <div className=\"flex flex-col md:flex-row gap-4\">\r\n        {/* Search */}\r\n        <div className=\"flex items-center relative flex-grow\">\r\n          <Search className=\"h-4 w-4 absolute left-3 text-gray-400\" />\r\n          <Input\r\n            placeholder=\"Search products...\"\r\n            className=\"pl-9\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n          />\r\n        </div>\r\n\r\n        {/* Category Filter */}\r\n        <div className=\"min-w-[180px]\">\r\n          <Select value={categoryFilter} onValueChange={setCategoryFilter}>\r\n            <SelectTrigger>\r\n              <SelectValue placeholder=\"All Categories\" />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"all\">All Categories</SelectItem>\r\n              {categories.map((category) => (\r\n                <SelectItem key={category} value={category}>\r\n                  {category}\r\n                </SelectItem>\r\n              ))}\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n\r\n        {/* Stock Status Filter */}\r\n        <div className=\"min-w-[150px]\">\r\n          <Select value={stockStatusFilter} onValueChange={setStockStatusFilter}>\r\n            <SelectTrigger>\r\n              <SelectValue placeholder=\"Stock Status\" />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"all\">All Stock</SelectItem>\r\n              <SelectItem value=\"in-stock\">In Stock</SelectItem>\r\n              <SelectItem value=\"low-stock\">Low Stock (≤10)</SelectItem>\r\n              <SelectItem value=\"out-of-stock\">Out of Stock</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n\r\n        {/* Results count */}\r\n        <div className=\"flex items-center gap-4\">\r\n          <Badge variant=\"secondary\" className=\"text-xs\">\r\n            {filteredAndSortedData.length} {filteredAndSortedData.length === 1 ? 'product' : 'products'} found\r\n          </Badge>\r\n          {totalPages > 1 && (\r\n            <div className=\"text-xs text-muted-foreground\">\r\n              Page {currentPage} of {totalPages}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <TooltipProvider>\r\n        <div className=\"overflow-x-auto\">\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow>\r\n                <TableHead className=\"w-[80px]\">Image</TableHead>\r\n                <TableHead>Item #</TableHead>\r\n                <TableHead>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => handleSort('productName')}\r\n                    className=\"h-auto p-0 font-medium text-left justify-start hover:bg-transparent\"\r\n                  >\r\n                    Product Name {getSortIcon('productName')}\r\n                  </Button>\r\n                </TableHead>\r\n                <TableHead>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => handleSort('category')}\r\n                    className=\"h-auto p-0 font-medium text-left justify-start hover:bg-transparent\"\r\n                  >\r\n                    Category {getSortIcon('category')}\r\n                  </Button>\r\n                </TableHead>\r\n                <TableHead className=\"text-right\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => handleSort('openingStock')}\r\n                    className=\"h-auto p-0 font-medium text-right justify-end hover:bg-transparent\"\r\n                  >\r\n                    Opening Stock {getSortIcon('openingStock')}\r\n                  </Button>\r\n                </TableHead>\r\n                <TableHead className=\"text-right\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => handleSort('stockIn')}\r\n                    className=\"h-auto p-0 font-medium text-right justify-end hover:bg-transparent\"\r\n                  >\r\n                    Stock In {getSortIcon('stockIn')}\r\n                  </Button>\r\n                </TableHead>\r\n                <TableHead className=\"text-right\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => handleSort('transferOut')}\r\n                    /* Using transferOut sort key for Stock Out generally, though it's a mix */\r\n                    className=\"h-auto p-0 font-medium text-right justify-end hover:bg-transparent\"\r\n                  >\r\n                    Stock Out\r\n                  </Button>\r\n                </TableHead>\r\n                <TableHead className=\"text-right\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => handleSort('closingStock')}\r\n                    className=\"h-auto p-0 font-medium text-right justify-end hover:bg-transparent\"\r\n                  >\r\n                    Closing Stock {getSortIcon('closingStock')}\r\n                  </Button>\r\n                </TableHead>\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {paginatedData.map((item) => (\r\n                <TableRow\r\n                  key={item.productId}\r\n                  className={`cursor-pointer hover:bg-muted/50 transition-colors ${isStockMismatch(item) ? 'bg-red-50 hover:bg-red-100 border-l-4 border-l-red-500' : ''\r\n                    }`}\r\n                  onClick={() => onProductClick(item.productId)}\r\n                >\r\n                  <TableCell>\r\n                    <ProductImage imageUrl={item.imageUrl} alt={item.productName} size=\"sm\" />\r\n                  </TableCell>\r\n                  <TableCell className=\"font-medium truncate max-w-[120px]\">#{item.itemNumber}</TableCell>\r\n                  <TableCell className=\"truncate max-w-[200px]\">\r\n                    <Tooltip>\r\n                      <TooltipTrigger asChild>\r\n                        <span className=\"cursor-help\">{item.productName}</span>\r\n                      </TooltipTrigger>\r\n                      <TooltipContent side=\"top\" className=\"max-w-xs\">\r\n                        <div className=\"space-y-1\">\r\n                          <p className=\"font-bold break-words whitespace-normal\">{item.productName}</p>\r\n                          {item.category && (\r\n                            <p className=\"text-xs text-muted-foreground\">Category: {item.category}</p>\r\n                          )}\r\n                        </div>\r\n                      </TooltipContent>\r\n                    </Tooltip>\r\n                  </TableCell>\r\n                  <TableCell>{item.category || '-'}</TableCell>\r\n                  <TableCell className=\"text-right\">{item.openingStock}</TableCell>\r\n                  {/* Stock In = Stock In + Return In + Positive Adjustments */}\r\n                  <TableCell className=\"text-right text-green-600 font-medium\">\r\n                    {item.stockIn + item.returnIn + (item.adjustmentsIn || 0)}\r\n                  </TableCell>\r\n                  {/* Stock Out = Sold + Transfer Out + Return Out + Negative Adjustments (abs) */}\r\n                  <TableCell className=\"text-right text-red-600 font-medium\">\r\n                    {item.itemsSold + item.transferOut + item.returnOut + (item.adjustmentsOut || 0)}\r\n                  </TableCell>\r\n                  <TableCell className=\"text-right font-bold\">{item.closingStock}</TableCell>\r\n                </TableRow>\r\n              ))}\r\n              {filteredAndSortedData.length > 0 && (\r\n                <TableRow className=\"font-semibold bg-muted/50 border-t-2\">\r\n                  <TableCell colSpan={4}>Total</TableCell>\r\n                  <TableCell className=\"text-right\">{totals.openingStock}</TableCell>\r\n                  <TableCell className=\"text-right text-green-700\">\r\n                    {totals.stockIn + totals.returnIn + totals.adjustmentsIn}\r\n                  </TableCell>\r\n                  <TableCell className=\"text-right text-red-700\">\r\n                    {totals.itemsSold + totals.transferOut + totals.returnOut + totals.adjustmentsOut}\r\n                  </TableCell>\r\n                  <TableCell className=\"text-right\">{totals.closingStock}</TableCell>\r\n                </TableRow>\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n\r\n          {filteredAndSortedData.length === 0 && !isLoading && (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              No products found matching your filters.\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Pagination */}\r\n        {totalPages > 1 && (\r\n          <div className=\"flex justify-center mt-6\">\r\n            <Pagination>\r\n              <PaginationContent>\r\n                <PaginationItem>\r\n                  <PaginationPrevious\r\n                    onClick={() => handlePageChange(Math.max(1, currentPage - 1))}\r\n                    className={currentPage === 1 ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                  />\r\n                </PaginationItem>\r\n\r\n                {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\r\n                  let pageNumber;\r\n                  if (totalPages <= 5) {\r\n                    pageNumber = i + 1;\r\n                  } else if (currentPage <= 3) {\r\n                    pageNumber = i + 1;\r\n                  } else if (currentPage >= totalPages - 2) {\r\n                    pageNumber = totalPages - 4 + i;\r\n                  } else {\r\n                    pageNumber = currentPage - 2 + i;\r\n                  }\r\n\r\n                  return (\r\n                    <PaginationItem key={pageNumber}>\r\n                      <PaginationLink\r\n                        onClick={() => handlePageChange(pageNumber)}\r\n                        isActive={currentPage === pageNumber}\r\n                        className=\"cursor-pointer\"\r\n                      >\r\n                        {pageNumber}\r\n                      </PaginationLink>\r\n                    </PaginationItem>\r\n                  );\r\n                })}\r\n\r\n                <PaginationItem>\r\n                  <PaginationNext\r\n                    onClick={() => handlePageChange(Math.min(totalPages, currentPage + 1))}\r\n                    className={currentPage === totalPages ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                  />\r\n                </PaginationItem>\r\n              </PaginationContent>\r\n            </Pagination>\r\n          </div>\r\n        )}\r\n      </TooltipProvider>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StockSummaryTable;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2867, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/StockSummaryOverview.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { formatNumber } from '@/lib/utils';\r\n\r\ninterface StockSummaryData {\r\n  productId: string;\r\n  productName: string;\r\n  itemNumber: string;\r\n  imageUrl?: string | null;\r\n  costPrice: number;\r\n  sellingPrice: number;\r\n  openingStock: number;\r\n  itemsSold: number;\r\n  stockIn: number;\r\n  transferOut: number;\r\n  returnIn: number;\r\n  returnOut: number;\r\n  adjustmentsIn: number;\r\n  adjustmentsOut: number;\r\n  closingStock: number;\r\n  revaluation: number;\r\n}\r\n\r\ninterface StockSummaryOverviewProps {\r\n  data: StockSummaryData[];\r\n}\r\n\r\nconst StockSummaryOverview: React.FC<StockSummaryOverviewProps> = ({ data }) => {\r\n  const { canViewCostPrice } = useFinancialVisibility();\r\n  const { settings } = useBusinessSettings();\r\n  const currency = settings?.currency || 'UGX';\r\n\r\n  const formatCurrencyValue = (amount: number) => {\r\n    return `${currency} ${formatNumber(amount)}`;\r\n  };\r\n\r\n  const financialTotals = React.useMemo(() => {\r\n    const totals = data.reduce((acc, item) => ({\r\n      openingStock: acc.openingStock + (item.openingStock * item.costPrice),\r\n      // Aggregate Stock In (Stock In + Return In + Adjustments In)\r\n      stockIn: acc.stockIn + ((item.stockIn + item.returnIn + (item.adjustmentsIn || 0)) * item.costPrice),\r\n      // Aggregate Stock Out (Items Sold + Transfer Out + Return Out + Adjustments Out)\r\n      stockOut: acc.stockOut + ((item.itemsSold + item.transferOut + item.returnOut + (item.adjustmentsOut || 0)) * item.costPrice)\r\n    }), {\r\n      openingStock: 0,\r\n      stockIn: 0,\r\n      stockOut: 0\r\n    });\r\n\r\n    // Calculate closing stock value derived from the aggregated totals\r\n    // Closing = Opening + StockIn - StockOut\r\n    const closingStock = totals.openingStock + totals.stockIn - totals.stockOut;\r\n\r\n    return { ...totals, closingStock };\r\n  }, [data]);\r\n\r\n  if (data.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <CardTitle>Stock Summary Overview</CardTitle>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-6\">\r\n          <div className=\"space-y-2\">\r\n            <p className=\"text-sm text-muted-foreground font-medium uppercase\">Opening Stock Value</p>\r\n            <p className=\"text-xl font-bold text-blue-600\">\r\n              {canViewCostPrice ? formatCurrencyValue(financialTotals.openingStock) : '•••'}\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <p className=\"text-sm text-muted-foreground font-medium uppercase\">Total Stock In Value</p>\r\n            <p className=\"text-xl font-bold text-green-600\">\r\n              {canViewCostPrice ? formatCurrencyValue(financialTotals.stockIn) : '•••'}\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <p className=\"text-sm text-muted-foreground font-medium uppercase\">Total Stock Out Value</p>\r\n            <p className=\"text-xl font-bold text-red-600\">\r\n              {canViewCostPrice ? formatCurrencyValue(financialTotals.stockOut) : '•••'}\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <p className=\"text-sm text-muted-foreground font-medium uppercase\">Closing Stock Value</p>\r\n            <p className=\"text-xl font-bold text-purple-600\">\r\n              {canViewCostPrice ? formatCurrencyValue(financialTotals.closingStock) : '•••'}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default StockSummaryOverview;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAyBA,MAAM,uBAA4D,CAAC,EAAE,IAAI,EAAE;;IACzE,MAAM,EAAE,gBAAgB,EAAE,GAAG,IAAA,mKAAsB;IACnD,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,6JAAmB;IACxC,MAAM,WAAW,UAAU,YAAY;IAEvC,MAAM,sBAAsB,CAAC;QAC3B,OAAO,GAAG,SAAS,CAAC,EAAE,IAAA,sIAAY,EAAC,SAAS;IAC9C;IAEA,MAAM,kBAAkB,wKAAK,CAAC,OAAO;yDAAC;YACpC,MAAM,SAAS,KAAK,MAAM;wEAAC,CAAC,KAAK,OAAS,CAAC;wBACzC,cAAc,IAAI,YAAY,GAAI,KAAK,YAAY,GAAG,KAAK,SAAS;wBACpE,6DAA6D;wBAC7D,SAAS,IAAI,OAAO,GAAI,CAAC,KAAK,OAAO,GAAG,KAAK,QAAQ,GAAG,CAAC,KAAK,aAAa,IAAI,CAAC,CAAC,IAAI,KAAK,SAAS;wBACnG,iFAAiF;wBACjF,UAAU,IAAI,QAAQ,GAAI,CAAC,KAAK,SAAS,GAAG,KAAK,WAAW,GAAG,KAAK,SAAS,GAAG,CAAC,KAAK,cAAc,IAAI,CAAC,CAAC,IAAI,KAAK,SAAS;oBAC9H,CAAC;uEAAG;gBACF,cAAc;gBACd,SAAS;gBACT,UAAU;YACZ;YAEA,mEAAmE;YACnE,yCAAyC;YACzC,MAAM,eAAe,OAAO,YAAY,GAAG,OAAO,OAAO,GAAG,OAAO,QAAQ;YAE3E,OAAO;gBAAE,GAAG,MAAM;gBAAE;YAAa;QACnC;wDAAG;QAAC;KAAK;IAET,IAAI,KAAK,MAAM,KAAK,GAAG;QACrB,OAAO;IACT;IAEA,qBACE,6LAAC,2IAAI;;0BACH,6LAAC,iJAAU;0BACT,cAAA,6LAAC,gJAAS;8BAAC;;;;;;;;;;;0BAEb,6LAAC,kJAAW;0BACV,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAE,WAAU;8CAAsD;;;;;;8CACnE,6LAAC;oCAAE,WAAU;8CACV,mBAAmB,oBAAoB,gBAAgB,YAAY,IAAI;;;;;;;;;;;;sCAI5E,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAE,WAAU;8CAAsD;;;;;;8CACnE,6LAAC;oCAAE,WAAU;8CACV,mBAAmB,oBAAoB,gBAAgB,OAAO,IAAI;;;;;;;;;;;;sCAIvE,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAE,WAAU;8CAAsD;;;;;;8CACnE,6LAAC;oCAAE,WAAU;8CACV,mBAAmB,oBAAoB,gBAAgB,QAAQ,IAAI;;;;;;;;;;;;sCAIxE,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAE,WAAU;8CAAsD;;;;;;8CACnE,6LAAC;oCAAE,WAAU;8CACV,mBAAmB,oBAAoB,gBAAgB,YAAY,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOtF;GAvEM;;QACyB,mKAAsB;QAC9B,6JAAmB;;;KAFpC;uCAyES"}},
    {"offset": {"line": 3075, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/StockSummaryTab.tsx"],"sourcesContent":["\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { RefreshCw } from 'lucide-react';\r\nimport { format, startOfDay, endOfDay, startOfWeek, endOfWeek, startOfMonth, endOfMonth } from 'date-fns';\r\nimport StockSummaryFilters from './StockSummaryFilters';\r\nimport StockSummaryTable from './StockSummaryTable';\r\nimport StockSummaryOverview from './StockSummaryOverview';\r\nimport { useStockSummaryData } from '@/hooks/useStockSummaryData';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\nimport { exportStockSummaryToPDF } from '@/utils/exportStockSummaryToPDF';\r\n\r\ninterface StockSummaryData {\r\n  productId: string;\r\n  productName: string;\r\n  itemNumber: string;\r\n  imageUrl?: string | null;\r\n  costPrice: number;\r\n  sellingPrice: number;\r\n  openingStock: number;\r\n  itemsSold: number;\r\n  stockIn: number;\r\n  transferOut: number;\r\n  returnIn: number;\r\n  returnOut: number;\r\n  returnOut: number;\r\n  adjustmentsIn: number;\r\n  adjustmentsOut: number;\r\n  closingStock: number;\r\n  category?: string;\r\n  revaluation: number;\r\n}\r\n\r\nconst StockSummaryTab = () => {\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const { products } = useProducts(user?.id, 10000); // Load all products for filtering\r\n\r\n  // Load persisted state from localStorage\r\n  const getPersistedState = () => {\r\n    try {\r\n      const saved = localStorage.getItem('stockSummaryFilters');\r\n      if (saved) {\r\n        const parsed = JSON.parse(saved);\r\n        return {\r\n          period: parsed.period || 'this-month',\r\n          dateRange: parsed.dateRange ? {\r\n            from: parsed.dateRange.from ? new Date(parsed.dateRange.from) : startOfMonth(new Date()),\r\n            to: parsed.dateRange.to ? new Date(parsed.dateRange.to) : endOfMonth(new Date())\r\n          } : {\r\n            from: startOfMonth(new Date()),\r\n            to: endOfMonth(new Date())\r\n          },\r\n          specificDay: parsed.specificDay ? new Date(parsed.specificDay) : undefined\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading persisted stock summary filters:', error);\r\n    }\r\n    return {\r\n      period: 'all-time' as const,\r\n      dateRange: {\r\n        from: new Date(2020, 0, 1),\r\n        to: endOfDay(new Date())\r\n      },\r\n      specificDay: undefined\r\n    };\r\n  };\r\n\r\n  const persistedState = getPersistedState();\r\n  const [period, setPeriod] = useState<'today' | 'yesterday' | 'this-week' | 'last-week' | 'this-month' | 'last-month' | 'this-year' | 'all-time' | 'specific-day' | 'custom'>('all-time');\r\n  const [dateRange, setDateRange] = useState<{ from: Date | undefined; to: Date | undefined }>(persistedState.dateRange);\r\n  const [specificDay, setSpecificDay] = useState<Date | undefined>(persistedState.specificDay);\r\n  const [filteredStockData, setFilteredStockData] = useState<StockSummaryData[]>([]);\r\n\r\n  const { stockSummaryData, isLoading, loadStockSummaryData, clearCache } = useStockSummaryData(dateRange);\r\n\r\n  // Handle manual refresh with cache clearing\r\n  const handleRefresh = async () => {\r\n    clearCache();\r\n    await loadStockSummaryData();\r\n  };\r\n\r\n  // Listen for stock updates from other components\r\n  useEffect(() => {\r\n    const handleStockUpdate = () => {\r\n      console.log('Stock updated, refreshing stock summary data');\r\n      clearCache();\r\n      loadStockSummaryData();\r\n    };\r\n\r\n    window.addEventListener('stock-updated', handleStockUpdate);\r\n\r\n    return () => {\r\n      window.removeEventListener('stock-updated', handleStockUpdate);\r\n    };\r\n  }, [clearCache, loadStockSummaryData]);\r\n\r\n  // Persist state to localStorage whenever filters change\r\n  useEffect(() => {\r\n    const stateToSave = {\r\n      period,\r\n      dateRange: {\r\n        from: dateRange.from?.toISOString(),\r\n        to: dateRange.to?.toISOString()\r\n      },\r\n      specificDay: specificDay?.toISOString()\r\n    };\r\n    localStorage.setItem('stockSummaryFilters', JSON.stringify(stateToSave));\r\n  }, [period, dateRange, specificDay]);\r\n\r\n  // Update date range when period changes\r\n  useEffect(() => {\r\n    const now = new Date();\r\n    let newRange: { from: Date; to: Date };\r\n\r\n    switch (period) {\r\n      case 'today':\r\n        newRange = {\r\n          from: startOfDay(now),\r\n          to: endOfDay(now)\r\n        };\r\n        break;\r\n      case 'yesterday':\r\n        const yesterday = new Date(now);\r\n        yesterday.setDate(yesterday.getDate() - 1);\r\n        newRange = {\r\n          from: startOfDay(yesterday),\r\n          to: endOfDay(yesterday)\r\n        };\r\n        break;\r\n      case 'this-week':\r\n        newRange = {\r\n          from: startOfWeek(now),\r\n          to: endOfWeek(now)\r\n        };\r\n        break;\r\n      case 'last-week':\r\n        const lastWeek = new Date(now);\r\n        lastWeek.setDate(lastWeek.getDate() - 7);\r\n        newRange = {\r\n          from: startOfWeek(lastWeek),\r\n          to: endOfWeek(lastWeek)\r\n        };\r\n        break;\r\n      case 'this-month':\r\n        newRange = {\r\n          from: startOfMonth(now),\r\n          to: endOfMonth(now)\r\n        };\r\n        break;\r\n      case 'last-month':\r\n        const lastMonth = new Date(now);\r\n        lastMonth.setMonth(lastMonth.getMonth() - 1);\r\n        newRange = {\r\n          from: startOfMonth(lastMonth),\r\n          to: endOfMonth(lastMonth)\r\n        };\r\n        break;\r\n      case 'this-year':\r\n        newRange = {\r\n          from: new Date(now.getFullYear(), 0, 1),\r\n          to: new Date(now.getFullYear(), 11, 31)\r\n        };\r\n        break;\r\n      case 'all-time':\r\n        newRange = {\r\n          from: new Date(2020, 0, 1), // Go back far enough to cover everything\r\n          to: endOfDay(now) // Ensure we cover up to the very end of today\r\n        };\r\n        break;\r\n      case 'specific-day':\r\n        if (specificDay) {\r\n          newRange = {\r\n            from: startOfDay(specificDay),\r\n            to: endOfDay(specificDay)\r\n          };\r\n        } else {\r\n          return; // Don't update if no specific day is selected\r\n        }\r\n        break;\r\n      default:\r\n        return; // Don't change for custom\r\n    }\r\n\r\n    setDateRange(newRange);\r\n  }, [period, specificDay]);\r\n\r\n  const exportToCSV = () => {\r\n    const headers = [\r\n      'Item Number',\r\n      'Product Name',\r\n      'Category',\r\n      'Opening Stock',\r\n      'Items Sold',\r\n      'Stock In',\r\n      'Transfer Out',\r\n      'Return In',\r\n      'Return Out',\r\n      'Closing Stock'\r\n    ];\r\n\r\n    const rows = filteredStockData.map(item => [\r\n      item.itemNumber,\r\n      item.productName,\r\n      item.category || '',\r\n      item.openingStock.toString(),\r\n      item.itemsSold.toString(),\r\n      item.stockIn.toString(),\r\n      item.transferOut.toString(),\r\n      item.returnIn.toString(),\r\n      item.returnOut.toString(),\r\n      item.closingStock.toString()\r\n    ]);\r\n\r\n    const csvContent = [\r\n      headers.join(','),\r\n      ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv' });\r\n    const url = window.URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = `stock-summary-filtered-${format(dateRange?.from || new Date(), 'yyyy-MM-dd')}.csv`;\r\n    link.click();\r\n    window.URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const exportToPDF = () => {\r\n    exportStockSummaryToPDF(filteredStockData, 'Current Period', dateRange);\r\n  };\r\n\r\n  const handleProductClick = (productId: string) => {\r\n    navigate(`/inventory/${productId}`);\r\n  };\r\n\r\n  const handleFilteredDataChange = (filteredData: StockSummaryData[]) => {\r\n    setFilteredStockData(filteredData);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header and Filters */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"flex items-center justify-end mb-4\">\r\n            <Button\r\n              onClick={handleRefresh}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              disabled={isLoading}\r\n              className=\"gap-2\"\r\n            >\r\n              <RefreshCw className={`h-4 w-4 ${isLoading ? 'animate-spin' : ''}`} />\r\n              Refresh Data\r\n            </Button>\r\n          </div>\r\n          <StockSummaryFilters\r\n            period={period}\r\n            setPeriod={setPeriod}\r\n            dateRange={dateRange}\r\n            setDateRange={setDateRange}\r\n            specificDay={specificDay}\r\n            setSpecificDay={setSpecificDay}\r\n            onExportCSV={exportToCSV}\r\n            onExportPDF={exportToPDF}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Stock Summary Table */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <StockSummaryTable\r\n            data={stockSummaryData}\r\n            isLoading={isLoading}\r\n            onProductClick={handleProductClick}\r\n            onFilteredDataChange={handleFilteredDataChange}\r\n            currentProducts={products}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Stock Summary Overview */}\r\n      <StockSummaryOverview data={filteredStockData} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StockSummaryTab;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AAuBA,MAAM,kBAAkB;;IACtB,MAAM,WAAW,IAAA,kLAAW;IAC5B,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,wJAAO;IACxB,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,6IAAW,EAAC,MAAM,IAAI,QAAQ,kCAAkC;IAErF,yCAAyC;IACzC,MAAM,oBAAoB;QACxB,IAAI;YACF,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,IAAI,OAAO;gBACT,MAAM,SAAS,KAAK,KAAK,CAAC;gBAC1B,OAAO;oBACL,QAAQ,OAAO,MAAM,IAAI;oBACzB,WAAW,OAAO,SAAS,GAAG;wBAC5B,MAAM,OAAO,SAAS,CAAC,IAAI,GAAG,IAAI,KAAK,OAAO,SAAS,CAAC,IAAI,IAAI,IAAA,8JAAY,EAAC,IAAI;wBACjF,IAAI,OAAO,SAAS,CAAC,EAAE,GAAG,IAAI,KAAK,OAAO,SAAS,CAAC,EAAE,IAAI,IAAA,0JAAU,EAAC,IAAI;oBAC3E,IAAI;wBACF,MAAM,IAAA,8JAAY,EAAC,IAAI;wBACvB,IAAI,IAAA,0JAAU,EAAC,IAAI;oBACrB;oBACA,aAAa,OAAO,WAAW,GAAG,IAAI,KAAK,OAAO,WAAW,IAAI;gBACnE;YACF;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,kDAAkD;QAClE;QACA,OAAO;YACL,QAAQ;YACR,WAAW;gBACT,MAAM,IAAI,KAAK,MAAM,GAAG;gBACxB,IAAI,IAAA,sJAAQ,EAAC,IAAI;YACnB;YACA,aAAa;QACf;IACF;IAEA,MAAM,iBAAiB;IACvB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAyI;IAC7K,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAmD,eAAe,SAAS;IACrH,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAmB,eAAe,WAAW;IAC3F,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,yKAAQ,EAAqB,EAAE;IAEjF,MAAM,EAAE,gBAAgB,EAAE,SAAS,EAAE,oBAAoB,EAAE,UAAU,EAAE,GAAG,IAAA,6JAAmB,EAAC;IAE9F,4CAA4C;IAC5C,MAAM,gBAAgB;QACpB;QACA,MAAM;IACR;IAEA,iDAAiD;IACjD,IAAA,0KAAS;qCAAC;YACR,MAAM;+DAAoB;oBACxB,QAAQ,GAAG,CAAC;oBACZ;oBACA;gBACF;;YAEA,OAAO,gBAAgB,CAAC,iBAAiB;YAEzC;6CAAO;oBACL,OAAO,mBAAmB,CAAC,iBAAiB;gBAC9C;;QACF;oCAAG;QAAC;QAAY;KAAqB;IAErC,wDAAwD;IACxD,IAAA,0KAAS;qCAAC;YACR,MAAM,cAAc;gBAClB;gBACA,WAAW;oBACT,MAAM,UAAU,IAAI,EAAE;oBACtB,IAAI,UAAU,EAAE,EAAE;gBACpB;gBACA,aAAa,aAAa;YAC5B;YACA,aAAa,OAAO,CAAC,uBAAuB,KAAK,SAAS,CAAC;QAC7D;oCAAG;QAAC;QAAQ;QAAW;KAAY;IAEnC,wCAAwC;IACxC,IAAA,0KAAS;qCAAC;YACR,MAAM,MAAM,IAAI;YAChB,IAAI;YAEJ,OAAQ;gBACN,KAAK;oBACH,WAAW;wBACT,MAAM,IAAA,0JAAU,EAAC;wBACjB,IAAI,IAAA,sJAAQ,EAAC;oBACf;oBACA;gBACF,KAAK;oBACH,MAAM,YAAY,IAAI,KAAK;oBAC3B,UAAU,OAAO,CAAC,UAAU,OAAO,KAAK;oBACxC,WAAW;wBACT,MAAM,IAAA,0JAAU,EAAC;wBACjB,IAAI,IAAA,sJAAQ,EAAC;oBACf;oBACA;gBACF,KAAK;oBACH,WAAW;wBACT,MAAM,IAAA,4JAAW,EAAC;wBAClB,IAAI,IAAA,wJAAS,EAAC;oBAChB;oBACA;gBACF,KAAK;oBACH,MAAM,WAAW,IAAI,KAAK;oBAC1B,SAAS,OAAO,CAAC,SAAS,OAAO,KAAK;oBACtC,WAAW;wBACT,MAAM,IAAA,4JAAW,EAAC;wBAClB,IAAI,IAAA,wJAAS,EAAC;oBAChB;oBACA;gBACF,KAAK;oBACH,WAAW;wBACT,MAAM,IAAA,8JAAY,EAAC;wBACnB,IAAI,IAAA,0JAAU,EAAC;oBACjB;oBACA;gBACF,KAAK;oBACH,MAAM,YAAY,IAAI,KAAK;oBAC3B,UAAU,QAAQ,CAAC,UAAU,QAAQ,KAAK;oBAC1C,WAAW;wBACT,MAAM,IAAA,8JAAY,EAAC;wBACnB,IAAI,IAAA,0JAAU,EAAC;oBACjB;oBACA;gBACF,KAAK;oBACH,WAAW;wBACT,MAAM,IAAI,KAAK,IAAI,WAAW,IAAI,GAAG;wBACrC,IAAI,IAAI,KAAK,IAAI,WAAW,IAAI,IAAI;oBACtC;oBACA;gBACF,KAAK;oBACH,WAAW;wBACT,MAAM,IAAI,KAAK,MAAM,GAAG;wBACxB,IAAI,IAAA,sJAAQ,EAAC,KAAK,8CAA8C;oBAClE;oBACA;gBACF,KAAK;oBACH,IAAI,aAAa;wBACf,WAAW;4BACT,MAAM,IAAA,0JAAU,EAAC;4BACjB,IAAI,IAAA,sJAAQ,EAAC;wBACf;oBACF,OAAO;wBACL,QAAQ,8CAA8C;oBACxD;oBACA;gBACF;oBACE,QAAQ,0BAA0B;YACtC;YAEA,aAAa;QACf;oCAAG;QAAC;QAAQ;KAAY;IAExB,MAAM,cAAc;QAClB,MAAM,UAAU;YACd;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;SACD;QAED,MAAM,OAAO,kBAAkB,GAAG,CAAC,CAAA,OAAQ;gBACzC,KAAK,UAAU;gBACf,KAAK,WAAW;gBAChB,KAAK,QAAQ,IAAI;gBACjB,KAAK,YAAY,CAAC,QAAQ;gBAC1B,KAAK,SAAS,CAAC,QAAQ;gBACvB,KAAK,OAAO,CAAC,QAAQ;gBACrB,KAAK,WAAW,CAAC,QAAQ;gBACzB,KAAK,QAAQ,CAAC,QAAQ;gBACtB,KAAK,SAAS,CAAC,QAAQ;gBACvB,KAAK,YAAY,CAAC,QAAQ;aAC3B;QAED,MAAM,aAAa;YACjB,QAAQ,IAAI,CAAC;eACV,KAAK,GAAG,CAAC,CAAA,MAAO,IAAI,GAAG,CAAC,CAAA,OAAQ,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC;SACtD,CAAC,IAAI,CAAC;QAEP,MAAM,OAAO,IAAI,KAAK;YAAC;SAAW,EAAE;YAAE,MAAM;QAAW;QACvD,MAAM,MAAM,OAAO,GAAG,CAAC,eAAe,CAAC;QACvC,MAAM,OAAO,SAAS,aAAa,CAAC;QACpC,KAAK,IAAI,GAAG;QACZ,KAAK,QAAQ,GAAG,CAAC,uBAAuB,EAAE,IAAA,kKAAM,EAAC,WAAW,QAAQ,IAAI,QAAQ,cAAc,IAAI,CAAC;QACnG,KAAK,KAAK;QACV,OAAO,GAAG,CAAC,eAAe,CAAC;IAC7B;IAEA,MAAM,cAAc;QAClB,IAAA,qKAAuB,EAAC,mBAAmB,kBAAkB;IAC/D;IAEA,MAAM,qBAAqB,CAAC;QAC1B,SAAS,CAAC,WAAW,EAAE,WAAW;IACpC;IAEA,MAAM,2BAA2B,CAAC;QAChC,qBAAqB;IACvB;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC,2IAAI;0BACH,cAAA,6LAAC,kJAAW;oBAAC,WAAU;;sCACrB,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC,+IAAM;gCACL,SAAS;gCACT,SAAQ;gCACR,MAAK;gCACL,UAAU;gCACV,WAAU;;kDAEV,6LAAC,gOAAS;wCAAC,WAAW,CAAC,QAAQ,EAAE,YAAY,iBAAiB,IAAI;;;;;;oCAAI;;;;;;;;;;;;sCAI1E,6LAAC,oKAAmB;4BAClB,QAAQ;4BACR,WAAW;4BACX,WAAW;4BACX,cAAc;4BACd,aAAa;4BACb,gBAAgB;4BAChB,aAAa;4BACb,aAAa;;;;;;;;;;;;;;;;;0BAMnB,6LAAC,2IAAI;0BACH,cAAA,6LAAC,kJAAW;oBAAC,WAAU;8BACrB,cAAA,6LAAC,kKAAiB;wBAChB,MAAM;wBACN,WAAW;wBACX,gBAAgB;wBAChB,sBAAsB;wBACtB,iBAAiB;;;;;;;;;;;;;;;;0BAMvB,6LAAC,qKAAoB;gBAAC,MAAM;;;;;;;;;;;;AAGlC;GA/PM;;QACa,kLAAW;QACX,wJAAO;QACH,6IAAW;QAuC0C,6JAAmB;;;KA1CzF;uCAiQS"}},
    {"offset": {"line": 3445, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/BulkOperationProgress.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { CheckCircle, AlertCircle, Info } from 'lucide-react';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\n\r\ninterface BulkOperationProgressProps {\r\n    title: string;\r\n    currentCount: number;\r\n    totalCount: number;\r\n    status: 'processing' | 'completed' | 'failed';\r\n    successCount?: number;\r\n    failureCount?: number;\r\n    onClose?: () => void;\r\n}\r\n\r\nexport const BulkOperationProgress: React.FC<BulkOperationProgressProps> = ({\r\n    title,\r\n    currentCount,\r\n    totalCount,\r\n    status,\r\n    successCount,\r\n    failureCount,\r\n}) => {\r\n    const progressPercentage = Math.round((currentCount / totalCount) * 100);\r\n\r\n    return (\r\n        <div className=\"space-y-6 py-4\">\r\n            {status === 'processing' && (\r\n                <Alert>\r\n                    <Info className=\"h-4 w-4\" />\r\n                    <AlertDescription>\r\n                        <strong>Please do not close this tab or dialog until the process is complete.</strong>\r\n                    </AlertDescription>\r\n                </Alert>\r\n            )}\r\n\r\n            <div className=\"text-center space-y-4\">\r\n                {status === 'processing' ? (\r\n                    <div className=\"mx-auto h-12 w-12 animate-spin rounded-full border-4 border-muted border-t-primary\"></div>\r\n                ) : status === 'completed' ? (\r\n                    <CheckCircle className=\"mx-auto h-12 w-12 text-green-500\" />\r\n                ) : (\r\n                    <AlertCircle className=\"mx-auto h-12 w-12 text-destructive\" />\r\n                )}\r\n\r\n                <div>\r\n                    <h3 className=\"text-lg font-semibold\">{title}</h3>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                        {status === 'processing'\r\n                            ? `Processing item ${currentCount} of ${totalCount}`\r\n                            : status === 'completed'\r\n                                ? `Successfully processed ${successCount ?? totalCount} items${failureCount ? `, ${failureCount} failed` : ''}`\r\n                                : 'The operation failed to complete.'\r\n                        }\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between text-xs font-medium text-muted-foreground\">\r\n                    <span>Progress</span>\r\n                    <span>{progressPercentage}%</span>\r\n                </div>\r\n                <Progress value={progressPercentage} className=\"h-2 w-full\" />\r\n            </div>\r\n\r\n            {(successCount !== undefined || failureCount !== undefined) && status === 'completed' && (\r\n                <div className=\"grid grid-cols-2 gap-4 pt-2\">\r\n                    <div className=\"bg-green-50 border border-green-100 rounded-lg p-3 text-center\">\r\n                        <div className=\"text-xl font-bold text-green-700\">{successCount ?? 0}</div>\r\n                        <div className=\"text-xs text-green-600 font-medium\">Successful</div>\r\n                    </div>\r\n                    <div className=\"bg-red-50 border border-red-100 rounded-lg p-3 text-center\">\r\n                        <div className=\"text-xl font-bold text-red-700\">{failureCount ?? 0}</div>\r\n                        <div className=\"text-xs text-red-600 font-medium\">Failed</div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AAAA;AACA;;;;;AAYO,MAAM,wBAA8D,CAAC,EACxE,KAAK,EACL,YAAY,EACZ,UAAU,EACV,MAAM,EACN,YAAY,EACZ,YAAY,EACf;IACG,MAAM,qBAAqB,KAAK,KAAK,CAAC,AAAC,eAAe,aAAc;IAEpE,qBACI,6LAAC;QAAI,WAAU;;YACV,WAAW,8BACR,6LAAC,6IAAK;;kCACF,6LAAC,6MAAI;wBAAC,WAAU;;;;;;kCAChB,6LAAC,wJAAgB;kCACb,cAAA,6LAAC;sCAAO;;;;;;;;;;;;;;;;;0BAKpB,6LAAC;gBAAI,WAAU;;oBACV,WAAW,6BACR,6LAAC;wBAAI,WAAU;;;;;mEACf,WAAW,4BACX,6LAAC,6OAAW;wBAAC,WAAU;;;;;iFAEvB,6LAAC,sOAAW;wBAAC,WAAU;;;;;;kCAG3B,6LAAC;;0CACG,6LAAC;gCAAG,WAAU;0CAAyB;;;;;;0CACvC,6LAAC;gCAAE,WAAU;0CACR,WAAW,eACN,CAAC,gBAAgB,EAAE,aAAa,IAAI,EAAE,YAAY,GAClD,WAAW,cACP,CAAC,uBAAuB,EAAE,gBAAgB,WAAW,MAAM,EAAE,eAAe,CAAC,EAAE,EAAE,aAAa,OAAO,CAAC,GAAG,IAAI,GAC7G;;;;;;;;;;;;;;;;;;0BAMtB,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;0CAAK;;;;;;0CACN,6LAAC;;oCAAM;oCAAmB;;;;;;;;;;;;;kCAE9B,6LAAC,mJAAQ;wBAAC,OAAO;wBAAoB,WAAU;;;;;;;;;;;;YAGlD,CAAC,iBAAiB,aAAa,iBAAiB,SAAS,KAAK,WAAW,6BACtE,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,WAAU;0CAAoC,gBAAgB;;;;;;0CACnE,6LAAC;gCAAI,WAAU;0CAAqC;;;;;;;;;;;;kCAExD,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAI,WAAU;0CAAkC,gBAAgB;;;;;;0CACjE,6LAAC;gCAAI,WAAU;0CAAmC;;;;;;;;;;;;;;;;;;;;;;;;AAM1E;KAjEa"}},
    {"offset": {"line": 3663, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/CSVUploadDialog.tsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Upload, FileText, AlertCircle, CheckCircle, Download, Plus, Info } from 'lucide-react';\r\nimport { parseCSV, generateErrorLogCSV, ValidationError, CSVProductRow, extractUniqueCategories } from '@/utils/csvParser';\r\nimport { ProductFormData } from '@/types';\r\nimport { cn } from '@/lib/utils';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useBulkProducts } from '@/hooks/useBulkProducts';\r\nimport { BulkOperationProgress } from './BulkOperationProgress';\r\n\r\ninterface CSVUploadDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  onUpload: (products: ProductFormData[]) => Promise<void>;\r\n  categories: string[];\r\n}\r\n\r\ninterface UploadState {\r\n  step: 'select' | 'preview' | 'uploading' | 'complete';\r\n  file: File | null;\r\n  validRows: CSVProductRow[];\r\n  errors: ValidationError[];\r\n  totalRows: number;\r\n  uploadProgress: number;\r\n  successCount: number;\r\n  failureCount: number;\r\n  newCategories: string[];\r\n  currentProductIndex: number;\r\n}\r\n\r\nconst CSVUploadDialog: React.FC<CSVUploadDialogProps> = ({\r\n  open,\r\n  onOpenChange,\r\n  onUpload,\r\n  categories\r\n}) => {\r\n  const { detectNewCategories, bulkCreateProducts } = useBulkProducts();\r\n  const [state, setState] = useState<UploadState>({\r\n    step: 'select',\r\n    file: null,\r\n    validRows: [],\r\n    errors: [],\r\n    totalRows: 0,\r\n    uploadProgress: 0,\r\n    successCount: 0,\r\n    failureCount: 0,\r\n    newCategories: [],\r\n    currentProductIndex: 0\r\n  });\r\n\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n\r\n  const handleFileSelect = async (file: File) => {\r\n    if (!file.name.endsWith('.csv')) {\r\n      alert('Please select a CSV file');\r\n      return;\r\n    }\r\n\r\n    const text = await file.text();\r\n    const result = parseCSV(text);\r\n\r\n    // Convert CSV rows to ProductFormData to detect new categories\r\n    const products = result.validRows.map(convertCSVRowToProduct);\r\n    const newCategories = detectNewCategories(products);\r\n\r\n    setState({\r\n      ...state,\r\n      step: 'preview',\r\n      file,\r\n      validRows: result.validRows,\r\n      errors: result.errors,\r\n      totalRows: result.totalRows,\r\n      newCategories\r\n    });\r\n  };\r\n\r\n  const handleFileInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      handleFileSelect(file);\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    setIsDragging(false);\r\n\r\n    const file = e.dataTransfer.files[0];\r\n    if (file) {\r\n      handleFileSelect(file);\r\n    }\r\n  };\r\n\r\n  const handleDragOver = (e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    setIsDragging(true);\r\n  };\r\n\r\n  const handleDragLeave = () => {\r\n    setIsDragging(false);\r\n  };\r\n\r\n  const convertCSVRowToProduct = (row: CSVProductRow): ProductFormData => {\r\n    let creationDate = new Date();\r\n\r\n    // Accept any date format - try multiple parsing approaches\r\n    const dateValue = row['Creation Date'];\r\n    if (dateValue) {\r\n      // Try DD/MM/YYYY format first\r\n      const ddmmyyyyMatch = dateValue.match(/^(\\d{1,2})\\/(\\d{1,2})\\/(\\d{4})$/);\r\n      if (ddmmyyyyMatch) {\r\n        const [, day, month, year] = ddmmyyyyMatch;\r\n        creationDate = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));\r\n      } else {\r\n        // Try standard date parsing for other formats\r\n        const parsedDate = new Date(dateValue);\r\n        if (!isNaN(parsedDate.getTime())) {\r\n          creationDate = parsedDate;\r\n        }\r\n      }\r\n    }\r\n\r\n    return {\r\n      name: row['Product Name'],\r\n      category: row['Category'] || '',\r\n      description: row['Description'] || '',\r\n      supplier: row['Supplier'] || '',\r\n      quantity: row['Initial Stock'] ? Number(row['Initial Stock']) : 0,\r\n      minimumStock: row['Minimum Stock Level'] ? Number(row['Minimum Stock Level']) : undefined,\r\n      costPrice: row['Cost Price'] ? Number(row['Cost Price']) : undefined,\r\n      sellingPrice: row['Selling Price'] ? Number(row['Selling Price']) : undefined,\r\n      manufacturerBarcode: row['Manufacturer Barcode'] || '',\r\n      imageFile: null,\r\n      imageUrl: null,\r\n      createdAt: creationDate\r\n    };\r\n  };\r\n\r\n  const handleConfirmUpload = async () => {\r\n    setState(prev => ({ ...prev, step: 'uploading', uploadProgress: 0, currentProductIndex: 0 }));\r\n    setIsUploading(true);\r\n\r\n    const products = state.validRows.map(convertCSVRowToProduct);\r\n\r\n    try {\r\n      // Use the bulk upload function directly with progress tracking\r\n      await bulkCreateProducts(products, (current, total) => {\r\n        const progress = Math.round((current / total) * 100);\r\n        setState(prev => ({\r\n          ...prev,\r\n          uploadProgress: progress,\r\n          currentProductIndex: current,\r\n          successCount: current,\r\n          failureCount: 0\r\n        }));\r\n      });\r\n\r\n      setState(prev => ({\r\n        ...prev,\r\n        step: 'complete',\r\n        uploadProgress: 100,\r\n        successCount: products.length,\r\n        failureCount: 0,\r\n        currentProductIndex: products.length\r\n      }));\r\n    } catch (error) {\r\n      console.error('Bulk upload failed:', error);\r\n      setState(prev => ({\r\n        ...prev,\r\n        step: 'complete',\r\n        uploadProgress: 100,\r\n        successCount: 0,\r\n        failureCount: products.length,\r\n        currentProductIndex: products.length\r\n      }));\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    // Prevent closing during upload\r\n    if (isUploading) return;\r\n\r\n    // Check if we just completed a successful upload\r\n    const wasSuccessfulUpload = state.step === 'complete' && state.successCount > 0;\r\n\r\n    setState({\r\n      step: 'select',\r\n      file: null,\r\n      validRows: [],\r\n      errors: [],\r\n      totalRows: 0,\r\n      uploadProgress: 0,\r\n      successCount: 0,\r\n      failureCount: 0,\r\n      newCategories: [],\r\n      currentProductIndex: 0\r\n    });\r\n\r\n    onOpenChange(false);\r\n\r\n    // Trigger refresh if upload was successful\r\n    if (wasSuccessfulUpload) {\r\n      // Small delay to ensure dialog closes first\r\n      setTimeout(() => {\r\n        window.location.reload();\r\n      }, 100);\r\n    }\r\n  };\r\n\r\n  const handleOpenChange = (newOpen: boolean) => {\r\n    // Prevent dialog from closing during upload\r\n    if (!isUploading) {\r\n      onOpenChange(newOpen);\r\n    }\r\n  };\r\n\r\n  const renderFileSelection = () => (\r\n    <div className=\"space-y-4\">\r\n      <div\r\n        className={cn(\r\n          \"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\",\r\n          isDragging ? \"border-blue-500 bg-blue-50\" : \"border-gray-300 hover:border-gray-400\"\r\n        )}\r\n        onDrop={handleDrop}\r\n        onDragOver={handleDragOver}\r\n        onDragLeave={handleDragLeave}\r\n        onClick={() => fileInputRef.current?.click()}\r\n      >\r\n        <Upload className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\r\n        <p className=\"text-lg font-medium text-gray-900 mb-2\">\r\n          Upload CSV File\r\n        </p>\r\n        <p className=\"text-sm text-gray-500\">\r\n          Drag and drop your CSV file here, or click to browse\r\n        </p>\r\n        <p className=\"text-xs text-gray-400 mt-2\">\r\n          Supports all date formats | Accepts negative values | Use quotes for fields with commas\r\n        </p>\r\n      </div>\r\n\r\n      <input\r\n        ref={fileInputRef}\r\n        type=\"file\"\r\n        accept=\".csv\"\r\n        onChange={handleFileInputChange}\r\n        className=\"hidden\"\r\n      />\r\n    </div>\r\n  );\r\n\r\n  const renderPreview = () => (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"grid grid-cols-3 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-2xl font-bold text-green-600\">{state.validRows.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Valid products</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-2xl font-bold text-red-600\">{state.errors.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Errors found</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-2xl font-bold text-blue-600\">{state.totalRows}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Total rows</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {state.newCategories.length > 0 && (\r\n        <Alert>\r\n          <Plus className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            <div className=\"space-y-2\">\r\n              <p>The following {state.newCategories.length} new categories will be created:</p>\r\n              <div className=\"flex flex-wrap gap-1\">\r\n                {state.newCategories.map((category, index) => (\r\n                  <Badge key={index} variant=\"outline\" className=\"text-xs\">\r\n                    {category}\r\n                  </Badge>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {state.errors.length > 0 && (\r\n        <Alert variant=\"destructive\">\r\n          <AlertCircle className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            {state.errors.length} rows have errors and will be skipped.\r\n            <Button\r\n              variant=\"link\"\r\n              className=\"p-0 h-auto ml-2\"\r\n              onClick={() => generateErrorLogCSV(state.errors)}\r\n            >\r\n              <Download className=\"h-3 w-3 mr-1\" />\r\n              Download error log\r\n            </Button>\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      <div className=\"flex justify-end space-x-2\">\r\n        <Button variant=\"outline\" onClick={() => setState(prev => ({ ...prev, step: 'select' }))}>\r\n          Back\r\n        </Button>\r\n        <Button\r\n          onClick={handleConfirmUpload}\r\n          disabled={state.validRows.length === 0}\r\n        >\r\n          Upload {state.validRows.length} Products\r\n          {state.newCategories.length > 0 && ` & Create ${state.newCategories.length} Categories`}\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderUploading = () => (\r\n    <BulkOperationProgress\r\n      title=\"Uploading Products...\"\r\n      currentCount={state.currentProductIndex}\r\n      totalCount={state.validRows.length}\r\n      status=\"processing\"\r\n    />\r\n  );\r\n\r\n  const renderComplete = () => (\r\n    <div className=\"space-y-4\">\r\n      <BulkOperationProgress\r\n        title=\"Upload Complete!\"\r\n        currentCount={state.currentProductIndex}\r\n        totalCount={state.validRows.length}\r\n        status={state.failureCount > 0 ? 'failed' : 'completed'}\r\n        successCount={state.successCount}\r\n        failureCount={state.failureCount}\r\n      />\r\n      <div className=\"flex justify-center\">\r\n        <Button onClick={handleClose}>Close</Button>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleOpenChange}>\r\n      <DialogContent className=\"sm:max-w-[500px] pointer-events-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <FileText className=\"h-5 w-5\" />\r\n            Upload Products via CSV\r\n          </DialogTitle>\r\n          <DialogDescription>\r\n            Upload multiple products at once using a CSV file (DD/MM/YYYY date format)\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        {state.step === 'select' && renderFileSelection()}\r\n        {state.step === 'preview' && renderPreview()}\r\n        {state.step === 'uploading' && renderUploading()}\r\n        {state.step === 'complete' && renderComplete()}\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default CSVUploadDialog;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4291, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/StockHistoryDateFilter.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Calendar } from 'lucide-react';\r\n\r\ninterface StockHistoryDateFilterProps {\r\n  selectedFilter: string;\r\n  onFilterChange: (filter: string) => void;\r\n}\r\n\r\nconst StockHistoryDateFilter: React.FC<StockHistoryDateFilterProps> = ({\r\n  selectedFilter,\r\n  onFilterChange\r\n}) => {\r\n  return (\r\n    <div className=\"flex items-center gap-2\">\r\n      <Calendar size={16} />\r\n      <Select value={selectedFilter} onValueChange={onFilterChange}>\r\n        <SelectTrigger className=\"w-[180px]\">\r\n          <SelectValue placeholder=\"Select date range\" />\r\n        </SelectTrigger>\r\n        <SelectContent>\r\n          <SelectItem value=\"today\">Today</SelectItem>\r\n          <SelectItem value=\"yesterday\">Yesterday</SelectItem>\r\n          <SelectItem value=\"this-week\">This Week</SelectItem>\r\n          <SelectItem value=\"last-week\">Last Week</SelectItem>\r\n          <SelectItem value=\"this-month\">This Month</SelectItem>\r\n          <SelectItem value=\"last-month\">Last Month</SelectItem>\r\n          <SelectItem value=\"this-year\">This Year</SelectItem>\r\n          <SelectItem value=\"all\">All Time</SelectItem>\r\n        </SelectContent>\r\n      </Select>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StockHistoryDateFilter;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;;AAOA,MAAM,yBAAgE,CAAC,EACrE,cAAc,EACd,cAAc,EACf;IACC,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,yNAAQ;gBAAC,MAAM;;;;;;0BAChB,6LAAC,+IAAM;gBAAC,OAAO;gBAAgB,eAAe;;kCAC5C,6LAAC,sJAAa;wBAAC,WAAU;kCACvB,cAAA,6LAAC,oJAAW;4BAAC,aAAY;;;;;;;;;;;kCAE3B,6LAAC,sJAAa;;0CACZ,6LAAC,mJAAU;gCAAC,OAAM;0CAAQ;;;;;;0CAC1B,6LAAC,mJAAU;gCAAC,OAAM;0CAAY;;;;;;0CAC9B,6LAAC,mJAAU;gCAAC,OAAM;0CAAY;;;;;;0CAC9B,6LAAC,mJAAU;gCAAC,OAAM;0CAAY;;;;;;0CAC9B,6LAAC,mJAAU;gCAAC,OAAM;0CAAa;;;;;;0CAC/B,6LAAC,mJAAU;gCAAC,OAAM;0CAAa;;;;;;0CAC/B,6LAAC,mJAAU;gCAAC,OAAM;0CAAY;;;;;;0CAC9B,6LAAC,mJAAU;gCAAC,OAAM;0CAAM;;;;;;;;;;;;;;;;;;;;;;;;AAKlC;KAxBM;uCA0BS"}},
    {"offset": {"line": 4426, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/EditStockHistoryDialog.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { StockHistoryEntry } from '@/types';\r\nimport { format } from 'date-fns';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\n\r\ninterface EditStockHistoryDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  entry: StockHistoryEntry | null;\r\n  onConfirm: (entryId: string, newQuantity: number, newReason: string, newDate?: Date) => Promise<boolean>;\r\n  isInitialStock?: boolean;\r\n  stockHistory?: StockHistoryEntry[];\r\n  productCreatedAt?: Date;\r\n}\r\n\r\nconst EditStockHistoryDialog: React.FC<EditStockHistoryDialogProps> = ({\r\n  open,\r\n  onOpenChange,\r\n  entry,\r\n  onConfirm,\r\n  isInitialStock = false,\r\n  stockHistory = [],\r\n  productCreatedAt,\r\n}) => {\r\n  const [quantityChange, setQuantityChange] = useState<number | ''>(0);\r\n  const [newReason, setNewReason] = useState<string>('');\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [validationError, setValidationError] = useState<string>('');\r\n  const { toast } = useToast();\r\n  const { hasPermission } = useProfiles();\r\n\r\n  // Get the initial stock date (chronologically first entry)\r\n  const getInitialStockDate = (): Date | null => {\r\n    if (stockHistory.length === 0) return null;\r\n    const sortedHistory = [...stockHistory].sort((a, b) => a.createdAt.getTime() - b.createdAt.getTime());\r\n    return sortedHistory[0]?.createdAt || null;\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (entry) {\r\n      setQuantityChange(entry.newQuantity - entry.oldQuantity);\r\n      setNewReason(entry.changeReason);\r\n      setValidationError(''); // Clear validation error when entry changes\r\n    }\r\n  }, [entry]);\r\n\r\n  const validateQuantityChange = (newChange: number, currentChange: number): string => {\r\n    // If current change is negative, don't allow changing to positive\r\n    if (currentChange < 0 && newChange > 0) {\r\n      return 'Cannot change from negative to positive value.';\r\n    }\r\n    // If current change is positive, don't allow changing to negative\r\n    if (currentChange > 0 && newChange < 0) {\r\n      return 'Cannot change from positive to negative value.';\r\n    }\r\n    return '';\r\n  };\r\n\r\n  const handleQuantityChange = (value: string) => {\r\n    // Always allow empty string so users can clear the field\r\n    if (value === '') {\r\n      setQuantityChange('');\r\n      setValidationError('');\r\n      return;\r\n    }\r\n\r\n    const numericValue = parseInt(value) || 0;\r\n    const currentChange = quantityChange === '' ? 0 : quantityChange;\r\n\r\n    const error = validateQuantityChange(numericValue, currentChange);\r\n\r\n    // Only update the input if validation passes\r\n    if (!error) {\r\n      setQuantityChange(numericValue);\r\n      setValidationError('');\r\n    } else {\r\n      // Show validation error but don't update the input\r\n      setValidationError(error);\r\n    }\r\n  };\r\n\r\n  const handleReasonChange = (value: string) => {\r\n    setNewReason(value);\r\n  };\r\n\r\n  const handleSubmit = async (skipDateUpdate = false) => {\r\n    if (!entry) return;\r\n\r\n    const changeAmount = quantityChange === '' ? 0 : quantityChange;\r\n\r\n    // Validate quantity change before submitting\r\n    const originalChange = entry.newQuantity - entry.oldQuantity;\r\n    const error = validateQuantityChange(changeAmount, originalChange);\r\n    if (error) {\r\n      toast({\r\n        title: \"Invalid quantity change\",\r\n        description: error,\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    const newQuantity = entry.oldQuantity + changeAmount;\r\n\r\n    if (!newReason.trim()) {\r\n      toast({\r\n        title: \"Invalid reason\",\r\n        description: \"Please provide a reason for this stock change\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n\r\n    try {\r\n      const success = await onConfirm(\r\n        entry.id,\r\n        newQuantity,\r\n        newReason.trim()\r\n      );\r\n\r\n      if (success) {\r\n        toast({\r\n          title: \"Stock history updated\",\r\n          description: \"The stock history entry has been updated successfully.\"\r\n        });\r\n        onOpenChange(false);\r\n      } else {\r\n        toast({\r\n          title: \"Update failed\",\r\n          description: \"Failed to update stock history entry. Please try again.\",\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating stock history:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"An error occurred while updating the stock history.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    onOpenChange(false);\r\n  };\r\n\r\n  if (!entry) return null;\r\n\r\n  // Check if this entry was created by a sale operation\r\n  const isSaleRelatedEntry = (entry: StockHistoryEntry): boolean => {\r\n    const saleReasons = ['Sale', 'Delete sale', 'Deleted Sale', 'Sale qty edit'];\r\n    return saleReasons.some(reason => entry.changeReason.toLowerCase().includes(reason.toLowerCase()));\r\n  };\r\n\r\n  const formatChangeReason = (reason: string): string => {\r\n    return reason\r\n      .replace('Deleted sale', 'Deleted Sale');\r\n  };\r\n\r\n  // If this is initial stock, show form with date editing enabled but with validation\r\n  if (isInitialStock) {\r\n    return (\r\n      <Dialog open={open} onOpenChange={onOpenChange}>\r\n        <DialogContent className=\"sm:max-w-md\">\r\n          <DialogHeader>\r\n            <DialogTitle>Edit Initial Stock Entry</DialogTitle>\r\n            <DialogDescription>\r\n              This is the initial stock entry. You can modify quantity, reason, and date, but the date must be earlier than all other stock transactions.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"quantity\">Quantity Change</Label>\r\n              <Input\r\n                id=\"quantity\"\r\n                type=\"number\"\r\n                value={quantityChange}\r\n                onChange={(e) => handleQuantityChange(e.target.value)}\r\n                className={validationError ? 'border-destructive border-2 bg-destructive/5 focus:border-destructive focus:ring-destructive' : ''}\r\n              />\r\n              {validationError && (\r\n                <p className=\"text-sm text-destructive\">{validationError}</p>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"reason\">Change Reason</Label>\r\n              <Input\r\n                id=\"reason\"\r\n                value={newReason}\r\n                onChange={(e) => setNewReason(e.target.value)}\r\n                placeholder=\"Enter reason for stock change\"\r\n              />\r\n            </div>\r\n\r\n          </div>\r\n\r\n          <div className=\"flex justify-end gap-2 mt-6\">\r\n            <Button variant=\"outline\" onClick={handleCancel} disabled={isSubmitting}>\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={() => handleSubmit()}\r\n              disabled={isSubmitting || !hasPermission('inventory', 'stock_adjustment')}\r\n            >\r\n              {isSubmitting ? 'Updating...' : 'Update Entry'}\r\n            </Button>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  // If this is a sale-related entry, show a restricted message\r\n  if (isSaleRelatedEntry(entry)) {\r\n    return (\r\n      <Dialog open={open} onOpenChange={onOpenChange}>\r\n        <DialogContent className=\"sm:max-w-md\">\r\n          <DialogHeader>\r\n            <DialogTitle>Cannot Edit Sale-Related Entry</DialogTitle>\r\n            <DialogDescription>\r\n              This stock history entry was created by a sales operation and can only be modified through the Edit Sale form.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-muted p-3 rounded-lg space-y-2\">\r\n              <div className=\"font-medium\">Entry Details:</div>\r\n              <div className=\"text-sm space-y-1\">\r\n                <div><strong>Date:</strong> {format(entry.createdAt, 'PPP p')}</div>\r\n                <div><strong>Change:</strong> {entry.oldQuantity} → {entry.newQuantity}</div>\r\n                <div><strong>Reason:</strong> {formatChangeReason(entry.changeReason)}</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-blue-50 border border-blue-200 p-3 rounded-lg\">\r\n              <div className=\"text-blue-800 text-sm\">\r\n                <strong>Note:</strong> To modify this entry, please use the Edit Sale form in the Sales section.\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex justify-end gap-2 mt-6\">\r\n            <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\r\n              Close\r\n            </Button>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  const originalChange = entry.newQuantity - entry.oldQuantity;\r\n  const changeAmount = quantityChange === '' ? 0 : quantityChange;\r\n  const newQuantity = entry.oldQuantity + changeAmount;\r\n  const newChange = changeAmount;\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"sm:max-w-md\">\r\n        <DialogHeader>\r\n          <DialogTitle>Edit Stock History Entry</DialogTitle>\r\n          <DialogDescription>\r\n            Modify the details of this stock history entry. The product's current stock will be recalculated after saving.\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n            <div>\r\n              <Label className=\"text-muted-foreground\">Original</Label>\r\n              <div className=\"font-medium\">\r\n                {entry.oldQuantity} → {entry.newQuantity}\r\n              </div>\r\n              <div className={`text-xs ${originalChange >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n                {originalChange >= 0 ? '+' : ''}{originalChange}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <Label className=\"text-muted-foreground\">New</Label>\r\n              <div className=\"font-medium\">\r\n                {entry.oldQuantity} → {newQuantity}\r\n              </div>\r\n              <div className={`text-xs ${newChange >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n                {newChange >= 0 ? '+' : ''}{newChange}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"quantity\">Quantity Change</Label>\r\n            <Input\r\n              id=\"quantity\"\r\n              type=\"number\"\r\n              value={quantityChange}\r\n              onChange={(e) => handleQuantityChange(e.target.value)}\r\n              className={validationError ? 'border-destructive border-2 bg-destructive/5 focus:border-destructive focus:ring-destructive' : ''}\r\n            />\r\n            {entry && (\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                ⚠️ {(quantityChange === '' ? 0 : quantityChange) < 0\r\n                  ? \"Current change is negative - you cannot change to positive values\"\r\n                  : \"Current change is positive - you cannot change to negative values\"\r\n                }\r\n              </p>\r\n            )}\r\n            {validationError && (\r\n              <p className=\"text-sm text-destructive\">{validationError}</p>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"reason\">Change Reason</Label>\r\n            <Input\r\n              id=\"reason\"\r\n              value={newReason}\r\n              onChange={(e) => setNewReason(e.target.value)}\r\n              placeholder=\"Enter reason for stock change\"\r\n            />\r\n          </div>\r\n\r\n        </div>\r\n\r\n        <div className=\"flex justify-end gap-2 mt-6\">\r\n          <Button variant=\"outline\" onClick={handleCancel} disabled={isSubmitting}>\r\n            Cancel\r\n          </Button>\r\n          <Button\r\n            onClick={() => handleSubmit()}\r\n            disabled={isSubmitting || !hasPermission('inventory', 'stock_adjustment')}\r\n          >\r\n            {isSubmitting ? 'Updating...' : 'Update Entry'}\r\n          </Button>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default EditStockHistoryDialog;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5147, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/EditGroupDateDialog.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { StockHistoryEntry } from '@/types';\r\nimport { format } from 'date-fns';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useProducts } from '@/hooks/useProducts';\r\nimport { useAuth } from '@/components/auth/AuthProvider';\r\n\r\ninterface EditGroupDateDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    group: { supplier?: string; invoice?: string; date: Date; entries: StockHistoryEntry[] } | null;\r\n    onConfirm: (newDate: Date) => Promise<boolean>;\r\n}\r\n\r\nexport const EditGroupDateDialog: React.FC<EditGroupDateDialogProps> = ({\r\n    open,\r\n    onOpenChange,\r\n    group,\r\n    onConfirm,\r\n}) => {\r\n    const { user } = useAuth();\r\n    const { products } = useProducts(user?.id);\r\n    const [newDate, setNewDate] = useState<string>('');\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [validationError, setValidationError] = useState<string>('');\r\n    const { toast } = useToast();\r\n\r\n    useEffect(() => {\r\n        if (group) {\r\n            setNewDate(format(new Date(group.date), 'yyyy-MM-dd'));\r\n            setValidationError('');\r\n        }\r\n    }, [group]);\r\n\r\n    const handleDateChange = (value: string) => {\r\n        setNewDate(value);\r\n        setValidationError('');\r\n    };\r\n\r\n    const validateDate = (): boolean => {\r\n        if (!group || !newDate) return false;\r\n\r\n        const selectedDate = new Date(newDate);\r\n        selectedDate.setHours(23, 59, 59, 999); // Allow same day\r\n\r\n        // Check against all products in the group\r\n        for (const entry of group.entries) {\r\n            const product = products.find(p => p.id === entry.productId);\r\n            if (product && product.createdAt) {\r\n                const createdAt = new Date(product.createdAt);\r\n                if (selectedDate < createdAt) {\r\n                    setValidationError(`New date cannot be earlier than product creation date (${format(createdAt, 'PP')}) for ${product.name}.`);\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        if (!group || !newDate) return;\r\n\r\n        if (!validateDate()) return;\r\n\r\n        setIsSubmitting(true);\r\n        try {\r\n            const success = await onConfirm(new Date(newDate));\r\n            if (success) {\r\n                toast({\r\n                    title: \"Dates updated\",\r\n                    description: \"All entries in this invoice have been updated to the new date.\"\r\n                });\r\n                onOpenChange(false);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error updating group date:', error);\r\n            toast({\r\n                title: \"Update failed\",\r\n                description: \"An error occurred while updating the dates.\",\r\n                variant: \"destructive\"\r\n            });\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    if (!group) return null;\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-md\">\r\n                <DialogHeader>\r\n                    <DialogTitle>Edit Invoice Date</DialogTitle>\r\n                    <DialogDescription>\r\n                        This will update the date for all {group.entries.length} items in this invoice.\r\n                        Time settings for each item will be preserved.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <div className=\"space-y-4 py-4\">\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"date\">New Date</Label>\r\n                        <Input\r\n                            id=\"date\"\r\n                            type=\"date\"\r\n                            value={newDate}\r\n                            onChange={(e) => handleDateChange(e.target.value)}\r\n                            className={validationError ? 'border-destructive' : ''}\r\n                        />\r\n                        {validationError && (\r\n                            <p className=\"text-sm text-destructive\">{validationError}</p>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"bg-muted p-3 rounded-lg text-sm space-y-1\">\r\n                        {group.supplier && <div><strong>Supplier:</strong> {group.supplier}</div>}\r\n                        {group.invoice && <div><strong>Invoice:</strong> {group.invoice}</div>}\r\n                        <div><strong>Current Date:</strong> {format(new Date(group.date), 'PP')}</div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex justify-end gap-2 mt-4\">\r\n                    <Button variant=\"outline\" onClick={() => onOpenChange(false)} disabled={isSubmitting}>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={handleSubmit} disabled={isSubmitting}>\r\n                        {isSubmitting ? 'Updating...' : 'Update Dates'}\r\n                    </Button>\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5430, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/DeleteStockHistoryDialog.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from '@/components/ui/alert-dialog';\r\nimport { StockHistoryEntry } from '@/types';\r\nimport { format } from 'date-fns';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { AlertTriangle } from 'lucide-react';\r\n\r\ninterface DeleteStockHistoryDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  entry: StockHistoryEntry | null;\r\n  onConfirm: (entryId: string) => Promise<boolean>;\r\n}\r\n\r\nconst DeleteStockHistoryDialog: React.FC<DeleteStockHistoryDialogProps> = ({\r\n  open,\r\n  onOpenChange,\r\n  entry,\r\n  onConfirm,\r\n}) => {\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n  const { toast } = useToast();\r\n\r\n  const handleDelete = async () => {\r\n    if (!entry) return;\r\n\r\n    setIsDeleting(true);\r\n\r\n    try {\r\n      const success = await onConfirm(entry.id);\r\n\r\n      if (success) {\r\n        toast({\r\n          title: \"Stock history deleted\",\r\n          description: \"The stock history entry has been deleted and stock recalculated.\"\r\n        });\r\n        onOpenChange(false);\r\n      } else {\r\n        toast({\r\n          title: \"Delete failed\",\r\n          description: \"Failed to delete stock history entry. Please try again.\",\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting stock history:', error);\r\n      toast({\r\n        title: \"Error\",\r\n        description: \"An error occurred while deleting the stock history.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsDeleting(false);\r\n    }\r\n  };\r\n\r\n  if (!entry) return null;\r\n\r\n  // Check if this entry was created by a sale operation\r\n  const isSaleRelatedEntry = (entry: StockHistoryEntry): boolean => {\r\n    const saleReasons = ['Sale', 'Delete sale', 'Deleted Sale', 'Sale qty edit'];\r\n    return saleReasons.some(reason => entry.changeReason.toLowerCase().includes(reason.toLowerCase()));\r\n  };\r\n\r\n  const formatChangeReason = (reason: string): string => {\r\n    return reason\r\n      .replace('Deleted sale', 'Deleted Sale');\r\n  };\r\n\r\n  // If this is a sale-related entry, show a restricted message\r\n  if (isSaleRelatedEntry(entry)) {\r\n    return (\r\n      <AlertDialog open={open} onOpenChange={onOpenChange}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle className=\"flex items-center gap-2\">\r\n              <AlertTriangle className=\"h-5 w-5 text-blue-600\" />\r\n              Cannot Delete Sale-Related Entry\r\n            </AlertDialogTitle>\r\n            <AlertDialogDescription className=\"space-y-3\">\r\n              <p>\r\n                This stock history entry was created by a sales operation and cannot be deleted directly.\r\n              </p>\r\n\r\n              <div className=\"bg-muted p-3 rounded-lg space-y-2\">\r\n                <div className=\"font-medium\">Entry Details:</div>\r\n                <div className=\"text-sm space-y-1\">\r\n                  <div><strong>Date:</strong> {format(entry.createdAt, 'PPP p')}</div>\r\n                  <div><strong>Change:</strong> {entry.oldQuantity} → {entry.newQuantity}</div>\r\n                  <div><strong>Reason:</strong> {formatChangeReason(entry.changeReason)}</div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"bg-blue-50 border border-blue-200 p-3 rounded-lg\">\r\n                <div className=\"text-blue-800 text-sm\">\r\n                  <strong>Note:</strong> To remove this entry, please edit or delete the corresponding sale in the Sales section.\r\n                </div>\r\n              </div>\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Close</AlertDialogCancel>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    );\r\n  }\r\n\r\n  const stockChange = entry.newQuantity - entry.oldQuantity;\r\n\r\n  return (\r\n    <AlertDialog open={open} onOpenChange={onOpenChange}>\r\n      <AlertDialogContent>\r\n        <AlertDialogHeader>\r\n          <AlertDialogTitle className=\"flex items-center gap-2\">\r\n            <AlertTriangle className=\"h-5 w-5 text-destructive\" />\r\n            Delete Stock History Entry\r\n          </AlertDialogTitle>\r\n          <AlertDialogDescription className=\"space-y-3\">\r\n            <p>\r\n              Are you sure you want to delete this stock history entry? This action cannot be undone.\r\n            </p>\r\n\r\n            <div className=\"bg-muted p-3 rounded-lg space-y-2\">\r\n              <div className=\"font-medium\">Entry Details:</div>\r\n              <div className=\"text-sm space-y-1\">\r\n                <div><strong>Date:</strong> {format(entry.createdAt, 'PPP p')}</div>\r\n                <div><strong>Change:</strong> {entry.oldQuantity} → {entry.newQuantity}</div>\r\n                <div className={`${stockChange >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n                  <strong>Impact:</strong> {stockChange >= 0 ? '+' : ''}{stockChange} units\r\n                </div>\r\n                <div><strong>Reason:</strong> {formatChangeReason(entry.changeReason)}</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-amber-50 border border-amber-200 p-3 rounded-lg\">\r\n              <div className=\"text-amber-800 text-sm\">\r\n                <strong>Warning:</strong> After deletion, the product's current stock will be automatically recalculated based on the remaining stock history entries.\r\n              </div>\r\n            </div>\r\n          </AlertDialogDescription>\r\n        </AlertDialogHeader>\r\n        <AlertDialogFooter>\r\n          <AlertDialogCancel disabled={isDeleting}>Cancel</AlertDialogCancel>\r\n          <AlertDialogAction\r\n            onClick={handleDelete}\r\n            disabled={isDeleting}\r\n            className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n          >\r\n            {isDeleting ? 'Deleting...' : 'Delete Entry'}\r\n          </AlertDialogAction>\r\n        </AlertDialogFooter>\r\n      </AlertDialogContent>\r\n    </AlertDialog>\r\n  );\r\n};\r\n\r\nexport default DeleteStockHistoryDialog;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5894, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/DeleteInvoiceDialog.tsx"],"sourcesContent":["import React from 'react';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from '@/components/ui/alert-dialog';\r\nimport { StockHistoryEntry } from '@/types';\r\n\r\ninterface DeleteInvoiceDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  group: {\r\n    supplier: string;\r\n    invoice: string;\r\n    entries: StockHistoryEntry[];\r\n  } | null;\r\n  onConfirm: (entryIds: string[]) => Promise<boolean>;\r\n}\r\n\r\nexport const DeleteInvoiceDialog: React.FC<DeleteInvoiceDialogProps> = ({\r\n  open,\r\n  onOpenChange,\r\n  group,\r\n  onConfirm\r\n}) => {\r\n  const handleConfirm = async () => {\r\n    if (!group) return;\r\n    \r\n    const entryIds = group.entries.map(entry => entry.id);\r\n    const success = await onConfirm(entryIds);\r\n    if (success) {\r\n      onOpenChange(false);\r\n    }\r\n  };\r\n\r\n  if (!group) return null;\r\n\r\n  return (\r\n    <AlertDialog open={open} onOpenChange={onOpenChange}>\r\n      <AlertDialogContent>\r\n        <AlertDialogHeader>\r\n          <AlertDialogTitle>Delete Entire Invoice</AlertDialogTitle>\r\n          <AlertDialogDescription className=\"space-y-2\">\r\n            <p>\r\n              Are you sure you want to delete all stock entries for this invoice?\r\n            </p>\r\n            <div className=\"bg-muted p-3 rounded-lg\">\r\n              <p><strong>Supplier:</strong> {group.supplier}</p>\r\n              <p><strong>Invoice:</strong> {group.invoice}</p>\r\n              <p><strong>Items:</strong> {group.entries.length} products will be affected</p>\r\n            </div>\r\n            <p className=\"text-destructive text-sm\">\r\n              This will permanently remove all stock history entries for this purchase and recalculate stock levels. This action cannot be undone.\r\n            </p>\r\n          </AlertDialogDescription>\r\n        </AlertDialogHeader>\r\n        <AlertDialogFooter>\r\n          <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n          <AlertDialogAction\r\n            onClick={handleConfirm}\r\n            className=\"bg-destructive hover:bg-destructive/90\"\r\n          >\r\n            Delete Invoice\r\n          </AlertDialogAction>\r\n        </AlertDialogFooter>\r\n      </AlertDialogContent>\r\n    </AlertDialog>\r\n  );\r\n};"],"names":[],"mappings":";;;;;AACA;;;AAuBO,MAAM,sBAA0D,CAAC,EACtE,IAAI,EACJ,YAAY,EACZ,KAAK,EACL,SAAS,EACV;IACC,MAAM,gBAAgB;QACpB,IAAI,CAAC,OAAO;QAEZ,MAAM,WAAW,MAAM,OAAO,CAAC,GAAG,CAAC,CAAA,QAAS,MAAM,EAAE;QACpD,MAAM,UAAU,MAAM,UAAU;QAChC,IAAI,SAAS;YACX,aAAa;QACf;IACF;IAEA,IAAI,CAAC,OAAO,OAAO;IAEnB,qBACE,6LAAC,6JAAW;QAAC,MAAM;QAAM,cAAc;kBACrC,cAAA,6LAAC,oKAAkB;;8BACjB,6LAAC,mKAAiB;;sCAChB,6LAAC,kKAAgB;sCAAC;;;;;;sCAClB,6LAAC,wKAAsB;4BAAC,WAAU;;8CAChC,6LAAC;8CAAE;;;;;;8CAGH,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;;8DAAE,6LAAC;8DAAO;;;;;;gDAAkB;gDAAE,MAAM,QAAQ;;;;;;;sDAC7C,6LAAC;;8DAAE,6LAAC;8DAAO;;;;;;gDAAiB;gDAAE,MAAM,OAAO;;;;;;;sDAC3C,6LAAC;;8DAAE,6LAAC;8DAAO;;;;;;gDAAe;gDAAE,MAAM,OAAO,CAAC,MAAM;gDAAC;;;;;;;;;;;;;8CAEnD,6LAAC;oCAAE,WAAU;8CAA2B;;;;;;;;;;;;;;;;;;8BAK5C,6LAAC,mKAAiB;;sCAChB,6LAAC,mKAAiB;sCAAC;;;;;;sCACnB,6LAAC,mKAAiB;4BAChB,SAAS;4BACT,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AAOX;KAjDa"}},
    {"offset": {"line": 6063, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/SavedRequisitions.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n  Download,\r\n  Eye,\r\n  Edit,\r\n  Trash2,\r\n  Calendar,\r\n  Package,\r\n  AlertTriangle\r\n} from 'lucide-react';\r\nimport { format } from 'date-fns';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { usePagination } from '@/hooks/usePagination';\r\nimport { Pagination, PaginationContent, PaginationItem, PaginationLink, PaginationNext, PaginationPrevious } from '@/components/ui/pagination';\r\nimport { cn } from '@/lib/utils';\r\nimport { Requisition } from '@/hooks/useRequisitions';\r\n\r\n// Alternative PDF generation using HTML\r\nconst generateAlternativePDF = async (requisition: Requisition, businessName: string) => {\r\n  // Create a temporary HTML element for PDF generation\r\n  const tempDiv = document.createElement('div');\r\n  tempDiv.style.position = 'absolute';\r\n  tempDiv.style.left = '-9999px';\r\n  tempDiv.style.width = '800px';\r\n  tempDiv.style.padding = '40px';\r\n  tempDiv.style.backgroundColor = 'white';\r\n  tempDiv.style.fontFamily = 'Arial, sans-serif';\r\n\r\n  const validItems = requisition.items.filter(item => item.quantity > 0);\r\n  const totalQuantity = validItems.reduce((sum, item) => sum + item.quantity, 0);\r\n  const urgentItems = validItems.filter(item => item.urgentItem).length;\r\n\r\n  tempDiv.innerHTML = `\r\n    <div style=\"text-align: center; margin-bottom: 40px;\">\r\n      <h1 style=\"color: #2563eb; font-size: 24px; margin: 0;\">PURCHASE REQUISITION</h1>\r\n    </div>\r\n    \r\n    <div style=\"margin-bottom: 30px;\">\r\n      <p><strong>Business:</strong> ${businessName}</p>\r\n      <p><strong>Date:</strong> ${format(requisition.createdAt, 'PPP')}</p>\r\n      <p><strong>Requisition #:</strong> ${requisition.requisitionNumber}</p>\r\n      <p><strong>Title:</strong> ${requisition.title}</p>\r\n      <p><strong>Status:</strong> ${requisition.status.toUpperCase()}</p>\r\n    </div>\r\n    \r\n    ${validItems.length > 0 ? `\r\n      <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 30px;\">\r\n        <thead>\r\n          <tr style=\"background-color: #2563eb; color: white;\">\r\n            <th style=\"border: 1px solid #ddd; padding: 8px; text-align: left;\">#</th>\r\n            <th style=\"border: 1px solid #ddd; padding: 8px; text-align: left;\">Item Description</th>\r\n            <th style=\"border: 1px solid #ddd; padding: 8px; text-align: left;\">Quantity</th>\r\n            <th style=\"border: 1px solid #ddd; padding: 8px; text-align: left;\">Urgent</th>\r\n            <th style=\"border: 1px solid #ddd; padding: 8px; text-align: left;\">Supplier/Price</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          ${validItems.map((item, index) => `\r\n            <tr style=\"${item.urgentItem ? 'background-color: #fef3c7;' : ''}\">\r\n              <td style=\"border: 1px solid #ddd; padding: 8px;\">${index + 1}</td>\r\n              <td style=\"border: 1px solid #ddd; padding: 8px;\">${item.productName}</td>\r\n              <td style=\"border: 1px solid #ddd; padding: 8px;\">${Math.round(item.quantity).toLocaleString()}</td>\r\n              <td style=\"border: 1px solid #ddd; padding: 8px;\">${item.urgentItem ? 'Yes' : 'No'}</td>\r\n              <td style=\"border: 1px solid #ddd; padding: 8px;\"></td>\r\n            </tr>\r\n          `).join('')}\r\n        </tbody>\r\n      </table>\r\n      \r\n      <div style=\"margin-bottom: 30px; padding: 15px; background-color: #f8fafc; border-radius: 8px;\">\r\n        <h3 style=\"margin: 0 0 10px 0; color: #1e40af;\">SUMMARY</h3>\r\n        <p><strong>Total Items:</strong> ${validItems.length}</p>\r\n        <p><strong>Total Quantity:</strong> ${totalQuantity.toLocaleString()}</p>\r\n        <p><strong>Urgent Items:</strong> ${urgentItems}</p>\r\n      </div>\r\n    ` : `\r\n      <p>No items in this requisition.</p>\r\n    `}\r\n    \r\n    ${requisition.notes ? `\r\n      <div style=\"margin-bottom: 30px;\">\r\n        <h3 style=\"color: #1e40af;\">NOTES</h3>\r\n        <p style=\"padding: 10px; background-color: #f1f5f9; border-radius: 4px;\">${requisition.notes}</p>\r\n      </div>\r\n    ` : ''}\r\n    \r\n    <div style=\"margin-top: 60px;\">\r\n      <div style=\"display: flex; justify-content: space-between; margin-bottom: 20px;\">\r\n        <div>\r\n          <p>Requested by: _____________________</p>\r\n          <p>Date: _____________</p>\r\n        </div>\r\n        <div>\r\n          <p>Approved by: _____________________</p>\r\n          <p>Date: _____________</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  document.body.appendChild(tempDiv);\r\n\r\n  try {\r\n    const { generateVectorPDF } = await import('@/utils/generateVectorPDF');\r\n    await generateVectorPDF(tempDiv, {\r\n      filename: `Requisition_${requisition.requisitionNumber}.pdf`,\r\n      orientation: 'portrait',\r\n      format: 'a4',\r\n      margins: { top: 10, right: 10, bottom: 10, left: 10 }\r\n    });\r\n  } finally {\r\n    document.body.removeChild(tempDiv);\r\n  }\r\n};\r\n\r\ninterface SavedRequisitionsProps {\r\n  requisitions: Requisition[];\r\n  isLoading: boolean;\r\n  onRefresh: () => void;\r\n  onDelete: (id: string) => void;\r\n  businessName?: string;\r\n}\r\n\r\nconst SavedRequisitions = ({\r\n  requisitions,\r\n  isLoading,\r\n  onRefresh,\r\n  onDelete,\r\n  businessName = 'Your Business Name'\r\n}: SavedRequisitionsProps) => {\r\n  const isMobile = useIsMobile();\r\n  const [selectedRequisition, setSelectedRequisition] = useState<Requisition | null>(null);\r\n\r\n  const {\r\n    currentPage,\r\n    setCurrentPage,\r\n    paginatedItems,\r\n    totalPages\r\n  } = usePagination({ items: requisitions, itemsPerPage: 10 });\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'draft': return 'bg-gray-100 text-gray-800';\r\n      case 'submitted': return 'bg-blue-100 text-blue-800';\r\n      case 'approved': return 'bg-green-100 text-green-800';\r\n      case 'completed': return 'bg-purple-100 text-purple-800';\r\n      default: return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const formatNumber = (num: number) => {\r\n    return Math.round(num).toLocaleString();\r\n  };\r\n\r\n  const generateRequisitionPDF = async (requisition: Requisition) => {\r\n    try {\r\n      console.log('Starting PDF generation for requisition:', requisition.requisitionNumber);\r\n\r\n      // Use the alternative PDF generation method\r\n      await generateAlternativePDF(requisition, businessName);\r\n      console.log('PDF generated successfully using alternative method');\r\n\r\n    } catch (error) {\r\n      console.error('PDF generation failed:', error);\r\n      console.error('Error message:', error.message);\r\n      console.error('Error stack:', error.stack);\r\n\r\n      // Show user-friendly error message\r\n      alert(`Failed to generate PDF: ${error.message || 'Unknown error occurred'}`);\r\n    }\r\n  };\r\n\r\n  const RequisitionCard = ({ requisition }: { requisition: Requisition }) => {\r\n    const totalQuantity = requisition.items.reduce((sum, item) => sum + item.quantity, 0);\r\n    const urgentItems = requisition.items.filter(item => item.urgentItem).length;\r\n\r\n    return (\r\n      <Card className=\"mb-4\">\r\n        <CardHeader className=\"pb-3\">\r\n          <div className=\"flex items-start justify-between\">\r\n            <div>\r\n              <CardTitle className=\"text-sm font-medium\">{requisition.title}</CardTitle>\r\n              <p className=\"text-xs text-muted-foreground mt-1\">\r\n                {requisition.requisitionNumber} • {format(requisition.createdAt, 'MMM d, yyyy')}\r\n              </p>\r\n            </div>\r\n            <Badge className={cn('text-xs', getStatusColor(requisition.status))}>\r\n              {requisition.status}\r\n            </Badge>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"pt-0\">\r\n          <div className=\"space-y-2 text-xs\">\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-muted-foreground\">Items:</span>\r\n              <span>{requisition.items.length}</span>\r\n            </div>\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-muted-foreground\">Total Qty:</span>\r\n              <span>{formatNumber(totalQuantity)}</span>\r\n            </div>\r\n            {urgentItems > 0 && (\r\n              <div className=\"flex justify-between text-orange-600\">\r\n                <span className=\"flex items-center gap-1\">\r\n                  <AlertTriangle size={12} />\r\n                  Urgent:\r\n                </span>\r\n                <span>{urgentItems}</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"flex gap-2 mt-4\">\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setSelectedRequisition(requisition)}\r\n              className=\"flex-1\"\r\n            >\r\n              <Eye size={14} className=\"mr-1\" />\r\n              View\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => generateRequisitionPDF(requisition)}\r\n              className=\"flex-1\"\r\n            >\r\n              <Download size={14} className=\"mr-1\" />\r\n              PDF\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => onDelete(requisition.id)}\r\n              className=\"px-2\"\r\n            >\r\n              <Trash2 size={14} />\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"text-center py-8\">\r\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\r\n            <p className=\"mt-2 text-muted-foreground\">Loading requisitions...</p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  if (requisitions.length === 0) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"text-center py-8\">\r\n            <Package className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n            <h3 className=\"text-lg font-medium mb-2\">No requisitions yet</h3>\r\n            <p className=\"text-muted-foreground\">\r\n              Create your first requisition to see it appear here.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center justify-between\">\r\n            <CardTitle>Saved Requisitions ({requisitions.length})</CardTitle>\r\n            <Button variant=\"outline\" size=\"sm\" onClick={onRefresh}>\r\n              Refresh\r\n            </Button>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {isMobile ? (\r\n            <div className=\"space-y-4\">\r\n              {paginatedItems.map(requisition => (\r\n                <RequisitionCard key={requisition.id} requisition={requisition} />\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"overflow-x-auto\">\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead>Title</TableHead>\r\n                    <TableHead>Number</TableHead>\r\n                    <TableHead>Date</TableHead>\r\n                    <TableHead>Items</TableHead>\r\n                    <TableHead>Total Qty</TableHead>\r\n                    <TableHead>Status</TableHead>\r\n                    <TableHead>Actions</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n                <TableBody>\r\n                  {paginatedItems.map(requisition => {\r\n                    const totalQuantity = requisition.items.reduce((sum, item) => sum + item.quantity, 0);\r\n                    const urgentItems = requisition.items.filter(item => item.urgentItem).length;\r\n\r\n                    return (\r\n                      <TableRow key={requisition.id}>\r\n                        <TableCell>\r\n                          <div>\r\n                            <div className=\"font-medium\">{requisition.title}</div>\r\n                            {urgentItems > 0 && (\r\n                              <div className=\"flex items-center gap-1 text-orange-600 text-xs mt-1\">\r\n                                <AlertTriangle size={10} />\r\n                                {urgentItems} urgent\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </TableCell>\r\n                        <TableCell className=\"font-mono text-sm\">\r\n                          {requisition.requisitionNumber}\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          {format(requisition.createdAt, 'MMM d, yyyy')}\r\n                        </TableCell>\r\n                        <TableCell>{requisition.items.length}</TableCell>\r\n                        <TableCell>{formatNumber(totalQuantity)}</TableCell>\r\n                        <TableCell>\r\n                          <Badge className={cn('text-xs', getStatusColor(requisition.status))}>\r\n                            {requisition.status}\r\n                          </Badge>\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          <div className=\"flex gap-1\">\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              onClick={() => setSelectedRequisition(requisition)}\r\n                            >\r\n                              <Eye size={14} />\r\n                            </Button>\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              onClick={() => generateRequisitionPDF(requisition)}\r\n                            >\r\n                              <Download size={14} />\r\n                            </Button>\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              onClick={() => onDelete(requisition.id)}\r\n                            >\r\n                              <Trash2 size={14} />\r\n                            </Button>\r\n                          </div>\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    );\r\n                  })}\r\n                </TableBody>\r\n              </Table>\r\n            </div>\r\n          )}\r\n\r\n          {totalPages > 1 && (\r\n            <div className=\"mt-4\">\r\n              <Pagination>\r\n                <PaginationContent>\r\n                  <PaginationItem>\r\n                    <PaginationPrevious\r\n                      onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\r\n                      className={currentPage === 1 ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                    />\r\n                  </PaginationItem>\r\n                  {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (\r\n                    <PaginationItem key={page}>\r\n                      <PaginationLink\r\n                        onClick={() => setCurrentPage(page)}\r\n                        isActive={currentPage === page}\r\n                        className=\"cursor-pointer\"\r\n                      >\r\n                        {page}\r\n                      </PaginationLink>\r\n                    </PaginationItem>\r\n                  ))}\r\n                  <PaginationItem>\r\n                    <PaginationNext\r\n                      onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\r\n                      className={currentPage === totalPages ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                    />\r\n                  </PaginationItem>\r\n                </PaginationContent>\r\n              </Pagination>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Requisition Detail Modal */}\r\n      {selectedRequisition && (\r\n        <Card className=\"fixed inset-4 z-50 overflow-auto bg-background border shadow-lg\">\r\n          <CardHeader>\r\n            <div className=\"flex items-start justify-between\">\r\n              <div>\r\n                <CardTitle>{selectedRequisition.title}</CardTitle>\r\n                <p className=\"text-sm text-muted-foreground mt-1\">\r\n                  {selectedRequisition.requisitionNumber} • {format(selectedRequisition.createdAt, 'PPP')}\r\n                </p>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Badge className={cn('text-xs', getStatusColor(selectedRequisition.status))}>\r\n                  {selectedRequisition.status}\r\n                </Badge>\r\n                <Button variant=\"outline\" size=\"sm\" onClick={() => setSelectedRequisition(null)}>\r\n                  Close\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-4\">\r\n              {selectedRequisition.notes && (\r\n                <div>\r\n                  <h4 className=\"font-medium mb-2\">Notes:</h4>\r\n                  <p className=\"text-sm text-muted-foreground\">{selectedRequisition.notes}</p>\r\n                </div>\r\n              )}\r\n\r\n              <div>\r\n                <h4 className=\"font-medium mb-2\">Items ({selectedRequisition.items.length}):</h4>\r\n                <div className=\"overflow-x-auto\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Item</TableHead>\r\n                        <TableHead>Quantity</TableHead>\r\n                        <TableHead>Urgent</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {selectedRequisition.items.map((item, index) => (\r\n                        <TableRow key={index} className={item.urgentItem ? \"bg-orange-50\" : \"\"}>\r\n                          <TableCell>{item.productName}</TableCell>\r\n                          <TableCell>{formatNumber(item.quantity)}</TableCell>\r\n                          <TableCell>\r\n                            {item.urgentItem && (\r\n                              <Badge variant=\"destructive\" className=\"text-xs\">\r\n                                <AlertTriangle size={10} className=\"mr-1\" />\r\n                                Urgent\r\n                              </Badge>\r\n                            )}\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SavedRequisitions;"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AAGA,wCAAwC;AACxC,MAAM,yBAAyB,OAAO,aAA0B;IAC9D,qDAAqD;IACrD,MAAM,UAAU,SAAS,aAAa,CAAC;IACvC,QAAQ,KAAK,CAAC,QAAQ,GAAG;IACzB,QAAQ,KAAK,CAAC,IAAI,GAAG;IACrB,QAAQ,KAAK,CAAC,KAAK,GAAG;IACtB,QAAQ,KAAK,CAAC,OAAO,GAAG;IACxB,QAAQ,KAAK,CAAC,eAAe,GAAG;IAChC,QAAQ,KAAK,CAAC,UAAU,GAAG;IAE3B,MAAM,aAAa,YAAY,KAAK,CAAC,MAAM,CAAC,CAAA,OAAQ,KAAK,QAAQ,GAAG;IACpE,MAAM,gBAAgB,WAAW,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,QAAQ,EAAE;IAC5E,MAAM,cAAc,WAAW,MAAM,CAAC,CAAA,OAAQ,KAAK,UAAU,EAAE,MAAM;IAErE,QAAQ,SAAS,GAAG,CAAC;;;;;;oCAMa,EAAE,aAAa;gCACnB,EAAE,IAAA,kKAAM,EAAC,YAAY,SAAS,EAAE,OAAO;yCAC9B,EAAE,YAAY,iBAAiB,CAAC;iCACxC,EAAE,YAAY,KAAK,CAAC;kCACnB,EAAE,YAAY,MAAM,CAAC,WAAW,GAAG;;;IAGjE,EAAE,WAAW,MAAM,GAAG,IAAI,CAAC;;;;;;;;;;;;UAYrB,EAAE,WAAW,GAAG,CAAC,CAAC,MAAM,QAAU,CAAC;uBACtB,EAAE,KAAK,UAAU,GAAG,+BAA+B,GAAG;gEACb,EAAE,QAAQ,EAAE;gEACZ,EAAE,KAAK,WAAW,CAAC;gEACnB,EAAE,KAAK,KAAK,CAAC,KAAK,QAAQ,EAAE,cAAc,GAAG;gEAC7C,EAAE,KAAK,UAAU,GAAG,QAAQ,KAAK;;;UAGvF,CAAC,EAAE,IAAI,CAAC,IAAI;;;;;;yCAMmB,EAAE,WAAW,MAAM,CAAC;4CACjB,EAAE,cAAc,cAAc,GAAG;0CACnC,EAAE,YAAY;;IAEpD,CAAC,GAAG,CAAC;;IAEL,CAAC,CAAC;;IAEF,EAAE,YAAY,KAAK,GAAG,CAAC;;;iFAGsD,EAAE,YAAY,KAAK,CAAC;;IAEjG,CAAC,GAAG,GAAG;;;;;;;;;;;;;;EAcT,CAAC;IAED,SAAS,IAAI,CAAC,WAAW,CAAC;IAE1B,IAAI;QACF,MAAM,EAAE,iBAAiB,EAAE,GAAG;QAC9B,MAAM,kBAAkB,SAAS;YAC/B,UAAU,CAAC,YAAY,EAAE,YAAY,iBAAiB,CAAC,IAAI,CAAC;YAC5D,aAAa;YACb,QAAQ;YACR,SAAS;gBAAE,KAAK;gBAAI,OAAO;gBAAI,QAAQ;gBAAI,MAAM;YAAG;QACtD;IACF,SAAU;QACR,SAAS,IAAI,CAAC,WAAW,CAAC;IAC5B;AACF;AAUA,MAAM,oBAAoB,CAAC,EACzB,YAAY,EACZ,SAAS,EACT,SAAS,EACT,QAAQ,EACR,eAAe,oBAAoB,EACZ;;IACvB,MAAM,WAAW,IAAA,gJAAW;IAC5B,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,yKAAQ,EAAqB;IAEnF,MAAM,EACJ,WAAW,EACX,cAAc,EACd,cAAc,EACd,UAAU,EACX,GAAG,IAAA,iJAAa,EAAC;QAAE,OAAO;QAAc,cAAc;IAAG;IAE1D,MAAM,iBAAiB,CAAC;QACtB,OAAQ;YACN,KAAK;gBAAS,OAAO;YACrB,KAAK;gBAAa,OAAO;YACzB,KAAK;gBAAY,OAAO;YACxB,KAAK;gBAAa,OAAO;YACzB;gBAAS,OAAO;QAClB;IACF;IAEA,MAAM,eAAe,CAAC;QACpB,OAAO,KAAK,KAAK,CAAC,KAAK,cAAc;IACvC;IAEA,MAAM,yBAAyB,OAAO;QACpC,IAAI;YACF,QAAQ,GAAG,CAAC,4CAA4C,YAAY,iBAAiB;YAErF,4CAA4C;YAC5C,MAAM,uBAAuB,aAAa;YAC1C,QAAQ,GAAG,CAAC;QAEd,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B;YACxC,QAAQ,KAAK,CAAC,kBAAkB,MAAM,OAAO;YAC7C,QAAQ,KAAK,CAAC,gBAAgB,MAAM,KAAK;YAEzC,mCAAmC;YACnC,MAAM,CAAC,wBAAwB,EAAE,MAAM,OAAO,IAAI,0BAA0B;QAC9E;IACF;IAEA,MAAM,kBAAkB,CAAC,EAAE,WAAW,EAAgC;QACpE,MAAM,gBAAgB,YAAY,KAAK,CAAC,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,QAAQ,EAAE;QACnF,MAAM,cAAc,YAAY,KAAK,CAAC,MAAM,CAAC,CAAA,OAAQ,KAAK,UAAU,EAAE,MAAM;QAE5E,qBACE,6LAAC,2IAAI;YAAC,WAAU;;8BACd,6LAAC,iJAAU;oBAAC,WAAU;8BACpB,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;;kDACC,6LAAC,gJAAS;wCAAC,WAAU;kDAAuB,YAAY,KAAK;;;;;;kDAC7D,6LAAC;wCAAE,WAAU;;4CACV,YAAY,iBAAiB;4CAAC;4CAAI,IAAA,kKAAM,EAAC,YAAY,SAAS,EAAE;;;;;;;;;;;;;0CAGrE,6LAAC,6IAAK;gCAAC,WAAW,IAAA,4HAAE,EAAC,WAAW,eAAe,YAAY,MAAM;0CAC9D,YAAY,MAAM;;;;;;;;;;;;;;;;;8BAIzB,6LAAC,kJAAW;oBAAC,WAAU;;sCACrB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAK,WAAU;sDAAwB;;;;;;sDACxC,6LAAC;sDAAM,YAAY,KAAK,CAAC,MAAM;;;;;;;;;;;;8CAEjC,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAK,WAAU;sDAAwB;;;;;;sDACxC,6LAAC;sDAAM,aAAa;;;;;;;;;;;;gCAErB,cAAc,mBACb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAK,WAAU;;8DACd,6LAAC,4OAAa;oDAAC,MAAM;;;;;;gDAAM;;;;;;;sDAG7B,6LAAC;sDAAM;;;;;;;;;;;;;;;;;;sCAKb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,+IAAM;oCACL,SAAQ;oCACR,MAAK;oCACL,SAAS,IAAM,uBAAuB;oCACtC,WAAU;;sDAEV,6LAAC,0MAAG;4CAAC,MAAM;4CAAI,WAAU;;;;;;wCAAS;;;;;;;8CAGpC,6LAAC,+IAAM;oCACL,SAAQ;oCACR,MAAK;oCACL,SAAS,IAAM,uBAAuB;oCACtC,WAAU;;sDAEV,6LAAC,yNAAQ;4CAAC,MAAM;4CAAI,WAAU;;;;;;wCAAS;;;;;;;8CAGzC,6LAAC,+IAAM;oCACL,SAAQ;oCACR,MAAK;oCACL,SAAS,IAAM,SAAS,YAAY,EAAE;oCACtC,WAAU;8CAEV,cAAA,6LAAC,uNAAM;wCAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAM1B;IAEA,IAAI,WAAW;QACb,qBACE,6LAAC,2IAAI;sBACH,cAAA,6LAAC,kJAAW;gBAAC,WAAU;0BACrB,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;;;;;sCACf,6LAAC;4BAAE,WAAU;sCAA6B;;;;;;;;;;;;;;;;;;;;;;IAKpD;IAEA,IAAI,aAAa,MAAM,KAAK,GAAG;QAC7B,qBACE,6LAAC,2IAAI;sBACH,cAAA,6LAAC,kJAAW;gBAAC,WAAU;0BACrB,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,sNAAO;4BAAC,WAAU;;;;;;sCACnB,6LAAC;4BAAG,WAAU;sCAA2B;;;;;;sCACzC,6LAAC;4BAAE,WAAU;sCAAwB;;;;;;;;;;;;;;;;;;;;;;IAO/C;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,2IAAI;;kCACH,6LAAC,iJAAU;kCACT,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,gJAAS;;wCAAC;wCAAqB,aAAa,MAAM;wCAAC;;;;;;;8CACpD,6LAAC,+IAAM;oCAAC,SAAQ;oCAAU,MAAK;oCAAK,SAAS;8CAAW;;;;;;;;;;;;;;;;;kCAK5D,6LAAC,kJAAW;;4BACT,yBACC,6LAAC;gCAAI,WAAU;0CACZ,eAAe,GAAG,CAAC,CAAA,4BAClB,6LAAC;wCAAqC,aAAa;uCAA7B,YAAY,EAAE;;;;;;;;;yFAIxC,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,6IAAK;;sDACJ,6LAAC,mJAAW;sDACV,cAAA,6LAAC,gJAAQ;;kEACP,6LAAC,iJAAS;kEAAC;;;;;;kEACX,6LAAC,iJAAS;kEAAC;;;;;;kEACX,6LAAC,iJAAS;kEAAC;;;;;;kEACX,6LAAC,iJAAS;kEAAC;;;;;;kEACX,6LAAC,iJAAS;kEAAC;;;;;;kEACX,6LAAC,iJAAS;kEAAC;;;;;;kEACX,6LAAC,iJAAS;kEAAC;;;;;;;;;;;;;;;;;sDAGf,6LAAC,iJAAS;sDACP,eAAe,GAAG,CAAC,CAAA;gDAClB,MAAM,gBAAgB,YAAY,KAAK,CAAC,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,QAAQ,EAAE;gDACnF,MAAM,cAAc,YAAY,KAAK,CAAC,MAAM,CAAC,CAAA,OAAQ,KAAK,UAAU,EAAE,MAAM;gDAE5E,qBACE,6LAAC,gJAAQ;;sEACP,6LAAC,iJAAS;sEACR,cAAA,6LAAC;;kFACC,6LAAC;wEAAI,WAAU;kFAAe,YAAY,KAAK;;;;;;oEAC9C,cAAc,mBACb,6LAAC;wEAAI,WAAU;;0FACb,6LAAC,4OAAa;gFAAC,MAAM;;;;;;4EACpB;4EAAY;;;;;;;;;;;;;;;;;;sEAKrB,6LAAC,iJAAS;4DAAC,WAAU;sEAClB,YAAY,iBAAiB;;;;;;sEAEhC,6LAAC,iJAAS;sEACP,IAAA,kKAAM,EAAC,YAAY,SAAS,EAAE;;;;;;sEAEjC,6LAAC,iJAAS;sEAAE,YAAY,KAAK,CAAC,MAAM;;;;;;sEACpC,6LAAC,iJAAS;sEAAE,aAAa;;;;;;sEACzB,6LAAC,iJAAS;sEACR,cAAA,6LAAC,6IAAK;gEAAC,WAAW,IAAA,4HAAE,EAAC,WAAW,eAAe,YAAY,MAAM;0EAC9D,YAAY,MAAM;;;;;;;;;;;sEAGvB,6LAAC,iJAAS;sEACR,cAAA,6LAAC;gEAAI,WAAU;;kFACb,6LAAC,+IAAM;wEACL,SAAQ;wEACR,MAAK;wEACL,SAAS,IAAM,uBAAuB;kFAEtC,cAAA,6LAAC,0MAAG;4EAAC,MAAM;;;;;;;;;;;kFAEb,6LAAC,+IAAM;wEACL,SAAQ;wEACR,MAAK;wEACL,SAAS,IAAM,uBAAuB;kFAEtC,cAAA,6LAAC,yNAAQ;4EAAC,MAAM;;;;;;;;;;;kFAElB,6LAAC,+IAAM;wEACL,SAAQ;wEACR,MAAK;wEACL,SAAS,IAAM,SAAS,YAAY,EAAE;kFAEtC,cAAA,6LAAC,uNAAM;4EAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;mDA9CP,YAAY,EAAE;;;;;4CAoDjC;;;;;;;;;;;;;;;;;4BAMP,aAAa,mBACZ,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,uJAAU;8CACT,cAAA,6LAAC,8JAAiB;;0DAChB,6LAAC,2JAAc;0DACb,cAAA,6LAAC,+JAAkB;oDACjB,SAAS,IAAM,eAAe,KAAK,GAAG,CAAC,GAAG,cAAc;oDACxD,WAAW,gBAAgB,IAAI,mCAAmC;;;;;;;;;;;4CAGrE,MAAM,IAAI,CAAC;gDAAE,QAAQ;4CAAW,GAAG,CAAC,GAAG,IAAM,IAAI,GAAG,GAAG,CAAC,CAAC,qBACxD,6LAAC,2JAAc;8DACb,cAAA,6LAAC,2JAAc;wDACb,SAAS,IAAM,eAAe;wDAC9B,UAAU,gBAAgB;wDAC1B,WAAU;kEAET;;;;;;mDANgB;;;;;0DAUvB,6LAAC,2JAAc;0DACb,cAAA,6LAAC,2JAAc;oDACb,SAAS,IAAM,eAAe,KAAK,GAAG,CAAC,YAAY,cAAc;oDACjE,WAAW,gBAAgB,aAAa,mCAAmC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAW1F,qCACC,6LAAC,2IAAI;gBAAC,WAAU;;kCACd,6LAAC,iJAAU;kCACT,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;;sDACC,6LAAC,gJAAS;sDAAE,oBAAoB,KAAK;;;;;;sDACrC,6LAAC;4CAAE,WAAU;;gDACV,oBAAoB,iBAAiB;gDAAC;gDAAI,IAAA,kKAAM,EAAC,oBAAoB,SAAS,EAAE;;;;;;;;;;;;;8CAGrF,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,6IAAK;4CAAC,WAAW,IAAA,4HAAE,EAAC,WAAW,eAAe,oBAAoB,MAAM;sDACtE,oBAAoB,MAAM;;;;;;sDAE7B,6LAAC,+IAAM;4CAAC,SAAQ;4CAAU,MAAK;4CAAK,SAAS,IAAM,uBAAuB;sDAAO;;;;;;;;;;;;;;;;;;;;;;;kCAMvF,6LAAC,kJAAW;kCACV,cAAA,6LAAC;4BAAI,WAAU;;gCACZ,oBAAoB,KAAK,kBACxB,6LAAC;;sDACC,6LAAC;4CAAG,WAAU;sDAAmB;;;;;;sDACjC,6LAAC;4CAAE,WAAU;sDAAiC,oBAAoB,KAAK;;;;;;;;;;;;8CAI3E,6LAAC;;sDACC,6LAAC;4CAAG,WAAU;;gDAAmB;gDAAQ,oBAAoB,KAAK,CAAC,MAAM;gDAAC;;;;;;;sDAC1E,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC,6IAAK;;kEACJ,6LAAC,mJAAW;kEACV,cAAA,6LAAC,gJAAQ;;8EACP,6LAAC,iJAAS;8EAAC;;;;;;8EACX,6LAAC,iJAAS;8EAAC;;;;;;8EACX,6LAAC,iJAAS;8EAAC;;;;;;;;;;;;;;;;;kEAGf,6LAAC,iJAAS;kEACP,oBAAoB,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,sBACpC,6LAAC,gJAAQ;gEAAa,WAAW,KAAK,UAAU,GAAG,iBAAiB;;kFAClE,6LAAC,iJAAS;kFAAE,KAAK,WAAW;;;;;;kFAC5B,6LAAC,iJAAS;kFAAE,aAAa,KAAK,QAAQ;;;;;;kFACtC,6LAAC,iJAAS;kFACP,KAAK,UAAU,kBACd,6LAAC,6IAAK;4EAAC,SAAQ;4EAAc,WAAU;;8FACrC,6LAAC,4OAAa;oFAAC,MAAM;oFAAI,WAAU;;;;;;gFAAS;;;;;;;;;;;;;+DANrC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuBvC;GA3VM;;QAOa,gJAAW;QAQxB,iJAAa;;;KAfb;uCA6VS"}},
    {"offset": {"line": 7193, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/InventoryPageSkeleton.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Skeleton } from '@/components/ui/skeleton';\r\n\r\nconst InventoryPageSkeleton = () => (\r\n  <div className=\"space-y-6\">\r\n    <div className=\"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\r\n      <div>\r\n        <Skeleton className=\"h-8 w-48 mb-2\" />\r\n        <Skeleton className=\"h-4 w-64\" />\r\n      </div>\r\n      <div className=\"flex items-center gap-2\">\r\n        <Skeleton className=\"h-9 w-9\" />\r\n        <Skeleton className=\"h-9 w-24\" />\r\n        <Skeleton className=\"h-9 w-32\" />\r\n      </div>\r\n    </div>\r\n\r\n    <div className=\"mb-4\">\r\n      <Skeleton className=\"h-10 w-full max-w-md\" />\r\n    </div>\r\n\r\n    <div className=\"mb-6\">\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        {[...Array(4)].map((_, i) => (\r\n          <Skeleton key={i} className=\"h-24\" />\r\n        ))}\r\n      </div>\r\n    </div>\r\n\r\n    <Skeleton className=\"h-64 mb-6\" />\r\n    <Skeleton className=\"h-96\" />\r\n  </div>\r\n);\r\n\r\nexport default InventoryPageSkeleton;"],"names":[],"mappings":";;;;;AACA;;;AAEA,MAAM,wBAAwB,kBAC5B,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;;0CACC,6LAAC,mJAAQ;gCAAC,WAAU;;;;;;0CACpB,6LAAC,mJAAQ;gCAAC,WAAU;;;;;;;;;;;;kCAEtB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,mJAAQ;gCAAC,WAAU;;;;;;0CACpB,6LAAC,mJAAQ;gCAAC,WAAU;;;;;;0CACpB,6LAAC,mJAAQ;gCAAC,WAAU;;;;;;;;;;;;;;;;;;0BAIxB,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,mJAAQ;oBAAC,WAAU;;;;;;;;;;;0BAGtB,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;8BACZ;2BAAI,MAAM;qBAAG,CAAC,GAAG,CAAC,CAAC,GAAG,kBACrB,6LAAC,mJAAQ;4BAAS,WAAU;2BAAb;;;;;;;;;;;;;;;0BAKrB,6LAAC,mJAAQ;gBAAC,WAAU;;;;;;0BACpB,6LAAC,mJAAQ;gBAAC,WAAU;;;;;;;;;;;;KA3BlB;uCA+BS"}},
    {"offset": {"line": 7333, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/InventoryHeader.tsx"],"sourcesContent":["import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Plus, RefreshCw, ListFilter, Search, Truck, FileDown, FileUp, Scale } from 'lucide-react';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\nimport { useProfiles } from '@/contexts/ProfileContext';\r\n\r\ninterface InventoryHeaderProps {\r\n  isLoading: boolean;\r\n  onRefresh: () => Promise<void>;\r\n  onDownloadTemplate: () => void;\r\n  onCSVUpload: () => void;\r\n}\r\n\r\nconst InventoryHeader: React.FC<InventoryHeaderProps> = ({\r\n  isLoading,\r\n  onRefresh,\r\n  onDownloadTemplate,\r\n  onCSVUpload\r\n}) => {\r\n  const navigate = useNavigate();\r\n  const isMobile = useIsMobile();\r\n  const { hasPermission } = useProfiles();\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"flex flex-col gap-3 md:flex-row md:items-center md:justify-between\">\r\n        <div className=\"space-y-1\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <h1 className=\"text-xl md:text-2xl lg:text-3xl font-bold text-sales-dark\">Inventory Overview</h1>\r\n          </div>\r\n          <p className=\"text-sm md:text-base text-muted-foreground\">\r\n            Monitor your inventory health and analyze sales performance\r\n          </p>\r\n        </div>\r\n\r\n        {/* Mobile Action Buttons - Improved Layout */}\r\n        {isMobile ? (\r\n          <div className=\"space-y-3\">\r\n            <div className=\"flex gap-2\">\r\n              {hasPermission('inventory', 'create') && (\r\n                <Button onClick={() => navigate('/inventory/new')} className=\"flex-1 gap-2 min-h-[44px]\">\r\n                  <Plus size={16} /> Add Product\r\n                </Button>\r\n              )}\r\n              <Button\r\n                onClick={onRefresh}\r\n                variant=\"outline\"\r\n                size=\"icon\"\r\n                disabled={isLoading}\r\n                className=\"shrink-0 min-h-[44px] min-w-[44px]\"\r\n              >\r\n                <RefreshCw className={`h-4 w-4 ${isLoading ? 'animate-spin' : ''}`} />\r\n              </Button>\r\n            </div>\r\n            <div className=\"grid grid-cols-2 gap-2\">\r\n              <Button onClick={() => navigate('/products')} variant=\"outline\" className=\"gap-1 text-xs min-h-[40px]\">\r\n                <ListFilter size={14} /> Products\r\n              </Button>\r\n              {hasPermission('inventory', 'view') && (\r\n                <Button onClick={() => navigate('/inventory/carriage-inwards')} variant=\"outline\" className=\"gap-1 text-xs min-h-[40px]\">\r\n                  <Truck size={14} /> Carriage\r\n                </Button>\r\n              )}\r\n            </div>\r\n            {hasPermission('inventory', 'create') && (\r\n              <div className=\"grid grid-cols-2 gap-2\">\r\n                <Button onClick={onDownloadTemplate} variant=\"outline\" className=\"gap-1 text-xs min-h-[40px]\">\r\n                  <FileDown size={14} /> Template\r\n                </Button>\r\n                <Button onClick={onCSVUpload} variant=\"outline\" className=\"gap-1 text-xs min-h-[40px]\">\r\n                  <FileUp size={14} /> Upload\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          // Desktop Action Buttons\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              onClick={onRefresh}\r\n              variant=\"outline\"\r\n              size=\"icon\"\r\n              disabled={isLoading}\r\n              className=\"relative\"\r\n              title=\"Refresh data\"\r\n            >\r\n              <RefreshCw className={`h-4 w-4 ${isLoading ? 'animate-spin' : ''}`} />\r\n              <span className=\"sr-only\">Refresh data</span>\r\n            </Button>\r\n\r\n            {hasPermission('inventory', 'create') && (\r\n              <>\r\n                <Button\r\n                  onClick={onDownloadTemplate}\r\n                  variant=\"outline\"\r\n                  className=\"gap-2\"\r\n                  title=\"Download CSV template\"\r\n                >\r\n                  <FileDown size={16} /> CSV Template\r\n                </Button>\r\n                <Button\r\n                  onClick={onCSVUpload}\r\n                  variant=\"outline\"\r\n                  className=\"gap-2\"\r\n                  title=\"Upload products via CSV\"\r\n                >\r\n                  <FileUp size={16} /> Upload CSV\r\n                </Button>\r\n              </>\r\n            )}\r\n            {hasPermission('inventory', 'view') && (\r\n              <Button onClick={() => navigate('/inventory/carriage-inwards')} variant=\"outline\" className=\"gap-2\">\r\n                <Truck size={16} /> Carriage Inwards\r\n              </Button>\r\n            )}\r\n            {hasPermission('inventory', 'stock_adjustment') && (\r\n              <Button onClick={() => navigate('/inventory/reconcile')} variant=\"outline\" className=\"gap-2\" title=\"Reconcile stock discrepancies\">\r\n                <Scale size={16} /> Reconcile\r\n              </Button>\r\n            )}\r\n            <Button onClick={() => navigate('/products')} variant=\"outline\" className=\"gap-2\">\r\n              <ListFilter size={16} /> All Products\r\n            </Button>\r\n            {hasPermission('inventory', 'create') && (\r\n              <Button onClick={() => navigate('/inventory/new')} className=\"gap-2\">\r\n                <Plus size={16} /> Add Product\r\n              </Button>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InventoryHeader;"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;;;AASA,MAAM,kBAAkD,CAAC,EACvD,SAAS,EACT,SAAS,EACT,kBAAkB,EAClB,WAAW,EACZ;;IACC,MAAM,WAAW,IAAA,kLAAW;IAC5B,MAAM,WAAW,IAAA,gJAAW;IAC5B,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,oJAAW;IAErC,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC;gCAAG,WAAU;0CAA4D;;;;;;;;;;;sCAE5E,6LAAC;4BAAE,WAAU;sCAA6C;;;;;;;;;;;;gBAM3D,yBACC,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;;gCACZ,cAAc,aAAa,2BAC1B,6LAAC,+IAAM;oCAAC,SAAS,IAAM,SAAS;oCAAmB,WAAU;;sDAC3D,6LAAC,6MAAI;4CAAC,MAAM;;;;;;wCAAM;;;;;;;8CAGtB,6LAAC,+IAAM;oCACL,SAAS;oCACT,SAAQ;oCACR,MAAK;oCACL,UAAU;oCACV,WAAU;8CAEV,cAAA,6LAAC,gOAAS;wCAAC,WAAW,CAAC,QAAQ,EAAE,YAAY,iBAAiB,IAAI;;;;;;;;;;;;;;;;;sCAGtE,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,+IAAM;oCAAC,SAAS,IAAM,SAAS;oCAAc,SAAQ;oCAAU,WAAU;;sDACxE,6LAAC,mOAAU;4CAAC,MAAM;;;;;;wCAAM;;;;;;;gCAEzB,cAAc,aAAa,yBAC1B,6LAAC,+IAAM;oCAAC,SAAS,IAAM,SAAS;oCAAgC,SAAQ;oCAAU,WAAU;;sDAC1F,6LAAC,gNAAK;4CAAC,MAAM;;;;;;wCAAM;;;;;;;;;;;;;wBAIxB,cAAc,aAAa,2BAC1B,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,+IAAM;oCAAC,SAAS;oCAAoB,SAAQ;oCAAU,WAAU;;sDAC/D,6LAAC,6NAAQ;4CAAC,MAAM;;;;;;wCAAM;;;;;;;8CAExB,6LAAC,+IAAM;oCAAC,SAAS;oCAAa,SAAQ;oCAAU,WAAU;;sDACxD,6LAAC,uNAAM;4CAAC,MAAM;;;;;;wCAAM;;;;;;;;;;;;;;;;;;+DAM5B,yBAAyB;8BACzB,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,+IAAM;4BACL,SAAS;4BACT,SAAQ;4BACR,MAAK;4BACL,UAAU;4BACV,WAAU;4BACV,OAAM;;8CAEN,6LAAC,gOAAS;oCAAC,WAAW,CAAC,QAAQ,EAAE,YAAY,iBAAiB,IAAI;;;;;;8CAClE,6LAAC;oCAAK,WAAU;8CAAU;;;;;;;;;;;;wBAG3B,cAAc,aAAa,2BAC1B;;8CACE,6LAAC,+IAAM;oCACL,SAAS;oCACT,SAAQ;oCACR,WAAU;oCACV,OAAM;;sDAEN,6LAAC,6NAAQ;4CAAC,MAAM;;;;;;wCAAM;;;;;;;8CAExB,6LAAC,+IAAM;oCACL,SAAS;oCACT,SAAQ;oCACR,WAAU;oCACV,OAAM;;sDAEN,6LAAC,uNAAM;4CAAC,MAAM;;;;;;wCAAM;;;;;;;;;wBAIzB,cAAc,aAAa,yBAC1B,6LAAC,+IAAM;4BAAC,SAAS,IAAM,SAAS;4BAAgC,SAAQ;4BAAU,WAAU;;8CAC1F,6LAAC,gNAAK;oCAAC,MAAM;;;;;;gCAAM;;;;;;;wBAGtB,cAAc,aAAa,qCAC1B,6LAAC,+IAAM;4BAAC,SAAS,IAAM,SAAS;4BAAyB,SAAQ;4BAAU,WAAU;4BAAQ,OAAM;;8CACjG,6LAAC,gNAAK;oCAAC,MAAM;;;;;;gCAAM;;;;;;;sCAGvB,6LAAC,+IAAM;4BAAC,SAAS,IAAM,SAAS;4BAAc,SAAQ;4BAAU,WAAU;;8CACxE,6LAAC,mOAAU;oCAAC,MAAM;;;;;;gCAAM;;;;;;;wBAEzB,cAAc,aAAa,2BAC1B,6LAAC,+IAAM;4BAAC,SAAS,IAAM,SAAS;4BAAmB,WAAU;;8CAC3D,6LAAC,6MAAI;oCAAC,MAAM;;;;;;gCAAM;;;;;;;;;;;;;;;;;;;;;;;;AAQlC;GAxHM;;QAMa,kLAAW;QACX,gJAAW;QACF,oJAAW;;;KARjC;uCA0HS"}},
    {"offset": {"line": 7734, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/InventorySearchBar.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Search } from 'lucide-react';\r\nimport { Product, ProductFilters } from '@/types';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\n\r\ninterface InventorySearchBarProps {\r\n    filters: ProductFilters;\r\n    setFilters: (filters: ProductFilters) => void;\r\n    products: Product[];\r\n    onSearchChange?: (e: React.ChangeEvent<HTMLInputElement>) => void;\r\n    onSearchSubmit?: (e: React.ChangeEvent<HTMLInputElement>) => void;\r\n    onSearchFocus?: () => void;\r\n}\r\n\r\nconst InventorySearchBar: React.FC<InventorySearchBarProps> = ({\r\n    filters,\r\n    setFilters,\r\n    products,\r\n    onSearchChange,\r\n    onSearchSubmit,\r\n    onSearchFocus\r\n}) => {\r\n    const isMobile = useIsMobile();\r\n    // Local state for the input field to allow smooth typing\r\n    const [localSearch, setLocalSearch] = useState(filters.search || '');\r\n\r\n    // Sync local state when external filters change\r\n    useEffect(() => {\r\n        const searchVal = filters.search || '';\r\n        setLocalSearch(searchVal);\r\n    }, [filters.search]);\r\n\r\n    // Handle typing - update local state and trigger suggestions (no database fetch)\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        setLocalSearch(e.target.value);\r\n        // Trigger live search for suggestions only\r\n        if (onSearchChange) {\r\n            onSearchChange(e);\r\n        }\r\n    };\r\n\r\n    // Submit on Enter key - Triggers database fetch\r\n    const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n        if (e.key === 'Enter') {\r\n            e.preventDefault();\r\n\r\n            if (onSearchSubmit) {\r\n                const fakeEvent = {\r\n                    target: { value: localSearch }\r\n                } as React.ChangeEvent<HTMLInputElement>;\r\n                onSearchSubmit(fakeEvent);\r\n            } else {\r\n                // Apply the filter to the table (DB Level)\r\n                setFilters({\r\n                    ...filters,\r\n                    search: localSearch\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    // Submit on Blur - Triggers database fetch\r\n    const handleBlur = () => {\r\n        if (localSearch !== filters.search) {\r\n            if (onSearchSubmit) {\r\n                const fakeEvent = {\r\n                    target: { value: localSearch }\r\n                } as React.ChangeEvent<HTMLInputElement>;\r\n                onSearchSubmit(fakeEvent);\r\n            } else {\r\n                setFilters({\r\n                    ...filters,\r\n                    search: localSearch\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"relative w-full\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4\" />\r\n            <Input\r\n                placeholder=\"Search products...\"\r\n                value={localSearch}\r\n                onChange={handleChange}\r\n                onKeyDown={handleKeyDown}\r\n                onBlur={handleBlur}\r\n                onFocus={onSearchFocus}\r\n                className=\"pl-9 w-full bg-white transition-all duration-200 focus:shadow-md\"\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default InventorySearchBar;\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;;AAWA,MAAM,qBAAwD,CAAC,EAC3D,OAAO,EACP,UAAU,EACV,QAAQ,EACR,cAAc,EACd,cAAc,EACd,aAAa,EAChB;;IACG,MAAM,WAAW,IAAA,gJAAW;IAC5B,yDAAyD;IACzD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC,QAAQ,MAAM,IAAI;IAEjE,gDAAgD;IAChD,IAAA,0KAAS;wCAAC;YACN,MAAM,YAAY,QAAQ,MAAM,IAAI;YACpC,eAAe;QACnB;uCAAG;QAAC,QAAQ,MAAM;KAAC;IAEnB,iFAAiF;IACjF,MAAM,eAAe,CAAC;QAClB,eAAe,EAAE,MAAM,CAAC,KAAK;QAC7B,2CAA2C;QAC3C,IAAI,gBAAgB;YAChB,eAAe;QACnB;IACJ;IAEA,gDAAgD;IAChD,MAAM,gBAAgB,CAAC;QACnB,IAAI,EAAE,GAAG,KAAK,SAAS;YACnB,EAAE,cAAc;YAEhB,IAAI,gBAAgB;gBAChB,MAAM,YAAY;oBACd,QAAQ;wBAAE,OAAO;oBAAY;gBACjC;gBACA,eAAe;YACnB,OAAO;gBACH,2CAA2C;gBAC3C,WAAW;oBACP,GAAG,OAAO;oBACV,QAAQ;gBACZ;YACJ;QACJ;IACJ;IAEA,2CAA2C;IAC3C,MAAM,aAAa;QACf,IAAI,gBAAgB,QAAQ,MAAM,EAAE;YAChC,IAAI,gBAAgB;gBAChB,MAAM,YAAY;oBACd,QAAQ;wBAAE,OAAO;oBAAY;gBACjC;gBACA,eAAe;YACnB,OAAO;gBACH,WAAW;oBACP,GAAG,OAAO;oBACV,QAAQ;gBACZ;YACJ;QACJ;IACJ;IAEA,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC,mNAAM;gBAAC,WAAU;;;;;;0BAClB,6LAAC,6IAAK;gBACF,aAAY;gBACZ,OAAO;gBACP,UAAU;gBACV,WAAW;gBACX,QAAQ;gBACR,SAAS;gBACT,WAAU;;;;;;;;;;;;AAI1B;GA9EM;;QAQe,gJAAW;;;KAR1B;uCAgFS"}},
    {"offset": {"line": 7855, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/TopSellingProductsTable.tsx"],"sourcesContent":["import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport { Button } from '@/components/ui/button';\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from '@/components/ui/dropdown-menu';\r\nimport { FileDown, ChevronDown } from 'lucide-react';\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\nimport { TopSellingItem } from '@/hooks/useInventoryData';\r\nimport { formatNumber, formatCashCurrency } from '@/lib/utils';\r\nimport { useBusinessSettings } from '@/hooks/useBusinessSettings';\r\nimport { useFinancialVisibility } from '@/hooks/useFinancialVisibility';\r\nimport { usePagination } from '@/hooks/usePagination';\r\nimport SalesTablePagination from '@/components/sales/SalesTablePagination';\r\nimport jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\n\r\ninterface TopSellingProductsTableProps {\r\n  products: TopSellingItem[];\r\n  onExport?: () => void;\r\n  period?: string;\r\n}\r\n\r\nconst TopSellingProductsTable: React.FC<TopSellingProductsTableProps> = ({\r\n  products,\r\n  onExport,\r\n  period = 'this-month'\r\n}) => {\r\n  const { settings } = useBusinessSettings();\r\n  const { canViewCostPrice, canViewProfit, canViewSellingPrice } = useFinancialVisibility();\r\n  const navigate = useNavigate();\r\n\r\n  // Pagination\r\n  const {\r\n    currentPage,\r\n    setCurrentPage,\r\n    paginatedItems,\r\n    totalPages\r\n  } = usePagination<TopSellingItem>({\r\n    items: products,\r\n    itemsPerPage: 10\r\n  });\r\n\r\n  const handleCSVExport = () => {\r\n    const headers = [\r\n      'Rank',\r\n      'Item Description',\r\n      'Quantity Sold',\r\n      'Average Price',\r\n      'Total Amount',\r\n      'Average Cost',\r\n      'Total Cost',\r\n      'Total Profit'\r\n    ];\r\n\r\n    const rows = products.map((item, index) => [\r\n      (index + 1).toString(),\r\n      item.description,\r\n      item.totalQuantity.toString(),\r\n      canViewSellingPrice ? item.averagePrice.toFixed(2) : 'RESTRICTED',\r\n      canViewSellingPrice ? item.totalAmount.toFixed(2) : 'RESTRICTED',\r\n      canViewCostPrice ? (item.averageCost || 0).toFixed(2) : 'RESTRICTED',\r\n      canViewCostPrice ? item.totalCost.toFixed(2) : 'RESTRICTED',\r\n      canViewProfit ? item.totalProfit.toFixed(2) : 'RESTRICTED'\r\n    ]);\r\n\r\n    const csvContent = [\r\n      headers.join(','),\r\n      ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv' });\r\n    const url = window.URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    const periodLabel = period.replace('-', ' ').replace(/\\b\\w/g, l => l.toUpperCase());\r\n    link.download = `top-selling-items-${periodLabel.toLowerCase().replace(/\\s+/g, '-')}-${new Date().toISOString().split('T')[0]}.csv`;\r\n    link.click();\r\n    window.URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const handlePDFExport = () => {\r\n    const doc = new jsPDF('landscape');\r\n    const periodLabel = period.replace('-', ' ').replace(/\\b\\w/g, l => l.toUpperCase());\r\n\r\n    // Add title\r\n    doc.setFontSize(18);\r\n    doc.setFont(undefined, 'bold');\r\n    doc.text('Top Selling Items Report', 14, 22);\r\n\r\n    // Add period and date\r\n    doc.setFontSize(12);\r\n    doc.setFont(undefined, 'normal');\r\n    doc.text(`Period: ${periodLabel}`, 14, 32);\r\n    doc.text(`Generated: ${new Date().toLocaleDateString()}`, 14, 40);\r\n\r\n    // Prepare table data\r\n    const tableData = products.map((item, index) => [\r\n      (index + 1).toString(),\r\n      item.description.length > 50 ? item.description.substring(0, 47) + '...' : item.description,\r\n      item.totalQuantity.toString(),\r\n      canViewSellingPrice ? `${settings.currency} ${formatNumber(item.averagePrice)}` : 'RESTRICTED',\r\n      canViewSellingPrice ? `${settings.currency} ${formatNumber(item.totalAmount)}` : 'RESTRICTED',\r\n      canViewCostPrice ? `${settings.currency} ${formatNumber(item.averageCost || 0)}` : 'RESTRICTED',\r\n      canViewCostPrice ? `${settings.currency} ${formatNumber(item.totalCost)}` : 'RESTRICTED',\r\n      canViewProfit ? `${settings.currency} ${formatNumber(item.totalProfit)}` : 'RESTRICTED'\r\n    ]);\r\n\r\n    // Add table\r\n    autoTable(doc, {\r\n      head: [['Rank', 'Item Description', 'Qty Sold', 'Avg Price', 'Total Amount', 'Avg Cost', 'Total Cost', 'Profit']],\r\n      body: tableData,\r\n      startY: 50,\r\n      styles: { fontSize: 9 },\r\n      headStyles: { fillColor: [66, 139, 202] },\r\n      columnStyles: {\r\n        0: { halign: 'center', cellWidth: 15 },\r\n        1: { cellWidth: 80 },\r\n        2: { halign: 'center', cellWidth: 25 },\r\n        3: { halign: 'right', cellWidth: 30 },\r\n        4: { halign: 'right', cellWidth: 35 },\r\n        5: { halign: 'right', cellWidth: 30 },\r\n        6: { halign: 'right', cellWidth: 30 },\r\n        7: { halign: 'right', cellWidth: 30 }\r\n      }\r\n    });\r\n\r\n    // Save the PDF\r\n    doc.save(`top-selling-items-${periodLabel.toLowerCase().replace(/\\s+/g, '-')}-${new Date().toISOString().split('T')[0]}.pdf`);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Export Dropdown */}\r\n      <div className=\"flex justify-end\">\r\n        <DropdownMenu>\r\n          <DropdownMenuTrigger asChild>\r\n            <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\r\n              <FileDown size={16} />\r\n              Export\r\n              <ChevronDown size={16} />\r\n            </Button>\r\n          </DropdownMenuTrigger>\r\n          <DropdownMenuContent align=\"end\">\r\n            <DropdownMenuItem onClick={onExport || handleCSVExport}>\r\n              Export as CSV\r\n            </DropdownMenuItem>\r\n            <DropdownMenuItem onClick={handlePDFExport}>\r\n              Export as PDF\r\n            </DropdownMenuItem>\r\n          </DropdownMenuContent>\r\n        </DropdownMenu>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <TooltipProvider>\r\n        <div className=\"overflow-x-auto rounded-md border\">\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow className=\"bg-muted/50\">\r\n                <TableHead className=\"w-[60px] min-w-[60px]\">Rank</TableHead>\r\n                <TableHead className=\"min-w-[200px]\">Item Description</TableHead>\r\n                <TableHead className=\"w-[100px] min-w-[100px] text-right\">Qty Sold</TableHead>\r\n                {canViewSellingPrice && (\r\n                  <>\r\n                    <TableHead className=\"w-[120px] min-w-[120px] text-right\">Avg Price</TableHead>\r\n                    <TableHead className=\"w-[120px] min-w-[120px] text-right\">Total Amount</TableHead>\r\n                  </>\r\n                )}\r\n                {canViewCostPrice && (\r\n                  <>\r\n                    <TableHead className=\"w-[120px] min-w-[120px] text-right\">Avg Cost</TableHead>\r\n                    <TableHead className=\"w-[120px] min-w-[120px] text-right\">Total Cost</TableHead>\r\n                  </>\r\n                )}\r\n                {canViewProfit && (\r\n                  <TableHead className=\"w-[120px] min-w-[120px] text-right\">Profit</TableHead>\r\n                )}\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {products.length === 0 ? (\r\n                <TableRow>\r\n                  <TableCell colSpan={8} className=\"text-center py-8 text-muted-foreground\">\r\n                    No sales data for the selected period\r\n                  </TableCell>\r\n                </TableRow>\r\n              ) : (\r\n                paginatedItems.map((item, index) => {\r\n                  const actualRank = (currentPage - 1) * 10 + index + 1;\r\n                  // Get the first product ID if available\r\n                  const productId = item.productIds && item.productIds.length > 0 ? item.productIds[0] : null;\r\n\r\n                  return (\r\n                    <TableRow\r\n                      key={`${item.description}-${index}`}\r\n                      className=\"hover:bg-gray-50 cursor-pointer\"\r\n                      onClick={() => productId && navigate(`/inventory/${productId}`)}\r\n                    >\r\n                      <TableCell className=\"text-center\">\r\n                        <span className=\"text-xs bg-primary/10 text-primary rounded-full w-6 h-6 inline-flex items-center justify-center font-bold\">\r\n                          {actualRank}\r\n                        </span>\r\n                      </TableCell>\r\n                      <TableCell className=\"font-medium\">\r\n                        <Tooltip>\r\n                          <TooltipTrigger asChild>\r\n                            <span className=\"cursor-help\">{item.description}</span>\r\n                          </TooltipTrigger>\r\n                          <TooltipContent side=\"top\" className=\"max-w-xs\">\r\n                            <p className=\"font-bold break-words whitespace-normal\">{item.description}</p>\r\n                          </TooltipContent>\r\n                        </Tooltip>\r\n                      </TableCell>\r\n                      <TableCell className=\"text-right font-medium text-green-600\">\r\n                        {item.totalQuantity % 1 === 0 ? item.totalQuantity : item.totalQuantity.toFixed(2)}\r\n                      </TableCell>\r\n                      {canViewSellingPrice && (\r\n                        <>\r\n                          <TableCell className=\"text-right font-medium tabular-nums\">\r\n                            {formatCashCurrency(item.averagePrice, settings.currency)}\r\n                          </TableCell>\r\n                          <TableCell className=\"text-right font-medium tabular-nums\">\r\n                            {formatCashCurrency(item.totalAmount, settings.currency)}\r\n                          </TableCell>\r\n                        </>\r\n                      )}\r\n                      {canViewCostPrice && (\r\n                        <>\r\n                          <TableCell className=\"text-right font-medium tabular-nums\">\r\n                            {formatCashCurrency(item.averageCost || 0, settings.currency)}\r\n                          </TableCell>\r\n                          <TableCell className=\"text-right font-medium tabular-nums\">\r\n                            {formatCashCurrency(item.totalCost, settings.currency)}\r\n                          </TableCell>\r\n                        </>\r\n                      )}\r\n                      {canViewProfit && (\r\n                        <TableCell className=\"text-right font-medium tabular-nums\">\r\n                          <span className={item.totalProfit >= 0 ? 'text-green-600' : 'text-red-600'}>\r\n                            {formatCashCurrency(item.totalProfit, settings.currency)}\r\n                          </span>\r\n                        </TableCell>\r\n                      )}\r\n                    </TableRow>\r\n                  );\r\n                })\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n        </div>\r\n      </TooltipProvider>\r\n\r\n      {/* Pagination Controls */}\r\n      {products.length > 0 && (\r\n        <div className=\"mt-4\">\r\n          <SalesTablePagination\r\n            currentPage={currentPage}\r\n            totalPages={totalPages}\r\n            onPageChange={setCurrentPage}\r\n          />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TopSellingProductsTable;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8408, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/TopSellingProductsCard.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport TopSellingProductsTable from '@/components/inventory/TopSellingProductsTable';\r\nimport { TopSellingItem } from '@/hooks/useInventoryData';\r\n\r\ninterface TopSellingProductsCardProps {\r\n  topSellingProducts: TopSellingItem[];\r\n  period: 'today' | 'yesterday' | 'this-week' | 'last-week' | 'this-month' | 'last-month' | 'all-time';\r\n  onPeriodChange: (period: 'today' | 'yesterday' | 'this-week' | 'last-week' | 'this-month' | 'last-month' | 'all-time') => void;\r\n}\r\n\r\nconst TopSellingProductsCard: React.FC<TopSellingProductsCardProps> = ({\r\n  topSellingProducts,\r\n  period,\r\n  onPeriodChange\r\n}) => {\r\n  return (\r\n    <Card className=\"shadow-sm border-t-0 bg-white\">\r\n      <CardHeader className=\"pb-3 md:pb-6\">\r\n        <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\r\n          <CardTitle className=\"text-base md:text-lg\">Top Selling Products</CardTitle>\r\n          <div className=\"flex items-center gap-2\">\r\n            <span className=\"text-sm text-muted-foreground\">Period:</span>\r\n            <Select value={period} onValueChange={(value) => onPeriodChange(value as typeof period)}>\r\n              <SelectTrigger className=\"w-[180px]\">\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"today\">Today</SelectItem>\r\n                <SelectItem value=\"yesterday\">Yesterday</SelectItem>\r\n                <SelectItem value=\"this-week\">This Week</SelectItem>\r\n                <SelectItem value=\"last-week\">Last Week</SelectItem>\r\n                <SelectItem value=\"this-month\">This Month</SelectItem>\r\n                <SelectItem value=\"last-month\">Last Month</SelectItem>\r\n                <SelectItem value=\"all-time\">All Time</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent className=\"p-0\">\r\n        <TopSellingProductsTable\r\n          products={topSellingProducts}\r\n          period={period}\r\n        />\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default TopSellingProductsCard;"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;;;AASA,MAAM,yBAAgE,CAAC,EACrE,kBAAkB,EAClB,MAAM,EACN,cAAc,EACf;IACC,qBACE,6LAAC,2IAAI;QAAC,WAAU;;0BACd,6LAAC,iJAAU;gBAAC,WAAU;0BACpB,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,gJAAS;4BAAC,WAAU;sCAAuB;;;;;;sCAC5C,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAK,WAAU;8CAAgC;;;;;;8CAChD,6LAAC,+IAAM;oCAAC,OAAO;oCAAQ,eAAe,CAAC,QAAU,eAAe;;sDAC9D,6LAAC,sJAAa;4CAAC,WAAU;sDACvB,cAAA,6LAAC,oJAAW;;;;;;;;;;sDAEd,6LAAC,sJAAa;;8DACZ,6LAAC,mJAAU;oDAAC,OAAM;8DAAQ;;;;;;8DAC1B,6LAAC,mJAAU;oDAAC,OAAM;8DAAY;;;;;;8DAC9B,6LAAC,mJAAU;oDAAC,OAAM;8DAAY;;;;;;8DAC9B,6LAAC,mJAAU;oDAAC,OAAM;8DAAY;;;;;;8DAC9B,6LAAC,mJAAU;oDAAC,OAAM;8DAAa;;;;;;8DAC/B,6LAAC,mJAAU;oDAAC,OAAM;8DAAa;;;;;;8DAC/B,6LAAC,mJAAU;oDAAC,OAAM;8DAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAMvC,6LAAC,kJAAW;gBAAC,WAAU;0BACrB,cAAA,6LAAC,wKAAuB;oBACtB,UAAU;oBACV,QAAQ;;;;;;;;;;;;;;;;;AAKlB;KArCM;uCAuCS"}},
    {"offset": {"line": 8584, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/StockLevelChart.tsx"],"sourcesContent":["\r\nimport React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n  Legend,\r\n} from 'recharts';\r\nimport { Product } from '@/types';\r\n\r\ninterface StockLevelChartProps {\r\n  products: Product[];\r\n}\r\n\r\nconst StockLevelChart: React.FC<StockLevelChartProps> = ({ products }) => {\r\n  // Calculate aggregated stock data\r\n  const totalInStock = products.filter(p => p.quantity > p.minimumStock).reduce((sum, p) => sum + p.quantity, 0);\r\n  const totalLowStock = products.filter(p => p.quantity > 0 && p.quantity <= p.minimumStock).reduce((sum, p) => sum + p.quantity, 0);\r\n  const totalMinimumLevel = products.reduce((sum, p) => sum + p.minimumStock, 0);\r\n  \r\n  // Create data array with each stock category as a separate object\r\n  const chartData = [\r\n    { name: 'In Stock', value: totalInStock, fill: '#4ade80' },\r\n    { name: 'Low Stock', value: totalLowStock, fill: '#f87171' },\r\n    { name: 'Minimum Level', value: totalMinimumLevel, fill: '#94a3b8' }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"w-full\">\r\n      <div className=\"h-[300px] w-full\">\r\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n          <BarChart\r\n            data={chartData}\r\n            margin={{ top: 20, right: 30, left: 20, bottom: 5 }}\r\n          >\r\n            <CartesianGrid strokeDasharray=\"3 3\" />\r\n            <XAxis dataKey=\"name\" />\r\n            <YAxis />\r\n            <Tooltip\r\n              formatter={(value, name, props) => {\r\n                return [value, props.payload.name];\r\n              }}\r\n            />\r\n            <Bar dataKey=\"value\" fill=\"#8884d8\" barSize={40}>\r\n              {chartData.map((entry, index) => (\r\n                <Bar key={`bar-${index}`} dataKey=\"value\" fill={entry.fill} />\r\n              ))}\r\n            </Bar>\r\n          </BarChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n      <div className=\"flex justify-center mt-4 space-x-6\">\r\n        <div className=\"flex items-center\">\r\n          <div className=\"w-3 h-3 bg-[#4ade80] rounded-full mr-2\"></div>\r\n          <span className=\"text-sm\">In Stock</span>\r\n        </div>\r\n        <div className=\"flex items-center\">\r\n          <div className=\"w-3 h-3 bg-[#f87171] rounded-full mr-2\"></div>\r\n          <span className=\"text-sm\">Low Stock</span>\r\n        </div>\r\n        <div className=\"flex items-center\">\r\n          <div className=\"w-3 h-3 bg-[#94a3b8] rounded-full mr-2\"></div>\r\n          <span className=\"text-sm\">Minimum Level</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StockLevelChart;\r\n"],"names":[],"mappings":";;;;;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAgBA,MAAM,kBAAkD,CAAC,EAAE,QAAQ,EAAE;IACnE,kCAAkC;IAClC,MAAM,eAAe,SAAS,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,GAAG,EAAE,YAAY,EAAE,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;IAC5G,MAAM,gBAAgB,SAAS,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,GAAG,KAAK,EAAE,QAAQ,IAAI,EAAE,YAAY,EAAE,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;IAChI,MAAM,oBAAoB,SAAS,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,YAAY,EAAE;IAE5E,kEAAkE;IAClE,MAAM,YAAY;QAChB;YAAE,MAAM;YAAY,OAAO;YAAc,MAAM;QAAU;QACzD;YAAE,MAAM;YAAa,OAAO;YAAe,MAAM;QAAU;QAC3D;YAAE,MAAM;YAAiB,OAAO;YAAmB,MAAM;QAAU;KACpE;IAED,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,6LAAmB;oBAAC,OAAM;oBAAO,QAAO;8BACvC,cAAA,6LAAC,mKAAQ;wBACP,MAAM;wBACN,QAAQ;4BAAE,KAAK;4BAAI,OAAO;4BAAI,MAAM;4BAAI,QAAQ;wBAAE;;0CAElD,6LAAC,iLAAa;gCAAC,iBAAgB;;;;;;0CAC/B,6LAAC,iKAAK;gCAAC,SAAQ;;;;;;0CACf,6LAAC,iKAAK;;;;;0CACN,6LAAC,qKAAO;gCACN,WAAW,CAAC,OAAO,MAAM;oCACvB,OAAO;wCAAC;wCAAO,MAAM,OAAO,CAAC,IAAI;qCAAC;gCACpC;;;;;;0CAEF,6LAAC,6JAAG;gCAAC,SAAQ;gCAAQ,MAAK;gCAAU,SAAS;0CAC1C,UAAU,GAAG,CAAC,CAAC,OAAO,sBACrB,6LAAC,6JAAG;wCAAsB,SAAQ;wCAAQ,MAAM,MAAM,IAAI;uCAAhD,CAAC,IAAI,EAAE,OAAO;;;;;;;;;;;;;;;;;;;;;;;;;;0BAMlC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;;;;;0CACf,6LAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;kCAE5B,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;;;;;0CACf,6LAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;kCAE5B,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;;;;;0CACf,6LAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAKpC;KArDM;uCAuDS"}},
    {"offset": {"line": 8801, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Downloads/FINAL/src/components/inventory/StockLevelOverviewCard.tsx"],"sourcesContent":["import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport StockLevelChart from '@/components/inventory/StockLevelChart';\r\nimport { Product } from '@/types';\r\nimport { useIsMobile } from '@/hooks/use-mobile';\r\n\r\ninterface StockLevelOverviewCardProps {\r\n  products: Product[];\r\n}\r\n\r\nconst StockLevelOverviewCard: React.FC<StockLevelOverviewCardProps> = ({ products }) => {\r\n  const isMobile = useIsMobile();\r\n\r\n  // Only show on desktop or if there are products\r\n  if (isMobile && products.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Card className=\"shadow-sm overflow-hidden\">\r\n      <CardHeader className=\"pb-3 md:pb-6\">\r\n        <CardTitle className=\"text-base md:text-lg\">Stock Level Overview</CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"pt-0\">\r\n        <StockLevelChart products={products} />\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default StockLevelOverviewCard;"],"names":[],"mappings":";;;;;AACA;AACA;AAEA;;;;;;AAMA,MAAM,yBAAgE,CAAC,EAAE,QAAQ,EAAE;;IACjF,MAAM,WAAW,IAAA,gJAAW;IAE5B,gDAAgD;IAChD,IAAI,YAAY,SAAS,MAAM,KAAK,GAAG;QACrC,OAAO;IACT;IAEA,qBACE,6LAAC,2IAAI;QAAC,WAAU;;0BACd,6LAAC,iJAAU;gBAAC,WAAU;0BACpB,cAAA,6LAAC,gJAAS;oBAAC,WAAU;8BAAuB;;;;;;;;;;;0BAE9C,6LAAC,kJAAW;gBAAC,WAAU;0BACrB,cAAA,6LAAC,gKAAe;oBAAC,UAAU;;;;;;;;;;;;;;;;;AAInC;GAlBM;;QACa,gJAAW;;;KADxB;uCAoBS"}}]
}