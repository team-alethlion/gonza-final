(globalThis.TURBOPACK || (globalThis.TURBOPACK = [])).push([typeof document === "object" ? document.currentScript : undefined,
"[project]/src/app/actions/data:44800f [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getExpensesAction",
    ()=>$$RSC_SERVER_ACTION_1
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"402e37ae5f317e45e7c2b4d0c5adab499af81d14d0":"getExpensesAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_1 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("402e37ae5f317e45e7c2b4d0c5adab499af81d14d0", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getExpensesAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJnU0EyRXNCLDhMQUFBIn0=
}),
"[project]/src/app/actions/data:b5cc1e [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createExpenseAction",
    ()=>$$RSC_SERVER_ACTION_0
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"605e3bb4746b8859e06f2fe24bb8c29c89434c1100":"createExpenseAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_0 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("605e3bb4746b8859e06f2fe24bb8c29c89434c1100", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "createExpenseAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJrU0FvQnNCLGdNQUFBIn0=
}),
"[project]/src/app/actions/data:475711 [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "updateExpenseAction",
    ()=>$$RSC_SERVER_ACTION_2
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"7077a08a1130225a7b61a1e58b625150fa2464c027":"updateExpenseAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_2 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("7077a08a1130225a7b61a1e58b625150fa2464c027", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "updateExpenseAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJrU0FxR3NCLGdNQUFBIn0=
}),
"[project]/src/app/actions/data:cac40e [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "deleteExpenseAction",
    ()=>$$RSC_SERVER_ACTION_3
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"403af43ad5cffacca8895380711b09eea48b602a18":"deleteExpenseAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_3 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("403af43ad5cffacca8895380711b09eea48b602a18", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "deleteExpenseAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJrU0FvTHNCLGdNQUFBIn0=
}),
"[project]/src/app/actions/data:6d0100 [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getBusinessSettingsAction",
    ()=>$$RSC_SERVER_ACTION_0
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"409fca4033c47a8ce32274ee5d84a1bf7b5ddd0ee6":"getBusinessSettingsAction"},"src/app/actions/business-settings.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_0 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("409fca4033c47a8ce32274ee5d84a1bf7b5ddd0ee6", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getBusinessSettingsAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vYnVzaW5lc3Mtc2V0dGluZ3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzZXJ2ZXInO1xyXG5cclxuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi8uLi8uLi9wcmlzbWEvZGInO1xyXG5pbXBvcnQgeyByZXZhbGlkYXRlUGF0aCB9IGZyb20gJ25leHQvY2FjaGUnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEJ1c2luZXNzU2V0dGluZ3NBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IGF3YWl0IGRiLmJyYW5jaFNldHRpbmdzLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZCB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghc2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpZDogc2V0dGluZ3MuaWQsXHJcbiAgICAgICAgICAgIGJ1c2luZXNzX25hbWU6IHNldHRpbmdzLmJ1c2luZXNzTmFtZSxcclxuICAgICAgICAgICAgYnVzaW5lc3NfYWRkcmVzczogc2V0dGluZ3MuYWRkcmVzcyxcclxuICAgICAgICAgICAgYnVzaW5lc3NfcGhvbmU6IHNldHRpbmdzLnBob25lLFxyXG4gICAgICAgICAgICBidXNpbmVzc19lbWFpbDogc2V0dGluZ3MuZW1haWwsXHJcbiAgICAgICAgICAgIGJ1c2luZXNzX2xvZ286IHNldHRpbmdzLmxvZ28sXHJcbiAgICAgICAgICAgIGN1cnJlbmN5OiBzZXR0aW5ncy5jdXJyZW5jeSxcclxuICAgICAgICAgICAgc2lnbmF0dXJlOiBzZXR0aW5ncy5zaWduYXR1cmVJbWFnZSxcclxuICAgICAgICAgICAgbWV0YWRhdGE6IHNldHRpbmdzLm1ldGFkYXRhIHx8IHt9XHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYnVzaW5lc3Mgc2V0dGluZ3M6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBzZXJ0QnVzaW5lc3NTZXR0aW5nc0FjdGlvbihicmFuY2hJZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgdXBkYXRlRGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIC8vIFZhbGlkYXRlIHVzZXIgYWNjZXNzIHRvIGJyYW5jaFxyXG4gICAgICAgIGNvbnN0IGJyYW5jaCA9IGF3YWl0IGRiLmJyYW5jaC5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgaWQ6IGJyYW5jaElkLFxyXG4gICAgICAgICAgICAgICAgT1I6IFtcclxuICAgICAgICAgICAgICAgICAgICB7IGFkbWluSWQ6IHVzZXJJZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHsgdXNlcnM6IHsgc29tZTogeyBpZDogdXNlcklkIH0gfSB9XHJcbiAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCFicmFuY2gpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVW5hdXRob3JpemVkIHRvIHVwZGF0ZSBicmFuY2ggc2V0dGluZ3MnIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkYXRhID0ge1xyXG4gICAgICAgICAgICBidXNpbmVzc05hbWU6IHVwZGF0ZURhdGEuYnVzaW5lc3NfbmFtZSxcclxuICAgICAgICAgICAgYWRkcmVzczogdXBkYXRlRGF0YS5idXNpbmVzc19hZGRyZXNzLFxyXG4gICAgICAgICAgICBwaG9uZTogdXBkYXRlRGF0YS5idXNpbmVzc19waG9uZSxcclxuICAgICAgICAgICAgZW1haWw6IHVwZGF0ZURhdGEuYnVzaW5lc3NfZW1haWwsXHJcbiAgICAgICAgICAgIGxvZ286IHVwZGF0ZURhdGEuYnVzaW5lc3NfbG9nbyxcclxuICAgICAgICAgICAgY3VycmVuY3k6IHVwZGF0ZURhdGEuY3VycmVuY3ksXHJcbiAgICAgICAgICAgIHNpZ25hdHVyZUltYWdlOiB1cGRhdGVEYXRhLnNpZ25hdHVyZSxcclxuICAgICAgICAgICAgbWV0YWRhdGE6IHVwZGF0ZURhdGEubWV0YWRhdGFcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCB1cHNlcnRlZCA9IGF3YWl0IGRiLmJyYW5jaFNldHRpbmdzLnVwc2VydCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBicmFuY2hJZCB9LFxyXG4gICAgICAgICAgICB1cGRhdGU6IGRhdGEsXHJcbiAgICAgICAgICAgIGNyZWF0ZToge1xyXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGJyYW5jaElkLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF0YVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiB1cHNlcnRlZC5pZCxcclxuICAgICAgICAgICAgICAgIGJ1c2luZXNzX25hbWU6IHVwc2VydGVkLmJ1c2luZXNzTmFtZSxcclxuICAgICAgICAgICAgICAgIGJ1c2luZXNzX2FkZHJlc3M6IHVwc2VydGVkLmFkZHJlc3MsXHJcbiAgICAgICAgICAgICAgICBidXNpbmVzc19waG9uZTogdXBzZXJ0ZWQucGhvbmUsXHJcbiAgICAgICAgICAgICAgICBidXNpbmVzc19lbWFpbDogdXBzZXJ0ZWQuZW1haWwsXHJcbiAgICAgICAgICAgICAgICBidXNpbmVzc19sb2dvOiB1cHNlcnRlZC5sb2dvLFxyXG4gICAgICAgICAgICAgICAgY3VycmVuY3k6IHVwc2VydGVkLmN1cnJlbmN5LFxyXG4gICAgICAgICAgICAgICAgc2lnbmF0dXJlOiB1cHNlcnRlZC5zaWduYXR1cmVJbWFnZSxcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB1cHNlcnRlZC5tZXRhZGF0YVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cHNlcnRpbmcgYnVzaW5lc3Mgc2V0dGluZ3M6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIHVwZGF0ZSBzZXR0aW5ncycgfTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6ImtUQUtzQixzTUFBQSJ9
}),
"[project]/src/app/actions/data:01c0b4 [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "upsertBusinessSettingsAction",
    ()=>$$RSC_SERVER_ACTION_1
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"7030790b3d20fcf62d9c199d3ecacadd25d0d7ec17":"upsertBusinessSettingsAction"},"src/app/actions/business-settings.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_1 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("7030790b3d20fcf62d9c199d3ecacadd25d0d7ec17", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "upsertBusinessSettingsAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vYnVzaW5lc3Mtc2V0dGluZ3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzZXJ2ZXInO1xyXG5cclxuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi8uLi8uLi9wcmlzbWEvZGInO1xyXG5pbXBvcnQgeyByZXZhbGlkYXRlUGF0aCB9IGZyb20gJ25leHQvY2FjaGUnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEJ1c2luZXNzU2V0dGluZ3NBY3Rpb24oYnJhbmNoSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IGF3YWl0IGRiLmJyYW5jaFNldHRpbmdzLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBicmFuY2hJZCB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghc2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpZDogc2V0dGluZ3MuaWQsXHJcbiAgICAgICAgICAgIGJ1c2luZXNzX25hbWU6IHNldHRpbmdzLmJ1c2luZXNzTmFtZSxcclxuICAgICAgICAgICAgYnVzaW5lc3NfYWRkcmVzczogc2V0dGluZ3MuYWRkcmVzcyxcclxuICAgICAgICAgICAgYnVzaW5lc3NfcGhvbmU6IHNldHRpbmdzLnBob25lLFxyXG4gICAgICAgICAgICBidXNpbmVzc19lbWFpbDogc2V0dGluZ3MuZW1haWwsXHJcbiAgICAgICAgICAgIGJ1c2luZXNzX2xvZ286IHNldHRpbmdzLmxvZ28sXHJcbiAgICAgICAgICAgIGN1cnJlbmN5OiBzZXR0aW5ncy5jdXJyZW5jeSxcclxuICAgICAgICAgICAgc2lnbmF0dXJlOiBzZXR0aW5ncy5zaWduYXR1cmVJbWFnZSxcclxuICAgICAgICAgICAgbWV0YWRhdGE6IHNldHRpbmdzLm1ldGFkYXRhIHx8IHt9XHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYnVzaW5lc3Mgc2V0dGluZ3M6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBzZXJ0QnVzaW5lc3NTZXR0aW5nc0FjdGlvbihicmFuY2hJZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgdXBkYXRlRGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIC8vIFZhbGlkYXRlIHVzZXIgYWNjZXNzIHRvIGJyYW5jaFxyXG4gICAgICAgIGNvbnN0IGJyYW5jaCA9IGF3YWl0IGRiLmJyYW5jaC5maW5kRmlyc3Qoe1xyXG4gICAgICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgICAgICAgaWQ6IGJyYW5jaElkLFxyXG4gICAgICAgICAgICAgICAgT1I6IFtcclxuICAgICAgICAgICAgICAgICAgICB7IGFkbWluSWQ6IHVzZXJJZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHsgdXNlcnM6IHsgc29tZTogeyBpZDogdXNlcklkIH0gfSB9XHJcbiAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCFicmFuY2gpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVW5hdXRob3JpemVkIHRvIHVwZGF0ZSBicmFuY2ggc2V0dGluZ3MnIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkYXRhID0ge1xyXG4gICAgICAgICAgICBidXNpbmVzc05hbWU6IHVwZGF0ZURhdGEuYnVzaW5lc3NfbmFtZSxcclxuICAgICAgICAgICAgYWRkcmVzczogdXBkYXRlRGF0YS5idXNpbmVzc19hZGRyZXNzLFxyXG4gICAgICAgICAgICBwaG9uZTogdXBkYXRlRGF0YS5idXNpbmVzc19waG9uZSxcclxuICAgICAgICAgICAgZW1haWw6IHVwZGF0ZURhdGEuYnVzaW5lc3NfZW1haWwsXHJcbiAgICAgICAgICAgIGxvZ286IHVwZGF0ZURhdGEuYnVzaW5lc3NfbG9nbyxcclxuICAgICAgICAgICAgY3VycmVuY3k6IHVwZGF0ZURhdGEuY3VycmVuY3ksXHJcbiAgICAgICAgICAgIHNpZ25hdHVyZUltYWdlOiB1cGRhdGVEYXRhLnNpZ25hdHVyZSxcclxuICAgICAgICAgICAgbWV0YWRhdGE6IHVwZGF0ZURhdGEubWV0YWRhdGFcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCB1cHNlcnRlZCA9IGF3YWl0IGRiLmJyYW5jaFNldHRpbmdzLnVwc2VydCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGJyYW5jaElkOiBicmFuY2hJZCB9LFxyXG4gICAgICAgICAgICB1cGRhdGU6IGRhdGEsXHJcbiAgICAgICAgICAgIGNyZWF0ZToge1xyXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IGJyYW5jaElkLFxyXG4gICAgICAgICAgICAgICAgLi4uZGF0YVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGlkOiB1cHNlcnRlZC5pZCxcclxuICAgICAgICAgICAgICAgIGJ1c2luZXNzX25hbWU6IHVwc2VydGVkLmJ1c2luZXNzTmFtZSxcclxuICAgICAgICAgICAgICAgIGJ1c2luZXNzX2FkZHJlc3M6IHVwc2VydGVkLmFkZHJlc3MsXHJcbiAgICAgICAgICAgICAgICBidXNpbmVzc19waG9uZTogdXBzZXJ0ZWQucGhvbmUsXHJcbiAgICAgICAgICAgICAgICBidXNpbmVzc19lbWFpbDogdXBzZXJ0ZWQuZW1haWwsXHJcbiAgICAgICAgICAgICAgICBidXNpbmVzc19sb2dvOiB1cHNlcnRlZC5sb2dvLFxyXG4gICAgICAgICAgICAgICAgY3VycmVuY3k6IHVwc2VydGVkLmN1cnJlbmN5LFxyXG4gICAgICAgICAgICAgICAgc2lnbmF0dXJlOiB1cHNlcnRlZC5zaWduYXR1cmVJbWFnZSxcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB1cHNlcnRlZC5tZXRhZGF0YVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cHNlcnRpbmcgYnVzaW5lc3Mgc2V0dGluZ3M6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnRmFpbGVkIHRvIHVwZGF0ZSBzZXR0aW5ncycgfTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6InFUQWdDc0IseU1BQUEifQ==
}),
"[project]/src/app/actions/data:7583bb [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getExpenseCategoriesAction",
    ()=>$$RSC_SERVER_ACTION_10
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"400ae4f1978594af2213c293fdc310bfc63bb46abb":"getExpenseCategoriesAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_10 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("400ae4f1978594af2213c293fdc310bfc63bb46abb", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getExpenseCategoriesAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJ5U0E2YXNCLHlNQUFBIn0=
}),
"[project]/src/app/actions/data:b0d02f [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createExpenseCategoryAction",
    ()=>$$RSC_SERVER_ACTION_11
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"40cd9128fc777c47ffb878528336fb0db6252970f9":"createExpenseCategoryAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_11 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("40cd9128fc777c47ffb878528336fb0db6252970f9", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "createExpenseCategoryAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIwU0FtY3NCLDBNQUFBIn0=
}),
"[project]/src/app/actions/data:effcf3 [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "deleteExpenseCategoryAction",
    ()=>$$RSC_SERVER_ACTION_12
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"406d7dde446cdd183e70288e49965c100788f613a7":"deleteExpenseCategoryAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_12 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("406d7dde446cdd183e70288e49965c100788f613a7", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "deleteExpenseCategoryAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIwU0FzZHNCLDBNQUFBIn0=
}),
"[project]/src/app/actions/data:f8b1bf [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createDefaultExpenseCategoriesAction",
    ()=>$$RSC_SERVER_ACTION_13
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"701e7872a606c6f4e0729b003ea3eccb48d2f038d9":"createDefaultExpenseCategoriesAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_13 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("701e7872a606c6f4e0729b003ea3eccb48d2f038d9", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "createDefaultExpenseCategoriesAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJtVEFvZXNCLG1OQUFBIn0=
}),
"[project]/src/app/actions/data:c09f2e [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getCashAccountsAction",
    ()=>$$RSC_SERVER_ACTION_14
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"404e4c969fb4ed9517070820aa9238be69635d81df":"getCashAccountsAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_14 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("404e4c969fb4ed9517070820aa9238be69635d81df", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getCashAccountsAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJvU0E0ZnNCLG9NQUFBIn0=
}),
"[project]/src/app/actions/data:e2bbab [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createCashAccountAction",
    ()=>$$RSC_SERVER_ACTION_15
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"40dcb97687ff077761d5656c206c90b60da7e90768":"createCashAccountAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_15 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("40dcb97687ff077761d5656c206c90b60da7e90768", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "createCashAccountAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJzU0FxaEJzQixzTUFBQSJ9
}),
"[project]/src/app/actions/data:5ba0e9 [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "updateCashAccountAction",
    ()=>$$RSC_SERVER_ACTION_16
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"608cfd9a6361204aef1789b1c8cec0c7a7251b5da6":"updateCashAccountAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_16 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("608cfd9a6361204aef1789b1c8cec0c7a7251b5da6", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "updateCashAccountAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJzU0EwaUJzQixzTUFBQSJ9
}),
"[project]/src/app/actions/data:1655b3 [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "deleteCashAccountAction",
    ()=>$$RSC_SERVER_ACTION_17
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"606de6e888cd750a405cef95d0de94e1650793b224":"deleteCashAccountAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_17 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("606de6e888cd750a405cef95d0de94e1650793b224", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "deleteCashAccountAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJzU0E4akJzQixzTUFBQSJ9
}),
"[project]/src/app/actions/data:f476fd [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "deleteCashAccountWithTransactionsAction",
    ()=>$$RSC_SERVER_ACTION_18
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"70cc14e48c776d93c255f39bea0884a4cc9308abf7":"deleteCashAccountWithTransactionsAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_18 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("70cc14e48c776d93c255f39bea0884a4cc9308abf7", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "deleteCashAccountWithTransactionsAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJzVEFnbUJzQixzTkFBQSJ9
}),
"[project]/src/app/actions/data:fa5a0f [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "getCashAccountBalanceAction",
    ()=>$$RSC_SERVER_ACTION_19
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
/* __next_internal_action_entry_do_not_use__ [{"6022d2e7f9e9a35853d5428f52c9618bc015f7bda3":"getCashAccountBalanceAction"},"src/app/actions/finance.ts",""] */ "use turbopack no side effects";
;
const $$RSC_SERVER_ACTION_19 = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("6022d2e7f9e9a35853d5428f52c9618bc015f7bda3", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getCashAccountBalanceAction");
;
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
 //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vZmluYW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcic7XHJcblxyXG5pbXBvcnQgeyBkYiwgUGF5bWVudFN0YXR1cywgQWN0aXZpdHlUeXBlLCBBY3Rpdml0eU1vZHVsZSB9IGZyb20gJy4uLy4uLy4uL3ByaXNtYS9kYic7XHJcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoIH0gZnJvbSAnbmV4dC9jYWNoZSc7XHJcblxyXG4vLyAtLS0gRVhQRU5TRVMgLS0tXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEV4cGVuc2VJbnB1dCB7XHJcbiAgICBhbW91bnQ6IG51bWJlcjtcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XHJcbiAgICBjYXRlZ29yeT86IHN0cmluZztcclxuICAgIGRhdGU6IERhdGU7XHJcbiAgICBwYXltZW50TWV0aG9kPzogc3RyaW5nO1xyXG4gICAgcGVyc29uSW5DaGFyZ2U/OiBzdHJpbmc7XHJcbiAgICByZWNlaXB0SW1hZ2U/OiBzdHJpbmc7XHJcbiAgICBjYXNoQWNjb3VudElkPzogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQWN0aW9uKGRhdGE6IEV4cGVuc2VJbnB1dCwgbGlua1RvQ2FzaDogYm9vbGVhbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgLy8gMS4gQ3JlYXRlIHRoZSBleHBlbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiBkYXRhLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogZGF0YS5yZWNlaXB0SW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjYXNoQWNjb3VudElkOiBsaW5rVG9DYXNoICYmIGRhdGEuY2FzaEFjY291bnRJZCA/IGRhdGEuY2FzaEFjY291bnRJZCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyAyLiBJZiBsaW5raW5nIHRvIGNhc2gsIGNyZWF0ZSBhIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgaWYgKGxpbmtUb0Nhc2ggJiYgZGF0YS5jYXNoQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmNhc2hBY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfb3V0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7ZGF0YS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6IGRhdGEucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlIHx8IG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZSB3aXRoIHRyYW5zYWN0aW9uIHJlZmVyZW5jZVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleHBlbnNlLmlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogY2FzaFR4LmlkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeHBlbnNlc0FjdGlvbihsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZXhwZW5zZXMgPSBhd2FpdCBkYi5leHBlbnNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IGRhdGU6ICdkZXNjJyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIGRhdGE6IGV4cGVuc2VzLm1hcCgoZTogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgLi4uZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IGUuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBlLnVwZGF0ZWRBdC50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2Q6IGUucGF5bWVudE1ldGhvZCxcclxuICAgICAgICAgICAgICAgIHBlcnNvbl9pbl9jaGFyZ2U6IGUucGVyc29uSW5DaGFyZ2UsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiBlLnJlY2VpcHRJbWFnZSxcclxuICAgICAgICAgICAgICAgIGNhc2hfYWNjb3VudF9pZDogZS5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgY2FzaF90cmFuc2FjdGlvbl9pZDogZS5jYXNoVHJhbnNhY3Rpb25JZFxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2VzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV4cGVuc2VBY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55LCBjdXJyZW50RXhwZW5zZTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZXhwZW5zZVxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkRXhwZW5zZSA9IGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpcHRJbWFnZTogdXBkYXRlcy5yZWNlaXB0SW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaEFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkIHx8IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzaG91bGRMaW5rVG9DYXNoID0gISF1cGRhdGVzLmNhc2hBY2NvdW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdhc0xpbmtlZFRvQ2FzaCA9ICEhY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiAhd2FzTGlua2VkVG9DYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50RXhwZW5zZS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGN1cnJlbnRFeHBlbnNlLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSB8fCBjdXJyZW50RXhwZW5zZS5jYXRlZ29yeSB8fCAnRXhwZW5zZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRXhwZW5zZTogJHt1cGRhdGVzLmRlc2NyaXB0aW9uIHx8IGN1cnJlbnRFeHBlbnNlLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNvbkluQ2hhcmdlOiB1cGRhdGVzLnBlcnNvbkluQ2hhcmdlIHx8IGN1cnJlbnRFeHBlbnNlLnBlcnNvbkluQ2hhcmdlIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSB8fCBjdXJyZW50RXhwZW5zZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QgfHwgY3VycmVudEV4cGVuc2UucGF5bWVudE1ldGhvZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlIHx8IGN1cnJlbnRFeHBlbnNlLnJlY2VpcHRJbWFnZSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5leHBlbnNlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNhc2hUcmFuc2FjdGlvbklkOiBjYXNoVHguaWQgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkTGlua1RvQ2FzaCAmJiB3YXNMaW5rZWRUb0Nhc2gpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjYXNoIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudEV4cGVuc2UuY2FzaFRyYW5zYWN0aW9uSWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogdXBkYXRlcy5jYXNoQWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHVwZGF0ZXMuYW1vdW50IHx8IGN1cnJlbnRFeHBlbnNlLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IHVwZGF0ZXMuY2F0ZWdvcnkgfHwgY3VycmVudEV4cGVuc2UuY2F0ZWdvcnkgfHwgJ0V4cGVuc2UnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYEV4cGVuc2U6ICR7dXBkYXRlcy5kZXNjcmlwdGlvbiB8fCBjdXJyZW50RXhwZW5zZS5kZXNjcmlwdGlvbn1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzb25JbkNoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSB8fCBjdXJyZW50RXhwZW5zZS5wZXJzb25JbkNoYXJnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB1cGRhdGVzLmRhdGUgfHwgY3VycmVudEV4cGVuc2UuZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogdXBkYXRlcy5wYXltZW50TWV0aG9kIHx8IGN1cnJlbnRFeHBlbnNlLnBheW1lbnRNZXRob2QgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiB1cGRhdGVzLnJlY2VpcHRJbWFnZSB8fCBjdXJyZW50RXhwZW5zZS5yZWNlaXB0SW1hZ2UgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRMaW5rVG9DYXNoICYmIHdhc0xpbmtlZFRvQ2FzaCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXN0aW5nIGNhc2ggdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjdXJyZW50RXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmV4cGVuc2UudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRXhwZW5zZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXhwZW5zZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFeHBlbnNlQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cGVuc2UgPSBhd2FpdCB0eC5leHBlbnNlLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVuc2U/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZXhwZW5zZS5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2U6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gSU5TVEFMTE1FTlQgUEFZTUVOVFMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGFsbG1lbnRQYXltZW50c0FjdGlvbihzYWxlSWQ6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXltZW50cyA9IGF3YWl0IGRiLmluc3RhbGxtZW50UGF5bWVudC5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IHNhbGVJZCB9LFxyXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHBheW1lbnREYXRlOiAnZGVzYycgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiBwYXltZW50cy5tYXAoKHA6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBwLmlkLFxyXG4gICAgICAgICAgICAgICAgc2FsZUlkOiBwLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogcC51c2VySWQsXHJcbiAgICAgICAgICAgICAgICBhbW91bnQ6IE51bWJlcihwLmFtb3VudCksXHJcbiAgICAgICAgICAgICAgICBwYXltZW50RGF0ZTogcC5wYXltZW50RGF0ZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IHAubm90ZXMsXHJcbiAgICAgICAgICAgICAgICBjYXNoVHJhbnNhY3Rpb25JZDogcC5jYXNoVHJhbnNhY3Rpb25JZCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogcC51cGRhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGluc3RhbGxtZW50IHBheW1lbnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjYXNoVHhJZCA9IGRhdGEuY2FzaFRyYW5zYWN0aW9uSWQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5hY2NvdW50SWQgJiYgZGF0YS5sb2NhdGlvbklkICYmICFjYXNoVHhJZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FsZSA9IGF3YWl0IHR4LnNhbGUuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGRhdGEuc2FsZUlkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IGN1c3RvbWVyTmFtZTogdHJ1ZSwgcmVjZWlwdE51bWJlcjogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHNhbGVcclxuICAgICAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3NhbGUuY3VzdG9tZXJOYW1lfSAtIFJlY2VpcHQgIyR7c2FsZS5yZWNlaXB0TnVtYmVyfWBcclxuICAgICAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciBzYWxlYDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXNoVHggPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBkYXRhLmFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAnY2FzaF9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKGRhdGEucGF5bWVudERhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhc2hUeElkID0gY2FzaFR4LmlkO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2FsZUlkOiBkYXRhLnNhbGVJZCxcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IGRhdGEubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHBheW1lbnREYXRlOiBkYXRhLnBheW1lbnREYXRlID8gbmV3IERhdGUoZGF0YS5wYXltZW50RGF0ZSkgOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBheW1lbnQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGluc3RhbGxtZW50IHBheW1lbnQ6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSW5zdGFsbG1lbnRQYXltZW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBub3QgZm91bmRcIik7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogdXBkYXRlcy5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHVwZGF0ZXMubm90ZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bWVudERhdGU6IHVwZGF0ZXMucGF5bWVudERhdGUgPyBuZXcgRGF0ZSh1cGRhdGVzLnBheW1lbnREYXRlKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY3VycmVudC5jYXNoVHJhbnNhY3Rpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogdXBkYXRlcy5wYXltZW50RGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMucGF5bWVudERhdGUpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBpbnN0YWxsbWVudCBwYXltZW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUluc3RhbGxtZW50UGF5bWVudEFjdGlvbihpZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdDogeyBjYXNoVHJhbnNhY3Rpb25JZDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBheW1lbnQ/LmNhc2hUcmFuc2FjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uZGVsZXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgaW5zdGFsbG1lbnQgcGF5bWVudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rSW5zdGFsbG1lbnRUb0Nhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcsIGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgdHguaW5zdGFsbG1lbnRQYXltZW50LmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgaW5jbHVkZTogeyBzYWxlOiB0cnVlIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICBpZiAocGF5bWVudC5jYXNoVHJhbnNhY3Rpb25JZCkgdGhyb3cgbmV3IEVycm9yKFwiUGF5bWVudCBhbHJlYWR5IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGF5bWVudC5zYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBJbnN0YWxsbWVudCBwYXltZW50IGZvciAke3BheW1lbnQuc2FsZS5jdXN0b21lck5hbWV9IC0gUmVjZWlwdCAjJHtwYXltZW50LnNhbGUucmVjZWlwdE51bWJlcn1gXHJcbiAgICAgICAgICAgICAgICA6IGBJbnN0YWxsbWVudCBwYXltZW50ICMke3BheW1lbnRJZC5zdWJzdHJpbmcoMCwgOCl9YDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNhc2hUeCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBheW1lbnQuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ2Nhc2hfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAnSW5zdGFsbG1lbnQgcGF5bWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcGF5bWVudC5wYXltZW50RGF0ZSxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXltZW50SWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IGNhc2hUeC5pZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNhc2hUeDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbGlua2luZyBpbnN0YWxsbWVudCB0byBjYXNoOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubGlua0luc3RhbGxtZW50RnJvbUNhc2hBY3Rpb24ocGF5bWVudElkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogcGF5bWVudElkIH0sXHJcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGF5bWVudD8uY2FzaFRyYW5zYWN0aW9uSWQpIHRocm93IG5ldyBFcnJvcihcIlBheW1lbnQgbm90IGxpbmtlZFwiKTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnQuY2FzaFRyYW5zYWN0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4Lmluc3RhbGxtZW50UGF5bWVudC51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHBheW1lbnRJZCB9LFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjYXNoVHJhbnNhY3Rpb25JZDogbnVsbCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5saW5raW5nIGluc3RhbGxtZW50IGZyb20gY2FzaDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBFWFBFTlNFIENBVEVHT1JJRVMgLS0tXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhwZW5zZUNhdGVnb3JpZXNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcy5tYXAoKGM6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIGlkOiBjLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBjLmlzRGVmYXVsdCxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYy5jcmVhdGVkQXQudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGV4cGVuc2UgY2F0ZWdvcmllczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlQ2F0ZWdvcnlBY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmV4cGVuc2VDYXRlZ29yeS5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiBkYXRhLmlzRGVmYXVsdCB8fCBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRXhwZW5zZUNhdGVnb3J5QWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuZXhwZW5zZUNhdGVnb3J5LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV4cGVuc2UgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEV4cGVuc2VDYXRlZ29yaWVzQWN0aW9uKHVzZXJJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcsIGNhdGVnb3J5TmFtZXM6IHN0cmluZ1tdKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBjYXRlZ29yeU5hbWVzLm1hcChuYW1lID0+ICh7XHJcbiAgICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgaXNEZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBhd2FpdCBkYi5leHBlbnNlQ2F0ZWdvcnkuY3JlYXRlTWFueSh7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHNraXBEdXBsaWNhdGVzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkZWZhdWx0IGNhdGVnb3JpZXM6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyAtLS0gQ0FTSCBBQ0NPVU5UUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoQWNjb3VudHNBY3Rpb24obG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgZGIuY2FzaEFjY291bnQuZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBsb2NhdGlvbklkIH0sXHJcbiAgICAgICAgICAgIG9yZGVyQnk6IFt7IGlzRGVmYXVsdDogJ2Rlc2MnIH0sIHsgbmFtZTogJ2FzYycgfV1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgZGF0YTogYWNjb3VudHMubWFwKChhOiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBpZDogYS5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgb3BlbmluZ0JhbGFuY2U6IE51bWJlcihhLm9wZW5pbmdCYWxhbmNlKSxcclxuICAgICAgICAgICAgICAgIGlzRGVmYXVsdDogYS5pc0RlZmF1bHQsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LnRvSVNPU3RyaW5nKClcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjYXNoIGFjY291bnRzOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hBY2NvdW50QWN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiBkYXRhLm9wZW5pbmdCYWxhbmNlIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGRhdGEuaXNEZWZhdWx0IHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCBhY2NvdW50OicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNhc2hBY2NvdW50QWN0aW9uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IGFueSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB1cGRhdGVzLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlcy5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG9wZW5pbmdCYWxhbmNlOiB1cGRhdGVzLm9wZW5pbmdCYWxhbmNlLFxyXG4gICAgICAgICAgICAgICAgaXNEZWZhdWx0OiB1cGRhdGVzLmlzRGVmYXVsdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKCcvZmluYW5jZScpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudEFjdGlvbihpZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR4Q291bnQgPSBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY291bnQoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZXhwQ291bnQgPSBhd2FpdCB0eC5leHBlbnNlLmNvdW50KHtcclxuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGNhc2hBY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHhDb3VudCA+IDAgfHwgZXhwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc1RyYW5zYWN0aW9uczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBgQWNjb3VudCBoYXMgJHt0eENvdW50fSB0cmFuc2FjdGlvbnMgYW5kICR7ZXhwQ291bnR9IGV4cGVuc2VzLmBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzVHJhbnNhY3Rpb25zOiBmYWxzZSB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoQWNjb3VudFdpdGhUcmFuc2FjdGlvbnNBY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nLCBkZWxldGVUcmFuc2FjdGlvbnM6IGJvb2xlYW4pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkZWxldGVUcmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQ6IGlkLCBsb2NhdGlvbklkIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24udXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgYWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWNjb3VudElkOiBudWxsIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdHguZXhwZW5zZS51cGRhdGVNYW55KHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoQWNjb3VudElkOiBpZCwgbG9jYXRpb25JZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaEFjY291bnRJZDogbnVsbCwgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hBY2NvdW50LmRlbGV0ZSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBpZCwgbG9jYXRpb25JZCB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgY2FzaCBhY2NvdW50IHdpdGggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhc2hBY2NvdW50QmFsYW5jZUFjdGlvbihhY2NvdW50SWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBkYi5jYXNoQWNjb3VudC5maW5kVW5pcXVlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGFjY291bnRJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHsgb3BlbmluZ0JhbGFuY2U6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFjY291bnQpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xyXG5cclxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGFtb3VudDogdHJ1ZSwgdHJhbnNhY3Rpb25UeXBlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGJhbGFuY2UgPSBOdW1iZXIoYWNjb3VudC5vcGVuaW5nQmFsYW5jZSk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0eCBvZiB0cmFuc2FjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gTnVtYmVyKHR4LmFtb3VudCk7XHJcbiAgICAgICAgICAgIGlmICh0eC50cmFuc2FjdGlvblR5cGUgPT09ICdjYXNoX2luJyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9pbicpIHtcclxuICAgICAgICAgICAgICAgIGJhbGFuY2UgKz0gYW1vdW50O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR4LnRyYW5zYWN0aW9uVHlwZSA9PT0gJ2Nhc2hfb3V0JyB8fCB0eC50cmFuc2FjdGlvblR5cGUgPT09ICd0cmFuc2Zlcl9vdXQnKSB7XHJcbiAgICAgICAgICAgICAgICBiYWxhbmNlIC09IGFtb3VudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYmFsYW5jZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIGFjY291bnQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIC0tLSBDQVNIIFRSQU5TQUNUSU9OUyAtLS1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKGxvY2F0aW9uSWQ6IHN0cmluZywgYWNjb3VudElkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7IGxvY2F0aW9uSWQgfTtcclxuICAgICAgICBpZiAoYWNjb3VudElkKSB3aGVyZS5hY2NvdW50SWQgPSBhY2NvdW50SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgICAgICAgIHdoZXJlLFxyXG4gICAgICAgICAgICBvcmRlckJ5OiBbeyBkYXRlOiAnZGVzYycgfSwgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBkYXRhOiB0cmFuc2FjdGlvbnMubWFwKCh0OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICAuLi50LFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogdC5jcmVhdGVkQXQudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IHQudXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiB0LnVzZXJJZCxcclxuICAgICAgICAgICAgICAgIGFjY291bnRfaWQ6IHQuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb25faWQ6IHQubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3R5cGU6IHQudHJhbnNhY3Rpb25UeXBlLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdC5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiB0LnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0X2ltYWdlOiB0LnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhc2ggdHJhbnNhY3Rpb25zOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhc2hUcmFuc2FjdGlvbkFjdGlvbihkYXRhOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ3RyYW5zZmVyJyAmJiBkYXRhLnRvQWNjb3VudElkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eE91dCA9IGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25JZDogZGF0YS5sb2NhdGlvbklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGRhdGEuYW1vdW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9vdXQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eEluID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25UeXBlOiAndHJhbnNmZXJfaW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kYXRlID8gbmV3IERhdGUoZGF0YS5kYXRlKSA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5IHx8ICdUcmFuc2ZlcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3R4T3V0LCB0eEluXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS5hY2NvdW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBkYXRhLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczogZGF0YS50YWdzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRhLmRhdGUgPyBuZXcgRGF0ZShkYXRhLmRhdGUpIDogbmV3IERhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IGRhdGEucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgdXBkYXRlczogYW55KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNhc2hUcmFuc2FjdGlvbi51cGRhdGUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHVwZGF0ZXMuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgYW1vdW50OiB1cGRhdGVzLmFtb3VudCxcclxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdXBkYXRlcy50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogdXBkYXRlcy5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1cGRhdGVzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogdXBkYXRlcy5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgIHRhZ3M6IHVwZGF0ZXMudGFncyxcclxuICAgICAgICAgICAgICAgIGRhdGU6IHVwZGF0ZXMuZGF0ZSA/IG5ldyBEYXRlKHVwZGF0ZXMuZGF0ZSkgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiB1cGRhdGVzLnBheW1lbnRNZXRob2QsXHJcbiAgICAgICAgICAgICAgICByZWNlaXB0SW1hZ2U6IHVwZGF0ZXMucmVjZWlwdEltYWdlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kQ2FzaFRyYW5zYWN0aW9uQWN0aW9uKGlkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCBkYi5jYXNoVHJhbnNhY3Rpb24uZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkIH0sXHJcbiAgICAgICAgICAgIHNlbGVjdDogeyBhY2NvdW50SWQ6IHRydWUgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cmFuc2FjdGlvbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgY2FzaCB0cmFuc2FjdGlvbjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDYXNoVHJhbnNhY3Rpb25BY3Rpb24oaWQ6IHN0cmluZywgbG9jYXRpb25JZDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGRiLiR0cmFuc2FjdGlvbihhc3luYyAodHg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0eC5pbnN0YWxsbWVudFBheW1lbnQudXBkYXRlTWFueSh7XHJcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBjYXNoVHJhbnNhY3Rpb25JZDogaWQgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY2FzaFRyYW5zYWN0aW9uSWQ6IG51bGwgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IHR4LmNhc2hUcmFuc2FjdGlvbi5kZWxldGUoe1xyXG4gICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQsIGxvY2F0aW9uSWQgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoJy9maW5hbmNlJyk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGNhc2ggdHJhbnNhY3Rpb246JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb3VudE9wZW5pbmdCYWxhbmNlQWN0aW9uKGFjY291bnRJZDogc3RyaW5nLCBsb2NhdGlvbklkOiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGRiLmNhc2hBY2NvdW50LmZpbmRGaXJzdCh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBhY2NvdW50SWQsIGxvY2F0aW9uSWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG9wZW5pbmdCYWxhbmNlOiB0cnVlIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogTnVtYmVyKGFjY291bnQ/Lm9wZW5pbmdCYWxhbmNlIHx8IDApIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgb3BlbmluZyBiYWxhbmNlOicsIGVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1bGtDYXNoVHJhbnNhY3Rpb25zQWN0aW9uKHRyYW5zYWN0aW9uczogYW55W10pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBkYXRhIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAndHJhbnNmZXInICYmIGRhdGEudG9BY2NvdW50SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogJ3RyYW5zZmVyX291dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQucHVzaChhd2FpdCB0eC5jYXNoVHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6IGRhdGEubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogZGF0YS50b0FjY291bnRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogZGF0YS5hbW91bnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblR5cGU6ICd0cmFuc2Zlcl9pbicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGRhdGEuY2F0ZWdvcnkgfHwgJ1RyYW5zZmVyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkLnB1c2goYXdhaXQgdHguY2FzaFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbklkOiBkYXRhLmxvY2F0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGRhdGEuYWNjb3VudElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBkYXRhLmFtb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogZGF0YS50cmFuc2FjdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc29uX2luX2NoYXJnZTogZGF0YS5wZXJzb25JbkNoYXJnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IGRhdGEudGFncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZSA/IG5ldyBEYXRlKGRhdGEuZGF0ZSkgOiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogZGF0YS5wYXltZW50TWV0aG9kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjZWlwdEltYWdlOiBkYXRhLnJlY2VpcHRJbWFnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXZhbGlkYXRlUGF0aCgnL2ZpbmFuY2UnKTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBidWxrIHRyYW5zYWN0aW9uczonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIwU0Ftb0JzQiwwTUFBQSJ9
}),
]);

//# sourceMappingURL=src_app_actions_d760d930._.js.map