(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,487779,e=>{"use strict";var s=e.i(843476),t=e.i(271645),a=e.i(107233),l=e.i(607486),i=e.i(727612),r=e.i(788699),n=e.i(643531),d=e.i(367240),o=e.i(440160),c=e.i(569074),m=e.i(270756),u=e.i(98919),x=e.i(519455),h=e.i(515288),p=e.i(487486),g=e.i(793479),j=e.i(110204),f=e.i(868499),b=e.i(422713),w=e.i(908406),N=e.i(776639);let v=({open:e,onOpenChange:a})=>{let[l,i]=(0,t.useState)(""),[r,n]=(0,t.useState)(!1),{createBusiness:d}=(0,b.useBusiness)(),{toast:o}=(0,w.useToast)();(0,t.useEffect)(()=>{e||(i(""),n(!1))},[e]);let c=async e=>{if(e.preventDefault(),!l.trim())return void o({title:"Error",description:"Business name is required",variant:"destructive"});n(!0);try{console.log("Creating business with name:",l.trim()),await d(l.trim())?(o({title:"Success",description:"Business created successfully"}),i(""),a(!1)):o({title:"Error",description:"Failed to create business",variant:"destructive"})}catch(e){console.error("Error creating business:",e),o({title:"Error",description:"Failed to create business",variant:"destructive"})}finally{n(!1)}};return(0,s.jsx)(N.Dialog,{open:e,onOpenChange:a,children:(0,s.jsxs)(N.DialogContent,{className:"sm:max-w-md",onOpenAutoFocus:e=>e.preventDefault(),children:[(0,s.jsx)(N.DialogHeader,{children:(0,s.jsx)(N.DialogTitle,{children:"Create New Business"})}),(0,s.jsxs)("form",{onSubmit:c,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(j.Label,{htmlFor:"businessName",children:"Business Name"}),(0,s.jsx)(g.Input,{id:"businessName",type:"text",value:l,onChange:e=>{console.log("Input value changing to:",e.target.value),i(e.target.value)},placeholder:"Enter business name",disabled:r,autoComplete:"off",className:"w-full"})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,s.jsx)(x.Button,{type:"button",variant:"outline",onClick:()=>{i(""),a(!1)},disabled:r,children:"Cancel"}),(0,s.jsx)(x.Button,{type:"submit",disabled:r||!l.trim(),children:r?"Creating...":"Create Business"})]})]})]})})},y=({open:e,onOpenChange:t,onConfirm:a,businessName:l})=>(0,s.jsx)(f.AlertDialog,{open:e,onOpenChange:t,children:(0,s.jsxs)(f.AlertDialogContent,{className:"mx-4 max-w-md",children:[(0,s.jsxs)(f.AlertDialogHeader,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"p-2 bg-amber-100 rounded-lg",children:(0,s.jsx)(d.RotateCcw,{className:"h-5 w-5 text-amber-600"})}),(0,s.jsx)(f.AlertDialogTitle,{children:"Reset Business Location"})]}),(0,s.jsxs)(f.AlertDialogDescription,{className:"text-sm space-y-2",children:[(0,s.jsxs)("p",{className:"font-medium text-gray-900",children:['Are you sure you want to reset "',l,'"?']}),(0,s.jsx)("p",{children:"This will permanently delete ALL data for this business location including:"}),(0,s.jsxs)("ul",{className:"list-disc list-inside text-xs space-y-1 ml-2",children:[(0,s.jsx)("li",{children:"All products and inventory"}),(0,s.jsx)("li",{children:"All sales records and receipts"}),(0,s.jsx)("li",{children:"All customers and their data"}),(0,s.jsx)("li",{children:"All expenses and transactions"}),(0,s.jsx)("li",{children:"All cash accounts and balances"}),(0,s.jsx)("li",{children:"All tasks and categories"}),(0,s.jsx)("li",{children:"All business settings"})]}),(0,s.jsx)("p",{className:"font-medium text-red-600 mt-2",children:"This action cannot be undone!"})]})]}),(0,s.jsxs)(f.AlertDialogFooter,{className:"flex-col-reverse md:flex-row gap-2",children:[(0,s.jsx)(f.AlertDialogCancel,{className:"w-full md:w-auto",children:"Cancel"}),(0,s.jsx)(f.AlertDialogAction,{onClick:a,className:"w-full md:w-auto bg-amber-600 hover:bg-amber-700 text-white",children:"Reset Business"})]})]})});var C=e.i(168148),D=e.i(102594),B=e.i(846696),S=e.i(95187);let k=(0,S.createServerReference)("60cb37a955a3f0fc9842da415e4b6b6c26c486a212",S.callServer,void 0,S.findSourceMapURL,"getBusinessBackupDataAction"),A=()=>{let[e,s]=(0,t.useState)(!1),[a,l]=(0,t.useState)(!1),[i,r]=(0,t.useState)(0),{user:n}=(0,D.useAuth)(),{currentBusiness:d}=(0,b.useBusiness)();return{exportBusinessData:async()=>{if(!n||!d)return void B.toast.error("No business selected for backup");s(!0),r(10);try{let e=await k(n.id,d.id);if(!e.success)throw Error(e.error||"Export failed");r(90);let s={metadata:{version:"1.0",timestamp:new Date().toISOString(),businessName:d.name,businessId:d.id,exportType:"full_backup"},data:e.data},t=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download=`${d.name.replace(/[^a-zA-Z0-9]/g,"_")}_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a),r(100),B.toast.success("Backup completed successfully")}catch(e){console.error("Backup failed:",e),B.toast.error("Backup failed. Please try again.")}finally{s(!1),r(0)}},importBusinessData:async e=>(B.toast.error("Data import is not yet supported with the new Prisma backend. Please contact support."),!1),isExporting:e,isImporting:a,progress:i}},P=({open:e,onOpenChange:t})=>{let{exportBusinessData:a,isExporting:l,progress:i}=A(),{currentBusiness:r}=(0,b.useBusiness)(),n=async()=>{await a(),l||t(!1)};return(0,s.jsx)(N.Dialog,{open:e,onOpenChange:t,children:(0,s.jsxs)(N.DialogContent,{className:"sm:max-w-md",children:[(0,s.jsxs)(N.DialogHeader,{children:[(0,s.jsxs)(N.DialogTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(o.Download,{className:"h-5 w-5"}),"Backup Business Data"]}),(0,s.jsxs)(N.DialogDescription,{children:["Export all your business data including products, sales, customers, expenses, and settings.",r&&(0,s.jsxs)("span",{className:"block mt-2 font-medium text-foreground",children:["Business: ",r.name]})]})]}),l&&(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Preparing backup... ",i.toFixed(0),"%"]}),(0,s.jsx)(C.Progress,{value:i,className:"w-full"})]}),(0,s.jsxs)(N.DialogFooter,{className:"flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",children:[(0,s.jsx)(x.Button,{variant:"outline",onClick:()=>t(!1),disabled:l,children:"Cancel"}),(0,s.jsx)(x.Button,{onClick:n,disabled:l||!r,children:l?"Exporting...":"Start Backup"})]})]})})};var T=e.i(878894),R=e.i(929592);let E=({open:e,onOpenChange:a})=>{let{importBusinessData:l,isImporting:i,progress:r}=A(),{currentBusiness:n}=(0,b.useBusiness)(),[d,o]=(0,t.useState)(null),[m,u]=(0,t.useState)(!1),h=(0,t.useRef)(null),p=async()=>{!d||await l(d)&&(a(!1),o(null),u(!1))},g=()=>{a(!1),o(null),u(!1),h.current&&(h.current.value="")};return(0,s.jsx)(N.Dialog,{open:e,onOpenChange:g,children:(0,s.jsxs)(N.DialogContent,{className:"sm:max-w-md",children:[(0,s.jsxs)(N.DialogHeader,{children:[(0,s.jsxs)(N.DialogTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Upload,{className:"h-5 w-5"}),"Restore Business Data"]}),(0,s.jsxs)(N.DialogDescription,{children:["Import business data from a backup file. This will replace all current data.",n&&(0,s.jsxs)("span",{className:"block mt-2 font-medium text-foreground",children:["Target Business: ",n.name]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[!d&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center border-2 border-dashed border-border rounded-lg p-6",children:[(0,s.jsx)(c.Upload,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Select a backup file to restore"}),(0,s.jsx)(x.Button,{variant:"outline",onClick:()=>h.current?.click(),disabled:i,children:"Choose File"}),(0,s.jsx)("input",{ref:h,type:"file",accept:".json",onChange:e=>{let s=e.target.files?.[0];s&&("application/json"===s.type||s.name.endsWith(".json")?(o(s),u(!0)):alert("Please select a valid JSON backup file"))},className:"hidden"})]}),d&&!i&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"p-3 bg-muted rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Selected File:"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:d.name}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(d.size/1024).toFixed(1)," KB"]})]}),m&&(0,s.jsxs)(R.Alert,{children:[(0,s.jsx)(T.AlertTriangle,{className:"h-4 w-4"}),(0,s.jsxs)(R.AlertDescription,{children:[(0,s.jsx)("strong",{children:"Warning:"})," This will permanently replace all current business data including products, sales, customers, and settings. This action cannot be undone."]})]})]}),i&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Restoring data... ",r.toFixed(0),"%"]}),(0,s.jsx)(C.Progress,{value:r,className:"w-full"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"Please don't close this window. The app will reload automatically when complete."})]})]}),(0,s.jsxs)(N.DialogFooter,{className:"flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",children:[(0,s.jsx)(x.Button,{variant:"outline",onClick:g,disabled:i,children:"Cancel"}),d&&(0,s.jsx)(x.Button,{onClick:p,disabled:i||!n,variant:"destructive",children:i?"Restoring...":"Restore Data"})]})]})})};var F=e.i(554527),O=e.i(286536),_=e.i(77705);let L=(0,e.i(475254).default)("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]),z=({open:e,onOpenChange:a,businessId:l,businessName:i,hasPassword:r,onPasswordSet:n,onSetPassword:d,onRemovePassword:o})=>{let[c,h]=(0,t.useState)(""),[p,b]=(0,t.useState)(""),[v,y]=(0,t.useState)(!1),[C,D]=(0,t.useState)(!1),[B,S]=(0,t.useState)(!1),[k,A]=(0,t.useState)(!1),[P,T]=(0,t.useState)(!1),[R,E]=(0,t.useState)(""),[F,z]=(0,t.useState)(!1),{toast:I}=(0,w.useToast)(),U=async e=>{if(e.preventDefault(),c.length<6?(I({title:"Password Too Short",description:"Password must be at least 6 characters long.",variant:"destructive"}),!1):c===p||(I({title:"Passwords Don't Match",description:"Please make sure both passwords are identical.",variant:"destructive"}),!1)){S(!0);try{await d(l,c)&&(n(l,!0),h(""),b(""),a(!1),I({title:"Password Set Successfully",description:`Business "${i}" is now password protected.`}),setTimeout(()=>{window.location.reload()},1e3))}catch(e){console.error("Error setting password:",e),I({title:"Failed to Set Password",description:"Please try again later.",variant:"destructive"})}finally{S(!1)}}},H=async()=>{if(!R.trim())return void I({title:"Password Required",description:"Please enter the current password to remove protection.",variant:"destructive"});S(!0);try{await o(l,R)&&(n(l,!1),A(!1),T(!1),E(""),a(!1),I({title:"Password Removed",description:`Business "${i}" is no longer password protected.`}),setTimeout(()=>{window.location.reload()},1e3))}catch(e){console.error("Error removing password:",e),I({title:"Failed to Remove Password",description:"Please try again later.",variant:"destructive"})}finally{S(!1)}},$=()=>{T(!0)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.Dialog,{open:e,onOpenChange:a,children:(0,s.jsxs)(N.DialogContent,{className:"sm:max-w-md",children:[(0,s.jsxs)(N.DialogHeader,{className:"text-center",children:[(0,s.jsx)("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10",children:r?(0,s.jsx)(u.Shield,{className:"h-6 w-6 text-primary"}):(0,s.jsx)(L,{className:"h-6 w-6 text-muted-foreground"})}),(0,s.jsx)(N.DialogTitle,{className:"text-xl",children:r?"Change Business Password":"Set Business Password"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:r?`Update the password for "${i}"`:`Set a password to protect access to "${i}"`})]}),r?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"text-center p-4 rounded-lg bg-muted/50",children:[(0,s.jsx)(m.Lock,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"This business is currently password protected"})]}),P?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"p-4 rounded-lg bg-amber-50 border border-amber-200",children:[(0,s.jsx)("p",{className:"text-sm text-amber-800 font-medium mb-2",children:"Enter current password to remove protection"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(g.Input,{type:F?"text":"password",value:R,onChange:e=>E(e.target.value),placeholder:"Enter current password",disabled:B,className:"pr-10"}),(0,s.jsx)(x.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>z(!F),disabled:B,children:F?(0,s.jsx)(_.EyeOff,{className:"h-4 w-4 text-muted-foreground"}):(0,s.jsx)(O.Eye,{className:"h-4 w-4 text-muted-foreground"})})]})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(x.Button,{variant:"outline",onClick:()=>{T(!1),E("")},disabled:B,className:"flex-1",children:"Cancel"}),(0,s.jsx)(x.Button,{variant:"destructive",onClick:H,disabled:B||!R.trim(),className:"flex-1",children:B?"Removing...":"Remove Password"})]})]}):(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(x.Button,{variant:"destructive",onClick:$,disabled:B,className:"w-full max-w-xs",children:"Remove Password"})})]}):null,(!r||c||p)&&(0,s.jsxs)("form",{onSubmit:U,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(j.Label,{htmlFor:"new-password",children:"New Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(g.Input,{id:"new-password",type:v?"text":"password",value:c,onChange:e=>h(e.target.value),placeholder:"Enter new password (min 6 characters)",disabled:B,className:"pr-10"}),(0,s.jsx)(x.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>y(!v),disabled:B,children:v?(0,s.jsx)(_.EyeOff,{className:"h-4 w-4 text-muted-foreground"}):(0,s.jsx)(O.Eye,{className:"h-4 w-4 text-muted-foreground"})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(j.Label,{htmlFor:"confirm-password",children:"Confirm Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(g.Input,{id:"confirm-password",type:C?"text":"password",value:p,onChange:e=>b(e.target.value),placeholder:"Confirm new password",disabled:B,className:"pr-10"}),(0,s.jsx)(x.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>D(!C),disabled:B,children:C?(0,s.jsx)(_.EyeOff,{className:"h-4 w-4 text-muted-foreground"}):(0,s.jsx)(O.Eye,{className:"h-4 w-4 text-muted-foreground"})})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,s.jsx)(x.Button,{type:"button",variant:"outline",onClick:()=>{h(""),b(""),y(!1),D(!1),T(!1),E(""),z(!1),a(!1)},disabled:B,className:"flex-1",children:"Cancel"}),(0,s.jsx)(x.Button,{type:"submit",disabled:B||!c.trim()||!p.trim(),className:"flex-1",children:B?"Setting...":r?"Update Password":"Set Password"})]})]})]})}),(0,s.jsx)(f.AlertDialog,{open:k,onOpenChange:A,children:(0,s.jsxs)(f.AlertDialogContent,{children:[(0,s.jsxs)(f.AlertDialogHeader,{children:[(0,s.jsx)(f.AlertDialogTitle,{children:"Remove Password Protection?"}),(0,s.jsxs)(f.AlertDialogDescription,{children:['This will remove password protection from "',i,'". Anyone with access to your account will be able to switch to this business without entering a password.']})]}),(0,s.jsxs)(f.AlertDialogFooter,{children:[(0,s.jsx)(f.AlertDialogCancel,{disabled:B,children:"Cancel"}),(0,s.jsx)(f.AlertDialogAction,{onClick:$,disabled:B,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:B?"Removing...":"Remove Password"})]})]})})]})};var I=e.i(414877),U=e.i(838125),H=e.i(777624);e.s(["default",0,()=>{let{businessLocations:e,currentBusiness:N,switchBusiness:C,updateBusiness:D,deleteBusiness:B,resetBusiness:S,locationLimit:k}=(0,b.useBusiness)(),{toast:A}=(0,w.useToast)(),T=(0,I.useIsMobile)(),{setBusinessPassword:R,verifyBusinessPassword:O,removeBusinessPassword:_,isLoading:L}=(0,U.useBusinessPassword)(),{hasPermission:$}=(0,H.useProfiles)(),M=$("settings","manage"),[K,Y]=(0,t.useState)(!1),[V,q]=(0,t.useState)(!1),[J,W]=(0,t.useState)(!1),[Z,G]=(0,t.useState)(!1),[Q,X]=(0,t.useState)(null),[ee,es]=(0,t.useState)(""),[et,ea]=(0,t.useState)(null),[el,ei]=(0,t.useState)(null),[er,en]=(0,t.useState)(!1),[ed,eo]=(0,t.useState)(!1),[ec,em]=(0,t.useState)(!1),[eu,ex]=(0,t.useState)(null),[eh,ep]=(0,t.useState)(null),eg=async()=>{Q&&ee.trim()&&(await D(Q,ee.trim())?(A({title:"Success",description:"Business name updated successfully"}),X(null),es("")):A({title:"Error",description:"Failed to update business name",variant:"destructive"}))},ej=()=>{X(null),es("")},ef=async()=>{et&&(await B(et)?A({title:"Success",description:"Business deleted successfully"}):A({title:"Error",description:"Failed to delete business",variant:"destructive"}),ea(null))},eb=async()=>{if(el){en(!0),console.log("Starting reset for business:",el);try{await S(el)?(A({title:"Success",description:"Business location has been reset successfully"}),console.log("Reset completed successfully"),setTimeout(()=>window.location.reload(),1500)):(A({title:"Error",description:"Failed to reset business location",variant:"destructive"}),console.error("Reset failed"))}catch(e){console.error("Error during reset:",e),A({title:"Error",description:"Failed to reset business location",variant:"destructive"})}finally{ei(null),en(!1)}}},ew=()=>{let s=e.find(e=>e.id===el);return s?.name||""};return(0,s.jsxs)("div",{className:"space-y-4 md:space-y-6 relative",children:[er&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-white rounded-lg p-6 shadow-xl max-w-sm mx-4 w-full",children:(0,s.jsxs)("div",{className:"text-center space-y-4",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Resetting Business"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:['Clearing all data for "',ew(),'"...',(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"text-xs text-gray-500 mt-1 block",children:"Please don't close this window. This may take a few moments."})]})]})})}),(0,s.jsxs)("div",{className:er?"pointer-events-none opacity-50":"",children:[(0,s.jsx)("div",{className:"space-y-3 md:space-y-2",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Business Management"}),(0,s.jsx)("p",{className:"text-sm md:text-base text-gray-600 mt-1",children:"Manage your business locations and settings"})]}),(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-2",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[M&&(0,s.jsxs)(x.Button,{onClick:()=>W(!0),variant:"outline",className:"flex-1 md:flex-none flex items-center justify-center gap-2",size:"default",disabled:!N||er,children:[(0,s.jsx)(o.Download,{className:"h-4 w-4"}),T?"Backup":"Backup Data"]}),M&&(0,s.jsxs)(x.Button,{onClick:()=>G(!0),variant:"outline",className:"flex-1 md:flex-none flex items-center justify-center gap-2",size:"default",disabled:!N||er,children:[(0,s.jsx)(c.Upload,{className:"h-4 w-4"}),T?"Restore":"Restore Data"]})]}),M&&(0,s.jsxs)(x.Button,{onClick:()=>{e.length>=k?q(!0):Y(!0)},className:"w-full md:w-auto flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700",size:"default",disabled:er,children:[(0,s.jsx)(a.Plus,{className:"h-4 w-4"}),"Create New Business"]})]})]})}),N&&(0,s.jsxs)(h.Card,{className:"border-blue-200 bg-gradient-to-r from-blue-50 to-blue-100/50",children:[(0,s.jsxs)(h.CardHeader,{className:"pb-3",children:[(0,s.jsxs)(h.CardTitle,{className:"flex items-center gap-2 text-blue-800 text-lg md:text-xl",children:[(0,s.jsx)("div",{className:"p-2 bg-blue-200 rounded-lg",children:(0,s.jsx)(l.Building2,{className:"h-5 w-5"})}),"Current Business"]}),(0,s.jsx)(h.CardDescription,{className:"text-blue-600 text-sm",children:"You are currently working with this business"})]}),(0,s.jsx)(h.CardContent,{className:"pt-0",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"font-semibold text-lg md:text-xl text-blue-900",children:N.name}),(0,s.jsxs)("p",{className:"text-sm text-blue-600",children:["Created: ",new Date(N.created_at).toLocaleDateString()]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[N.is_default&&(0,s.jsx)(p.Badge,{variant:"secondary",className:"bg-blue-100 text-blue-700 text-xs",children:"Default"}),(0,s.jsx)(p.Badge,{className:"bg-green-500 text-white text-xs",children:"Active"})]})]})})]}),(0,s.jsxs)(h.Card,{className:"shadow-sm",children:[(0,s.jsxs)(h.CardHeader,{className:"pb-4",children:[(0,s.jsx)(h.CardTitle,{className:"text-lg md:text-xl",children:"All Businesses"}),(0,s.jsx)(h.CardDescription,{className:"text-sm",children:"Manage your business locations. You can switch between them, edit their names, reset them, or delete them."})]}),(0,s.jsx)(h.CardContent,{children:(0,s.jsx)("div",{className:"space-y-3",children:0===e.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"p-4 bg-gray-100 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:(0,s.jsx)(l.Building2,{className:"h-10 w-10 text-gray-400"})}),(0,s.jsx)("p",{className:"text-gray-600 font-medium",children:"No businesses found"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Create your first business to get started"})]}):e.map(e=>(0,s.jsx)("div",{className:`p-4 border rounded-xl transition-all ${N?.id===e.id?"border-blue-300 bg-blue-50/50 shadow-sm":"border-gray-200 bg-white hover:bg-gray-50"}`,children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,s.jsx)("div",{className:`p-2 rounded-lg ${N?.id===e.id?"bg-blue-200":"bg-gray-100"}`,children:(0,s.jsx)(l.Building2,{className:"h-5 w-5 text-gray-600"})}),(0,s.jsx)("div",{className:"flex-1 min-w-0",children:Q===e.id?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(j.Label,{htmlFor:`edit-${e.id}`,className:"text-sm font-medium",children:"Business Name"}),(0,s.jsx)(g.Input,{id:`edit-${e.id}`,value:ee,onChange:e=>es(e.target.value),className:"h-9",onKeyDown:e=>{"Enter"===e.key&&eg(),"Escape"===e.key&&ej()},autoFocus:!0})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 text-base",children:e.name}),e.switch_password_hash&&(0,s.jsx)(m.Lock,{className:"h-4 w-4 text-amber-500"}),e.is_default&&(0,s.jsx)(p.Badge,{variant:"outline",className:"text-xs",children:"Default"}),N?.id===e.id&&(0,s.jsx)(p.Badge,{className:"text-xs bg-green-500 text-white",children:"Current"})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Created: ",new Date(e.created_at).toLocaleDateString(),e.switch_password_hash&&(0,s.jsx)("span",{className:"text-amber-600 ml-2",children:"â€¢ Password Protected"})]})]})})]}),(0,s.jsx)("div",{className:"flex items-center gap-2 md:flex-shrink-0",children:Q===e.id?(0,s.jsxs)("div",{className:"flex gap-2 w-full md:w-auto",children:[(0,s.jsxs)(x.Button,{size:"sm",onClick:eg,className:"flex-1 md:flex-none",children:[(0,s.jsx)(n.Check,{className:"h-4 w-4 md:mr-1"}),(0,s.jsx)("span",{className:"md:inline",children:"Save"})]}),(0,s.jsx)(x.Button,{size:"sm",variant:"outline",onClick:ej,className:"flex-1 md:flex-none",children:"Cancel"})]}):(0,s.jsxs)("div",{className:"flex gap-2 w-full md:w-auto",children:[N?.id!==e.id&&(0,s.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>{C(e.id,(e,s,t)=>{ex({businessId:e,businessName:s,onVerified:t}),eo(!0)})},className:"flex-1 md:flex-none text-sm",disabled:er,children:"Switch To"}),M&&(0,s.jsx)(x.Button,{size:"sm",variant:"ghost",onClick:()=>{var s,t;return s=e.id,t=e.name,void(X(s),es(t))},className:"p-2",disabled:er,children:(0,s.jsx)(r.Pencil,{className:"h-4 w-4"})}),M&&(0,s.jsx)(x.Button,{size:"sm",variant:"ghost",onClick:()=>{ep(e.id),em(!0)},className:"p-2 text-purple-600 hover:text-purple-700 hover:bg-purple-50",title:e.switch_password_hash?"Manage Password":"Set Password",disabled:er,children:(0,s.jsx)(u.Shield,{className:"h-4 w-4"})}),M&&(0,s.jsx)(x.Button,{size:"sm",variant:"ghost",onClick:()=>ei(e.id),className:"p-2 text-amber-600 hover:text-amber-700 hover:bg-amber-50",disabled:er,children:(0,s.jsx)(d.RotateCcw,{className:"h-4 w-4"})}),!e.is_default&&M&&(0,s.jsx)(x.Button,{size:"sm",variant:"ghost",onClick:()=>ea(e.id),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50",disabled:er,children:(0,s.jsx)(i.Trash2,{className:"h-4 w-4"})})]})})]})},e.id))})})]})]}),(0,s.jsx)(v,{open:K,onOpenChange:Y}),(0,s.jsx)(P,{open:J,onOpenChange:W}),(0,s.jsx)(E,{open:Z,onOpenChange:G}),(0,s.jsx)(y,{open:!!el,onOpenChange:()=>ei(null),onConfirm:eb,businessName:ew()}),(0,s.jsx)(F.BusinessPasswordDialog,{open:ed,onOpenChange:eo,businessName:eu?.businessName||"",onPasswordVerified:()=>{eu&&(eu.onVerified(),A({title:"Business Switched",description:"You are now working with the selected business"}))},onVerifyPassword:async e=>!!eu&&await O(eu.businessId,e)}),eh&&(0,s.jsx)(z,{open:ec,onOpenChange:em,businessId:eh,businessName:e.find(e=>e.id===eh)?.name||"",hasPassword:!!e.find(e=>e.id===eh)?.switch_password_hash,onPasswordSet:(s,t)=>{e.map(e=>e.id===s?{...e,switch_password_hash:t?"has_password":void 0}:e)},onSetPassword:R,onRemovePassword:async(e,s)=>!!await O(e,s)&&await _(e)}),(0,s.jsx)(f.AlertDialog,{open:!!et,onOpenChange:()=>ea(null),children:(0,s.jsxs)(f.AlertDialogContent,{className:"mx-4 max-w-md",children:[(0,s.jsxs)(f.AlertDialogHeader,{children:[(0,s.jsx)(f.AlertDialogTitle,{children:"Delete Business"}),(0,s.jsx)(f.AlertDialogDescription,{className:"text-sm",children:"Are you sure you want to delete this business? This action cannot be undone and will permanently delete all associated data including products, sales, customers, and expenses."})]}),(0,s.jsxs)(f.AlertDialogFooter,{className:"flex-col-reverse md:flex-row gap-2",children:[(0,s.jsx)(f.AlertDialogCancel,{className:"w-full md:w-auto",children:"Cancel"}),(0,s.jsx)(f.AlertDialogAction,{onClick:ef,className:"w-full md:w-auto bg-red-600 hover:bg-red-700",children:"Delete"})]})]})}),(0,s.jsx)(f.AlertDialog,{open:V,onOpenChange:q,children:(0,s.jsxs)(f.AlertDialogContent,{className:"mx-4 max-w-md",children:[(0,s.jsxs)(f.AlertDialogHeader,{children:[(0,s.jsxs)(f.AlertDialogTitle,{className:"flex items-center gap-2 text-amber-600",children:[(0,s.jsx)(u.Shield,{className:"h-5 w-5"}),"Location Limit Reached"]}),(0,s.jsx)(f.AlertDialogDescription,{className:"text-sm pt-2",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("p",{className:"font-medium text-foreground",children:["You have reached the maximum allowed limit of ",(0,s.jsxs)("span",{className:"font-bold text-amber-600",children:[k," locations"]}),"."]}),(0,s.jsxs)("div",{className:"bg-muted/50 p-4 rounded-lg border border-border/50 text-sm space-y-2",children:[(0,s.jsx)("p",{children:"To add more locations, please contact Admin support:"}),(0,s.jsx)("a",{href:"tel:+256758519696",className:"block text-primary font-bold text-lg hover:underline",children:"+256 758519696"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground italic",children:"Note: Additional charges may apply for increasing your location limit."})]})]})})]}),(0,s.jsx)(f.AlertDialogFooter,{children:(0,s.jsx)(f.AlertDialogCancel,{className:"w-full",children:"Close"})})]})})]})}],487779)}]);