(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,825092,(e,t,a)=>{var s=e.r(590174),r=e.r(789292),n=e.r(673869);t.exports=function(e,t){return e&&e.length?s(e,n(t,2),r):void 0}},737517,(e,t,a)=>{var s=e.r(590174),r=e.r(673869),n=e.r(748695);t.exports=function(e,t){return e&&e.length?s(e,r(t,2),n):void 0}},444680,e=>{"use strict";var t=e.i(391398),a=e.i(191788),s=e.i(824216),r=e.i(590977),n=e.i(563905),l=e.i(353533),i=e.i(21860),o=e.i(972733),c=e.i(590255),d=e.i(687072),u=e.i(576255),m=e.i(759279),x=e.i(939310),h=e.i(150064),p=e.i(46108),f=e.i(96539);let g=["Rent & Utilities","Salaries & Wages","Marketing & Advertising","Office Supplies & Equipment","Professional Services","Cost of bringing Goods","Delivery To Customer","Insurance","Licenses, Permits & Fees","Software & Subscriptions","Depreciation & Amortization","Training & Development","Communication","Bank & Transaction Fees","Miscellaneous"],y=()=>{let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(!0),{toast:l}=(0,h.useToast)(),{currentBusiness:i}=(0,p.useBusiness)(),{user:o}=(0,s.useAuth)(),c=(0,a.useCallback)(async()=>{if(!i?.id){t([]),n(!1);return}try{n(!0);let e=await (0,f.getExpenseCategoriesAction)(i.id);if(!e.success||!e.data)throw Error(e.error||"Failed to fetch categories");let a=e.data.map(e=>({...e,createdAt:new Date(e.createdAt)}));if(0===a.length)return void await d();t(a)}catch(e){console.error("Error loading expense categories:",e),l({title:"Error",description:"Failed to load expense categories",variant:"destructive"})}finally{n(!1)}},[i?.id,l]),d=async()=>{if(i?.id&&o?.id)try{(await (0,f.createDefaultExpenseCategoriesAction)(o.id,i.id,g)).success&&await c()}catch(e){console.error("Error creating default categories:",e)}},u=async a=>{if(!i?.id||!o?.id)return null;try{let s=e.find(e=>e.name.toLowerCase()===a.toLowerCase());if(s)return l({title:"Category exists",description:"This category already exists."}),s;let r=await (0,f.createExpenseCategoryAction)({userId:o.id,locationId:i.id,name:a,isDefault:!1});if(!r.success||!r.data)throw Error(r.error);let n={...r.data,createdAt:new Date(r.data.createdAt)};return t(e=>[...e,n]),n}catch(e){return console.error("Error creating category:",e),l({title:"Error",description:"Failed to create category",variant:"destructive"}),null}},m=async e=>{try{let a=await (0,f.deleteExpenseCategoryAction)(e);if(!a.success)throw Error(a.error);return t(t=>t.filter(t=>t.id!==e)),l({title:"Success",description:"Category deleted successfully"}),!0}catch(e){return console.error("Error deleting category:",e),l({title:"Error",description:"Failed to delete category",variant:"destructive"}),!1}};return(0,a.useEffect)(()=>{c()},[c]),{categories:e,isLoading:r,createCategory:u,deleteCategory:m,refreshCategories:c}};var j=e.i(45124),v=e.i(91762),b=e.i(909289),N=e.i(277519),C=e.i(296202),w=e.i(212283),k=e.i(17255),A=e.i(599875);let S=()=>{let{categories:e,createCategory:s,deleteCategory:r}=y(),[n,l]=(0,a.useState)(""),[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),m=async()=>{if(n.trim()){c(!0);try{await s(n.trim())&&l("")}finally{c(!1)}}},h=async e=>{c(!0);try{await r(e)}finally{c(!1)}};return(0,t.jsxs)(C.Dialog,{open:d,onOpenChange:u,children:[(0,t.jsx)(C.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(x.Button,{variant:"outline",className:"gap-2",children:[(0,t.jsx)(N.Tag,{className:"h-4 w-4"}),"Expense Categories"]})}),(0,t.jsxs)(C.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(C.DialogHeader,{children:[(0,t.jsx)(C.DialogTitle,{children:"Expense Categories"}),(0,t.jsx)(C.DialogDescription,{children:"Manage your expense categories."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v.Label,{htmlFor:"newCategory",children:"Add New Category"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(j.Input,{id:"newCategory",placeholder:"Enter category name",value:n,onChange:e=>l(e.target.value),onKeyPress:e=>"Enter"===e.key&&m()}),(0,t.jsx)(x.Button,{onClick:m,disabled:!n.trim()||i,size:"sm",children:(0,t.jsx)(o.Plus,{className:"h-4 w-4"})})]})]}),(0,t.jsx)("div",{className:"space-y-3",children:e.length>0?(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Categories"}),(0,t.jsx)(k.ScrollArea,{className:"h-64 rounded-md border p-2",children:(0,t.jsx)("div",{className:"space-y-1",children:e.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-md hover:bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(N.Tag,{className:"h-3 w-3 text-gray-500"}),(0,t.jsx)("span",{className:"text-sm",children:e.name}),e.isDefault&&(0,t.jsx)(A.Badge,{variant:"secondary",className:"text-xs",children:"Default"})]}),(0,t.jsxs)(w.AlertDialog,{children:[(0,t.jsx)(w.AlertDialogTrigger,{asChild:!0,children:(0,t.jsx)(x.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:(0,t.jsx)(b.Trash2,{className:"h-3 w-3 text-red-500"})})}),(0,t.jsxs)(w.AlertDialogContent,{children:[(0,t.jsxs)(w.AlertDialogHeader,{children:[(0,t.jsx)(w.AlertDialogTitle,{children:"Delete Category"}),(0,t.jsxs)(w.AlertDialogDescription,{children:['Are you sure you want to delete "',e.name,'"? This action cannot be undone.']})]}),(0,t.jsxs)(w.AlertDialogFooter,{children:[(0,t.jsx)(w.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(w.AlertDialogAction,{onClick:()=>h(e.id),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]})]},e.id))})})]}):(0,t.jsx)("div",{className:"text-center py-4 text-sm text-gray-500",children:"No categories yet. Add one above to get started."})})]}),(0,t.jsx)(C.DialogFooter,{children:(0,t.jsx)(C.DialogClose,{asChild:!0,children:(0,t.jsx)(x.Button,{variant:"outline",children:"Close"})})})]})]})};var T=e.i(30691);let E=({onAddExpense:e,onAddBulkExpense:a,onImportExpenses:s,onRefresh:r,isRefreshing:n,onExportCSV:l,onExportPDF:i,onDownloadTemplate:h,canCreate:p=!0})=>{let f=(0,T.useIsMobile)();return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h1",{className:"text-2xl md:text-3xl font-bold",children:"Expenses"}),(0,t.jsx)("p",{className:"text-sm md:text-base text-muted-foreground",children:"Track and manage your business expenses"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 sm:gap-3",children:[p&&(0,t.jsxs)(x.Button,{onClick:e,className:"gap-2 text-sm bg-red-600 hover:bg-red-700 shadow-sm",size:f?"sm":"default",children:[(0,t.jsx)(o.Plus,{className:"h-4 w-4"}),"Add Expense"]}),(0,t.jsxs)(x.Button,{variant:"outline",onClick:r,disabled:n,className:"gap-2 text-sm",size:f?"sm":"default",children:[(0,t.jsx)(c.RefreshCcw,{className:`h-4 w-4 ${n?"animate-spin":""}`}),"Refresh"]}),(0,t.jsxs)(x.Button,{variant:"outline",onClick:h,className:"gap-2 text-sm border-green-200 dark:border-green-900/30 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/10",size:f?"sm":"default",children:[(0,t.jsx)(d.Download,{className:"h-4 w-4"}),"Template"]}),(0,t.jsx)("div",{className:"hidden sm:block",children:(0,t.jsx)(S,{})})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2 pt-1 border-t border-slate-100 dark:border-slate-800/50 mt-2",children:[p&&(0,t.jsxs)(x.Button,{variant:"ghost",onClick:a,className:"gap-2 text-xs h-8 px-3 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/10",children:[(0,t.jsx)(o.Plus,{className:"h-3.5 w-3.5"}),"Bulk Entry"]}),p&&(0,t.jsxs)(x.Button,{variant:"ghost",onClick:s,className:"gap-2 text-xs h-8 px-3 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/10",children:[(0,t.jsx)(m.Upload,{className:"h-3.5 w-3.5"}),"Import"]}),(0,t.jsx)("div",{className:"h-4 w-[1px] bg-slate-200 dark:bg-slate-700 mx-1"}),l&&(0,t.jsxs)(x.Button,{variant:"ghost",onClick:l,className:"gap-2 text-xs h-8 px-3 text-slate-600 dark:text-slate-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/10",children:[(0,t.jsx)(u.FileText,{className:"h-3.5 w-3.5"}),"CSV Export"]}),i&&(0,t.jsxs)(x.Button,{variant:"ghost",onClick:i,className:"gap-2 text-xs h-8 px-3 text-slate-600 dark:text-slate-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/10",children:[(0,t.jsx)(u.FileText,{className:"h-3.5 w-3.5"}),"PDF Export"]}),(0,t.jsx)("div",{className:"sm:hidden block ml-auto",children:(0,t.jsx)(S,{})})]})]})};var D=e.i(426119),P=e.i(89635);let I=({totalExpenses:e,thisMonthExpenses:a,transactionCount:s,formatCurrency:r,dateFilter:n})=>{let{canViewTotalExpenses:l}=(0,P.useFinancialVisibility)();return(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)(D.Card,{children:[(0,t.jsx)(D.CardHeader,{className:"pb-3",children:(0,t.jsxs)(D.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:["Total Expenses (","all"===n?"All Time":n.replace("-"," ").replace(/\b\w/g,e=>e.toUpperCase()),")"]})}),(0,t.jsx)(D.CardContent,{children:(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600",children:l?r(e):"•••"})})]}),(0,t.jsxs)(D.Card,{children:[(0,t.jsx)(D.CardHeader,{className:"pb-3",children:(0,t.jsx)(D.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"This Month"})}),(0,t.jsx)(D.CardContent,{children:(0,t.jsx)("div",{className:"text-2xl font-bold",children:l?r(a):"•••"})})]}),(0,t.jsxs)(D.Card,{children:[(0,t.jsx)(D.CardHeader,{className:"pb-3",children:(0,t.jsx)(D.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total Transactions"})}),(0,t.jsx)(D.CardContent,{children:(0,t.jsx)("div",{className:"text-2xl font-bold",children:s})})]})]})},O=({filteredExpenses:e,formatCurrency:a})=>(0,t.jsxs)(D.Card,{children:[(0,t.jsx)(D.CardHeader,{className:"pb-3 md:pb-6",children:(0,t.jsx)(D.CardTitle,{className:"text-lg md:text-xl",children:"Recent Expenses"})}),(0,t.jsx)(D.CardContent,{className:"px-3 md:px-6",children:0===e.length?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"No expenses found for the selected period."})}):(0,t.jsx)("div",{className:"space-y-4",children:e.slice(0,10).map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("div",{className:"font-medium",children:e.description}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.date.toLocaleDateString()," • ",e.category||"Uncategorized"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"font-semibold text-red-600",children:a(e.amount)}),e.cashAccountId&&(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"Linked to Cash"})]})]},e.id))})})]});var F=e.i(550292),M=e.i(397250),L=e.i(335716),R=e.i(56206),B=e.i(379472),z=e.i(328233),V=e.i(106043),_=["points","className","baseLinePoints","connectNulls"];function H(){return(H=Object.assign.bind()).apply(this,arguments)}function U(e){return function(e){if(Array.isArray(e))return K(e)}(e)||function(e){if("u">typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return K(e,void 0);var a=Object.prototype.toString.call(e).slice(8,-1);if("Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return K(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,s=Array(t);a<t;a++)s[a]=e[a];return s}var $=function(e){return e&&e.x===+e.x&&e.y===+e.y},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[[]];return e.forEach(function(e){$(e)?t[t.length-1].push(e):t[t.length-1].length>0&&t.push([])}),$(e[0])&&t[t.length-1].push(e[0]),t[t.length-1].length<=0&&(t=t.slice(0,-1)),t},Y=function(e,t){var a=W(e);t&&(a=[a.reduce(function(e,t){return[].concat(U(e),U(t))},[])]);var s=a.map(function(e){return e.reduce(function(e,t,a){return"".concat(e).concat(0===a?"M":"L").concat(t.x,",").concat(t.y)},"")}).join("");return 1===a.length?"".concat(s,"Z"):s},X=function(e,t,a){var s=Y(e,a);return"".concat("Z"===s.slice(-1)?s.slice(0,-1):s,"L").concat(Y(t.reverse(),a).slice(1))},q=function(e){var t=e.points,s=e.className,r=e.baseLinePoints,n=e.connectNulls,l=function(e,t){if(null==e)return{};var a,s,r=function(e,t){if(null==e)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}(e,_);if(!t||!t.length)return null;var i=(0,R.default)("recharts-polygon",s);if(r&&r.length){var o=l.stroke&&"none"!==l.stroke,c=X(t,r,n);return a.default.createElement("g",{className:i},a.default.createElement("path",H({},(0,V.filterProps)(l,!0),{fill:"Z"===c.slice(-1)?l.fill:"none",stroke:"none",d:c})),o?a.default.createElement("path",H({},(0,V.filterProps)(l,!0),{fill:"none",d:Y(t,n)})):null,o?a.default.createElement("path",H({},(0,V.filterProps)(l,!0),{fill:"none",d:Y(r,n)})):null)}var d=Y(t,n);return a.default.createElement("path",H({},(0,V.filterProps)(l,!0),{fill:"Z"===d.slice(-1)?l.fill:"none",className:i,d:d}))},G=e.i(61320),Z=e.i(778979),J=e.i(193555);function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(){return(ee=Object.assign.bind()).apply(this,arguments)}function et(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}function ea(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?et(Object(a),!0).forEach(function(t){ei(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):et(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function es(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,eo(s.key),s)}}function er(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(er=function(){return!!e})()}function en(e){return(en=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function el(e,t){return(el=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ei(e,t,a){return(t=eo(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function eo(e){var t=function(e,t){if("object"!=Q(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=Q(s))return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Q(t)?t:t+""}var ec=Math.PI/180,ed=function(e){var t,s;function r(){var e,t;if(!(this instanceof r))throw TypeError("Cannot call a class as a function");return e=r,t=arguments,e=en(e),function(e,t){if(t&&("object"===Q(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");var a=e;if(void 0===a)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(this,er()?Reflect.construct(e,t||[],en(this).constructor):e.apply(this,t))}if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");return r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&el(r,e),t=[{key:"getTickLineCoord",value:function(e){var t=this.props,a=t.cx,s=t.cy,r=t.radius,n=t.orientation,l=t.tickSize,i=(0,J.polarToCartesian)(a,s,r,e.coordinate),o=(0,J.polarToCartesian)(a,s,r+("inner"===n?-1:1)*(l||8),e.coordinate);return{x1:i.x,y1:i.y,x2:o.x,y2:o.y}}},{key:"getTickTextAnchor",value:function(e){var t=this.props.orientation,a=Math.cos(-e.coordinate*ec);return a>1e-5?"outer"===t?"start":"end":a<-1e-5?"outer"===t?"end":"start":"middle"}},{key:"renderAxisLine",value:function(){var e=this.props,t=e.cx,s=e.cy,r=e.radius,n=e.axisLine,l=e.axisLineType,i=ea(ea({},(0,V.filterProps)(this.props,!1)),{},{fill:"none"},(0,V.filterProps)(n,!1));if("circle"===l)return a.default.createElement(z.Dot,ee({className:"recharts-polar-angle-axis-line"},i,{cx:t,cy:s,r:r}));var o=this.props.ticks.map(function(e){return(0,J.polarToCartesian)(t,s,r,e.coordinate)});return a.default.createElement(q,ee({className:"recharts-polar-angle-axis-line"},i,{points:o}))}},{key:"renderTicks",value:function(){var e=this,t=this.props,s=t.ticks,n=t.tick,l=t.tickLine,i=t.tickFormatter,o=t.stroke,c=(0,V.filterProps)(this.props,!1),d=(0,V.filterProps)(n,!1),u=ea(ea({},c),{},{fill:"none"},(0,V.filterProps)(l,!1)),m=s.map(function(t,s){var m=e.getTickLineCoord(t),x=ea(ea(ea({textAnchor:e.getTickTextAnchor(t)},c),{},{stroke:"none",fill:o},d),{},{index:s,payload:t,x:m.x2,y:m.y2});return a.default.createElement(B.Layer,ee({className:(0,R.default)("recharts-polar-angle-axis-tick",(0,J.getTickClassName)(n)),key:"tick-".concat(t.coordinate)},(0,Z.adaptEventsOfChild)(e.props,t,s)),l&&a.default.createElement("line",ee({className:"recharts-polar-angle-axis-tick-line"},u,m)),n&&r.renderTickItem(n,x,i?i(t.value,s):t.value))});return a.default.createElement(B.Layer,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var e=this.props,t=e.ticks,s=e.radius,r=e.axisLine;return!(s<=0)&&t&&t.length?a.default.createElement(B.Layer,{className:(0,R.default)("recharts-polar-angle-axis",this.props.className)},r&&this.renderAxisLine(),this.renderTicks()):null}}],s=[{key:"renderTickItem",value:function(e,t,s){return a.default.isValidElement(e)?a.default.cloneElement(e,t):(0,L.default)(e)?e(t):a.default.createElement(G.Text,ee({},t,{className:"recharts-polar-angle-axis-tick-value"}),s)}}],t&&es(r.prototype,t),s&&es(r,s),Object.defineProperty(r,"prototype",{writable:!1}),r}(a.PureComponent);ei(ed,"displayName","PolarAngleAxis"),ei(ed,"axisType","angleAxis"),ei(ed,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var eu=e.i(825092),em=e.i(737517),ex=e.i(905e3),eh=["cx","cy","angle","ticks","axisLine"],ep=["ticks","tick","angle","tickFormatter","stroke"];function ef(e){return(ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eg(){return(eg=Object.assign.bind()).apply(this,arguments)}function ey(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}function ej(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ey(Object(a),!0).forEach(function(t){ek(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ey(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function ev(e,t){if(null==e)return{};var a,s,r=function(e,t){if(null==e)return{};var a={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;a[s]=e[s]}return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function eb(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,eA(s.key),s)}}function eN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(eN=function(){return!!e})()}function eC(e){return(eC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ew(e,t){return(ew=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ek(e,t,a){return(t=eA(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function eA(e){var t=function(e,t){if("object"!=ef(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=ef(s))return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ef(t)?t:t+""}var eS=function(e){var t,s;function r(){var e,t;if(!(this instanceof r))throw TypeError("Cannot call a class as a function");return e=r,t=arguments,e=eC(e),function(e,t){if(t&&("object"===ef(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");var a=e;if(void 0===a)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(this,eN()?Reflect.construct(e,t||[],eC(this).constructor):e.apply(this,t))}if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");return r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&ew(r,e),t=[{key:"getTickValueCoord",value:function(e){var t=e.coordinate,a=this.props,s=a.angle,r=a.cx,n=a.cy;return(0,J.polarToCartesian)(r,n,t,s)}},{key:"getTickTextAnchor",value:function(){var e;switch(this.props.orientation){case"left":e="end";break;case"right":e="start";break;default:e="middle"}return e}},{key:"getViewBox",value:function(){var e=this.props,t=e.cx,a=e.cy,s=e.angle,r=e.ticks,n=(0,eu.default)(r,function(e){return e.coordinate||0});return{cx:t,cy:a,startAngle:s,endAngle:s,innerRadius:(0,em.default)(r,function(e){return e.coordinate||0}).coordinate||0,outerRadius:n.coordinate||0}}},{key:"renderAxisLine",value:function(){var e=this.props,t=e.cx,s=e.cy,r=e.angle,n=e.ticks,l=e.axisLine,i=ev(e,eh),o=n.reduce(function(e,t){return[Math.min(e[0],t.coordinate),Math.max(e[1],t.coordinate)]},[1/0,-1/0]),c=(0,J.polarToCartesian)(t,s,o[0],r),d=(0,J.polarToCartesian)(t,s,o[1],r),u=ej(ej(ej({},(0,V.filterProps)(i,!1)),{},{fill:"none"},(0,V.filterProps)(l,!1)),{},{x1:c.x,y1:c.y,x2:d.x,y2:d.y});return a.default.createElement("line",eg({className:"recharts-polar-radius-axis-line"},u))}},{key:"renderTicks",value:function(){var e=this,t=this.props,s=t.ticks,n=t.tick,l=t.angle,i=t.tickFormatter,o=t.stroke,c=ev(t,ep),d=this.getTickTextAnchor(),u=(0,V.filterProps)(c,!1),m=(0,V.filterProps)(n,!1),x=s.map(function(t,s){var c=e.getTickValueCoord(t),x=ej(ej(ej(ej({textAnchor:d,transform:"rotate(".concat(90-l,", ").concat(c.x,", ").concat(c.y,")")},u),{},{stroke:"none",fill:o},m),{},{index:s},c),{},{payload:t});return a.default.createElement(B.Layer,eg({className:(0,R.default)("recharts-polar-radius-axis-tick",(0,J.getTickClassName)(n)),key:"tick-".concat(t.coordinate)},(0,Z.adaptEventsOfChild)(e.props,t,s)),r.renderTickItem(n,x,i?i(t.value,s):t.value))});return a.default.createElement(B.Layer,{className:"recharts-polar-radius-axis-ticks"},x)}},{key:"render",value:function(){var e=this.props,t=e.ticks,s=e.axisLine,r=e.tick;return t&&t.length?a.default.createElement(B.Layer,{className:(0,R.default)("recharts-polar-radius-axis",this.props.className)},s&&this.renderAxisLine(),r&&this.renderTicks(),ex.Label.renderCallByParent(this.props,this.getViewBox())):null}}],s=[{key:"renderTickItem",value:function(e,t,s){return a.default.isValidElement(e)?a.default.cloneElement(e,t):(0,L.default)(e)?e(t):a.default.createElement(G.Text,eg({},t,{className:"recharts-polar-radius-axis-tick-value"}),s)}}],t&&eb(r.prototype,t),s&&eb(r,s),Object.defineProperty(r,"prototype",{writable:!1}),r}(a.PureComponent);ek(eS,"displayName","PolarRadiusAxis"),ek(eS,"axisType","radiusAxis"),ek(eS,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});var eT=e.i(992984),eE=e.i(489118),eD=e.i(305565),eP=e.i(495094),eI=e.i(366998),eO=e.i(301426),eF=e.i(300244),eM=e.i(57216),eL=e.i(270627),eR=e.i(703315),eB=e.i(991461),ez=e.i(134959);function eV(e){return(eV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e_(){return(e_=Object.assign.bind()).apply(this,arguments)}function eH(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}function eU(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?eH(Object(a),!0).forEach(function(t){eX(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):eH(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function eK(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,eq(s.key),s)}}function e$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(e$=function(){return!!e})()}function eW(e){return(eW=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eY(e,t){return(eY=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function eX(e,t,a){return(t=eq(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function eq(e){var t=function(e,t){if("object"!=eV(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=eV(s))return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eV(t)?t:t+""}var eG=function(e){var t,s;function r(e){var t,a,s;if(!(this instanceof r))throw TypeError("Cannot call a class as a function");return a=r,s=[e],a=eW(a),eX(t=function(e,t){if(t&&("object"===eV(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");var a=e;if(void 0===a)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(this,e$()?Reflect.construct(a,s||[],eW(this).constructor):a.apply(this,s)),"pieRef",null),eX(t,"sectorRefs",[]),eX(t,"id",(0,eL.uniqueId)("recharts-pie-")),eX(t,"handleAnimationEnd",function(){var e=t.props.onAnimationEnd;t.setState({isAnimationFinished:!0}),(0,L.default)(e)&&e()}),eX(t,"handleAnimationStart",function(){var e=t.props.onAnimationStart;t.setState({isAnimationFinished:!1}),(0,L.default)(e)&&e()}),t.state={isAnimationFinished:!e.isAnimationActive,prevIsAnimationActive:e.isAnimationActive,prevAnimationId:e.animationId,sectorToFocus:0},t}if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");return r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&eY(r,e),t=[{key:"isActiveIndex",value:function(e){var t=this.props.activeIndex;return Array.isArray(t)?-1!==t.indexOf(e):e===t}},{key:"hasActiveIndex",value:function(){var e=this.props.activeIndex;return Array.isArray(e)?0!==e.length:e||0===e}},{key:"renderLabels",value:function(e){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var t=this.props,s=t.label,n=t.labelLine,l=t.dataKey,i=t.valueKey,o=(0,V.filterProps)(this.props,!1),c=(0,V.filterProps)(s,!1),d=(0,V.filterProps)(n,!1),u=s&&s.offsetRadius||20,m=e.map(function(e,t){var m=(e.startAngle+e.endAngle)/2,x=(0,J.polarToCartesian)(e.cx,e.cy,e.outerRadius+u,m),h=eU(eU(eU(eU({},o),e),{},{stroke:"none"},c),{},{index:t,textAnchor:r.getTextAnchor(x.x,e.cx)},x),p=eU(eU(eU(eU({},o),e),{},{fill:"none",stroke:e.fill},d),{},{index:t,points:[(0,J.polarToCartesian)(e.cx,e.cy,e.outerRadius,m),x]}),f=l;return(0,eP.default)(l)&&(0,eP.default)(i)?f="value":(0,eP.default)(l)&&(f=i),a.default.createElement(B.Layer,{key:"label-".concat(e.startAngle,"-").concat(e.endAngle,"-").concat(e.midAngle,"-").concat(t)},n&&r.renderLabelLineItem(n,p,"line"),r.renderLabelItem(s,h,(0,eR.getValueByDataKey)(e,f)))});return a.default.createElement(B.Layer,{className:"recharts-pie-labels"},m)}},{key:"renderSectorsStatically",value:function(e){var t=this,s=this.props,r=s.activeShape,n=s.blendStroke,l=s.inactiveShape;return e.map(function(s,i){if((null==s?void 0:s.startAngle)===0&&(null==s?void 0:s.endAngle)===0&&1!==e.length)return null;var o=t.isActiveIndex(i),c=l&&t.hasActiveIndex()?l:null,d=eU(eU({},s),{},{stroke:n?s.fill:s.stroke,tabIndex:-1});return a.default.createElement(B.Layer,e_({ref:function(e){e&&!t.sectorRefs.includes(e)&&t.sectorRefs.push(e)},tabIndex:-1,className:"recharts-pie-sector"},(0,Z.adaptEventsOfChild)(t.props,s,i),{key:"sector-".concat(null==s?void 0:s.startAngle,"-").concat(null==s?void 0:s.endAngle,"-").concat(s.midAngle,"-").concat(i)}),a.default.createElement(ez.Shape,e_({option:o?r:c,isActive:o,shapeType:"sector"},d)))})}},{key:"renderSectorsWithAnimation",value:function(){var e=this,t=this.props,s=t.sectors,r=t.isAnimationActive,n=t.animationBegin,l=t.animationDuration,i=t.animationEasing,o=t.animationId,c=this.state,d=c.prevSectors,u=c.prevIsAnimationActive;return a.default.createElement(eT.default,{begin:n,duration:l,isActive:r,easing:i,from:{t:0},to:{t:1},key:"pie-".concat(o,"-").concat(u),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(t){var r=t.t,n=[],l=(s&&s[0]).startAngle;return s.forEach(function(e,t){var a=d&&d[t],s=t>0?(0,eE.default)(e,"paddingAngle",0):0;if(a){var i=(0,eL.interpolateNumber)(a.endAngle-a.startAngle,e.endAngle-e.startAngle),o=eU(eU({},e),{},{startAngle:l+s,endAngle:l+i(r)+s});n.push(o),l=o.endAngle}else{var c=e.endAngle,u=e.startAngle,m=(0,eL.interpolateNumber)(0,c-u)(r),x=eU(eU({},e),{},{startAngle:l+s,endAngle:l+m+s});n.push(x),l=x.endAngle}}),a.default.createElement(B.Layer,null,e.renderSectorsStatically(n))})}},{key:"attachKeyboardHandlers",value:function(e){var t=this;e.onkeydown=function(e){if(!e.altKey)switch(e.key){case"ArrowLeft":var a=++t.state.sectorToFocus%t.sectorRefs.length;t.sectorRefs[a].focus(),t.setState({sectorToFocus:a});break;case"ArrowRight":var s=--t.state.sectorToFocus<0?t.sectorRefs.length-1:t.state.sectorToFocus%t.sectorRefs.length;t.sectorRefs[s].focus(),t.setState({sectorToFocus:s});break;case"Escape":t.sectorRefs[t.state.sectorToFocus].blur(),t.setState({sectorToFocus:0})}}}},{key:"renderSectors",value:function(){var e=this.props,t=e.sectors,a=e.isAnimationActive,s=this.state.prevSectors;return a&&t&&t.length&&(!s||!(0,eD.default)(s,t))?this.renderSectorsWithAnimation():this.renderSectorsStatically(t)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var e=this,t=this.props,s=t.hide,r=t.sectors,n=t.className,l=t.label,i=t.cx,o=t.cy,c=t.innerRadius,d=t.outerRadius,u=t.isAnimationActive,m=this.state.isAnimationFinished;if(s||!r||!r.length||!(0,eL.isNumber)(i)||!(0,eL.isNumber)(o)||!(0,eL.isNumber)(c)||!(0,eL.isNumber)(d))return null;var x=(0,R.default)("recharts-pie",n);return a.default.createElement(B.Layer,{tabIndex:this.props.rootTabIndex,className:x,ref:function(t){e.pieRef=t}},this.renderSectors(),l&&this.renderLabels(r),ex.Label.renderCallByParent(this.props,null,!1),(!u||m)&&eO.LabelList.renderCallByParent(this.props,r,!1))}}],s=[{key:"getDerivedStateFromProps",value:function(e,t){return t.prevIsAnimationActive!==e.isAnimationActive?{prevIsAnimationActive:e.isAnimationActive,prevAnimationId:e.animationId,curSectors:e.sectors,prevSectors:[],isAnimationFinished:!0}:e.isAnimationActive&&e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curSectors:e.sectors,prevSectors:t.curSectors,isAnimationFinished:!0}:e.sectors!==t.curSectors?{curSectors:e.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(e,t){return e>t?"start":e<t?"end":"middle"}},{key:"renderLabelLineItem",value:function(e,t,s){if(a.default.isValidElement(e))return a.default.cloneElement(e,t);if((0,L.default)(e))return e(t);var r=(0,R.default)("recharts-pie-label-line","boolean"!=typeof e?e.className:"");return a.default.createElement(eI.Curve,e_({},t,{key:s,type:"linear",className:r}))}},{key:"renderLabelItem",value:function(e,t,s){if(a.default.isValidElement(e))return a.default.cloneElement(e,t);var r=s;if((0,L.default)(e)&&(r=e(t),a.default.isValidElement(r)))return r;var n=(0,R.default)("recharts-pie-label-text","boolean"==typeof e||(0,L.default)(e)?"":e.className);return a.default.createElement(G.Text,e_({},t,{alignmentBaseline:"middle",className:n}),r)}}],t&&eK(r.prototype,t),s&&eK(r,s),Object.defineProperty(r,"prototype",{writable:!1}),r}(a.PureComponent);eX(eG,"displayName","Pie"),eX(eG,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!eM.Global.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0}),eX(eG,"parseDeltaAngle",function(e,t){return(0,eL.mathSign)(t-e)*Math.min(Math.abs(t-e),360)}),eX(eG,"getRealPieData",function(e){var t=e.data,a=e.children,s=(0,V.filterProps)(e,!1),r=(0,V.findAllByType)(a,eF.Cell);return t&&t.length?t.map(function(e,t){return eU(eU(eU({payload:e},s),e),r&&r[t]&&r[t].props)}):r&&r.length?r.map(function(e){return eU(eU({},s),e.props)}):[]}),eX(eG,"parseCoordinateOfPie",function(e,t){var a=t.top,s=t.left,r=t.width,n=t.height,l=(0,J.getMaxRadius)(r,n);return{cx:s+(0,eL.getPercentValue)(e.cx,r,r/2),cy:a+(0,eL.getPercentValue)(e.cy,n,n/2),innerRadius:(0,eL.getPercentValue)(e.innerRadius,l,0),outerRadius:(0,eL.getPercentValue)(e.outerRadius,l,.8*l),maxRadius:e.maxRadius||Math.sqrt(r*r+n*n)/2}}),eX(eG,"getComposedData",function(e){var t,a,s=e.item,r=e.offset,n=void 0!==s.type.defaultProps?eU(eU({},s.type.defaultProps),s.props):s.props,l=eG.getRealPieData(n);if(!l||!l.length)return null;var i=n.cornerRadius,o=n.startAngle,c=n.endAngle,d=n.paddingAngle,u=n.dataKey,m=n.nameKey,x=n.valueKey,h=n.tooltipType,p=Math.abs(n.minAngle),f=eG.parseCoordinateOfPie(n,r),g=eG.parseDeltaAngle(o,c),y=Math.abs(g),j=u;(0,eP.default)(u)&&(0,eP.default)(x)?((0,eB.warn)(!1,'Use "dataKey" to specify the value of pie,\n      the props "valueKey" will be deprecated in 1.1.0'),j="value"):(0,eP.default)(u)&&((0,eB.warn)(!1,'Use "dataKey" to specify the value of pie,\n      the props "valueKey" will be deprecated in 1.1.0'),j=x);var v=l.filter(function(e){return 0!==(0,eR.getValueByDataKey)(e,j,0)}).length,b=y-v*p-(y>=360?v:v-1)*d,N=l.reduce(function(e,t){var a=(0,eR.getValueByDataKey)(t,j,0);return e+((0,eL.isNumber)(a)?a:0)},0);return N>0&&(t=l.map(function(e,t){var s,r=(0,eR.getValueByDataKey)(e,j,0),n=(0,eR.getValueByDataKey)(e,m,t),l=((0,eL.isNumber)(r)?r:0)/N,c=(s=t?a.endAngle+(0,eL.mathSign)(g)*d*(0!==r):o)+(0,eL.mathSign)(g)*((0!==r?p:0)+l*b),u=(s+c)/2,x=(f.innerRadius+f.outerRadius)/2,y=[{name:n,value:r,payload:e,dataKey:j,type:h}],v=(0,J.polarToCartesian)(f.cx,f.cy,x,u);return a=eU(eU(eU({percent:l,cornerRadius:i,name:n,tooltipPayload:y,midAngle:u,middleRadius:x,tooltipPosition:v},e),f),{},{value:(0,eR.getValueByDataKey)(e,j),startAngle:s,endAngle:c,payload:e,paddingAngle:(0,eL.mathSign)(g)*d})})),eU(eU({},f),{},{sectors:t,data:l})});var eZ=(0,M.generateCategoricalChart)({chartName:"PieChart",GraphicalChild:eG,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:ed},{axisType:"radiusAxis",AxisComp:eS}],formatAxisMap:J.formatAxisMap,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),eJ=e.i(723451),eQ=e.i(694713);let e0=["#9b87f5","#7E69AB","#6E59A5","#D6BCFA","#E5DEFF","#0EA5E9","#F97316","#D946EF","#F2FCE2","#FEF7CD","#FEC6A1","#FFDEE2","#FDE1D3","#D3E4FD","#F1F0FB"],e1=({expenses:e,formatCurrency:s})=>{let{canViewTotalExpenses:r}=(0,P.useFinancialVisibility)(),[n,l]=(0,a.useState)("category"),i=(0,a.useMemo)(()=>{let t=e.reduce((e,t)=>e+t.amount,0);if("category"===n){let a=new Map;return e.forEach(e=>{let t=(e.category||"Uncategorized").toLowerCase().trim(),s=a.get(t);s?(s.total+=e.amount,s.count+=1):a.set(t,{total:e.amount,count:1})}),Array.from(a.entries()).map(([e,{total:a,count:s}])=>({name:e.charAt(0).toUpperCase()+e.slice(1),value:a,percentage:a/t*100,count:s})).sort((e,t)=>t.value-e.value)}{let a=new Map;return e.forEach(e=>{let t=(e.personInCharge||"Unassigned").toLowerCase().trim(),s=a.get(t);s?(s.total+=e.amount,s.count+=1):a.set(t,{total:e.amount,count:1})}),Array.from(a.entries()).map(([e,{total:a,count:s}])=>({name:e.charAt(0).toUpperCase()+e.slice(1),value:a,percentage:a/t*100,count:s})).sort((e,t)=>t.value-e.value)}},[e,n]);return(0,t.jsxs)(D.Card,{className:"mt-6",children:[(0,t.jsx)(D.CardHeader,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsx)(D.CardTitle,{className:"text-lg sm:text-xl",children:"Expense Distribution"}),(0,t.jsx)(F.Tabs,{value:n,onValueChange:e=>l(e),className:"w-full sm:w-auto",children:(0,t.jsxs)(F.TabsList,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(F.TabsTrigger,{value:"category",children:"By Category"}),(0,t.jsx)(F.TabsTrigger,{value:"person",children:"By Person"})]})})]})}),(0,t.jsx)(D.CardContent,{className:"pt-2",children:i.length>0?(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row space-y-6 lg:space-y-0 lg:space-x-4",children:[(0,t.jsxs)("div",{className:"w-full lg:w-1/2 flex flex-col items-center",children:[(0,t.jsx)("div",{className:"h-[220px] sm:h-[260px] w-full max-w-[280px] mx-auto",children:(0,t.jsx)(eJ.ResponsiveContainer,{width:"100%",height:"100%",children:(0,t.jsxs)(eZ,{margin:{top:5,right:5,bottom:5,left:5},children:[(0,t.jsx)(eG,{data:i,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,innerRadius:36,paddingAngle:1.5,dataKey:"value",stroke:"#ffffff",strokeWidth:1.5,children:i.map((e,a)=>(0,t.jsx)(eF.Cell,{fill:e0[a%e0.length],className:"hover:opacity-80 transition-opacity"},`cell-${a}`))}),(0,t.jsx)(eQ.Tooltip,{content:(0,t.jsx)(({active:e,payload:a})=>{if(e&&a&&a.length){let e=a[0].payload;return(0,t.jsxs)("div",{className:"bg-card p-3 shadow rounded border border-border text-sm",children:[(0,t.jsx)("p",{className:"font-medium text-foreground",children:e.name}),(0,t.jsx)("p",{className:"text-primary",children:r?s(e.value):"•••"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:[e.percentage.toFixed(1),"% of total"]}),(0,t.jsxs)("p",{className:"text-xs",children:[e.count," expense",1!==e.count?"s":""]})]})}return null},{})})]})})}),(0,t.jsx)("div",{className:"mt-2 text-xs text-center text-muted-foreground",children:(0,t.jsx)("p",{children:"Tap segments for details"})})]}),(0,t.jsx)("div",{className:"w-full lg:w-1/2",children:(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("h3",{className:"text-sm font-medium mb-1.5 px-1",children:["category"===n?"Categories":"People"," Breakdown"]}),(0,t.jsx)("div",{className:"space-y-0 max-h-[220px] sm:max-h-[260px] overflow-y-auto pr-1 rounded-md",children:i.map((e,a)=>(0,t.jsxs)("div",{className:"flex justify-between items-center border-b border-border/40 py-2 px-1 hover:bg-muted/50 rounded-sm transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-1.5",children:[(0,t.jsx)("div",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{backgroundColor:e0[a%e0.length]}}),(0,t.jsx)("span",{className:"truncate max-w-[120px] sm:max-w-[160px] text-xs sm:text-sm",children:e.name})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"font-medium text-xs sm:text-sm",children:r?s(e.value):"•••"}),(0,t.jsxs)("div",{className:"text-[10px] sm:text-xs text-muted-foreground",children:[e.percentage.toFixed(1),"%"]})]})]},a))})]})})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-[160px] sm:h-[200px] text-center text-muted-foreground",children:[(0,t.jsx)("p",{className:"text-sm",children:"No expense data available."}),(0,t.jsx)("p",{className:"text-xs mt-2",children:"Try a different date range or add some expenses."})]})})]})};var e2=e.i(450095),e5=e.i(708997),e4=e.i(533538),e3=e.i(518466),e6=e.i(726302),e8=e.i(57098),e9=e.i(868462),e7=e.i(502685);let te=({expense:e,open:s,onOpenChange:r,formatCurrency:n,accounts:l})=>{let i=(0,T.useIsMobile)(),[o,c]=(0,a.useState)(!1);if(!e)return null;let d=(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Date"}),(0,t.jsx)("p",{className:"text-sm",children:e.date.toLocaleDateString()})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Amount"}),(0,t.jsx)("p",{className:"text-lg font-semibold text-red-600",children:n(e.amount)})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Description"}),(0,t.jsx)("p",{className:"text-sm",children:e.description})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Category"}),e.category?(0,t.jsx)(A.Badge,{variant:"secondary",children:e.category}):(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Not specified"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Payment Method"}),(0,t.jsx)("p",{className:"text-sm",children:e.paymentMethod||"Not specified"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Person in Charge"}),(0,t.jsx)("p",{className:"text-sm",children:e.personInCharge||"Not specified"})]}),e.cashAccountId&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Cash Account"}),(0,t.jsx)(A.Badge,{variant:"outline",children:(e=>{if(!e)return null;let t=l.find(t=>t.id===e);return t?.name||"Unknown Account"})(e.cashAccountId)})]}),e.receiptImage&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Receipt"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:e.receiptImage,alt:"Receipt",className:"max-w-full h-32 object-contain border rounded cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>c(!0)}),(0,t.jsx)(x.Button,{variant:"secondary",size:"sm",className:"absolute top-2 right-2 opacity-80 hover:opacity-100",onClick:()=>c(!0),children:(0,t.jsx)(e2.Eye,{className:"h-4 w-4"})})]})]})]});return i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e8.Drawer,{open:s,onOpenChange:r,children:(0,t.jsx)(e8.DrawerContent,{className:"max-h-[85vh]",children:(0,t.jsxs)("div",{className:"relative px-4 py-6 pb-8",children:[(0,t.jsxs)(e8.DrawerClose,{className:"absolute right-4 top-4 rounded-sm opacity-70 hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring",children:[(0,t.jsx)(e9.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,t.jsx)(e8.DrawerHeader,{className:"px-0 pb-4",children:(0,t.jsx)(e8.DrawerTitle,{className:"text-lg",children:"Expense Details"})}),(0,t.jsx)(k.ScrollArea,{className:"h-[calc(85vh-120px)] pr-4",children:d})]})})}),e.receiptImage&&(0,t.jsx)(e7.default,{isOpen:o,onOpenChange:c,imageUrl:e.receiptImage,imageAlt:"Receipt image"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.Dialog,{open:s,onOpenChange:r,children:(0,t.jsxs)(C.DialogContent,{className:"sm:max-w-[600px] max-h-[90vh]",children:[(0,t.jsx)(C.DialogHeader,{children:(0,t.jsx)(C.DialogTitle,{children:"Expense Details"})}),(0,t.jsx)(k.ScrollArea,{className:"max-h-[70vh] pr-4",children:d})]})}),e.receiptImage&&(0,t.jsx)(e7.default,{isOpen:o,onOpenChange:c,imageUrl:e.receiptImage,imageAlt:"Receipt image"})]})};var tt=e.i(443915),ta=e.i(130027),ts=e.i(897837),tr=e.i(348370),tn=e.i(690176),tl=e.i(229767),ti=e.i(792042);let to=({open:e,onOpenChange:r,onSubmit:n,initialData:i,title:c="Add New Expense"})=>{let[d,m]=(0,a.useState)(""),[p,f]=(0,a.useState)(""),[g,b]=(0,a.useState)(""),[w,A]=(0,a.useState)(""),[T,E]=(0,a.useState)(new Date),[D,P]=(0,a.useState)(""),[I,O]=(0,a.useState)(""),[F,M]=(0,a.useState)(""),[L,R]=(0,a.useState)(!1),[B,z]=(0,a.useState)(""),[V,_]=(0,a.useState)(!1),[H,U]=(0,a.useState)(!1),[K,$]=(0,a.useState)(!1),[W,Y]=(0,a.useState)(null),{accounts:X}=(0,e6.useCashAccounts)(),{categories:q,createCategory:G}=y(),{toast:Z}=(0,h.useToast)(),{user:J}=(0,s.useAuth)();J?.id,(0,a.useEffect)(()=>{e&&i?(m(i.amount?.toString()||""),f(i.description||""),b(i.category||""),E(i.date||new Date),P(i.paymentMethod||""),O(i.personInCharge||""),M(i.receiptImage||""),R(i.linkToCash||!1),z(i.cashAccountId||""),Y(null)):e&&!i&&(m(""),f(""),b(""),E(new Date),P(""),O(""),M(""),R(!1),z(""),Y(null))},[e,i]);let Q=async e=>{if(e.preventDefault(),!d||!p)return void Z({title:"Error",description:"Amount and description are required",variant:"destructive"});if(L&&!B)return void Z({title:"Error",description:"Please select a cash account when linking to cash",variant:"destructive"});_(!0);try{console.log("ExpenseForm: Submitting expense with linkToCash:",L,"cashAccountId:",B),W&&console.warn("Receipt file upload skipped – no storage backend configured.");let e={amount:parseFloat(d),description:p,category:g||void 0,date:T,paymentMethod:D||void 0,personInCharge:I||void 0,receiptImage:F||void 0,linkToCash:L,cashAccountId:L?B:void 0};console.log("ExpenseForm: Final expense data:",e),await n(e),r(!1)}catch(e){console.error("Error submitting expense:",e)}finally{_(!1)}},ee=()=>{M("")},et=async()=>{if(!w.trim())return void Z({title:"Error",description:"Please enter a category name",variant:"destructive"});$(!0);try{let e=await G(w.trim());e&&(b(e.name),A(""),Z({title:"Success",description:"Category created successfully"}))}catch(e){console.error("Error creating category:",e)}finally{$(!1)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.Dialog,{open:e,onOpenChange:r,children:(0,t.jsxs)(C.DialogContent,{className:"sm:max-w-md max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)(C.DialogHeader,{children:(0,t.jsx)(C.DialogTitle,{children:c})}),(0,t.jsxs)("form",{onSubmit:Q,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(v.Label,{htmlFor:"amount",children:"Amount *"}),(0,t.jsx)(j.Input,{id:"amount",type:"number",step:"0.01",value:d,onChange:e=>m(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),document.getElementById("description")?.focus())},placeholder:"0.00",disabled:V})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v.Label,{htmlFor:"description",children:"Description *"}),(0,t.jsx)(tt.Textarea,{id:"description",value:p,onChange:e=>f(e.target.value),onKeyDown:e=>{if("Enter"===e.key&&!e.shiftKey){e.preventDefault();let t=document.querySelector('button[data-category-select="true"]');t?t.focus():document.getElementById("newCategory")?.focus()}},placeholder:"Enter expense description",disabled:V})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(v.Label,{children:"Category"}),(0,t.jsxs)(x.Button,{type:"button",variant:"outline",className:"w-full justify-start text-left font-normal",onClick:()=>U(!0),"data-category-select":"true",onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),document.getElementById("newCategory")?.focus())},disabled:V,children:[(0,t.jsx)(N.Tag,{className:"mr-2 h-4 w-4"}),g||"Select Category"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v.Label,{htmlFor:"newCategory",children:"Create New Category"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(j.Input,{id:"newCategory",value:w,onChange:e=>A(e.target.value),onKeyDown:e=>{if("Enter"===e.key){e.preventDefault();let t=document.querySelector('button[data-date-picker="true"]');t?.focus()}},placeholder:"Enter new category name",disabled:V||K}),(0,t.jsx)(x.Button,{type:"button",onClick:et,disabled:!w.trim()||V||K,size:"sm",children:(0,t.jsx)(o.Plus,{className:"h-4 w-4"})})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v.Label,{children:"Date"}),(0,t.jsxs)(tr.Popover,{children:[(0,t.jsx)(tr.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(x.Button,{variant:"outline",className:(0,l.cn)("w-full justify-start text-left font-normal",!T&&"text-muted-foreground"),"data-date-picker":"true",onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),document.getElementById("paymentMethod")?.focus())},disabled:V,children:[(0,t.jsx)(tl.CalendarIcon,{className:"mr-2 h-4 w-4"}),T?(0,ti.format)(T,"PPP"):(0,t.jsx)("span",{children:"Pick a date"})]})}),(0,t.jsx)(tr.PopoverContent,{className:"w-auto p-0",children:(0,t.jsx)(ts.Calendar,{mode:"single",selected:T,onSelect:e=>e&&E(e),initialFocus:!0})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v.Label,{htmlFor:"paymentMethod",children:"Payment Method"}),(0,t.jsx)(j.Input,{id:"paymentMethod",value:D,onChange:e=>P(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),document.getElementById("personInCharge")?.focus())},placeholder:"Enter payment method (e.g., Cash, Credit Card, etc.)",disabled:V})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v.Label,{htmlFor:"personInCharge",children:"Person in Charge"}),(0,t.jsx)(j.Input,{id:"personInCharge",value:I,onChange:e=>O(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),document.getElementById("receipt")?.focus())},placeholder:"Enter person responsible",disabled:V})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v.Label,{htmlFor:"receipt",children:"Receipt (Image or PDF)"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(j.Input,{id:"receipt",type:"file",accept:"image/*,.pdf",onChange:e=>{let t=e.target.files?.[0];if(t){let e=t.type.startsWith("image/"),a="application/pdf"===t.type;if(!e&&!a)return void Z({title:"Error",description:"Please select an image or PDF file",variant:"destructive"});Y(t),M(URL.createObjectURL(t))}},disabled:V}),F&&(0,t.jsx)("div",{className:"relative inline-block",children:F&&F.includes("pdf")?(0,t.jsxs)("div",{className:"flex items-center gap-2 p-2 border rounded",children:[(0,t.jsx)(u.FileText,{className:"h-8 w-8 text-red-600"}),(0,t.jsx)("span",{className:"text-sm",children:"PDF Receipt"}),(0,t.jsx)(x.Button,{type:"button",variant:"destructive",size:"sm",className:"ml-auto h-6 w-6 rounded-full p-0",onClick:ee,disabled:V,children:(0,t.jsx)(e9.X,{className:"h-3 w-3"})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{src:F,alt:"Receipt",className:"w-20 h-20 object-cover rounded border"}),(0,t.jsx)(x.Button,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0",onClick:ee,disabled:V,children:(0,t.jsx)(e9.X,{className:"h-3 w-3"})})]})})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(ta.Switch,{id:"linkToCash",checked:L,onCheckedChange:R,disabled:V}),(0,t.jsx)(v.Label,{htmlFor:"linkToCash",children:"Link to Cash Account"})]}),L&&(0,t.jsxs)("div",{children:[(0,t.jsx)(v.Label,{htmlFor:"cashAccount",children:"Cash Account"}),(0,t.jsxs)(tn.Select,{value:B,onValueChange:e=>{z(e),setTimeout(()=>{let e=document.querySelector('button[type="submit"]');e?.focus()},100)},disabled:V,children:[(0,t.jsx)(tn.SelectTrigger,{onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),setTimeout(()=>{let e=document.querySelector('button[type="submit"]');e?.focus()},100))},children:(0,t.jsx)(tn.SelectValue,{placeholder:"Select cash account"})}),(0,t.jsx)(tn.SelectContent,{children:X.map(e=>(0,t.jsx)(tn.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(x.Button,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:V,children:"Cancel"}),(0,t.jsx)(x.Button,{type:"submit",disabled:V,children:V?"Saving...":"Save Expense"})]})]})]})}),(0,t.jsx)(C.Dialog,{open:H,onOpenChange:U,children:(0,t.jsxs)(C.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsx)(C.DialogHeader,{children:(0,t.jsx)(C.DialogTitle,{children:"Select Category"})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(k.ScrollArea,{className:"h-64 rounded-md border p-4",children:(0,t.jsx)("div",{className:"space-y-2",children:q.map(e=>(0,t.jsxs)(x.Button,{variant:"ghost",className:"w-full justify-start",onClick:()=>{b(e.name),U(!1)},children:[(0,t.jsx)(N.Tag,{className:"mr-2 h-4 w-4"}),e.name]},e.id))})}),(0,t.jsx)(S,{}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(x.Button,{variant:"outline",onClick:()=>U(!1),children:"Cancel"})})]})]})})]})},tc=({expense:e,open:a,onOpenChange:s,onSubmit:r})=>{if(!e)return null;let n={amount:e.amount,description:e.description,category:e.category||"",date:e.date,paymentMethod:e.paymentMethod||"",personInCharge:e.personInCharge||"",receiptImage:e.receiptImage||"",linkToCash:!!e.cashAccountId,cashAccountId:e.cashAccountId||""},l=async e=>{console.log("EditExpenseDialog handleSubmit data:",e),await r(e)};return(0,t.jsx)(to,{open:a,onOpenChange:s,onSubmit:l,initialData:n,title:"Edit Expense"})},td=({expense:e,open:a,onOpenChange:s,onConfirm:r,formatCurrency:n})=>e?(0,t.jsx)(w.AlertDialog,{open:a,onOpenChange:s,children:(0,t.jsxs)(w.AlertDialogContent,{children:[(0,t.jsxs)(w.AlertDialogHeader,{children:[(0,t.jsx)(w.AlertDialogTitle,{children:"Delete Expense"}),(0,t.jsxs)(w.AlertDialogDescription,{className:"space-y-2",children:[(0,t.jsx)("div",{children:"Are you sure you want to delete this expense?"}),(0,t.jsxs)("div",{className:"p-3 bg-muted rounded-md",children:[(0,t.jsx)("div",{className:"font-medium",children:e.description}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[n(e.amount)," • ",e.date.toLocaleDateString()]})]}),(0,t.jsx)("div",{className:"text-sm text-destructive",children:"This action cannot be undone."})]})]}),(0,t.jsxs)(w.AlertDialogFooter,{children:[(0,t.jsx)(w.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(w.AlertDialogAction,{onClick:r,className:"bg-destructive hover:bg-destructive/90",children:"Delete Expense"})]})]})}):null;var tu=e.i(638822);let tm=({expenses:e,onUpdateExpense:s,onDeleteExpense:r,formatCurrency:i})=>{let o=(0,T.useIsMobile)(),{accounts:c}=(0,e6.useCashAccounts)(),{settings:d}=(0,n.useBusinessSettings)(),{canViewTotalExpenses:u}=(0,P.useFinancialVisibility)(),{hasPermission:m}=(0,tu.useProfiles)(),h=d.currency||"USD",[p,f]=(0,a.useState)(""),[g,y]=(0,a.useState)(null),[v,N]=(0,a.useState)(!1),[C,w]=(0,a.useState)(!1),[k,S]=(0,a.useState)(!1),E=e.filter(e=>e.description.toLowerCase().includes(p.toLowerCase())||e.category&&e.category.toLowerCase().includes(p.toLowerCase())||e.paymentMethod&&e.paymentMethod.toLowerCase().includes(p.toLowerCase())||e.personInCharge&&e.personInCharge.toLowerCase().includes(p.toLowerCase())),I=e=>{if(!e)return null;let t=c.find(t=>t.id===e);return t?.name||"Unknown Account"},O=e=>{y(e),N(!0)},F=e=>{y(e),w(!0)},M=e=>{y(e),S(!0)},L=async e=>{g&&(await s(g.id,e),w(!1),y(null))},R=async()=>{g&&await r(g.id)&&(S(!1),y(null))};return o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(D.Card,{children:[(0,t.jsx)(D.CardHeader,{className:"pb-4",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)(D.CardTitle,{className:"text-lg",children:"Expenses List"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(e4.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,t.jsx)(j.Input,{placeholder:"Search expenses...",value:p,onChange:e=>f(e.target.value),className:"pl-10"})]})]})}),(0,t.jsx)(D.CardContent,{className:"px-3",children:0===E.length?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:p?"No expenses found matching your search.":"No expenses found."})}):(0,t.jsx)("div",{className:"space-y-3",children:E.map(e=>(0,t.jsxs)(D.Card,{className:"p-4 space-y-3 cursor-pointer hover:shadow-md transition-shadow border-l-4 border-l-red-500",onClick:()=>O(e),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"space-y-1 flex-1",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:e.date.toLocaleDateString()}),(0,t.jsx)("div",{className:"text-base font-semibold line-clamp-2",children:e.description})]}),(0,t.jsxs)("div",{className:"text-right space-y-1",children:[(0,t.jsx)("div",{className:"text-lg font-bold text-red-600",children:u?(0,l.formatCashCurrency)(e.amount,h):"•••"}),(0,t.jsxs)("div",{className:"flex gap-1",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)(x.Button,{variant:"ghost",size:"sm",onClick:()=>O(e),className:"h-6 w-6 p-0 text-gray-600 hover:text-gray-700",children:(0,t.jsx)(e2.Eye,{className:"h-3 w-3"})}),m("expenses","edit")&&(0,t.jsx)(x.Button,{variant:"ghost",size:"sm",onClick:()=>F(e),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700",children:(0,t.jsx)(e5.Edit,{className:"h-3 w-3"})}),m("expenses","delete")&&(0,t.jsx)(x.Button,{variant:"ghost",size:"sm",onClick:()=>M(e),className:"h-6 w-6 p-0 text-red-600 hover:text-red-700",children:(0,t.jsx)(b.Trash2,{className:"h-3 w-3"})})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-medium text-muted-foreground",children:"Category:"}),e.category?(0,t.jsx)(A.Badge,{variant:"secondary",className:"text-xs",children:e.category}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})]}),e.paymentMethod&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-medium text-muted-foreground",children:"Payment:"}),(0,t.jsx)("span",{className:"text-xs",children:e.paymentMethod})]}),e.personInCharge&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-medium text-muted-foreground",children:"Person in Charge:"}),(0,t.jsx)("span",{className:"text-xs",children:e.personInCharge})]}),e.receiptImage&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-medium text-muted-foreground",children:"Receipt:"}),(0,t.jsx)(A.Badge,{variant:"outline",className:"text-xs",children:"Available"})]}),e.cashAccountId&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-medium text-muted-foreground",children:"Cash Account:"}),(0,t.jsx)(A.Badge,{variant:"outline",className:"text-xs",children:I(e.cashAccountId)})]})]})]},e.id))})})]}),(0,t.jsx)(te,{expense:g,open:v,onOpenChange:N,formatCurrency:i,accounts:c}),(0,t.jsx)(tc,{expense:g,open:C,onOpenChange:w,onSubmit:L}),(0,t.jsx)(td,{expense:g,open:k,onOpenChange:S,onConfirm:R,formatCurrency:i})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(D.Card,{children:[(0,t.jsx)(D.CardHeader,{className:"pb-4",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsx)(D.CardTitle,{className:"text-lg md:text-xl",children:"Expenses List"}),(0,t.jsxs)("div",{className:"relative w-full sm:w-80",children:[(0,t.jsx)(e4.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,t.jsx)(j.Input,{placeholder:"Search expenses by description, category, payment method...",value:p,onChange:e=>f(e.target.value),className:"pl-10"})]})]})}),(0,t.jsx)(D.CardContent,{children:0===E.length?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:p?"No expenses found matching your search.":"No expenses found."})}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(e3.Table,{children:[(0,t.jsx)(e3.TableHeader,{children:(0,t.jsxs)(e3.TableRow,{children:[(0,t.jsx)(e3.TableHead,{children:"Date"}),(0,t.jsx)(e3.TableHead,{children:"Description"}),(0,t.jsx)(e3.TableHead,{children:"Category"}),(0,t.jsx)(e3.TableHead,{children:"Amount"}),(0,t.jsx)(e3.TableHead,{children:"Payment Method"}),(0,t.jsx)(e3.TableHead,{children:"Person In Charge"}),(0,t.jsx)(e3.TableHead,{children:"Cash Account"}),(0,t.jsx)(e3.TableHead,{children:"Receipt"}),(0,t.jsx)(e3.TableHead,{className:"text-right",children:"Actions"})]})}),(0,t.jsx)(e3.TableBody,{children:E.map(e=>(0,t.jsxs)(e3.TableRow,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>O(e),children:[(0,t.jsx)(e3.TableCell,{className:"whitespace-nowrap",children:e.date.toLocaleDateString()}),(0,t.jsx)(e3.TableCell,{className:"font-medium",children:e.description}),(0,t.jsx)(e3.TableCell,{children:e.category?(0,t.jsx)(A.Badge,{variant:"secondary",children:e.category}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,t.jsx)(e3.TableCell,{className:"font-semibold text-red-600",children:u?(0,l.formatCashCurrency)(e.amount,h):"•••"}),(0,t.jsx)(e3.TableCell,{children:e.paymentMethod||(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,t.jsx)(e3.TableCell,{children:e.personInCharge||(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,t.jsx)(e3.TableCell,{children:e.cashAccountId?(0,t.jsx)(A.Badge,{variant:"outline",children:I(e.cashAccountId)}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,t.jsx)(e3.TableCell,{children:e.receiptImage?(0,t.jsx)(A.Badge,{variant:"outline",children:"Receipt"}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,t.jsx)(e3.TableCell,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex justify-end gap-1",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)(x.Button,{variant:"ghost",size:"sm",onClick:()=>O(e),className:"h-8 w-8 p-0",children:(0,t.jsx)(e2.Eye,{className:"h-4 w-4"})}),m("expenses","edit")&&(0,t.jsx)(x.Button,{variant:"ghost",size:"sm",onClick:()=>F(e),className:"h-8 w-8 p-0",children:(0,t.jsx)(e5.Edit,{className:"h-4 w-4"})}),m("expenses","delete")&&(0,t.jsx)(x.Button,{variant:"ghost",size:"sm",onClick:()=>M(e),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:(0,t.jsx)(b.Trash2,{className:"h-4 w-4"})})]})})]},e.id))})]})})})]}),(0,t.jsx)(te,{expense:g,open:v,onOpenChange:N,formatCurrency:i,accounts:c}),(0,t.jsx)(tc,{expense:g,open:C,onOpenChange:w,onSubmit:L}),(0,t.jsx)(td,{expense:g,open:k,onOpenChange:S,onConfirm:R,formatCurrency:i})]})},tx=({filteredExpenses:e,expenseStats:a,formatCurrency:s,dateFilter:r,onUpdateExpense:n,onDeleteExpense:l,showOnlyOverview:i=!1,showOnlyList:o=!1})=>i?(0,t.jsxs)("div",{className:"space-y-4 md:space-y-6",children:[(0,t.jsx)(I,{totalExpenses:a.totalExpenses,thisMonthExpenses:a.thisMonthExpenses,transactionCount:a.transactionCount,formatCurrency:s,dateFilter:r}),(0,t.jsx)(e1,{expenses:e,formatCurrency:s}),(0,t.jsx)(O,{filteredExpenses:e,formatCurrency:s})]}):o?(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsx)(tm,{expenses:e,onUpdateExpense:n,onDeleteExpense:l,formatCurrency:s})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(I,{totalExpenses:a.totalExpenses,thisMonthExpenses:a.thisMonthExpenses,transactionCount:a.transactionCount,formatCurrency:s,dateFilter:r}),(0,t.jsx)(tm,{expenses:e,onUpdateExpense:n,onDeleteExpense:l,formatCurrency:s})]});var th=e.i(151670);let tp=({dateFilter:e,dateRange:a,onDateFilterChange:s,onDateRangeChange:r})=>(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center mb-4",onClick:e=>{e.stopPropagation()},children:[(0,t.jsx)("div",{className:"w-full sm:w-[200px]",children:(0,t.jsxs)(tn.Select,{value:e,onValueChange:s,children:[(0,t.jsx)(tn.SelectTrigger,{className:"bg-white shadow-sm",children:(0,t.jsx)(tn.SelectValue,{placeholder:"Select period"})}),(0,t.jsxs)(tn.SelectContent,{className:"z-50 bg-white shadow-lg",children:[(0,t.jsx)(tn.SelectItem,{value:"all",children:"All Time"}),(0,t.jsx)(tn.SelectItem,{value:"today",children:"Today"}),(0,t.jsx)(tn.SelectItem,{value:"yesterday",children:"Yesterday"}),(0,t.jsx)(tn.SelectItem,{value:"this-week",children:"This Week"}),(0,t.jsx)(tn.SelectItem,{value:"last-week",children:"Last Week"}),(0,t.jsx)(tn.SelectItem,{value:"this-month",children:"This Month"}),(0,t.jsx)(tn.SelectItem,{value:"last-month",children:"Last Month"}),(0,t.jsx)(tn.SelectItem,{value:"this-year",children:"This Year"}),(0,t.jsx)(tn.SelectItem,{value:"custom",children:"Custom Range"})]})]})}),"custom"===e&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)(tr.Popover,{children:[(0,t.jsx)(tr.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(x.Button,{variant:"outline",className:"bg-white flex items-center gap-2 h-10 pl-3 text-left font-normal",children:[(0,t.jsx)(th.Calendar,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:a.from?(0,ti.format)(a.from,"MMM d, yyyy"):"Start Date"})]})}),(0,t.jsx)(tr.PopoverContent,{className:"w-auto p-0 z-[100] bg-white shadow-lg",align:"start",children:(0,t.jsx)(ts.Calendar,{initialFocus:!0,mode:"single",defaultMonth:a?.from,selected:a?.from,onSelect:e=>r({...a,from:e}),className:"p-3 pointer-events-auto",showOutsideDays:!0})})]}),(0,t.jsx)("span",{className:"text-muted-foreground",children:"to"}),(0,t.jsxs)(tr.Popover,{children:[(0,t.jsx)(tr.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(x.Button,{variant:"outline",className:"bg-white flex items-center gap-2 h-10 pl-3 text-left font-normal",children:[(0,t.jsx)(th.Calendar,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:a.to?(0,ti.format)(a.to,"MMM d, yyyy"):"End Date"})]})}),(0,t.jsx)(tr.PopoverContent,{className:"w-auto p-0 z-[100] bg-white shadow-lg",align:"start",children:(0,t.jsx)(ts.Calendar,{initialFocus:!0,mode:"single",defaultMonth:a?.to,selected:a?.to,onSelect:e=>r({...a,to:e}),className:"p-3 pointer-events-auto",showOutsideDays:!0})})]})]})]});var tf=e.i(168994),tg=e.i(676379),ty=e.i(300550),tj=e.i(600300),tv=e.i(108996),tb=e.i(626427),tN=e.i(262945);let tC="bulk_expenses_draft",tw=({open:e,onOpenChange:n,onSuccess:i})=>{let c=(0,T.useIsMobile)(),{user:d}=(0,s.useAuth)(),{accounts:u}=(0,e6.useCashAccounts)(),{createBulkExpenses:m}=(0,r.useExpenses)(),[h,p]=(0,a.useState)([]),[f,g]=(0,a.useState)(new Date),[y,N]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!e)return;let t=localStorage.getItem(tC);if(t)try{let e=JSON.parse(t);p(e.map(e=>({...e,date:new Date(e.date)})))}catch(e){console.error("Failed to parse draft",e),w()}else p([]),w()},[e]),(0,a.useEffect)(()=>{h.length>0?localStorage.setItem(tC,JSON.stringify(h)):localStorage.removeItem(tC)},[h]);let w=()=>{let e={id:Math.random().toString(36).substr(2,9),amount:0,description:"",category:"Other",date:f,paymentMethod:"Cash",personInCharge:"",linkToCash:!1,cashAccountId:u.length>0?u[0].id:void 0};p(t=>[...t,e])},k=e=>{p(t=>t.filter(t=>t.id!==e)),1===h.length&&w()},A=(e,t)=>{p(a=>a.map(a=>a.id===e?{...a,...t}:a))},S=(e,t)=>{let a=h.findIndex(t=>t.id===e);if(a<0||"up"===t&&0===a||"down"===t&&a===h.length-1)return;let s=[...h],r="up"===t?a-1:a+1;[s[a],s[r]]=[s[r],s[a]],p(s)},E=async()=>{let e=h.filter(e=>e.amount>0&&""!==e.description.trim());if(0===e.length)return void alert("Please enter at least one valid expense with amount and description");if(e.filter(e=>e.linkToCash&&!e.cashAccountId).length>0)return void alert("Please select a finance account for all linked expenses");N(!0);try{await m(e.map(({id:e,...t})=>({...t}))),localStorage.removeItem(tC),i()}catch(e){console.error("Bulk save failed",e),alert("Failed to save expenses. Please check your network connection.")}finally{N(!1)}};return(0,t.jsx)(C.Dialog,{open:e,onOpenChange:n,children:(0,t.jsx)(C.DialogContent,{className:"max-w-[95vw] md:max-w-6xl p-0 overflow-hidden border-none bg-transparent shadow-none",children:(0,t.jsx)("div",{className:"space-y-4 md:space-y-6",children:(0,t.jsxs)(D.Card,{className:"shadow-2xl overflow-hidden border-none bg-gradient-to-br from-white to-slate-50 dark:from-slate-900 dark:to-slate-950",children:[(0,t.jsx)(D.CardHeader,{className:"pb-3 bg-white dark:bg-slate-900 border-b",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 p-2 rounded-lg",children:(0,t.jsx)(tv.Receipt,{className:"h-5 w-5 text-red-600"})}),(0,t.jsx)(D.CardTitle,{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"Bulk Expense Entry"})]}),(0,t.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Log multiple expenses efficiently. Link them to finance accounts to update cash ledgers automatically."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(x.Button,{variant:"ghost",onClick:()=>n(!1),disabled:y,children:[(0,t.jsx)(e9.X,{className:"h-4 w-4 mr-2"}),"Cancel"]}),(0,t.jsxs)(x.Button,{onClick:E,disabled:y,className:"bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 shadow-lg font-bold",children:[y?(0,t.jsx)(ty.Save,{className:"h-4 w-4 mr-2 animate-spin"}):(0,t.jsx)(ty.Save,{className:"h-4 w-4 mr-2"}),"Save ",h.filter(e=>e.amount>0).length," Expenses"]})]})]})}),(0,t.jsx)(D.CardContent,{className:"p-4 sm:p-6 space-y-6 max-h-[80vh] overflow-y-auto custom-scrollbar",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-slate-900/50 rounded-xl p-4 border border-slate-100 dark:border-slate-800 space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[(0,t.jsxs)("div",{className:"flex-1 md:flex-initial",children:[(0,t.jsx)("p",{className:"text-[10px] font-semibold text-muted-foreground uppercase mb-1 ml-1",children:"Default Date"}),(0,t.jsxs)(tr.Popover,{children:[(0,t.jsx)(tr.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(x.Button,{variant:"outline",className:(0,l.cn)("justify-start text-left font-normal w-full md:w-[220px] h-10 shadow-sm rounded-lg",!f&&"text-muted-foreground"),children:[(0,t.jsx)(th.Calendar,{className:"mr-2 h-4 w-4 text-red-500"}),f?(0,ti.format)(f,"PPP"):(0,t.jsx)("span",{children:"Pick a date"})]})}),(0,t.jsx)(tr.PopoverContent,{className:"w-auto p-0 z-[100]",align:"start",children:(0,t.jsx)(ts.Calendar,{mode:"single",selected:f,onSelect:e=>e&&g(e),initialFocus:!0})})]})]}),(0,t.jsx)("div",{className:"flex items-end h-full",children:(0,t.jsxs)(x.Button,{onClick:w,variant:"outline",className:"gap-2 h-10 font-semibold border-red-200 dark:border-red-900/30 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/10 rounded-lg",children:[(0,t.jsx)(o.Plus,{className:"h-4 w-4"}),"Add Row"]})})]}),(0,t.jsxs)(tb.Alert,{className:"bg-orange-50/50 dark:bg-orange-900/10 border-orange-100 dark:border-orange-900 py-2 w-full md:max-w-xs",children:[(0,t.jsx)(tj.Info,{className:"h-4 w-4 text-orange-500"}),(0,t.jsxs)(tb.AlertDescription,{className:"text-[10px] sm:text-xs",children:["Rows with ",(0,t.jsx)("strong",{children:"Link Transaction"})," checked will automatically create cash deductions."]})]})]}),(0,t.jsx)("div",{className:"min-h-[300px]",children:c?(0,t.jsx)("div",{className:"space-y-4 px-1",children:h.map((e,a)=>(0,t.jsxs)(D.Card,{className:"overflow-hidden border-l-4 border-l-red-500/30 shadow-sm",children:[(0,t.jsxs)(D.CardHeader,{className:"flex flex-row items-center justify-between p-3 pb-2 bg-muted/20",children:[(0,t.jsxs)(D.CardTitle,{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:["Expense ",a+1]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(x.Button,{size:"icon",variant:"ghost",className:"h-8 w-8 text-muted-foreground",onClick:()=>S(e.id,"up"),children:(0,t.jsx)(tf.ArrowUp,{className:"h-4 w-4"})}),(0,t.jsx)(x.Button,{size:"icon",variant:"ghost",className:"h-8 w-8 text-destructive/70",onClick:()=>k(e.id),children:(0,t.jsx)(b.Trash2,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)(D.CardContent,{className:"p-3 space-y-3",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)(tr.Popover,{children:[(0,t.jsx)(tr.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(x.Button,{variant:"outline",size:"sm",className:(0,l.cn)("w-full justify-start text-left font-normal h-9 rounded-lg",!e.date&&"text-muted-foreground"),children:[(0,t.jsx)(th.Calendar,{className:"mr-2 h-3 w-3"}),(0,t.jsx)("span",{className:"truncate text-xs",children:e.date?(0,ti.format)(e.date,"MMM dd, yyyy"):"Date"})]})}),(0,t.jsx)(tr.PopoverContent,{className:"w-auto p-0 z-[70]",align:"start",children:(0,t.jsx)(ts.Calendar,{mode:"single",selected:e.date,onSelect:t=>t&&A(e.id,{date:t}),initialFocus:!0})})]}),(0,t.jsx)(j.Input,{type:"number",placeholder:"Amount",value:e.amount||"",onChange:t=>A(e.id,{amount:Number(t.target.value)}),className:"h-9 font-medium rounded-lg"})]}),(0,t.jsx)(j.Input,{placeholder:"Description",value:e.description,onChange:t=>A(e.id,{description:t.target.value}),className:"h-9 rounded-lg"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)(tn.Select,{value:e.category,onValueChange:t=>A(e.id,{category:t}),children:[(0,t.jsx)(tn.SelectTrigger,{className:"h-9 text-xs rounded-lg",children:(0,t.jsx)(tn.SelectValue,{placeholder:"Category"})}),(0,t.jsxs)(tn.SelectContent,{children:[(0,t.jsx)(tn.SelectItem,{value:"Sales",children:"Sales"}),(0,t.jsx)(tn.SelectItem,{value:"Expenses",children:"Expenses"}),(0,t.jsx)(tn.SelectItem,{value:"Payroll",children:"Payroll"}),(0,t.jsx)(tn.SelectItem,{value:"Other",children:"Other"})]})]}),(0,t.jsxs)(tn.Select,{value:e.paymentMethod,onValueChange:t=>A(e.id,{paymentMethod:t}),children:[(0,t.jsx)(tn.SelectTrigger,{className:"h-9 text-xs rounded-lg",children:(0,t.jsx)(tn.SelectValue,{placeholder:"Method"})}),(0,t.jsxs)(tn.SelectContent,{children:[(0,t.jsx)(tn.SelectItem,{value:"Cash",children:"Cash"}),(0,t.jsx)(tn.SelectItem,{value:"M-Pesa",children:"M-Pesa"}),(0,t.jsx)(tn.SelectItem,{value:"Bank",children:"Bank"}),(0,t.jsx)(tn.SelectItem,{value:"Card",children:"Card"})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2 p-2 bg-slate-50 dark:bg-slate-900 rounded-lg border border-slate-100 dark:border-slate-800",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(tN.Checkbox,{id:`link-mobile-${e.id}`,checked:e.linkToCash,onCheckedChange:t=>A(e.id,{linkToCash:!!t})}),(0,t.jsx)(v.Label,{htmlFor:`link-mobile-${e.id}`,className:"text-xs font-medium",children:"Link to Finance Account"})]}),e.linkToCash&&(0,t.jsxs)(tn.Select,{value:e.cashAccountId,onValueChange:t=>A(e.id,{cashAccountId:t}),children:[(0,t.jsx)(tn.SelectTrigger,{className:"h-9 text-xs rounded-md",children:(0,t.jsx)(tn.SelectValue,{placeholder:"Select Account"})}),(0,t.jsx)(tn.SelectContent,{children:u.map(e=>(0,t.jsx)(tn.SelectItem,{value:e.id,children:e.name},e.id))})]})]})]})]},e.id))}):(0,t.jsx)("div",{className:"overflow-x-auto rounded-xl border-none shadow-sm bg-white dark:bg-slate-900",children:(0,t.jsxs)(e3.Table,{children:[(0,t.jsx)(e3.TableHeader,{className:"bg-slate-50 dark:bg-slate-800/50",children:(0,t.jsxs)(e3.TableRow,{children:[(0,t.jsx)(e3.TableHead,{className:"w-[140px]",children:"Date"}),(0,t.jsx)(e3.TableHead,{className:"w-[130px]",children:"Amount"}),(0,t.jsx)(e3.TableHead,{children:"Description"}),(0,t.jsx)(e3.TableHead,{className:"w-[140px]",children:"Category"}),(0,t.jsx)(e3.TableHead,{className:"w-[180px]",children:"Link to Cash"}),(0,t.jsx)(e3.TableHead,{className:"w-[120px] text-right",children:"Actions"})]})}),(0,t.jsx)(e3.TableBody,{children:h.map(e=>(0,t.jsxs)(e3.TableRow,{className:"hover:bg-muted/30 transition-colors border-slate-100 dark:border-slate-800",children:[(0,t.jsx)(e3.TableCell,{children:(0,t.jsxs)(tr.Popover,{children:[(0,t.jsx)(tr.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(x.Button,{variant:"outline",size:"sm",className:(0,l.cn)("w-full justify-start text-left font-normal h-9 rounded-lg",!e.date&&"text-muted-foreground"),children:[(0,t.jsx)(th.Calendar,{className:"mr-2 h-3 w-3 shrink-0"}),(0,t.jsx)("span",{className:"truncate",children:e.date?(0,ti.format)(e.date,"MMM dd, yyyy"):"Date"})]})}),(0,t.jsx)(tr.PopoverContent,{className:"w-auto p-0 z-[70]",align:"start",children:(0,t.jsx)(ts.Calendar,{mode:"single",selected:e.date,onSelect:t=>t&&A(e.id,{date:t}),initialFocus:!0})})]})}),(0,t.jsx)(e3.TableCell,{children:(0,t.jsx)(j.Input,{type:"number",value:e.amount||"",onChange:t=>A(e.id,{amount:Number(t.target.value)}),className:"h-9 font-medium rounded-lg",placeholder:"0.00"})}),(0,t.jsx)(e3.TableCell,{children:(0,t.jsx)(j.Input,{value:e.description,onChange:t=>A(e.id,{description:t.target.value}),placeholder:"Description...",className:"h-9 rounded-lg"})}),(0,t.jsx)(e3.TableCell,{children:(0,t.jsxs)(tn.Select,{value:e.category,onValueChange:t=>A(e.id,{category:t}),children:[(0,t.jsx)(tn.SelectTrigger,{className:"h-9 rounded-lg",children:(0,t.jsx)(tn.SelectValue,{})}),(0,t.jsxs)(tn.SelectContent,{children:[(0,t.jsx)(tn.SelectItem,{value:"Sales",children:"Sales"}),(0,t.jsx)(tn.SelectItem,{value:"Expenses",children:"Expenses"}),(0,t.jsx)(tn.SelectItem,{value:"Payroll",children:"Payroll"}),(0,t.jsx)(tn.SelectItem,{value:"Supplies",children:"Supplies"}),(0,t.jsx)(tn.SelectItem,{value:"Utilities",children:"Utilities"}),(0,t.jsx)(tn.SelectItem,{value:"Rent",children:"Rent"}),(0,t.jsx)(tn.SelectItem,{value:"Other",children:"Other"})]})]})}),(0,t.jsx)(e3.TableCell,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-1.5 p-1 bg-slate-50/50 dark:bg-slate-800/50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(tN.Checkbox,{id:`link-${e.id}`,checked:e.linkToCash,onCheckedChange:t=>A(e.id,{linkToCash:!!t})}),(0,t.jsx)(v.Label,{htmlFor:`link-${e.id}`,className:"text-[10px] font-medium text-slate-600",children:"Link Transaction"})]}),e.linkToCash&&(0,t.jsxs)(tn.Select,{value:e.cashAccountId,onValueChange:t=>A(e.id,{cashAccountId:t}),children:[(0,t.jsx)(tn.SelectTrigger,{className:"text-[10px] h-7 px-2 rounded-md",children:(0,t.jsx)(tn.SelectValue,{placeholder:"Select Account"})}),(0,t.jsx)(tn.SelectContent,{children:u.map(e=>(0,t.jsx)(tn.SelectItem,{value:e.id,children:e.name},e.id))})]})]})}),(0,t.jsx)(e3.TableCell,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-0.5",children:[(0,t.jsx)(x.Button,{size:"icon",variant:"ghost",className:"h-7 w-7 text-muted-foreground",onClick:()=>S(e.id,"up"),children:(0,t.jsx)(tf.ArrowUp,{className:"h-3.5 w-3.5"})}),(0,t.jsx)(x.Button,{size:"icon",variant:"ghost",className:"h-7 w-7 text-muted-foreground",onClick:()=>S(e.id,"down"),children:(0,t.jsx)(tg.ArrowDown,{className:"h-3.5 w-3.5"})}),(0,t.jsx)(x.Button,{size:"icon",variant:"ghost",className:"h-7 w-7 text-destructive/70 hover:text-destructive hover:bg-destructive/10",onClick:()=>k(e.id),children:(0,t.jsx)(b.Trash2,{className:"h-3.5 w-3.5"})})]})})]},e.id))})]})})}),h.length>5&&(0,t.jsx)("div",{className:"flex justify-center pt-2",children:(0,t.jsxs)(x.Button,{onClick:w,variant:"ghost",className:"gap-2 text-muted-foreground hover:text-red-500",children:[(0,t.jsx)(o.Plus,{className:"h-4 w-4"}),"Add Another Row"]})})]})})]})})})})};var tk=e.i(366730),tA=e.i(675878),tS=e.i(430788),tT=e.i(615230),tE=e.i(232719);let tD=({open:e,onOpenChange:s,onUploadComplete:n})=>{let{createBulkExpenses:i}=(0,r.useExpenses)(),{accounts:o}=(0,e6.useCashAccounts)(),[c,h]=(0,a.useState)({step:"select",file:null,validRows:[],errors:[],totalRows:0,uploadProgress:0,successCount:0,failureCount:0}),p=(0,a.useRef)(null),[f,g]=(0,a.useState)(!1),[y,j]=(0,a.useState)(!1),v=e=>{let t=new Date,a=e.Date,s=a?.toString();if(s)if(a instanceof Date)t=a;else{let e=s.match(/^(\d{1,2})[/-](\d{1,2})[/-](\d{4})$/);if(e){let[,a,s,r]=e;t=new Date(parseInt(r),parseInt(s)-1,parseInt(a))}else{let e=new Date(s);isNaN(e.getTime())||(t=e)}}let r="",n=e["Link to Finance"]?.toString().toLowerCase()==="true";if(n&&e["Finance Account"]){let t=o?.find(t=>t.name.toLowerCase()===e["Finance Account"]?.toString().toLowerCase());t&&(r=t.id)}return{amount:parseFloat(e.Amount?.toString().replace(/[^0-9.-]/g,"")||"0"),description:e.Description||"",category:e.Category||"Other",date:t,paymentMethod:e["Payment Method"]||"Cash",personInCharge:e["Person In Charge"]||"",linkToCash:n,cashAccountId:r||void 0}},b=async e=>{let t,a=e.name.endsWith(".xlsx")||e.name.endsWith(".xls"),s=e.name.endsWith(".csv");if(!a&&!s)return void alert("Please select a CSV or Excel file");if(a){let a=await e.arrayBuffer(),s=tT.read(a,{cellDates:!0}),r=s.SheetNames[0],n=s.Sheets[r],l=tT.utils.sheet_to_json(n).map(e=>({Date:e.Date||"",Amount:e.Amount||"",Description:e.Description||"",Category:e.Category||"","Payment Method":e["Payment Method"]||"","Person In Charge":e["Person In Charge"]||"","Link to Finance":e["Link to Finance"]||"","Finance Account":e["Finance Account"]||""})),i=[],c=[];l.forEach((e,t)=>{let a=(0,tE.validateExpenseCSVRow)(e,t+2);e["Link to Finance"]?.toString().toLowerCase()==="true"&&e["Finance Account"]&&(o?.find(t=>t.name.toLowerCase()===e["Finance Account"]?.toString().toLowerCase())||a.push({row:t+2,field:"Finance Account",message:`Account "${e["Finance Account"]}" not found.`})),0===a.length?i.push(e):c.push(...a)}),t={validRows:i,errors:c,totalRows:l.length}}else{let a=await e.text();t=(0,tE.parseExpenseCSV)(a);let s=[],r=[];t.validRows.forEach((e,t)=>{e["Link to Finance"]?.toString().toLowerCase()==="true"&&e["Finance Account"]?o?.find(t=>t.name.toLowerCase()===e["Finance Account"]?.toString().toLowerCase())?r.push(e):s.push({row:t+2,field:"Finance Account",message:`Account "${e["Finance Account"]}" not found.`}):r.push(e)}),t.errors.push(...s),t.validRows=r}h({...c,step:"preview",file:e,validRows:t.validRows,errors:t.errors,totalRows:t.totalRows})},N=async()=>{h(e=>({...e,step:"uploading",uploadProgress:0})),j(!0);let e=c.validRows.map(v);try{await i(e),h(t=>({...t,step:"complete",uploadProgress:100,successCount:e.length,failureCount:0})),setTimeout(()=>n(),1500)}catch(t){console.error("Bulk upload failed:",t),h(t=>({...t,step:"complete",uploadProgress:100,successCount:0,failureCount:e.length}))}finally{j(!1)}};return(0,t.jsx)(C.Dialog,{open:e,onOpenChange:s,children:(0,t.jsx)(C.DialogContent,{className:"max-w-[95vw] md:max-w-4xl p-0 overflow-hidden border-none bg-transparent shadow-none",children:(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)(D.Card,{className:"shadow-2xl border-none bg-transparent",children:[(0,t.jsx)(D.CardHeader,{className:"px-6 py-4 bg-white dark:bg-slate-900 border-b rounded-t-[2rem]",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"bg-red-600 p-2.5 rounded-2xl text-white shadow-lg",children:(0,t.jsx)(m.Upload,{className:"h-6 w-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D.CardTitle,{className:"text-2xl font-black tracking-tight",children:"CSV/Excel Importer"}),(0,t.jsx)("p",{className:"text-sm font-bold text-slate-500 dark:text-slate-400 uppercase tracking-tight",children:"Bulk process historical expense logs"})]})]}),(0,t.jsxs)(x.Button,{variant:"ghost",onClick:()=>s(!1),className:"bg-white dark:bg-slate-900 shadow-sm border rounded-xl h-10 px-4",children:[(0,t.jsx)(e9.X,{className:"h-4 w-4 mr-2"})," Cancel"]})]})}),(0,t.jsx)(D.CardContent,{className:"p-0",children:(0,t.jsxs)("div",{className:"bg-white/95 dark:bg-slate-900/95 backdrop-blur-sm rounded-b-[2rem] p-8 md:p-12 border shadow-sm min-h-[450px] max-h-[85vh] overflow-y-auto custom-scrollbar flex flex-col justify-center",children:["select"===c.step&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:(0,l.cn)("border-4 border-dashed rounded-3xl p-12 text-center cursor-pointer transition-all duration-300",f?"border-red-500 bg-red-50/50 scale-[1.01] shadow-xl":"border-slate-200 dark:border-slate-800 hover:border-red-400 hover:bg-slate-50/50 dark:hover:bg-slate-900/50"),onDrop:e=>{e.preventDefault(),g(!1),b(e.dataTransfer.files[0])},onDragOver:e=>{e.preventDefault(),g(!0)},onDragLeave:()=>g(!1),onClick:()=>p.current?.click(),children:[(0,t.jsx)("div",{className:"bg-red-100 dark:bg-red-900/40 w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-sm",children:(0,t.jsx)(m.Upload,{className:"h-10 w-10 text-red-600 dark:text-red-400"})}),(0,t.jsx)("h3",{className:"text-2xl font-black text-slate-900 dark:text-slate-100 mb-2",children:"Select CSV or Excel"}),(0,t.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 max-w-sm mx-auto mb-8",children:"Import multiple expenses quickly. Drag and drop your file here or click to browse."}),(0,t.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-100 dark:bg-slate-800 rounded-full text-[11px] font-bold text-slate-600 dark:text-slate-400",children:[(0,t.jsx)(u.FileText,{className:"h-3 w-3"})," .CSV"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-100 dark:bg-green-900/30 rounded-full text-[11px] font-bold text-green-700 dark:text-green-400",children:[(0,t.jsx)(u.FileText,{className:"h-3 w-3"})," .XLSX"]})]})]}),(0,t.jsxs)("div",{className:"border rounded-2xl overflow-hidden bg-white dark:bg-slate-900 shadow-sm",children:[(0,t.jsx)("div",{className:"bg-slate-50 dark:bg-slate-800/50 px-6 py-3 border-b flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(tj.Info,{className:"h-4 w-4 text-red-500"}),(0,t.jsx)("span",{className:"text-xs font-black text-slate-700 dark:text-slate-300 uppercase tracking-widest",children:"Expected Format"})]})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(e3.Table,{children:[(0,t.jsx)(e3.TableHeader,{children:(0,t.jsxs)(e3.TableRow,{className:"bg-slate-100/30 dark:bg-slate-900/30",children:[(0,t.jsx)(e3.TableHead,{className:"text-[10px] h-9",children:"Date"}),(0,t.jsx)(e3.TableHead,{className:"text-[10px] h-9",children:"Amount"}),(0,t.jsx)(e3.TableHead,{className:"text-[10px] h-9",children:"Description"}),(0,t.jsx)(e3.TableHead,{className:"text-[10px] h-9",children:"Link to Finance"}),(0,t.jsx)(e3.TableHead,{className:"text-[10px] h-9",children:"Finance Account"})]})}),(0,t.jsxs)(e3.TableBody,{children:[(0,t.jsxs)(e3.TableRow,{className:"h-9 border-slate-100 dark:border-slate-800",children:[(0,t.jsx)(e3.TableCell,{className:"text-[11px] py-1.5 font-mono",children:"22/12/2025"}),(0,t.jsx)(e3.TableCell,{className:"text-[11px] py-1.5 font-bold",children:"450.00"}),(0,t.jsx)(e3.TableCell,{className:"text-[11px] py-1.5 truncate max-w-[120px]",children:"Office Rent"}),(0,t.jsx)(e3.TableCell,{className:"text-[11px] py-1.5 text-red-600 font-bold italic",children:"true"}),(0,t.jsx)(e3.TableCell,{className:"text-[11px] py-1.5 truncate max-w-[120px]",children:"Company Wallet"})]}),(0,t.jsxs)(e3.TableRow,{className:"h-9 border-none",children:[(0,t.jsx)(e3.TableCell,{className:"text-[11px] py-1.5 font-mono",children:"23/12/2025"}),(0,t.jsx)(e3.TableCell,{className:"text-[11px] py-1.5 font-bold",children:"120.00"}),(0,t.jsx)(e3.TableCell,{className:"text-[11px] py-1.5 truncate max-w-[120px]",children:"Stationery"}),(0,t.jsx)(e3.TableCell,{className:"text-[11px] py-1.5 text-slate-400 font-bold italic",children:"false"}),(0,t.jsx)(e3.TableCell,{className:"text-[11px] py-1.5 text-slate-400 italic",children:"Leave Empty"})]})]})]})})]}),(0,t.jsx)("input",{ref:p,type:"file",accept:".csv, .xlsx, .xls",onChange:e=>e.target.files?.[0]&&b(e.target.files[0]),className:"hidden"})]}),"preview"===c.step&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-2xl border border-slate-100 dark:border-slate-800 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"bg-red-50 dark:bg-red-900/30 p-2 rounded-xl",children:(0,t.jsx)(u.FileText,{className:"h-6 w-6 text-red-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-lg font-black text-slate-900 dark:text-slate-100",children:c.file?.name}),(0,t.jsx)("p",{className:"text-xs text-slate-500 uppercase font-bold tracking-tight",children:"Analyzed Successfully"})]})]}),(0,t.jsx)(x.Button,{variant:"ghost",size:"sm",onClick:()=>h(e=>({...e,step:"select"})),className:"text-red-600 font-bold",children:"Change File"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(D.Card,{className:"shadow-none bg-emerald-50/50 dark:bg-emerald-900/10 border-emerald-100 dark:border-emerald-800/50",children:(0,t.jsxs)(D.CardContent,{className:"p-6",children:[(0,t.jsx)("div",{className:"text-3xl font-black text-emerald-600 dark:text-emerald-400",children:c.validRows.length}),(0,t.jsx)("p",{className:"text-[10px] font-black text-emerald-700 dark:text-emerald-500 uppercase tracking-widest mt-1",children:"Ready to Import"})]})}),(0,t.jsx)(D.Card,{className:"shadow-none bg-rose-50/50 dark:bg-rose-900/10 border-rose-100 dark:border-rose-800/50",children:(0,t.jsxs)(D.CardContent,{className:"p-6",children:[(0,t.jsx)("div",{className:"text-3xl font-black text-rose-600 dark:text-rose-400",children:c.errors.length}),(0,t.jsx)("p",{className:"text-[10px] font-black text-rose-700 dark:text-rose-500 uppercase tracking-widest mt-1",children:"Invalid Records"})]})})]})]}),c.errors.length>0&&(0,t.jsxs)(tb.Alert,{variant:"destructive",className:"bg-rose-50/50 dark:bg-rose-900/10 border-rose-200 dark:border-rose-900/50 rounded-2xl p-4",children:[(0,t.jsx)(tA.AlertCircle,{className:"h-5 w-5 text-rose-600"}),(0,t.jsxs)(tb.AlertDescription,{className:"text-sm text-rose-700 dark:text-rose-400 leading-relaxed font-bold ml-2",children:["Heads up! ",c.errors.length," rows have errors and will be skipped.",(0,t.jsxs)(x.Button,{variant:"link",className:"p-0 h-auto ml-2 text-rose-800 dark:text-rose-300 underline font-black uppercase text-xs",onClick:()=>(0,tE.generateErrorLogCSV)(c.errors,"expense_errors.csv"),children:[(0,t.jsx)(d.Download,{className:"h-3 w-3 mr-1 inline"})," Export Error Log"]})]})]}),(0,t.jsxs)(x.Button,{className:"w-full h-14 bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 shadow-xl font-black text-lg rounded-2xl",onClick:N,disabled:0===c.validRows.length,children:["Confirm Import of ",c.validRows.length," Expenses"]})]}),"uploading"===c.step&&(0,t.jsxs)("div",{className:"space-y-10 py-12 text-center",children:[(0,t.jsxs)("div",{className:"relative w-24 h-24 mx-auto",children:[(0,t.jsx)("div",{className:"absolute inset-0 rounded-3xl border-4 border-slate-100 dark:border-slate-800"}),(0,t.jsx)("div",{className:"absolute inset-0 rounded-3xl border-4 border-t-red-600 animate-spin"}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)(tv.Receipt,{className:"h-10 w-10 text-red-500/30"})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-2xl font-black",children:"Processing Your Data"}),(0,t.jsxs)("div",{className:"max-w-xs mx-auto space-y-2",children:[(0,t.jsx)(tk.Progress,{value:c.uploadProgress,className:"h-3 rounded-full bg-slate-100 dark:bg-slate-800"}),(0,t.jsxs)("span",{className:"text-xs font-black text-slate-400 uppercase tracking-[0.2em]",children:[Math.round(c.uploadProgress),"% Complete"]})]})]})]}),"complete"===c.step&&(0,t.jsxs)("div",{className:"space-y-8 py-8 text-center animate-in fade-in zoom-in duration-500",children:[(0,t.jsx)("div",{className:"bg-emerald-100 dark:bg-emerald-900/30 w-24 h-24 rounded-[2rem] flex items-center justify-center mx-auto shadow-inner",children:(0,t.jsx)(tS.CheckCircle,{className:"h-12 w-12 text-emerald-600 dark:text-emerald-400"})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h3",{className:"text-3xl font-black tracking-tight",children:"Import Complete!"}),(0,t.jsxs)("p",{className:"text-slate-500 dark:text-slate-400 font-bold uppercase text-xs tracking-widest",children:["Successfully Added ",(0,t.jsxs)("span",{className:"text-emerald-600 dark:text-emerald-400 font-black",children:[c.successCount," Records"]})]})]}),(0,t.jsx)(x.Button,{onClick:n,className:"h-14 px-12 rounded-2xl text-lg font-black bg-slate-900 hover:bg-black dark:bg-white dark:text-black shadow-xl",children:"Return to Dashboard"})]})]})})]})})})})};var tP=e.i(847550);let tI=({onNewEntry:e,onBulkEntry:a,onImportCSV:s,canCreate:r=!0})=>(0,t.jsx)(D.Card,{className:"border-none shadow-md overflow-hidden bg-gradient-to-br from-white to-slate-50 dark:from-slate-900 dark:to-slate-950 mb-6",children:(0,t.jsxs)("div",{className:"p-4 sm:p-6 space-y-4",children:[(0,t.jsx)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h3",{className:"text-lg font-bold tracking-tight",children:"Expense Center"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Manage your business expenditures efficiently"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[(0,t.jsxs)(x.Button,{type:"button",onClick:e,disabled:!r,className:(0,l.cn)("h-auto py-4 flex flex-col items-center justify-center gap-2 text-white shadow-lg border-none active:scale-[0.98] transition-all",r?"bg-red-600 hover:bg-red-700":"bg-slate-400 cursor-not-allowed opacity-60"),children:[(0,t.jsx)("div",{className:"bg-white/20 p-2 rounded-lg",children:(0,t.jsx)(o.Plus,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("span",{className:"block font-bold",children:"New Entry"}),(0,t.jsx)("span",{className:"block text-[10px] opacity-80 font-medium",children:"Single Expense"})]})]}),(0,t.jsxs)(x.Button,{type:"button",onClick:a,variant:"outline",disabled:!r,className:(0,l.cn)("h-auto py-4 flex flex-col items-center justify-center gap-2 border-slate-200 dark:border-slate-800 shadow-sm active:scale-[0.98] transition-all",r?"hover:bg-orange-50/50 dark:hover:bg-orange-900/10 hover:border-orange-200":"opacity-60 cursor-not-allowed"),children:[(0,t.jsx)("div",{className:"bg-orange-100 dark:bg-orange-900/30 p-2 rounded-lg text-orange-600 dark:text-orange-400",children:(0,t.jsx)(tP.LayoutGrid,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("span",{className:"block font-bold",children:"Bulk Entry"}),(0,t.jsx)("span",{className:"block text-[10px] text-muted-foreground font-medium",children:"Manual Batch"})]})]}),(0,t.jsxs)(x.Button,{type:"button",onClick:s,variant:"outline",disabled:!r,className:(0,l.cn)("h-auto py-4 flex flex-col items-center justify-center gap-2 border-slate-200 dark:border-slate-800 shadow-sm active:scale-[0.98] transition-all",r?"hover:bg-emerald-50/50 dark:hover:bg-emerald-900/10 hover:border-emerald-200":"opacity-60 cursor-not-allowed"),children:[(0,t.jsx)("div",{className:"bg-emerald-100 dark:bg-emerald-900/30 p-2 rounded-lg text-emerald-600 dark:text-emerald-400",children:(0,t.jsx)(m.Upload,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("span",{className:"block font-bold",children:"Import CSV"}),(0,t.jsx)("span",{className:"block text-[10px] text-muted-foreground font-medium",children:"Process Legacy Logs"})]})]})]})]})});var tO=e.i(537068);let tF=(0,e.i(369547).default)("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);var tM=e.i(365713),tL=e.i(411168);e.s(["default",0,()=>{let{user:e}=(0,s.useAuth)(),o=(0,tM.useNavigate)(),c=(0,T.useIsMobile)(),{hasPermission:d,isLoading:u}=(0,tu.useProfiles)(),{settings:m}=(0,n.useBusinessSettings)(),{expenses:h,isLoading:p,createExpense:f,updateExpense:g,deleteExpense:y,refreshExpenses:j}=(0,r.useExpenses)(),[v,b]=(0,a.useState)("overview"),[N,C]=(0,a.useState)(!1),[w,k]=(0,a.useState)(!1),[A,S]=(0,a.useState)(!1),[D,P]=(0,a.useState)("all"),[I,O]=(0,a.useState)({from:void 0,to:void 0}),{filteredExpenses:M,expenseStats:L,formatCurrency:R}=((e,t,s)=>{let{settings:r}=(0,n.useBusinessSettings)(),o=(0,a.useMemo)(()=>{let e=r.currency||"USD";return t=>(0,l.formatCashCurrency)(t,e)},[r.currency]),c=(0,a.useMemo)(()=>{let a,r;if("all"===t)return e;if("custom"===t)a=s.from,r=s.to;else{let e=(0,i.getDateRangeFromFilter)(t);a=e.from,r=e.to}return e.filter(e=>(0,i.isDateInRange)(e.date,a,r))},[e,t,s]),d=(0,a.useMemo)(()=>({totalExpenses:c.reduce((e,t)=>e+t.amount,0),thisMonthExpenses:c.filter(e=>{let t=e.date.getMonth(),a=new Date().getMonth(),s=e.date.getFullYear(),r=new Date().getFullYear();return t===a&&s===r}).reduce((e,t)=>e+t.amount,0),transactionCount:c.length}),[c]);return{filteredExpenses:c,expenseStats:d,formatCurrency:o}})(h||[],D,I),B=async e=>{try{await f(e),C(!1)}catch(e){console.error("Error creating expense:",e)}},z=(0,a.useCallback)(()=>{((e,t,a="USD")=>{if(0===e.length)return alert("No expenses to export");let s=new Blob([[["Date","Description","Category","Amount","Payment Method","Person in Charge","Cash Account","Receipt Available"],...e.map(e=>[(0,ti.format)(e.date,"yyyy-MM-dd"),`"${e.description.replace(/"/g,'""')}"`,e.category||"",e.amount.toString(),e.paymentMethod||"",e.personInCharge||"",e.cashAccountId?"Yes":"No",e.receiptImage?"Yes":"No"])].map(e=>e.join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(void 0!==r.download){let e=URL.createObjectURL(s);r.setAttribute("href",e),r.setAttribute("download",`expenses-${a}-${(0,ti.format)(new Date,"yyyy-MM-dd")}.csv`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}})(M,0,m?.currency||"USD")},[M,R,m?.currency]),V=(0,a.useCallback)(()=>{((e,t,a="USD",s,r,n,l)=>{if(0===e.length)return alert("No expenses to export");let i=new tL.default({orientation:"landscape",unit:"mm",format:"a4"}),o=i.internal.pageSize.getWidth(),c=i.internal.pageSize.getHeight(),d=8;i.setFontSize(20),i.setFont("helvetica","bold"),i.text(s||"Business",8,d),d+=12,i.setFontSize(16),i.text("Expenses Report",8,d),d+=10,i.setFontSize(12),i.setFont("helvetica","normal");let u="";if(n&&"all"!==n)switch(n){case"today":u=`Period: Today (${(0,ti.format)(new Date,"MMM dd, yyyy")})`;break;case"yesterday":let m=new Date;m.setDate(m.getDate()-1),u=`Period: Yesterday (${(0,ti.format)(m,"MMM dd, yyyy")})`;break;case"this-week":u="Period: This Week";break;case"last-week":u="Period: Last Week";break;case"this-month":u=`Period: This Month (${(0,ti.format)(new Date,"MMMM yyyy")})`;break;case"last-month":let x=new Date;x.setMonth(x.getMonth()-1),u=`Period: Last Month (${(0,ti.format)(x,"MMMM yyyy")})`;break;case"this-year":u=`Period: This Year (${(0,ti.format)(new Date,"yyyy")})`;break;case"custom":u=l?.from&&l?.to?`Period: ${(0,ti.format)(l.from,"MMM dd, yyyy")} - ${(0,ti.format)(l.to,"MMM dd, yyyy")}`:l?.from?`Period: From ${(0,ti.format)(l.from,"MMM dd, yyyy")}`:l?.to?`Period: Until ${(0,ti.format)(l.to,"MMM dd, yyyy")}`:"Period: Custom Range";break;default:u="Period: All Time"}else u="Period: All Time";i.text(u,8,d),d+=6,i.setFontSize(10),i.text(`Generated on: ${(0,ti.format)(new Date,"MMM dd, yyyy HH:mm")}`,8,d),d+=10;let h=e.reduce((e,t)=>e+t.amount,0),p=d,f=[{header:"Date",width:25,x:8},{header:"Description",width:65,x:33},{header:"Category",width:30,x:98},{header:`Amount (${a})`,width:30,x:128},{header:"Payment",width:30,x:158},{header:"Person",width:35,x:188},{header:"Cash",width:20,x:223},{header:"Receipt",width:20,x:243}];i.setFillColor(240,240,240),i.rect(8,p,o-16,8,"F"),i.setFontSize(9),i.setFont("helvetica","bold"),i.setTextColor(0,0,0),f.forEach(e=>{i.text(e.header,e.x+2,p+6)}),i.setLineWidth(.5),i.setDrawColor(0,0,0),i.rect(8,p,o-16,8),i.setFont("helvetica","normal"),i.setFontSize(8);let g=p+8,y=Math.floor((c-g-20)/6);e.forEach((e,a)=>{a>0&&a%y==0&&(i.addPage(),g=8,i.setFillColor(240,240,240),i.rect(8,g,o-16,8,"F"),i.setFont("helvetica","bold"),i.setFontSize(9),f.forEach(e=>{i.text(e.header,e.x+2,g+6)}),i.rect(8,g,o-16,8),g+=8,i.setFont("helvetica","normal"),i.setFontSize(8)),a%2==1&&(i.setFillColor(248,248,248),i.rect(8,g,o-16,6,"F"));let s=[(0,ti.format)(e.date,"MM/dd/yyyy"),e.description.length>30?e.description.substring(0,27)+"...":e.description,e.category||"-",t(e.amount),e.paymentMethod?.substring(0,12)||"-",e.personInCharge?.substring(0,15)||"-",e.cashAccountId?"Yes":"No",e.receiptImage?"Yes":"No"];f.forEach((e,t)=>{let a=s[t],r=e.x+2;if(3===t){let t=i.getTextWidth(a);i.text(a,e.x+e.width-t-2,g+4.5)}else i.text(a,r,g+4.5)}),i.setLineWidth(.1),i.rect(8,g,o-16,6),g+=6}),(g+=8)+25>c-8&&(i.addPage(),g=20),i.setFontSize(14),i.setFont("helvetica","bold"),i.text("Summary",8,g),g+=12,i.setFontSize(11),i.setFont("helvetica","normal"),[["Total Expenses:",e.length.toString()],["Total Amount:",t(h)],["With Receipts:",e.filter(e=>e.receiptImage).length.toString()],["Cash Linked:",e.filter(e=>e.cashAccountId).length.toString()]].forEach((e,t)=>{let a=g+5*t;i.setFont("helvetica","bold"),i.text(e[0],8,a),i.setFont("helvetica","normal"),i.text(e[1],58,a)});let j=i.getNumberOfPages();for(let e=1;e<=j;e++)i.setPage(e),i.setFontSize(8),i.setFont("helvetica","normal"),i.text(`Page ${e} of ${j}`,o-8-20,c-10),i.setFontSize(10),i.setFont("helvetica","italic"),i.setTextColor(150,150,150),i.text("Created By Gonza Systems",8,c-5),i.setTextColor(0,0,0);let v=`expenses_report_${(0,ti.format)(new Date,"yyyy-MM-dd")}.pdf`;i.save(v)})(M,R,m?.currency||"USD",m?.businessName,m?.businessLogo,D,I)},[M,R,m,D,I]);if(u||p)return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(!d("expenses","view"))return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,t.jsxs)(tb.Alert,{variant:"destructive",children:[(0,t.jsx)(tA.AlertCircle,{className:"h-4 w-4"}),(0,t.jsx)(tb.AlertTitle,{children:"Access Denied"}),(0,t.jsx)(tb.AlertDescription,{children:"You do not have permission to view expenses. Please contact your administrator if you believe this is an error."})]}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(x.Button,{onClick:()=>o("/"),variant:"outline",children:"Back to Dashboard"})})]});let _=d("expenses","create");return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(E,{onAddExpense:()=>C(!0),isRefreshing:p,onRefresh:j,onAddBulkExpense:()=>k(!0),onImportExpenses:()=>S(!0),onExportCSV:z,onExportPDF:V,onDownloadTemplate:()=>{let e,t;return e=tT.utils.json_to_sheet([{Date:"22/12/2025",Amount:"450.00",Description:"Office Rent",Category:"Rent","Payment Method":"Bank","Person In Charge":"Admin","Link to Finance":"true","Finance Account":"Company Wallet"},{Date:"23/12/2025",Amount:"120.00",Description:"Stationery",Category:"Supplies","Payment Method":"Cash","Person In Charge":"Manager","Link to Finance":"false","Finance Account":""}],{header:["Date","Amount","Description","Category","Payment Method","Person In Charge","Link to Finance","Finance Account"]}),t=tT.utils.book_new(),void(tT.utils.book_append_sheet(t,e,"Expenses Template"),tT.writeFile(t,"expense_import_template.xlsx"))},canCreate:_}),(0,t.jsx)(to,{open:N,onOpenChange:C,onSubmit:B}),(0,t.jsx)(tw,{open:w,onOpenChange:k,onSuccess:()=>{k(!1),j()}}),(0,t.jsx)(tD,{open:A,onOpenChange:S,onUploadComplete:()=>{S(!1),j()}}),(0,t.jsx)("div",{className:"px-4 md:px-0",children:(0,t.jsxs)(F.Tabs,{value:v,onValueChange:b,className:"w-full space-y-6",children:[(0,t.jsxs)(F.TabsList,{className:`grid w-full ${c?"grid-cols-2 gap-1 h-auto py-1":"grid-cols-2"} bg-slate-100/50 dark:bg-slate-800/50 p-1 rounded-xl`,children:[(0,t.jsxs)(F.TabsTrigger,{value:"overview",className:"flex items-center gap-2 py-2.5 rounded-lg data-[state=active]:bg-white dark:data-[state=active]:bg-slate-900 data-[state=active]:shadow-sm",children:[(0,t.jsx)(tF,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Overview"})]}),(0,t.jsxs)(F.TabsTrigger,{value:"expenses-list",className:"flex items-center gap-2 py-2.5 rounded-lg data-[state=active]:bg-white dark:data-[state=active]:bg-slate-900 data-[state=active]:shadow-sm",children:[(0,t.jsx)(tO.List,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"List"})]})]}),(0,t.jsxs)(F.TabsContent,{value:"overview",className:"space-y-6 animate-in fade-in-50 duration-300",children:[(0,t.jsx)(tI,{onNewEntry:()=>C(!0),onBulkEntry:()=>k(!0),onImportCSV:()=>S(!0),canCreate:_}),(0,t.jsx)(tp,{dateFilter:D,dateRange:I,onDateFilterChange:P,onDateRangeChange:O}),(0,t.jsx)(tx,{filteredExpenses:M,expenseStats:L,formatCurrency:R,dateFilter:D,onUpdateExpense:g,onDeleteExpense:y,showOnlyOverview:!0})]}),(0,t.jsxs)(F.TabsContent,{value:"expenses-list",className:"space-y-6 animate-in fade-in-50 duration-300",children:[(0,t.jsx)(tp,{dateFilter:D,dateRange:I,onDateFilterChange:P,onDateRangeChange:O}),(0,t.jsx)(tx,{filteredExpenses:M,expenseStats:L,formatCurrency:R,dateFilter:D,onUpdateExpense:g,onDeleteExpense:y,showOnlyList:!0})]})]})})]})}],444680)},194725,(e,t,a)=>{let s="/Expenses";(window.__NEXT_P=window.__NEXT_P||[]).push([s,()=>e.r(444680)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([s])})}]);