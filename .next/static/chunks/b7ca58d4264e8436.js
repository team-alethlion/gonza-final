(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,433069,e=>{"use strict";var t=e.i(391398),r=e.i(191788),a=e.i(550292),s=e.i(824216),n=e.i(46108),l=e.i(679935),i=e.i(893930),c=e.i(285700),d=e.i(256680),o=e.i(290205),u=e.i(834492),m=e.i(530174),h=e.i(653162);async function g(e,t){try{let r=await d.db.task.findMany({where:{createdById:e,branchId:t},orderBy:{dueDate:"asc"}});return{success:!0,data:r.map(e=>({...e,user_id:e.userId,location_id:e.locationId,due_date:e.dueDate.toISOString().split("T")[0],completed_at:e.completedAt?.toISOString()||null,created_at:e.createdAt.toISOString(),updated_at:e.updatedAt.toISOString(),reminder_enabled:e.reminderEnabled,reminder_time:e.reminderTime,is_recurring:e.isRecurring,recurrence_type:e.recurrenceType,recurrence_end_date:e.recurrenceEndDate?.toISOString().split("T")[0]||null,parent_task_id:e.parentTaskId,recurrence_count:e.recurrenceCount}))}}catch(e){return console.error("Error fetching tasks:",e),{success:!1,error:e.message}}}async function x(e){try{let t=await d.db.$transaction(async t=>{let r=await t.task.create({data:{createdById:e.userId,branchId:e.locationId,title:e.title,description:e.description||null,priority:e.priority,dueDate:e.dueDate,category:e.category||null,reminderEnabled:e.reminderEnabled||!1,reminderTime:e.reminderTime||null,isRecurring:e.isRecurring||!1,recurrenceType:e.recurrenceType||null,recurrenceEndDate:e.recurrenceEndDate||null}});if(r.isRecurring&&r.recurrenceType&&r.recurrenceEndDate){let e=[],a=r.dueDate,s=r.recurrenceEndDate,n=0;for(;n<365;){let t;switch(r.recurrenceType){case"daily":t=(0,u.addDays)(a,1);break;case"weekly":t=(0,m.addWeeks)(a,1);break;case"monthly":t=(0,h.addMonths)(a,1);break;default:t=a}if(t>s)break;e.push({createdById:r.createdById,branchId:r.branchId,title:r.title,description:r.description,priority:r.priority,dueDate:t,category:r.category,completed:!1,reminderEnabled:r.reminderEnabled,reminderTime:r.reminderTime,isRecurring:!1,parentTaskId:r.id,recurrenceCount:n+1}),a=t,n++}e.length>0&&await t.task.createMany({data:e})}return r});return(0,o.revalidatePath)("/tasks"),{success:!0,data:t}}catch(e){return console.error("Error creating task:",e),{success:!1,error:e.message}}}async function y(e,t,r){try{let a=await d.db.$transaction(async a=>{let s=await a.task.update({where:{id:e,createdById:t},data:{...r}});if(s.isRecurring&&(r.recurrenceType||r.recurrenceEndDate)&&(await a.task.deleteMany({where:{parentTaskId:e,completed:!1}}),s.recurrenceType&&s.recurrenceEndDate)){let e=[],t=s.dueDate,r=s.recurrenceEndDate,n=0;for(;n<365;){let a;switch(s.recurrenceType){case"daily":a=(0,u.addDays)(t,1);break;case"weekly":a=(0,m.addWeeks)(t,1);break;case"monthly":a=(0,h.addMonths)(t,1);break;default:a=t}if(a>r)break;e.push({createdById:s.createdById,branchId:s.branchId,title:s.title,description:s.description,priority:s.priority,dueDate:a,category:s.category,isRecurring:!1,parentTaskId:s.id,recurrenceCount:n+1}),t=a,n++}e.length>0&&await a.task.createMany({data:e})}return s});return(0,o.revalidatePath)("/tasks"),{success:!0,data:a}}catch(e){return console.error("Error updating task:",e),{success:!1,error:e.message}}}async function p(e,t){try{return await d.db.$transaction(async r=>{await r.task.deleteMany({where:{parentTaskId:e,completed:!1}}),await r.task.delete({where:{id:e,createdById:t}})}),(0,o.revalidatePath)("/tasks"),{success:!0}}catch(e){return console.error("Error deleting task:",e),{success:!1,error:e.message}}}async function j(e,t,r){try{return await d.db.task.updateMany({where:{id:{in:e},createdById:t},data:r}),(0,o.revalidatePath)("/tasks"),{success:!0}}catch(e){return console.error("Error bulk updating tasks:",e),{success:!1,error:e.message}}}async function f(e,t){try{let r=await d.db.taskCategory.findMany({where:{userId:e,branchId:t},orderBy:{name:"asc"}});return{success:!0,data:r.map(e=>({...e,user_id:e.userId,location_id:e.locationId,created_at:e.createdAt.toISOString(),updated_at:e.updatedAt.toISOString()}))}}catch(e){return console.error("Error fetching categories:",e),{success:!1,error:e.message}}}async function v(e,t,r){try{let a=await d.db.taskCategory.create({data:{userId:e,branchId:t,name:r}});return{success:!0,data:a}}catch(e){return console.error("Error creating category:",e),{success:!1,error:e.message}}}async function k(e,t,r){try{let a=await d.db.taskCategory.update({where:{id:e,userId:t},data:{name:r}});return{success:!0,data:a}}catch(e){return console.error("Error updating category:",e),{success:!1,error:e.message}}}async function b(e,t){try{return await d.db.taskCategory.delete({where:{id:e,userId:t}}),{success:!0}}catch(e){return console.error("Error deleting category:",e),{success:!1,error:e.message}}}async function w(e,t){try{let r=["General","Marketing","Operations","Finance","Follow-up"],a=await d.db.taskCategory.findMany({where:{userId:e,branchId:t,name:{in:r}},select:{name:!0}}),s=new Set(a.map(e=>e.name)),n=r.filter(e=>!s.has(e)).map(r=>({userId:e,branchId:t,name:r}));return n.length>0&&await d.db.taskCategory.createMany({data:n}),{success:!0}}catch(e){return console.error("Error creating default categories:",e),{success:!1,error:e.message}}}let N=()=>{let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)(!0),{user:c}=(0,s.useAuth)(),{currentBusiness:d}=(0,n.useBusiness)(),o=async()=>{if(!c?.id||!d?.id){t([]),i(!1);return}try{let e=await f(c.id,d.id);if(!e.success||!e.data)throw Error(e.error||"Failed to fetch categories");t(e.data)}catch(e){console.error("Error loading task categories:",e),l.toast.error("Failed to load task categories"),t([])}finally{i(!1)}},u=async e=>{if(!c?.id||!d?.id)return null;try{let r=await v(c.id,d.id,e.trim());if(!r.success||!r.data)throw Error(r.error);let a=r.data,s={...a,user_id:a.userId,location_id:a.locationId,created_at:a.createdAt.toISOString(),updated_at:a.updatedAt.toISOString()};return t(e=>[...e,s]),l.toast.success("Category created successfully"),s}catch(e){return console.error("Error creating task category:",e),l.toast.error("Failed to create category"),null}},m=async(e,r)=>{if(!c?.id)return!1;try{let a=await k(e,c.id,r.trim());if(!a.success)throw Error(a.error);return t(t=>t.map(t=>t.id===e?{...t,name:r.trim()}:t)),l.toast.success("Category updated successfully"),!0}catch(e){return console.error("Error updating task category:",e),l.toast.error("Failed to update category"),!1}},h=async e=>{if(!c?.id)return!1;try{let r=await b(e,c.id);if(!r.success)throw Error(r.error);return t(t=>t.filter(t=>t.id!==e)),l.toast.success("Category deleted successfully"),!0}catch(e){return console.error("Error deleting task category:",e),l.toast.error("Failed to delete category"),!1}},g=async()=>{if(c?.id&&d?.id)try{let e=await w(c.id,d.id);if(!e.success)throw Error(e.error);await o()}catch(e){console.error("Error creating default categories:",e)}};return(0,r.useEffect)(()=>{o()},[c?.id,d?.id]),{categories:e,isLoading:a,createCategory:u,updateCategory:m,deleteCategory:h,createDefaultCategories:g,refreshCategories:o}};var C=e.i(498170),T=e.i(692093),_=e.i(974174);function S(e,t){return(0,_.isSameDay)((0,C.constructFrom)(t?.in||e,e),(0,T.constructNow)(t?.in||e))}var D=e.i(296202),E=e.i(939310),I=e.i(45124),M=e.i(91762),B=e.i(443915),P=e.i(690176),F=e.i(130027),A=e.i(897837),R=e.i(348370),L=e.i(229767),O=e.i(792042),H=e.i(353533);let $=({isRecurring:e,recurrenceType:r,recurrenceEndDate:a,dueDate:s,onRecurringChange:n,onRecurrenceTypeChange:l,onRecurrenceEndDateChange:i})=>{let c=(0,h.addMonths)(s,12);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(F.Switch,{id:"recurring",checked:e,onCheckedChange:n}),(0,t.jsx)(M.Label,{htmlFor:"recurring",children:"Make this a recurring task"})]}),e&&(0,t.jsxs)("div",{className:"space-y-4 pl-6 border-l-2 border-gray-100",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(M.Label,{children:"Repeat frequency"}),(0,t.jsxs)(P.Select,{value:r,onValueChange:e=>l(e),children:[(0,t.jsx)(P.SelectTrigger,{children:(0,t.jsx)(P.SelectValue,{placeholder:"Select frequency"})}),(0,t.jsxs)(P.SelectContent,{children:[(0,t.jsx)(P.SelectItem,{value:"daily",children:"Daily"}),(0,t.jsx)(P.SelectItem,{value:"weekly",children:"Weekly"}),(0,t.jsx)(P.SelectItem,{value:"monthly",children:"Monthly"})]})]})]}),r&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(M.Label,{children:"End date (max 12 months)"}),(0,t.jsxs)(R.Popover,{children:[(0,t.jsx)(R.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(E.Button,{variant:"outline",className:(0,H.cn)("w-full justify-start text-left font-normal",!a&&"text-muted-foreground"),children:[(0,t.jsx)(L.CalendarIcon,{className:"mr-2 h-4 w-4"}),a?(0,O.format)(a,"MMM dd, yyyy"):"Select end date"]})}),(0,t.jsx)(R.PopoverContent,{className:"w-auto p-0",children:(0,t.jsx)(A.Calendar,{mode:"single",selected:a||void 0,onSelect:e=>i(e||null),fromDate:s,toDate:c,initialFocus:!0})})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Recurring tasks can repeat for up to 12 months from the due date"})]})]})]})},V=({isOpen:e,onClose:a,onSubmit:s,task:n,initialDate:l})=>{console.log("TaskForm rendering with props:",{isOpen:e,task:n,initialDate:l});let[i,c]=(0,r.useState)({title:"",description:"",priority:"Medium",due_date:(0,O.format)(l||new Date,"yyyy-MM-dd"),category:"",reminder_enabled:!1,reminder_time:"",is_recurring:!1,recurrence_type:void 0,recurrence_end_date:void 0}),[d,o]=(0,r.useState)(!1),[u,m]=(0,r.useState)(l||new Date),[h,g]=(0,r.useState)(null),x=[];try{x=N().categories||[]}catch(e){console.error("Error loading task categories:",e)}(0,r.useEffect)(()=>{console.log("TaskForm useEffect - task changed:",n),n?(c({title:n.title,description:n.description||"",priority:n.priority,due_date:n.due_date,category:n.category||"",reminder_enabled:n.reminder_enabled,reminder_time:n.reminder_time||"",is_recurring:n.is_recurring,recurrence_type:n.recurrence_type||void 0,recurrence_end_date:n.recurrence_end_date||void 0}),m(new Date(n.due_date)),g(n.recurrence_end_date?new Date(n.recurrence_end_date):null)):l&&(c(e=>({...e,due_date:(0,O.format)(l,"yyyy-MM-dd")})),m(l))},[n,l]);let y=async e=>{if(e.preventDefault(),console.log("TaskForm handleSubmit called with data:",i),!i.title.trim())return void console.log("TaskForm - title is empty, not submitting");o(!0);try{let e={...i,category:"no-category"===i.category?"":i.category,recurrence_end_date:h?(0,O.format)(h,"yyyy-MM-dd"):void 0};await s(e),n||(c({title:"",description:"",priority:"Medium",due_date:(0,O.format)(new Date,"yyyy-MM-dd"),category:"",reminder_enabled:!1,reminder_time:"",is_recurring:!1,recurrence_type:void 0,recurrence_end_date:void 0}),m(new Date),g(null)),a()}catch(e){console.error("Error submitting task:",e)}finally{o(!1)}};return console.log("TaskForm about to render dialog, isOpen:",e),(0,t.jsx)(D.Dialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(D.DialogContent,{className:"sm:max-w-md max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)(D.DialogHeader,{children:(0,t.jsx)(D.DialogTitle,{children:n?"Edit Task":"Create New Task"})}),(0,t.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(M.Label,{htmlFor:"title",children:"Task Title *"}),(0,t.jsx)(I.Input,{id:"title",value:i.title,onChange:e=>c(t=>({...t,title:e.target.value})),placeholder:"What needs to be done?",required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(M.Label,{htmlFor:"description",children:"Description"}),(0,t.jsx)(B.Textarea,{id:"description",value:i.description,onChange:e=>c(t=>({...t,description:e.target.value})),placeholder:"Add more details...",rows:3})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(M.Label,{children:"Priority"}),(0,t.jsxs)(P.Select,{value:i.priority,onValueChange:e=>c(t=>({...t,priority:e})),children:[(0,t.jsx)(P.SelectTrigger,{children:(0,t.jsx)(P.SelectValue,{})}),(0,t.jsxs)(P.SelectContent,{children:[(0,t.jsx)(P.SelectItem,{value:"Low",className:"text-green-600",children:"Low Priority"}),(0,t.jsx)(P.SelectItem,{value:"Medium",className:"text-yellow-600",children:"Medium Priority"}),(0,t.jsx)(P.SelectItem,{value:"High",className:"text-red-600",children:"High Priority"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(M.Label,{children:"Due Date"}),(0,t.jsxs)(R.Popover,{children:[(0,t.jsx)(R.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(E.Button,{variant:"outline",className:(0,H.cn)("w-full justify-start text-left font-normal",!u&&"text-muted-foreground"),children:[(0,t.jsx)(L.CalendarIcon,{className:"mr-2 h-4 w-4"}),u?(0,O.format)(u,"MMM dd, yyyy"):"Pick a date"]})}),(0,t.jsx)(R.PopoverContent,{className:"w-auto p-0",children:(0,t.jsx)(A.Calendar,{mode:"single",selected:u,onSelect:e=>{console.log("TaskForm handleDateSelect called with:",e),e&&(m(e),c(t=>({...t,due_date:(0,O.format)(e,"yyyy-MM-dd")})))},initialFocus:!0})})]})]})]}),x.length>0&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(M.Label,{children:"Category"}),(0,t.jsxs)(P.Select,{value:i.category||"no-category",onValueChange:e=>c(t=>({...t,category:"no-category"===e?"":e})),children:[(0,t.jsx)(P.SelectTrigger,{children:(0,t.jsx)(P.SelectValue,{placeholder:"Select a category"})}),(0,t.jsxs)(P.SelectContent,{children:[(0,t.jsx)(P.SelectItem,{value:"no-category",children:"No Category"}),x.map(e=>(0,t.jsx)(P.SelectItem,{value:e.name,children:e.name},e.id))]})]})]}),(0,t.jsx)($,{isRecurring:i.is_recurring||!1,recurrenceType:i.recurrence_type||"",recurrenceEndDate:h,dueDate:u,onRecurringChange:e=>c(t=>({...t,is_recurring:e,recurrence_type:e?t.recurrence_type:void 0})),onRecurrenceTypeChange:e=>c(t=>({...t,recurrence_type:e||void 0})),onRecurrenceEndDateChange:g}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(F.Switch,{id:"reminder",checked:i.reminder_enabled,onCheckedChange:e=>c(t=>({...t,reminder_enabled:e}))}),(0,t.jsx)(M.Label,{htmlFor:"reminder",children:"Enable reminder"})]}),i.reminder_enabled&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(M.Label,{htmlFor:"reminder-time",children:"Reminder Time"}),(0,t.jsx)(I.Input,{id:"reminder-time",type:"time",value:i.reminder_time,onChange:e=>c(t=>({...t,reminder_time:e.target.value}))})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,t.jsx)(E.Button,{type:"button",variant:"outline",onClick:a,children:"Cancel"}),(0,t.jsx)(E.Button,{type:"submit",disabled:d||!i.title.trim(),children:d?"Saving...":n?"Update Task":"Create Task"})]})]})]})})};var W=e.i(972733);let z=({pendingTodayTasksCount:e,totalTasksCount:r,onCreateTask:a,canCreate:s=!0})=>(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Tasks"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:e>0?`You have ${e} task${1===e?"":"s"} due today`:r>0?"All clear for today! ðŸŽ‰":"What's on your mind today?"})]}),s&&(0,t.jsxs)(E.Button,{onClick:a,className:"mt-4 sm:mt-0",children:[(0,t.jsx)(W.Plus,{className:"w-4 h-4 mr-2"}),"Create Task"]})]});var Q=e.i(537068),Y=e.i(151670),U=e.i(72538);let q=({activeTab:e})=>(0,t.jsxs)(a.TabsList,{className:"grid w-full grid-cols-3 lg:w-auto lg:grid-cols-4",children:[(0,t.jsxs)(a.TabsTrigger,{value:"list",className:"flex items-center gap-2",children:[(0,t.jsx)(Q.List,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"List"})]}),(0,t.jsxs)(a.TabsTrigger,{value:"calendar",className:"flex items-center gap-2",children:[(0,t.jsx)(Y.Calendar,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Calendar"})]}),(0,t.jsxs)(a.TabsTrigger,{value:"today",className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-xs text-white font-bold",children:"T"})}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Today"})]}),(0,t.jsxs)(a.TabsTrigger,{value:"stats",className:"flex items-center gap-2",children:[(0,t.jsx)(U.BarChart3,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Stats"})]})]});var X=e.i(533538);let K=({filters:e,onFiltersChange:r,taskCategories:a,selectedTasks:s,onBulkComplete:n,canEdit:l=!0})=>(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border space-y-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(X.Search,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,t.jsx)(I.Input,{placeholder:"Search tasks...",value:e.search,onChange:t=>r({...e,search:t.target.value}),className:"pl-10"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,t.jsxs)(P.Select,{value:e.status,onValueChange:t=>r({...e,status:t}),children:[(0,t.jsx)(P.SelectTrigger,{children:(0,t.jsx)(P.SelectValue,{})}),(0,t.jsxs)(P.SelectContent,{children:[(0,t.jsx)(P.SelectItem,{value:"all",children:"All Tasks"}),(0,t.jsx)(P.SelectItem,{value:"pending",children:"Pending"}),(0,t.jsx)(P.SelectItem,{value:"completed",children:"Completed"})]})]}),(0,t.jsxs)(P.Select,{value:e.priority,onValueChange:t=>r({...e,priority:t}),children:[(0,t.jsx)(P.SelectTrigger,{children:(0,t.jsx)(P.SelectValue,{})}),(0,t.jsxs)(P.SelectContent,{children:[(0,t.jsx)(P.SelectItem,{value:"all",children:"All Priorities"}),(0,t.jsx)(P.SelectItem,{value:"High",children:"High Priority"}),(0,t.jsx)(P.SelectItem,{value:"Medium",children:"Medium Priority"}),(0,t.jsx)(P.SelectItem,{value:"Low",children:"Low Priority"})]})]}),(0,t.jsxs)(P.Select,{value:e.category,onValueChange:t=>r({...e,category:t}),children:[(0,t.jsx)(P.SelectTrigger,{children:(0,t.jsx)(P.SelectValue,{})}),(0,t.jsxs)(P.SelectContent,{children:[(0,t.jsx)(P.SelectItem,{value:"all",children:"All Categories"}),(0,t.jsx)(P.SelectItem,{value:"no-category",children:"No Category"}),a.map(e=>(0,t.jsx)(P.SelectItem,{value:e,children:e},e))]})]})]}),s.length>0&&(0,t.jsxs)("div",{className:"flex items-center justify-between bg-blue-50 p-3 rounded-md",children:[(0,t.jsxs)("span",{className:"text-sm text-blue-700",children:[s.length," task",1===s.length?"":"s"," selected"]}),l&&(0,t.jsx)(E.Button,{onClick:n,size:"sm",children:"Mark as Complete"})]})]});var G=e.i(889461),J=e.i(426119),Z=e.i(262945),ee=e.i(599875),et=e.i(708997),er=e.i(909289),ea=e.i(756043);let es=(0,e.i(369547).default)("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);function en(e,t){return(0,_.isSameDay)(e,(0,u.addDays)((0,T.constructNow)(t?.in||e),1),t)}var el=e.i(635113);function ei(e){return+(0,el.toDate)(e)<Date.now()}var ec=e.i(124323),ed=e.i(782415);function eo(e,t,r){let[a,s]=(0,ec.normalizeDates)(r?.in,e,t),n=eu(a,s),l=Math.abs((0,ed.differenceInCalendarDays)(a,s));a.setDate(a.getDate()-n*l);let i=Number(eu(a,s)===-n),c=n*(l-i);return 0===c?0:c}function eu(e,t){let r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}let em=({task:e,onToggleComplete:a,onEdit:s,onDelete:n,canEdit:l=!0,canDelete:i=!0})=>{let c,[d,o]=(0,r.useState)(!1),u=async()=>{o(!0),await a(e.id),o(!1)};return(0,t.jsx)(J.Card,{className:(0,H.cn)("transition-all duration-200 hover:shadow-md",(t=>{if(e.completed)return"border-gray-200";switch(t){case"High":return"border-red-300 bg-red-50";case"Medium":return"border-yellow-300 bg-yellow-50";case"Low":return"border-green-300 bg-green-50";default:return"border-gray-200"}})(e.priority),e.completed&&"opacity-75"),children:(0,t.jsxs)(J.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)(Z.Checkbox,{checked:e.completed,onCheckedChange:u,disabled:d||!l,className:"mt-1"}),(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("h3",{className:(0,H.cn)("font-medium text-sm",e.completed&&"line-through text-gray-500"),children:e.title}),e.is_recurring&&(0,t.jsx)(es,{className:"w-3 h-3 text-blue-500"})]}),e.description&&(0,t.jsx)("p",{className:(0,H.cn)("text-xs text-gray-600 mt-1",e.completed&&"text-gray-400"),children:e.description}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,t.jsx)(ee.Badge,{variant:"secondary",className:(e=>{switch(e){case"High":return"bg-red-100 text-red-700 hover:bg-red-200";case"Medium":return"bg-yellow-100 text-yellow-700 hover:bg-yellow-200";case"Low":return"bg-green-100 text-green-700 hover:bg-green-200";default:return"bg-gray-100 text-gray-700 hover:bg-gray-200"}})(e.priority),children:e.priority}),e.category&&(0,t.jsx)(ee.Badge,{variant:"outline",className:"text-xs",children:e.category}),e.is_recurring&&(0,t.jsx)(ee.Badge,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700",children:e.is_recurring&&e.recurrence_type?({daily:"Daily",weekly:"Weekly",monthly:"Monthly"})[e.recurrence_type]:null}),(0,t.jsxs)("div",{className:(0,H.cn)("flex items-center text-xs",(c=new Date(e.due_date),e.completed?"text-gray-500":ei(c)&&!S(c)?"text-red-500":S(c)?"text-orange-500":en(c)?"text-yellow-500":"text-gray-600")),children:[(0,t.jsx)(ea.Clock,{className:"w-3 h-3 mr-1"}),(e=>{let t=new Date(e);if(S(t))return"Today";if(en(t))return"Tomorrow";if(ei(t)&&!S(t)){let e=Math.abs(eo(new Date,t));return`${e} day${1===e?"":"s"} ago`}let r=eo(t,new Date);return r<=7?`In ${r} day${1===r?"":"s"}`:(0,O.format)(t,"MMM dd, yyyy")})(e.due_date)]})]}),e.parent_task_id&&(0,t.jsx)("div",{className:"mt-1",children:(0,t.jsxs)(ee.Badge,{variant:"outline",className:"text-xs bg-gray-50",children:["Instance #",e.recurrence_count]})})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1 ml-2",children:[l&&(0,t.jsx)(E.Button,{variant:"ghost",size:"sm",onClick:()=>s(e),className:"h-7 w-7 p-0 hover:bg-gray-100",children:(0,t.jsx)(et.Edit,{className:"h-3 w-3"})}),i&&(0,t.jsx)(E.Button,{variant:"ghost",size:"sm",onClick:()=>n(e.id),className:"h-7 w-7 p-0 hover:bg-red-100 hover:text-red-600",children:(0,t.jsx)(er.Trash2,{className:"h-3 w-3"})})]})]})})]}),e.reminder_enabled&&e.reminder_time&&(0,t.jsxs)("div",{className:"mt-2 flex items-center text-xs text-gray-500",children:[(0,t.jsx)(ea.Clock,{className:"w-3 h-3 mr-1"}),"Reminder at ",e.reminder_time]})]})})},eh=({tasks:e,onToggleComplete:r,onEdit:a,onDelete:s,canEdit:n=!0,canDelete:l=!0})=>{let i=e.filter(e=>!e.completed),c=e.filter(e=>e.completed);return 0===e.length?(0,t.jsx)("div",{className:"text-center py-12",children:(0,t.jsxs)("div",{className:"text-gray-400 mb-4",children:[(0,t.jsx)(G.CheckCircle2,{className:"w-16 h-16 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-lg font-medium text-gray-600",children:"What's on your mind today?"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Add your first task to get started!"})]})}):(0,t.jsxs)("div",{className:"space-y-6",children:[i.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Pending (",i.length,")"]}),(0,t.jsx)("div",{className:"space-y-3",children:i.map(e=>(0,t.jsx)(em,{task:e,onToggleComplete:r,onEdit:a,onDelete:s,canEdit:n,canDelete:l},e.id))})]}),c.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Completed (",c.length,")"]}),(0,t.jsx)("div",{className:"space-y-3",children:c.map(e=>(0,t.jsx)(em,{task:e,onToggleComplete:r,onEdit:a,onDelete:s,canEdit:n,canDelete:l},e.id))})]})]})},eg=({tasks:e,onToggleComplete:a,onEdit:s,onDelete:n,onBulkComplete:l,canEdit:i=!0,canDelete:c=!0})=>{let[d,o]=(0,r.useState)({status:"all",priority:"all",category:"all",search:""}),[u,m]=(0,r.useState)([]),{categories:h}=N(),g=(0,r.useMemo)(()=>e.filter(e=>{if("pending"===d.status&&e.completed||"completed"===d.status&&!e.completed||"all"!==d.priority&&e.priority!==d.priority||"all"!==d.category&&("no-category"===d.category&&e.category||"no-category"!==d.category&&e.category!==d.category))return!1;if(d.search){let t=d.search.toLowerCase();return e.title.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)}return!0}),[e,d]),x=[...new Set(e.map(e=>e.category).filter(Boolean))];return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(K,{filters:d,onFiltersChange:o,taskCategories:x,selectedTasks:u,onBulkComplete:()=>{l&&u.length>0&&(l(u),m([]))},canEdit:i}),(0,t.jsx)(eh,{tasks:g,onToggleComplete:a,onEdit:s,onDelete:n,canEdit:i,canDelete:c}),0===g.length&&e.length>0&&(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-gray-500",children:"No tasks match your current filters."})})]})};var ex=e.i(551836),ey=e.i(721614),ep=e.i(93445);let ej=({tasks:e,onToggleComplete:a,onEdit:s,onDelete:n,canEdit:l=!0,canDelete:i=!0})=>{let[c,d]=(0,r.useState)(new Date),[o,u]=(0,r.useState)(new Date),m=(0,r.useMemo)(()=>{let t={};return e.forEach(e=>{let r=(0,O.format)(new Date(e.due_date),"yyyy-MM-dd");t[r]||(t[r]=[]),t[r].push(e)}),t},[e]),g=(0,r.useMemo)(()=>m[(0,O.format)(c,"yyyy-MM-dd")]||[],[m,c]),x=e=>m[(0,O.format)(e,"yyyy-MM-dd")]||[],y=e=>{e&&d(e)};return(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(J.Card,{className:"lg:col-span-2",children:[(0,t.jsx)(J.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(J.CardTitle,{className:"text-lg font-semibold",children:(0,O.format)(o,"MMMM yyyy")}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(E.Button,{variant:"outline",size:"sm",onClick:()=>{let e=new Date;u(e),d(e)},className:"text-xs",children:"Today"}),(0,t.jsx)(E.Button,{variant:"outline",size:"sm",onClick:()=>{u(e=>(0,ep.subMonths)(e,1))},children:(0,t.jsx)(ex.ChevronLeft,{className:"h-4 w-4"})}),(0,t.jsx)(E.Button,{variant:"outline",size:"sm",onClick:()=>{u(e=>(0,h.addMonths)(e,1))},children:(0,t.jsx)(ey.ChevronRight,{className:"h-4 w-4"})})]})]})}),(0,t.jsxs)(J.CardContent,{children:[(0,t.jsx)(A.Calendar,{mode:"single",selected:c,onSelect:y,month:o,onMonthChange:u,className:"w-full",components:{Day:({date:e,...r})=>{x(e);let a=(0,_.isSameDay)(e,c);return(0,t.jsx)("div",{className:`relative p-2 hover:bg-gray-50 cursor-pointer rounded-md ${a?"bg-blue-100":""}`,onClick:()=>y(e),children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("span",{className:`text-sm ${a?"font-bold":""}`,children:(0,O.format)(e,"d")}),(e=>{let r=x(e);if(0===r.length)return null;let a=r.filter(e=>e.completed).length,s=r.length,n=r.filter(e=>"High"===e.priority&&!e.completed).length;return(0,t.jsxs)("div",{className:"flex items-center justify-center mt-1 space-x-1",children:[n>0&&(0,t.jsx)("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full"}),s-a>0&&(0,t.jsx)("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),a>0&&(0,t.jsx)("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"})]})})(e)]})})}}}),(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-center space-x-4 text-xs text-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),(0,t.jsx)("span",{children:"High Priority"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,t.jsx)("span",{children:"Pending"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,t.jsx)("span",{children:"Completed"})]})]})]})]}),(0,t.jsxs)(J.Card,{children:[(0,t.jsxs)(J.CardHeader,{children:[(0,t.jsx)(J.CardTitle,{className:"text-lg font-semibold",children:(0,O.format)(c,"MMM dd, yyyy")}),g.length>0&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)(ee.Badge,{variant:"secondary",children:[g.filter(e=>!e.completed).length," pending"]}),(0,t.jsxs)(ee.Badge,{variant:"secondary",children:[g.filter(e=>e.completed).length," completed"]})]})]}),(0,t.jsx)(J.CardContent,{children:0===g.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("p",{className:"text-gray-500 text-sm",children:"No tasks for this date."}),(0,t.jsx)("p",{className:"text-gray-400 text-xs mt-1",children:"All clear! Time for a coffee break â˜•"})]}):(0,t.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:g.map(e=>(0,t.jsx)(em,{task:e,onToggleComplete:a,onEdit:s,onDelete:n,canEdit:l,canDelete:i},e.id))})})]})]})};var ef=e.i(366730),ev=e.i(432237),ek=e.i(891680);let eb=({tasks:e})=>{let a=(0,r.useMemo)(()=>{let t=e.length,r=e.filter(e=>e.completed).length,a=e.filter(e=>S(new Date(e.due_date))),s=a.filter(e=>e.completed).length,n=e.filter(e=>ei(new Date(e.due_date))&&!e.completed&&!S(new Date(e.due_date))).length,l=e.filter(e=>"High"===e.priority&&!e.completed).length,i=t>0?Math.round(r/t*100):0,c=a.length>0?Math.round(s/a.length*100):0;return{totalTasks:t,completedTasks:r,pendingTasks:t-r,todayTasks:a.length,todayCompleted:s,overdueTasks:n,highPriorityPending:l,completionRate:i,todayCompletionRate:c}},[e]),s=[{title:"Total Tasks",value:a.totalTasks,icon:ea.Clock,color:"text-blue-600",bgColor:"bg-blue-50"},{title:"Completed",value:a.completedTasks,icon:G.CheckCircle2,color:"text-green-600",bgColor:"bg-green-50"},{title:"Overdue",value:a.overdueTasks,icon:ev.AlertTriangle,color:"text-red-600",bgColor:"bg-red-50"},{title:"High Priority",value:a.highPriorityPending,icon:ek.TrendingUp,color:"text-orange-600",bgColor:"bg-orange-50"}];return 0===a.totalTasks?(0,t.jsx)(J.Card,{children:(0,t.jsx)(J.CardContent,{className:"p-6 text-center",children:(0,t.jsx)("p",{className:"text-gray-500",children:"No tasks yet. Create your first task to see statistics!"})})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:s.map(e=>(0,t.jsx)(J.Card,{children:(0,t.jsx)(J.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:`p-2 rounded-lg ${e.bgColor}`,children:(0,t.jsx)(e.icon,{className:`h-4 w-4 ${e.color}`})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.value}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:e.title})]})]})})},e.title))}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)(J.Card,{children:[(0,t.jsx)(J.CardHeader,{children:(0,t.jsx)(J.CardTitle,{className:"text-base",children:"Overall Progress"})}),(0,t.jsx)(J.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{children:"Completion Rate"}),(0,t.jsxs)("span",{className:"font-semibold",children:[a.completionRate,"%"]})]}),(0,t.jsx)(ef.Progress,{value:a.completionRate,className:"h-2"}),(0,t.jsxs)("p",{className:"text-xs text-gray-600",children:[a.completedTasks," of ",a.totalTasks," tasks completed"]})]})})]}),(0,t.jsxs)(J.Card,{children:[(0,t.jsx)(J.CardHeader,{children:(0,t.jsx)(J.CardTitle,{className:"text-base",children:"Today's Progress"})}),(0,t.jsx)(J.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{children:"Today's Completion"}),(0,t.jsxs)("span",{className:"font-semibold",children:[a.todayCompletionRate,"%"]})]}),(0,t.jsx)(ef.Progress,{value:a.todayCompletionRate,className:"h-2"}),(0,t.jsxs)("p",{className:"text-xs text-gray-600",children:[a.todayCompleted," of ",a.todayTasks," today's tasks completed"]})]})})]})]}),a.completionRate>80&&(0,t.jsx)(J.Card,{className:"bg-green-50 border-green-200",children:(0,t.jsxs)(J.CardContent,{className:"p-4 text-center",children:[(0,t.jsx)("p",{className:"text-green-800 font-medium",children:"ðŸŽ‰ Excellent work!"}),(0,t.jsxs)("p",{className:"text-green-700 text-sm mt-1",children:["You're doing great with a ",a.completionRate,"% completion rate!"]})]})}),a.overdueTasks>0&&(0,t.jsx)(J.Card,{className:"bg-orange-50 border-orange-200",children:(0,t.jsxs)(J.CardContent,{className:"p-4 text-center",children:[(0,t.jsx)("p",{className:"text-orange-800 font-medium",children:"â° Heads up!"}),(0,t.jsxs)("p",{className:"text-orange-700 text-sm mt-1",children:["You have ",a.overdueTasks," overdue task",1===a.overdueTasks?"":"s",". Consider updating your schedule or completing them soon."]})]})})]})},ew=({tasks:e,todayTasks:r,onToggleComplete:s,onEdit:n,onDelete:l,onBulkComplete:i,onCreateTask:c,canCreate:d=!0,canEdit:o=!0,canDelete:u=!0})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.TabsContent,{value:"list",className:"space-y-6",children:(0,t.jsx)(eg,{tasks:e,onToggleComplete:s,onEdit:n,onDelete:l,onBulkComplete:i,canEdit:o,canDelete:u})}),(0,t.jsx)(a.TabsContent,{value:"calendar",className:"space-y-6",children:(0,t.jsx)(ej,{tasks:e,onToggleComplete:s,onEdit:n,onDelete:l,canEdit:o,canDelete:u})}),(0,t.jsx)(a.TabsContent,{value:"today",className:"space-y-6",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg border p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Today's Tasks"}),d&&(0,t.jsxs)(E.Button,{onClick:c,variant:"outline",size:"sm",children:[(0,t.jsx)(W.Plus,{className:"w-4 h-4 mr-2"}),"Add Task"]})]}),0===r.length?(0,t.jsx)("div",{className:"text-center py-12",children:(0,t.jsxs)("div",{className:"text-gray-400 mb-4",children:[(0,t.jsx)(Y.Calendar,{className:"w-16 h-16 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-lg font-medium text-gray-600",children:"No tasks for today"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Time for a coffee break â˜•"})]})}):(0,t.jsx)(eh,{tasks:r,onToggleComplete:s,onEdit:n,onDelete:l,canEdit:o,canDelete:u})]})}),(0,t.jsx)(a.TabsContent,{value:"stats",className:"space-y-6",children:(0,t.jsx)(eb,{tasks:e})})]});var eN=e.i(638822),eC=e.i(626427),eT=e.i(675878),e_=e.i(386408),eS=e.i(365713);e.s(["default",0,()=>{let e,d,{user:o}=(0,s.useAuth)(),{hasPermission:u,isLoading:m}=(0,eN.useProfiles)(),h=(0,eS.useNavigate)(),f=u("tasks","view"),v=u("tasks","create"),k=u("tasks","edit"),b=u("tasks","delete");try{e=(()=>{let[e,t]=(0,r.useState)([]),{user:a}=(0,s.useAuth)(),{currentBusiness:d}=(0,n.useBusiness)(),o=(0,c.useQueryClient)(),u=(0,r.useCallback)(async()=>{if(!a?.id||!d?.id)return[];try{let e=await g(a.id,d.id);if(!e.success||!e.data)throw Error(e.error||"Failed to fetch tasks");return e.data}catch(e){return console.error("Error loading tasks:",e),l.toast.error("Failed to load tasks"),[]}},[a?.id,d?.id]),m=["tasks",a?.id,d?.id],{data:h,isLoading:f,isFetching:v}=(0,i.useQuery)({queryKey:m,queryFn:u,enabled:!!a?.id&&!!d?.id,staleTime:3e5,gcTime:18e5,refetchOnWindowFocus:!1,refetchOnReconnect:!1});(0,r.useEffect)(()=>{h&&t(h)},[h]);let k=f&&!h,b=async e=>{if(!a?.id||!d?.id)return null;try{let r={userId:a.id,locationId:d.id,title:e.title,description:e.description,priority:e.priority,dueDate:new Date(e.due_date),category:e.category,reminderEnabled:e.reminder_enabled,reminderTime:e.reminder_time&&""!==e.reminder_time.trim()?e.reminder_time:null,isRecurring:e.is_recurring,recurrenceType:e.recurrence_type,recurrenceEndDate:e.recurrence_end_date?new Date(e.recurrence_end_date):null},s=await x(r);if(!s.success||!s.data)throw Error(s.error);let n=s.data,i={...n,user_id:n.userId,location_id:n.locationId,due_date:n.dueDate.toISOString().split("T")[0],completed_at:n.completedAt?.toISOString()||null,created_at:n.createdAt.toISOString(),updated_at:n.updatedAt.toISOString(),reminder_enabled:n.reminderEnabled,reminder_time:n.reminderTime,is_recurring:n.isRecurring,recurrence_type:n.recurrenceType,recurrence_end_date:n.recurrenceEndDate?.toISOString().split("T")[0]||null,parent_task_id:n.parentTaskId,recurrence_count:n.recurrenceCount};return t(e=>[i,...e]),o.setQueryData(m,e=>e?[i,...e]:[i]),o.invalidateQueries({queryKey:m}),l.toast.success("Task created successfully"),i}catch(e){return console.error("Error creating task:",e),l.toast.error("Failed to create task"),null}},w=async(e,t)=>{if(!a?.id)return!1;try{let r={...t};t.due_date&&(r.dueDate=new Date(t.due_date)),t.completed_at&&(r.completedAt=new Date(t.completed_at)),t.recurrence_end_date&&(r.recurrenceEndDate=new Date(t.recurrence_end_date)),void 0!==t.is_recurring&&(r.isRecurring=t.is_recurring),t.recurrence_type&&(r.recurrenceType=t.recurrence_type),void 0!==t.reminder_time&&(r.reminderTime=t.reminder_time&&""!==t.reminder_time.trim()?t.reminder_time:null);let s=await y(e,a.id,r);if(!s.success||!s.data)throw Error(s.error);return o.invalidateQueries({queryKey:m}),!0}catch(e){return console.error("Error updating task:",e),l.toast.error("Failed to update task"),!1}},N=async t=>{let r=e.find(e=>e.id===t);if(!r)return!1;let a={completed:!r.completed,completed_at:r.completed?null:new Date().toISOString()},s=await w(t,a);return s&&(r.completed?l.toast.success("Task marked as pending"):l.toast.success("Well done! ðŸŽ‰ Task completed")),s},C=async e=>{if(!a?.id)return!1;try{let t=await p(e,a.id);if(!t.success)throw Error(t.error);return o.invalidateQueries({queryKey:m}),l.toast.success("Task deleted successfully"),!0}catch(e){return console.error("Error deleting task:",e),l.toast.error("Failed to delete task"),!1}},T=async(e,t)=>{if(!a?.id||0===e.length)return!1;try{let r={...t};void 0!==t.completed&&(r.completed=t.completed),void 0!==t.completed_at&&(r.completedAt=t.completed_at?new Date(t.completed_at):null);let s=await j(e,a.id,r);if(!s.success)throw Error(s.error);return o.invalidateQueries({queryKey:m}),l.toast.success(`Updated ${e.length} tasks`),!0}catch(e){return console.error("Error bulk updating tasks:",e),l.toast.error("Failed to update tasks"),!1}};return{tasks:e,isLoading:k,createTask:b,updateTask:w,deleteTask:C,toggleTaskCompletion:N,bulkUpdateTasks:T,refreshTasks:()=>{o.invalidateQueries({queryKey:m})}}})()}catch(t){console.error("Error in useTasks:",t),e={tasks:[],isLoading:!1,createTask:async()=>null,updateTask:async()=>!1,deleteTask:async()=>!1,toggleTaskCompletion:async()=>!1,bulkUpdateTasks:async()=>!1}}try{d=N()}catch(e){console.error("Error in useTaskCategories:",e),d={categories:[],createDefaultCategories:async()=>{}}}let{tasks:w,isLoading:C,createTask:T,updateTask:_,deleteTask:D,toggleTaskCompletion:I,bulkUpdateTasks:M}=e,{categories:B,createDefaultCategories:P}=d,F=(({tasks:e,createTask:t,updateTask:a,deleteTask:s,toggleTaskCompletion:n,bulkUpdateTasks:l})=>{let[i,c]=(0,r.useState)(!1),[d,o]=(0,r.useState)(null),[u,m]=(0,r.useState)(null),[h,g]=(0,r.useState)("list"),x=e.filter(e=>S(new Date(e.due_date))),y=x.filter(e=>!e.completed),p=(0,r.useCallback)(()=>{o(null),m(null),c(!0)},[]),j=(0,r.useCallback)(e=>{o(e),c(!0)},[]),f=(0,r.useCallback)(async e=>!!window.confirm("Are you sure you want to delete this task?")&&await s(e),[s]),v=(0,r.useCallback)(async e=>{try{d?await a(d.id,e):await t(e)}catch(e){console.error("Error in handleFormSubmit:",e)}},[d,a,t]);return{isTaskFormOpen:i,editingTask:d,selectedDate:u,activeTab:h,todayTasks:x,pendingTodayTasks:y,setActiveTab:g,handleCreateTask:p,handleEditTask:j,handleDeleteTask:f,handleFormSubmit:v,handleBulkComplete:(0,r.useCallback)(async e=>await l(e,{completed:!0,completed_at:new Date().toISOString()}),[l]),handleFormClose:(0,r.useCallback)(()=>{c(!1),o(null),m(null)},[]),toggleTaskCompletion:n}})({tasks:w,createTask:T,updateTask:_,deleteTask:D,toggleTaskCompletion:I,bulkUpdateTasks:M});return(r.default.useEffect(()=>{0!==B.length||C||P()},[B.length,C,P]),o)?m||C?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):f?(0,t.jsxs)("div",{className:"max-w-6xl mx-auto p-4 sm:p-6",children:[(0,t.jsx)(z,{pendingTodayTasksCount:F.pendingTodayTasks.length,totalTasksCount:w.length,onCreateTask:F.handleCreateTask,canCreate:v}),(0,t.jsxs)(a.Tabs,{value:F.activeTab,onValueChange:F.setActiveTab,className:"space-y-6",children:[(0,t.jsx)(q,{activeTab:F.activeTab}),(0,t.jsx)(ew,{tasks:w,todayTasks:F.todayTasks,onToggleComplete:F.toggleTaskCompletion,onEdit:F.handleEditTask,onDelete:F.handleDeleteTask,onBulkComplete:F.handleBulkComplete,onCreateTask:F.handleCreateTask,canCreate:v,canEdit:k,canDelete:b})]}),(0,t.jsx)(V,{isOpen:F.isTaskFormOpen,onClose:F.handleFormClose,onSubmit:F.handleFormSubmit,task:F.editingTask,initialDate:F.selectedDate||void 0})]}):(0,t.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,t.jsxs)(eC.Alert,{variant:"destructive",children:[(0,t.jsx)(eT.AlertCircle,{className:"h-4 w-4"}),(0,t.jsx)(eC.AlertTitle,{children:"Access Denied"}),(0,t.jsx)(eC.AlertDescription,{children:"You do not have permission to view the tasks module. Please contact your administrator if you believe this is an error."})]}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsxs)(E.Button,{onClick:()=>h("/"),variant:"outline",className:"gap-2",children:[(0,t.jsx)(e_.ArrowLeft,{className:"h-4 w-4"}),"Back to Dashboard"]})})]}):(0,t.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,t.jsx)("div",{className:"bg-amber-50 border border-amber-200 p-4 rounded-md",children:(0,t.jsx)("p",{className:"text-amber-800",children:"You need to be signed in to manage your tasks. All tasks are saved to your account."})})})}],433069)},869008,(e,t,r)=>{let a="/Tasks";(window.__NEXT_P=window.__NEXT_P||[]).push([a,()=>e.r(433069)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([a])})}]);