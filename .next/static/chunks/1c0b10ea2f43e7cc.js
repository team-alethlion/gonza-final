(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,727612,e=>{"use strict";let t=(0,e.i(475254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>t],727612)},487486,e=>{"use strict";var t=e.i(843476),r=e.i(225913),a=e.i(975157);let i=(0,r.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",warning:"border-transparent bg-amber-500 text-white hover:bg-amber-600",success:"border-transparent bg-green-600 text-white hover:bg-green-700"}},defaultVariants:{variant:"default"}});function s({className:e,variant:r,...s}){return(0,t.jsx)("div",{className:(0,a.cn)(i({variant:r}),e),...s})}e.s(["Badge",()=>s])},688511,e=>{"use strict";let t=(0,e.i(475254).default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>t],688511)},691162,e=>{"use strict";let t;var r=e.i(271645),a=e.i(30030),i=e.i(820783),s=e.i(326999),n=e.i(981140),o=e.i(843476),l=Symbol("radix.slottable"),c="AlertDialog",[d,u]=(0,a.createContextScope)(c,[s.createDialogScope]),h=(0,s.createDialogScope)(),p=e=>{let{__scopeAlertDialog:t,...r}=e,a=h(t);return(0,o.jsx)(s.Root,{...a,...r,modal:!0})};p.displayName=c;var f=r.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,i=h(r);return(0,o.jsx)(s.Trigger,{...i,...a,ref:t})});f.displayName="AlertDialogTrigger";var y=e=>{let{__scopeAlertDialog:t,...r}=e,a=h(t);return(0,o.jsx)(s.Portal,{...a,...r})};y.displayName="AlertDialogPortal";var g=r.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,i=h(r);return(0,o.jsx)(s.Overlay,{...i,...a,ref:t})});g.displayName="AlertDialogOverlay";var m="AlertDialogContent",[x,v]=d(m),b=((t=({children:e})=>(0,o.jsx)(o.Fragment,{children:e})).displayName="AlertDialogContent.Slottable",t.__radixId=l,t),j=r.forwardRef((e,t)=>{let{__scopeAlertDialog:a,children:l,...c}=e,d=h(a),u=r.useRef(null),p=(0,i.useComposedRefs)(t,u),f=r.useRef(null);return(0,o.jsx)(s.WarningProvider,{contentName:m,titleName:S,docsSlug:"alert-dialog",children:(0,o.jsx)(x,{scope:a,cancelRef:f,children:(0,o.jsxs)(s.Content,{role:"alertdialog",...d,...c,ref:p,onOpenAutoFocus:(0,n.composeEventHandlers)(c.onOpenAutoFocus,e=>{e.preventDefault(),f.current?.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,o.jsx)(b,{children:l}),(0,o.jsx)(R,{contentRef:u})]})})})});j.displayName=m;var S="AlertDialogTitle",k=r.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,i=h(r);return(0,o.jsx)(s.Title,{...i,...a,ref:t})});k.displayName=S;var D="AlertDialogDescription",A=r.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,i=h(r);return(0,o.jsx)(s.Description,{...i,...a,ref:t})});A.displayName=D;var w=r.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,i=h(r);return(0,o.jsx)(s.Close,{...i,...a,ref:t})});w.displayName="AlertDialogAction";var N="AlertDialogCancel",C=r.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...a}=e,{cancelRef:n}=v(N,r),l=h(r),c=(0,i.useComposedRefs)(t,n);return(0,o.jsx)(s.Close,{...l,...a,ref:c})});C.displayName=N;var R=({contentRef:e})=>{let t=`\`${m}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${m}\` by passing a \`${D}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${m}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return r.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null};e.s(["Action",()=>w,"AlertDialog",()=>p,"AlertDialogAction",()=>w,"AlertDialogCancel",()=>C,"AlertDialogContent",()=>j,"AlertDialogDescription",()=>A,"AlertDialogOverlay",()=>g,"AlertDialogPortal",()=>y,"AlertDialogTitle",()=>k,"AlertDialogTrigger",()=>f,"Cancel",()=>C,"Content",()=>j,"Description",()=>A,"Overlay",()=>g,"Portal",()=>y,"Root",()=>p,"Title",()=>k,"Trigger",()=>f,"createAlertDialogScope",()=>u],691162)},868499,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(691162),i=e.i(975157),s=e.i(519455);let n=a.Root,o=a.Trigger,l=a.Portal,c=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)(a.Overlay,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r,ref:s}));c.displayName=a.Overlay.displayName;let d=r.forwardRef(({className:e,...r},s)=>(0,t.jsxs)(l,{children:[(0,t.jsx)(c,{}),(0,t.jsx)(a.Content,{ref:s,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r})]}));d.displayName=a.Content.displayName;let u=({className:e,...r})=>(0,t.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...r});u.displayName="AlertDialogHeader";let h=({className:e,...r})=>(0,t.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...r});h.displayName="AlertDialogFooter";let p=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)(a.Title,{ref:s,className:(0,i.cn)("text-lg font-semibold",e),...r}));p.displayName=a.Title.displayName;let f=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)(a.Description,{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",e),...r}));f.displayName=a.Description.displayName;let y=r.forwardRef(({className:e,...r},n)=>(0,t.jsx)(a.Action,{ref:n,className:(0,i.cn)((0,s.buttonVariants)(),e),...r}));y.displayName=a.Action.displayName;let g=r.forwardRef(({className:e,...r},n)=>(0,t.jsx)(a.Cancel,{ref:n,className:(0,i.cn)((0,s.buttonVariants)({variant:"outline"}),"mt-2 sm:mt-0",e),...r}));g.displayName=a.Cancel.displayName,e.s(["AlertDialog",()=>n,"AlertDialogAction",()=>y,"AlertDialogCancel",()=>g,"AlertDialogContent",()=>d,"AlertDialogDescription",()=>f,"AlertDialogFooter",()=>h,"AlertDialogHeader",()=>u,"AlertDialogTitle",()=>p,"AlertDialogTrigger",()=>o])},878894,e=>{"use strict";let t=(0,e.i(475254).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],878894)},871689,e=>{"use strict";let t=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],871689)},57287,e=>{"use strict";var t=e.i(271645),r=e.i(981140),a=e.i(820783),i=e.i(30030),s=e.i(369340),n=e.i(999682),o=e.i(635804),l=e.i(248425),c=e.i(843476),d="Switch",[u,h]=(0,i.createContextScope)(d),[p,f]=u(d),y=t.forwardRef((e,i)=>{let{__scopeSwitch:n,name:o,checked:u,defaultChecked:h,required:f,disabled:y,value:g="on",onCheckedChange:m,form:b,...j}=e,[S,k]=t.useState(null),D=(0,a.useComposedRefs)(i,e=>k(e)),A=t.useRef(!1),w=!S||b||!!S.closest("form"),[N,C]=(0,s.useControllableState)({prop:u,defaultProp:h??!1,onChange:m,caller:d});return(0,c.jsxs)(p,{scope:n,checked:N,disabled:y,children:[(0,c.jsx)(l.Primitive.button,{type:"button",role:"switch","aria-checked":N,"aria-required":f,"data-state":v(N),"data-disabled":y?"":void 0,disabled:y,value:g,...j,ref:D,onClick:(0,r.composeEventHandlers)(e.onClick,e=>{C(e=>!e),w&&(A.current=e.isPropagationStopped(),A.current||e.stopPropagation())})}),w&&(0,c.jsx)(x,{control:S,bubbles:!A.current,name:o,value:g,checked:N,required:f,disabled:y,form:b,style:{transform:"translateX(-100%)"}})]})});y.displayName=d;var g="SwitchThumb",m=t.forwardRef((e,t)=>{let{__scopeSwitch:r,...a}=e,i=f(g,r);return(0,c.jsx)(l.Primitive.span,{"data-state":v(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:t})});m.displayName=g;var x=t.forwardRef(({__scopeSwitch:e,control:r,checked:i,bubbles:s=!0,...l},d)=>{let u=t.useRef(null),h=(0,a.useComposedRefs)(u,d),p=(0,n.usePrevious)(i),f=(0,o.useSize)(r);return t.useEffect(()=>{let e=u.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(p!==i&&t){let r=new Event("click",{bubbles:s});t.call(e,i),e.dispatchEvent(r)}},[p,i,s]),(0,c.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i,...l,tabIndex:-1,ref:h,style:{...l.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function v(e){return e?"checked":"unchecked"}x.displayName="SwitchBubbleInput",e.s(["Root",()=>y,"Switch",()=>y,"SwitchThumb",()=>m,"Thumb",()=>m,"createSwitchScope",()=>h])},699375,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(57287),i=e.i(975157);let s=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)(a.Root,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...r,ref:s,children:(0,t.jsx)(a.Thumb,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));s.displayName=a.Root.displayName,e.s(["Switch",()=>s])},232189,(e,t,r)=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},865156,(e,t,r)=>{"use strict";var a=e.r(232189);function i(){}function s(){}s.resetWarningCache=i,t.exports=function(){function e(e,t,r,i,s,n){if(n!==a){var o=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:i};return r.PropTypes=r,r}},745009,(e,t,r)=>{t.exports=e.r(865156)()},503116,e=>{"use strict";let t=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],503116)},37451,172720,489855,933289,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("6055d418bbb34217108fb09f6c6e07a1977765bffb",t.callServer,void 0,t.findSourceMapURL,"getStockHistoryAction");e.s(["getStockHistoryAction",()=>r],37451);let a=(0,t.createServerReference)("60b4fb287dfbc2b628cca363587f00d76a36f3623b",t.callServer,void 0,t.findSourceMapURL,"recalculateStockChainAction");e.s(["recalculateStockChainAction",()=>a],172720);let i=(0,t.createServerReference)("60428e59105c2448bb202e52e31bf2d4492d8468f7",t.callServer,void 0,t.findSourceMapURL,"deleteStockHistoryEntriesByReferenceAction");e.s(["deleteStockHistoryEntriesByReferenceAction",()=>i],489855);let s=(0,t.createServerReference)("70e0c90d8c965637b3ae61b1f0dd8fc9a41ea083d6",t.callServer,void 0,t.findSourceMapURL,"updateStockHistoryDatesByReferenceAction");e.s(["updateStockHistoryDatesByReferenceAction",()=>s],933289)},960014,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("7022b270c26116cc720c0fe09926fa8749c32b0ea9",t.callServer,void 0,t.findSourceMapURL,"getStockSummaryReportAction");e.s(["getStockSummaryReportAction",()=>r])},654550,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("40193ce83d40b7dbf7c2991866f6d090da71bf2f59",t.callServer,void 0,t.findSourceMapURL,"createStockHistoryAction");e.s(["createStockHistoryAction",()=>r])},752304,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("60a33152b65e6ef5593ff2b5c1d0a77d09216fe7e5",t.callServer,void 0,t.findSourceMapURL,"repairStockChainsAction");e.s(["repairStockChainsAction",()=>r])},634076,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("406e0d925bc965618c40bddb0b2011bea951e9b025",t.callServer,void 0,t.findSourceMapURL,"getStockRepairsPreviewAction");e.s(["getStockRepairsPreviewAction",()=>r])},44686,e=>{"use strict";var t=e.i(271645),r=e.i(422713),a=e.i(37451),i=e.i(654550),s=e.i(172720),n=e.i(489855),o=e.i(933289),l=e.i(752304),c=e.i(634076);e.s(["useStockHistory",0,(e,d)=>{let[u,h]=(0,t.useState)([]),[p,f]=(0,t.useState)(!0),{currentBusiness:y}=(0,r.useBusiness)(),g=(0,t.useCallback)(async()=>{if(!e||!y){h([]),f(!1);return}try{f(!0);let e=await (0,a.getStockHistoryAction)(y.id,d);if(!e.success||!e.data)throw Error(e.error||"Failed to fetch stock history");let t=e.data.map(e=>({id:e.id,productId:e.productId,oldQuantity:e.oldQuantity,newQuantity:e.newQuantity,changeReason:e.changeReason,createdAt:new Date(e.createdAt),referenceId:e.referenceId,receiptNumber:e.receiptNumber,product:e.product}));h(t)}catch(e){console.error("Error loading stock history:",e)}finally{f(!1)}},[e,y?.id,d]);return(0,t.useEffect)(()=>{g()},[g]),{stockHistory:u,isLoading:p,createStockHistoryEntry:async(t,r,a,s,n,o,l,c)=>{try{if(!e||!y)return!1;let d=c?`[${c}] | ${s}`:s,u=await (0,i.createStockHistoryAction)({userId:e,locationId:y.id,productId:t,previousQuantity:r,newQuantity:a,changeReason:d,referenceId:n,receiptNumber:l,createdAt:o?.toISOString()});if(!u.success)return console.error("Error creating stock history entry:",u.error),!1;return await g(),!0}catch(e){return console.error("Error creating stock history:",e),!1}},deleteMultipleStockHistoryEntriesByReference:async e=>{try{if(!y)return!1;let t=await (0,n.deleteStockHistoryEntriesByReferenceAction)(e,y.id);if(!t.success)throw Error(t.error);return await g(),!0}catch(e){return console.error("Error deleting stock history entries:",e),!1}},recalculateStockChain:async e=>{try{if(!y)return!1;let t=await (0,s.recalculateStockChainAction)(e,y.id);if(!t.success)throw Error(t.error);return await g(),!0}catch(e){return console.error("Error recalculating stock chain:",e),!1}},updateStockHistoryDatesBySaleId:async(e,t)=>{try{if(!y)return!1;let r=await (0,o.updateStockHistoryDatesByReferenceAction)(e,y.id,t.toISOString());if(!r.success)throw Error(r.error);return await g(),!0}catch(e){return console.error("Error updating stock history dates:",e),!1}},repairAllStockChains:async e=>{try{if(!y)return{repaired:0,failed:0};let e=await (0,l.repairStockChainsAction)(y.id);if(e.success&&e.data)return e.data;return{repaired:0,failed:0}}catch(e){return console.error("Error repairing all chains:",e),{repaired:0,failed:0}}},previewStockChainRepairs:async e=>{try{if(!y)return[];let e=await (0,c.getStockRepairsPreviewAction)(y.id);if(e.success&&e.data)return e.data;return[]}catch(e){return console.error("Error previewing repairs:",e),[]}},refreshHistory:g}}])},840710,e=>{"use strict";var t=e.i(102594),r=e.i(422713),a=e.i(266027),i=e.i(912598),s=e.i(960014);e.s(["useStockSummaryData",0,e=>{let{user:n}=(0,t.useAuth)(),{currentBusiness:o}=(0,r.useBusiness)(),l=(0,i.useQueryClient)(),c=async()=>{if(!n?.id||!o?.id||!e?.from||!e?.to)return[];try{let t=await (0,s.getStockSummaryReportAction)(o.id,e.from.toISOString(),e.to.toISOString());if(t.success&&t.data)return t.data;throw Error(t.error)}catch(e){throw console.error("[StockSummary] Error fetching report:",e.message),e}},{data:d=[],isLoading:u,refetch:h}=(0,a.useQuery)({queryKey:["stockSummary",o?.id,e.from?.toISOString(),e.to?.toISOString()],queryFn:c,enabled:!!n?.id&&!!o?.id&&!!e?.from&&!!e?.to,staleTime:3e5,gcTime:18e5});return{stockSummaryData:d,isLoading:u,loadStockSummaryData:h,clearCache:()=>{l.invalidateQueries({queryKey:["stockSummary"]})},clearAllLocationCaches:()=>{l.invalidateQueries({queryKey:["stockSummary"]})}}}])},21722,505883,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(776639),i=e.i(519455),s=e.i(793479),n=e.i(110204),o=e.i(401851),l=e.i(908406),c=e.i(777624);e.s(["default",0,({open:e,onOpenChange:d,entry:u,onConfirm:h,isInitialStock:p=!1,stockHistory:f=[],productCreatedAt:y})=>{let[g,m]=(0,r.useState)(0),[x,v]=(0,r.useState)(""),[b,j]=(0,r.useState)(!1),[S,k]=(0,r.useState)(""),{toast:D}=(0,l.useToast)(),{hasPermission:A}=(0,c.useProfiles)();(0,r.useEffect)(()=>{u&&(m(u.newQuantity-u.oldQuantity),v(u.changeReason),k(""))},[u]);let w=(e,t)=>t<0&&e>0?"Cannot change from negative to positive value.":t>0&&e<0?"Cannot change from positive to negative value.":"",N=e=>{if(""===e){m(""),k("");return}let t=parseInt(e)||0,r=w(t,""===g?0:g);r?k(r):(m(t),k(""))},C=async(e=!1)=>{if(!u)return;let t=""===g?0:g,r=w(t,u.newQuantity-u.oldQuantity);if(r)return void D({title:"Invalid quantity change",description:r,variant:"destructive"});let a=u.oldQuantity+t;if(!x.trim())return void D({title:"Invalid reason",description:"Please provide a reason for this stock change",variant:"destructive"});j(!0);try{await h(u.id,a,x.trim())?(D({title:"Stock history updated",description:"The stock history entry has been updated successfully."}),d(!1)):D({title:"Update failed",description:"Failed to update stock history entry. Please try again.",variant:"destructive"})}catch(e){console.error("Error updating stock history:",e),D({title:"Error",description:"An error occurred while updating the stock history.",variant:"destructive"})}finally{j(!1)}},R=()=>{d(!1)};if(!u)return null;if(p)return(0,t.jsx)(a.Dialog,{open:e,onOpenChange:d,children:(0,t.jsxs)(a.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(a.DialogHeader,{children:[(0,t.jsx)(a.DialogTitle,{children:"Edit Initial Stock Entry"}),(0,t.jsx)(a.DialogDescription,{children:"This is the initial stock entry. You can modify quantity, reason, and date, but the date must be earlier than all other stock transactions."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"quantity",children:"Quantity Change"}),(0,t.jsx)(s.Input,{id:"quantity",type:"number",value:g,onChange:e=>N(e.target.value),className:S?"border-destructive border-2 bg-destructive/5 focus:border-destructive focus:ring-destructive":""}),S&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:S})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"reason",children:"Change Reason"}),(0,t.jsx)(s.Input,{id:"reason",value:x,onChange:e=>v(e.target.value),placeholder:"Enter reason for stock change"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,t.jsx)(i.Button,{variant:"outline",onClick:R,disabled:b,children:"Cancel"}),(0,t.jsx)(i.Button,{onClick:()=>C(),disabled:b||!A("inventory","stock_adjustment"),children:b?"Updating...":"Update Entry"})]})]})});if(["Sale","Delete sale","Deleted Sale","Sale qty edit"].some(e=>u.changeReason.toLowerCase().includes(e.toLowerCase())))return(0,t.jsx)(a.Dialog,{open:e,onOpenChange:d,children:(0,t.jsxs)(a.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(a.DialogHeader,{children:[(0,t.jsx)(a.DialogTitle,{children:"Cannot Edit Sale-Related Entry"}),(0,t.jsx)(a.DialogDescription,{children:"This stock history entry was created by a sales operation and can only be modified through the Edit Sale form."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-muted p-3 rounded-lg space-y-2",children:[(0,t.jsx)("div",{className:"font-medium",children:"Entry Details:"}),(0,t.jsxs)("div",{className:"text-sm space-y-1",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Date:"})," ",(0,o.format)(u.createdAt,"PPP p")]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Change:"})," ",u.oldQuantity," → ",u.newQuantity]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Reason:"})," ",u.changeReason.replace("Deleted sale","Deleted Sale")]})]})]}),(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg",children:(0,t.jsxs)("div",{className:"text-blue-800 text-sm",children:[(0,t.jsx)("strong",{children:"Note:"})," To modify this entry, please use the Edit Sale form in the Sales section."]})})]}),(0,t.jsx)("div",{className:"flex justify-end gap-2 mt-6",children:(0,t.jsx)(i.Button,{variant:"outline",onClick:()=>d(!1),children:"Close"})})]})});let E=u.newQuantity-u.oldQuantity,T=""===g?0:g,P=u.oldQuantity+T;return(0,t.jsx)(a.Dialog,{open:e,onOpenChange:d,children:(0,t.jsxs)(a.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(a.DialogHeader,{children:[(0,t.jsx)(a.DialogTitle,{children:"Edit Stock History Entry"}),(0,t.jsx)(a.DialogDescription,{children:"Modify the details of this stock history entry. The product's current stock will be recalculated after saving."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(n.Label,{className:"text-muted-foreground",children:"Original"}),(0,t.jsxs)("div",{className:"font-medium",children:[u.oldQuantity," → ",u.newQuantity]}),(0,t.jsxs)("div",{className:`text-xs ${E>=0?"text-green-600":"text-red-600"}`,children:[E>=0?"+":"",E]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.Label,{className:"text-muted-foreground",children:"New"}),(0,t.jsxs)("div",{className:"font-medium",children:[u.oldQuantity," → ",P]}),(0,t.jsxs)("div",{className:`text-xs ${T>=0?"text-green-600":"text-red-600"}`,children:[T>=0?"+":"",T]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"quantity",children:"Quantity Change"}),(0,t.jsx)(s.Input,{id:"quantity",type:"number",value:g,onChange:e=>N(e.target.value),className:S?"border-destructive border-2 bg-destructive/5 focus:border-destructive focus:ring-destructive":""}),u&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["⚠️ ",(""===g?0:g)<0?"Current change is negative - you cannot change to positive values":"Current change is positive - you cannot change to negative values"]}),S&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:S})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"reason",children:"Change Reason"}),(0,t.jsx)(s.Input,{id:"reason",value:x,onChange:e=>v(e.target.value),placeholder:"Enter reason for stock change"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,t.jsx)(i.Button,{variant:"outline",onClick:R,disabled:b,children:"Cancel"}),(0,t.jsx)(i.Button,{onClick:()=>C(),disabled:b||!A("inventory","stock_adjustment"),children:b?"Updating...":"Update Entry"})]})]})})}],21722);var d=e.i(868499),u=e.i(878894);e.s(["default",0,({open:e,onOpenChange:a,entry:i,onConfirm:s})=>{let[n,c]=(0,r.useState)(!1),{toast:h}=(0,l.useToast)(),p=async()=>{if(i){c(!0);try{await s(i.id)?(h({title:"Stock history deleted",description:"The stock history entry has been deleted and stock recalculated."}),a(!1)):h({title:"Delete failed",description:"Failed to delete stock history entry. Please try again.",variant:"destructive"})}catch(e){console.error("Error deleting stock history:",e),h({title:"Error",description:"An error occurred while deleting the stock history.",variant:"destructive"})}finally{c(!1)}}};if(!i)return null;if(["Sale","Delete sale","Deleted Sale","Sale qty edit"].some(e=>i.changeReason.toLowerCase().includes(e.toLowerCase())))return(0,t.jsx)(d.AlertDialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(d.AlertDialogContent,{children:[(0,t.jsxs)(d.AlertDialogHeader,{children:[(0,t.jsxs)(d.AlertDialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(u.AlertTriangle,{className:"h-5 w-5 text-blue-600"}),"Cannot Delete Sale-Related Entry"]}),(0,t.jsxs)(d.AlertDialogDescription,{className:"space-y-3",children:[(0,t.jsx)("p",{children:"This stock history entry was created by a sales operation and cannot be deleted directly."}),(0,t.jsxs)("div",{className:"bg-muted p-3 rounded-lg space-y-2",children:[(0,t.jsx)("div",{className:"font-medium",children:"Entry Details:"}),(0,t.jsxs)("div",{className:"text-sm space-y-1",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Date:"})," ",(0,o.format)(i.createdAt,"PPP p")]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Change:"})," ",i.oldQuantity," → ",i.newQuantity]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Reason:"})," ",i.changeReason.replace("Deleted sale","Deleted Sale")]})]})]}),(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg",children:(0,t.jsxs)("div",{className:"text-blue-800 text-sm",children:[(0,t.jsx)("strong",{children:"Note:"})," To remove this entry, please edit or delete the corresponding sale in the Sales section."]})})]})]}),(0,t.jsx)(d.AlertDialogFooter,{children:(0,t.jsx)(d.AlertDialogCancel,{children:"Close"})})]})});let f=i.newQuantity-i.oldQuantity;return(0,t.jsx)(d.AlertDialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(d.AlertDialogContent,{children:[(0,t.jsxs)(d.AlertDialogHeader,{children:[(0,t.jsxs)(d.AlertDialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(u.AlertTriangle,{className:"h-5 w-5 text-destructive"}),"Delete Stock History Entry"]}),(0,t.jsxs)(d.AlertDialogDescription,{className:"space-y-3",children:[(0,t.jsx)("p",{children:"Are you sure you want to delete this stock history entry? This action cannot be undone."}),(0,t.jsxs)("div",{className:"bg-muted p-3 rounded-lg space-y-2",children:[(0,t.jsx)("div",{className:"font-medium",children:"Entry Details:"}),(0,t.jsxs)("div",{className:"text-sm space-y-1",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Date:"})," ",(0,o.format)(i.createdAt,"PPP p")]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Change:"})," ",i.oldQuantity," → ",i.newQuantity]}),(0,t.jsxs)("div",{className:`${f>=0?"text-green-600":"text-red-600"}`,children:[(0,t.jsx)("strong",{children:"Impact:"})," ",f>=0?"+":"",f," units"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Reason:"})," ",i.changeReason.replace("Deleted sale","Deleted Sale")]})]})]}),(0,t.jsx)("div",{className:"bg-amber-50 border border-amber-200 p-3 rounded-lg",children:(0,t.jsxs)("div",{className:"text-amber-800 text-sm",children:[(0,t.jsx)("strong",{children:"Warning:"})," After deletion, the product's current stock will be automatically recalculated based on the remaining stock history entries."]})})]})]}),(0,t.jsxs)(d.AlertDialogFooter,{children:[(0,t.jsx)(d.AlertDialogCancel,{disabled:n,children:"Cancel"}),(0,t.jsx)(d.AlertDialogAction,{onClick:p,disabled:n,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:n?"Deleting...":"Delete Entry"})]})]})})}],505883)},48503,e=>{e.v(e=>Promise.resolve().then(()=>e(915833)))},870653,e=>{e.v(t=>Promise.all(["static/chunks/63eee2351f5394d5.js"].map(t=>e.l(t))).then(()=>t(424154)))},195111,e=>{e.v(t=>Promise.all(["static/chunks/f66634c84e3526bd.js"].map(t=>e.l(t))).then(()=>t(38201)))}]);