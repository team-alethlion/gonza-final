(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,755838,(e,t,s)=>{"use strict";var a=e.r(271645),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=a.useState,i=a.useEffect,l=a.useLayoutEffect,o=a.useDebugValue;function d(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!r(e,s)}catch(e){return!0}}var c="u"<typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),a=n({inst:{value:s,getSnapshot:t}}),r=a[0].inst,c=a[1];return l(function(){r.value=s,r.getSnapshot=t,d(r)&&c({inst:r})},[e,s,t]),i(function(){return d(r)&&c({inst:r}),e(function(){d(r)&&c({inst:r})})},[e]),o(s),s};s.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:c},802239,(e,t,s)=>{"use strict";t.exports=e.r(755838)},795052,e=>{"use strict";var t=e.i(843476),s=e.i(317751),a=e.i(912598),r=e.i(679788),n=e.i(904792),i=e.i(102594),l=e.i(422713),o=e.i(777624),d=e.i(271645),c=e.i(414877),u=e.i(991918),m=e.i(225913),x=e.i(475254);let h=(0,x.default)("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);var p=e.i(975157),f=e.i(519455),g=e.i(793479),b=e.i(772436),j=e.i(980376),w=e.i(302747),v=e.i(746798);let y=d.createContext(null);function N(){let e=d.useContext(y);if(!e)throw Error("useSidebar must be used within a SidebarProvider.");return e}let k=d.forwardRef(({defaultOpen:e=!0,open:s,onOpenChange:a,className:r,style:n,children:i,...l},o)=>{let u=(0,c.useIsMobile)(),[m,x]=d.useState(!1),[h,f]=d.useState(e),g=s??h,b=d.useCallback(e=>{let t="function"==typeof e?e(g):e;a?a(t):f(t),document.cookie=`sidebar:state=${t}; path=/; max-age=604800`},[a,g]),j=d.useCallback(()=>u?x(e=>!e):b(e=>!e),[u,b,x]);d.useEffect(()=>{let e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),j())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[j]);let w=g?"expanded":"collapsed",N=d.useMemo(()=>({state:w,open:g,setOpen:b,isMobile:u,openMobile:m,setOpenMobile:x,toggleSidebar:j}),[w,g,b,u,m,x,j]);return(0,t.jsx)(y.Provider,{value:N,children:(0,t.jsx)(v.TooltipProvider,{delayDuration:0,children:(0,t.jsx)("div",{style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...n},className:(0,p.cn)("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:o,...l,children:i})})})});k.displayName="SidebarProvider";let S=d.forwardRef(({side:e="left",variant:s="sidebar",collapsible:a="offcanvas",className:r,children:n,...i},l)=>{let{isMobile:o,state:d,openMobile:c,setOpenMobile:u}=N();return"none"===a?(0,t.jsx)("div",{className:(0,p.cn)("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:l,...i,children:n}):o?(0,t.jsx)(j.Sheet,{open:c,onOpenChange:u,...i,children:(0,t.jsx)(j.SheetContent,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:e,children:(0,t.jsx)("div",{className:"flex h-full w-full flex-col",children:n})})}):(0,t.jsxs)("div",{ref:l,className:"group peer hidden md:block text-sidebar-foreground","data-state":d,"data-collapsible":"collapsed"===d?a:"","data-variant":s,"data-side":e,children:[(0,t.jsx)("div",{className:(0,p.cn)("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===s||"inset"===s?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),(0,t.jsx)("div",{className:(0,p.cn)("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex","left"===e?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===s||"inset"===s?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...i,children:(0,t.jsx)("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:n})})]})});S.displayName="Sidebar";let C=d.forwardRef(({className:e,onClick:s,...a},r)=>{let{toggleSidebar:n}=N();return(0,t.jsxs)(f.Button,{ref:r,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:(0,p.cn)("h-7 w-7",e),onClick:e=>{s?.(e),n()},...a,children:[(0,t.jsx)(h,{}),(0,t.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]})});C.displayName="SidebarTrigger",d.forwardRef(({className:e,...s},a)=>{let{toggleSidebar:r}=N();return(0,t.jsx)("button",{ref:a,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:(0,p.cn)("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...s})}).displayName="SidebarRail",d.forwardRef(({className:e,...s},a)=>(0,t.jsx)("main",{ref:a,className:(0,p.cn)("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...s})).displayName="SidebarInset",d.forwardRef(({className:e,...s},a)=>(0,t.jsx)(g.Input,{ref:a,"data-sidebar":"input",className:(0,p.cn)("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...s})).displayName="SidebarInput",d.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,"data-sidebar":"header",className:(0,p.cn)("flex flex-col gap-2 p-2",e),...s})).displayName="SidebarHeader";let P=d.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,"data-sidebar":"footer",className:(0,p.cn)("flex flex-col gap-2 p-2",e),...s}));P.displayName="SidebarFooter",d.forwardRef(({className:e,...s},a)=>(0,t.jsx)(b.Separator,{ref:a,"data-sidebar":"separator",className:(0,p.cn)("mx-2 w-auto bg-sidebar-border",e),...s})).displayName="SidebarSeparator";let L=d.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,"data-sidebar":"content",className:(0,p.cn)("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...s}));L.displayName="SidebarContent",d.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,"data-sidebar":"group",className:(0,p.cn)("relative flex w-full min-w-0 flex-col p-2",e),...s})).displayName="SidebarGroup",d.forwardRef(({className:e,asChild:s=!1,...a},r)=>{let n=s?u.Slot:"div";return(0,t.jsx)(n,{ref:r,"data-sidebar":"group-label",className:(0,p.cn)("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...a})}).displayName="SidebarGroupLabel",d.forwardRef(({className:e,asChild:s=!1,...a},r)=>{let n=s?u.Slot:"button";return(0,t.jsx)(n,{ref:r,"data-sidebar":"group-action",className:(0,p.cn)("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...a})}).displayName="SidebarGroupAction",d.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,"data-sidebar":"group-content",className:(0,p.cn)("w-full text-sm",e),...s})).displayName="SidebarGroupContent";let z=d.forwardRef(({className:e,...s},a)=>(0,t.jsx)("ul",{ref:a,"data-sidebar":"menu",className:(0,p.cn)("flex w-full min-w-0 flex-col gap-1",e),...s}));z.displayName="SidebarMenu";let R=d.forwardRef(({className:e,...s},a)=>(0,t.jsx)("li",{ref:a,"data-sidebar":"menu-item",className:(0,p.cn)("group/menu-item relative",e),...s}));R.displayName="SidebarMenuItem";let A=(0,m.cva)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),M=d.forwardRef(({asChild:e=!1,isActive:s=!1,variant:a="default",size:r="default",tooltip:n,className:i,...l},o)=>{let d=e?u.Slot:"button",{isMobile:c,state:m}=N(),x=(0,t.jsx)(d,{ref:o,"data-sidebar":"menu-button","data-size":r,"data-active":s,className:(0,p.cn)(A({variant:a,size:r}),i),...l});return n?("string"==typeof n&&(n={children:n}),(0,t.jsxs)(v.Tooltip,{children:[(0,t.jsx)(v.TooltipTrigger,{asChild:!0,children:x}),(0,t.jsx)(v.TooltipContent,{side:"right",align:"center",hidden:"collapsed"!==m||c,...n})]})):x});M.displayName="SidebarMenuButton",d.forwardRef(({className:e,asChild:s=!1,showOnHover:a=!1,...r},n)=>{let i=s?u.Slot:"button";return(0,t.jsx)(i,{ref:n,"data-sidebar":"menu-action",className:(0,p.cn)("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",a&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...r})}).displayName="SidebarMenuAction",d.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,"data-sidebar":"menu-badge",className:(0,p.cn)("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...s})).displayName="SidebarMenuBadge",d.forwardRef(({className:e,showIcon:s=!1,...a},r)=>{let n=d.useMemo(()=>`${Math.floor(40*Math.random())+50}%`,[]);return(0,t.jsxs)("div",{ref:r,"data-sidebar":"menu-skeleton",className:(0,p.cn)("rounded-md h-8 flex gap-2 px-2 items-center",e),...a,children:[s&&(0,t.jsx)(w.Skeleton,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),(0,t.jsx)(w.Skeleton,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":n}})]})}).displayName="SidebarMenuSkeleton";let I=d.forwardRef(({className:e,...s},a)=>(0,t.jsx)("ul",{ref:a,"data-sidebar":"menu-sub",className:(0,p.cn)("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...s}));I.displayName="SidebarMenuSub";let D=d.forwardRef(({...e},s)=>(0,t.jsx)("li",{ref:s,...e}));D.displayName="SidebarMenuSubItem";let E=d.forwardRef(({asChild:e=!1,size:s="md",isActive:a,className:r,...n},i)=>{let l=e?u.Slot:"a";return(0,t.jsx)(l,{ref:i,"data-sidebar":"menu-sub-button","data-size":s,"data-active":a,className:(0,p.cn)("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground","sm"===s&&"text-xs","md"===s&&"text-sm","group-data-[collapsible=icon]:hidden",r),...n})});E.displayName="SidebarMenuSubButton";let B=()=>(0,t.jsx)(r.Link,{to:"/",className:"flex items-center",children:(0,t.jsx)("img",{src:"/lovable-uploads/798d07d7-1db7-498c-92f3-6f6346827d59.png",alt:"Gonzo Systems Logo",className:"h-8 md:h-10"})});var T=e.i(292270),_=e.i(239616),O=e.i(607486),F=e.i(16715),G=e.i(755146),$=e.i(30207),U=e.i(934620);e.i(174080);var W=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let a=(0,u.createSlot)(`Primitive.${s}`),r=d.forwardRef((e,r)=>{let{asChild:n,...i}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(n?a:s,{...i,ref:r})});return r.displayName=`Primitive.${s}`,{...e,[s]:r}},{}),V=e.i(802239);function H(){return()=>{}}var Y="Avatar",[q,K]=function(e,s=[]){let a=[],r=()=>{let t=a.map(e=>d.createContext(e));return function(s){let a=s?.[e]||t;return d.useMemo(()=>({[`__scope${e}`]:{...s,[e]:a}}),[s,a])}};return r.scopeName=e,[function(s,r){let n=d.createContext(r);n.displayName=s+"Context";let i=a.length;a=[...a,r];let l=s=>{let{scope:a,children:r,...l}=s,o=a?.[e]?.[i]||n,c=d.useMemo(()=>l,Object.values(l));return(0,t.jsx)(o.Provider,{value:c,children:r})};return l.displayName=s+"Provider",[l,function(t,a){let l=a?.[e]?.[i]||n,o=d.useContext(l);if(o)return o;if(void 0!==r)return r;throw Error(`\`${t}\` must be used within \`${s}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let s=()=>{let s=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let a=s.reduce((t,{useScope:s,scopeName:a})=>{let r=s(e)[`__scope${a}`];return{...t,...r}},{});return d.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return s.scopeName=t.scopeName,s}(r,...s)]}(Y),[Q,J]=q(Y),X=d.forwardRef((e,s)=>{let{__scopeAvatar:a,...r}=e,[n,i]=d.useState("idle");return(0,t.jsx)(Q,{scope:a,imageLoadingStatus:n,onImageLoadingStatusChange:i,children:(0,t.jsx)(W.span,{...r,ref:s})})});X.displayName=Y;var Z="AvatarImage",ee=d.forwardRef((e,s)=>{let{__scopeAvatar:a,src:r,onLoadingStatusChange:n=()=>{},...i}=e,l=J(Z,a),o=function(e,{referrerPolicy:t,crossOrigin:s}){let a=(0,V.useSyncExternalStore)(H,()=>!0,()=>!1),r=d.useRef(null),n=a?(r.current||(r.current=new window.Image),r.current):null,[i,l]=d.useState(()=>ea(n,e));return(0,U.useLayoutEffect)(()=>{l(ea(n,e))},[n,e]),(0,U.useLayoutEffect)(()=>{let e=e=>()=>{l(e)};if(!n)return;let a=e("loaded"),r=e("error");return n.addEventListener("load",a),n.addEventListener("error",r),t&&(n.referrerPolicy=t),"string"==typeof s&&(n.crossOrigin=s),()=>{n.removeEventListener("load",a),n.removeEventListener("error",r)}},[n,s,t]),i}(r,i),c=(0,$.useCallbackRef)(e=>{n(e),l.onImageLoadingStatusChange(e)});return(0,U.useLayoutEffect)(()=>{"idle"!==o&&c(o)},[o,c]),"loaded"===o?(0,t.jsx)(W.img,{...i,ref:s,src:r}):null});ee.displayName=Z;var et="AvatarFallback",es=d.forwardRef((e,s)=>{let{__scopeAvatar:a,delayMs:r,...n}=e,i=J(et,a),[l,o]=d.useState(void 0===r);return d.useEffect(()=>{if(void 0!==r){let e=window.setTimeout(()=>o(!0),r);return()=>window.clearTimeout(e)}},[r]),l&&"loaded"!==i.imageLoadingStatus?(0,t.jsx)(W.span,{...n,ref:s}):null});function ea(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}es.displayName=et;let er=d.forwardRef(({className:e,...s},a)=>(0,t.jsx)(X,{ref:a,className:(0,p.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...s}));er.displayName=X.displayName,d.forwardRef(({className:e,...s},a)=>(0,t.jsx)(ee,{ref:a,className:(0,p.cn)("aspect-square h-full w-full",e),...s})).displayName=ee.displayName;let en=d.forwardRef(({className:e,...s},a)=>(0,t.jsx)(es,{ref:a,className:(0,p.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...s}));en.displayName=es.displayName;var ei=e.i(643531),el=e.i(664659),eo=e.i(107308),ed=e.i(554527),ec=e.i(838125);let eu=({variant:e="desktop",onItemClick:s})=>{let{currentBusiness:a,businessLocations:r,switchBusiness:n}=(0,l.useBusiness)(),{verifyBusinessPassword:i}=(0,ec.useBusinessPassword)(),[o,c]=(0,d.useState)(!0),[u,m]=(0,d.useState)(!1),[x,h]=(0,d.useState)(null),p=e=>{n(e,(e,t,s)=>{h({businessId:e,businessName:t,onVerified:s}),m(!0)}),x||s?.()},g=()=>{x&&(x.onVerified(),m(!1),h(null),setTimeout(()=>{s?.()},100))},b=async e=>!!x&&await i(x.businessId,e);return"sidebar"===e?r.length<=1?(0,t.jsxs)(M,{className:"w-full text-primary-foreground",disabled:!0,children:[(0,t.jsx)(O.Building2,{className:"size-4"}),(0,t.jsx)("span",{className:"flex-1 text-left truncate group-data-[collapsible=icon]:hidden",children:a?.name||"Business"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(eo.Collapsible,{open:o,onOpenChange:c,children:[(0,t.jsx)(eo.CollapsibleTrigger,{asChild:!0,children:(0,t.jsxs)(M,{className:"w-full text-primary-foreground hover:bg-white/10",children:[(0,t.jsx)(O.Building2,{className:"size-4"}),(0,t.jsx)("span",{className:"flex-1 text-left truncate group-data-[collapsible=icon]:hidden",children:a?.name||"Select Business"}),(0,t.jsx)(el.ChevronDown,{className:"h-4 w-4 transition-transform data-[state=open]:rotate-180 group-data-[collapsible=icon]:hidden"})]})}),(0,t.jsx)(eo.CollapsibleContent,{children:(0,t.jsx)(I,{className:"bg-primary",children:r.map(e=>(0,t.jsx)(D,{children:(0,t.jsxs)(E,{onClick:()=>p(e.id),isActive:a?.id===e.id,className:"w-full justify-between text-primary-foreground/80 hover:bg-white/10 hover:text-primary-foreground data-[active=true]:bg-secondary data-[active=true]:text-secondary-foreground",children:[(0,t.jsx)("span",{className:"truncate",children:e.name}),a?.id===e.id&&(0,t.jsx)(ei.Check,{className:"h-4 w-4"})]})},e.id))})})]}),x&&(0,t.jsx)(ed.BusinessPasswordDialog,{open:u,onOpenChange:m,businessName:x.businessName,onPasswordVerified:g,onVerifyPassword:b})]}):"mobile"===e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b",children:[(0,t.jsx)("div",{className:"text-sm text-gray-500 mb-2",children:"Current Business"}),(0,t.jsx)("div",{className:"font-medium break-words",children:a?.name||"Loading..."}),(0,t.jsx)("div",{className:"mt-3 space-y-1",children:r.map(e=>(0,t.jsxs)("button",{onClick:()=>p(e.id),className:`w-full text-left px-3 py-2 rounded-md text-sm flex items-center justify-between transition-colors touch-manipulation ${a?.id===e.id?"bg-blue-50 text-blue-600":"hover:bg-gray-50 active:bg-gray-100"}`,type:"button",children:[(0,t.jsxs)("span",{className:"flex items-center gap-2 min-w-0 flex-1",children:[(0,t.jsx)(O.Building2,{className:"h-4 w-4 flex-shrink-0"}),(0,t.jsx)("span",{className:"truncate",children:e.name}),e.is_default&&(0,t.jsx)("span",{className:"text-xs bg-gray-100 px-1 rounded flex-shrink-0",children:"Default"})]}),a?.id===e.id&&(0,t.jsx)(ei.Check,{className:"h-4 w-4 flex-shrink-0"})]},e.id))})]}),x&&(0,t.jsx)(ed.BusinessPasswordDialog,{open:u,onOpenChange:e=>{console.log("Mobile dialog open change:",e),m(e)},businessName:x.businessName,onPasswordVerified:g,onVerifyPassword:b})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(G.DropdownMenu,{children:[(0,t.jsx)(G.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(f.Button,{variant:"ghost",className:"justify-start gap-2 h-auto py-2",children:[(0,t.jsx)(O.Building2,{className:"h-4 w-4"}),(0,t.jsxs)("div",{className:"text-left",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Business"}),(0,t.jsx)("div",{className:"text-sm font-medium",children:a?.name||"Loading..."})]})]})}),(0,t.jsx)(G.DropdownMenuContent,{align:"start",className:"w-64",children:r.map(e=>(0,t.jsxs)(G.DropdownMenuItem,{onClick:()=>p(e.id),className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(O.Building2,{className:"h-4 w-4"}),e.name,e.is_default&&(0,t.jsx)("span",{className:"text-xs bg-gray-100 px-1 rounded",children:"Default"})]}),a?.id===e.id&&(0,t.jsx)(ei.Check,{className:"h-4 w-4"})]},e.id))})]}),x&&(0,t.jsx)(ed.BusinessPasswordDialog,{open:u,onOpenChange:m,businessName:x.businessName,onPasswordVerified:g,onVerifyPassword:b})]})};var em=e.i(728469);let ex=()=>{let{user:e,signOut:s}=(0,i.useAuth)(),{currentBusiness:a,businessLocations:n,switchBusiness:o}=(0,l.useBusiness)(),{updateAvailable:d,isUpdating:c,triggerUpdate:u}=(0,em.useAppUpdate)();return(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(G.DropdownMenu,{children:[(0,t.jsx)(G.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(f.Button,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:(0,t.jsx)(er,{className:"h-8 w-8",children:(0,t.jsx)(en,{children:e?.email?e.email.charAt(0).toUpperCase():"U"})})})}),(0,t.jsxs)(G.DropdownMenuContent,{className:"w-80",align:"end",forceMount:!0,children:[(0,t.jsx)("div",{className:"flex items-center justify-start gap-2 p-2",children:(0,t.jsx)("div",{className:"flex flex-col space-y-1 leading-none",children:e?.email&&(0,t.jsx)("p",{className:"font-medium",children:e.email})})}),(0,t.jsx)(G.DropdownMenuSeparator,{}),(0,t.jsx)("div",{className:"p-2",children:(0,t.jsx)(eu,{variant:"desktop"})}),(0,t.jsx)(G.DropdownMenuSeparator,{}),(0,t.jsx)(G.DropdownMenuItem,{asChild:!0,children:(0,t.jsxs)(r.Link,{to:"/business-management",className:"flex items-center bg-blue-50 text-blue-700 font-medium",children:[(0,t.jsx)(O.Building2,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Manage Businesses"})]})}),(0,t.jsx)(G.DropdownMenuSeparator,{}),(0,t.jsxs)(G.DropdownMenuGroup,{children:[(0,t.jsx)(G.DropdownMenuItem,{asChild:!0,children:(0,t.jsxs)(r.Link,{to:"/settings",className:"flex items-center",children:[(0,t.jsx)(_.Settings,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Settings"})]})}),(0,t.jsxs)(G.DropdownMenuItem,{onClick:u,disabled:c,className:"flex items-center bg-orange-50 text-orange-700 font-medium hover:bg-orange-100",children:[(0,t.jsx)(F.RefreshCw,{className:`mr-2 h-4 w-4 ${c?"animate-spin":""}`}),(0,t.jsx)("span",{children:c?"UPDATING...":"UPDATE APP"})]})]}),(0,t.jsx)(G.DropdownMenuSeparator,{}),(0,t.jsxs)(G.DropdownMenuItem,{onClick:s,children:[(0,t.jsx)(T.LogOut,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Log out"})]})]})]})})},eh=(0,x.default)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),ep=(0,x.default)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);var ef=e.i(350627),eg=e.i(488844),eb=e.i(212426),ej=e.i(618348),ew=e.i(686311),ev=e.i(761911),ey=e.i(252754),eN=e.i(656272),ek=e.i(227516);let eS=(0,x.default)("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);var eC=e.i(561659);let eP=({className:e="",onClick:s,isSidebar:a=!1})=>{let i=(0,n.useLocation)(),{hasPermission:l}=(0,o.useProfiles)(),d=[{name:"Dashboard",path:"/",icon:(0,t.jsx)(ep,{className:"w-4 h-4"})},{name:"Sales",path:"/sales",icon:(0,t.jsx)(ef.Receipt,{className:"w-4 h-4"}),module:"sales"},{name:"Inventory",path:"/inventory",icon:(0,t.jsx)(eg.Package,{className:"w-4 h-4"}),module:"inventory"},{name:"Finance",path:"/cash",icon:(0,t.jsx)(ey.Wallet,{className:"w-4 h-4"}),module:"finance"},{name:"Expenses",path:"/expenses",icon:(0,t.jsx)(eb.DollarSign,{className:"w-4 h-4"}),module:"expenses"},{name:"Customers",path:"/customers",icon:(0,t.jsx)(ev.Users,{className:"w-4 h-4"}),module:"customers"},{name:"Messages",path:"/messages",icon:(0,t.jsx)(ew.MessageSquare,{className:"w-4 h-4"}),module:"messages"},{name:"Profiles",path:"/profiles",icon:(0,t.jsx)(eS,{className:"w-4 h-4"}),module:"profiles"},{name:"Tasks",path:"/tasks",icon:(0,t.jsx)(eN.CheckSquare,{className:"w-4 h-4"}),module:"tasks"},{name:"History",path:"/history",icon:(0,t.jsx)(ek.History,{className:"w-4 h-4"})}].filter(e=>!e.module||l(e.module,"view")),c=[{name:"Billing History",path:"/billing",icon:(0,t.jsx)(eC.CreditCard,{className:"w-4 h-4"})},{name:"Settings",path:"/settings",icon:(0,t.jsx)(_.Settings,{className:"w-4 h-4"}),module:"settings"},{name:"Help",path:"/help",icon:(0,t.jsx)(ej.HelpCircle,{className:"w-4 h-4"})},{name:"Privacy Policy",path:"/privacy-policy",icon:(0,t.jsx)(ej.HelpCircle,{className:"w-4 h-4"})}].filter(e=>!e.module||l(e.module,"view")),u=e=>!!("/"===e&&"/"===i.pathname||"/"!==e&&i.pathname.startsWith(e));if(a)return(0,t.jsxs)("div",{className:"flex flex-col justify-between h-full",children:[(0,t.jsx)(z,{className:"w-full",children:d.map(e=>(0,t.jsx)(R,{children:(0,t.jsx)(M,{asChild:!0,isActive:u(e.path),tooltip:e.name,className:"text-primary-foreground/80 hover:bg-white/10 hover:text-primary-foreground data-[active=true]:bg-secondary data-[active=true]:text-secondary-foreground",children:(0,t.jsxs)(r.Link,{to:e.path,onClick:s,children:[e.icon,(0,t.jsx)("span",{className:"group-data-[collapsible=icon]:hidden",children:e.name})]})})},e.name))}),(0,t.jsx)(z,{className:"w-full",children:c.map(e=>(0,t.jsx)(R,{children:(0,t.jsx)(M,{asChild:!0,isActive:u(e.path),tooltip:e.name,className:"text-primary-foreground/80 hover:bg-white/10 hover:text-primary-foreground data-[active=true]:bg-secondary data-[active=true]:text-secondary-foreground",children:(0,t.jsxs)(r.Link,{to:e.path,onClick:s,children:[e.icon,(0,t.jsx)("span",{className:"group-data-[collapsible=icon]:hidden",children:e.name})]})})},e.name))})]});let m=[...d,...c];return(0,t.jsx)("nav",{className:(0,p.cn)("flex flex-col space-y-1",e),children:m.map(e=>(0,t.jsxs)(r.Link,{to:e.path,className:`px-3 py-2 rounded-md text-sm font-medium flex items-center gap-2 ${u(e.path)?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,onClick:s,children:[e.icon,(0,t.jsx)("span",{children:e.name})]},e.name))})},eL=()=>{let{signOut:s}=(0,i.useAuth)(),[a,r]=(0,d.useState)(!1),n=async()=>{try{r(!0),await s()}catch(s){console.error("Error during logout:",s);let{toast:t}=await e.A(357706);t.error("Failed to logout. Please try again.")}finally{r(!1)}};return(0,t.jsx)("div",{className:"absolute bottom-4 left-4 right-4 bg-white",children:(0,t.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:n,disabled:a,className:"w-full justify-start px-4 py-3 text-sm font-medium text-gray-600 hover:text-red-600 flex items-center gap-2 bg-white hover:bg-gray-50",children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"animate-spin mr-1",children:(0,t.jsxs)("svg",{className:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),"Logging out..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.LogOut,{className:"w-4 h-4"}),"Logout"]})})})};var ez=e.i(967489),eR=e.i(284614);let eA=()=>{let{profiles:e,currentProfile:s,setCurrentProfile:a}=(0,o.useProfiles)();return 0===e.length?null:(0,t.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,t.jsx)(eR.User,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,t.jsxs)(ez.Select,{value:s?.id||"",onValueChange:t=>{a(e.find(e=>e.id===t)||null)},children:[(0,t.jsx)(ez.SelectTrigger,{className:"h-8 min-w-[120px] max-w-[200px]",children:(0,t.jsx)(ez.SelectValue,{placeholder:"Select profile"})}),(0,t.jsx)(ez.SelectContent,{children:e.map(e=>(0,t.jsx)(ez.SelectItem,{value:e.id,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium",children:e.profile_name}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.role,")"]})]})},e.id))})]})]})};var eM=e.i(759684);let eI=()=>{let[e,s]=(0,d.useState)(!1),{updateAvailable:a,isUpdating:n,triggerUpdate:i}=(0,em.useAppUpdate)();return(0,t.jsxs)(j.Sheet,{open:e,onOpenChange:s,modal:!0,children:[(0,t.jsx)(j.SheetTrigger,{asChild:!0,children:(0,t.jsxs)(f.Button,{variant:"ghost",size:"icon",className:"md:hidden",children:[(0,t.jsx)(eh,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"sr-only",children:"Open menu"})]})}),(0,t.jsxs)(j.SheetContent,{side:"left",className:"w-full sm:w-72 pt-10 flex flex-col z-[60]",children:[(0,t.jsx)(j.SheetHeader,{className:"mb-4",children:(0,t.jsx)(j.SheetTitle,{className:"text-left",children:"Menu"})}),(0,t.jsx)(eM.ScrollArea,{className:"flex-1",children:(0,t.jsxs)("div",{className:"pb-16",children:[(0,t.jsx)("div",{className:"px-6 pb-4 border-b",children:(0,t.jsxs)(f.Button,{onClick:i,disabled:n,className:"w-full flex items-center gap-2 px-3 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-md text-sm font-medium transition-colors",children:[(0,t.jsx)(F.RefreshCw,{className:`h-4 w-4 ${n?"animate-spin":""}`}),n?"UPDATING...":"UPDATE APP"]})}),(0,t.jsx)(eu,{variant:"mobile",onItemClick:()=>{console.log("Business selector item clicked")}}),(0,t.jsx)("div",{className:"px-6 pb-4",children:(0,t.jsx)(eA,{})}),(0,t.jsx)("div",{className:"px-6 pb-4 border-b",children:(0,t.jsxs)(r.Link,{to:"/business-management",onClick:()=>s(!1),className:"w-full flex items-center gap-2 px-3 py-2 bg-blue-50 text-blue-700 rounded-md text-sm font-medium hover:bg-blue-100 transition-colors",children:[(0,t.jsx)(O.Building2,{className:"h-4 w-4"}),"Manage Businesses"]})}),(0,t.jsx)(eP,{className:"p-4",onClick:()=>s(!1)})]})}),(0,t.jsx)(eL,{})]})]})};var eD=e.i(440160);let eE=()=>{let{isInstallable:e,isInstalled:s,promptToInstall:a}=function(){let[e,t]=(0,d.useState)(null),[s,a]=(0,d.useState)(!1),[r,n]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{window.matchMedia("(display-mode: standalone)").matches&&n(!0);let e=e=>{e.preventDefault(),t(e),a(!0)},s=()=>{n(!0),a(!1),t(null),console.log("App was installed")};return window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",s),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",s)}},[]),{isInstallable:s,isInstalled:r,promptToInstall:async()=>{if(!e)return void console.log("Cannot install: No install prompt available");e.prompt();let s=await e.userChoice;t(null),"accepted"===s.outcome?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt")}}}();return s||!e?null:(0,t.jsxs)(v.Tooltip,{children:[(0,t.jsx)(v.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(f.Button,{variant:"outline",size:"icon",onClick:a,className:"text-gray-600 hover:text-gray-900",children:[(0,t.jsx)(eD.Download,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Install app"})]})}),(0,t.jsx)(v.TooltipContent,{children:(0,t.jsx)("p",{children:"Install this app on your computer"})})]})},eB=()=>(0,c.useIsMobile)()?(0,t.jsx)("header",{className:"bg-white/80 backdrop-blur-md border-b border-border/50 shadow-sm py-4 fixed top-0 left-0 right-0 z-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 flex justify-between items-center",children:[(0,t.jsx)("div",{className:"flex items-center gap-6",children:(0,t.jsx)(B,{})}),(0,t.jsx)(eI,{})]})}):(0,t.jsxs)("header",{className:"flex h-14 shrink-0 items-center justify-between border-b border-border/50 bg-white/80 backdrop-blur-md px-6 sticky top-0 z-50",children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)(C,{})}),(0,t.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2",children:(0,t.jsx)(B,{})}),(0,t.jsxs)("nav",{className:"flex items-center gap-2",children:[(0,t.jsx)(eE,{}),(0,t.jsx)(ex,{})]})]}),eT=()=>{let e=(0,n.useLocation)(),s=t=>!!("/"===t&&"/"===e.pathname||"/"!==t&&e.pathname.startsWith(t));return(0,t.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg z-50 md:hidden safe-area-inset-bottom",children:(0,t.jsxs)("div",{className:"flex justify-between items-center px-1 py-2 min-h-[60px]",children:[(0,t.jsxs)(r.Link,{to:"/",className:`flex flex-1 flex-col items-center py-2 px-1 rounded-md transition-colors min-h-[48px] ${s("/")?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[(0,t.jsx)(ep,{className:"h-5 w-5 mb-1"}),(0,t.jsx)("span",{className:"text-xs font-medium text-center",children:"Dashboard"})]}),(0,t.jsxs)(r.Link,{to:"/sales",className:`flex flex-1 flex-col items-center py-2 px-1 rounded-md transition-colors min-h-[48px] ${s("/sales")?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[(0,t.jsx)(ef.Receipt,{className:"h-5 w-5 mb-1"}),(0,t.jsx)("span",{className:"text-xs font-medium text-center",children:"Sales"})]}),(0,t.jsxs)(r.Link,{to:"/inventory",className:`flex flex-1 flex-col items-center py-2 px-1 rounded-md transition-colors min-h-[48px] ${s("/inventory")?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[(0,t.jsx)(eg.Package,{className:"h-5 w-5 mb-1"}),(0,t.jsx)("span",{className:"text-xs font-medium text-center",children:"Inventory"})]}),(0,t.jsxs)(r.Link,{to:"/cash",className:`flex flex-1 flex-col items-center py-2 px-1 rounded-md transition-colors min-h-[48px] ${s("/cash")?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[(0,t.jsx)(ey.Wallet,{className:"h-5 w-5 mb-1"}),(0,t.jsx)("span",{className:"text-xs font-medium text-center",children:"Finance"})]}),(0,t.jsxs)(r.Link,{to:"/expenses",className:`flex flex-1 flex-col items-center py-2 px-1 rounded-md transition-colors min-h-[48px] ${s("/expenses")?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[(0,t.jsx)(eb.DollarSign,{className:"h-5 w-5 mb-1"}),(0,t.jsx)("span",{className:"text-xs font-medium text-center",children:"Expenses"})]}),(0,t.jsxs)(r.Link,{to:"/customers",className:`flex flex-1 flex-col items-center py-2 px-1 rounded-md transition-colors min-h-[48px] ${s("/customers")?"text-blue-600 bg-blue-50":"text-gray-600"}`,children:[(0,t.jsx)(ev.Users,{className:"h-5 w-5 mb-1"}),(0,t.jsx)("span",{className:"text-xs font-medium text-center",children:"Customers"})]})]})})};var e_=e.i(107233),eO=e.i(201928);let eF=()=>{let[e,s]=(0,d.useState)(!1),a=(0,n.useNavigate)(),r=(0,c.useIsMobile)(),i=(e,t)=>{a(e,{state:t}),s(!1)};return(0,t.jsx)("div",{className:`fixed ${r?"bottom-28":"bottom-6"} right-6 z-50`,children:(0,t.jsxs)(G.DropdownMenu,{open:e,onOpenChange:s,children:[(0,t.jsx)(G.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(f.Button,{size:"lg",className:"h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-shadow",children:(0,t.jsx)(e_.Plus,{className:"h-6 w-6"})})}),(0,t.jsxs)(G.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,t.jsxs)(G.DropdownMenuItem,{onClick:()=>i("/new-sale"),children:[(0,t.jsx)(eO.ShoppingCart,{className:"mr-2 h-4 w-4"}),"Create Sale"]}),(0,t.jsxs)(G.DropdownMenuItem,{onClick:()=>i("/new-sale",{defaultPaymentStatus:"Installment Sale"}),children:[(0,t.jsx)(eC.CreditCard,{className:"mr-2 h-4 w-4"}),"Create Installment Sale"]}),(0,t.jsxs)(G.DropdownMenuItem,{onClick:()=>i("/inventory/new"),children:[(0,t.jsx)(eg.Package,{className:"mr-2 h-4 w-4"}),"Add Product"]}),(0,t.jsxs)(G.DropdownMenuItem,{onClick:()=>i("/customers"),children:[(0,t.jsx)(ev.Users,{className:"mr-2 h-4 w-4"}),"Add Customer"]}),(0,t.jsxs)(G.DropdownMenuItem,{onClick:()=>i("/expenses"),children:[(0,t.jsx)(eb.DollarSign,{className:"mr-2 h-4 w-4"}),"Add Expense"]})]})]})})};var eG=e.i(846696);let e$=()=>{let{businessLocations:e}=(0,l.useBusiness)(),{signOut:s}=(0,i.useAuth)(),{hasPermission:a}=(0,o.useProfiles)(),[n,c]=(0,d.useState)(!1),u=a("settings","manage"),m=async()=>{c(!0);try{await s(),eG.toast.success("Logged out successfully")}catch(e){console.error("Error during logout:",e),eG.toast.error("Failed to logout. Please try again.")}finally{c(!1)}};return(0,t.jsxs)(S,{collapsible:"icon",className:"hidden border-r border-primary-foreground/20 bg-primary text-primary-foreground md:flex",children:[(0,t.jsxs)(L,{className:"p-2 pt-6 flex flex-col",children:[e.length>0&&(0,t.jsxs)("div",{className:"p-2 space-y-2",children:[(0,t.jsx)(eu,{variant:"sidebar"}),(0,t.jsx)(eA,{})]}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(eP,{isSidebar:!0})})]}),(0,t.jsx)(P,{className:"p-2 border-t border-primary-foreground/20",children:(0,t.jsxs)(z,{children:[(0,t.jsx)(R,{children:(0,t.jsxs)(M,{onClick:m,disabled:n,className:"w-full justify-start hover:bg-white/10 text-primary-foreground",tooltip:n?"Logging out...":"Logout",children:[(0,t.jsx)(T.LogOut,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{className:"group-data-[collapsible=icon]:hidden truncate",children:n?"Logging out...":"Logout"})]})}),u&&(0,t.jsx)(R,{children:(0,t.jsx)(M,{className:"w-full justify-start hover:bg-white/10 text-primary-foreground",asChild:!0,tooltip:"Manage Businesses",children:(0,t.jsxs)(r.Link,{to:"/business-management",children:[(0,t.jsx)(O.Building2,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{className:"group-data-[collapsible=icon]:hidden truncate",children:"Manage Businesses"})]})})})]})})]})};var eU=e.i(261246),eW=e.i(929592);let eV=(0,x.default)("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),eH=()=>{let{isOnline:e}=(()=>{let[e,t]=(0,d.useState)("u"<typeof navigator||navigator.onLine);return(0,d.useEffect)(()=>{let e=()=>t(navigator.onLine);return window.addEventListener("online",e),window.addEventListener("offline",e),e(),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",e)}},[]),{isOnline:e,isSlowConnection:!1}})();return e?null:(0,t.jsx)("div",{className:"fixed top-16 left-1/2 transform -translate-x-1/2 z-50 w-full max-w-md px-4",children:(0,t.jsxs)(eW.Alert,{className:"bg-red-50 border-red-200 animate-fade-in",children:[(0,t.jsx)(eV,{className:"h-4 w-4 text-red-600"}),(0,t.jsx)(eW.AlertDescription,{className:"text-red-800 font-medium",children:"No internet connection. Please check your network."})]})})};var eY=e.i(515288);let eq=()=>{let{profiles:e,currentProfile:s,setCurrentProfile:a,logoutProfile:r,isLoading:n}=(0,o.useProfiles)();return s||n||0===e.length?null:(0,t.jsx)("div",{className:"fixed inset-0 z-[100] bg-background/95 backdrop-blur-md flex flex-col items-center justify-center overflow-y-auto p-4 sm:p-8",children:(0,t.jsxs)("div",{className:"w-full max-w-2xl space-y-12 animate-in fade-in zoom-in duration-500 py-12",children:[(0,t.jsxs)("div",{className:"text-center space-y-8",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)("img",{src:"/lovable-uploads/798d07d7-1db7-498c-92f3-6f6346827d59.png",alt:"Gonza Logo",className:"h-24 md:h-32 animate-in fade-in slide-in-from-bottom-8 duration-1000"})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h1",{className:"text-4xl font-extrabold tracking-tight text-primary",children:"Welcome Back"}),(0,t.jsx)("p",{className:"text-muted-foreground text-xl",children:"Please select your profile to continue"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,t.jsx)(eY.Card,{className:"cursor-pointer hover:border-primary hover:shadow-lg transition-all transform hover:-translate-y-1 group",onClick:()=>a(e),children:(0,t.jsxs)(eY.CardHeader,{className:"flex flex-row items-center gap-4 pb-2",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center group-hover:bg-primary/20 transition-colors",children:(0,t.jsx)(eR.User,{className:"h-6 w-6 text-primary"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)(eY.CardTitle,{className:"text-lg truncate",children:e.profile_name}),(0,t.jsx)(eY.CardDescription,{className:"capitalize",children:e.role})]})]})},e.id))}),(0,t.jsx)("div",{className:"flex justify-center pt-8",children:(0,t.jsxs)(f.Button,{variant:"ghost",className:"text-muted-foreground hover:text-primary gap-2",onClick:r,children:[(0,t.jsx)(T.LogOut,{className:"h-4 w-4"}),"Sign out of business"]})})]})})};var eK=e.i(270756);let eQ=()=>{let{currentProfile:e,isProfileVerified:s,verifyPin:a,setCurrentProfile:r,logoutProfile:n}=(0,o.useProfiles)(),[i,l]=(0,d.useState)(""),[c,u]=(0,d.useState)(!1),[m,x]=(0,d.useState)(!1),h=(0,d.useRef)(null);if((0,d.useEffect)(()=>{l(""),x(!1)},[e?.id]),(0,d.useEffect)(()=>{e&&!s&&h.current&&h.current.focus()},[e,s]),!e||s)return null;let b=async e=>{let t=e||i;if(4===t.length){u(!0),x(!1);try{await a(t)||(l(""),x(!0),setTimeout(()=>{x(!1),h.current?.focus()},500))}finally{u(!1)}}};return(0,t.jsx)("div",{className:"fixed inset-0 z-[100] bg-background/95 backdrop-blur-sm flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:(0,p.cn)("w-full max-w-sm flex flex-col items-center justify-center space-y-6 text-center",m?"animate-shake":""),children:[(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)("img",{src:"/lovable-uploads/798d07d7-1db7-498c-92f3-6f6346827d59.png",alt:"Gonza Logo",className:"h-12 animate-in fade-in slide-in-from-bottom-4 duration-700"})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:(0,t.jsx)(eK.Lock,{className:"h-6 w-6 text-primary"})}),(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"Enter PIN"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.profile_name})]}),(0,t.jsxs)("div",{className:"w-full space-y-4",children:[(0,t.jsx)(g.Input,{ref:h,id:"security-pin-code",name:"security-pin-code",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:i,onChange:e=>{let t=e.target.value.replace(/\D/g,"").slice(0,4);l(t),4===t.length&&b(t)},onKeyDown:e=>{"Enter"===e.key&&4===i.length&&b()},disabled:c,placeholder:"Enter 4-digit PIN",autoComplete:"one-time-code",style:{WebkitTextSecurity:"disc"},className:(0,p.cn)("text-center text-2xl font-bold tracking-widest h-14",m&&"border-destructive")}),m&&(0,t.jsx)("p",{className:"text-sm text-destructive animate-in fade-in",children:"Incorrect PIN. Please try again."}),(0,t.jsx)(f.Button,{variant:"outline",size:"lg",onClick:()=>r(null),disabled:c,className:"w-full",children:"Switch Profile"})]}),(0,t.jsxs)("div",{className:"pt-2 space-y-2 w-full",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,t.jsx)(f.Button,{variant:"link",size:"sm",onClick:()=>r(null),disabled:c,className:"h-auto p-0 text-sm",children:"Back to Profiles"}),(0,t.jsx)(f.Button,{variant:"link",size:"sm",className:"text-destructive h-auto p-0 text-xs font-normal hover:no-underline",onClick:n,disabled:c,children:"Logout of System"})]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["First time? Default PIN is ",(0,t.jsx)("span",{className:"font-mono font-semibold",children:"0000"})]})]})]})})};var eJ=e.i(776639),eX=e.i(110204),eZ=e.i(581418);let e0=()=>{let{currentProfile:e,changePin:s,isFirstTimeSetupNeeded:a,dismissFirstTimeSetup:r}=(0,o.useProfiles)(),[n,i]=(0,d.useState)(""),[l,c]=(0,d.useState)(""),[u,m]=(0,d.useState)(!1),x=(0,d.useRef)(null),h=(0,d.useRef)(null);if(!a||!e)return null;let p=async()=>{if(n!==l)return void eG.toast.error("PINs do not match");if(4!==n.length||!/^\d+$/.test(n))return void eG.toast.error("PIN must be exactly 4 digits");if("0000"===n)return void eG.toast.error("Please choose a PIN other than the default 0000");m(!0);try{await s("0000",n)&&r()}finally{m(!1)}};return(0,t.jsx)(eJ.Dialog,{open:!0,onOpenChange:()=>{},children:(0,t.jsxs)(eJ.DialogContent,{className:"sm:max-w-md",onInteractOutside:e=>e.preventDefault(),children:[(0,t.jsxs)(eJ.DialogHeader,{children:[(0,t.jsx)("div",{className:"flex justify-center mb-6",children:(0,t.jsx)("img",{src:"/lovable-uploads/798d07d7-1db7-498c-92f3-6f6346827d59.png",alt:"Gonza Logo",className:"h-12 animate-in fade-in slide-in-from-bottom-2 duration-700"})}),(0,t.jsx)("div",{className:"mx-auto w-12 h-12 bg-amber-50 rounded-2xl flex items-center justify-center mb-4 border border-amber-100",children:(0,t.jsx)(eK.Lock,{className:"h-6 w-6 text-amber-600"})}),(0,t.jsx)(eJ.DialogTitle,{className:"text-center text-2xl",children:"Secure Your Account"}),(0,t.jsxs)(eJ.DialogDescription,{className:"text-center",children:["You're currently using the default PIN ",(0,t.jsx)("span",{className:"font-mono font-bold",children:"0000"}),". For security, we recommend setting a custom PIN now."]})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(eX.Label,{htmlFor:"new_pin_setup",children:"New 4-Digit PIN"}),(0,t.jsx)(g.Input,{ref:x,id:"new_pin_setup",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:n,onChange:e=>{let t=e.target.value.replace(/\D/g,"").slice(0,4);i(t),4===t.length&&setTimeout(()=>h.current?.focus(),100)},placeholder:"Enter new PIN",autoComplete:"one-time-code",style:{WebkitTextSecurity:"disc"}})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(eX.Label,{htmlFor:"confirm_pin_setup",children:"Confirm PIN"}),(0,t.jsx)(g.Input,{ref:h,id:"confirm_pin_setup",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:4,value:l,onChange:e=>{let t=e.target.value.replace(/\D/g,"").slice(0,4);c(t),4===t.length&&4===n.length&&setTimeout(()=>p(),100)},placeholder:"Confirm new PIN",autoComplete:"one-time-code",style:{WebkitTextSecurity:"disc"}})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)(f.Button,{className:"w-full gap-2 bg-primary hover:bg-primary/90",onClick:p,disabled:u||4!==n.length||4!==l.length,children:[(0,t.jsx)(eZ.ShieldCheck,{className:"h-4 w-4"}),u?"Setting PIN...":"Set Custom PIN"]}),(0,t.jsx)(f.Button,{variant:"ghost",className:"w-full text-muted-foreground",onClick:()=>{r(),eG.toast.warning("Remember to change your PIN from Settings → Profiles → Security")},disabled:u,children:"Skip for now"})]}),(0,t.jsx)("p",{className:"text-[10px] text-muted-foreground/60 text-center",children:"You can change your PIN anytime from Settings → Profiles → Security"})]})})},e1=()=>{try{let e=(0,c.useIsMobile)();return(0,t.jsx)(k,{children:(0,t.jsxs)(v.TooltipProvider,{children:[e?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 w-full",children:[(0,t.jsx)(eB,{}),(0,t.jsx)(eH,{}),(0,t.jsx)("main",{className:"pt-20 pb-20 min-h-screen",children:(0,t.jsx)("div",{className:"px-2 py-2 max-w-full overflow-x-hidden",children:(0,t.jsx)(d.default.Suspense,{fallback:(0,t.jsx)(eU.default,{message:"Loading page..."}),children:(0,t.jsx)(n.Outlet,{})})})}),(0,t.jsxs)("footer",{className:"fixed bottom-0 left-0 right-0 bg-background border-t text-center text-xs text-muted-foreground py-2 mb-16 z-40",children:["© ",new Date().getFullYear()," Gonza Systems. All rights reserved."]}),(0,t.jsx)(eT,{})]}):(0,t.jsxs)("div",{className:"flex min-h-screen w-full",children:[(0,t.jsx)(e$,{}),(0,t.jsxs)("div",{className:"flex flex-1 flex-col min-h-screen min-w-0",children:[(0,t.jsx)(eB,{}),(0,t.jsx)(eH,{}),(0,t.jsx)("main",{className:"flex-1 bg-gray-50 p-6 overflow-auto",children:(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)(d.default.Suspense,{fallback:(0,t.jsx)(eU.default,{message:"Loading page..."}),children:(0,t.jsx)(n.Outlet,{})})})}),(0,t.jsxs)("footer",{className:"bg-background border-t text-center text-xs text-muted-foreground py-3",children:["© ",new Date().getFullYear()," Gonza Systems. All rights reserved."]})]}),(0,t.jsx)(eF,{})]}),(0,t.jsx)(eq,{}),(0,t.jsx)(eQ,{}),(0,t.jsx)(e0,{})]})})}catch(e){return console.error("Layout rendering error:",e),(0,t.jsx)(k,{children:(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Loading..."}),(0,t.jsx)(eU.default,{message:"Initializing app..."})]})})})}};var e2=e.i(971984);let e4=({children:e})=>{let{businessLocations:s,isLoading:a,createBusiness:r}=(0,l.useBusiness)(),{profiles:c,isLoading:u}=(0,o.useProfiles)(),{isCompleted:m,isFrozen:x,daysRemaining:h,isLoading:p}=(0,e2.useOnboarding)(),{user:f,loading:g,signOut:b}=(0,i.useAuth)(),j=(0,n.useNavigate)(),w=(0,n.useLocation)(),[v,y]=(0,d.useState)(!1);console.log("[Gate Render Check]:",{path:w.pathname,user:f?.id,authLoading:g,businessLoading:a,profilesLoading:u,onboardingLoading:p,onboardingCompleted:m,isAutomating:v,locations:s.length,profiles:c.length});let N=!a&&!u&&(0===s.length||0===c.length);return((0,d.useEffect)(()=>{(async()=>{if(!a&&!u&&f&&0===s.length&&!v){console.log("[Gate Action]: Auto-creating business for user:",f.id),y(!0);try{let e=f.user_metadata?.business_name||"My Business";await r(e),eG.toast.success("Your business system is ready!")}catch(e){console.error("[Gate Error]: Auto-setup failed:",e),eG.toast.error("Failed to complete account setup. Please try again.")}finally{y(!1)}}})()},[a,u,s.length,f,v,r]),(0,d.useEffect)(()=>{g||a||p||!1!==m||"/onboarding"===w.pathname||(console.log("[Gate Action]: MANDATORY REDIRECT to /onboarding"),j("/onboarding",{replace:!0}))},[g,a,p,m,w.pathname,j]),g||a||u||p||v)?(0,t.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background text-foreground",children:(0,t.jsx)(eU.default,{message:v?"Finalizing account setup...":p?"Checking profile status...":"Checking account setup..."})}):N?(0,t.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background",children:(0,t.jsx)(eU.default,{message:"Finalizing setup..."})}):!1===m&&"/onboarding"!==w.pathname?(console.log("[Gate Status]: Blocking render, awaiting redirect to onboarding"),null):m&&x?(0,t.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background p-6",children:(0,t.jsxs)("div",{className:"w-full max-w-md bg-white border border-border/40 shadow-xl rounded-lg p-10 text-center animate-in zoom-in-95 duration-300",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-amber-50 text-amber-600 border-amber-100 rounded-full flex items-center justify-center mx-auto mb-6 border",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,t.jsx)("h2",{className:"text-xl font-bold text-foreground mb-3 uppercase tracking-widest",children:"Account Paused"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed mb-8",children:"Your account has been temporarily paused due to unusual activity detected on your profile. Please contact the administrator immediately to resolve this issue and restore your access."}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"bg-muted/30 p-3 rounded-lg border border-border/40 mb-2",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-wider mb-1",children:"Admin Support"}),(0,t.jsx)("a",{href:"tel:+256758519696",className:"text-lg font-bold text-primary hover:underline block",children:"+256 758519696"})]}),(0,t.jsx)("button",{onClick:()=>b(),className:"block w-full py-2.5 text-muted-foreground text-[10px] font-bold uppercase tracking-widest border border-border/40 rounded hover:bg-muted transition-all",children:"Sign Out"})]})]})}):!0===m||"/onboarding"===w.pathname?(console.log("[Gate Status]: ALLOWING PASSAGE to",w.pathname),(0,t.jsx)(t.Fragment,{children:e})):m&&x?(0,t.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background p-6",children:(0,t.jsxs)("div",{className:"w-full max-w-md bg-white border border-border/40 shadow-xl rounded-lg p-10 text-center animate-in zoom-in-95 duration-300",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-amber-50 text-amber-600 border-amber-100 rounded-full flex items-center justify-center mx-auto mb-6 border",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,t.jsx)("h2",{className:"text-xl font-bold text-foreground mb-3 uppercase tracking-widest",children:"Account Paused"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed mb-8",children:"Your account has been temporarily paused due to unusual activity detected on your profile. Please contact the administrator immediately to resolve this issue and restore your access."}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"bg-muted/30 p-3 rounded-lg border border-border/40 mb-2",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-wider mb-1",children:"Admin Support"}),(0,t.jsx)("a",{href:"tel:+256758519696",className:"text-lg font-bold text-primary hover:underline block",children:"+256 758519696"})]}),(0,t.jsx)("button",{onClick:()=>b(),className:"block w-full py-2.5 text-muted-foreground text-[10px] font-bold uppercase tracking-widest border border-border/40 rounded hover:bg-muted transition-all",children:"Sign Out"})]})]})}):(console.log("[Gate Status]: Fallback block"),(0,t.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background",children:(0,t.jsx)(eU.default,{message:"Verifying access..."})}))};var e5=e.i(908406),e6=e.i(209912);let e3=({children:s})=>{let{daysRemaining:a,billingAmount:r,billingDuration:n,isLoading:o,isFrozen:c,refetch:u}=(0,e2.useOnboarding)(),{signOut:m,user:x}=(0,i.useAuth)(),{currentBusiness:h}=(0,l.useBusiness)(),[p,f]=(0,d.useState)(!1),[g,b]=(0,d.useState)(null),[j,w]=(0,d.useState)(null);d.default.useEffect(()=>{(async()=>{if(x)try{let e=await fetch(`/api/subscription/latest?userId=${x.id}`);if(e.ok){let t=await e.json();t?.id&&w({...t,business_name:h?.name||"Gonzo System User"})}}catch(e){console.error("Failed to fetch payment data:",e)}})()},[x,h]);let v=async()=>{if(!j)return;let{generateSubscriptionInvoice:t}=await e.A(171290);await t(j,"invoice")},y=async()=>{if(x){if(!r||r<=0)return void(0,e5.toast)({title:"Plan Not Configured",description:"Your subscription plan hasn't been set by an admin yet. Please contact support.",variant:"destructive"});f(!0);try{let e=crypto.randomUUID(),t=h?.id||"00000000-0000-0000-0000-000000000000",s=await fetch("/api/initiate-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({purchaseId:e,userId:x.id,locationId:t,amount:r,billingDuration:n,phoneNumber:x.phone||"0700000000",description:`Subscription Renewal - ${n} Plan`})}),a=await s.json();if(!s.ok||!a.redirect_url)throw Error(a.error||"Failed to initiate payment");b(a.redirect_url)}catch(e){console.error("Subscription Renewal Error:",e),(0,e5.toast)({title:"Payment Error",description:`${e.message||"Unknown error"}. Please try again later.`,variant:"destructive"})}finally{f(!1)}}};if(o)return(0,t.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background",children:(0,t.jsx)(eU.default,{message:"Verifying subscription..."})});console.log("--- [SubscriptionGate] Access Check ---"),console.log("Days Remaining:",a),console.log("Is Frozen:",c),console.log("Is Loading:",o);let N=void 0!==a&&a<=0,k="/payment-callback"===window.location.pathname||"/onboarding"===window.location.pathname||"/login"===window.location.pathname||"/signup"===window.location.pathname;return(console.log("Is Locked:",N),console.log("Is Public Path:",k),N&&!k)?g?(0,t.jsxs)("div",{className:"fixed inset-0 z-[100] bg-background flex flex-col items-center justify-center p-4",children:[(0,t.jsxs)("div",{className:"w-full max-w-4xl h-[85vh] bg-white rounded-2xl shadow-2xl border border-border/40 overflow-hidden relative flex flex-col",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-border/40 flex items-center justify-between bg-white",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center",children:(0,t.jsx)(eC.CreditCard,{className:"w-4 h-4 text-blue-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-bold uppercase tracking-wider",children:"Secure Payment"}),(0,t.jsx)("p",{className:"text-[10px] text-muted-foreground font-mono",children:"Pesapal Integrated Gateway"})]})]}),(0,t.jsx)("button",{onClick:()=>b(null),className:"text-[10px] font-bold uppercase tracking-widest text-muted-foreground hover:text-foreground transition-colors",children:"Cancel"})]}),(0,t.jsx)("iframe",{src:g,className:"w-full flex-1 border-none",title:"Pesapal Payment"})]}),(0,t.jsx)("p",{className:"mt-4 text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-medium opacity-60",children:"Do not close this window until the payment is complete"})]}):(0,t.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background p-6",children:(0,t.jsxs)("div",{className:"w-full max-w-md bg-white border border-border/40 shadow-xl rounded-lg p-10 text-center animate-in zoom-in-95 duration-300",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-amber-50 text-amber-600 border-amber-100 rounded-full flex items-center justify-center mx-auto mb-6 border",children:(0,t.jsx)(eC.CreditCard,{className:"w-8 h-8"})}),(0,t.jsx)("h2",{className:"text-xl font-bold text-foreground mb-3 uppercase tracking-widest",children:"Subscription Expired"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed mb-6",children:"Your subscription has expired. Don't worry, all your data is safe. Please renew your subscription to restore full access to your business dashboard."}),(0,t.jsxs)("div",{className:"bg-muted/30 p-4 rounded-lg border border-border/40 mb-6 text-left",children:[(0,t.jsx)("p",{className:"text-[10px] font-bold uppercase tracking-widest text-muted-foreground mb-1",children:"Renewal Amount"}),(0,t.jsxs)("div",{className:"flex items-end justify-between",children:[(0,t.jsxs)("p",{className:"text-2xl font-bold text-foreground",children:["UGX ",r?.toLocaleString()??"50,000"]}),(0,t.jsx)("span",{className:"text-xs font-medium px-2 py-1 bg-white border border-border/60 rounded text-muted-foreground shadow-sm",children:n})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("button",{onClick:y,disabled:p,className:"block w-full py-2.5 bg-primary text-primary-foreground text-[11px] font-bold uppercase tracking-widest rounded transition-all hover:bg-primary/90 disabled:opacity-50",children:p?"Processing...":"Renew Subscription Now"}),(0,t.jsxs)("div",{className:"bg-muted/30 p-3 rounded-lg border border-border/40 mb-2",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground uppercase tracking-wider mb-1",children:"Admin Support"}),(0,t.jsx)("a",{href:"tel:+256758519696",className:"text-lg font-bold text-primary hover:underline block",children:"+256 758519696"})]}),j&&(0,t.jsxs)("button",{onClick:v,className:"flex items-center justify-center gap-2 w-full py-2 text-[10px] font-bold uppercase tracking-widest text-primary hover:bg-primary/5 rounded transition-all border border-primary/20",children:[(0,t.jsx)(e6.Rocket,{className:"w-3.5 h-3.5 rotate-45"}),"Download ",j.id.split("-")[0].toUpperCase()," Invoice"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>{(0,e5.toast)({title:"Syncing status...",description:"Checking for your recent payment."}),u()},className:"block w-full py-2.5 text-muted-foreground text-[10px] font-bold uppercase tracking-widest border border-border/40 rounded hover:bg-muted transition-all",children:"Check Status"}),(0,t.jsx)("button",{onClick:()=>m(),className:"block w-full py-2.5 text-muted-foreground text-[10px] font-bold uppercase tracking-widest border border-border/40 rounded hover:bg-muted transition-all",children:"Sign Out"})]})]})]})}):(0,t.jsx)(t.Fragment,{children:s})},e8=(0,d.lazy)(()=>e.A(838835)),e7=(0,d.lazy)(()=>e.A(917611)),e9=(0,d.lazy)(()=>e.A(171523)),te=(0,d.lazy)(()=>e.A(442988)),tt=(0,d.lazy)(()=>e.A(26990)),ts=(0,d.lazy)(()=>e.A(752600)),ta=(0,d.lazy)(()=>e.A(338017)),tr=(0,d.lazy)(()=>e.A(173432)),tn=(0,d.lazy)(()=>e.A(327977)),ti=(0,d.lazy)(()=>e.A(289783)),tl=(0,d.lazy)(()=>e.A(512392)),to=(0,d.lazy)(()=>e.A(212107)),td=(0,d.lazy)(()=>e.A(10667)),tc=(0,d.lazy)(()=>e.A(190485)),tu=(0,d.lazy)(()=>e.A(835688)),tm=(0,d.lazy)(()=>e.A(891346)),tx=(0,d.lazy)(()=>e.A(339663)),th=(0,d.lazy)(()=>e.A(260069)),tp=(0,d.lazy)(()=>e.A(635345)),tf=(0,d.lazy)(()=>e.A(555648)),tg=(0,d.lazy)(()=>e.A(575276)),tb=(0,d.lazy)(()=>e.A(552858)),tj=(0,d.lazy)(()=>e.A(606722)),tw=(0,d.lazy)(()=>e.A(889177)),tv=(0,d.lazy)(()=>e.A(292473)),ty=(0,d.lazy)(()=>e.A(195993)),tN=new s.QueryClient({defaultOptions:{queries:{retry:1,staleTime:3e5,gcTime:18e5,refetchOnWindowFocus:!1}}}),tk=()=>{let{user:e,loading:s}=(0,i.useAuth)(),[a,r]=(0,d.useState)(!1),[c,u]=(0,d.useState)(!1);return((0,d.useEffect)(()=>{u(!navigator.onLine);let e=()=>u(!1),t=()=>u(!0);return window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]),(0,d.useEffect)(()=>{},[]),c)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 px-4",children:(0,t.jsxs)("div",{className:"text-center max-w-md",children:[(0,t.jsx)("img",{src:"/lovable-uploads/798d07d7-1db7-498c-92f3-6f6346827d59.png",alt:"Gonzo Systems Logo",className:"h-16 mx-auto mb-6"}),(0,t.jsx)(eV,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2 text-gray-800",children:"No Internet Connection"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"Please check your internet connection and try again. Make sure you're connected to WiFi or mobile data."}),(0,t.jsxs)(f.Button,{onClick:()=>{r(!0),window.location.reload()},className:"gap-2",size:"lg",disabled:a,children:[(0,t.jsx)(F.RefreshCw,{className:`h-4 w-4 ${a?"animate-spin":""}`}),a?"Refreshing...":"Refresh App"]})]})}):s?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)(eU.default,{message:"Loading authentication..."})}):e?(0,t.jsx)(l.BusinessProvider,{children:(0,t.jsx)(o.ProfileProvider,{children:(0,t.jsx)(d.Suspense,{fallback:(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)(eU.default,{message:"Loading page..."})}),children:(0,t.jsxs)(n.Routes,{children:[(0,t.jsx)(n.Route,{path:"/login",element:(0,t.jsx)(n.Navigate,{to:"/",replace:!0})}),(0,t.jsx)(n.Route,{path:"/signup",element:(0,t.jsx)(n.Navigate,{to:"/",replace:!0})}),(0,t.jsx)(n.Route,{path:"/delete-personal-data",element:(0,t.jsx)(tj,{})}),(0,t.jsx)(n.Route,{path:"/onboarding",element:(0,t.jsx)(ty,{})}),(0,t.jsxs)(n.Route,{element:(0,t.jsx)(e3,{children:(0,t.jsx)(e4,{children:(0,t.jsx)(e1,{})})}),children:[(0,t.jsx)(n.Route,{path:"/",element:(0,t.jsx)(e8,{})}),(0,t.jsx)(n.Route,{path:"/sales",element:(0,t.jsx)(tt,{})}),(0,t.jsx)(n.Route,{path:"/new-sale",element:(0,t.jsx)(ts,{})}),(0,t.jsx)(n.Route,{path:"/expenses",element:(0,t.jsx)(ta,{})}),(0,t.jsx)(n.Route,{path:"/settings",element:(0,t.jsx)(tf,{})}),(0,t.jsx)(n.Route,{path:"/privacy-policy",element:(0,t.jsx)(tb,{})}),(0,t.jsx)(n.Route,{path:"/inventory",element:(0,t.jsx)(tr,{})}),(0,t.jsx)(n.Route,{path:"/inventory/carriage-inwards",element:(0,t.jsx)(tc,{})}),(0,t.jsx)(n.Route,{path:"/inventory/reconcile",element:(0,t.jsx)(tu,{})}),(0,t.jsx)(n.Route,{path:"/inventory/new",element:(0,t.jsx)(to,{})}),(0,t.jsx)(n.Route,{path:"/inventory/edit/:id",element:(0,t.jsx)(to,{})}),(0,t.jsx)(n.Route,{path:"/inventory/:id",element:(0,t.jsx)(td,{})}),(0,t.jsx)(n.Route,{path:"/products",element:(0,t.jsx)(ti,{})}),(0,t.jsx)(n.Route,{path:"/categories",element:(0,t.jsx)(tl,{})}),(0,t.jsx)(n.Route,{path:"/cash",element:(0,t.jsx)(tn,{})}),(0,t.jsx)(n.Route,{path:"/cash/:accountId",element:(0,t.jsx)(tm,{})}),(0,t.jsx)(n.Route,{path:"/messages",element:(0,t.jsx)(tx,{})}),(0,t.jsx)(n.Route,{path:"/payment-callback",element:(0,t.jsx)(tg,{})}),(0,t.jsx)(n.Route,{path:"/tasks",element:(0,t.jsx)(th,{})}),(0,t.jsx)(n.Route,{path:"/history",element:(0,t.jsx)(tp,{})}),(0,t.jsx)(n.Route,{path:"/help",element:(0,t.jsx)(tw,{})}),(0,t.jsx)(n.Route,{path:"*",element:(0,t.jsx)(tv,{})})]})]})})})}):(0,t.jsx)(d.Suspense,{fallback:(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)(eU.default,{message:"Loading..."})}),children:(0,t.jsxs)(n.Routes,{children:[(0,t.jsx)(n.Route,{path:"/",element:(0,t.jsx)(te,{})}),(0,t.jsx)(n.Route,{path:"/login",element:(0,t.jsx)(e7,{})}),(0,t.jsx)(n.Route,{path:"/signup",element:(0,t.jsx)(e9,{})}),(0,t.jsx)(n.Route,{path:"/privacy-policy",element:(0,t.jsx)(tb,{})}),(0,t.jsx)(n.Route,{path:"/delete-personal-data",element:(0,t.jsx)(tj,{})}),(0,t.jsx)(n.Route,{path:"/payment-callback",element:(0,t.jsx)(tg,{})}),(0,t.jsx)(n.Route,{path:"*",element:(0,t.jsx)(n.Navigate,{to:"/",replace:!0})})]})})};e.s(["default",0,function(){let[e,s]=(0,d.useState)(!1);return((0,d.useEffect)(()=>{s(!0)},[]),e)?(0,t.jsx)(a.QueryClientProvider,{client:tN,children:(0,t.jsx)(r.BrowserRouter,{children:(0,t.jsx)(i.AuthProvider,{children:(0,t.jsx)(tk,{})})})}):null}],795052)}]);