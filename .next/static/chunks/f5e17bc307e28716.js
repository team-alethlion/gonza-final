(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,943674,e=>{"use strict";var t=e.i(843476),s=e.i(271645),r=e.i(904792),i=e.i(519455),a=e.i(107233),l=e.i(16715),n=e.i(440160),o=e.i(569074),c=e.i(727612),d=e.i(871689),u=e.i(303281),m=e.i(102594),x=e.i(422713),h=e.i(414877),p=e.i(975157),g=e.i(160615),j=e.i(669469),f=e.i(487486);let N=({product:e})=>0===e.quantity?(0,t.jsx)(f.Badge,{variant:"destructive",children:"Out of stock"}):e.quantity<=e.minimumStock?(0,t.jsx)(f.Badge,{variant:"warning",children:"Low stock"}):(0,t.jsx)(f.Badge,{variant:"success",children:"In stock"});var b=e.i(541071),v=e.i(688511),y=e.i(952571),C=e.i(777624),w=e.i(755146);let S=({product:e,onView:s,onEdit:r})=>{let{hasPermission:a}=(0,C.useProfiles)();return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(w.DropdownMenu,{children:[(0,t.jsx)(w.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(i.Button,{variant:"ghost",size:"icon",children:[(0,t.jsx)(b.MoreHorizontal,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Open menu"})]})}),(0,t.jsxs)(w.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(w.DropdownMenuLabel,{children:"Actions"}),(0,t.jsxs)(w.DropdownMenuItem,{onClick:()=>s(e.id),children:[(0,t.jsx)(y.Info,{className:"mr-2 h-4 w-4"})," View details"]}),a("inventory","edit")&&(0,t.jsxs)(w.DropdownMenuItem,{onClick:()=>r(e.id),children:[(0,t.jsx)(v.Edit,{className:"mr-2 h-4 w-4"})," Edit"]})]})]})})};var P=e.i(257428),k=e.i(746798),T=e.i(392401);let D=({product:e,onView:s,onEdit:r,showAllFields:i=!0,enableBulkActions:a=!1,isSelected:l=!1,onToggleSelection:n})=>{let{settings:o}=(0,g.useBusinessSettings)(),{formatFinancial:c,canViewCostPrice:d,canViewSellingPrice:u,canViewProfit:m}=(0,T.useFinancialVisibility)(),x=e.quantity*e.costPrice;return(0,t.jsx)(k.TooltipProvider,{children:(0,t.jsxs)("div",{className:"py-4 px-4 hover:bg-gray-50 border-b last:border-b-0 rounded-md",onClick:()=>s(e.id),children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[a&&(0,t.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,t.jsx)(P.Checkbox,{checked:l,onCheckedChange:()=>n?.(e.id),"aria-label":`Select ${e.name}`})}),(0,t.jsx)(j.default,{imageUrl:e.imageUrl,alt:e.name}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(k.Tooltip,{children:[(0,t.jsx)(k.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("h3",{className:"font-medium text-sales-dark cursor-help max-w-[150px] truncate",children:e.name})}),(0,t.jsx)(k.TooltipContent,{side:"top",className:"max-w-xs",children:(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"font-bold break-words whitespace-normal",children:e.name}),e.description&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground whitespace-pre-wrap",children:e.description})]})})]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["#",e.itemNumber]})]})]}),(0,t.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,t.jsx)(S,{product:e,onView:s,onEdit:r})})]}),(0,t.jsxs)("div",{className:`grid grid-cols-2 gap-y-2.5 text-sm ${a?"ml-20":"ml-14"}`,children:[e.category&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"text-muted-foreground font-medium",children:"Category:"}),(0,t.jsx)("div",{className:"font-normal",children:e.category})]}),(0,t.jsx)("div",{className:"text-muted-foreground font-medium",children:"Quantity:"}),(0,t.jsx)("div",{className:"font-medium",children:e.quantity%1==0?e.quantity:e.quantity.toFixed(2)}),(0,t.jsx)("div",{className:"text-muted-foreground font-medium",children:"Status:"}),(0,t.jsx)("div",{children:(0,t.jsx)(N,{product:e})}),void 0!==e.costPrice&&null!==e.costPrice&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"text-muted-foreground font-medium",children:"Cost Price:"}),(0,t.jsx)("div",{className:"font-medium tabular-nums",children:d?`${o.currency} ${c(e.costPrice,"cost")}`:"•••"}),(0,t.jsx)("div",{className:"text-muted-foreground font-medium",children:"Total Cost:"}),(0,t.jsx)("div",{className:"font-medium tabular-nums",children:d?`${o.currency} ${(0,p.formatNumber)(x)}`:"•••"})]}),i&&void 0!==e.sellingPrice&&null!==e.sellingPrice&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"text-muted-foreground font-medium",children:"Selling Price:"}),(0,t.jsx)("div",{className:"font-medium tabular-nums",children:u?`${o.currency} ${c(e.sellingPrice,"selling")}`:"•••"})]})]})]})})};var F=e.i(784774),B=e.i(655900),$=e.i(664659);let z=({field:e,currentSortField:s,sortOrder:r,onSort:i,children:a,className:l})=>(0,t.jsx)(F.TableHead,{className:`cursor-pointer hover:bg-muted/80 ${l||""}`,onClick:()=>i(e),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[a,s===e&&(0,t.jsx)("div",{className:"ml-1",children:"asc"===r?(0,t.jsx)(B.ChevronUp,{className:"h-4 w-4"}):(0,t.jsx)($.ChevronDown,{className:"h-4 w-4"})})]})});var E=e.i(401851),I=e.i(793479),O=e.i(967489),A=e.i(643531),U=e.i(37727);let M=({value:e,type:r,options:a=[],currency:l,onSave:n,className:o="",displayFormatter:c})=>{let[d,u]=(0,s.useState)(!1),[m,x]=(0,s.useState)(e.toString()),[h,g]=(0,s.useState)(!1),j=t=>{t.stopPropagation(),u(!1),x(e.toString())},f=async e=>{e.stopPropagation(),g(!0);try{let e="number"===r?parseFloat(m)||0:m;await n(e)&&u(!1)}catch(e){console.error("Error saving:",e)}finally{g(!1)}};return d?(0,t.jsxs)("div",{className:"flex items-center gap-1",onClick:e=>e.stopPropagation(),children:["select"===r?(0,t.jsxs)(O.Select,{value:m,onValueChange:x,children:[(0,t.jsx)(O.SelectTrigger,{className:"h-8 text-xs",children:(0,t.jsx)(O.SelectValue,{})}),(0,t.jsx)(O.SelectContent,{children:a.map(e=>(0,t.jsx)(O.SelectItem,{value:e,children:e},e))})]}):(0,t.jsx)(I.Input,{type:r,value:m,onChange:e=>x(e.target.value),onKeyDown:e=>{e.stopPropagation(),"Enter"===e.key?f(e):"Escape"===e.key&&j(e)},className:"h-8 text-xs",autoFocus:!0,step:"number"===r?"0.01":void 0}),(0,t.jsx)(i.Button,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:f,disabled:h,children:(0,t.jsx)(A.Check,{className:"h-3 w-3"})}),(0,t.jsx)(i.Button,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:j,disabled:h,children:(0,t.jsx)(U.X,{className:"h-3 w-3"})})]}):(0,t.jsxs)("div",{className:`group cursor-pointer flex items-center gap-2 ${o}`,onClick:t=>{t.stopPropagation(),u(!0),x(e.toString())},children:[(0,t.jsx)("span",{className:"flex-1",children:c?c(e):"number"===r&&l?`${l} ${(0,p.formatNumber)(e)}`:e.toString()}),(0,t.jsx)(v.Edit,{className:"h-3 w-3 opacity-0 group-hover:opacity-50 transition-opacity"})]})},R=({products:e,sortField:s,sortOrder:r,handleSort:i,onView:a,onEdit:l,showAllFields:n=!0,enableBulkActions:o=!1,selectedProductIds:c=new Set,onToggleProductSelection:d,onToggleAllProducts:u,onUpdateProduct:m,categories:x=[]})=>{let{settings:h}=(0,g.useBusinessSettings)(),{hasPermission:p}=(0,C.useProfiles)(),{canViewCostPrice:f,canViewSellingPrice:b,formatFinancial:v}=(0,T.useFinancialVisibility)(),y=p("inventory","edit"),w=e.map(e=>e.id),D=w.length>0&&w.every(e=>c.has(e));return n?(0,t.jsx)("div",{className:"overflow-hidden rounded-md border",children:(0,t.jsx)(k.TooltipProvider,{children:(0,t.jsxs)(F.Table,{children:[(0,t.jsx)(F.TableHeader,{children:(0,t.jsxs)(F.TableRow,{className:"bg-muted/50",children:[o&&(0,t.jsx)(F.TableHead,{className:"w-[50px]",children:(0,t.jsx)(P.Checkbox,{checked:D,onCheckedChange:()=>u?.(w),"aria-label":"Select all products"})}),(0,t.jsx)(F.TableHead,{className:"w-[80px]",children:"Image"}),(0,t.jsx)(z,{field:"itemNumber",currentSortField:s,sortOrder:r,onSort:i,className:"w-[100px]",children:"Item #"}),(0,t.jsx)(z,{field:"name",currentSortField:s,sortOrder:r,onSort:i,className:"w-[180px]",children:"Product Name"}),(0,t.jsx)(z,{field:"category",currentSortField:s,sortOrder:r,onSort:i,className:"w-[120px]",children:"Category"}),(0,t.jsx)(z,{field:"quantity",currentSortField:s,sortOrder:r,onSort:i,className:"w-[80px] text-right",children:"Quantity"}),(0,t.jsx)(F.TableHead,{className:"w-[80px]",children:"Status"}),f&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(z,{field:"costPrice",currentSortField:s,sortOrder:r,onSort:i,className:"w-[100px] text-right",children:"Cost Price"}),(0,t.jsx)(F.TableHead,{className:"w-[100px] text-right",children:"Total Cost"})]}),b&&(0,t.jsx)(z,{field:"sellingPrice",currentSortField:s,sortOrder:r,onSort:i,className:"w-[100px] text-right",children:"Selling Price"}),(0,t.jsx)(F.TableHead,{className:"w-[100px] text-center",children:"Created Date"}),(0,t.jsx)(F.TableHead,{className:"w-[80px] text-right",children:"Actions"})]})}),(0,t.jsx)(F.TableBody,{children:e.map(e=>(0,t.jsxs)(F.TableRow,{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>a(e.id),children:[o&&(0,t.jsx)(F.TableCell,{onClick:e=>e.stopPropagation(),children:(0,t.jsx)(P.Checkbox,{checked:c.has(e.id),onCheckedChange:()=>d?.(e.id),"aria-label":`Select ${e.name}`})}),(0,t.jsx)(F.TableCell,{children:(0,t.jsx)(j.default,{imageUrl:e.imageUrl,alt:e.name,size:"sm"})}),(0,t.jsx)(F.TableCell,{className:"font-mono text-sm max-w-[100px] truncate",children:(0,t.jsxs)(k.Tooltip,{children:[(0,t.jsx)(k.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("span",{className:"cursor-help",children:e.itemNumber})}),(0,t.jsx)(k.TooltipContent,{children:(0,t.jsx)("p",{className:"font-mono",children:e.itemNumber})})]})}),(0,t.jsx)(F.TableCell,{className:"font-medium max-w-[180px] truncate",children:(0,t.jsxs)(k.Tooltip,{children:[(0,t.jsx)(k.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("span",{className:"cursor-help",children:e.name})}),(0,t.jsx)(k.TooltipContent,{className:"max-w-xs",children:(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"font-bold break-words whitespace-normal",children:e.name}),e.description&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground whitespace-pre-wrap",children:e.description})]})})]})}),(0,t.jsx)(F.TableCell,{className:"max-w-[120px]",onClick:e=>e.stopPropagation(),children:m&&y?(0,t.jsx)(M,{value:e.category,type:"select",options:x,onSave:t=>m(e.id,{category:t})}):(0,t.jsx)("span",{className:"truncate",children:e.category})}),(0,t.jsx)(F.TableCell,{className:"text-right font-medium",children:e.quantity%1==0?e.quantity:e.quantity.toFixed(2)}),(0,t.jsx)(F.TableCell,{children:(0,t.jsx)(N,{product:e})}),f&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(F.TableCell,{className:"text-right font-medium tabular-nums",onClick:e=>e.stopPropagation(),children:m&&y?(0,t.jsx)(M,{value:e.costPrice,type:"number",currency:h.currency,onSave:t=>m(e.id,{costPrice:t}),className:"text-right"}):(0,t.jsxs)("span",{children:[h.currency," ",v(e.costPrice,"cost")]})}),(0,t.jsxs)(F.TableCell,{className:"text-right font-medium tabular-nums",children:[h.currency," ",v(e.quantity*e.costPrice,"cost")]})]}),b&&(0,t.jsx)(F.TableCell,{className:"text-right font-medium tabular-nums",onClick:e=>e.stopPropagation(),children:m&&y?(0,t.jsx)(M,{value:e.sellingPrice,type:"number",currency:h.currency,onSave:t=>m(e.id,{sellingPrice:t}),className:"text-right"}):(0,t.jsxs)("span",{children:[h.currency," ",v(e.sellingPrice,"price")]})}),(0,t.jsx)(F.TableCell,{className:"text-center text-sm text-muted-foreground",children:(0,E.format)(e.createdAt,"MMM dd, yyyy")}),(0,t.jsx)(F.TableCell,{className:"text-right",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(S,{product:e,onView:a,onEdit:l})})]},e.id))})]})})}):(0,t.jsx)("div",{className:"overflow-hidden rounded-md border",children:(0,t.jsx)(k.TooltipProvider,{children:(0,t.jsxs)(F.Table,{children:[(0,t.jsx)(F.TableHeader,{children:(0,t.jsxs)(F.TableRow,{className:"bg-muted/50",children:[o&&(0,t.jsx)(F.TableHead,{className:"w-[50px]",children:(0,t.jsx)(P.Checkbox,{checked:D,onCheckedChange:()=>u?.(w),"aria-label":"Select all products"})}),(0,t.jsx)(F.TableHead,{className:"w-[80px]",children:"Image"}),(0,t.jsx)(z,{field:"itemNumber",currentSortField:s,sortOrder:r,onSort:i,className:"w-[100px]",children:"Item #"}),(0,t.jsx)(z,{field:"name",currentSortField:s,sortOrder:r,onSort:i,className:"w-[160px]",children:"Product Name"}),(0,t.jsx)(z,{field:"category",currentSortField:s,sortOrder:r,onSort:i,className:"w-[120px]",children:"Category"}),(0,t.jsx)(z,{field:"quantity",currentSortField:s,sortOrder:r,onSort:i,className:"w-[80px] text-right",children:"Quantity"}),(0,t.jsx)(F.TableHead,{className:"w-[80px]",children:"Status"}),f&&(0,t.jsx)(z,{field:"costPrice",currentSortField:s,sortOrder:r,onSort:i,className:"w-[100px] text-right",children:"Cost Price"}),b&&(0,t.jsx)(z,{field:"sellingPrice",currentSortField:s,sortOrder:r,onSort:i,className:"w-[100px] text-right",children:"Selling Price"}),(0,t.jsx)(F.TableHead,{className:"w-[100px] text-center",children:"Created Date"}),(0,t.jsx)(F.TableHead,{className:"w-[80px] text-right",children:"Actions"})]})}),(0,t.jsx)(F.TableBody,{children:e.map(e=>(0,t.jsxs)(F.TableRow,{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>a(e.id),children:[o&&(0,t.jsx)(F.TableCell,{onClick:e=>e.stopPropagation(),children:(0,t.jsx)(P.Checkbox,{checked:c.has(e.id),onCheckedChange:()=>d?.(e.id),"aria-label":`Select ${e.name}`})}),(0,t.jsx)(F.TableCell,{children:(0,t.jsx)(j.default,{imageUrl:e.imageUrl,alt:e.name,size:"sm"})}),(0,t.jsx)(F.TableCell,{className:"font-mono text-sm max-w-[100px] truncate",children:(0,t.jsxs)(k.Tooltip,{children:[(0,t.jsx)(k.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("span",{className:"cursor-help",children:e.itemNumber})}),(0,t.jsx)(k.TooltipContent,{children:(0,t.jsx)("p",{className:"font-mono",children:e.itemNumber})})]})}),(0,t.jsx)(F.TableCell,{className:"font-medium max-w-[160px] truncate",children:(0,t.jsxs)(k.Tooltip,{children:[(0,t.jsx)(k.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("span",{className:"cursor-help",children:e.name})}),(0,t.jsx)(k.TooltipContent,{className:"max-w-xs",children:(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"font-bold break-words whitespace-normal",children:e.name}),e.description&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground whitespace-pre-wrap",children:e.description})]})})]})}),(0,t.jsx)(F.TableCell,{className:"max-w-[120px]",onClick:e=>e.stopPropagation(),children:m&&y?(0,t.jsx)(M,{value:e.category,type:"select",options:x,onSave:t=>m(e.id,{category:t})}):(0,t.jsx)("span",{className:"truncate",children:e.category})}),(0,t.jsx)(F.TableCell,{className:"text-right font-medium",children:e.quantity%1==0?e.quantity:e.quantity.toFixed(2)}),(0,t.jsx)(F.TableCell,{children:(0,t.jsx)(N,{product:e})}),(0,t.jsx)(F.TableCell,{children:(0,t.jsx)(N,{product:e})}),f&&(0,t.jsx)(F.TableCell,{className:"text-right font-medium tabular-nums",onClick:e=>e.stopPropagation(),children:m&&y?(0,t.jsx)(M,{value:e.costPrice,type:"number",currency:h.currency,onSave:t=>m(e.id,{costPrice:t}),className:"text-right"}):(0,t.jsxs)("span",{children:[h.currency," ",v(e.costPrice,"cost")]})}),b&&(0,t.jsx)(F.TableCell,{className:"text-right font-medium tabular-nums",onClick:e=>e.stopPropagation(),children:m&&y?(0,t.jsx)(M,{value:e.sellingPrice,type:"number",currency:h.currency,onSave:t=>m(e.id,{sellingPrice:t}),className:"text-right"}):(0,t.jsxs)("span",{children:[h.currency," ",v(e.sellingPrice,"selling")]})}),(0,t.jsx)(F.TableCell,{className:"text-center text-sm text-muted-foreground",children:(0,E.format)(e.createdAt,"MMM dd, yyyy")}),(0,t.jsx)(F.TableCell,{className:"text-right",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(S,{product:e,onView:a,onEdit:l})})]},e.id))})]})})})};var q=e.i(488844);let V=()=>{let e=(0,r.useNavigate)();return(0,t.jsxs)("div",{className:"text-center py-12 px-4 border-dashed border-2 rounded-lg bg-white",children:[(0,t.jsx)("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-muted mb-4",children:(0,t.jsx)(q.Package,{className:"h-6 w-6 text-muted-foreground"})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"No products found"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Start managing your inventory by adding your first product."}),(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsxs)(i.Button,{onClick:()=>e("/inventory/new"),className:"gap-2",children:[(0,t.jsx)(a.Plus,{size:16})," Add New Product"]})})]})},L=({products:e,isLoading:i,showAllFields:a=!0,enableBulkActions:l=!1,selectedProductIds:n=new Set,onToggleProductSelection:o,onToggleAllProducts:c,sortField:d,sortOrder:u,onSort:m,onUpdateProduct:x,categories:p=[]})=>{let g=(0,r.useNavigate)(),j=(0,h.useIsMobile)(),[f,N]=s.default.useState("name"),[b,v]=s.default.useState("asc"),y=d||f,C=u||b,w=e=>{g(`/inventory/edit/${e}`)},S=e=>{g(`/inventory/${e}`)},P=s.default.useMemo(()=>[...e].sort((e,t)=>{let s=0;switch(y){case"name":s=e.name.localeCompare(t.name);break;case"category":s=e.category.localeCompare(t.category);break;case"quantity":s=e.quantity-t.quantity;break;case"sellingPrice":s=e.sellingPrice-t.sellingPrice;break;case"costPrice":s=e.costPrice-t.costPrice;break;case"itemNumber":s=e.itemNumber.localeCompare(t.itemNumber)}return"asc"===C?s:-s}),[e,y,C]);if(i)return(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsx)("div",{className:"animate-pulse",children:"Loading inventory data..."})});if(0===e.length)return(0,t.jsx)(V,{});if(j){let e=P.map(e=>e.id),s=e.length>0&&e.every(e=>n.has(e));return(0,t.jsxs)("div",{className:"space-y-4",children:[l&&P.length>0&&(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 bg-muted/30 rounded-md",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:s,onChange:()=>c?.(e),className:"rounded border-gray-300",id:"mobile-select-all"}),(0,t.jsxs)("label",{htmlFor:"mobile-select-all",className:"text-sm font-medium",children:["Select All (",e.length,")"]})]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[n.size," selected"]})]}),(0,t.jsx)("div",{className:"divide-y",children:P.map(e=>(0,t.jsx)(D,{product:e,onView:S,onEdit:w,showAllFields:a,enableBulkActions:l,isSelected:n.has(e.id),onToggleSelection:o},e.id))})]})}return(0,t.jsx)(R,{products:P,sortField:y,sortOrder:C,handleSort:e=>{m?m(e):y===e?v("asc"===C?"desc":"asc"):(N(e),v("asc"))},onView:S,onEdit:w,showAllFields:a,enableBulkActions:l,selectedProductIds:n,onToggleProductSelection:o,onToggleAllProducts:c,onUpdateProduct:x,categories:p})};var H=e.i(555436),Q=e.i(797548),W=e.i(515288);let G=({filters:e,setFilters:r,categories:i,productsCount:a})=>{let l=(0,h.useIsMobile)(),[n,o]=s.default.useState(e.search);s.default.useEffect(()=>{e.search!==n&&o(e.search)},[e.search]);let c=(t,s)=>{r({...e,[t]:s})};return(0,t.jsx)(W.Card,{className:"mb-6 shadow-sm",children:(0,t.jsx)(W.CardContent,{className:(0,p.cn)("p-4",l&&"p-3"),children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center relative flex-grow",children:[(0,t.jsx)(H.Search,{className:"h-4 w-4 absolute left-3 text-gray-400"}),(0,t.jsx)(I.Input,{placeholder:"Search products...",className:"pl-9",value:n,onChange:e=>{o(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&c("search",n)},onBlur:()=>{n!==e.search&&c("search",n)}})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,t.jsx)("div",{className:"min-w-[180px]",children:(0,t.jsxs)(O.Select,{value:e.category||"all",onValueChange:e=>c("category","all"===e?"":e),children:[(0,t.jsx)(O.SelectTrigger,{className:(0,p.cn)("w-full",""!==e.category&&"border-primary"),children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(Q.Filter,{className:"h-4 w-4"}),(0,t.jsx)(O.SelectValue,{placeholder:"All Categories"})]})}),(0,t.jsxs)(O.SelectContent,{children:[(0,t.jsx)(O.SelectItem,{value:"all",children:"All Categories"}),i.map(e=>(0,t.jsx)(O.SelectItem,{value:e.name,children:e.name},e.id))]})]})}),(0,t.jsx)("div",{className:"min-w-[150px]",children:(0,t.jsxs)(O.Select,{value:e.stockStatus,onValueChange:e=>c("stockStatus",e),children:[(0,t.jsx)(O.SelectTrigger,{className:(0,p.cn)("all"!==e.stockStatus&&"border-primary"),children:(0,t.jsx)(O.SelectValue,{placeholder:"Stock Status"})}),(0,t.jsxs)(O.SelectContent,{children:[(0,t.jsx)(O.SelectItem,{value:"all",children:"All Stock"}),(0,t.jsx)(O.SelectItem,{value:"inStock",children:"In Stock"}),(0,t.jsx)(O.SelectItem,{value:"lowStock",children:"Low Stock"}),(0,t.jsx)(O.SelectItem,{value:"outOfStock",children:"Out of Stock"})]})]})}),(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsxs)(f.Badge,{variant:"secondary",className:"text-xs",children:[a," ",1===a?"product":"products"," found"]})})]})]})})})};var _=e.i(184244),J=e.i(908962),K=e.i(908406),Y=e.i(255749),X=e.i(261246),Z=e.i(776639),ee=e.i(649941);let et=({open:e,onOpenChange:s,selectedProducts:r,onConfirm:a,isDeleting:l,deletionProgress:n})=>{let o=n?Math.round(n.current/n.total*100):0,c=e=>{l||s(e)};return(0,t.jsx)(Z.Dialog,{open:e,onOpenChange:c,children:(0,t.jsxs)(Z.DialogContent,{className:"pointer-events-auto",children:[(0,t.jsxs)(Z.DialogHeader,{children:[(0,t.jsx)(Z.DialogTitle,{children:"Delete Selected Products"}),(0,t.jsxs)(Z.DialogDescription,{children:["Are you sure you want to delete ",r.length," product",r.length>1?"s":"","? This action cannot be undone."]})]}),(0,t.jsx)("div",{className:"max-h-40 overflow-y-auto",children:(0,t.jsx)("div",{className:"space-y-1",children:r.map(e=>(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["• ",e.name]},e.id))})}),l&&n&&(0,t.jsx)(ee.BulkOperationProgress,{title:"Deleting Products...",currentCount:n.current,totalCount:n.total,status:"processing"}),(0,t.jsxs)(Z.DialogFooter,{children:[(0,t.jsx)(i.Button,{variant:"outline",onClick:()=>c(!1),disabled:l,children:"Cancel"}),(0,t.jsx)(i.Button,{variant:"destructive",onClick:a,disabled:l,children:l?`Deleting... (${o}%)`:`Delete ${r.length} Product${r.length>1?"s":""}`})]})]})})};var es=e.i(501504),er=e.i(929592),ei=e.i(178583),ea=e.i(63209);let el=e=>{let t=[],s="",r=!1,i=0;for(;i<e.length;){let a=e[i],l=e[i+1];if('"'===a)if(r&&'"'===l){s+='"',i+=2;continue}else r=!r;else","!==a||r?s+=a:(t.push(s.trim()),s="");i++}return t.push(s.trim()),t},en=(e,t)=>{let s=[];return e["Item Number"]?.trim()||s.push({row:t,field:"Item Number",message:"Item Number is required for updates"}),e.Quantity&&""!==e.Quantity.trim()&&isNaN(Number(e.Quantity))&&s.push({row:t,field:"Quantity",message:"Quantity must be a number"}),e["Cost Price"]&&""!==e["Cost Price"].trim()&&isNaN(Number(e["Cost Price"]))&&s.push({row:t,field:"Cost Price",message:"Cost Price must be a number"}),e["Selling Price"]&&""!==e["Selling Price"].trim()&&isNaN(Number(e["Selling Price"]))&&s.push({row:t,field:"Selling Price",message:"Selling Price must be a number"}),s};var eo=e.i(908482);let ec=({open:e,onOpenChange:r,userId:a})=>{let{bulkUpdateProducts:l,detectNewCategories:c,isUpdating:d}=(e=>{let[t,r]=(0,s.useState)(!1),[i,a]=(0,s.useState)(null),{toast:l}=(0,K.useToast)(),{products:n,updateProduct:o}=(0,J.useProducts)(e,1e4),{categories:c,createCategory:d}=(0,eo.useCategories)(e),u=e=>{let t=[],s=[];return e.forEach((e,r)=>{let i,a=e["Item Number"]?.trim(),l=a?.padStart(4,"0"),o=n.find(e=>e.itemNumber===a||e.itemNumber===l);if(!o)return void s.push(`Row ${r+1}: Product with Item Number "${a}" not found`);let c={};if(e.Name?.trim()&&e.Name.trim()!==o.name&&(c.name=e.Name.trim()),e.Category?.trim()&&e.Category.trim()!==o.category&&(c.category=e.Category.trim()),e.Quantity?.trim()!==""&&!isNaN(Number(e.Quantity))){let t=Number(e.Quantity);t!==o.quantity&&(c.quantity=t,i={oldQuantity:o.quantity,newQuantity:t})}if(e["Cost Price"]?.trim()!==""&&!isNaN(Number(e["Cost Price"]))){let t=Number(e["Cost Price"]);Math.abs(t-o.costPrice)>.001&&(c.costPrice=t)}if(e["Selling Price"]?.trim()!==""&&!isNaN(Number(e["Selling Price"]))){let t=Number(e["Selling Price"]);Math.abs(t-o.sellingPrice)>.001&&(c.sellingPrice=t)}e.Supplier?.trim()&&e.Supplier.trim()!==(o.supplier||"")&&(c.supplier=e.Supplier.trim()),e.Description?.trim()&&e.Description.trim()!==(o.description||"")&&(c.description=e.Description.trim()),e["Manufacturer Barcode"]?.trim()!==void 0&&e["Manufacturer Barcode"].trim()!==(o.manufacturerBarcode||"")&&(c.manufacturerBarcode=e["Manufacturer Barcode"].trim()),e.Barcode?.trim()!==void 0&&e.Barcode.trim()!==(o.barcode||"")&&(c.barcode=e.Barcode.trim()),Object.keys(c).length>0&&t.push({productId:o.id,itemNumber:o.itemNumber,updates:c,quantityChange:i})}),{validUpdates:t,errors:s}},m=e=>{let t=c.map(e=>e.name);return[...new Set(e.map(e=>e.Category?.trim()).filter(e=>e&&""!==e))].filter(e=>!t.includes(e))},x=async(e,t)=>{r(!0),a({current:0,total:e.length});try{let{validUpdates:s,errors:r}=u(e);if(r.length>0)throw Error(`Validation errors: ${r.join(", ")}`);for(let t of m(e))await d(t);let i=0,n=0;for(let e=0;e<s.length;e++){let r=s[e];try{console.log(`DEBUG: Calling updateProduct for ${r.itemNumber} with updates:`,r.updates);let e=await o(r.productId,r.updates,void 0,!1,"CSV Edit");console.log(`DEBUG: UpdateProduct result for ${r.itemNumber}: ${e}`),e?i++:n++}catch(e){console.error(`Error updating product ${r.itemNumber}:`,e),n++}let l=e+1;a({current:l,total:s.length}),t?.(l,s.length)}return i>0&&l({title:"Products updated successfully",description:`${i} product${i>1?"s":""} updated successfully`}),n>0&&l({title:"Some updates failed",description:`${n} product${n>1?"s":""} could not be updated`,variant:"destructive"}),{successCount:i,failureCount:n}}catch(e){throw console.error("Bulk update failed:",e),l({title:"Update failed",description:e instanceof Error?e.message:"An error occurred during the update",variant:"destructive"}),e}finally{r(!1),a(null)}};return{isUpdating:t,updateProgress:i,validateUpdates:u,detectNewCategories:m,bulkUpdateProducts:x}})(a),[u,m]=(0,s.useState)({step:"select",file:null,validRows:[],errors:[],totalRows:0,updateProgress:0,successCount:0,failureCount:0,newCategories:[],currentProductIndex:0}),x=(0,s.useRef)(null),[h,g]=(0,s.useState)(!1),j=async e=>{if(!e.name.endsWith(".csv"))return void alert("Please select a CSV file");let t=(e=>{let t=e.trim().split("\n"),s=el(t[0]).map(e=>e.trim()),r=[],i=[];for(let e=1;e<t.length;e++){let a=el(t[e]).map(e=>e.trim()),l={};s.forEach((e,t)=>{l[e]=a[t]||""});let n=en(l,e+1);0===n.length?r.push(l):i.push(...n)}return{validRows:r,errors:i,totalRows:t.length-1}})(await e.text()),s=c(t.validRows);m({...u,step:"preview",file:e,validRows:t.validRows,errors:t.errors,totalRows:t.totalRows,newCategories:s})},N=async()=>{m(e=>({...e,step:"updating",updateProgress:0,currentProductIndex:0}));try{let e=await l(u.validRows,(e,t)=>{let s=Math.round(e/t*100);m(t=>({...t,updateProgress:s,currentProductIndex:e}))});m(t=>({...t,step:"complete",updateProgress:100,successCount:e.successCount,failureCount:e.failureCount,currentProductIndex:u.validRows.length}))}catch(e){console.error("Update failed:",e),m(e=>({...e,step:"complete",updateProgress:100,successCount:0,failureCount:u.validRows.length,currentProductIndex:u.validRows.length}))}};return(0,t.jsx)(Z.Dialog,{open:e,onOpenChange:e=>{d||r(e)},children:(0,t.jsxs)(Z.DialogContent,{className:"sm:max-w-[500px] pointer-events-auto",children:[(0,t.jsxs)(Z.DialogHeader,{children:[(0,t.jsxs)(Z.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(ei.FileText,{className:"h-5 w-5"}),"Update Products via CSV"]}),(0,t.jsx)(Z.DialogDescription,{children:"Update existing products using a CSV file with Item Numbers for identification"})]}),"select"===u.step&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:(0,p.cn)("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors",h?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"),onDrop:e=>{e.preventDefault(),g(!1);let t=e.dataTransfer.files[0];t&&j(t)},onDragOver:e=>{e.preventDefault(),g(!0)},onDragLeave:()=>{g(!1)},onClick:()=>x.current?.click(),children:[(0,t.jsx)(o.Upload,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,t.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload CSV File for Product Updates"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Drag and drop your CSV file here, or click to browse"}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"Make sure the CSV includes Item Number column for product identification"})]}),(0,t.jsx)("input",{ref:x,type:"file",accept:".csv",onChange:e=>{let t=e.target.files?.[0];t&&j(t)},className:"hidden"})]}),"preview"===u.step&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsx)(W.Card,{children:(0,t.jsxs)(W.CardContent,{className:"pt-6",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:u.validRows.length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Products to update"})]})}),(0,t.jsx)(W.Card,{children:(0,t.jsxs)(W.CardContent,{className:"pt-6",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600",children:u.errors.length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Errors found"})]})}),(0,t.jsx)(W.Card,{children:(0,t.jsxs)(W.CardContent,{className:"pt-6",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:u.totalRows}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total rows"})]})})]}),u.newCategories.length>0&&(0,t.jsxs)(er.Alert,{children:[(0,t.jsx)(v.Edit,{className:"h-4 w-4"}),(0,t.jsx)(er.AlertDescription,{children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{children:["The following ",u.newCategories.length," new categories will be created:"]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:u.newCategories.map((e,s)=>(0,t.jsx)(f.Badge,{variant:"outline",className:"text-xs",children:e},s))})]})})]}),u.errors.length>0&&(0,t.jsxs)(er.Alert,{variant:"destructive",children:[(0,t.jsx)(ea.AlertCircle,{className:"h-4 w-4"}),(0,t.jsxs)(er.AlertDescription,{children:[u.errors.length," rows have errors and will be skipped.",(0,t.jsxs)(i.Button,{variant:"link",className:"p-0 h-auto ml-2",onClick:()=>{let e,t,s;return e=new Blob([["Row,Field,Error Message",...u.errors.map(e=>[e.row,e.field,`"${e.message}"`].join(","))].join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),void((s=document.createElement("a")).href=t,s.download="product_update_errors.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(t))},children:[(0,t.jsx)(n.Download,{className:"h-3 w-3 mr-1"}),"Download error log"]})]})]}),(0,t.jsxs)(er.Alert,{children:[(0,t.jsx)(y.Info,{className:"h-4 w-4"}),(0,t.jsx)(er.AlertDescription,{children:(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{children:(0,t.jsx)("strong",{children:"Update Rules:"})}),(0,t.jsxs)("ul",{className:"text-sm space-y-1 ml-2",children:[(0,t.jsx)("li",{children:"• Only fields with changes will be updated"}),(0,t.jsx)("li",{children:"• Empty fields will be ignored (no changes)"}),(0,t.jsx)("li",{children:"• Quantity changes will be tracked in stock history"}),(0,t.jsx)("li",{children:"• Products are identified by Item Number"})]})]})})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,t.jsx)(i.Button,{variant:"outline",onClick:()=>m(e=>({...e,step:"select"})),children:"Back"}),(0,t.jsxs)(i.Button,{onClick:N,disabled:0===u.validRows.length,children:["Update ",u.validRows.length," Products",u.newCategories.length>0&&` & Create ${u.newCategories.length} Categories`]})]})]}),"updating"===u.step&&(0,t.jsx)(ee.BulkOperationProgress,{title:"Updating Products...",currentCount:u.currentProductIndex,totalCount:u.validRows.length,status:"processing"}),"complete"===u.step&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(ee.BulkOperationProgress,{title:"Update Complete!",currentCount:u.currentProductIndex,totalCount:u.validRows.length,status:u.failureCount>0?"failed":"completed",successCount:u.successCount,failureCount:u.failureCount}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(i.Button,{onClick:()=>{if(d)return;let e="complete"===u.step&&u.successCount>0;m({step:"select",file:null,validRows:[],errors:[],totalRows:0,updateProgress:0,successCount:0,failureCount:0,newCategories:[],currentProductIndex:0}),r(!1),e&&setTimeout(()=>{window.location.reload()},100)},children:"Close"})})]})]})})};var ed=e.i(284765),eu=e.i(699375),em=e.i(110204);let ex=({open:e,onOpenChange:r,selectedProducts:a,onConfirm:l,isPrinting:n,printProgress:o})=>{let[c,d]=(0,s.useState)(!0),m=e=>{n||r(e)},x=a.length;return(0,t.jsx)(Z.Dialog,{open:e,onOpenChange:m,children:(0,t.jsxs)(Z.DialogContent,{className:"sm:max-w-[425px]",children:[(0,t.jsxs)(Z.DialogHeader,{children:[(0,t.jsxs)(Z.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(u.Printer,{className:"h-5 w-5"}),"Print Barcode Labels"]}),(0,t.jsxs)(Z.DialogDescription,{children:["You are about to print barcodes for ",x," product",x>1?"s":"","."]})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-muted/30",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ed.Settings2,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(em.Label,{htmlFor:"bulk-print-price",className:"text-sm font-medium cursor-pointer",children:"Show Price on Label"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Include selling price on each label"})]})]}),(0,t.jsx)(eu.Switch,{id:"bulk-print-price",checked:c,onCheckedChange:d,disabled:n})]}),(0,t.jsx)("div",{className:"max-h-40 overflow-y-auto border rounded-md p-2 bg-muted/10",children:(0,t.jsx)("div",{className:"space-y-1",children:a.map(e=>(0,t.jsxs)("div",{className:"text-xs text-muted-foreground truncate px-2 py-1",children:["• ",e.name," (",e.itemNumber,")"]},e.id))})})]}),n&&o&&(0,t.jsx)(ee.BulkOperationProgress,{title:"Printing Labels...",currentCount:o.current,totalCount:o.total,status:"processing"}),(0,t.jsxs)(Z.DialogFooter,{children:[(0,t.jsx)(i.Button,{variant:"outline",onClick:()=>m(!1),disabled:n,children:"Cancel"}),(0,t.jsx)(i.Button,{onClick:()=>l(c),disabled:n||0===x,className:"gap-2",children:n?`Printing... ${Math.round((o?.current||0)/(o?.total||1)*100)}%`:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Printer,{className:"h-4 w-4"}),"Print ",x," Label",x>1?"s":""]})})]})]})})},eh=({open:e,onOpenChange:r,productCount:a,onConfirm:l,isExporting:o})=>{let[c,d]=(0,s.useState)(!0),u=()=>{let e=Math.floor(4.085106382978723),t=Math.floor(8.71875);return{cols:e,rows:t,itemsPerPage:e*t}},{cols:m,rows:x,itemsPerPage:h}=u();return(0,t.jsx)(Z.Dialog,{open:e,onOpenChange:r,children:(0,t.jsxs)(Z.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(Z.DialogHeader,{children:[(0,t.jsx)(Z.DialogTitle,{children:"Export Barcodes to PDF"}),(0,t.jsx)(Z.DialogDescription,{children:"Barcodes are automatically arranged on A4 paper (45mm × 30mm labels)."})]}),(0,t.jsxs)("div",{className:"space-y-6 py-4",children:[(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,t.jsxs)("p",{className:"text-sm text-blue-900",children:[(0,t.jsx)("strong",{children:a})," product",1!==a?"s":""," with barcodes will be exported"]})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(em.Label,{className:"text-base font-semibold",children:"Automatic Layout"}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,t.jsxs)("p",{children:["• ",m," columns × ",x," rows"]}),(0,t.jsxs)("p",{children:["• ",h," barcodes per page"]}),(0,t.jsx)("p",{children:"• Fixed size: 45mm × 30mm"})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between py-2 border-t",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(em.Label,{className:"text-sm font-medium",children:"Include Price"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Show product price on each barcode"})]}),(0,t.jsx)(eu.Switch,{checked:c,onCheckedChange:d})]}),(0,t.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:(0,t.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,t.jsx)("strong",{children:"Estimated pages:"})," ",(()=>{let{itemsPerPage:e}=u();return Math.ceil(a/e)})()]})})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)(i.Button,{onClick:()=>{l({showPrice:c})},disabled:o,className:"w-full gap-2",children:[(0,t.jsx)(n.Download,{className:"h-4 w-4"}),o?"Exporting...":"Export PDF"]}),(0,t.jsx)(i.Button,{variant:"outline",onClick:()=>r(!1),disabled:o,className:"w-full",children:"Cancel"})]})]})})};var ep=e.i(553366),eg=e.i(483969),ej=e.i(555781),ef=e.i(244095);e.s(["default",0,()=>{let e=(0,r.useNavigate)(),{user:j}=(0,m.useAuth)(),{currentBusiness:f,isLoading:N}=(0,x.useBusiness)(),{hasPermission:b}=(0,C.useProfiles)(),{toast:v}=(0,K.useToast)(),y=(0,h.useIsMobile)(),S=b("inventory","create"),P=b("inventory","edit"),k=b("inventory","delete"),T=b("inventory","view"),{products:D,filteredProducts:F,isLoading:B,loadProducts:z,filters:E,setFilters:I,deleteProduct:O,updateProduct:A,page:U,setPage:M,pageSize:R,setPageSize:q,totalCount:V,refetch:H,isFetching:Q}=(0,J.useProducts)(j?.id,50),{categories:Z}=(0,eo.useCategories)(j?.id),{bulkCreateProducts:ee}=(0,ep.useBulkProducts)(),{settings:er}=(0,g.useBusinessSettings)(),[ei,ea]=(0,s.useState)(new Set),[el,en]=(0,s.useState)(!1),[ed,eu]=(0,s.useState)(!1),[em,eN]=(0,s.useState)([]),[eb,ev]=(0,s.useState)(!1),[ey,eC]=(0,s.useState)(!1),[ew,eS]=(0,s.useState)(!1),[eP,ek]=(0,s.useState)(!1),[eT,eD]=(0,s.useState)(!1),[eF,eB]=(0,s.useState)(!1),[e$,ez]=(0,s.useState)([]),[eE,eI]=(0,s.useState)(void 0),[eO,eA]=(0,s.useState)(void 0),[eU,eM]=(0,s.useState)("name"),[eR,eq]=(0,s.useState)("asc"),[eV,eL]=(0,s.useState)(void 0),[eH,eQ]=(0,s.useState)(void 0),[eW,eG]=(0,s.useState)(void 0),[e_,eJ]=(0,s.useState)(void 0);(0,s.useEffect)(()=>{let e=!1;return(async()=>{if(!j?.id||!f?.id)return;let t=`allProductsStats_${f.id}`,s=localStorage.getItem(t);try{if(s){let e=JSON.parse(s);if(Date.now()-e.ts<3e5){eL(e.costValue),eQ(e.lowStock),eG(e.outOfStock),eJ(e.stockValue);return}}}catch{}let r=await (0,ej.getProductStatsAction)(f.id);if(!e){eL(r.costValue),eQ(r.lowStock),eG(r.outOfStock),eJ(r.stockValue);try{localStorage.setItem(t,JSON.stringify({...r,ts:Date.now()}))}catch{}}})(),()=>{e=!0}},[j?.id,f?.id]);let eK=(0,s.useMemo)(()=>[...F].sort((e,t)=>{let s=0;switch(eU){case"name":s=e.name.localeCompare(t.name);break;case"category":s=e.category.localeCompare(t.category);break;case"quantity":s=e.quantity-t.quantity;break;case"sellingPrice":s=e.sellingPrice-t.sellingPrice;break;case"costPrice":s=e.costPrice-t.costPrice;break;case"itemNumber":s=e.itemNumber.localeCompare(t.itemNumber)}return"asc"===eR?s:-s}),[F,eU,eR]),eY=async()=>{await H(),ea(new Set),v({title:"Products refreshed",description:"Your product list has been updated."})},eX=async()=>{if(!j?.id||!f?.id)return[];try{let e=await (0,ej.getAllProductsAction)(j.id,f.id);if(E.search){let t=E.search.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.category.toLowerCase().includes(t)||e.supplier&&e.supplier.toLowerCase().includes(t)||e.itemNumber.toLowerCase().includes(t))}return E.category&&(e=e.filter(e=>e.category===E.category)),"outOfStock"===E.stockStatus?e=e.filter(e=>0===e.quantity):"inStock"===E.stockStatus?e=e.filter(e=>e.quantity>0):"lowStock"===E.stockStatus&&(e=e.filter(e=>e.quantity>0&&e.quantity<=e.minimumStock)),e.sort((e,t)=>{let s=0;switch(eU){case"name":s=e.name.localeCompare(t.name);break;case"category":s=e.category.localeCompare(t.category);break;case"quantity":s=e.quantity-t.quantity;break;case"sellingPrice":s=e.sellingPrice-t.sellingPrice;break;case"costPrice":s=e.costPrice-t.costPrice;break;case"itemNumber":s=e.itemNumber.localeCompare(t.itemNumber)}return"asc"===eR?s:-s})}catch(e){return console.error("Error fetching all products for export:",e),v({title:"Export failed",description:"Failed to fetch products for export. Please try again.",variant:"destructive"}),[]}},eZ=async()=>{v({title:"Preparing export...",description:"Fetching all products. Please wait."});let e=await eX();if(e.length>0){let t,s,r,i,a,l,n,o;s=(t=localStorage.getItem("businessSettings"))?JSON.parse(t):{currency:"USD"},r=["Item Number","Name","Category","Quantity","Minimum Stock",`Cost Price (${s.currency})`,`Selling Price (${s.currency})`,"Supplier","Description","Created Date","Last Updated"],i=e.map(e=>[e.itemNumber,e.name,e.category,e.quantity.toString(),e.minimumStock.toString(),e.costPrice.toFixed(2),e.sellingPrice.toFixed(2),e.supplier||"N/A",e.description?e.description.replace(/,/g,";").replace(/\n/g," "):"N/A",new Date(e.createdAt).toLocaleDateString(),new Date(e.updatedAt).toLocaleDateString()]),a=[r.join(","),...i.map(e=>e.join(","))].join("\n"),l=`data:text/csv;charset=utf-8,${encodeURIComponent(a)}`,n=`products_${new Date().toISOString().slice(0,10)}.csv`,(o=document.createElement("a")).href=l,o.download=n,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),v({title:"Export successful",description:`${e.length} products exported to CSV file.`})}else v({title:"No products to export",description:"There are no products matching your current filters.",variant:"destructive"})},e0=async()=>{v({title:"Preparing export...",description:"Fetching all products. Please wait."});let e=await eX();if(e.length>0){let t,s,r,i;t=["Item Number,Name,Category,Quantity,Cost Price,Selling Price,Supplier,Description",...e.map(e=>[e.itemNumber,e.name,e.category,e.quantity.toString(),e.costPrice.toString(),e.sellingPrice.toString(),e.supplier||"",e.description||""]).map(e=>e.map(e=>`"${e}"`).join(","))].join("\n"),s=`data:text/csv;charset=utf-8,${encodeURIComponent(t)}`,r=`products_for_update_${new Date().toISOString().slice(0,10)}.csv`,(i=document.createElement("a")).href=s,i.download=r,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),v({title:"Export successful",description:`${e.length} products exported for editing. Use this file with 'Update via CSV'.`})}else v({title:"No products to export",description:"There are no products matching your current filters.",variant:"destructive"})},e1=async()=>{v({title:"Preparing export...",description:"Fetching all products. Please wait."});let e=await eX();e.length>0?(((e,t)=>{let s=t||{businessName:"Your Business",businessAddress:"Business Address",businessPhone:"(123) 456-7890",businessEmail:"support@yourbusiness.com",currency:"USD"},r=new Y.default({orientation:"portrait",unit:"mm",format:"a4",compress:!0}),i=r.internal.pageSize.getWidth(),a=r.internal.pageSize.getHeight(),l=i-10-10,n=10,o=()=>{r.setFontSize(8),r.setFont("helvetica","normal"),r.setTextColor(150,150,150),r.text("Created By Gonza Systems",i/2,a-10,{align:"center"}),r.setTextColor(0,0,0)},c=[20,55,30,25,25,25],d=["Item #","Product Name","Category","Qty",`Cost (${s.currency})`,`Price (${s.currency})`],u=()=>{r.setFillColor(243,244,246),r.rect(10,n-1,l,8,"F"),r.setLineWidth(.2),r.rect(10,n-1,l,8),r.setFontSize(8),r.setFont("helvetica","bold");let e=10;d.forEach((t,s)=>{let i=c[s],a=r.getTextWidth(t),l=e+(i-a)/2;r.text(t,l,n+5),s<d.length-1&&r.line(e+i,n-1,e+i,n+8-1),e+=i}),n+=8},m=e=>n+e>a-10-15&&(o(),r.addPage(),n=10,u(),r.setFont("helvetica","normal"),r.setFontSize(7),!0);r.setFontSize(14),r.setFont("helvetica","bold");let x=s.businessName||"Your Business",h=r.getTextWidth(x);if(r.text(x,(i-h)/2,n),n+=4,s.businessAddress){r.setFontSize(9),r.setFont("helvetica","normal");let e=r.getTextWidth(s.businessAddress);r.text(s.businessAddress,(i-e)/2,n),n+=3}if(s.businessPhone||s.businessEmail){r.setFontSize(8);let e=[s.businessPhone,s.businessEmail].filter(Boolean).join(" | "),t=r.getTextWidth(e);r.text(e,(i-t)/2,n),n+=3}n+=3,r.setFontSize(12),r.setFont("helvetica","bold");let g="Products Inventory Report",j=r.getTextWidth(g);r.text(g,(i-j)/2,n),n+=4,r.setFontSize(8),r.setFont("helvetica","normal");let f=new Date().toLocaleDateString(),N=`Generated on ${f}`,b=r.getTextWidth(N);r.text(N,(i-b)/2,n),n+=6;let v=e.length,y=e.filter(e=>e.quantity>0&&e.quantity<=e.minimumStock).length,C=e.filter(e=>0===e.quantity).length,w=e.reduce((e,t)=>e+t.costPrice*t.quantity,0);r.setFillColor(248,249,250),r.rect(10,n-2,l,15,"F"),r.setLineWidth(.2),r.setDrawColor(200,200,200),r.rect(10,n-2,l,15),r.setFontSize(9),r.setFont("helvetica","bold"),r.text("Inventory Summary",15,n+2),r.setFontSize(7),r.setFont("helvetica","normal");let S=[`Total: ${v}`,`Low Stock: ${y}`,`Out of Stock: ${C}`,`Total Value: ${s.currency} ${(0,p.formatNumber)(w)}`],P=n+6;S.forEach((e,t)=>{let s=15+t%2*(l/2);2===t&&(P+=3),r.text(e,s,P+3*Math.floor(t/2))}),n+=19,m(13),u(),r.setFont("helvetica","normal"),r.setFontSize(7),e.forEach((e,t)=>{m(8);let s=[e.itemNumber||"",e.name||"",e.category||"",e.quantity.toString(),(0,p.formatNumber)(e.costPrice),(0,p.formatNumber)(e.sellingPrice)];t%2==0&&(r.setFillColor(249,250,251),r.rect(10,n-1,l,6,"F")),0===e.quantity?(r.setFillColor(254,226,226),r.rect(10,n-1,l,6,"F")):e.quantity<=e.minimumStock&&(r.setFillColor(254,243,199),r.rect(10,n-1,l,6,"F")),r.setLineWidth(.1),r.rect(10,n-1,l,6);let i=10;s.forEach((e,t)=>{let a=c[t],l=e;if(1===t)for(;r.getTextWidth(l)>a-3&&l.length>3;)l=l.substring(0,l.length-4)+"...";else if(2===t)for(;r.getTextWidth(l)>a-3&&l.length>3;)l=l.substring(0,l.length-4)+"...";let o=i+1.5;if(t>=3){let e=r.getTextWidth(l);o=i+a-e-1.5}r.setTextColor(0,0,0),r.text(l,o,n+3.5),t<s.length-1&&r.line(i+a,n-1,i+a,n+6-1),i+=a}),n+=6}),n+=5,m(10),r.setFontSize(7),r.setFont("helvetica","italic"),r.setTextColor(100,100,100);let k=`This report contains ${e.length} products. Generated by ${s.businessName||"Inventory System"}`,T=r.getTextWidth(k);r.text(k,(i-T)/2,n),o();let D=`products-inventory-${new Date().toISOString().slice(0,10)}.pdf`;r.save(D)})(e,er),v({title:"Export successful",description:`${e.length} products exported to PDF file.`})):v({title:"No products to export",description:"There are no products matching your current filters.",variant:"destructive"})},e2=()=>{(0,eg.generateProductCSVTemplate)(),v({title:"Template downloaded",description:"CSV template has been downloaded to your device."})},e4=async e=>{try{await ee(e),ev(!1),await z()}catch(e){console.error("CSV upload failed:",e),v({title:"Upload failed",description:"There was an error uploading your products. Please try again.",variant:"destructive"})}},e5=async()=>{if(0===ei.size)return;eS(!0),eI({current:0,total:ei.size});let e=0,t=0,s=0;try{for(let r of ei){try{await O(r)?e++:t++}catch(e){t++,console.error(`Error deleting product ${r}:`,e)}s++,eI({current:s,total:ei.size})}ea(new Set),e>0&&v({title:"Products deleted",description:`Successfully deleted ${e} product${e>1?"s":""}`}),t>0&&v({title:"Some deletions failed",description:`${t} product${t>1?"s":""} could not be deleted`,variant:"destructive"}),en(!1),await z()}finally{eS(!1),eI(void 0)}},e6=async(e=!1)=>{if(e){v({title:"Preparing for bulk print...",description:"Fetching all products matching current filters."});let e=await eX();if(0===e.length)return void v({title:"No products found",description:"There are no products matching your current filters to print.",variant:"destructive"});eN(e)}else{if(0===ei.size)return void v({title:"No products selected",description:"Please select products to print or use 'Print All'.",variant:"destructive"});eN(te)}eu(!0)},e8=async e=>{if(0===em.length)return;ek(!0),eA({current:0,total:em.length});let t=0,s=0;try{for(let r of em){if(!r.barcode){s++,eA(e=>e?{...e,current:e.current+1}:void 0);continue}try{let i=e?`TEXT 15,180,"3",0,1,1,"${er.currency} ${(0,p.formatNumber)(r.sellingPrice)}"
`:"";(await fetch("http://localhost:5000/print/label",{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({PrinterName:er.defaultPrinterName||"Label Printer",Content:`SIZE 50 mm, 30 mm
GAP 3 mm, 0 mm
CLS
TEXT 15,20,"3",0,1,1,"${r.name}"
BARCODE 15,70,"128",60,1,0,2,2,"${r.barcode}"
${i}PRINT 1
`})})).ok?t++:s++}catch(e){console.error(`Failed to print label for ${r.name}:`,e),s++}eA(e=>e?{...e,current:e.current+1}:void 0),await new Promise(e=>setTimeout(e,100))}t>0&&v({title:"Printing successful",description:`Sent ${t} labels to the printer.`}),s>0&&v({title:"Some labels failed",description:`${s} labels could not be printed. Check your connection.`,variant:"destructive"}),eu(!1)}finally{ek(!1),eA(void 0)}},e3=async(e=!1)=>{try{let t=[];if(e)v({title:"Preparing barcode export...",description:"Fetching all products matching current filters."}),t=await eX();else{if(0===ei.size)return void v({title:"No products selected",description:"Please select products to export barcodes.",variant:"destructive"});t=te}let s=t.filter(e=>e.barcode);if(0===s.length)return void v({title:"No barcodes to export",description:"None of the selected products have barcodes.",variant:"destructive"});ez(s),eB(!0)}catch(e){console.error("Failed to prepare barcode export:",e),v({title:"Export preparation failed",description:"Failed to prepare products for export.",variant:"destructive"})}},e7=async e=>{eD(!0);try{v({title:"Generating PDF...",description:`Exporting ${e$.length} barcode${e$.length>1?"s":""}...`}),await (0,ef.exportBulkBarcodesToPDF)(e$,{showPrice:e.showPrice,currency:er.currency}),v({title:"Export successful",description:`${e$.length} barcode${e$.length>1?"s":""} exported to PDF.`}),eB(!1)}catch(e){console.error("Barcode export failed:",e),v({title:"Export failed",description:"Failed to export barcodes. Please try again.",variant:"destructive"})}finally{eD(!1)}},e9=async(e,t)=>{try{if(await A(e,t))return v({title:"Product updated",description:"Product details have been updated successfully."}),!0;return v({title:"Update failed",description:"Failed to update product. Please try again.",variant:"destructive"}),!1}catch(e){return console.error("Error updating product:",e),v({title:"Update failed",description:"An error occurred while updating the product.",variant:"destructive"}),!1}},te=(0,s.useMemo)(()=>eK.filter(e=>ei.has(e.id)),[eK,ei]);return N||!f||B&&0===D.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[60vh] space-y-4",children:[(0,t.jsx)(X.default,{}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Loading products..."})]}):(0,t.jsxs)("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[(0,t.jsx)("div",{className:"space-y-3 md:space-y-4",children:(0,t.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:()=>e("/inventory"),className:"shrink-0 h-8 w-8",title:"Back to inventory",children:(0,t.jsx)(d.ArrowLeft,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h1",{className:"text-lg md:text-2xl lg:text-3xl font-bold text-sales-dark",children:"Products"}),(0,t.jsx)("p",{className:"text-xs md:text-base text-muted-foreground",children:"Manage your product inventory and pricing"})]})]}),y?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[S&&(0,t.jsxs)(i.Button,{onClick:()=>e("/inventory/new"),className:"flex-1 gap-2 h-9",children:[(0,t.jsx)(a.Plus,{size:16})," Add Product"]}),(0,t.jsx)(i.Button,{onClick:eY,variant:"outline",size:"icon",disabled:B||Q,className:"shrink-0 h-9 w-9",children:(0,t.jsx)(l.RefreshCw,{className:`h-4 w-4 ${B||Q?"animate-spin":""}`})})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:S&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Button,{onClick:e2,variant:"outline",className:"gap-1 text-xs h-8",children:[(0,t.jsx)(n.Download,{size:14})," Template"]}),(0,t.jsxs)(i.Button,{onClick:()=>ev(!0),variant:"outline",className:"gap-1 text-xs h-8",children:[(0,t.jsx)(o.Upload,{size:14})," Add CSV"]})]})}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:P&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Button,{onClick:e0,variant:"outline",className:"gap-1 text-xs h-8",children:[(0,t.jsx)(n.Download,{size:14})," Export for Editing"]}),(0,t.jsxs)(i.Button,{onClick:()=>eC(!0),variant:"outline",className:"gap-1 text-xs h-8",children:[(0,t.jsx)(o.Upload,{size:14})," Update CSV"]})]})}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:T&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Button,{onClick:eZ,variant:"outline",className:"gap-1 text-xs h-8",children:[(0,t.jsx)(n.Download,{size:14})," Full Export"]}),(0,t.jsxs)(i.Button,{onClick:e1,variant:"outline",className:"gap-1 text-xs h-8",children:[(0,t.jsx)(n.Download,{size:14})," PDF"]})]})}),k&&ei.size>0&&(0,t.jsxs)(i.Button,{onClick:()=>en(!0),variant:"destructive",className:"w-full gap-2 text-xs h-8",disabled:ew,children:[(0,t.jsx)(c.Trash2,{size:14})," Delete Selected (",ei.size,")"]}),P&&(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)(i.Button,{onClick:()=>e6(!1),variant:"outline",className:"gap-2 text-xs h-8",disabled:0===ei.size||eP,children:[(0,t.jsx)(u.Printer,{size:14})," Print Selected"]}),(0,t.jsxs)(i.Button,{onClick:()=>e6(!0),variant:"outline",className:"gap-2 text-xs h-8",disabled:0===V||eP,children:[(0,t.jsx)(u.Printer,{size:14})," Print All (",V,")"]})]}),T&&(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)(i.Button,{onClick:()=>e3(!1),variant:"outline",className:"gap-2 text-xs h-8",disabled:0===ei.size||eT,children:[(0,t.jsx)(n.Download,{size:14})," Export Barcodes"]}),(0,t.jsxs)(i.Button,{onClick:()=>e3(!0),variant:"outline",className:"gap-2 text-xs h-8",disabled:0===V||eT,children:[(0,t.jsx)(n.Download,{size:14})," All Barcodes"]})]})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)(i.Button,{onClick:eY,variant:"outline",size:"icon",disabled:B||Q,title:"Refresh products",children:(0,t.jsx)(l.RefreshCw,{className:`h-4 w-4 ${B||Q?"animate-spin":""}`})}),S&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Button,{onClick:e2,variant:"outline",className:"gap-2",children:[(0,t.jsx)(n.Download,{size:16})," CSV Template"]}),(0,t.jsxs)(i.Button,{onClick:()=>ev(!0),variant:"outline",className:"gap-2",children:[(0,t.jsx)(o.Upload,{size:16})," Add via CSV"]})]}),P&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Button,{onClick:e0,variant:"outline",className:"gap-2",children:[(0,t.jsx)(n.Download,{size:16})," Export for Editing"]}),(0,t.jsxs)(i.Button,{onClick:()=>eC(!0),variant:"outline",className:"gap-2",children:[(0,t.jsx)(o.Upload,{size:16})," Update via CSV"]})]}),T&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Button,{onClick:eZ,variant:"outline",className:"gap-2",children:[(0,t.jsx)(n.Download,{size:16})," Full Export"]}),(0,t.jsxs)(i.Button,{onClick:e1,variant:"outline",className:"gap-2",children:[(0,t.jsx)(n.Download,{size:16})," Export PDF"]})]}),k&&ei.size>0&&(0,t.jsxs)(i.Button,{onClick:()=>en(!0),variant:"destructive",className:"gap-2",disabled:ew,children:[(0,t.jsx)(c.Trash2,{size:16})," Delete Selected (",ei.size,")"]}),P&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Button,{onClick:()=>e6(!1),variant:"outline",className:"gap-2",disabled:0===ei.size||eP,children:[(0,t.jsx)(u.Printer,{size:16})," Print Selected"]}),(0,t.jsxs)(i.Button,{onClick:()=>e6(!0),variant:"outline",className:"gap-2",disabled:0===V||eP,children:[(0,t.jsx)(u.Printer,{size:16})," Print All (",V,")"]})]}),T&&(0,t.jsxs)(w.DropdownMenu,{children:[(0,t.jsx)(w.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(i.Button,{variant:"outline",className:"gap-2",disabled:eT,children:[(0,t.jsx)(n.Download,{size:16})," Export Barcodes ",(0,t.jsx)($.ChevronDown,{size:16})]})}),(0,t.jsxs)(w.DropdownMenuContent,{align:"end",children:[(0,t.jsxs)(w.DropdownMenuItem,{onClick:()=>e3(!1),disabled:0===ei.size,children:[(0,t.jsx)(n.Download,{className:"mr-2 h-4 w-4"}),"Selected Products (",ei.size,")"]}),(0,t.jsx)(w.DropdownMenuSeparator,{}),(0,t.jsxs)(w.DropdownMenuItem,{onClick:()=>e3(!0),disabled:0===V,children:[(0,t.jsx)(n.Download,{className:"mr-2 h-4 w-4"}),"All Products (",V,")"]})]})]}),S&&(0,t.jsxs)(i.Button,{onClick:()=>e("/inventory/new"),className:"gap-2",children:[(0,t.jsx)(a.Plus,{size:16})," Add Product"]})]})]})}),(0,t.jsx)(_.default,{products:D,hideStockValue:!0,totalCountOverride:V,totalCostValueOverride:eV,lowStockOverride:eH,outOfStockOverride:eW,totalStockValueOverride:e_}),(0,t.jsxs)(W.Card,{className:"shadow-sm",children:[(0,t.jsx)(W.CardHeader,{className:"pb-2 md:pb-6",children:(0,t.jsx)(W.CardTitle,{className:"text-sm md:text-lg",children:"Filter Products"})}),(0,t.jsx)(W.CardContent,{className:"pt-0",children:(0,t.jsx)(G,{filters:E,setFilters:I,categories:Z,productsCount:eK.length})})]}),(0,t.jsxs)(W.Card,{className:"shadow-sm",children:[(0,t.jsxs)(W.CardHeader,{className:"pb-2 md:pb-6",children:[(0,t.jsx)(W.CardTitle,{className:"text-sm md:text-lg flex items-center justify-between",children:(0,t.jsxs)("span",{children:["Products (",V,")",ei.size>0&&(0,t.jsxs)("span",{className:"text-xs font-normal text-muted-foreground ml-2",children:[ei.size," selected"]})]})}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground mt-2 p-2 bg-blue-50 rounded border-l-4 border-blue-400",children:["💡 ",(0,t.jsx)("strong",{children:"Tip:"})," Click on Category, Cost Price, or Selling Price to edit them directly in the table"]})]}),(0,t.jsxs)(W.CardContent,{className:"p-0",children:[(0,t.jsx)(L,{products:eK,isLoading:B,showAllFields:!0,enableBulkActions:!0,selectedProductIds:ei,onToggleProductSelection:e=>{let t=new Set(ei);t.has(e)?t.delete(e):t.add(e),ea(t)},onToggleAllProducts:e=>{ei.size===e.length?ea(new Set):ea(new Set(e))},sortField:eU,sortOrder:eR,onSort:e=>{eU===e?eq("asc"===eR?"desc":"asc"):(eM(e),eq("asc"))},onUpdateProduct:e9,categories:Z.map(e=>e.name)}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 md:p-4 border-t",children:[(0,t.jsxs)("div",{className:"text-xs md:text-sm text-muted-foreground",children:["Showing ",(U-1)*R+1,"–",Math.min(U*R,V)," of ",V]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("select",{className:"border rounded px-2 py-1 text-xs md:text-sm",value:R,onChange:e=>q(Number(e.target.value)),children:[20,50,100].map(e=>(0,t.jsxs)("option",{value:e,children:[e," / page"]},e))}),(0,t.jsx)(i.Button,{variant:"outline",size:"sm",disabled:1===U||B,onClick:()=>M(Math.max(1,U-1)),children:"Prev"}),(0,t.jsx)(i.Button,{variant:"outline",size:"sm",disabled:U*R>=V||B,onClick:()=>M(U+1),children:"Next"})]})]})]})]}),(0,t.jsx)(es.default,{open:eb,onOpenChange:ev,onUpload:e4,categories:Z.map(e=>e.name)}),(0,t.jsx)(ec,{open:ey,onOpenChange:eC,userId:j?.id}),(0,t.jsx)(et,{open:el,onOpenChange:en,selectedProducts:te,onConfirm:e5,isDeleting:ew,deletionProgress:eE}),(0,t.jsx)(ex,{open:ed,onOpenChange:eu,selectedProducts:em,onConfirm:e8,isPrinting:eP,printProgress:eO}),(0,t.jsx)(eh,{open:eF,onOpenChange:eB,productCount:e$.filter(e=>e.barcode).length,onConfirm:e7,isExporting:eT})]})}],943674)}]);