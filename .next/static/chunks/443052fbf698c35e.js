(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63209,e=>{"use strict";let t=(0,e.i(475254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},269638,e=>{"use strict";let t=(0,e.i(475254).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],269638)},972520,e=>{"use strict";let t=(0,e.i(475254).default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>t],972520)},373884,e=>{"use strict";let t=(0,e.i(475254).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],373884)},932145,e=>{"use strict";var t=e.i(843476),a=e.i(271645),s=e.i(679788),r=e.i(904792),l=e.i(269638),i=e.i(373884);let n=(0,e.i(475254).default)("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);var c=e.i(63209),o=e.i(209912),d=e.i(972520);e.s(["default",0,()=>{let[e]=(0,s.useSearchParams)(),u=(0,r.useNavigate)(),[m,x]=(0,a.useState)("loading"),[h,f]=(0,a.useState)("Verifying your payment with PesaPal..."),[p,g]=(0,a.useState)(null),y=e.get("OrderTrackingId"),b=e.get("purchase_id");return(0,a.useEffect)(()=>{(async()=>{if(!y){console.error("[PaymentCallback] No OrderTrackingId found in URL parameters."),x("failed"),f("Missing payment reference. We couldn't track this transaction.");return}try{console.log("--- [PaymentCallback] Initiating Verification ---"),console.log("Tracking ID:",y),console.log("Purchase ID:",b),x("loading");let e=await fetch("/api/verify-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderTrackingId:y,purchaseId:b})}),t=await e.json();if(!e.ok)throw console.error("[PaymentCallback] HTTP error:",e.status),Error(`HTTP ${e.status}`);console.log("[PaymentCallback] Backend Response:",t);let a=t.is_subscription;if(console.log("[PaymentCallback] Function Result:",t),!1===t.success){console.error("[PaymentCallback] Business Error:",t.error),x("failed"),f(t.error||"Verification failed on the server.");return}let s="completed"===t.payment_status;g(t),console.log("Result Analysis:",{isCompleted:s,isSubscription:a,value:t.value_added}),s?(x("success"),f(`Access Restored! Your subscription has been extended by ${t.value_added} days.`),setTimeout(()=>{console.log("[PaymentCallback] Auto-redirecting to dashboard"),u("/")},4e3)):"failed"===t.payment_status?(x("failed"),f("The transaction was declined by PesaPal. Please try again.")):"cancelled"===t.payment_status?(x("cancelled"),f("The payment process was cancelled.")):(x("loading"),f("Your payment is still being processed by the network. Please wait..."),setTimeout(()=>{console.log("[PaymentCallback] Refreshing to check status again..."),window.location.reload()},6e3))}catch(e){console.error("[PaymentCallback] Unexpected Error:",e),x("failed"),f(e.message||"An unexpected error occurred while verifying your payment.")}})()},[y,b,u]),(0,t.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-[#fafafa] p-6",children:(0,t.jsxs)("div",{className:"w-full max-w-md animate-in fade-in slide-in-from-bottom-4 duration-1000",children:[(0,t.jsxs)("div",{className:"bg-white border border-border/40 shadow-[0_32px_64px_-12px_rgba(0,0,0,0.06)] rounded-3xl p-10 text-center relative overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600"}),(0,t.jsxs)("div",{className:"mb-10 relative",children:["loading"===m&&(0,t.jsxs)("div",{className:"w-24 h-24 bg-blue-50/50 text-blue-600 rounded-3xl flex items-center justify-center mx-auto border border-blue-100/50 relative overflow-hidden",children:[(0,t.jsx)(n,{className:"w-10 h-10 animate-spin relative z-10"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-blue-100/20 animate-pulse"})]}),"success"===m&&(0,t.jsx)("div",{className:"w-24 h-24 bg-green-50/50 text-green-600 rounded-3xl flex items-center justify-center mx-auto border border-green-100/50 rotate-3 scale-110 duration-500",children:(0,t.jsx)(l.CheckCircle,{className:"w-12 h-12 -rotate-3"})}),"failed"===m&&(0,t.jsx)("div",{className:"w-24 h-24 bg-red-50/50 text-red-600 rounded-3xl flex items-center justify-center mx-auto border border-red-100/50 rotate-3 animate-in shake-in",children:(0,t.jsx)(i.XCircle,{className:"w-12 h-12 -rotate-3"})}),"cancelled"===m&&(0,t.jsx)("div",{className:"w-24 h-24 bg-amber-50/50 text-amber-600 rounded-3xl flex items-center justify-center mx-auto border border-amber-100/50 rotate-3",children:(0,t.jsx)(c.AlertCircle,{className:"w-12 h-12 -rotate-3"})})]}),(0,t.jsxs)("h1",{className:"text-2xl font-bold text-foreground mb-4 font-inter tracking-tight",children:["loading"===m&&"Verifying Payment","success"===m&&"Payment Successful","failed"===m&&"Transaction Failed","cancelled"===m&&"Payment Cancelled"]}),(0,t.jsx)("p",{className:"text-[15px] text-muted-foreground leading-relaxed mb-10 px-4",children:h}),"success"===m&&p&&(0,t.jsxs)("div",{className:"bg-[#f8faff] rounded-2xl p-6 border border-blue-50/50 mb-10 text-left animate-in slide-in-from-bottom-2 duration-700",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-widest text-blue-600/60",children:"Subscription Details"}),(0,t.jsx)(o.Rocket,{className:"w-3 h-3 text-blue-500"})]}),(0,t.jsxs)("div",{className:"flex items-end justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-foreground font-bold text-lg",children:[p.value_added," Days Access"]}),(0,t.jsx)("p",{className:"text-[10px] uppercase tracking-wider font-medium text-muted-foreground/80",children:"Value Added to Account"})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsx)("p",{className:"text-foreground/40 font-mono text-[10px] truncate max-w-[100px]",children:p.tracking_id})})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:["loading"!==m&&(0,t.jsxs)("button",{onClick:()=>u("/"),className:"group relative w-full h-14 bg-foreground text-background font-bold text-[12px] uppercase tracking-widest rounded-2xl transition-all hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center gap-2 overflow-hidden shadow-lg shadow-black/5",children:[(0,t.jsxs)("span",{className:"relative z-10 flex items-center gap-2",children:["Continue to Dashboard",(0,t.jsx)(d.ArrowRight,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity"})]}),"loading"===m&&(0,t.jsx)("div",{className:"py-4",children:(0,t.jsx)("p",{className:"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-medium opacity-60 animate-pulse",children:"Secured by PesaPal Integrated"})})]})]}),(0,t.jsxs)("p",{className:"mt-8 text-center text-[11px] text-muted-foreground/40 font-medium",children:["Â© ",new Date().getFullYear()," Gonza Systems. All rights reserved."]})]})})}],932145)}]);