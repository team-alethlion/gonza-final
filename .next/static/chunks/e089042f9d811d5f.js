(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,388474,e=>{"use strict";var t=e.i(271645),r=e.i(820783),a=e.i(30030),i=e.i(981140),s=e.i(369340),n=e.i(999682),o=e.i(635804),c=e.i(296626),l=e.i(248425),d=e.i(843476),u="Checkbox",[f,p]=(0,a.createContextScope)(u),[b,v]=f(u);function m(e){let{__scopeCheckbox:r,checked:a,children:i,defaultChecked:n,disabled:o,form:c,name:l,onCheckedChange:f,required:p,value:v="on",internal_do_not_use_render:m}=e,[g,h]=(0,s.useControllableState)({prop:a,defaultProp:n??!1,onChange:f,caller:u}),[y,k]=t.useState(null),[x,C]=t.useState(null),S=t.useRef(!1),w=!y||!!c||!!y.closest("form"),E={checked:g,disabled:o,setChecked:h,control:y,setControl:k,name:l,form:c,value:v,hasConsumerStoppedPropagationRef:S,required:p,defaultChecked:!R(n)&&n,isFormControl:w,bubbleInput:x,setBubbleInput:C};return(0,d.jsx)(b,{scope:r,...E,children:"function"==typeof m?m(E):i})}var g="CheckboxTrigger",h=t.forwardRef(({__scopeCheckbox:e,onKeyDown:a,onClick:s,...n},o)=>{let{control:c,value:u,disabled:f,checked:p,required:b,setControl:m,setChecked:h,hasConsumerStoppedPropagationRef:y,isFormControl:k,bubbleInput:x}=v(g,e),C=(0,r.useComposedRefs)(o,m),S=t.useRef(p);return t.useEffect(()=>{let e=c?.form;if(e){let t=()=>h(S.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[c,h]),(0,d.jsx)(l.Primitive.button,{type:"button",role:"checkbox","aria-checked":R(p)?"mixed":p,"aria-required":b,"data-state":w(p),"data-disabled":f?"":void 0,disabled:f,value:u,...n,ref:C,onKeyDown:(0,i.composeEventHandlers)(a,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,i.composeEventHandlers)(s,e=>{h(e=>!!R(e)||!e),x&&k&&(y.current=e.isPropagationStopped(),y.current||e.stopPropagation())})})});h.displayName=g;var y=t.forwardRef((e,t)=>{let{__scopeCheckbox:r,name:a,checked:i,defaultChecked:s,required:n,disabled:o,value:c,onCheckedChange:l,form:u,...f}=e;return(0,d.jsx)(m,{__scopeCheckbox:r,checked:i,defaultChecked:s,disabled:o,required:n,onCheckedChange:l,name:a,form:u,value:c,internal_do_not_use_render:({isFormControl:e})=>(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h,{...f,ref:t,__scopeCheckbox:r}),e&&(0,d.jsx)(S,{__scopeCheckbox:r})]})})});y.displayName=u;var k="CheckboxIndicator",x=t.forwardRef((e,t)=>{let{__scopeCheckbox:r,forceMount:a,...i}=e,s=v(k,r);return(0,d.jsx)(c.Presence,{present:a||R(s.checked)||!0===s.checked,children:(0,d.jsx)(l.Primitive.span,{"data-state":w(s.checked),"data-disabled":s.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...e.style}})})});x.displayName=k;var C="CheckboxBubbleInput",S=t.forwardRef(({__scopeCheckbox:e,...a},i)=>{let{control:s,hasConsumerStoppedPropagationRef:c,checked:u,defaultChecked:f,required:p,disabled:b,name:m,value:g,form:h,bubbleInput:y,setBubbleInput:k}=v(C,e),x=(0,r.useComposedRefs)(i,k),S=(0,n.usePrevious)(u),w=(0,o.useSize)(s);t.useEffect(()=>{if(!y)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!c.current;if(S!==u&&e){let r=new Event("click",{bubbles:t});y.indeterminate=R(u),e.call(y,!R(u)&&u),y.dispatchEvent(r)}},[y,S,u,c]);let E=t.useRef(!R(u)&&u);return(0,d.jsx)(l.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:f??E.current,required:p,disabled:b,name:m,value:g,form:h,...a,tabIndex:-1,ref:x,style:{...a.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function R(e){return"indeterminate"===e}function w(e){return R(e)?"indeterminate":e?"checked":"unchecked"}S.displayName=C,e.s(["Checkbox",()=>y,"CheckboxIndicator",()=>x,"Indicator",()=>x,"Root",()=>y,"createCheckboxScope",()=>p,"unstable_BubbleInput",()=>S,"unstable_CheckboxBubbleInput",()=>S,"unstable_CheckboxProvider",()=>m,"unstable_CheckboxTrigger",()=>h,"unstable_Provider",()=>m,"unstable_Trigger",()=>h])},257428,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(388474),i=e.i(643531),s=e.i(975157);let n=r.forwardRef(({className:e,...r},n)=>(0,t.jsx)(a.Root,{ref:n,className:(0,s.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...r,children:(0,t.jsx)(a.Indicator,{className:(0,s.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(i.Check,{className:"h-4 w-4"})})}));n.displayName=a.Root.displayName,e.s(["Checkbox",()=>n])},503116,e=>{"use strict";let t=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],503116)},269638,e=>{"use strict";let t=(0,e.i(475254).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],269638)},797548,e=>{"use strict";let t=(0,e.i(475254).default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);e.s(["Filter",()=>t],797548)},356909,e=>{"use strict";let t=(0,e.i(475254).default)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],356909)},555436,e=>{"use strict";let t=(0,e.i(475254).default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);e.s(["Search",()=>t],555436)},926209,e=>{"use strict";var t=e.i(271645),r=e.i(981140),a=e.i(30030),i=e.i(842727),s=e.i(296626),n=e.i(248425),o=e.i(586318),c=e.i(369340),l=e.i(610772),d=e.i(843476),u="Tabs",[f,p]=(0,a.createContextScope)(u,[i.createRovingFocusGroupScope]),b=(0,i.createRovingFocusGroupScope)(),[v,m]=f(u),g=t.forwardRef((e,t)=>{let{__scopeTabs:r,value:a,onValueChange:i,defaultValue:s,orientation:f="horizontal",dir:p,activationMode:b="automatic",...m}=e,g=(0,o.useDirection)(p),[h,y]=(0,c.useControllableState)({prop:a,onChange:i,defaultProp:s??"",caller:u});return(0,d.jsx)(v,{scope:r,baseId:(0,l.useId)(),value:h,onValueChange:y,orientation:f,dir:g,activationMode:b,children:(0,d.jsx)(n.Primitive.div,{dir:g,"data-orientation":f,...m,ref:t})})});g.displayName=u;var h="TabsList",y=t.forwardRef((e,t)=>{let{__scopeTabs:r,loop:a=!0,...s}=e,o=m(h,r),c=b(r);return(0,d.jsx)(i.Root,{asChild:!0,...c,orientation:o.orientation,dir:o.dir,loop:a,children:(0,d.jsx)(n.Primitive.div,{role:"tablist","aria-orientation":o.orientation,...s,ref:t})})});y.displayName=h;var k="TabsTrigger",x=t.forwardRef((e,t)=>{let{__scopeTabs:a,value:s,disabled:o=!1,...c}=e,l=m(k,a),u=b(a),f=R(l.baseId,s),p=w(l.baseId,s),v=s===l.value;return(0,d.jsx)(i.Item,{asChild:!0,...u,focusable:!o,active:v,children:(0,d.jsx)(n.Primitive.button,{type:"button",role:"tab","aria-selected":v,"aria-controls":p,"data-state":v?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:f,...c,ref:t,onMouseDown:(0,r.composeEventHandlers)(e.onMouseDown,e=>{o||0!==e.button||!1!==e.ctrlKey?e.preventDefault():l.onValueChange(s)}),onKeyDown:(0,r.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&l.onValueChange(s)}),onFocus:(0,r.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==l.activationMode;v||o||!e||l.onValueChange(s)})})})});x.displayName=k;var C="TabsContent",S=t.forwardRef((e,r)=>{let{__scopeTabs:a,value:i,forceMount:o,children:c,...l}=e,u=m(C,a),f=R(u.baseId,i),p=w(u.baseId,i),b=i===u.value,v=t.useRef(b);return t.useEffect(()=>{let e=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,d.jsx)(s.Presence,{present:o||b,children:({present:t})=>(0,d.jsx)(n.Primitive.div,{"data-state":b?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":f,hidden:!t,id:p,tabIndex:0,...l,ref:r,style:{...e.style,animationDuration:v.current?"0s":void 0},children:t&&c})})});function R(e,t){return`${e}-trigger-${t}`}function w(e,t){return`${e}-content-${t}`}S.displayName=C,e.s(["Content",()=>S,"List",()=>y,"Root",()=>g,"Tabs",()=>g,"TabsContent",()=>S,"TabsList",()=>y,"TabsTrigger",()=>x,"Trigger",()=>x,"createTabsScope",()=>p])},677572,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(926209),i=e.i(975157);let s=a.Root,n=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)(a.List,{ref:s,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...r}));n.displayName=a.List.displayName;let o=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)(a.Trigger,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...r}));o.displayName=a.Trigger.displayName;let c=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)(a.Content,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r}));c.displayName=a.Content.displayName,e.s(["Tabs",()=>s,"TabsContent",()=>c,"TabsList",()=>n,"TabsTrigger",()=>o])},619578,e=>{"use strict";var t=e.i(688594);function r(e,r,a){return(0,t.addMonths)(e,-r,a)}e.s(["subMonths",()=>r])},304228,e=>{"use strict";var t=e.i(271645),r=e.i(422713),a=e.i(777624),i=e.i(266027),s=e.i(912598),n=e.i(908406),o=e.i(95187);let c=(0,o.createServerReference)("600b97f3c90242ca4be1574d304e260e5e07e3c8cf",o.callServer,void 0,o.findSourceMapURL,"getMessagesAction"),l=(0,o.createServerReference)("40fae8e3cd20e274d8835c219996fbcfcdde06446f",o.callServer,void 0,o.findSourceMapURL,"createMessageAction"),d=(0,o.createServerReference)("608c56e751f1517abf78af3f8f4b1eb817c5efcecc",o.callServer,void 0,o.findSourceMapURL,"getMessageTemplatesAction"),u=(0,o.createServerReference)("4012401c60d205ed481a496ad745ca64dfad82e200",o.callServer,void 0,o.findSourceMapURL,"createMessageTemplateAction"),f=(0,o.createServerReference)("60a4c2261958cabb4ed4ad155b1559b15bd9b1c7a3",o.callServer,void 0,o.findSourceMapURL,"updateMessageTemplateAction"),p=(0,o.createServerReference)("406dfcb8705c888c32dc2bb1380b80464b3977c05d",o.callServer,void 0,o.findSourceMapURL,"deleteMessageTemplateAction");e.s(["useMessages",0,e=>{let[o,b]=(0,t.useState)([]),[v,m]=(0,t.useState)([]),[g,h]=(0,t.useState)([]),[y,k]=(0,t.useState)(0),{currentBusiness:x}=(0,r.useBusiness)(),{currentProfile:C}=(0,a.useProfiles)(),S=(0,s.useQueryClient)(),R=async()=>{C?.sms_credits!==void 0&&k(C.sms_credits)},w=async t=>{if(!e||!x?.id)return null;try{let r=await u({userId:e,locationId:x.id,name:t.name,content:t.content,category:t.category,variables:t.variables,isDefault:t.isDefault});if(r.success&&r.data)return P(),r.data;throw Error(r.error)}catch(e){return console.error("Error creating template:",e),(0,n.toast)({title:"Error",description:"Failed to create template",variant:"destructive"}),null}},E=async(e,t)=>{try{let r=await f(e,t);if(r.success)P();else throw Error(r.error)}catch(e){console.error("Error updating template:",e),(0,n.toast)({title:"Error",description:"Failed to update template",variant:"destructive"})}},T=async e=>{try{let t=await p(e);if(t.success)m(t=>t.filter(t=>t.id!==e));else throw Error(t.error)}catch(e){console.error("Error deleting template:",e),(0,n.toast)({title:"Error",description:"Failed to delete template",variant:"destructive"})}},j=(0,t.useCallback)(async()=>{if(!e||!x?.id)return[];try{let t=await c(e,x.id);if(t.success&&t.data)return t.data;return[]}catch(e){return console.error("Error fetching messages:",e),[]}},[e,x?.id]),I=["messages",e,x?.id],{data:M,isLoading:N}=(0,i.useQuery)({queryKey:I,queryFn:j,enabled:!!e&&!!x?.id});(0,t.useEffect)(()=>{M&&b(M)},[M]);let P=async()=>{if(e&&x?.id)try{let t=await d(e,x.id);t.success&&t.data&&m(t.data)}catch(e){console.error("Error fetching templates:",e)}},L=async()=>{h([])},F=async t=>{let r;if(!e||!x?.id||!C)return null;let a=(r=t.phoneNumber.replace(/[\s\-\(\)]/g,"")).startsWith("+")?r:r.startsWith("256")?"+"+r:r.startsWith("0")?"+256"+r.substring(1):(9===r.length&&r.match(/^[7]\d{8}$/),"+256"+r),i=Math.ceil(t.content.length/160);if(C.sms_credits<i)return(0,n.toast)({title:"Error",description:"Insufficient credits",variant:"destructive"}),null;try{let r=await l({userId:e,locationId:x.id,profileId:C.id,customerId:t.customerId,phoneNumber:a,content:t.content,templateId:t.templateId,smsCreditsUsed:i,status:"sent",metadata:t.metadata});if(r.success&&r.data){let e={...r.data,createdAt:r.data.createdAt.toISOString()};return b(t=>[e,...t]),S.invalidateQueries({queryKey:I}),(0,n.toast)({title:"Success",description:"Message sent successfully"}),e}throw Error(r.error)}catch(e){return console.error("Error sending message:",e),(0,n.toast)({title:"Error",description:"Failed to send message",variant:"destructive"}),null}},A=async e=>{let t=0;for(let r of e.customerIds)t++;return{success:t,failed:0,errors:[]}},_=async(e,t)=>((0,n.toast)({title:"Info",description:"Credit purchase migration in progress"}),null);return(0,t.useEffect)(()=>{e&&x?.id&&(P(),L(),R())},[e,x?.id,C?.id]),{messages:o,templates:v,purchases:g,liveCredits:y,isLoading:N&&!M,createMessage:F,createBulkMessages:A,createTemplate:w,updateTemplate:E,deleteTemplate:T,getMessageStats:()=>{let e=o.length,t=o.filter(e=>"sent"===e.status||"delivered"===e.status).length,r=o.filter(e=>"failed"===e.status).length;return{total:e,sent:t,failed:r,pending:o.filter(e=>"pending"===e.status).length,totalCreditsUsed:o.reduce((e,t)=>e+t.smsCreditsUsed,0),creditsRemaining:y}},initiateCreditPurchase:_,refresh:()=>{S.invalidateQueries({queryKey:I}),P(),L(),R()}}}],304228)},510637,e=>{"use strict";var t=e.i(299378);function r(e,r,a){return(0,t.addYears)(e,-r,a)}e.s(["subYears",()=>r])},373884,e=>{"use strict";let t=(0,e.i(475254).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],373884)}]);